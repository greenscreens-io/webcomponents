import{GSDOM as e,GSComponents as t,GSUtil as s,GSFunction as n,GSDialog as a,GSLoader as r,GSEvents as i,GSAttr as o,GSElement as c,GSEnvironment as l,GSModal as d}from'/webcomponents/release/esm/io.greenscreens.components.all.esm.min.js';let u=class Utils{static setUI(e){const t=document.createElement(e);document.body.insertAdjacentElement('beforeend',t)}static unsetUI(t){e.queryAll(t).forEach((e=>e.remove()))}static get notify(){return t.get('notification')}static inform(e=!1,t){if(Utils.notify)return e?Utils.notify.info('Info',t):(Utils.notify.danger('Error',t),e)}static handleError(e){const t=e.data?.error||e.msg||e.message||e.toString();return Utils.inform(!1,t),t}static fromHex(e){let t=[];for(let s=0,n=e.length;s<n;s+=2)t.push(parseInt(e.substring(s,2),16));return new Uint8Array(t)}static#e(e){var t=null;if(e instanceof Array)t=new Uint8Array(e);else if(e instanceof ArrayBuffer)t=new Uint8Array(e);else if(e instanceof Uint8Array)t=e;else if(e instanceof String||'string'==typeof e)t=utf8ToBuffer(e);else{if(!e.toArrayBuffer)throw'Invalid input, must be String or ArrayBuffer or Uint8Array';t=new Uint8Array(e.toArrayBuffer())}return t}static stringToBlob(e){return new Blob([e],{encoding:'UTF-8',type:'text/plain;charset=UTF-8'})}static binaryToBlob(e){const t=Utils.#e(e);return new Blob([t],{type:'application/octet-stream'})}static download(e,t){if(!t)return!1;const n=s.isString(t)?Utils.stringToBlob(t):Utils.binaryToBlob(t),a=URL.createObjectURL(n);try{const t=document.createElement('a');t.download=e,t.href=a,t.click()}finally{setTimeout((()=>URL.revokeObjectURL(a)),250)}return!0}static revokeObjectURL(e){0===e?.indexOf('blob:')&&URL.revokeObjectURL(e)}static openInNewTab(e,t,s='_blank'){const a=globalThis.open(e,s,t||null);return n.isFunction(a.focus)&&a.focus(),a.addEventListener('beforeunload',(()=>(Utils.revokeObjectURL(e),null))),a}};class WebAuthn{static#t=/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/;static#s=`${location.origin}/services/api?q=/wsauth`;static#n=`${location.origin}/services/rpc`;static#a={'x-type':'admin'};static{Object.freeze(WebAuthn)}static#r(e){return Uint8Array.from(atob(e),(e=>e.charCodeAt(0)))}static#i(e){return btoa(String.fromCharCode.apply(null,new Uint8Array(e)))}static isAllowed(){return!WebAuthn.#t.test(location.hostname)&&'https:'===location.protocol||'localhost'===location.hostname}static get#o(){return{api:WebAuthn.#s,service:WebAuthn.#n,headers:WebAuthn.#a}}static async#c(){if(!io?.greenscreens?.WebAuthnController)return Engine.init(WebAuthn.#o)}static async#l(e,t=!1,s){return await WebAuthn.#c(),await io.greenscreens.WebAuthnController[e](s,t)}static async#d(e){const t=(await WebAuthn.#l('register',!1,e)).data,s=WebAuthn.#r(t.challenge),n=WebAuthn.#r(t.uid),a={publicKey:{rp:{name:t.rp,id:location.hostname},challenge:s,user:{id:n,name:t.name,displayName:t.displayName},pubKeyCredParams:[{type:'public-key',alg:-7},{type:'public-key',alg:-257},{type:'public-key',alg:-41}],attestation:'direct',timeout:6e4,excludeCredentials:[],extensions:{},authenticatorSelection:{requireResidentKey:!1,userVerification:'preferred'}}},r=await navigator.credentials.create(a);if(null==r)throw new Error('Credential not found!');const i={uid:t.uid,id:r.id,rawId:WebAuthn.#i(r.rawId),attestationObject:WebAuthn.#i(r.response.attestationObject),clientDataJSON:WebAuthn.#i(r.response.clientDataJSON)};return await WebAuthn.#l('register',!0,i)}static async#u(e,t){const s=(await WebAuthn.#l(e,!1,t)).data,n=WebAuthn.#r(s.challenge),a=[];if('test'===e&&0===s.uid.length)throw new Error('Invalid credentials!');s.uid.every((e=>{const t={type:'public-key',id:WebAuthn.#r(e)};return a.push(t),!0}));const r={challenge:n,rpId:location.hostname,userVerification:'preferred',timeout:6e4,allowCredentials:a,extensions:{uvm:!0,loc:!1,txAuthSimple:'Could you please verify yourself?'}},i=await navigator.credentials.get({publicKey:r});if(null==i)throw new Error('Credential not found!');const o={id:i.id,rawId:WebAuthn.#i(i.rawId),authenticatorData:WebAuthn.#i(i.response.authenticatorData),clientDataJSON:WebAuthn.#i(i.response.clientDataJSON),signature:WebAuthn.#i(i.response.signature),userHandle:WebAuthn.#i(i.response.userHandle)};return await WebAuthn.#l(e,!0,o)}static register(e){return WebAuthn.#d(e)}static authenticate(e){return WebAuthn.#u('authenticate',e)}static update(e){return WebAuthn.#u('update',e)}static unregister(e){return WebAuthn.#u('unregister',e)}static test(e){return WebAuthn.#u('test',e)}}class GSAdminDialog extends a{connectedCallback(){super.connectedCallback();this.cssHeader='p-3 dialog-title'}get dialogTemplate(){return''}get dialogTitle(){return''}async onBeforeReady(){await super.onBeforeReady();const t=this;t.on('data',t.#g.bind(t)),t.on('error',t.#m.bind(t)),t.on('open',t.#p.bind(t));const s=await r.getTemplate(t.dialogTemplate);await i.waitAnimationFrame((async()=>{e.setHTML(t,s),t.title=t.dialogTitle,await GSUtil.timeout(200)}))}onReady(){this.auto&&this.open(),super.onReady()}get auto(){return o.getAsBool(this,'auto',!0)}get waiter(){return t.get('modal-waiter')}get notify(){return t.get('notification')}get form(){return e.query(this,'form')}open(e){this.form?.reset(),this.#h(e),super.open(e)}async onOpen(e){return e}async onData(e){return!0}async#p(t){const s=this,n=await s.onOpen(e.toObject(s.form));!1===n?i.prevent(t):s.#h(n)}#h(t){if('object'==typeof t){const s=this;e.queryAll(s,'form').forEach((s=>e.fromObject(s,t))),i.send(s,'change')}}#m(e){u.inform(!1,'Some fields are invalid!')}async#g(e){i.prevent(e);const t=this;let s=!1;try{t.disable(),s=await t.onData(e.detail.data)}catch(e){u.handleError(e)}finally{t.enable(),s&&t.close()}}onError(e){u.handleError(e)}}globalThis.Tn5250={version:'6.0.0.300',build:'25.07.2023.',release:20230725};class Login extends GSAdminDialog{static{customElements.define('gs-admin-shell-login',Login),Object.seal(Login)}static#a={'x-type':'admin'};static#y={uuid:'ADMIN',host:'ADMIN',user:'ADMIN'};static#f=`${location.origin}/services/api?q=/rpc`;static#w=`${location.origin}/services/rpc`;static#b=`${location.origin}/services/api?q=/wsadmin`;static#S=`${location.origin}/services/wsadmin`.replace('http','ws');static#v=`${location.origin}/services/auth`;#c=null;connectedCallback(){super.connectedCallback();const e=this;e.cancelable=!1,e.align='center',e.cssTitle='d-flex justify-content-center w-100'}get dialogTemplate(){return'//shell/login.html'}get dialogTitle(){return`<img src="${globalThis.GSC?.logoUrl||'../assets/img/logo.png'}" alt="..." height="30" width="180">`}get#E(){return this.query('input[name="otp"]')}get#O(){return this.query('input[name="password"]')}async onOpen(){const e=this;return e.#D(),u.unsetUI('gs-admin-shell'),DEMO?e.#M(!1):(await s.timeout(5),await e.#G(),e.#c=await e.#A(),e.#T(),!0)}async onData(e){const t=this;if(globalThis.DEMO)return t.#I(),!0;try{t.#M(!0);const s=Object.assign(e,Login.#y);await io.greenscreens.AdminController.login(s)}catch(e){throw t.onOpen(),e}t.#R()}async#T(){const e=this;if(!e.#C)return;const t={appID:0,ipAddress:Tn5250.opt.ip},s=Object.assign(t,Login.#y);try{const t=await WebAuthn.authenticate(s);t.success&&(document.cookie='X-Authorization='+t.srl+'; path=/services/wsadmin'),e.#R()}catch(t){u.handleError(t),e.#x&&location.reload()}}async#R(){const e=this;return e.#c?.stop(),e.#c=await e.#U(),e.#c.SocketChannel.on('offline',(t=>{u.handleError(t),e.#c?.stop(),location.reload()})),e.#I(),!0}get#C(){return Tn5250?.opt?.fido}get#k(){return Tn5250?.opt?.otp}get#x(){return this.#C&&!this.#k}#D(){'DEMO'in globalThis||(globalThis.DEMO='function'!=typeof Engine)}#M(t=!1){e.queryAll(this,'input, button').forEach((e=>o.toggle(e,'disabled',t))),e.query(this,'input').focus()}async#G(){delete globalThis.io;const t=await fetch(Login.#v);if(!t.ok)return!1;const s=globalThis.Tn5250.opt=await t.json();globalThis.Tn5250.opt=s;const n=this;o.toggle(n.#E,'disabled',!s.otp),o.toggle(n.#O,'disabled',!s.otp),e.toggleClass(n.#E,'d-none',!s.otp),n.#x&&(n.closable=!1,n.body.parentElement.innerHTML='<div class="m-3 text-center fs-5">Use security key to access Web Admin console.</div>')}async#A(){return this.#F(Login.#f,Login.#w)}async#U(){return this.#F(Login.#b,Login.#S)}async#F(e,t){return delete globalThis.io,this.#c=null,Engine.init({api:e,service:t,headers:Login.#a})}#I(){this.#j(),u.setUI('gs-admin-shell')}#j(){u.unsetUI('gs-admin-shell-login'),u.unsetUI('gs-admin-shell')}}class SidebarUI extends c{static{customElements.define('gs-admin-shell-sidebar',SidebarUI),Object.seal(SidebarUI)}async getTemplate(){return super.getTemplate('//shell/sidebar.html')}onReady(){super.onReady()}}class HeaderUI extends c{static{customElements.define('gs-admin-shell-header',HeaderUI),Object.seal(HeaderUI)}async getTemplate(){return super.getTemplate('//shell/header.html')}onReady(){super.onReady();const e=this;e.on('action',e.#P.bind(e)),e.queryAll('gs-dropdown').forEach((t=>e.attachEvent(t,'action',e.#P.bind(e))))}async#P(e){const t=this;try{const a=e?.detail?.action||e?.detail?.source?.target?.dataset?.action,r=s.capitalizeAttr(a),i=t[r];n.isFunction(i)&&(n.isFunctionAsync(i)?await t[r](e):t[r](e))}catch(e){u.handleError(e)}}get notify(){return t.get('notification')}async logout(){try{u.unsetUI('gs-admin-shell-login'),u.unsetUI('gs-admin-shell');return(DEMO||await io.greenscreens.Session.closeSession()).success}finally{location.reload()}}async restart(){const e=DEMO||await io.greenscreens.Server.restart();u.inform(e.success,'Server is restarting! <br>Wait about 1min. then refresh browser.')}async certClientVerify(){const e=(DEMO||await io.greenscreens.Certificate.verifySSLClient(2)).msg||'Client SSL verification changed.';u.inform(!0,e+'<br>Restart server to apply changes.')}async certGenTerm(){'RSA'===(DEMO||await io.greenscreens.Server.regenerate()).code&&u.inform(!0,'New encryption keys generated')}async certGenReq(){const e=DEMO||await io.greenscreens.Certificate.request(!0);u.download('server_request.txt',e.data.requestPem),u.download('server_private.txt',e.data.privatePem)}async certGenSvr(){confirm('Are you sure? Action will overwrite existnig certificate.')&&(DEMO||await io.greenscreens.Certificate.generate(!0),u.inform(!0,'New server certificate generated! <br> Please, restart server for changes to apply.'))}certExport(){u.openInNewTab(`${location.origin}/services/certificate?id=0`),u.openInNewTab(`${location.origin}/services/certificate?id=1`)}explorer(){u.openInNewTab(`${location.origin}/admin/explorer`,'toolbar=no,scrollbars=yes,resizable=yes')}downloadConfig(){u.openInNewTab(`${location.origin}/services/admintransfer?type=conf`)}downloadLogs(){u.openInNewTab(`${location.origin}/services/admintransfer?type=log`)}}class ShellUI extends c{static{customElements.define('gs-admin-shell',ShellUI),Object.seal(ShellUI)}async getTemplate(){return super.getTemplate('//shell.html')}onReady(){super.onReady();const e=this;e.GSC?.company&&e.company&&(e.company.innerHTML=e.GSC.company)}get company(){return this.getByID('company')}get GSC(){return globalThis.GSC}}class GSSearch extends c{static{customElements.define('gs-search',GSSearch),Object.seal(GSSearch)}async getTemplate(){const e=this;return`\n        <div class="input-group ${e.css}">\n            <i class="input-group-text ${e.iconCSS}"></i>\n            <input type="search"  incremental="true" class="form-control ${e.inputCSS}" placeholder="${e.placeholder}" name="${e.name}">\n        </div>        \n        `}onReady(){const e=this;l.isWebkit?e.attachEvent(e.#L,'search',e.#B.bind(e)):e.attachEvent(e.#L,'keydown',e.#B.bind(e)),super.onReady()}#B(e){if(!l.isWebkit&&13!=e.which)return;i.prevent(e);const t={type:'search',action:'search',value:this.#L.value};i.send(this,'action',t,!0,!0,!0)}get#L(){return this.query('input')}get css(){return o.get(this,'css','')}set css(e=''){return o.set(this,'css',e)}get iconCSS(){return o.get(this,'css-icon','bg-white bi bi-search')}set iconCSS(e=''){return o.set(this,'css-icon',e)}get inputCSS(){return o.get(this,'css-input','border-start-0')}set inputCSS(e=''){return o.set(this,'css-input',e)}get placeholder(){return o.get(this,'placeholder','search')}set placeholder(e=''){return o.set(this,'placeholder',e)}get name(){return o.get(this,'name','search')}set name(e=''){return o.set(this,'name',e)}}class BaseViewUI extends c{constructor(){super(),this.className='d-flex flex-fill'}onReady(){const e=this;super.onReady(),globalThis.GS_LOG_ACTION=!0,i.monitorAction(e,'view'),e.attachEvent(e.#V,'filter',(t=>e.onViewRefresh())),requestAnimationFrame((()=>e.onViewRefresh()))}get recID(){return'id'}get filter(){const e=this.#V?.store.filter||[],t={};return e.forEach((e=>t[e.name]=e.value)),t}get store(){return this.#V?.store}get#V(){return this.query('#table-main')}get form(){return e.query(this.modal,'#form-main')}get waiter(){return t.get('modal-waiter')}get modal(){return this.query('#modal-main')}async onViewExport(){const e=this.tagName.toLowerCase(),t=this.store.data;s.export([JSON.stringify(t)],`${e}.json`)}async onViewClone(e){const t=this,s=e.detail.data[0];if(!s)return;const n=Object.assign({},s);try{if(!await t.onClone(n))throw new Error('Record not cloned!');t.store.setData(n,!0),u.notify.secondary('','Record cloned!'),t.onViewRefresh()}catch(e){t.onError(e)}}async onViewRemove(e){const t=this,s=e.detail.data[0];if(s)try{if(!await t.onRemove(s))throw new Error('Record not removed!');const e=t.store.data.filter((e=>!e.hasOwnProperty(t.recID)||e[t.recID]!==s[t.recID]));t.store.setData(e),u.notify.danger('','Record removed!')}catch(e){t.onError(e)}}async onViewDetails(t){const s=this,n=await s.onDetails(t.detail.data[0]);if(!n)return;s.form?.reset(),e.fromObject(s.form,n),s.modal.open(n);const a=await s.modal.waitEvent('data');try{if(!await s.onUpdate(a.data))throw new Error('Record not updated!');Object.assign(n,a.data),s.store.reload(),u.notify.warn('','Record updated!')}catch(t){s.onError(t)}}async onViewCreate(e){const t=this;t.form?.reset(),t.modal.open();const s=await t.modal.waitEvent('data');try{if(!await t.onCreate(s.data))throw new Error('Record not created!');u.notify.primary('','Record created!'),t.onViewRefresh()}catch(e){t.onError(e)}}async onViewRefresh(e){const t=this,s=await t.onLoad(e);t.store&&requestAnimationFrame((()=>{try{Array.isArray(s)&&s.length>0?t.store.setData(s):t.store.reload()}catch(e){t.onError(e)}}))}onViewSearch(e){this.store.filter=e.detail.value}onError(e){u.handleError(e)}async onDetails(e){return e}async onCreate(e){return!0}async onClone(e){return!0}async onUpdate(e){return!0}async onRemove(e){return!0}async onLoad(e){return!1}}class GSConfiguration extends BaseViewUI{static{customElements.define('gs-admin-view-configuration',GSConfiguration),Object.seal(GSConfiguration)}onReady(){super.onReady();const e=this;requestAnimationFrame((async()=>{await s.timeout(1e3),e.#h()}))}#h(){const e=this.query('gs-context');this.#W?(e?.self?.querySelector('[data-action="license"]')?.remove(),e?.self?.querySelector('[data-action="install"]')?.remove()):e?.self?.querySelector('[data-action="activate"]')?.remove()}get#W(){return 1==Tn5250?.opt?.lic}async getTemplate(){return super.getTemplate('//views/configurations.html')}get activateDialog(){return t.get('modal-activate')}get installDialog(){return t.get('modal-install')}get licenseDialog(){return t.get('modal-license')}get printerReset(){return t.get('modal-reset')}get printerSetup(){return t.get('modal-setup')}get validate(){return t.get('modal-validate')}async onLoad(e){return(DEMO||await io.greenscreens.Hosts.list(!1)).data}async onCreate(e){return(DEMO||await io.greenscreens.Hosts.setHost(e)).success}async onUpdate(e){return(DEMO||await io.greenscreens.Hosts.setHost(e)).success}async onRemove(e){return(DEMO||await io.greenscreens.Hosts.unsetHost(e)).success}async onClone(e){return(DEMO||await io.greenscreens.Hosts.cloneConfig(e)).success}onViewResetPrinter(e){const t=e.detail.data[0];this.printerReset.open(t)}onViewSetupPrinter(e){const t=e.detail.data[0];this.printerSetup.open(t)}onViewActivate(e){const t=e.detail.data[0];this.activateDialog.open(t)}onViewInstall(e){const t=e.detail.data[0];this.installDialog.open(t)}onViewLicense(e){const t=e.detail.data[0];this.licenseDialog.open(t)}async onViewValidateServer(e){const t=this;t.waiter.open();try{const s=e.detail.data[0],n=`<pre>${(DEMO||await io.greenscreens.Hosts.validate(s)).msg}</pre>`;t.validate.confirm('Validate',n)}finally{t.waiter.close()}}}class GSTunnel extends BaseViewUI{static{customElements.define('gs-admin-view-tunnel',GSTunnel),Object.seal(GSTunnel)}async getTemplate(){return super.getTemplate('//views/tunnel.html')}async onLoad(){const e=this,t=e.filter;return(DEMO||await io.greenscreens.Proxy.list(e.store.page,e.store.limit,t)).data}async onCreate(e){return(DEMO||await io.greenscreens.Proxy.save(e)).success}async onClone(e){delete e.id,e.name=`${e.name} - ${Date.now()}`;return(DEMO||await io.greenscreens.Proxy.save(e)).success}async onUpdate(e){return(DEMO||await io.greenscreens.Proxy.save(e)).success}async onRemove(e){return(DEMO||await io.greenscreens.Proxy.remove(e.id)).success}async onViewSstart(e){const t=e.detail.data[0],s=DEMO||await io.greenscreens.Proxy.start(t.id);u.inform(s.success,'Tunnel started')}async onViewStop(e){const t=e.detail.data[0],s=DEMO||await io.greenscreens.Proxy.stop(t.id);u.inform(s.success,'Tunnel stopped')}async onViewRestart(e){const t=e.detail.data[0],s=DEMO||await io.greenscreens.Proxy.restart(t.id);u.inform(s.success,'Tunnel restarted')}async onViewDownload(e){const t=e.detail.data[0],s=DEMO||await io.greenscreens.Proxy.download(t.id),n=['auto: true','mode: cloud','cloud: '+location.origin,'token: '+s.code,'tls: 1','tlsVerify: true'];u.download(t.name+'.bin',u.fromHex(s.msg)),u.download('server.config',n.join('\n'))}}class GSCustomization extends BaseViewUI{static{customElements.define('gs-admin-view-customization',GSCustomization),Object.seal(GSCustomization)}async getTemplate(){return super.getTemplate('//views/customizations.html')}async onLoad(){const e=this,t=DEMO||await io.greenscreens.Scripts.getScripts();e.header.value=t.data?.header||'',e.footer.value=t.data?.footer||'',e.ui.value=t.data?.ui||''}async save(){const e=this;try{const t=DEMO||await io.greenscreens.Scripts.setScripts(e.header.value,e.footer.value,e.ui.value);u.inform(t.success,'Data saved!')}catch(e){u.handleError(e)}}get header(){return this.query('#header')}get footer(){return this.query('#footer')}get ui(){return this.query('#ui')}}class GSFilterFido extends BaseViewUI{static{customElements.define('gs-admin-view-filterfido',GSFilterFido),Object.seal(GSFilterFido)}async getTemplate(){return super.getTemplate('//views/filter-fido.html')}async onReady(){super.onReady();const e=this;e.modal.large();try{const t=DEMO||await io.greenscreens.Fido.isActive();e.switcher.selectedIndex=parseInt(t.code,10)}finally{e.attachEvent(e.switcher,'change',e.#q.bind(e))}}get switcher(){return this.query('select[name="filter"]')}async#q(e){try{const t=parseInt(e.target.value,10);DEMO||await io.greenscreens.Fido.activity(t)}catch(e){u.handleError(e)}}async onLoad(){const e=this,t=e.filter;return(DEMO||await io.greenscreens.Fido.list(e.store.page-1,e.store.limit,t)).data}async onCreate(e){return(DEMO||await io.greenscreens.Fido.set(e)).success}async onUpdate(e){return(DEMO||await io.greenscreens.Fido.set(e)).success}async onRemove(e){return(DEMO||await io.greenscreens.Fido.remove(e.id)).success}}class GSFilterIP extends BaseViewUI{static{customElements.define('gs-admin-view-filterip',GSFilterIP),Object.seal(GSFilterIP)}async onReady(){super.onReady();const e=this;e.modal.large();try{const t=DEMO||await io.greenscreens.Filter.isActive();e.switcher.selectedIndex=parseInt(t.code,10)}finally{e.attachEvent(e.switcher,'change',e.#q.bind(e))}}get switcher(){return this.query('select[name="filter"]')}async#q(e){try{const t=parseInt(e.target.value,10);DEMO||await io.greenscreens.Filter.activity(t)}catch(e){u.handleError(e)}}async getTemplate(){return super.getTemplate('//views/filter-ip.html')}async onLoad(){const e=this,t=e.filter;return(DEMO||await io.greenscreens.Filter.list(e.store.page-1,e.store.limit,t)).data}async onCreate(e){return(DEMO||await io.greenscreens.Filter.set(e)).success}async onUpdate(e){return(DEMO||await io.greenscreens.Filter.set(e)).success}async onRemove(e){return(DEMO||await io.greenscreens.Filter.remove(e.id)).success}}class GSFilterMobile extends BaseViewUI{static{customElements.define('gs-admin-view-filtermobile',GSFilterMobile),Object.seal(GSFilterMobile)}async onReady(){super.onReady();const e=this;e.modal.large();try{const t=DEMO||await io.greenscreens.Mobile.isActive();e.switcher.selectedIndex=parseInt(t.code,10)}finally{e.attachEvent(e.switcher,'change',e.#q.bind(e))}}get switcher(){return this.query('select[name="filter"]')}async#q(e){try{const t=parseInt(e.target.value,10);DEMO||await io.greenscreens.Mobile.activity(t)}catch(e){u.handleError(e)}}async getTemplate(){return super.getTemplate('//views/filter-mobile.html')}async onLoad(){const e=this,t=e.filter;return(DEMO||await io.greenscreens.Mobile.list(e.store.page-1,e.store.limit,t)).data}async onCreate(e){return(DEMO||await io.greenscreens.Mobile.set(e)).success}async onUpdate(e){return(DEMO||await io.greenscreens.Mobile.set(e)).success}async onRemove(e){return(DEMO||await io.greenscreens.Mobile.remove(e.id)).success}}class GSApiKeys extends BaseViewUI{static{customElements.define('gs-admin-view-apikeys',GSApiKeys),Object.seal(GSApiKeys)}onReady(){super.onReady(),this.modal.large()}async getTemplate(){return super.getTemplate('//views/keys-api.html')}async onLoad(){const e=this,t=e.filter;return(DEMO||await io.greenscreens.ApiKeys.list(e.store.page-1,e.store.limit,t)).data}async onCreate(e){return(DEMO||await io.greenscreens.ApiKeys.add(e)).success}async onUpdate(e){return(DEMO||await io.greenscreens.ApiKeys.update(e.id,e)).success}async onRemove(e){return(DEMO||await io.greenscreens.ApiKeys.remove(e.id)).success}onViewToggle(e){const t=e.detail.data[0];if(!t)return Utils.inform(!1,'Record not selected!');t.active=!t.active;this.onUpdate(t),this.onViewRefresh()}}class GSOtp extends BaseViewUI{static{customElements.define('gs-admin-view-otp',GSOtp),Object.seal(GSOtp)}onReady(){super.onReady(),this.modal.large()}async getTemplate(){return super.getTemplate('//views/keys-otp.html')}async onLoad(){const e=this,t=e.filter;return(DEMO||await io.greenscreens.OAuth.list(e.store.page-1,e.store.limit,t)).data}async onUpdate(e){return(DEMO||await io.greenscreens.OAuth.update(e.id,e.active)).success}async onRemove(e){return(DEMO||await io.greenscreens.OAuth.remove(e.id)).success}onViewToggle(e){const t=e.detail.data[0];if(!t)return u.inform(!1,'Record not selected!');t.active=!t.active;this.onUpdate(t),this.onViewRefresh()}}class GSBiometrics extends BaseViewUI{static{customElements.define('gs-admin-view-biometrics',GSBiometrics),Object.seal(GSBiometrics)}async getTemplate(){return super.getTemplate('//views/keys-bio.html')}async onLoad(){const e=this,t=e.filter;return(DEMO||await io.greenscreens.WebAuth.list(e.store.page-1,e.store.limit,t)).data}async onRemove(e){return(DEMO||await io.greenscreens.WebAuth.remove(e)).success}}class GSPrinting extends BaseViewUI{static{customElements.define('gs-admin-view-printing',GSPrinting),Object.seal(GSPrinting)}async getTemplate(){return super.getTemplate('//views/printing.html')}async onLoad(){const e=this,t=e.filter;return(DEMO||await io.greenscreens.Printers.list(e.store.page-1,e.store.limit,t)).data}async onCreate(e){this.#N(e);return(DEMO||await io.greenscreens.Printers.set(e)).success}async onUpdate(e){this.#N(e);return(DEMO||await io.greenscreens.Printers.set(e)).success}async onRemove(e){return(DEMO||await io.greenscreens.Printers.remove(e.id)).success}#N(e){e.uuid=e.uuid.toUpperCase(),e.host=e.host.toUpperCase(),e.outq=(e.outq||'').toUpperCase(),e.library=(e.library||'').toUpperCase(),e.userName=(e.userName||'').toUpperCase(),e.spoolName=(e.spoolName||'').toUpperCase()}}class GSScheduler extends BaseViewUI{#$={'':0,true:1,false:2};static{customElements.define('gs-admin-view-scheduler',GSScheduler),Object.seal(GSScheduler)}async getTemplate(){return super.getTemplate('//views/schedulers.html')}async onLoad(){const e=this,t=e.filter,s=t.type?parseInt(t.type,10):null,n=e.#$[t.status]||0;return(DEMO||await io.greenscreens.Scheduler.list(e.store.page-1,e.store.limit,s,n)).data}async onCreate(e){return(DEMO||await io.greenscreens.Scheduler.save(e)).success}async onUpdate(e){return(DEMO||await io.greenscreens.Scheduler.save(e)).success}async onRemove(e){return(DEMO||await io.greenscreens.Scheduler.remove(e.id)).success}async onViewRun(e){const t=e.detail.data[0],s=DEMO||await io.greenscreens.Scheduler.runNow(t.id);u.inform(s.success,'Task started!'),this.onViewRefresh()}}class GSUsers extends BaseViewUI{static{customElements.define('gs-admin-view-users',GSUsers),Object.seal(GSUsers)}async getTemplate(){return super.getTemplate('//views/users.html')}async onLoad(){const e=this,t=e.filter;return(DEMO||await io.greenscreens.Users.list(e.store.page-1,e.store.limit,t)).data}async onCreate(e){this.#N(e);return(DEMO||await io.greenscreens.Users.save(e)).success}async onUpdate(e){this.#N(e);return(DEMO||await io.greenscreens.Users.save(e)).success}async onClone(e){delete e.id;return(DEMO||await io.greenscreens.Users.save(e)).success}async onRemove(e){return(DEMO||await io.greenscreens.Users.remove(e.id)).success}async onViewCommit(e){const t=this;t.waiter.open();try{const e=DEMO||await io.greenscreens.Users.commit();u.inform(e.success,'Sync with database ok!')}finally{t.waiter.close()}}async onViewResync(e){const t=this;t.waiter.open();try{const e=DEMO||await io.greenscreens.Users.resync();u.inform(e.success,'Sync from storage started!')}finally{t.waiter.close()}}#N(e){e.confid=parseInt(e.confid||0),e.devtype=parseInt(e.devtype||0),e.driver=parseInt(e.driver||0),e.drawer1=parseInt(e.drawer1||-1),e.drawer2=parseInt(e.drawer2||-1),e.enhanced=parseInt(e.enhanced||0),e.uuid=(e.uuid||'').toUpperCase(),e.host=(e.host||'').toUpperCase(),e.user=(e.user||'').toUpperCase(),e.display=(e.display||'').toUpperCase(),e.outq=(e.outq||'').toUpperCase(),e.program=(e.program||'').toUpperCase(),e.printer=e.printer||'Default'}}(class GSWorkstations extends BaseViewUI{static{customElements.define('gs-admin-view-services',GSWorkstations),Object.seal(GSWorkstations)}async getTemplate(){return super.getTemplate('//views/services.html')}async onLoad(){return(DEMO||await io.greenscreens.Tweaks.list()).data}});class GSWorkstations extends BaseViewUI{static{customElements.define('gs-admin-view-workstations',GSWorkstations),Object.seal(GSWorkstations)}#H={};async getTemplate(){return super.getTemplate('//views/workstations.html')}async onLoad(){const e=this,t=e.filter;return(DEMO||await io.greenscreens.Manage.listSessions(e.store.page-1,e.store.limit,t)).data}async onViewMessage(e){const t=prompt('Enter message to send');if(t?.trim().length>0)try{const s=e.detail.data[0];s.message=t;DEMO||await io.greenscreens.Manage.sendMessage(s.sessionID,s.deviceID,s.message);u.inform(!0,'Message sent!')}catch(e){u.handleError(e)}}async onViewLogging(e){try{const t=e.detail.data[0],s=DEMO||await io.greenscreens.Manage.loging(t);if('false'===s.msg){const e=location.origin+'/services/logs?id='+s.code;u.download('server.log',e)}}catch(e){u.handleError(e)}}async onViewKill(e){try{const t=e.detail.data[0];DEMO||await io.greenscreens.Manage.killDevice(t);u.inform(!0,'Kill signal sent!')}catch(e){u.handleError(e)}}async onViewMessageFilter(e){const t=prompt('Enter message to send');if(!(t?.trim().length>0))return;const s=this;try{Object.assign(s.filter).message=t;DEMO||await io.greenscreens.Manage.sendMessages(s.filter);u.inform(!0,'Message sent!')}catch(e){u.handleError(e)}}async onViewKillFilter(e){const t=this;try{DEMO||await io.greenscreens.Manage.killSessions(t.filter);u.inform(!0,'Kill signal sent!')}catch(e){u.handleError(e)}}async onViewExport(e){const t=this;try{const e=DEMO||await io.greenscreens.Manage.export(0,0,t.filter),s=JSON.stringify(e.data);u.download('workstations.json',s)}catch(e){u.handleError(e)}}disconnectedCallback(){super.disconnectedCallback();Object.values(this.#H).filter((e=>n.isFunction(e.close))).forEach((e=>e.close())),this.#H={}}onViewViewSession(e){if(DEMO)return u.inform(!1,'Not available in DEMO mode.');const t=this,s=e.detail.data[0];let a=t.#H[s.deviceID];if(a&&!a.closed)return;const r=`${location.origin}/terminal/?d=0&k=0`;a=u.openInNewTab(r,'target=blank,width=800,height=600,scrollbasrs=no,toolbar=no,titlebar=yes'),a.onclose=()=>delete t.#H[s.deviceID],n.isFunction(a.focus)&&a.focus();const i=setInterval((()=>{a.Tn5250&&(clearInterval(i),t.#H[s.deviceID]=a,a.document.title=`Terminal - ${s.uuid} - ${s.host} - ${s.display}`,t.#K(a,s),a.Tn5250.Keyboard.listen('command',((e,n,r,i)=>{'PF5'===i&&t.#K(a,s)})))}),1e3)}async#K(e,t){if(e?.Tn5250)try{const s=await io.greenscreens.Manage.getScreen(t.sessionID,t.deviceID);e.Tn5250.Application.test(e.Tn5250.Binary.fromHex(s.msg))}catch(e){}}}class GSWebmodules extends BaseViewUI{static{customElements.define('gs-admin-view-webmodules',GSWebmodules),Object.seal(GSWebmodules)}async getTemplate(){return super.getTemplate('//views/modules.html')}async onLoad(){return(DEMO||await io.greenscreens.WebModules.list()).data}async onViewStart(e){const t=e.detail.data[0],s=DEMO||await io.greenscreens.WebModules.start(t.name);u.inform(s.success,'Module started!'),this.onViewRefresh()}async onViewStop(e){const t=e.detail.data[0],s=DEMO||await io.greenscreens.WebModules.stop(t.name);u.inform(s.success,'Module stopped!'),this.onViewRefresh()}async onViewRestart(e){const t=e.detail.data[0],s=DEMO||await io.greenscreens.WebModules.restart(t.name);u.inform(s.success,'Module restarted!'),this.onViewRefresh()}}class GSAbout extends d{static#z='6.0.0.';static#_='20.10.2022. 15:00:00';static{customElements.define('gs-admin-dialog-about',GSAbout),Object.seal(GSAbout)}constructor(){super(),this.align='center'}onReady(){super.onReady();this.confirm(void 0,this.#X)}get version(){return globalThis.Tn5250?.opt?.version||GSAbout.#z}get build(){return globalThis.Tn5250?.opt?.build||GSAbout.#_}get#X(){return`\n        <div slot="body" class="text-center">\n            <div>Version : <span>${this.version}</span></div>\n            <div>Build : <span>${this.build}</span></div>\n        </div>\n        `}}class GSCertBlocked extends GSAdminDialog{static{customElements.define('gs-admin-dialog-certblocked',GSCertBlocked),Object.seal(GSCertBlocked)}get dialogTemplate(){return'//dialogs/certificates-blocked.html'}get dialogTitle(){return'Blocked Certificates'}async onOpen(){return{list:(DEMO||await io.greenscreens.Server.getBlocked()).msg}}async onData(e){return(DEMO||await io.greenscreens.Server.setBlocked(e.list)).success}}class GSCertClient extends GSAdminDialog{static{customElements.define('gs-admin-dialog-certclient',GSCertClient),Object.seal(GSCertClient)}get dialogTemplate(){return'//dialogs/certificates-client.html'}get dialogTitle(){return'Generate Client Certificates'}async onData(e){const t=DEMO||await io.greenscreens.Certificate.generateClient(e),s=Utils.fromHex(t.msg),n=new Uint8Array(s);return Utils.download(t.code,n),t.success}}(class GSCertImport extends GSAdminDialog{static{customElements.define('gs-admin-dialog-certimport',GSCertImport),Object.seal(GSCertImport)}onReady(){super.onReady(),this.large&&this.large()}get dialogTemplate(){return'//dialogs/certificates-import.html'}get dialogTitle(){return'Import Certificates'}async onData(e){return(DEMO||await io.greenscreens.Certificate.setFromPEM(e.rootCAPub,e.rootCAPriv,e.serverPub,e.serverPriv,e.rootPass,e.serverPass)).success}}),class GSCertImport extends GSAdminDialog{static{customElements.define('gs-admin-dialog-certimportpfx',GSCertImport),Object.seal(GSCertImport)}onReady(){super.onReady(),this.large&&this.large()}get dialogTemplate(){return'//dialogs/certificates-importpfx.html'}get dialogTitle(){return'Import Binary Certificate'}get input(){return GSDOM.query(this,'gs-filebox')?.query('input')}get file(){const e=this.input;return!(!e?.files?.length>0)&&e.files[0]}async pfx(){const e=await(this.file?.arrayBuffer());return btoa(new Uint8Array(e))}async onData(e){e.pfx=await this.pfx();return(DEMO||await io.greenscreens.Certificate.setFromPFX(e.pfx,e.password)).success}};class GSCertOpt extends GSAdminDialog{static{customElements.define('gs-admin-dialog-certopt',GSCertOpt),Object.seal(GSCertOpt)}onReady(){super.onReady(),this.large&&this.large()}get dialogTemplate(){return'//dialogs/certificates-options.html'}get dialogTitle(){return'Certificate Options'}async onOpen(){if(DEMO)return await r.loadSafe('./data/cert.json','GET',null,!0);return(DEMO||await io.greenscreens.Certificate.loadConfig()).data}async onData(e){return(DEMO||await io.greenscreens.Certificate.saveConfig(e)).success}}class GSLoginAdmin extends GSAdminDialog{static{customElements.define('gs-admin-dialog-loginadm',GSLoginAdmin),Object.seal(GSLoginAdmin)}get dialogTemplate(){return'//dialogs/login-admin.html'}get dialogTitle(){return'Admin Login'}async onOpen(){const e=DEMO||await io.greenscreens.Server.getConfig();return delete e.data.password,e.data}async onData(e){return(DEMO||await io.greenscreens.Session.newAuth(e)).success}}class GSLoginDefaults extends GSAdminDialog{static{customElements.define('gs-admin-dialog-logindefs',GSLoginDefaults),Object.seal(GSLoginDefaults)}get dialogTemplate(){return'//dialogs/login-defaults.html'}get dialogTitle(){return'Login Defaults'}async onOpen(){const e=DEMO||await io.greenscreens.Server.getDefaults();return delete e.data.password,e.data}async onData(e){return(DEMO||await io.greenscreens.Server.saveDefaults(e)).success}}class GSOtpOptions extends GSAdminDialog{static{customElements.define('gs-admin-dialog-otpopt',GSOtpOptions),Object.seal(GSOtpOptions)}get dialogTemplate(){return'//dialogs/otp-options.html'}get dialogTitle(){return'OTP Options'}async onOpen(){return(DEMO||await io.greenscreens.Server.getOtp()).data}async onData(e){return(DEMO||await io.greenscreens.Server.saveOTP(e)).success}}class GSRegisterBiometrics extends GSAdminDialog{static{customElements.define('gs-admin-dialog-bioreg',GSRegisterBiometrics),Object.seal(GSRegisterBiometrics)}connectedCallback(){super.connectedCallback();this.align='center',this.cancelable=!1}get dialogTemplate(){return'//dialogs/register-bio.html'}get dialogTitle(){return'Register Biometric'}async onOpen(){const e=this;if(DEMO)return u.inform(!1,'Not supported in DEMO mode!');if(!WebAuthn.isAllowed()){const t='FIDO2 allowed only on secured url <br>and valid domain name!';return e.body=t,u.inform(!1,t)}return!0}async onData(){const e={uuid:'ADMIN',host:'ADMIN',user:'ADMIN',appID:0};e.ipAddress=Tn5250.opt.ip;try{await WebAuthn.register(e);me.body='Biometric Web Admin login activated!'}catch(e){me.body=u.handleError(e)||'Biometric Web Admin login not activated!'}return!0}}class GSRegisterOtp extends GSAdminDialog{static#J='/barcode/generator?group=Two%20Dimensional&type=QR&composite=&zoom=4&format=png&eci=-1&attGS1=0&attQR1=&attQR2=3&b64=';static{customElements.define('gs-admin-dialog-otpreg',GSRegisterOtp),Object.seal(GSRegisterOtp)}constructor(){super();this.cancelable=!1,this.align='center'}get dialogTemplate(){return'//dialogs/register-otp.html'}get dialogTitle(){return'Register OTP'}get scratch(){return e.query(this,'#scratch')}get qrcode(){return e.query(this,'#qrcode')}get token(){return e.query(this,'#token')}getUrl(e){const t=self.btoa(e);return`${location.origin}${GSRegisterOtp.#J}${t}`}async onOpen(){if(DEMO)return u.inform(!1,'Nota available in DEMO!');const e=await io.greenscreens.OAuth.register();return this.#Q(e.data),this.#h(e.data),e.data}async onData(){return!0}#h(e){const t=this,s=t.getUrl(e.url);t.qrcode.parentElement.href=s,t.qrcode.src=s,t.qrcode.title=e.url,t.token.innerHTML=e.key.replaceAll('=',''),t.scratch.innerHTML=e.scratchCodes.join('&nbsp;')}#Q(e){const t=e.scratchCodes,s=['Green Screens Admin OTP Codes','\n\n','User : ',e.userName,'\n\n','Key : ',e.key.replaceAll('=',''),'\n\n','Recovery Keys : '];t.every((e=>(s.push(e),s.push(' '),!0))),u.download('Green_Screens_Admin_OTP.txt',s.join(''))}}class GSNetwork extends GSAdminDialog{static{customElements.define('gs-admin-dialog-network',GSNetwork),Object.seal(GSNetwork)}get dialogTemplate(){return'//dialogs/network.html'}get dialogTitle(){return'Netowrk Options'}async onOpen(){const e=DEMO||await io.greenscreens.Server.getInterface();return e.data.restart=e.data.restart?'1':'0',e.data}async onData(e){e.restart=1===parseInt(e.restart),e.redirect=1===parseInt(e.redirect),e.nodes=1===parseInt(e.nodes);return(DEMO||await io.greenscreens.Server.setInterface(e)).success}}class GSSystem extends GSAdminDialog{static{customElements.define('gs-admin-dialog-system',GSSystem),Object.seal(GSSystem)}onReady(){super.onReady(),this.large&&this.large()}get dialogTemplate(){return'//dialogs/system.html'}get dialogTitle(){return'System Options'}async onOpen(){return(DEMO||await io.greenscreens.Server.getConfig()).data}async onData(e){return(DEMO||await io.greenscreens.Server.setConfig(e)).success}async reloadKerberos(){return(DEMO||await io.greenscreens.Server.reloadKerberors()).success}}class GSWorkstation extends GSAdminDialog{static{customElements.define('gs-admin-dialog-workstation',GSWorkstation),Object.seal(GSWorkstation)}#Y=null;connectedCallback(){this.cssBody='NA',super.connectedCallback()}get dialogTemplate(){return null}get dialogTitle(){return'Workstation Info'}async onReady(){super.onReady(),this.#Y=await r.loadSafe('data/wks.json','GET',null,!0)}open(e){const t=this,s=['<div class="container p-2"><div class="row"><div class="col-xs-12"><table class="table border"><tbody>'],n=t.#Y.order.filter((e=>t.#Y.data[e])).map((s=>`<tr><td class="fw-bold w-25 text-bg-secondary">${t.#Y.data[s]}</td><td>${e[s]||''}</td></td>`)).join('');s.push(n),s.push('</tbody></table></div></div></div>'),t.body=s.join(''),super.open()}}class GSFilter extends GSAdminDialog{static#Z='((([0-9]{1,2})|(1[0-9]{2,2})|(2[0-4][0-9])|(25[0-5])|\\*)\\.){3}(([0-9]{1,2})|(1[0-9]{2,2})|(2[0-4][0-9])|(25[0-5])|\\*)';static#ee=[`^${GSFilter.#Z}$`,`^${GSFilter.#Z}/[0-9]{1,2}$`,`^${GSFilter.#Z}-${GSFilter.#Z}$`];static{customElements.define('gs-admin-dialog-filter',GSFilter),Object.seal(GSFilter)}onReady(){super.onReady();const e=this;e.large(),e.attachEvent(e,'change',e.#te.bind(e))}get dialogTemplate(){return'//forms/filter-ip.html'}get dialogTitle(){return'IP Filter'}get typeField(){return this.query('select[name=type]')}get valueField(){return this.query('input[name=value]')}#te(e){this.valueField.pattern=GSFilter.#ee[this.typeField.value]}async onOpen(e){return this.valueField.pattern=GSFilter.#ee[e.type],e}}class GSService extends GSAdminDialog{static{customElements.define('gs-admin-dialog-service',GSService),Object.seal(GSService)}onReady(){super.onReady(),this.large()}get dialogTemplate(){return'//dialogs/service.html'}get dialogTitle(){return'Service Module Property'}get valueField(){return this.query('input[name=value]')}open(e){const t=this;t.form?.reset(),t.valueField.type='text',t.valueField.classList.value='form-control',t.valueField.parentElement.classList.value='',s.isNumber(e.value)&&(t.valueField.type='number'),s.isBool(e.value)&&(t.valueField.type='checkbox',t.valueField.classList.value='form-check-input',t.valueField.parentElement.classList.value='form-check form-switch fs-5'),super.open(e)}async onData(e){const t=this,s=o.get(t.valueField,'type');'checkbox'===s&&(e.value=!0===t.valueField.checked),'number'===s&&(e.value=parseInt(e.value||0)||0);return(DEMO||await io.greenscreens.Tweaks.set(e.module,e.property,e.value)).success}}class GSPrinterReset extends GSAdminDialog{static{customElements.define('gs-admin-dialog-printer-reset',GSPrinterReset),Object.seal(GSPrinterReset)}#se=null;get dialogTemplate(){return'//dialogs/printer-reset.html'}get dialogTitle(){return'Printer Reset'}open(e){const t=this;t.#se=Object.assign({},e),t.#se.host=t.#se.name,super.open()}async onOpen(){return this.#se}async onData(e){const t=this;t.waiter.open();let s=!1;try{t.visible=!1;s=(DEMO||await io.greenscreens.Printer.reset(e)).success}catch(e){throw t.visible=!0,e}finally{t.waiter.close()}return s}}class GSPrinterSetup extends GSAdminDialog{static{customElements.define('gs-admin-dialog-printer-setup',GSPrinterSetup),Object.seal(GSPrinterSetup)}#se=null;get dialogTemplate(){return'//dialogs/printer-setup.html'}get dialogTitle(){return'Printer Setup'}get hpt(){return e.query(this,'select[name="hostTransform"]')}onReady(){super.onReady();const e=this;requestAnimationFrame((async()=>{await s.timeout(250),e.attachEvent(e.hpt,'change',e.#ne.bind(e))}))}open(e){const t=this;t.#se=Object.assign({},e),t.#se.host=t.#se.name,delete t.#se.drawer1,delete t.#se.drawer2,t.form.reset(),t.#h(!0),super.open()}async onOpen(){return this.#se}async onData(e){const t=this;t.waiter.open();let s=!1;try{t.visible=!1,e.hostTransform=1===parseInt(e.hostTransform);s=(DEMO||await io.greenscreens.Printer.setup(e)).success}catch(e){throw t.visible=!0,e}finally{t.waiter.close()}return s}#ne(e){this.#h('1'!==e.target.value)}#h(e){this.queryAll('[data-group="true"] input, [data-group="true"] select').forEach((t=>o.toggle(t,'disabled',e)))}}class GSActivate extends GSAdminDialog{static{customElements.define('gs-admin-dialog-activate',GSActivate),Object.seal(GSActivate)}get dialogTemplate(){return'//dialogs/activate.html'}get dialogTitle(){return'Add license key to the IBM i server'}async onOpen(e){return{ipAddress:e?.ipAddress||''}}async onData(e){return(DEMO||await io.greenscreens.Activator.activate(e)).success}}class GSInstall extends GSAdminDialog{static{customElements.define('gs-admin-dialog-install',GSInstall),Object.seal(GSInstall)}get dialogTemplate(){return'//dialogs/install.html'}get dialogTitle(){return'Install product to the IBM i server'}async onOpen(e){return{ipAddress:e?.ipAddress||''}}async onData(e){return(DEMO||await io.greenscreens.Installer.installProduct(e)).success}}class GSLicense extends GSAdminDialog{static{customElements.define('gs-admin-dialog-license',GSLicense),Object.seal(GSLicense)}get dialogTemplate(){return'//dialogs/license.html'}get dialogTitle(){return'Add license key to the IBM i server'}async onOpen(e){return{ipAddress:e?.ipAddress||''}}async onData(e){return(DEMO||await io.greenscreens.Installer.addProductLicense(e)).success}}class GSKerberos extends GSAdminDialog{static{customElements.define('gs-admin-dialog-kerberos',GSKerberos),Object.seal(GSKerberos)}onReady(){super.onReady(),this.large&&this.large()}get dialogTemplate(){return'//dialogs/kerberos.html'}get dialogTitle(){return'SSO Options'}async onOpen(){return(DEMO||await io.greenscreens.Kerberos.load()).data}async onData(e){return(DEMO||await io.greenscreens.Kerberos.save(e)).success}async onDialogReload(){return(DEMO||await io.greenscreens.Kerberos.reload()).success}}class GSMigrate extends GSAdminDialog{static{customElements.define('gs-admin-dialog-migrate',GSMigrate),Object.seal(GSMigrate)}get dialogTemplate(){return'//dialogs/migrate.html'}get dialogTitle(){return'Migrate Storage'}async onData(e){const t=DEMO||await io.greenscreens.Server.migrate(e.path),s=this;return t.success?setTimeout((()=>s.inform()),500):s.inform(),t.success}inform(){this.notify.primary('','Migration started, check server logs for details!')}}class GSCertImport extends GSAdminDialog{static{customElements.define('gs-admin-dialog-certstoreimport',GSCertImport),Object.seal(GSCertImport)}onReady(){super.onReady(),this.large&&this.large()}get dialogTemplate(){return'//dialogs/certificates-import-store.html'}get dialogTitle(){return'Import PFX/PEM Certificate Store'}get input(){return GSDOM.query(this,'gs-filebox')?.query('input')}get file(){const e=this.input;return!(!e?.files?.length>0)&&e.files[0]}get isPEM(){return this.isExt('.pem')}get isPFX(){return this.isExt('.pfx')}isExt(e){return this.file?.name.endsWith(e)}async fileToHex(){const e=await(this.file?.arrayBuffer());return u.toHex(e)}async onData(e){if(DEMO)return DEMO.success;const t=this;e.hex=await t.fileToHex();let s=!1;if(t.isPEM)s=await io.greenscreens.Certificate.loadFromPEM(e.hex,e.password,e.type);else{if(!t.isPFX)throw new Error('PEM or PFX file format supported!');s=await io.greenscreens.Certificate.loadFromPFX(e.hex,e.password,e.type)}return s.success}}
//# sourceMappingURL=io.greenscreens.admin.min.js.map
