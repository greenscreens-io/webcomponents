{"version":3,"file":"io.greenscreens.ipp.min.js","sources":["../modules/Utils.mjs","../modules/BaseView.mjs","../modules/IPPAttributes.mjs","../modules/IPPJobs.mjs","../modules/IPPView.mjs","../modules/IPPConsole.mjs"],"sourcesContent":["/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSDOM } from \"/webcomponents/release/esm/io.greenscreens.components.all.min.js\";\r\n\r\n\r\n/**\r\n * A module loading Utils class\r\n * @module Utils\r\n */\r\n\r\n/**\r\n * Helper class with shared utility functions\r\n * @class\r\n */\r\nexport class Utils {\r\n\r\n    static get notify() {\r\n        return GSDOM.query('gs-notification');\r\n    }\r\n\r\n    /**\r\n     * Used by inherited dialogs to show notification on remote data fetch\r\n     * \r\n     * @param {boolean} success Status message info/danger\r\n     * @param {string} msg Message t oshow\r\n     * @returns {boolean}\r\n     */\r\n    static inform(success = false, msg) {\r\n        if (success) return Utils.notify?.info('Info', msg);\r\n        Utils.notify?.danger('Error', msg);\r\n        return success;\r\n    }\r\n\r\n    static handleError(e) {\r\n        console.log(e);\r\n        const msg = e.data?.error || e.msg || e.message || e.toString();\r\n        Utils.inform(false, msg);\r\n        return msg;\r\n    }\r\n\r\n    static async load(url = '') {\r\n        const res = await fetch(url);\r\n        return await res.json();\r\n    }\r\n}","/*\r\n* Copyright (C) 2015, 2024 Green Screens Ltd.\r\n*/\r\n\r\n/**\r\n * A BaseView class used by all other views\r\n * @module ipp/BaseView\r\n */\r\nimport { GSEvents, GSElement } from \"/webcomponents/release/esm/io.greenscreens.components.all.min.js\";\r\n\r\nimport { Utils } from './Utils.mjs';\r\n\r\nexport class BaseView extends GSElement {\r\n\r\n    renderUI() {\r\n        return this.renderTemplate();\r\n    }\r\n\r\n    firstUpdated() {\r\n        super.firstUpdated();\r\n        GSEvents.monitorAction(this);\r\n    }\r\n\r\n    onError(e) {\r\n        Utils.handleError(e);\r\n    }\r\n\r\n}","/*\r\n* Copyright (C) 2015, 2024 Green Screens Ltd.\r\n*/\r\n\r\n/**\r\n * A module loading IPPPrinterAttributes class\r\n * \r\n * @module ipp/IPPPrinterAttributes\r\n */\r\n\r\nimport { GSElement } from \"/webcomponents/release/esm/io.greenscreens.components.all.min.js\";\r\n/**\r\n * IPPPrinterAttributes UI lists printer attributes\r\n */\r\n\r\n/**\r\n * IPPPrinterAttributes UI lists printer attributes\r\n */\r\nexport class IPPAttributes extends GSElement {\r\n\r\n    constructor() {\r\n        super();\r\n        this.template = '//ipp-printer-attributes.html';\r\n    }\r\n\r\n    renderUI() {\r\n        return this.renderTemplate();\r\n    }\r\n    \r\n    load(data) {\r\n        if (!data) return;\r\n        data = data['printer-attributes'] ||data;\r\n        const list = Object.entries(data).map(t => { return {key: t[0], value : t[1]} } );\r\n        // this.#table.data = list;\r\n        // uses gs-data-handler\r\n        this.#controller.store?.clear?.();\r\n        this.#controller.write(list);\r\n        this.#controller.read();\r\n    }\r\n\r\n    get #controller() {\r\n        return this.#table.dataController;\r\n    }\r\n\r\n    get #table() {\r\n        return this.query('gs-table', true);\r\n    }\r\n\r\n    static {\r\n        GSElement.define('gs-ipp-attributes', IPPAttributes);\r\n    }\r\n\r\n}","/*\r\n* Copyright (C) 2015, 2024 Green Screens Ltd.\r\n*/\r\n\r\n/**\r\n * A module loading IPPJobs class\r\n * \r\n * @module ipp/IPPJobs\r\n */\r\nimport { Utils } from './Utils.mjs';\r\nimport { BaseView } from './BaseView.mjs';\r\n\r\n/**\r\n * IPPJobs UI lists printer jobs and allows job manupulation actions\r\n */\r\nexport class IPPJobs extends BaseView {\r\n\r\n    constructor() {\r\n        super();\r\n        this.template = '//ipp-jobs.html';\r\n    }  \r\n\r\n    templateInjected() {\r\n        const me = this;\r\n        me.#jobsTable.on('select', me.onDetails.bind(me));\r\n    }\r\n\r\n    load(data) {\r\n        if (!data) return;\r\n        const me = this;        \r\n        me.#attrTable.data = [];\r\n        if (data.jobs) {\r\n            this.#loadData(this.#jobsTable, data.jobs);\r\n        }  else {\r\n            me.#loadAttr(data);\r\n        }\r\n    }\r\n    \r\n    #loadAttr(data) {\r\n        if (!data) return;\r\n        data = data['job-attributes'] ||data;\r\n        const list = Object.entries(data).map(t => { return {key: t[0], value : t[1]} } );\r\n        this.#loadData(this.#attrTable, list);\r\n    }\r\n\r\n    #loadData(table, data) {\r\n        const controller = table.dataController;\r\n        controller.store?.clear?.();\r\n        controller.write(data);\r\n        controller.read();\r\n    }\r\n\r\n    get #jobsTable() {\r\n        return this.query('#table-jobs', true);\r\n    }\r\n\r\n    get #attrTable() {\r\n        return this.query('#table-job-attributes', true);\r\n    }\r\n\r\n    onCancelJob(e) {\r\n\r\n    }\r\n    \r\n    onPrintUri(e) {\r\n\r\n    }\r\n\r\n    onPurgeJobs(e) {\r\n        this.#jobsTable.data = [];\r\n    }\r\n\r\n    async onDetails(e) {\r\n        const jobs = await Utils.load('./data/job-attributes.json');\r\n        this.load(jobs);\r\n    }\r\n\r\n    async onRefresh(e) {\r\n        const jobs = await Utils.load('./data/jobs.json');\r\n        this.load(jobs);\r\n    }\r\n\r\n    static {\r\n        BaseView.define('gs-ipp-jobs', IPPJobs);\r\n    }\r\n\r\n}","/*\r\n* Copyright (C) 2015, 2024 Green Screens Ltd.\r\n*/\r\n\r\n/**\r\n * A module loading IPPView class\r\n * @module ipp/IPPView\r\n */\r\nimport { Utils } from './Utils.mjs';\r\nimport { BaseView } from './BaseView.mjs';\r\n\r\nexport class IPPView extends BaseView {\r\n\r\n    constructor() {\r\n        super();\r\n        this.template = '//ipp-view.html';\r\n    }\r\n\r\n    get #attributes() {\r\n        return this.query('gs-ipp-attributes', true);\r\n    }\r\n\r\n    get #jobs() {\r\n        return this.query('gs-ipp-jobs', true);\r\n    }\r\n\r\n    get uri() {\r\n        return this.query('#printerURI')?.value || '';\r\n    }\r\n\r\n    async onRegister() {\r\n        this.onRefresh();\r\n    }\r\n\r\n    async onRefresh() {\r\n        const me = this;\r\n        const data = await Utils.load('./data/printer-attributes.json');\r\n        me.#attributes.load(data);\r\n\r\n        const jobs = await Utils.load('./data/jobs.json');\r\n        me.#jobs.load(jobs);\r\n    }\r\n\r\n    static {\r\n        BaseView.define('gs-ipp-view', IPPView);\r\n    }\r\n\r\n}","/*\r\n* Copyright (C) 2015, 2024 Green Screens Ltd.\r\n*/\r\n\r\n/**\r\n * A module loading IPPConsole class\r\n * \r\n * @module ipp/IPPConsole\r\n */\r\nimport { GSElement } from \"/webcomponents/release/esm/io.greenscreens.components.all.min.js\";\r\n\r\n/**\r\n * IPPJobs UI lists printer jobs and allows job manupulation actions\r\n */\r\nexport class IPPConsole extends GSElement {\r\n\r\n    constructor() {\r\n        super();\r\n        this.template = '//ipp-console.html';\r\n    }\r\n    \r\n    renderUI() {\r\n        return this.renderTemplate();\r\n    }    \r\n\r\n    log(data = '') {\r\n        this.#console.content = JSON.stringify(data, '', 4);\r\n    }\r\n\r\n    get #console() {\r\n        return this.query('gs-highlight', true);\r\n    }\r\n\r\n    static {\r\n        GSElement.define('gs-ipp-console', IPPConsole);\r\n    }\r\n\r\n}"],"names":["Utils","notify","GSDOM","query","static","success","msg","info","danger","e","data","error","message","toString","inform","url","res","fetch","json","BaseView","GSElement","renderUI","this","renderTemplate","firstUpdated","super","GSEvents","monitorAction","onError","handleError","IPPAttributes","constructor","template","load","list","Object","entries","map","t","key","value","controller","store","clear","write","read","table","dataController","define","IPPJobs","templateInjected","me","jobsTable","on","onDetails","bind","attrTable","jobs","loadData","loadAttr","onCancelJob","onPrintUri","onPurgeJobs","async","IPPView","attributes","uri","onRefresh","IPPConsole","log","console","content","JSON","stringify"],"mappings":"sHAgBO,MAAMA,MAEEC,oBACP,OAAOC,EAAMC,MAAM,kBACtB,CASDC,cAAcC,GAAU,EAAOC,GAC3B,OAAID,EAAgBL,MAAMC,QAAQM,KAAK,OAAQD,IAC/CN,MAAMC,QAAQO,OAAO,QAASF,GACvBD,EACV,CAEDD,mBAAmBK,GAEf,MAAMH,EAAMG,EAAEC,MAAMC,OAASF,EAAEH,KAAOG,EAAEG,SAAWH,EAAEI,WAErD,OADAb,MAAMc,QAAO,EAAOR,GACbA,CACV,CAEDF,kBAAkBW,EAAM,IACpB,MAAMC,QAAYC,MAAMF,GACxB,aAAaC,EAAIE,MACpB,ECjCE,MAAMC,iBAAiBC,EAE1BC,WACI,OAAOC,KAAKC,gBACf,CAEDC,eACIC,MAAMD,eACNE,EAASC,cAAcL,KAC1B,CAEDM,QAAQnB,GACJT,MAAM6B,YAAYpB,EACrB,ECPE,MAAMqB,sBAAsBV,EAE/BW,cACIN,QACAH,KAAKU,SAAW,+BACnB,CAEDX,WACI,OAAOC,KAAKC,gBACf,CAEDU,KAAKvB,GACD,IAAKA,EAAM,OACXA,EAAOA,EAAK,uBAAwBA,EACpC,MAAMwB,EAAOC,OAAOC,QAAQ1B,GAAM2B,KAAIC,IAAc,CAACC,IAAKD,EAAE,GAAIE,MAAQF,EAAE,OAG1EhB,MAAKmB,EAAYC,OAAOC,UACxBrB,MAAKmB,EAAYG,MAAMV,GACvBZ,MAAKmB,EAAYI,MACpB,CAEGJ,QACA,OAAOnB,MAAKwB,EAAOC,cACtB,CAEGD,QACA,OAAOxB,KAAKnB,MAAM,YAAY,EACjC,QAGGiB,EAAU4B,OAAO,oBAAqBlB,cACzC,ECnCE,MAAMmB,gBAAgB9B,SAEzBY,cACIN,QACAH,KAAKU,SAAW,iBACnB,CAEDkB,mBACI,MAAMC,EAAK7B,KACX6B,GAAGC,EAAWC,GAAG,SAAUF,EAAGG,UAAUC,KAAKJ,GAChD,CAEDlB,KAAKvB,GACD,IAAKA,EAAM,OACX,MAAMyC,EAAK7B,KACX6B,GAAGK,EAAW9C,KAAO,GACjBA,EAAK+C,KACLnC,MAAKoC,EAAUpC,MAAK8B,EAAY1C,EAAK+C,MAErCN,GAAGQ,EAAUjD,EAEpB,CAEDiD,GAAUjD,GACN,IAAKA,EAAM,OACXA,EAAOA,EAAK,mBAAoBA,EAChC,MAAMwB,EAAOC,OAAOC,QAAQ1B,GAAM2B,KAAIC,IAAc,CAACC,IAAKD,EAAE,GAAIE,MAAQF,EAAE,OAC1EhB,MAAKoC,EAAUpC,MAAKkC,EAAYtB,EACnC,CAEDwB,GAAUZ,EAAOpC,GACb,MAAM+B,EAAaK,EAAMC,eACzBN,EAAWC,OAAOC,UAClBF,EAAWG,MAAMlC,GACjB+B,EAAWI,MACd,CAEGO,QACA,OAAO9B,KAAKnB,MAAM,eAAe,EACpC,CAEGqD,QACA,OAAOlC,KAAKnB,MAAM,yBAAyB,EAC9C,CAEDyD,YAAYnD,GAEX,CAEDoD,WAAWpD,GAEV,CAEDqD,YAAYrD,GACRa,MAAK8B,EAAW1C,KAAO,EAC1B,CAEDqD,gBAAgBtD,GACZ,MAAMgD,QAAazD,MAAMiC,KAAK,8BAC9BX,KAAKW,KAAKwB,EACb,CAEDM,gBAAgBtD,GACZ,MAAMgD,QAAazD,MAAMiC,KAAK,oBAC9BX,KAAKW,KAAKwB,EACb,QAGGtC,SAAS6B,OAAO,cAAeC,QAClC,ECzEE,MAAMe,gBAAgB7C,SAEzBY,cACIN,QACAH,KAAKU,SAAW,iBACnB,CAEGiC,QACA,OAAO3C,KAAKnB,MAAM,qBAAqB,EAC1C,CAEGsD,QACA,OAAOnC,KAAKnB,MAAM,eAAe,EACpC,CAEG+D,UACA,OAAO5C,KAAKnB,MAAM,gBAAgBqC,OAAS,EAC9C,CAEDuB,mBACIzC,KAAK6C,WACR,CAEDJ,kBACI,MACMrD,QAAaV,MAAMiC,KAAK,kCADnBX,MAER2C,EAAYhC,KAAKvB,GAEpB,MAAM+C,QAAazD,MAAMiC,KAAK,oBAJnBX,MAKRmC,EAAMxB,KAAKwB,EACjB,QAGGtC,SAAS6B,OAAO,cAAegB,QAClC,EC/BE,MAAMI,mBAAmBhD,EAE5BW,cACIN,QACAH,KAAKU,SAAW,oBACnB,CAEDX,WACI,OAAOC,KAAKC,gBACf,CAED8C,IAAI3D,EAAO,IACPY,MAAKgD,EAASC,QAAUC,KAAKC,UAAU/D,EAAM,GAAI,EACpD,CAEG4D,QACA,OAAOhD,KAAKnB,MAAM,gBAAgB,EACrC,QAGGiB,EAAU4B,OAAO,iBAAkBoB,WACtC"}