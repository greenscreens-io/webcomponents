(()=>{"use strict";class GSLog{static logging=!0;static info(t,e){this.#t(t,e,!0,"info")}static warn(t,e){this.#t(t,e,!0,"warn")}static error(t,e){this.#t(t,e,!0,"error")}static log(t,e,s){this.#t(t,e,s)}static#t(t,e,s,r){if(!s&&!this.logging)return;let n=console[r||"log"];if(n="function"==typeof n?n:console.log,t)return n(`${t.nodeName} -> ${t.id}: ${e}`);n(e)}static{Object.seal(GSLog)}}class GSUtil{static#e=0;static FLAT=1==globalThis.GS_FLAT;static ALPHANUM=/^[a-zA-Z0-9-_]+$/;static isNumber=t=>!isNaN(parseFloat(t))&&isFinite(t);static isString=t=>"string"==typeof t;static isNull=t=>null==t;static toBinary=(t=0)=>t.toString(2);static asNum=(t=0)=>GSUtil.isNumber(t)?parseFloat(t):0;static asBool=(t=!1)=>"true"===t.toString().trim().toLowerCase();static fromLiteral=(t,e)=>t.replace(/\${(.*?)}/g,((t,s)=>e[s]));static capitalize=t=>t[0].toUpperCase()+t.slice(1).toLowerCase();static capitalizeAttr=t=>t.split("-").map(((t,e)=>e?GSUtil.capitalize(t):t)).join("");static initerror=()=>{throw new Error("This class cannot be instantiated")};static isURL=(t="")=>/^(https?:\/\/|\/{1,2}|\.\/{1})(\S*\/*){1,}/i.test(t.trim());static isHTML=(t="")=>t.includes("<")&&t.includes(">");static get locale(){return navigator.language?navigator.language:navigator.languages[0]}static isJsonString(t=""){return"string"==typeof t&&(t.startsWith("{")||t.startsWith("["))}static isJsonType(t=""){return Array.isArray(t)||"object"==typeof t}static isJson(t=""){return GSUtil.isJsonString(t)||GSUtil.isJsonType(t)}static toJson(t=""){return GSUtil.isJsonString(t)?JSON.parse(t):GSUtil.isJsonType(t)?t:(GSLog.warn(null,`Invalid data to convert into JSON: ${t}`),null)}static normalize(t,e=""){return(t??e).toString().trim()}static fromTemplateLiteral(t,e){const s=Object.keys(e),r=Object.values(e);return new Function(...s,`return \`${t}\`;`)(...r)}static parseValue(t){if(!GSUtil.isStringNonEmpty(t))return;let e=window,s=null;return t.trim().split(".").forEach(((t,r,n)=>{if(e)return r<n.length-1?e=e[t]:void(s=e[t])})),s}static isStringNonEmpty(t=""){return!GSUtil.isStringEmpty(t)}static isStringEmpty(t=""){return!!GSUtil.isString(t)&&0===t.trim().length}static isStringMatch(t,e){const s=GSUtil.isStringNonEmpty(t),r=GSUtil.isStringNonEmpty(e);return s&&r?t.trim().toLowerCase()==e.trim().toLowerCase():s===r}static async timeout(t=0){return new Promise((e=>{setTimeout(e.bind(null,!0),t)}))}static requestAnimationFrame(t){if("function"==typeof t)return GSUtil.#e>0?t():(GSUtil.#e++,globalThis.requestAnimationFrame((()=>{try{t()}catch(t){console.log(t)}finally{GSUtil.#e--}})))}static async export(t,e,s="octet/stream"){const r=new Blob(t,{type:s}),n=URL.createObjectURL(r);try{const t=document.createElement("a");t.href=n,t.download=e,t.click(),await GSUtil.timeout(2e3)}finally{URL.revokeObjectURL(n)}}static register(t,e,s,r=!0,n=!1,i=!1){HTMLElement.isPrototypeOf(e)&&(customElements.get(t)||(customElements.define(t,e,{extends:s?.toLowerCase()}),r&&!Object.isSealed(e)&&Object.seal(e),n&&!Object.isFrozen(e)&&Object.freeze(e),i&&(self[e.name]=e)))}static{Object.seal(GSUtil),globalThis.GSUtil=GSUtil}}class GSDOM_GSDOM{static SPEED=300;static parse(t="",e=!1,s="text/html"){try{const r=(new DOMParser).parseFromString(t,s);return e?r?.body?.firstElementChild:r}catch(t){throw GSLog.error(null,t),t}}static parseWrapped(t,e="",s=!1){const r=GSDOM_GSDOM.parse(e),n=GSDOM_GSDOM.#s(r.head.children).concat(GSDOM_GSDOM.#s(r.body.children)),i=s||1!==n.length,a=GSDOM_GSDOM.wrap(t,i?null:n.shift());for(;n.length>0;)a.appendChild(n.shift());return a}static wrap(t,e){return GSDOM_GSDOM.link(t,e||document.createElement("gs-block"))}static link(t,e){return e.setAttribute("proxy",`#${t.id}`),t.slot&&e.setAttribute("slot",t.slot),e}static#s(t){return Array.from(t||[]).filter((t=>!GSDOM_GSDOM.isText(t)))}static isElement(t,e){if(!(e&&t))return!1;if(!GSUtil.isString(e))return t instanceof e;const s=customElements.get(e.toLowerCase());if(s&&t instanceof s)return t;const r=GSDOM_GSDOM.inheritance(t);for(let s of r)if(s?.constructor?.name===e)return t;return e.toUpperCase()===t.tagName&&t}static isTemplateElement(t){return t instanceof HTMLTemplateElement}static isHTMLElement(t){return t instanceof HTMLElement}static isSVGElement(t){return t instanceof SVGElement}static isText(t){return t instanceof Text}static isComment(t){return t instanceof Comment}static isGSElement(t){if(!t?.clazzName)return!1;const e=GSDOM_GSDOM.inheritance(t);for(let t of e){if(!t)break;if("GSElement"===t?.clazzName)return!0}return!1}static isGSExtra(t){return 0===t?.getAttribute("is")?.indexOf("GS-")}static getChilds(t){return Array.from(t?.childNodes||[]).filter((t=>GSDOM_GSDOM.isGSElement(t)))}static hide(t,e=!1){return t?.classList?.add(e?"gs-hide-orientation":"gs-hide")}static show(t,e=!1){return t?.classList?.remove(e?"gs-hide-orientation":"gs-hide")}static addSibling(t,e){const s=GSDOM_GSDOM.isHTMLElement(e)||GSDOM_GSDOM.isSVGElement(e),r=GSDOM_GSDOM.isHTMLElement(t)&&s,n=t===e&&t.parentNode===e||t.nextElementSibling===e;return!(!r||n)&&t.parentNode.insertBefore(e,t.nextElementSibling)}static appendChild(t,e){return!(!(GSDOM_GSDOM.isHTMLElement(t)&&GSDOM_GSDOM.isHTMLElement(e))||t===e)&&t.appendChild(e)}static insertAdjacent(t,e,s){const r=GSDOM_GSDOM.isHTMLElement(t)&&GSDOM_GSDOM.isHTMLElement(e),n=t===e&&t.parentNode===e;return!(!r||n)&&t.insertAdjacentElement(s,e)}static removeElement(t){return t?.parentNode?.removeChild(t)}static walk(t,e=!1,s=!1,r=!0){return e?GSDOM_GSDOM.parentAll(t):GSDOM_GSDOM.childAll(t,s,r)}static*childAll(t,e=!1,s=!0,r=!1){if(!t)return;r&&(yield t),s&&(yield*GSDOM_GSDOM.childAll(t.shadowRoot,e,s,!0));const n=e?t.childNodes:t.children;if(n)for(let t of n)yield*GSDOM_GSDOM.childAll(t,e,s,!0)}static parent(t){return t?t.parentElement||t.parentNode||t.host:null}static*parentAll(t){let e=GSDOM_GSDOM.parent(t);for(;e;)yield e,e=GSDOM_GSDOM.parent(e);if(e)return yield e}static*inheritance(t){let e=t.__proto__;for(;e;)yield e,e=e.__proto__;if(e)return yield e}static getRoot(t){if(!t)return null;const e=GSDOM_GSDOM.parentAll(t);for(let t of e){if(t instanceof ShadowRoot)return t;if(t instanceof HTMLBodyElement)return t}return null}static getByID(t,e){if("string"==typeof t)return GSDOM_GSDOM.getByID(document.body,e);if(!t||!e)return null;const s=GSDOM_GSDOM.walk(t,!1);for(let t of s)if(t.id===e)return t;return null}static closest(t,e){if("string"==typeof t)return GSDOM_GSDOM.closest(document.body,e);if(!t||!e)return null;const s=GSDOM_GSDOM.walk(t,!0);for(let t of s)if(GSDOM_GSDOM.matches(t,e))return t;return null}static query(t,e){if("string"==typeof t)return GSDOM_GSDOM.query(document.body,e);if(!t||!e)return null;if(GSDOM_GSDOM.matches(t,e))return t;const s=GSDOM_GSDOM.walk(t,!1,!1);for(let t of s)if(GSDOM_GSDOM.matches(t,e))return t;return null}static matches(t,e){return t&&"function"==typeof t.matches&&t.matches(e)}static queryAll(t,e){if("string"==typeof t)return GSDOM_GSDOM.queryAll(document.body,e);const s=[];if(!t||!e)return s;const r=GSDOM_GSDOM.walk(t,!1,!1);for(let t of r)GSDOM_GSDOM.matches(t,e)&&s.push(t);return s}static setHTML(t,e=""){(t instanceof ShadowRoot||t instanceof HTMLElement||t instanceof HTMLTemplateElement)&&(t.innerHTML=e)}static setText(t,e=""){t&&(t.textContent=e)}static toggleClass(t,e=!0,s="d-none"){return!!GSDOM_GSDOM.isHTMLElement(t)&&(!(!s||0==s.trim().length)&&(s=s.split(" ").filter((t=>t&&t.trim().length>0)),null===e?s.forEach((e=>t.classList.toggle(e))):void(e?t.classList.add.apply(t.classList,s):t.classList.remove.apply(t.classList,s))))}static hasClass(t,e=""){return t?.classList?.contains(e)}static clearInputs(t,e="input, textarea"){const s=GSDOM_GSDOM.unwrap(t);requestAnimationFrame((()=>{s.querySelectorAll(e).forEach((t=>t.value=""))}))}static toValue(t){if(!GSDOM_GSDOM.isHTMLElement(t))return;if("checkbox"===t.type)return t.checked;let e=t.value;if("text"===t.type){const s=GSDOM_GSDOM.styleValue(t,"text-transform");s&&("lowercase"==s.value&&(e=t.value.toLowerCase()),"uppercase"==s.value&&(e=t.value.toUpperCase()))}return e}static fromValue(t,e){GSDOM_GSDOM.isHTMLElement(t)&&("checkbox"===t.type?t.checked=1==e:t.value=e)}static styleValue(t,e){const s=GSDOM_GSDOM.getComputedStyledMap(t);return"function"==typeof s.get?s.get(e):s[e]}static getComputedStyledMap(t){return t.computedStyleMap?t.computedStyleMap():window.getComputedStyle?window.getComputedStyle(t):null}static toObject(t,e="input, textarea, select",s=!0){const r=GSDOM_GSDOM.unwrap(t),n={},i=GSDOM_GSDOM.queryAll(r,e);return Array.from(i).filter((t=>t.name)).filter((t=>"true"!==t.dataset.ignore)).filter((t=>!!s||t.checkValidity())).forEach((t=>{n[t.name]=GSDOM_GSDOM.toValue(t)})),n}static fromObject(t,e,s="input, textarea, select"){if(!e)return;const r=GSDOM_GSDOM.unwrap(t),n=GSDOM_GSDOM.queryAll(r,s);Array.from(n).filter((t=>t.name&&Object.hasOwn(e,t.name))).forEach((t=>GSDOM_GSDOM.fromValue(t,e[t.name])))}static fromURLHashToForm(t){location.hash.slice(1).split("&").every((e=>{if(e.length<2)return!0;const s=e.split("=");return GSDOM_GSDOM.setValue(`input[name=${s[0]}]`,s[1],t),!0}))}static unwrap(t){return t?t.self||t:document}static enableInput(t,e="input, select, .btn"){GSDOM_GSDOM.queryAll(t,e).forEach((t=>t.removeAttribute("disabled")))}static disableInput(t,e="input, select, .btn"){GSDOM_GSDOM.queryAll(el,e).forEach((t=>t.setAttribute("disabled",!0)))}static setValue(t,e,s){const r=GSDOM_GSDOM.query(s,t);GSDOM_GSDOM.fromValue(r,e)}static textNodesUnder(t){const e=document.createTreeWalker(t||document,NodeFilter.SHOW_TEXT,null,!1),s=[];let r;for(;r=e.nextNode();)s.push(r);return s}static cleanHTML(t){const e=GSDOM_GSDOM.textNodesUnder(t||document).filter((t=>0===t.wholeText.trim().length));e.filter((t=>t.nextSibling instanceof Text)).forEach((t=>t.remove())),e.forEach((t=>t.nodeValue=t.wholeText.replaceAll(/\u0020{4}/g,"\t").replaceAll(/(\n*\t*)*(?=\n\t*)/g,"")))}static validate(t,e,s,r=!1){if(t.tagName!==e){if(r)return!1;throw new Error(`Owner element : ${t.tagName}, id:${t.id} is not of excpected type: ${e}`)}if(GSDOM_GSDOM.isAllowed(Array.from(t.childNodes),s))return!0;if(r)return!1;const n=GSDOM_GSDOM.toValidationError(t,s);throw new Error(n)}static isAllowed(t,e){return Array.isArray(t)?0===t.filter((t=>GSDOM_GSDOM.isAllowed(t,e))).length:!(t instanceof Text||t instanceof Comment||e.includes(t.tagName))}static toValidationError(t,e){const s=`<${e.join(">, <")}>`;return`${t.tagName} ID: ${t.id} allows as a child nodes only : ${s}!`}static async injectCSS(t,e){if(!t?.shadowRoot instanceof ShadowRoot)return!1;let s=!0;try{const s=await fetch(e);if(!s.ok)return;const r=await s.text(),n=new CSSStyleSheet;n.replaceSync(r),t.shadowRoot.adoptedStyleSheets=[n]}catch(t){console.log(t),s=!1}return s}static{Object.seal(GSDOM_GSDOM),window.GSDOM=GSDOM_GSDOM}}class GSID{static#r=0;static reset(){this.#r=0}static next(t="GSId-"){return`${t}${this.#r++}`}static get id(){return this.next()}static hashCode(t){const e=(t||"").length;let s=0,r=0;if(0===e)return s;for(;r<e;)s=(s<<5)-s+t.charCodeAt(r++)|0;return s}static{Object.freeze(GSID)}}class GSAttr{static isHTMLElement(t){return t instanceof HTMLElement}static toggle(t,e,s=!1){GSAttr.isHTMLElement(t)&&(s?t.setAttribute(e,""):t.removeAttribute(e))}static set(t,e,s){GSAttr.isHTMLElement(t)&&(GSUtil.normalize(s)?t.setAttribute(e,s):t.removeAttribute(e))}static get(t,e="",s=""){if(!GSAttr.isHTMLElement(t))return s;const r=t.getAttribute(e)||s;return GSUtil.normalize(r)}static getAsBool(t,e="",s="false"){const r=GSAttr.get(t,e,s);return GSUtil.asBool(r)}static getAsNum(t,e="",s="0"){const r=GSAttr.get(t,e,s);return GSUtil.asNum(r)}static getAsJson(t,e="",s="0"){const r=GSAttr.get(t,e,s,{});return JSON.parse(r)}static setAsBool(t,e="",s="false"){return GSAttr.set(t,e,GSUtil.asBool(s),!1)}static setAsNum(t,e="",s="0"){return GSAttr.set(t,e,GSUtil.asNum(s),NaN)}static setAsJson(t,e="",s="0"){return GSAttr.set(t,e,JSON.stringify(s),"{}")}static dataToString(t){return Array.from(t.attributes).filter((t=>t.name.startsWith("data-"))).map((t=>`${t.name}="${t.value}"`)).join(" ")}static{Object.seal(GSAttr)}}class GSFunction{static isFunction=t=>"function"==typeof t;static hasFunction(t,e){return t&&GSFunction.isFunction(t[e])}static isFunctionAsync(t){if(!GSFunction.isFunction(t))return!1;let e=t instanceof GSFunction.callFunctionAsync.constructor;return e||(e="AsyncFunction"==t[Symbol.toStringTag]),e}static async callFunctionAsync(t,e){try{return await t(e)}catch(t){return t}}static callFunctionSync(t,e){try{return t(e)}catch(t){return t}}static callFunction(t,e){if(GSFunction.isFunction(t))return GSFunction.isFunctionAsync(t)?GSFunction.callFunctionAsync(t,e):GSFunction.callFunctionSync(t,e)}static parseFunction(t){const e=GSUtil.parseValue(t);return GSFunction.isFunction(e)?e:null}static{Object.seal(GSFunction)}}class GSLoader{static TEMPLATE_URL=globalThis.GS_TEMPLATE_URL||location.origin;static NO_CACHE=!1;static{if(!globalThis.GS_TEMPLATE_URL){const t=location.href.split("?").pop();let e=t.split("/");GSLoader.TEMPLATE_URL=t.endsWith("/")?t:e.slice(0,-1).join("/"),globalThis.GS_TEMPLATE_URL=GSLoader.TEMPLATE_URL}const t=Object.hasOwn(self,"GS_NO_CACHE");t&&(GSLoader.NO_CACHE=!0===globalThis.GS_NO_CACHE,localStorage&&localStorage.setItem("GS_NO_CACHE",GSLoader.NO_CACHE)),GSLoader.NO_CACHE=!!localStorage&&"true"==localStorage.getItem("GS_NO_CACHE")}static normalizeURL(t="",e=!1){t=t||"";let s=null;const r=location.pathname.split("/").pop(-1).includes("."),n=t.includes("extension://");s=t.startsWith("http")||n?t:t.startsWith("/")?`${location.origin}/${t}`:r?`${location.origin}${location.pathname}/../${t}`:`${location.origin}${location.pathname}/${t}`,s=s.split("://").map((t=>t.replaceAll(/\/{2,}/g,"/"))).join("://");const i=new URL(s);return!e&&GSLoader.NO_CACHE&&i.searchParams.append("_dc",Date.now()),i.href}static parentPath(t="",e=1){return(t||"").split("/").slice(0,-1*e).join("/")}static async getTemplate(t=""){if(!t)return t;if(t.startsWith("#")){const e=GSDOM_GSDOM.query(document.documentElement,t);return e?e.innerHTML:t}return GSUtil.isHTML(t)?t:(t=GSLoader.#n(t),GSLoader.loadSafe(t))}static#n(t=""){return t=t.startsWith("//")?GSLoader.#i+"/"+t:t,GSLoader.normalizeURL(t)}static get#i(){return GSLoader.normalizeURL(GSLoader.#a,!0)}static get#a(){return GSLoader.TEMPLATE_URL?GSLoader.TEMPLATE_URL.replace("//","/"):""}static async loadTemplate(t="",e="GET"){const s=GSLoader.#n(t);return await GSLoader.load(s,e)}static async load(t="",e="GET",s,r=!1){let n=null;const i="Content-Type";(s=s||{})[i]=r?"application/json":s[i]||"text/plain";const a=GSLoader.normalizeURL(t,!0),o=await fetch(a,{method:e,headers:s});return o.ok&&(n=r?await o.json():await o.text()),n}static async loadSafe(t="",e="GET",s,r=!1,n){try{if(t)return GSLoader.load(t,e,s,r)}catch(t){GSLog.error(this,t)}return n||(r?{}:"")}static async loadData(t=""){const e=GSUtil.isJson(t),s=!e&&GSFunction.parseFunction(t),r=GSFunction.isFunction(s);if((!r&&GSUtil.parseValue(t)||e)&&(t=GSUtil.toJson(t)),r){t=GSFunction.isFunctionAsync(s)?await GSFunction.callFunctionAsync(s,this):GSFunction.callFunction(s)}if(GSUtil.isJsonType(t))return t}static{Object.seal(GSLoader)}}class GSEvent{static#o=new Map;static#c=!1;static protect(){window.addEventListener("contextmenu",(t=>{GSEvent.prevent(t)})),document.addEventListener("keydown",(t=>{const e=t.code;return"F12"!=e&&((!t.ctrlKey||!t.shiftKey||"KeyI"!=e)&&void 0)}))}static async waitPageLoad(t,e="loaded",s,r=100){GSEvent.#c||await GSEvent.wait(window,"load"),GSEvent.#c=!0,await GSUtil.timeout(r),GSFunction.callFunction(s),GSEvent.sendSuspended(t,e)}static async waitAnimationFrame(t){return new Promise(((e,s)=>{requestAnimationFrame((()=>{try{e(),"function"==typeof t&&t()}catch(t){console.log(t),s(t)}}))}))}static listen(t,e,s,r,n=!1){return!e&&t?t.addEventListener(s,r,n):GSDOM_GSDOM.queryAll(t,e).map((t=>t.addEventListener(s,r,n)))}static unlisten(t,e,s,r){return!e&&t?t.removeEventListener(s,r):GSDOM_GSDOM.queryAll(t,e).map((t=>t.removeEventListener(s,r)))}static once(t,e,s,r){return GSEvent.listen(t,e,s,r,{once:!0})}static wait(t,e=""){return new Promise(((s,r)=>{if(!e)return r("Event undefined!");GSEvent.once(t,null,e,(t=>s(t.detail)))}))}static prevent(t){GSFunction.hasFunction(t,"preventDefault")&&t.preventDefault(),GSFunction.hasFunction(t,"stopPropagation")&&t.stopPropagation()}static send(t=document,e,s="",r=!1,n=!1,i=!1){const a=new CustomEvent(e,{detail:s,bubbles:r,composed:n,cancelable:i});return t.dispatchEvent(a)}static sendSuspended(t=document,e,s="",r=!1,n=!1,i=!1){e&&requestAnimationFrame((()=>{GSEvent.send(t,e,s,r,n,i)}))}static attach(t,e,s="",r,n=!1,i=!1){if(!e)return!1;if(e.offline)return!1;if(!GSFunction.isFunction(r))return!1;if(!GSFunction.hasFunction(e,"addEventListener"))return!1;const a=this,o=a.#l(t,e,s,r),c=a.#u(t);return a.#d(c,o.key).set(o.fnkey,o),o.capture=i,n&&(o.once=t=>{try{o.fn(t)}finally{a.remove(o.own,o.el,o.name,o.once)}},Object.defineProperty(o.once,"gsid",{value:r.gsid,writable:!1})),e.addEventListener(s,n?o.once:o.fn,{once:n,capture:i}),!0}static remove(t,e,s="",r){const n=this,i=n.#l(t,e,s,r),a=n.#u(t),o=n.#d(a,i.key),c=o.get(i.fnkey);if(c)o.delete(c.fnkey),n.#h(c);else if(i.fnkey===i.key)for(let t of o.values())o.delete(t.fnkey),n.#h(t);0===o.size&&a.delete(i.key),0===a.size&&n.#o.delete(t)}static deattachListeners(t){const e=this,s=e.#m(t);if(!s)return;const r=s.values();for(let t of r){for(let s of t.values())e.#h(s);t.clear()}s.clear()}static#l(t,e,s="",r=""){if(!e)return!1;const n=this.#g(e),i=this.#S(r);return{own:t,fn:r,el:e,name:s,key:GSID.hashCode(`${n}${s}`),fnkey:GSID.hashCode(`${n}${s}${i||""}`)}}static#d(t,e){let s=t.get(e);return s||(s=new Map,t.set(e,s)),s}static#S(t){return GSFunction.isFunction(t)?(t.gsid||Object.defineProperty(t,"gsid",{value:GSID.next(),writable:!1}),t.gsid):null}static#g(t){let e=GSAttr.get(t,"data-gselid");return e||(e=GSID.next(),GSAttr.set(t,"data-gselid",e)),e}static#u(t){return this.#d(this.#o,t)}static#m(t){const e=this.#o.get(t);if(e)return this.#o.delete(t),e}static#h(t){t.el.removeEventListener(t.name,t.once?t.once:t.fn,{capture:t.capture}),t.el=null,t.fn=null,t.once=null}static{Object.freeze(GSEvent)}}class GSBase extends HTMLElement{static#r=0;#p="";static get observedAttributes(){return[]}static nextID(){return GSBase.#r++,`GSHID_${GSBase.#r}`}static hashCode(t){let e=0,s=t.length,r=0;if(s>0)for(;r<s;)e=(e<<5)-e+t.charCodeAt(r++)|0;return e}static sendEvent(t=document,e,s="",r=!1,n=!1,i=!1){const a=new CustomEvent(e,{detail:s,bubbles:r,composed:n,cancelable:i});return t.dispatchEvent(a)}static sendSuspendedEvent(t=document,e,s=""){requestAnimationFrame((()=>{GSBase.sendEvent(t,e,s)}))}connectedCallback(){const t=this;if(t.url&&t.isRenderable()){const e=GSBase.hashCode(t.url);if(document.querySelector(`[data-hash="${e}"]`))return void t.remove();const s=t.render(),r=s instanceof Promise;s&&!r&&(s.dataset.hash=e,t.isHead?document.head.appendChild(s):t.insertAdjacentElement("afterend",s),t.isAuto&&(s.id=s.id?s.id:GSBase.nextID(),t.#p=s.id))}t.isAuto||t.remove()}disconnectedCallback(){const t=this;if(t.isAuto&&t.#p){const e=document.querySelector(`#${t.#p}`);e&&e.remove()}t.dispose()}attributeChangedCallback(t,e,s){const r=this;requestAnimationFrame((()=>{r.attributeCallback(t,e,s)}))}attributeCallback(t,e,s){}render(){}dispose(){}get isMobile(){return navigator.userAgentData?navigator.userAgentData.mobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}get isSchema(){const t=this.schema;if(!t)return!0;const e=location.protocol.replace(":","");return"http"===t&&e===t||"https"===t&&e===t}get isAsset(){return this.isTarget("GreenScreens")}isTarget(t=""){if(!t)return!0;const e=t.toLowerCase();if(navigator.userAgentData){let t=!1;return navigator.userAgentData.brands.forEach((s=>{s.brand.toLowerCase().includes(e)&&(t=!0)})),t}const s=new RegExp(`${t}`,"i");return!!navigator.userAgent.match(s)}isRenderable(){const t=this,e=t.isMobile,s=t.isAsset,r=t.isSchema,n=t.target,i=t.env;return!!r&&(("assets"!==i||!1!==s)&&(("browser"!==i||!0!==s)&&(("mobile"!==i||!1!==e)&&(("desktop"!==i||!0!==e)&&!!t.isTarget(n)))))}get env(){return this.getAttribute("env")||""}get target(){return this.getAttribute("target")||""}get url(){const t=this;let e=t.getAttribute("url")||"";if("assets"===t.env)return"**"+e;if(t.#G)try{let t=`${location.origin}${location.pathname}`;e.startsWith("/")&&(t=location.origin),e.startsWith("http")&&(t=void 0);const s=new URL(e,t);s.searchParams.append("_dc",Date.now()),e=s.href}catch(t){console.log(t)}return e}get type(){const t=this;let e=t.getAttribute("type")||"";return e||(t.url.indexOf(".js")>0?e="text/javascript":t.url.indexOf(".css")>0&&(e="text/css")),e}get async(){return this.getAttributeBool("async","false")}get defer(){return this.getAttributeBool("defer","false")}get isHead(){return this.getAttributeBool("head")}get isAuto(){return this.getAttributeBool("auto")}get schema(){return this.getAttribute("schema")||""}get nonce(){return this.getAttribute("nonce")||""}get crossorigin(){return this.getAttribute("crossorigin")}get fetchpriority(){return this.getAttribute("fetchpriority")||"auto"}get integrity(){return this.getAttribute("integrity")}get referrerpolicy(){return this.getAttribute("referrerpolicy")}getAttributeBool(t="",e="true"){return"true"===(this.getAttribute(t)||e)}get#G(){return Object.hasOwn(globalThis,"GS_NO_CACHE")?globalThis.GS_NO_CACHE:!!localStorage&&"true"==localStorage.getItem("GS_NO_CACHE")}static{Object.seal(GSBase)}}class GSCacheStyles{static#f=new Map;static set(t,e){const s=this;if(e instanceof CSSStyleSheet&&s.#f.set(t,e),"string"==typeof e){const r=new CSSStyleSheet;r.replaceSync(e),s.#f.set(t,r)}return s.get(t)}static remove(t){return this.#f.delete(t)}static get(t){return this.#f.get(t)}static getOrSet(t,e){if(e&&0===e.cssRules.length)return;const s=GSCacheStyles,r=s.get(t);return r||s.set(t,e)}static get styles(){return Array.from(new Map([...GSCacheStyles.#f].sort(((t,e)=>String(t[0]).localeCompare(e[0])))).values())}static injectStyle(t="",e=0){if(t)try{e=e||GSBase.hashCode(t);const s=new CSSStyleSheet;s.replaceSync(t),GSCacheStyles.getOrSet(e,s),document.adoptedStyleSheets=GSCacheStyles.styles}catch(t){console.log(t)}}static{Object.freeze(GSCacheStyles),window.GSCacheStyles=GSCacheStyles;const t=".gs-hide{display:none;}.gs-hide-orientation,.gs-render{display:none !important;}gs-item{display:none !important;}";GSCacheStyles.injectStyle(t)}}class GSComponents_GSComponents{static#o=new Set;static store(t){GSComponents_GSComponents.#o.add(t)}static remove(t){GSComponents_GSComponents.#o.delete(t)}static get(t=""){if(!t)return null;const e=Array.from(this.#o).filter((e=>e.id===t));return 0===e.length?null:e[0]}static#b(t="",e=0,s){const fn=e=>{const r=e.detail;if(t.startsWith("gs-")&&r.tagName===t.toUpperCase()||r.id===t)return GSEvent.unlisten(document.body,null,"componentready",fn),s(r)},r={once:!1,capture:!1};e>0&&(r.signal=AbortSignal.timeout(e)),GSEvent.listen(document.body,null,"componentready",fn,r)}static waitFor(t="",e=0){return new Promise(((s,r)=>{let n=GSComponents_GSComponents.find(t)||GSComponents_GSComponents.get(t);return n?s(n):GSComponents_GSComponents.#b(t,e,s)}))}static notifyFor(t="",e){if(!GSFunction.isFunction(e))return!1;const callback=s=>{const r=s.composedPath().shift();return r.id===t||r.tagName===t?e(r,s):void 0},s=GSComponents_GSComponents.find(t)||GSComponents_GSComponents.get(t);return s?e(s):(GSEvent.listen(document.body,null,"componentready",callback),callback)}static findAll(t="",e=!0,s=!0){let r=Array.from(GSComponents_GSComponents.#o);return t&&(r=r.filter((e=>e&&GSDOM_GSDOM.matches(e,t)))),e||(r=r.filter((t=>t.shadowRoot))),s||(r=r.filter((t=>!t.shadowRoot))),r}static find(t="",e=!0,s=!0){return GSComponents_GSComponents.findAll(t,e,s).shift()}static getOwner(t,e){if(!(GSDOM_GSDOM.isGSElement(t)||GSDOM_GSDOM.isHTMLElement(t)))return null;const s=GSDOM_GSDOM.parentAll(t);for(let t of s){if(!t)break;if(t instanceof ShadowRoot){const s=GSDOM_GSDOM.parent(t);return e?GSDOM_GSDOM.isElement(s,e)?s:GSComponents_GSComponents.getOwner(s,e):s}if(GSDOM_GSDOM.isElement(t,e))return t}return e?null:GSDOM_GSDOM.parent(t)}static hasGetter(t,e){return GSComponents_GSComponents.hasFunc(t,e,"get")}static hasSetter(t,e){return GSComponents_GSComponents.hasFunc(t,e,"set")}static hasFunc(t,e,s){const r=Reflect.getOwnPropertyDescriptor(t.__proto__,e);return r&&"function"==typeof r[s]}static listenStyles(){GSComponents_GSComponents.#v||(document.addEventListener("gs-style",GSComponents_GSComponents.#y),GSComponents_GSComponents.#v=!0)}static unlistenStyles(){document.removeEventListener("gs-style",GSComponents_GSComponents.#y),GSComponents_GSComponents.#v=!1}static#v=!1;static#y(){requestAnimationFrame((()=>{GSComponents_GSComponents.findAll(null,!1,!0).filter((t=>t.shadowRoot)).forEach((t=>t.shadowRoot.adoptedStyleSheets=GSCacheStyles.styles))}))}static{Object.freeze(GSComponents_GSComponents),GSComponents_GSComponents.listenStyles(),window.GSComponents=GSComponents_GSComponents}}class GSData{static uniqe(t){return Array.from(new Set(t))}static arraysEqual(t,e){if(t===e)return!0;if(!Array.isArray(t))return!1;if(!Array.isArray(e))return!1;t.sort(),e.sort();for(var s=0;s<t.length;++s)if(t[s]!==e[s])return!1;return!0}static mergeArrays(t=[],e=[]){return t.concat(e).filter(((t,e,s)=>s.indexOf(t)===e))}static filterData(t,e,s){return 0===t.length?e:e.filter((e=>GSData.filterRecord(e,t,s)))}static filterRecord(t,e,s){return"string"==typeof e?GSData.filterSimple(t,e,s):GSData.filterComplex(t,e)}static filterSimple(t,e="",s){e=e.toLowerCase(),s=s||Object.keys(t);let r=null;for(let n of s)if(r=t[n],(""+r).toString().toLowerCase().includes(e))return!0;return!1}static filterComplex(t,e){let s=!0,r=null;for(let n of e)if(r=n?.value?.toLowerCase(),s=s&&(""+t[n.name]).toLocaleLowerCase().includes(r),!s)break;return s}static sortData(t,e){return 0===t.length?e:e.sort(((e,s)=>GSData.sortPair(e,s,t)))}static sortPair(t,e,s){const r=Array.isArray(t);let n=0;return s.forEach(((s,i)=>{if(!s)return;const a=s.col||i,o=r?a:s.name,c=t[o],l=e[o];n=GSData.compare(c,l,s.ord,n)})),n}static compare(t,e,s,r){return GSUtil.isNumber(t)&&GSUtil.isNumber(e)?r||GSData.compareNum(t,e,s):GSUtil.isString(t)||GSUtil.isString(e)?r||GSData.compareString(t,e,s):r}static compareString(t,e,s){const r=(t||"").toString(),n=(e||"").toString();return s<0?n.localeCompare(r):r.localeCompare(n)}static compareNum(t,e,s){return s<0?e-t:t-e}static{Object.seal(GSData)}}class GSEnvironment{static get isMobile(){return navigator.userAgentData?navigator.userAgentData.mobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}static get isDesktop(){return!GSEnvironment.isMobile}static get isWebkit(){return/webkit/.test(navigator.userAgent.toLowerCase())}static isValidBrowser(t=""){if(!t)return!0;const e=t.toLowerCase();if(navigator.userAgentData){let t=!1;return navigator.userAgentData.brands.forEach((s=>{s.brand.toLowerCase().includes(e)&&(t=!0)})),t}const s=navigator.userAgent.toLocaleLowerCase(),r=s.indexOf("edg")>0;return!(!r||!e.startsWith("edg"))||!r&&s.indexOf(e)>0}static isValidEnvironment(t=""){return!t||("desktop"===t?GSEnvironment.isDesktop:"mobile"===t?GSEnvironment.isMobile:GSEnvironment.isDevice(t))}static isDevice(t=""){if(!t)return!0;const e=t.toLowerCase();if(navigator.userAgentData&&navigator.userAgentData.platform){return navigator.userAgentData.platform.toLowerCase()===e}return navigator.userAgent.toLocaleLowerCase().indexOf(e)>1}static isValidOrientation(t=""){if(!t)return!0;if(!screen.orientation)return!0;const e=screen.orientation.type;return e.includes("portrait")?"portrait"===t||"vertical"===t:!e.includes("landscape")||("landscape"===t||"horizontal"===t)}static{Object.seal(GSEnvironment)}}class GSDOMObserver extends MutationObserver{static#A=new Map;static#D=new Map;observe(t,e){const s=e||{childList:!0,subtree:!0};return super.observe(t,s)}static create(t){const e=new GSDOMObserver(GSDOMObserver.#M);return e.observe(t),e}static#E(t=!1){return t?GSDOMObserver.#D:GSDOMObserver.#A}static get#O(){return GSDOMObserver.#w||GSDOMObserver.#C}static get#w(){return GSDOMObserver.#A.size>0}static get#C(){return GSDOMObserver.#D.size>0}static#M(t){GSDOMObserver.#O&&t.forEach((t=>{GSDOMObserver.#w&&t.addedNodes.forEach((t=>GSDOMObserver.#T(t,GSDOMObserver.#A))),GSDOMObserver.#C&&t.removedNodes.forEach((t=>GSDOMObserver.#T(t,GSDOMObserver.#D)))}))}static#T(t,e){return 0!==e.size&&(GSDOMObserver.#x(t,e),t.childNodes.forEach((t=>GSDOMObserver.#T(t,e))),!0)}static#x(t,e){e.forEach(((e,s)=>{try{s(t)&&e(t)}catch(t){console.log(t)}}))}static#L(t,e,s){if(t instanceof HTMLElement==0)return!1;const r=new Map;return r.set(e,s),GSDOMObserver.#T(t,r)}static#k(t){return"function"==typeof t}static#$(t,e){return GSDOMObserver.#k(t)&&GSDOMObserver.#k(e)}static registerFilter(t,e,s=!1){return!!GSDOMObserver.#$(t,e)&&(GSDOMObserver.#E(s).set(t,e),s||GSDOMObserver.#L(document.body,t,e),!0)}static unregisterFilter(t,e=!1){return!!GSDOMObserver.#k(t)&&GSDOMObserver.#E(e).delete(t)}static{Object.freeze(GSDOMObserver),window.GSDOMObserver=GSDOMObserver;const t=GSDOMObserver.create(document.documentElement);window.addEventListener("unload",(()=>{t.disconnect()}))}}class GSElement extends HTMLElement{#_=!1;#F=!1;#I=null;#N=null;#R=!1;#j=null;static{customElements.define("gs-element",GSElement)}constructor(){super()}static observeAttributes(t){return GSData.mergeArrays(t,GSElement.observedAttributes)}static get observedAttributes(){return["orientation","id"]}get clazzName(){return this.constructor.name}get template(){return GSAttr.get(this,"template","")}set template(t){GSAttr.set(this,"template",t)}get isFlat(){return GSUtil.FLAT||GSAttr.getAsBool(this,"flat")}get isProxy(){return this.#R}get proxy(){return GSAttr.get(this,"proxy",!1)}get environment(){return GSAttr.get(this,"environment","")}set environment(t){GSAttr.set(this,"environment",t)}get os(){return GSAttr.get(this,"os","")}set os(t){GSAttr.set(this,"os",t)}get browser(){return GSAttr.get(this,"browser","")}set browser(t){GSAttr.set(this,"browser",t)}get orientation(){return GSAttr.get(this,"orientation","")}set orientation(t){GSAttr.set(this,"orientation",t)}get onready(){return GSAttr.get(this,"onready","")}set onready(t){GSAttr.set(this,"onready",t)}get isValidEnvironment(){return GSEnvironment.isValidEnvironment(this.environment)}get isValidOS(){return GSEnvironment.isDevice(this.os)}get isValidOrientation(){return GSEnvironment.isValidOrientation(this.orientation)}get isValidBrowser(){return GSEnvironment.isValidBrowser(this.browser)}get owner(){return GSComponents_GSComponents.getOwner(this)}get offline(){return this.#F}get online(){return!this.#F}get ready(){return this.#_}get anchor(){const t="beforeend@self";return this.proxy?t:GSAttr.get(this,"anchor",t)}get self(){const t=this;return t.isProxy&&t.#I instanceof GSElement?t.#I.self:t.#I}updateUI(){const t=this;t.shadowRoot&&(t.shadowRoot.adoptedStyleSheets=GSCacheStyles.styles,GSEvent.send(document.body,"i18n",t.shadowRoot))}getStyle(){return GSAttr.get(this,"style","")}getByID(t=""){return GSDOM_GSDOM.getByID(this,t)}closest(t=""){return GSDOM_GSDOM.closest(this,t)}query(t=""){return GSDOM_GSDOM.query(this.self,t)}queryAll(t=""){return GSDOM_GSDOM.queryAll(this.self,t)}async getTemplate(t=""){return GSLoader.getTemplate(t)}hide(t=!1){GSDOM_GSDOM.hide(this,t)}show(t=!1){GSDOM_GSDOM.show(this,t)}async waitEvent(t=""){if(!t)throw new Error("Event undefined!");const e=this;return new Promise(((s,r)=>{e.once(t,(t=>s(t.detail)))}))}once(t,e){return this.listen(t,e,!0)}on(t,e,s=!1){return this.listen(t,e,s)}off(t,e){return this.unlisten(t,e)}listen(t,e,s=!1){return this.attachEvent(this,t,e,s)}unlisten(t,e){return this.removeEvent(this,t,e)}attachEvent(t,e="",s,r=!1){return GSEvent.attach(this,t,e,s,r)}removeEvent(t,e="",s){return GSEvent.remove(this,t,e,s)}connectedCallback(){const t=this;if(!t.#H()){if(!(t.isValidEnvironment&&t.isValidBrowser&&t.isValidOS))return t.remove();t.id||(t.id=GSID.id),t.#j=t.#U(),t.#R=t.#j.ref,GSComponents_GSComponents.store(t),t.#P()}}disconnectedCallback(){const t=this;t.#F=!0,t.#N&&t.#N.disconnect(),GSComponents_GSComponents.remove(t),GSEvent.deattachListeners(t),t.#B(),t.#N=null,t.#I=null,t.#j=null}attributeChangedCallback(t,e,s){const r=this;"orientation"===t&&r.#q(),"id"===t&&(GSComponents_GSComponents.remove(e),GSComponents_GSComponents.store(r)),r.#_&&GSUtil.requestAnimationFrame((()=>{r.attributeCallback(t,e,s)}))}attributeCallback(t,e,s){}onReady(){const t=this;if(t.offline)return;t.#_=!0;const e=GSFunction.parseFunction(t.onready);GSFunction.callFunction(e),GSEvent.send(document.body,"componentready",t)}#q(t){const e=this;GSUtil.requestAnimationFrame((()=>{e.offline||(e.isValidOrientation?e.show(!0):e.hide(!0))}))}#H(){const t=GSComponents_GSComponents.getOwner(this,GSElement);return t&&t.isProxy}#V(){const t=this;GSUtil.requestAnimationFrame((()=>{t.updateUI()}))}get#z(){const t=this;return t.shadowRoot||(t.attachShadow({mode:"open"}),t.#N=GSDOMObserver.create(t.#z),t.updateUI()),t.shadowRoot}get#W(){const t=this;return t.#R&&t.isFlat||!t.#R}async#Y(){const t=this;if(t.offline)return;const e=t.#W,s=e?await t.getTemplate(t.template):t.outerHTML;await GSEvent.waitAnimationFrame((()=>{if(t.offline)return;const r=t.#j;if(t.#R)return e?t.#I=GSDOM_GSDOM.parseWrapped(t,s,!0):(t.#I=GSDOM_GSDOM.parse(s,!0),t.#I.id=t.id,t.id=GSID.id),GSDOM_GSDOM.link(t,t.#I),void GSDOM_GSDOM.insertAdjacent(r.target,t.#I,r.anchor);if(r.target!==t){if(r.target===t.parentElement)return t.#I=t.isFlat?t:t.#z,void GSDOM_GSDOM.setHTML(t.#I,s);t.#I=GSDOM_GSDOM.parseWrapped(t,s,!0),GSDOM_GSDOM.link(t,t.#I),GSDOM_GSDOM.insertAdjacent(r.target,t.#I,r.anchor)}else if(t.isFlat)if(s){const e=GSDOM_GSDOM.parseWrapped(t,s,!1);t.#I=e,GSDOM_GSDOM.insertAdjacent(r.target,e,r.anchor)}else t.#I=t;else t.#I=t.#z,GSDOM_GSDOM.setHTML(t.#I,s)})),t.updateUI()}#U(){const t=this,e=t.anchor,s=e.indexOf("@");let r=s>0?e.slice(0,s):e,n=s>0?e.slice(s+1):"self";"self"!==r&&"parent"!==r||(n=n||r,r=null),r=GSUtil.normalize(r,"beforeend"),n=GSUtil.normalize(n,"self");let i=null;switch(n){case"self":i=t;break;case"parent":i=t.parentElement;break;default:i=GSDOM_GSDOM.query(document.documentElement,n)}if(!i){const e=`Injection point not available!\nElement: ${t.tagName}, Id:${t.id}, tgt:${n}`;throw GSLog.error(t,e),new Error(e)}return{anchor:r,target:i,ref:!(i===t||i===t.parentElement)}}#B(){const t=this;t.#I&&t.#I.remove&&(t.#I.remove(),t.#I=null)}async#P(){const t=this;await t.#Y(),t.offline||t.#W&&(t.isFlat||t.attachEvent(document,"gs-style",t.#V.bind(t)),t.attachEvent(screen.orientation,"change",t.#q.bind(t)),GSUtil.requestAnimationFrame((()=>t.onReady())))}}class SidebarUI extends GSElement{static{customElements.define("gs-admin-shell-sidebar",SidebarUI),Object.seal(SidebarUI)}async getTemplate(){return super.getTemplate("//shell/sidebar.html")}onReady(){super.onReady();const t=!0===Tn5250?.opt?.tunnel,e=this.query('[data-inject="gs-admin-view-tunnel"]');GSDOM_GSDOM.toggleClass(e,!t,"d-none")}}class Utils{static dataToBlob(t){const e=new Blob([t],{type:"text/html"});return URL.createObjectURL(e)}static releaseBlob(t){0===(t||"").indexOf("blob:")&&URL.revokeObjectURL(t)}static async download(t="",e){const s=document.createElement("a");s.href=Utils.dataToBlob(e),s.download=t,s.click(),await GSUtil.timeout(1e3),Utils.releaseBlob(s.href)}static openInNewTab(t="",e,s,r="_blank"){const n=(t||"").length>0?t:Utils.dataToBlob(e),i=window.open(n,r,s||null);if(!(i&&"function"==typeof i.focus))return Utils.releaseBlob(n),void alert("Browser is blocking popup!");i.addEventListener("beforeuload",(()=>Utils.releaseBlob(n)))}static toHex(t,e,s){const r=[];return Utils.wrap(t).forEach((t=>{r.push(t.toString(16).padStart(2,0))})),e?r.join(s||""):r}static fromHex(t,e,s){const r=[];Utils.wrap(t).forEach((t=>{r.push(parseInt(t,16))}))}static isHexString(t){return!!GSUtil.isString(t)&&/^[0-9A-Fa-f]+$/g.test(t)}static splitHexString(t){return t.match(/.{1,2}/g)}static wrap(t){if(GSUtil.isString(t)){if(Utils.isHexString(t))return Utils.splitHexString(t);t=Utils.base64ToBuffer(t)}return t instanceof Uint8Array||(t=new Uint8Array(t)),t}static unwrap(t){if("string"==typeof t){if(Utils.isHexString(t))return Utils.splitHexString(t);t=Utils.base64ToBuffer(t)}return t instanceof Uint8Array&&(t=Array.from(t)),t}static base64ToBuffer(t){const e=globalThis.atob(t),s=e.length,r=new Uint8Array(s);for(let t=0;t<s;t++)r[t]=e.charCodeAt(t);return r.buffer}}class HeaderUI extends GSElement{static{customElements.define("gs-admin-shell-header",HeaderUI),Object.seal(HeaderUI)}async getTemplate(){return super.getTemplate("//shell/header.html")}onReady(){super.onReady();const t=this;t.on("action",t.#J.bind(t)),t.queryAll("gs-dropdown").forEach((e=>t.attachEvent(e,"action",t.#J.bind(t))))}#J(t){const e=this,s=(t?.detail?.action||t?.detail?.source?.target?.dataset?.action).split("-").map(((t,s)=>0===s?t:e.#K(t))).join("");GSFunction.isFunction(e[s])&&e[s](t)}#K(t){return t.charAt(0).toUpperCase()+t.slice(1)}get notify(){return GSComponents.get("notification")}async logout(){await io.greenscreens.Session.closeSession(),document.body.innerHTML="<gs-admin-login></gs-admin-login>"}explorer(){Utils.openInNewTab("/admin/explorer.jsp",null,"toolbar=no,scrollbars=yes,resizable=yes")}async restart(){const t=this;if(!globalThis.confirm("Are you sure you want to restart the server? All data will be lost."))return;t.notify.info("Info","Restart server requested");const e=await io.greenscreens.Server.restart();e.success?t.notify.info("Info","Server is restarting! <br>Wait about 1min. then refresh browser."):t.notify.danger("Info",e.msg)}async certClientVerify(){const t=await io.greenscreens.Certificate.verifySSLClient(2);if(!t.success)return this.notify.danger("Error",t.msg);const e=t.msg||"Client SSL verification changed.";this.notify.info("Info",e+"<br>Restart server to apply changes.")}async certGenTerm(){const t=await io.greenscreens.Server.regenerate();if(t.success&&"RSA"===t.code)return this.notify.info("Info","New encryption keys generated");this.notify.danger("Error",t.msg)}async certGenReq(){const t=await io.greenscreens.Certificate.request(!0);if(!t.success)return this.notify.danger("Error",t.data.msg||"Certificate not generated");Utils.download("server_request.txt",t.data.requestPem),Utils.download("server_private.txt",t.data.privatePem),Utils.download("server_public.txt",t.data.publicPem)}async certGenSvr(){if(!confirm("Are you sure? Action will overwrite existnig certificate."))return;(await io.greenscreens.Certificate.generate(!0)).success?this.notify.info("Info","New server certificate generated! <br> Please, restart server for changes to apply."):this.notify.danger(res.msg)}async registerWebAuthn(){console.log("==> Register WebAuthn")}certExport(){Utils.openInNewTab("/services/certificate")}downloadSavf(){Utils.openInNewTab("/services/admintransfer?type=savf")}downloadConfig(){Utils.openInNewTab("/services/admintransfer?type=conf")}downloadLogs(){Utils.openInNewTab("/services/admintransfer?type=log")}}class ShellUI extends GSElement{static{customElements.define("gs-admin-shell",ShellUI),Object.seal(ShellUI)}async getTemplate(){return super.getTemplate("//shell.html")}onReady(){super.onReady()}}class GSModal extends GSElement{static#X=["ok","cancel"];static{customElements.define("gs-modal",GSModal),Object.seal(GSModal)}static get observedAttributes(){return GSElement.observeAttributes(["cancelable","closable","title","visible"])}attributeCallback(t="",e="",s=""){const r=this;r.#Z(),"visible"===t&&(r.visible?(r.#Q(".modal"),r.#Q(".modal-backdrop"),r.focusable().focus()):(r.#tt(".modal"),r.#tt(".modal-backdrop"),r.normal()),GSEvent.send(r,"visible",{type:"modal",ok:r.visible},!0,!0))}onReady(){const t=this;t.attachEvent(t,"click",t.#et.bind(t)),t.attachEvent(t,"action",t.#et.bind(t)),t.attachEvent(t,"form",t.#st.bind(t)),t.attachEvent(document,"keyup",t.#rt.bind(t)),super.onReady(),t.visible&&t.open()}#st(t){GSEvent.prevent(t);GSEvent.send(this,"data",{type:"modal",data:t.detail.data,evt:t},!0,!0,!0)&&this.close()}#rt(t){this.cancelable&&"Escape"===t.key&&this.close()}#et(t){const e=this,s=e.#nt(t);if(!s)return;const r="ok"===s,n=GSDOM_GSDOM.queryAll(e,"form");if(r&&n.length>0){const t=n.filter((t=>0==t.checkValidity()));t.forEach((t=>e.#it(t))),0===t.length&&n.forEach((t=>e.#at(t)));const s=t.map((t=>GSDOM_GSDOM.queryAll(t,"textarea, input, select").filter((t=>0==t.checkValidity()))));return void(s.length>0&&GSEvent.send(e,"error",{type:"modal",data:s},!0,!0,!0))}let i=!0;try{i=GSEvent.send(e,"action",{type:"modal",ok:r,evt:t},!0,!0,!0)}finally{i&&e.close(null,r)}}#at(t){try{GSEvent.send(t,"action",{action:"submit"})}catch(t){console.log(t)}}#it(t){try{t.reportValidity()}catch(t){console.log(t)}}#ot(t){const e=t.composedPath().shift();return e?.dataset?.action||t.detail.action||e?.type}#nt(t){const e=this.#ot(t),s=GSModal.#X.includes(e);return s&&GSEvent.prevent(t),s?e:null}#ct(t=""){const e=this.query(".modal-dialog");e&&requestAnimationFrame((()=>{e.classList.remove("modal-xl","modal-lg"),t&&e.classList.add(t)}))}large(){this.#ct("modal-lg")}extra(){this.#ct("modal-xl")}normal(){this.#ct()}info(t="",e="",s=!1,r=!1){const n=this;if(n.title=t,n.body=e,n.cancelable=r,n.closable=s,n.open(),s||r)return n.waitEvent("action")}confirm(t="",e=""){return this.info(t,e,!0,!1)}prompt(t="",e=""){return this.info(t,e,!0,!0)}open(t){GSEvent.prevent(t);GSEvent.send(this,"open",{type:"modal"},!0,!0,!0)&&(this.visible=!0)}close(t,e=!1){GSEvent.prevent(t);GSEvent.send(this,"close",{type:"modal",isOk:e},!0,!0,!0)&&(this.visible=!1)}toggle(){this.visible=!this.visible}focusable(){const t=this;return t.cancelable?t.#lt:t.closable?t.#ut:t}get#ut(){return this.query(".modal-ok")}get#lt(){return this.query(".modal-cancel")}#Q(t){const e=this.query(t);e&&(e.classList.remove("d-none"),e.classList.add("show","d-block"))}#tt(t){const e=this.query(t);e&&(e.classList.add("d-none"),e.classList.remove("show","d-block"))}#Z(){const t=this;GSDOM_GSDOM.toggleClass(t.#ut,!t.closable),GSDOM_GSDOM.toggleClass(t.#lt,!t.cancelable);const e=`justify-content-${t.align}`,s=t.query(".modal-footer");GSDOM_GSDOM.toggleClass(s,!0,e)}#dt(t="",e=""){let s=t?this.self.querySelector(`[slot="${t}"]`):null;return s||(s=this.self.querySelector(e)),s}get title(){return this.#dt("title",".modal-title")}set title(t=""){GSDOM_GSDOM.setHTML(this.title,t)}get body(){return this.#dt("body",".modal-body")}set body(t=""){GSDOM_GSDOM.setHTML(this.body,t)}get visible(){return GSAttr.getAsBool(this,"visible",!1)}set visible(t=!1){GSAttr.setAsBool(this,"visible",t)}get closable(){return GSAttr.getAsBool(this,"closable",!0)}set closable(t=!0){GSAttr.setAsBool(this,"closable",t),this.#Z()}get cancelable(){return GSAttr.getAsBool(this,"cancelable",!0)}set cancelable(t=!0){GSAttr.setAsBool(this,"cancelable",t),this.#Z()}get align(){return GSAttr.get(this,"align","end")}set align(t="end"){GSAttr.set(this,"align",t),this.#Z()}get buttonOk(){return GSAttr.get(this,"button-ok","Ok")}set buttonOk(t="Ok"){GSAttr.set(this,"button-ok",t)}get buttonCancel(){return GSAttr.get(this,"button-cancel","Cancel")}set buttonCancel(t="Cancel"){GSAttr.set(this,"button-cancel",t)}get cssButtonOk(){return GSAttr.get(this,"css-button-ok","btn-primary")}get cssButtonCancel(){return GSAttr.get(this,"css-button-cancel","btn-secondary")}get cssModal(){return GSAttr.get(this,"css-modal","")}get cssContent(){return GSAttr.get(this,"css-content","")}get cssHeader(){return GSAttr.get(this,"css-header","")}get cssTitle(){return GSAttr.get(this,"css-title","")}get cssBody(){return GSAttr.get(this,"css-body","")}get cssFooter(){return GSAttr.get(this,"css-footer","")}set cssModal(t=""){return GSAttr.set(this,"css-modal",t)}set cssContent(t=""){return GSAttr.set(this,"css-content",t)}set cssHeader(t=""){return GSAttr.set(this,"css-header",t)}set cssTitle(t=""){return GSAttr.set(this,"css-title",t)}set cssBody(t=""){return GSAttr.set(this,"css-body",t)}set cssFooter(t=""){return GSAttr.set(this,"css-footer",t)}async getTemplate(t=""){if(t)return super.getTemplate(t);const e=this;return`\n         <div class="modal d-none fade ${e.cssModal}">\n         <div class="modal-dialog modal-dialog-centered">\n           <div class="modal-content ${e.cssContent}">\n             <div class="modal-header border-0 ${e.cssHeader}">\n               <div class="modal-title ${e.cssTitle}">\n                 <slot name="title"></slot>\n               </div>\n             </div>\n             <div class="modal-body ${e.cssBody}">\n               <slot name="body"></slot>\n             </div>\n             <div class="modal-footer border-0 justify-content-${e.align} ${e.cssFooter}">\n               <button class="btn ${e.cssButtonCancel} modal-cancel" data-action="cancel">${e.buttonCancel}</button>\n               <button class="btn ${e.cssButtonOk} modal-ok" data-action="ok">${e.buttonOk}</button>\n             </div>\n           </div>\n         </div>\n       </div>\n       <div class="modal-backdrop d-none fade "></div>    \n     `}}class FormTunnel extends GSModal{static{customElements.define("gs-admin-form-tunnel",FormTunnel),Object.seal(FormTunnel)}get nameField(){return GSDOM.query(this,'input[name="name"]')}onReady(){super.onReady();const t=this;t.on("visible",t.#ht.bind(t))}#ht(t){const e=this,s=e.nameField?.value?.trim().length>0;GSAttr.toggle(e.nameField,"readonly",s),GSAttr.toggle(e.nameField,"disabled",s)}}class FormService extends GSModal{#mt=null;static{customElements.define("gs-admin-form-service",FormService),Object.seal(FormService)}get valueField(){return GSDOM.query(this,'input[name="value"]')}convert(t){switch(this.#mt){case"checkbox":t.value="true"==t.value;break;case"number":t.value=parseInt(t.value,10)}}updateValue(t){const e=this;e.#mt=e.valueToType(t),GSAttr.set(e.valueField,"type",e.#mt),"checkbox"===e.#mt?(e.valueField.className="form-check-input",e.valueField.parentElement.className="form-check form-switch fs-4",e.valueField.checked=t):(e.valueField.className="form-control",e.valueField.parentElement.className="")}valueToType(t){const e=typeof t;return"boolean"===e?"checkbox":"string"===e?"text":"number"}}class GSLinkExt extends HTMLLinkElement{#gt=null;constructor(){super();const t=this;t.order||(t.order=GSBase.nextID()),t.isCSS&&(t.#gt=setInterval(t.#St.bind(t),1))}connectedCallback(){}disconnectedCallback(){if(!this.isCSS)return;const t=GSCacheStyles.remove(this.order);GSBase.sendSuspendedEvent(document,"gs-style",t)}#St(){const t=this;if(!t.sheet)return;clearInterval(t.#gt),GSCacheStyles.injectStyle(t.asText,t.order);const e=GSCacheStyles.get(t.order);GSBase.sendSuspendedEvent(document,"gs-style",e)}get asText(){return Object.values(this.sheet.cssRules).map((t=>t.cssText)).join("")}get sheet(){const t=this;return Object.values(document.styleSheets).filter((e=>e.ownerNode===t)).pop()}get isCSS(){return"stylesheet"===this.rel||this.href.includes(".css")}get order(){return this.getAttribute("order")}set order(t=""){return this.setAttribute("order",t)}static{customElements.define("gs-ext-link",GSLinkExt,{extends:"link"}),Object.freeze(GSLinkExt)}}class GSStyleExt extends HTMLStyleElement{#gt=null;constructor(){super();const t=this;t.order||(t.order=GSBase.nextID()),t.#gt=setInterval(t.#St.bind(t),1)}connectedCallback(){}disconnectedCallback(){const t=GSCacheStyles.remove(this.order);GSBase.sendSuspendedEvent(document,"gs-style",t)}#St(){const t=this;if(!t.sheet)return;clearInterval(t.#gt),GSCacheStyles.injectStyle(t.asText,t.order);const e=GSCacheStyles.get(t.order);GSBase.sendSuspendedEvent(document,"gs-style",e)}get asText(){return Object.values(this.sheet.cssRules).map((t=>t.cssText)).join("")}get sheet(){const t=this;return Object.values(document.styleSheets).filter((e=>e.ownerNode===t)).pop()}get order(){return this.getAttribute("order")}set order(t=""){return this.setAttribute("order",t)}static{Object.freeze(GSStyleExt),customElements.define("gs-ext-style",GSStyleExt,{extends:"style"})}}class GSCSS extends GSBase{static get observedAttributes(){return["disabled"].concat(super.observedAttributes)}attributeCallback(t,e,s){const r=this;if("disabled"===t)return r.isDisabled?r.dispose():r.render()}constructor(){super();const t=this;t.disabled=0==t.notheme&&t.theme!==GSCSS.activeTheme}async render(){const t=this;if(!t.isDisabled){t.order||(t.order=GSBase.nextID());try{const e=await fetch(t.url);if(!e.ok)return;const s=await e.text();GSCacheStyles.injectStyle(s,t.order);const r=GSCacheStyles.get(t.order);r&&GSBase.sendSuspendedEvent(document,"gs-style",r)}catch(e){GSCacheStyles.remove(t.order),console.log(e)}}}dispose(){const t=this;if(!t.isAuto)return;const e=GSCacheStyles.get(t.order);GSCacheStyles.remove(t.order),GSBase.sendSuspendedEvent(document,"gs-style",e),document.adoptedStyleSheets=GSCacheStyles.styles}get order(){return this.getAttribute("order")}set order(t=""){return this.setAttribute("order",t)}get notheme(){return"true"===this.getAttribute("notheme")}get disabled(){return this.getAttribute("disabled")}set disabled(t=""){return this.setAttribute("disabled",""+t=="true")}get isDisabled(){return"true"===this.disabled}get theme(){return this.getAttribute("theme")||"default"}static get activeTheme(){return new URLSearchParams(location.hash.slice(1)).get("theme")||"default"}static#pt(t){const e=GSCSS.activeTheme;Array.from(document.querySelectorAll("gs-css")).filter((t=>0==t.notheme)).forEach((t=>t.disabled=t.theme!==e))}static{Object.freeze(GSCSS),customElements.define("gs-css",GSCSS),window.addEventListener("hashchange",GSCSS.#pt,!1)}}class GSScript extends GSBase{render(){const t=this,e=document.createElement("script");return e.src=t.url,t.getAttributeNames().filter((t=>"url"!==t)).forEach((s=>e.setAttribute(s,t.getAttribute(s)))),e}static{customElements.define("gs-script",GSScript),Object.freeze(GSScript)}}class GSLink extends GSBase{render(){const t=this,e=document.createElement("link");return e.href=t.url,t.getAttributeNames().filter((t=>"url"!==t)).forEach((s=>e.setAttribute(s,t.getAttribute(s)))),t.shadow&&"stylesheet"===e.rel&&e.setAttribute("is","gs-ext-link"),e}get rel(){const t=this;let e=t.getAttribute("rel")||"";return e||t.url.includes(".css")&&(e="stylesheet"),e}get shadow(){return"true"===this.getAttribute("shadow")}static{customElements.define("gs-link",GSLink),Object.freeze(GSLink)}}class GSCacheTemplate{static _store=new Map;static store(t,e){this._store.set(t,e)}static remove(t){return this._store.delete(t)}static load(t){return this._store.get(t)}static getOrCreate(t,e){const s=GSCacheTemplate;let r=s.load(t);return r||(r=s.create(e),s.store(t,r),r)}static create(t){const e=document.createElement("template");return GSDOM_GSDOM.setHTML(e,t),e}static clone(t){return GSDOM_GSDOM.isTemplateElement(t)?t.content.cloneNode(!0):null}static isFunctionTemplate(t){const e=GSFunction.parseFunction(t);return!!GSFunction.isFunction(e)&&e}static isHTMLTemplate(t){const e=t?t.trim():"";return!!/^<(.*)>$/s.test(e)&&t}static isURLTemplate(t){const e=t?t.trim():"";return!!/^(https?:\/\/|.{0,2}\/{1,2})/i.test(e)&&t}static initTemplate(t=!1,e="",s){const r=GSCacheTemplate;return t?r.getOrCreate(e,s):r.create(s)}static loadHTMLTemplate(t=!1,e="",s){const r=GSCacheTemplate,n=r.isHTMLTemplate(s);return n?r.initTemplate(t,e,n):n}static async loadURLTemplate(t=!1,e="",s){const r=GSCacheTemplate,n=s;try{let s=null;return t&&(s=r.load(n)),s?s:(s=await GSLoader.loadTemplate(n),r.initTemplate(t,e,s))}catch(t){GSLog.error(r,t)}return!1}static async loadFunctionTemplate(t=!1,e="",s){const r=GSCacheTemplate,n=r.isFunctionTemplate(s);if(!n)return n;try{let s=null;return r.cached&&(s=r.load(o)),s?s:(s=GSFunction.isFunctionAsync(n)?await n():n(),r.initTemplate(t,e,s))}catch(t){GSLog.error(r,t)}return n}static async loadTemplate(t=!1,e="",s){if(!e)return!1;if(!s)return!1;const r=GSCacheTemplate;let n=!1;return 0==s.indexOf("#")&&(n=document.getElementById(s.slice(1))),n||(n=r.loadHTMLTemplate(t,e,s)),n||(n=await r.loadFunctionTemplate(t,e,s)),n||(n=await r.loadURLTemplate(t,e,s)),n}}class GSTemplate extends HTMLElement{#Gt=!1;#I=null;#N=null;static get observedAttributes(){return["href"]}constructor(){super()}get id(){return GSAttr.get(this,"id")}set id(t){GSAttr.set(this,"id",t)}get href(){return GSAttr.get(this,"href")}set href(t){GSAttr.set(this,"href",t)}get isFlat(){return GSUtil.FLAT||GSAttr.getAsBool(this,"flat",!1)}get self(){return this.#I||this.shadowRoot}get environment(){return GSAttr.get(this,"environment","")}set environment(t){GSAttr.set(this,"environment",t)}get os(){return GSAttr.get(this,"os","")}set os(t){GSAttr.set(this,"os",t)}get browser(){return GSAttr.get(this,"browser","")}set browser(t){GSAttr.set(this,"browser",t)}attributeChangedCallback(t,e,s){this.#Gt&&"href"===t&&this.loadTemplate()}connectedCallback(){const t=this,e=t.parentElement;if(!e||"GS-ITEM"!=e.tagName){if(!(t.isValidEnvironment&&t.isValidBrowser&&t.isValidOS))return t.remove();t.id||(t.id=GSID.id),t.#Gt=!0,GSComponents_GSComponents.store(t),t.loadTemplate()}}disconnectedCallback(){const t=this;t.#Gt=!1,t.#B(),t.#N&&t.#N.disconnect(),GSComponents_GSComponents.remove(t),GSCacheTemplate.remove(t.id)}#B(){const t=this;t.#I&&(t.#I.remove(),t.#I=null)}get isValidEnvironment(){return GSEnvironment.isValidEnvironment(this.environment)}get isValidOS(){return GSEnvironment.isDevice(this.os)}get isValidBrowser(){return GSEnvironment.isValidBrowser(this.browser)}get shadow(){const t=this;return!t.shadowRoot&&t.#Gt&&(t.attachShadow({mode:"open"}),t.#N=GSDOMObserver.create(t.shadowRoot)),t.shadowRoot}async loadTemplate(){const t=this,e=await GSCacheTemplate.loadTemplate(!0,t.id,t.href);return e?t.parentElement instanceof HTMLHeadElement?(GSEvent.sendSuspended(document,"gs-template",{id:t.id,href:t.href}),e):(await GSEvent.waitAnimationFrame((async()=>{if(t.#Gt){if(t.isFlat){const s=GSDOM_GSDOM.parseWrapped(t,e.innerHTML);t.#I=t.insertAdjacentElement("afterend",s)}else t.shadow.adoptedStyleSheets=GSCacheStyles.styles,GSDOM_GSDOM.setHTML(t.shadow,e.innerHTML);GSEvent.sendSuspended(t,"templateready",{id:t.id,href:t.href},!0,!0)}})),e):(GSLog.error(this,`Template not found for: Id=${t.id}; href=${t.href}`),!1)}waitWhenReady(t=""){return t&&(this.href=t),this.waitEvent("templateready")}waitEvent(t=""){const e=this;return new Promise(((s,r)=>{if(!t)return r("Event undefined!");GSEvent.once(e,null,t,(t=>s(t.detail)),{once:!0})}))}query(t=""){return GSDOM_GSDOM.query(this,t)}queryAll(t="",e=!1){return GSDOM_GSDOM.queryAll(this,t)}static{customElements.define("gs-template",GSTemplate),Object.seal(GSTemplate)}}class GSDataListExt extends HTMLDataListElement{static{customElements.define("gs-ext-datalist",GSDataListExt,{extends:"datalist"}),Object.seal(GSDataListExt)}constructor(){super()}static get observedAttributes(){return["data"]}attributeChangedCallback(t,e,s){"data"===t&&this.load(s)}connectedCallback(){const t=this;t.id||t.setAttribute("id",GSID.id),GSComponents_GSComponents.store(t)}disconnectedCallback(){GSComponents_GSComponents.remove(this)}get owner(){const t=GSComponents_GSComponents.getOwner(this);return GSDOM_GSDOM.unwrap(t)}async load(t=""){if(!t)return;const e=await GSLoader.loadSafe(t,"GET",null,!0);this.apply(e)}apply(t){if(!Array.isArray(t))return!1;const e=this;return requestAnimationFrame((()=>{const s=[];t.forEach((t=>{s.push(e.#ft(t))})),GSDOM_GSDOM.setHTML(e,s.join("\n"))})),!0}#ft(t){const e=["<option"];return Object.entries(t).forEach((t=>{const s=t[0],r=t[1];if("text"!==s)return"selected"===s?e.push(s):void e.push(`${s}="${r}"`)})),e.push(t.text),e.push(">"),e.join(" ")}}class GSComboExt extends HTMLSelectElement{static{customElements.define("gs-ext-select",GSComboExt,{extends:"select"}),Object.seal(GSComboExt)}constructor(){super()}static get observedAttributes(){return["data"]}attributeChangedCallback(t,e,s){"data"===t&&this.load(s)}connectedCallback(){const t=this;t.id||t.setAttribute("id",GSID.id),GSComponents_GSComponents.store(t)}disconnectedCallback(){GSComponents_GSComponents.remove(this)}get owner(){const t=GSComponents_GSComponents.getOwner(this);return GSDOM_GSDOM.unwrap(t)}async load(t=""){if(!t)return;const e=await GSLoader.loadSafe(t,"GET",null,!0);this.apply(e)}apply(t){if(!Array.isArray(t))return!1;const e=this;return requestAnimationFrame((()=>{const s=[];t.forEach((t=>{s.push(e.#ft(t))})),GSDOM_GSDOM.setHTML(e,s.join("\n"))})),!0}#ft(t){const e=["<option"];return Object.entries(t).forEach((t=>{const s=t[0],r=t[1];if("text"!==s)return"selected"===s?e.push(s):void e.push(`${s}="${r}"`)})),e.push(">"),e.push(t.text),e.push("</option>"),e.join(" ")}}class GSFormExt extends HTMLFormElement{static#X=["ok","reset","submit"];static{customElements.define("gs-ext-form",GSFormExt,{extends:"form"}),Object.seal(GSFormExt),GSDOMObserver.registerFilter(GSFormExt.#bt,GSFormExt.#vt),GSDOMObserver.registerFilter(GSFormExt.#bt,GSFormExt.#yt,!0)}static#bt(t){return t instanceof HTMLFormElement&&t instanceof GSFormExt==!1}static#vt(t){GSFormExt.#At(t)}static#yt(t){GSEvent.deattachListeners(t)}constructor(){super()}static get observedAttributes(){return["mask"]}connectedCallback(){const t=this;t.id||t.setAttribute("id",GSID.id),GSFormExt.#At(t)}disconnectedCallback(){GSEvent.deattachListeners(this)}static#At(t){GSEvent.attach(t,t,"submit",GSFormExt.#Dt.bind(t)),GSEvent.attach(t,t,"action",GSFormExt.#J.bind(t)),GSEvent.attach(t,t,"click",GSFormExt.#J.bind(t))}static#J(t){const e=t.composedPath().shift(),s=e?.dataset.action||t.detail.action||e?.type;if(!GSFormExt.#X.includes(s))return;GSEvent.prevent(t);const r=this;switch(s){case"reset":r.reset();break;case"ok":case"submit":GSFormExt.#Dt(t,r)}}static#Dt(t,e){GSEvent.prevent(t);const s=e||this,r=s.checkValidity()&&s.isValid;if(!r)return s.reportValidity();const n={type:r?"submit":"invalid",data:GSDOM_GSDOM.toObject(s),source:t,valid:r};GSEvent.send(s,"form",n,!0,!0)}get isValid(){return 0===GSDOM_GSDOM.queryAll(this,"input,select,textarea").map((t=>t.checkValidity())).filter((t=>!1===t)).length}get buttonOK(){return GSFormExt.#Mt(this)}get buttonCancel(){return GSFormExt.#Et(this)}get buttonReset(){return GSFormExt.#Ot(this)}static#Mt(t){return GSDOM_GSDOM.query(t,'button[type="submit"]')}static#Et(t){return GSFormExt.#wt(t,"cancel")}static#Ot(t){return GSFormExt.#wt(t,"reset")}static#wt(t,e=""){return GSDOM_GSDOM.query(t,`button[data-action="${e}"]`)}}class GSInputExt extends HTMLInputElement{static#Ct=".^$*+-?()[]{}|—/";static#Tt={y:"[0-9]",m:"[0-9]",d:"[0-9]",Y:"[0-9]",M:"[0-9]",D:"[0-9]}",9:"[0-9]","#":"[0-9a-fA-F]",x:"[a-z]",X:"[A-Z]",s:"[0-9a-zA-Z]",S:"[0-9a-zA-Z]"};#xt=[];static{customElements.define("gs-ext-input",GSInputExt,{extends:"input"}),Object.seal(GSInputExt)}constructor(){super()}static get observedAttributes(){return["mask"]}connectedCallback(){const t=this;t.id||t.setAttribute("id",GSID.id),0===t.placeholder.length&&t.mask&&(t.placeholder=t.mask),t.#Lt(),t.#At(),GSComponents_GSComponents.store(t)}disconnectedCallback(){GSComponents_GSComponents.remove(this),GSEvent.deattachListeners(this)}attributeChangedCallback(t,e,s){"mask"===t&&this.#Lt()}get owner(){const t=GSComponents_GSComponents.getOwner(this);return GSDOM_GSDOM.unwrap(t)}get list(){const t=GSAttr.get(this,"list");return GSDOM_GSDOM.getByID(this.owner,t)}get filter(){const t=GSAttr.get(this,"data-filter");return GSDOM_GSDOM.getByID(this.owner,t)}get mask(){return GSAttr.get(this,"mask","")}get strict(){return GSAttr.get(this,"strict","")}#Lt(){const t=this;if(0===t.mask.length)return;const e=t.mask.split(""),s=[];t.#xt=[],e.forEach((e=>{if(GSInputExt.#Ct.includes(e))return t.#xt.push(e),void s.push("${v}");const r=GSInputExt.#Tt[e];return r?(t.#xt.push(new RegExp(r,"g")),void s.push(r)):void 0})),t.pattern=s.join("")}#At(){const t=this;GSEvent.attach(t,t,"input",t.#kt.bind(t)),GSEvent.attach(t,t,"blur",t.#$t.bind(t)),requestAnimationFrame((()=>{t.list&&(GSEvent.attach(t,t,"change",t.#_t.bind(t)),GSEvent.attach(t,t.filter,"change",t.#Ft.bind(t)))}))}#It(t,e="",s=""){const r=GSAttr.get(t,`data-${e}`,"").split(/[,;;]/),n=s.length>0&&r.includes(s);n?GSDOM_GSDOM.show(t):GSDOM_GSDOM.hide(t),GSDOM_GSDOM.queryAll(t,"input,textarea,select").forEach((t=>GSAttr.set(t,"data-ignore",!n||null)))}isInList(){const t=this,e=t.list;if(!e)return!0;if(!t.strict)return!0;if(!e.querySelector("option"))return!0;return null!=e.querySelector(`option[value="${t.value}"]`)}#_t(t){const e=this,s=e.owner;let r=GSDOM_GSDOM.query(e.list,`option[value="${e.value}"]`),n=!1;r||(r=e.list.querySelector("option"),n=!0);const i=r.dataset;Object.entries(i).forEach((t=>{const r=n?"":t[1],i=t[0];if(e.setAttribute(`data-${i}`,t[1]),"id"===i||"group"===i)return;const a=`[data-${i}]:not([data-${i}=""]`;Array.from(GSDOM_GSDOM.queryAll(s,a)).filter((t=>"OPTION"!==t.tagName)).filter((t=>null==GSAttr.get(t,"list",null))).forEach((t=>e.#It(t,i,r)))}))}#Ft(t){const e=this,s=e.list;e.value="";const r=GSAttr.get(e.filter,"data-group");GSDOM_GSDOM.queryAll(s,"option").forEach((t=>GSAttr.set(t,"disabled",!0)));const n=r?`option[data-group="${r}"]`:`option[data-id="${t.target.value}"]`;GSDOM_GSDOM.queryAll(s,n).forEach((t=>GSAttr.set(t,"disabled")))}#$t(t){const e=this;e.reportValidity(),e.isInList()||GSEvent.send(e,"strict",{ok:!1,source:t})}#kt(t){const e=this;return"number"===e.type?e.#Nt(t):e.mask?e.#Rt(t):"text"===e.type?e.#jt(t):void 0}#Nt(t){const e=this;e.value.length>e.maxLength&&(e.value=e.value.substring(0,e.maxLength))}#jt(t){const e=this;e.checkValidity()||e.reportValidity()}#Rt(t){const e=this,s=e.value.split("").slice(0,e.#xt.length);s.forEach(((t,r)=>{const n=e.#xt[r];return"string"==typeof n?s[r]=n:n instanceof RegExp?(n.lastIndex=0,void(n.test(t)||(s[r]=""))):void(s[r]="")})),e.value=s.join("")}}class GSNavLinkExt extends HTMLAnchorElement{static CSS_TAB_ACTIVE="text-bg-primary";static CSS_TAB_INACTIVE="text-bg-secondary";static{customElements.define("gs-ext-navlink",GSNavLinkExt,{extends:"a"}),Object.seal(GSNavLinkExt),GSDOMObserver.registerFilter(GSNavLinkExt.#bt,GSNavLinkExt.#vt),GSDOMObserver.registerFilter(GSNavLinkExt.#bt,GSNavLinkExt.#yt,!0)}static#bt(t){let e=t instanceof HTMLElement&&"gs-ext-navlink"!==GSAttr.get(t,"is");if(e){const s=t.classList;e=!t.hasAttribute("ignore")&&(s.contains("nav-link")||s.contains("list-group-item"))}return e}static#vt(t){GSNavLinkExt.#At(t)}static#yt(t){GSEvent.deattachListeners(t)}constructor(){super()}connectedCallback(){const t=this;t.id||t.setAttribute("id",GSID.id),GSNavLinkExt.#At(t)}disconnectedCallback(){GSEvent.deattachListeners(this)}static#At(t){GSEvent.attach(t,t,"click",GSNavLinkExt.#et.bind(t))}static#et(t,e){const s=e||this;if("false"===s.dataset.selectable)return GSNavLinkExt.#Ht(t,s);const r=GSNavLinkExt.#Ut(s),n=GSNavLinkExt.#Pt(s),i=GSNavLinkExt.#Bt(s),a=GSNavLinkExt.#qt(s);requestAnimationFrame((()=>{n&&n.querySelectorAll(".list-group-item").forEach((t=>GSDOM_GSDOM.toggleClass(t,!1,"active"))),r&&r.querySelectorAll(".nav-link").forEach((t=>GSDOM_GSDOM.toggleClass(t,!1,"active"))),i&&i.querySelectorAll(".tab-pane").forEach((t=>GSDOM_GSDOM.toggleClass(t,!1,"active show"))),GSDOM_GSDOM.toggleClass(s,!0,"active"),GSDOM_GSDOM.toggleClass(a,!0,"active show"),GSNavLinkExt.#Ht(t,s)}))}static#Ht(t,e){const s=GSNavLinkExt.#Vt(e),r={type:"active",data:e.dataset,source:t};GSEvent.send(s,"action",r,!0,!0,!0)}static#Pt(t){return t.closest(".list-group")}static#Ut(t){return t.closest(".nav")}static#Bt(t){const e=GSNavLinkExt.#qt(t);return e?e.closest(".tab-content"):null}static#qt(t){const e=GSNavLinkExt.#Ut(t),s=t?.dataset.bsTarget;return s?GSNavLinkExt.#Vt(e).querySelector(s):null}static#Vt(t){const e=GSComponents_GSComponents.getOwner(t);return GSDOM_GSDOM.unwrap(e)}}class GSDataAttr{static#zt="offcanvas|collapse|dropdown|button|tab|pill|popover|modal|popup";static#Wt="offcanvas|modal|alert|popup";static{GSDOMObserver.registerFilter(GSDataAttr.#bt,GSDataAttr.#vt),GSDOMObserver.registerFilter(GSDataAttr.#bt,GSDataAttr.#yt,!0)}static#bt(t){return!GSDOM_GSDOM.isGSElement(t)&&(!!GSDOM_GSDOM.isHTMLElement(t)&&(GSDataAttr.#Yt(t)&&t.classList.add("collapsible"),t.dataset.bsDismiss||t.dataset.bsToggle||t.dataset.inject))}static#vt(t){t.id=t.id||GSID.id,GSEvent.attach(t,t,"click",GSDataAttr.#et.bind(t))}static#yt(t){GSEvent.deattachListeners(t)}static#Jt(t){if(t)return t.dataset?.bsToggle||t.dataset?.bsDismiss||t.dataset?.inject?t:GSDataAttr.#Jt(t.parentElement)}static#et(t){const e=GSDataAttr.#Jt(t.target),s=e?.dataset?.inject,r=e?.dataset?.bsDismiss,n=GSDataAttr.getTarget(e),i=e?.dataset?.bsToggle;GSDataAttr.#Kt(e,n,i),GSDataAttr.#Xt(e,n,r),GSDataAttr.#Zt(e,n,s)}static#Qt(t,e,s){switch(s){case"alert":case"collapse":case"dropdown":case"modal":case"offcanvas":case"pill":case"popover":case"poup":case"tab":break;case"button":if(!e)return{list:[t],comps:[]};break;case"tooltip":return{list:[],comps:[]}}let r=GSDOM_GSDOM.queryAll(document.documentElement,`gs-${s}`);const n=e||`.${s}`;if(e)r=r.filter((t=>t.matches(n)));else if(t=t.closest(n)){const e=r.filter((e=>e.self.firstElementChild===t));return{list:0===e.length?[t]:[],comps:e}}const i=GSDOM_GSDOM.queryAll(document.documentElement,n),a=Array.from(document.querySelectorAll(n)),o=i.concat(a).filter((t=>r.indexOf(t)<0)).filter((t=>0===r.filter((e=>e.self.firstElementChild===t)).length));return{list:Array.from(new Set(o)),comps:r}}static#te(t,e){return t.filter((t=>GSDataAttr.#ee(t,e)))}static#se(t){return t.filter((t=>GSDataAttr.#re(t)))}static#ne(t,e){return t.filter((t=>!e.includes(t)))}static#ee(t,e){return e.split(" ").filter((t=>t.trim())).map((t=>"button"===t?"btn":t)).filter((e=>t.classList.contains(e))).length>0}static#re(t){return(t.classList.contains("hide")||t.classList.contains("fade")||t.classList.contains("collapse"))&&!t.classList.contains("show")}static#Yt(t){return t.classList.contains("collapse")&&!t.classList.contains("accordion-collapse")}static#ie(t){return t.classList.contains("fade")}static#ae(t,e,s){GSDOM_GSDOM.toggleClass(t,!0,e),GSDOM_GSDOM.toggleClass(t,!1,s)}static#oe(t){const e=GSDataAttr.#Yt(t)?"":"fade";GSDataAttr.#ae(t,e,"show")}static#ce(t){const e=GSDataAttr.#Yt(t)?"gsanim":"fade";GSDataAttr.#ae(t,"show",e)}static#le(t,e){const s=GSDataAttr.#te(t.list,e),r=GSDataAttr.#se(s);GSDataAttr.#ne(s,r).forEach((t=>GSDataAttr.#oe(t))),r.forEach((t=>GSDataAttr.#ce(t)))}static async#ue(t){GSDOM_GSDOM.toggleClass(t,!1,"show"),GSDataAttr.#ie(t)&&await GSUtil.timeout(GSDOM_GSDOM.SPEED),t.remove()}static#de(t){t.list.forEach((t=>GSDataAttr.#ue(t)))}static#Zt(t,e,s){if(!s)return;const r=s.toLowerCase().startsWith("gs-"),n=GSDOM_GSDOM.queryAll(document.documentElement,e),i=r?`<${s}></${s}>`:`<gs-template href="${s}" class="${t?.dataset?.css||""}"></gs-template>`;n.forEach((t=>GSDOM_GSDOM.setHTML(t,i)))}static#Kt(t,e,s){if(!GSDataAttr.#he(s))return;const r=GSDataAttr.#Qt(t,e,s);r.comps.filter((t=>GSFunction.isFunction(t.toggle))).forEach((e=>e.toggle(t))),GSDataAttr.#me(t,e,s,r),GSDataAttr.#le(r,s),GSDataAttr.#ge(t,e,s,r)}static#me(t,e,s,r){return GSDataAttr.#Se(t,e,s,r,!0)}static#ge(t,e,s,r){return GSDataAttr.#Se(t,e,s,r,!1)}static#Se(t,e,s,r,n){switch(s){case"button":case"modal":case"offcanvas":case"pill":case"popover":case"popup":case"tab":case"tooltip":break;case"collapse":n?r.list.filter((t=>t.classList.contains("accordion-collapse"))).forEach((t=>{Array.from(t.closest(".accordion").querySelectorAll(".accordion-collapse")).filter((e=>e!=t&&GSAttr.get(e,"data-bs-parent"))).forEach((t=>GSDOM_GSDOM.toggleClass(t,!1,"show")))})):GSDOM_GSDOM.toggleClass(t,null,"collapsed");break;case"dropdown":n?r.list=r.list.map((t=>t.querySelector(".dropdown-menu"))).filter((t=>null!=t)):(r.list.forEach((t=>t.classList.toggle("show"))),r.list.filter((t=>t.classList.contains("show"))).forEach((t=>GSDataAttr.#pe(t))))}}static#pe(t){GSEvent.once(t,null,"mouseleave",(e=>t.classList.remove("show")))}static#Xt(t,e,s){if(!GSDataAttr.#Ge(s))return;const r=GSDataAttr.#Qt(t,e,s);switch(r.comps.filter((t=>GSFunction.isFunction(t.close))).forEach((t=>t.close())),r.comps.filter((t=>GSFunction.isFunction(t.dismiss))).forEach((t=>t.dismiss())),s){case"alert":GSDataAttr.#de(r,s);break;case"modal":case"offcanvas":case"popup":GSDataAttr.#le(r,s)}}static#Ge(t){return t&&GSDataAttr.#Wt.includes(t)}static#he(t){return t&&GSDataAttr.#zt.includes(t)}static getTarget(t){const e=t?.dataset?.bsTarget||GSAttr.get(t,"href");return"#"===e?"":e}static getDismiss(t){return t?.dataset?.bsDismiss||""}static getToggle(t){return t?.dataset?.bsToggle||""}static getInject(t){return t?.dataset?.inject||""}static isDismiss(t){return!!t?.dataset?.bsDismiss}static isToggle(t){return!!t?.dataset?.bsToggle}}class GSTimeFormat extends GSElement{#r=0;static get observedAttributes(){return["interval"]}attributeChanged(t="",e="",s=""){const r=this;r.stop(),r.start(),r.#Z()}onReady(){super.onReady();this.#Z(),this.start()}disconnectedCallback(){this.stop()}#Z(){const t=this,e=new Date,s=e.toLocaleTimeString(t.locale);return GSDOM_GSDOM.setHTML(t.self,s),GSEvent.send(t,"time",{date:e},!0,!0),0}start(){const t=this;t.#r=t.interval>0?setInterval(t.#Z.bind(t),1e3*t.interval):t.#Z()}stop(){clearInterval(this.#r)}get isFlat(){return!0}get interval(){return GSAttr.getAsNum(this,"interval",1)}set interval(t=60){return GSAttr.setAsNum(this,"interval",t)}get locale(){return GSAttr.get(this,"locale",GSUtil.locale)}set locale(t=""){return GSAttr.set(this,"locale",t)}static{customElements.define("gs-time-format",GSTimeFormat),Object.seal(GSTimeFormat)}}class GSDate extends Date{static DEFAULT_FORMAT="YYYY-MM-DDTHH:mm:ssZ";static REGEX_FORMAT=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g;#fe=navigator.locale;format(t=GSDate.DEFAULT_FORMAT,e){this.locale=e;const s=this.asJSON();return t.replace(GSDate.REGEX_FORMAT,((t,e)=>e||s[t]))}build(){const t=this,e=t.last.getDate(),s=t.first.getDay(),r=t.#be(),n=0===s?[]:" ".repeat(s+(r?-2:-1)).split(" ");let i=1;for(;i<=e;)n.push(i.toString()),i++;for(;n.length%7!=0;)n.push("");return n}get locale(){return this.#fe}set locale(t){this.#fe=t||navigator.language}get year(){return this.getFullYear()}set year(t=0){this.setFullYear(t)}get month(){return this.getMonth()}set month(t=0){this.setMonth(t)}get day(){return this.getDate()}set day(t=0){this.setDate(t)}get first(){return new GSDate(this.getFullYear(),this.getMonth(),1)}get last(){return new GSDate(this.getFullYear(),this.getMonth()+1,0)}get YY(){return String(this.YYYY).slice(-2)}get YYYY(){return this.getFullYear()}get M(){return this.getMonth()+1}get MM(){return this.M.toString().padStart(2,"0")}get MMM(){return this.#ve({month:"short"})}get MMMM(){return this.#ve({month:"long"})}get D(){return this.getDate().toString()}get DD(){return this.D.padStart(2,"0")}get d(){return this.getDay().toString()}get dd(){return this.ddd.slice(0,2)}get ddd(){return this.#ve({weekday:"short"})}get dddd(){return this.#ve({weekday:"long"})}get H(){return this.getHours().toString()}get HH(){return this.H.padStart(2,"0")}get h(){return this.#ye(1)}get hh(){return this.#ye(2)}get a(){return this.#Ae(!0)}get A(){return this.#Ae(!1)}get m(){return this.getMinutes().toString()}get mm(){return this.m.padStart(2,"0")}get s(){return this.getSeconds().toString()}get ss(){return this.s.padStart(2,"0")}get SSS(){return this.getMilliseconds().toString().padStart(3,"0")}get Z(){return this.#De()}get ZZ(){return this.Z.replace(":","")}get Q(){return Math.ceil(this.M/3)}get k(){return(this.getHours()+1).toString()}get kk(){return this.k.padStart(2,"0")}get W(){const t=new Date(this.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);const e=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-e.getTime())/864e5-3+(e.getDay()+6)%7)/7)}get WW(){return this.W.toString().padStart(2,"0")}get x(){return this.getTime()}get X(){return Math.floor(this.x/1e3)}asJSON(){const t=this;return{YY:t.YY,YYYY:t.YYYY,M:t.M,MM:t.MM,MMM:t.MMM,MMMM:t.MMMM,D:t.D,DD:t.DD,d:t.d,dd:t.dd,ddd:t.ddd,dddd:t.dddd,H:t.H,HH:t.HH,h:t.h,hh:t.hh,a:t.a,A:t.A,m:t.m,mm:t.mm,s:t.s,ss:t.ss,SSS:t.SSS,Z:t.Z,ZZ:t.ZZ,Q:t.Q,k:t.k,kk:t.kk,W:t.W,WW:t.WW,x:t.x,X:t.X}}static monthList(t=!1,e=navigator.locale,s=!0){const r=new GSDate;r.locale=e,r.setMonth(0);const n=[];let i=null,a=12;for(;a--;)i=t?r.MMM:r.MMMM,i=s?r.#K(i):i,n.push(i),r.setMonth(r.getMonth()+1);return n}static dayList(t=!1,e=navigator.locale,s=!0){const r=new GSDate;r.locale=e;const n=r.#be()?1:0;r.setDate(r.getDate()-r.getDay()+n);const i=[];let a=null,o=7;for(;o--;)a=t?r.ddd:r.dddd,a=s?r.#K(a):a,i.push(a),r.setDate(r.getDate()+1);return i}#be(){return 1===new Intl.Locale(this.#fe)?.weekInfo?.firstDay}#K(t=""){return t.charAt(0).toUpperCase()+t.slice(1)}#ve(t){return this.toLocaleString(this.#fe,t)}#ye(t){return(this.getHours()%12||12).toString().padStart(t,"0")}#Ae(t){const e=this.#ve({hour:"2-digit",hour12:!0}).split(" ").pop(-1);return t?e.toLowerCase():e}#De(){const t=-1*this.getTimezoneOffset(),e=Math.abs(t),s=e%60;return`${t<=0?"+":"-"}${Math.floor(e/60).toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`}}class GSDateFormat extends HTMLElement{static observedAttributes=["value","locale","format"];#r=0;connectedCallback(){this.#Z()}attributeChangedCallback(t="",e="",s=""){this.#Z()}#Z(){const t=this;t.#r>0||(t.#r=setTimeout((()=>{GSDOM_GSDOM.setHTML(t,t.result),t.#r=0}),50))}get result(){const t=this,e=t.value;return t.format?e.format(t.format):new Intl.DateTimeFormat(t.locale,t.dataset).format(e)}get format(){return GSAttr.get(this,"format")}set format(t=""){return GSAttr.set(this,"format",t)}get value(){const t=Date.parse(GSAttr.get(this,"value")),e=new GSDate(t);return e.locale=this.locale,e}set value(t=""){GSAttr.set(this,"value",t)}get locale(){return GSAttr.get(this,"locale",navigator.locale)}set locale(t=""){GSAttr.set(this,"locale",t)}static{customElements.define("gs-date-format",GSDateFormat),Object.seal(GSDateFormat)}}class GSYearFormat extends HTMLElement{static observedAttributes=["offset"];connectedCallback(){this.#Z()}attributeChangedCallback(t="",e="",s=""){this.#Z()}#Z(){GSDOM_GSDOM.setHTML(this,this.value)}get value(){return this.current+this.offset}get current(){return(new Date).getFullYear()}get offset(){return GSAttr.getAsNum(this,"offset",0)}set offset(t="0"){GSAttr.setAsNum(this,"offset",t)}static{customElements.define("gs-year-format",GSYearFormat),Object.seal(GSYearFormat)}}class GSCurrencyFormat extends HTMLElement{static observedAttributes=["value","locale","currency"];#r=0;connectedCallback(){this.#Z()}attributeChangedCallback(t="",e="",s=""){this.#Z()}#Z(){const t=this;t.#r>0||(t.#r=setTimeout((()=>{GSDOM_GSDOM.setHTML(t,t.format),t.#r=0}),50))}get#Me(){return Object.apply(this.dataset,{style:"currency",currency:this.currency})}get format(){const t=this;return new Intl.NumberFormat(t.locale,t.#Me).format(t.value)}get value(){return GSAttr.getAsNum(this,"value",0)}set value(t=""){GSAttr.setAsNum(this,"value",t)}get locale(){return GSAttr.get(this,"locale",navigator.language)}set locale(t=""){GSAttr.set(this,"locale",t)}get currency(){return GSAttr.get(this,"currency","")}set currency(t=""){GSAttr.set(this,"currency",t)}static{customElements.define("gs-currency-format",GSCurrencyFormat),Object.seal(GSCurrencyFormat)}}class GSItem extends HTMLElement{static#Ee="data-bs-dismiss";static#Oe="data-bs-target";static#le="data-bs-toggle";static#we="data-action";static#Ce="data-inject";static#Te="data-selectable";static#xe=["GS-ITEM","TEMPLATE"];static{customElements.define("gs-item",GSItem),Object.seal(GSItem)}constructor(){super(),GSItem.validate(this)}static validate(t,e="GS-ITEM"){return GSDOM_GSDOM.validate(t,e,GSItem.#xe)}static getBody(t,e=!1){let s=GSItem.getTemplate(t);const r=GSItem.getFlat(t),n=GSItem.getAnchor(t),i=r||e?`anchor="${n}" flat="true"`:"",a=GSAttr.get(t,"css-template","");return s?`<gs-template ${i} href="${s}" class="${a}"></gs-template>`:(s=t.querySelector("template"),s?.innerHTML||"")}static genericItems(t){return GSDOM_GSDOM.isHTMLElement(t)?Array.from(t.children).filter((t=>"GS-ITEM"==t.tagName)):[]}static generateItem(t=""){return GSUtil.isJsonType(t)?Array.isArray(t)?GSItem.#Le(t):GSItem.#ke(t):""}static#$e(t){return GSUtil.isNumber(t)||GSUtil.isStringNonEmpty(t)}static#Le(t){return t.map((t=>GSItem.#ke(t))).join("\n")}static#ke(t){return`<gs-item ${GSItem.#_e(t)}>${Array.isArray(t.items)?GSItem.generateItem(t.items):""}</gs-item>`}static#_e(t){return Object.entries(t).filter((t=>GSItem.#$e(t[1]))).map((t=>`${t[0]}="${t[1]}"`)).join(" ")}static getAttrs(t){return[GSItem.getDismissAttr(t),GSItem.getTargetAttr(t),GSItem.getToggleAttr(t),GSItem.getActionAttr(t),GSItem.getInjectAttr(t)].join(" ")}static getDismissAttr(t){const e=GSItem.getDismiss(t);return e?`${GSItem.#Ee}="${e}"`:""}static getTargetAttr(t){const e=GSItem.getTarget(t);return e?`${GSItem.#Oe}="${e}"`:""}static getToggleAttr(t){const e=GSItem.getToggle(t);return e?`${GSItem.#le}="${e}"`:""}static getActionAttr(t){const e=GSItem.getAction(t);return e?`${GSItem.#we}="${e}"`:""}static getInjectAttr(t){const e=GSItem.getInject(t);return e?`${GSItem.#Ce}="${e}"`:""}static getSelectableAttr(t){const e=GSItem.getSelectable(t);return e?"":`${GSItem.#Te}="${e}"`}static getActive(t){return GSAttr.getAsBool(t,"active")}static getAction(t){return GSAttr.get(t,"action")}static getDismiss(t){return GSAttr.get(t,"dismiss")}static getTarget(t){return GSAttr.get(t,"target")}static getToggle(t){return GSAttr.get(t,"toggle")}static getInject(t){return GSAttr.get(t,"inject")}static getIcon(t){return GSAttr.get(t,"icon")}static getSelectable(t){return GSAttr.getAsBool(t,"selectable",!0)}static getAnchor(t){return GSAttr.get(t,"anchor","afterend@self")}static getFlat(t){return GSAttr.getAsBool(t,"flat",!1)}static getName(t){return GSAttr.get(t,"name","")}static getHref(t){return GSAttr.get(t,"href","#")}static getCSS(t){return GSAttr.get(t,"css","")}static getTemplate(t){return GSAttr.get(t,"template","")}get dismissAttr(){return GSItem.getDismissAttr(this)}get targetAttr(){return GSItem.getTargetAttr(this)}get toggleAttr(){return GSItem.getToggleAttr(this)}get actionAttr(){return GSItem.getActionAttr(this)}get injectAttr(){return GSItem.getInjectAttr(this)}get action(){return GSItem.getAction(this)}get dismiss(){return GSItem.getDismiss(this)}get target(){return GSItem.getTarget(this)}get toggle(){return GSItem.getToggle(this)}get inject(){return GSItem.getInject(this)}get selectable(){return GSItem.getSelectable(this)}get flat(){return GSItem.getFlat(this)}get name(){return GSItem.getName(this)}get css(){return GSItem.getCSS(this)}get active(){return GSItem.getActive(this)}get template(){return GSItem.getTemplate(this)}get body(){return GSItem.getBody(el)}static toDom(t,e="gs-item",s="name",r="value",n="type",i=!1){const a=[];return i||a.push('<gs-item type="object">'),Array.isArray(t)?t.forEach(((t,i)=>{const o=typeof t,c=Array.isArray(t);!c&&"object"===o||c?(a.push(`<${e} ${n}="object">`),a.push(GSItem.toDom(t,e,s,r,n,!0))):a.push(`<${e} ${r}="${t}" ${n}="${o}">`),a.push(`</${e}>`)})):Object.entries(t).forEach((t=>{const i=t[0],o=t[1],c=typeof o,l=Array.isArray(o),u=!l&&"object"===c;let d=!1;if(l&&o.length>0){const t=Array.isArray(o[0]),e="object"==typeof o[0];d=!(t||e)}d||l?(a.push(`<${e} ${s}="${i}" ${n}="array">`),a.push(GSItem.toDom(o,e,s,r,n,!0))):u?(a.push(`<${e} ${s}="${i}" ${n}="object">`),a.push(GSItem.toDom(o,e,s,r,n,!0))):a.push(`<${e} ${s}="${i}" ${r}="${o}" ${n}="${c}">`),a.push(`</${e}>`)})),i||a.push("</gs-item>"),a.join("")}static toJson(t,e="name",s="value",r="type"){if(!(t instanceof HTMLElement))return{};const n=t.getAttribute(e),i=t.getAttribute(s),a=t.getAttribute(r);let o=null;switch(a){case"array":o=[];break;case"object":o={};break;default:return GSItem.#Fe(i,a)}const c=Array.from(t.children),l="array"===a,u="object"===a;return c.forEach((t=>{const i=t.getAttribute(e);if(l)o.push(GSItem.toJson(t,e,s,r));else if(u){const n=GSItem.toJson(t,e,s,r);o[i]=n}else{const e=t.getAttribute(s),a=t.getAttribute(r);o[n][i]=GSItem.#Fe(e,a)}})),o}static#Fe(t,e){switch(e){case"boolean":return"true"===t;case"number":return parseFloat(t);default:return t}}}class GSAccordion extends GSElement{static{customElements.define("gs-accordion",GSAccordion),Object.seal(GSAccordion)}static get observedAttributes(){return GSElement.observeAttributes(["css","css-item","css-header","css-body","data"])}attributeCallback(t="",e="",s=""){const r=this;if("data"===t)return r.load(s);let n=null;switch(t){case"css":n=".accordion";break;case"css-item":n=".accordion-item";break;case"css-head":n=".accordion-button";break;case"css-body":n=".accordion-collapse"}n&&r.queryAll(n).forEach((t=>{GSDOM_GSDOM.toggleClass(t,!1,e),GSDOM_GSDOM.toggleClass(t,!0,s)}))}async getTemplate(t=""){const e=GSID.id,s=await this.#P(e);return`<div class="accordion ${this.css}" id="#${e}">${s}</div>`}async#P(t){const e=this,s=GSItem.genericItems(e).map((s=>e.#Ie(t,s)));return(await Promise.all(s)).join("")}get css(){return GSAttr.get(this,"css","")}set css(t=""){GSAttr.set(this,"css",t)}get cssItem(){return GSAttr.get(this,"css-item","")}set cssItem(t=""){GSAttr.set(this,"css-item",t)}get cssHead(){return GSAttr.get(this,"css-head")}set cssHead(t=""){return GSAttr.set(this,"css-head",t)}get cssBody(){return GSAttr.get(this,"css-body")}set cssBody(t=""){return GSAttr.set(this,"css-body",t)}async#Ie(t,e){const s=this,r=GSID.id,n=GSItem.getBody(e),i=s.#Ne(e),a=s.#Re(e),o=s.#je(e)?`data-bs-parent=#${t}`:"",c=s.#He(e);return`\n       <div class="accordion-item ${s.cssItem}">\n         <slot name="content">\n             <h2 class="accordion-header">\n               <button class="accordion-button ${s.cssHead} ${c?"":"collapsed"}" type="button" data-bs-toggle="collapse" data-bs-target="#${r}">\n                 ${i}\n               </button>\n             </h2>\n             <div class="accordion-collapse collapse ${s.cssBody} ${c?"show":""}" id="${r}" ${o}>\n               <div class="accordion-body">\n                   ${n||a}\n               </div>\n             </div>      \n         </slot>\n     </div>\n     `}#Ne(t){return GSAttr.get(t,"title")}#Re(t){return GSAttr.get(t,"message")}#He(t){return GSAttr.getAsBool(t,"visible",!1)}#je(t){return GSAttr.getAsBool(t,"autoclose",!0)}async load(t=""){const e=await GSLoader.loadData(t);if(!GSUtil.isJsonType(e))return;const s=this,r=GSItem.generateItem(e);return GSDOM_GSDOM.setHTML(s,r),GSEvent.deattachListeners(s),s.connectedCallback(),e}}class GSAlert extends GSElement{#Ue='<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>';#Pe=!1;static{customElements.define("gs-alert",GSAlert),Object.seal(GSAlert)}static get observedAttributes(){return GSElement.observeAttributes(["css","message","active"])}constructor(){super()}#et(t){GSEvent.send(this,"action",{type:"alert",source:t},!0),this.dismiss()}onReady(){const t=this,e=t.query(".btn-close");t.attachEvent(e,"click",t.#et.bind(t)),super.onReady()}attributeCallback(t="",e="",s=""){const r=this,n=r.firstElementChild;"message"==t&&GSDOM_GSDOM.setHTML(n,r.message),"css"==t&&(GSDOM_GSDOM.toggleClass(n,!1,e),GSDOM_GSDOM.toggleClass(n,!0,s)),"active"==t&&GSDOM_GSDOM.toggleClass(n,!r.#Pe,activeCSS)}get template(){const t=this;return`\n        <div class="alert ${t.css}" style="${this.getStyle()}" role="class">\n            <slot>${t.message}</slot>\n            ${t.dismissible?t.#Ue:""}\n        </class>`}get css(){const t=this.dismissible?"alert-dismissible fade show":"";return GSAttr.get(this,"css")+` ${t}`}set css(t=""){return GSAttr.set(this,"css",t)}get activeCSS(){return GSAttr.get(this,"css-active","d-none")}set activeCSS(t=""){return GSAttr.get(this,"css-active",t)}get message(){return GSAttr.get(this,"message")}set message(t=""){return GSAttr.set(this,"message",t)}get dismissible(){return GSAttr.getAsBool(this,"dismissible",!1)}set dismissible(t=""){return GSAttr.set(this,"dismissible",GSUtil.asBool(t))}async#Ee(){return GSDOM_GSDOM.toggleClass(this.query(".alert"),!1,"show"),await GSUtil.timeout(GSDOM_GSDOM.SPEED),this.remove()}dismiss(){return this.#Ee()}toggle(){this.active=!this.active}get isFlat(){return GSAttr.getAsBool(this,"flat",!0)}get anchor(){return"self"}}class GSButton extends GSElement{#Pe=!1;static{customElements.define("gs-button",GSButton),Object.seal(GSButton)}static get observedAttributes(){return GSElement.observeAttributes(["css","dismiss","target","toggle","title","active","disable"])}constructor(){super()}#et(t){const e=this;if(e.disable)return!1;GSEvent.send(e,"action",{type:"button",action:e.action,source:t},!0,!0,!0),e.active&&(e.#Pe=!e.#Pe,GSDOM_GSDOM.toggleClass(e.firstElementChild,e.#Pe,"active")),e.select||e.#Be.blur()}onReady(){const t=this;t.attachEvent(t.#Be,"click",t.#et.bind(t)),super.onReady()}attributeCallback(t="",e="",s=""){const r=this.firstElementChild;this.#Z(t,e,s),GSAttr.set(r,`data-bs-${t}`,s)}get#Be(){return this.query("button")}#Z(t="",e="",s=""){const r=this,n=r.firstElementChild;return"title"==t?GSDOM_GSDOM.setHTML(n,r.title):("css"==t&&(GSDOM_GSDOM.toggleClass(n,!1,e),GSDOM_GSDOM.toggleClass(n,!0,s)),"active"==t?GSDOM_GSDOM.toggleClass(n,r.#Pe,"active"):"disable"==t?GSAttr.set(this.firstElementChild,"disabled",GSUtil.asBool(s)?s:null):void 0)}get template(){const t=this,e=t.disable?"disabled":"",s=`${t.icon?`<i class="${t.icon}"></i>`:""} ${t.title}`,r=GSItem.getActionAttr(t),n=GSItem.getDismissAttr(t),i=GSItem.getTargetAttr(t),a=GSItem.getToggleAttr(t);return`<button class="btn ${t.css}" ${r} ${a} ${i} ${n} ${e} title="${t.comment}" role="tooltip">${s}</button>`}get css(){const t=this.#Pe?"active":"";return GSAttr.get(this,"css")+` ${t}`}set css(t=""){return GSAttr.set(this,"css",t)}get action(){return GSAttr.get(this,"action")}set action(t=""){return GSAttr.set(this,"action",t)}get dismiss(){return GSAttr.get(this,"dismiss")}set dismiss(t=""){return GSAttr.set(this,"dismiss",t)}get icon(){return GSAttr.get(this,"icon")}set icon(t=""){return GSAttr.set(this,"icon",t)}get target(){return GSAttr.get(this,"target")}set target(t=""){return GSAttr.set(this,"target",t)}get toggle(){return GSAttr.get(this,"toggle")}set toggle(t=""){return GSAttr.set(this,"toggle",t)}get comment(){return GSAttr.get(this,"comment")}set comment(t=""){return GSAttr.set(this,"comment",t)}get title(){return GSAttr.get(this,"title")}set title(t=""){return GSAttr.set(this,"title",t)}get active(){return GSAttr.getAsBool(this,"active",!1)}set active(t=""){return this.#Pe=GSUtil.asBool(t),GSAttr.set(this,"active",this.#Pe)}get disable(){return GSAttr.getAsBool(this,"disable",!1)}set disable(t=""){return GSAttr.getAsBool(this,"disable",t)}get select(){return GSAttr.getAsBool(this,"select",!0)}set select(t=""){return GSAttr.setAsBool(this,"select",t)}toggle(){this.active=!this.active}get isFlat(){return!0}get anchor(){return"self"}}class GSCenter extends GSElement{static{customElements.define("gs-center",GSCenter),Object.seal(GSCenter)}static get observedAttributes(){return GSElement.observeAttributes(["css"])}attributeCallback(t="",e="",s=""){if("css"===t){const t=this.query("div");GSDOM_GSDOM.toggleClass(t,!1,e),GSDOM_GSDOM.toggleClass(t,!0,s)}}async getTemplate(){return`<div class="position-absolute top-50 start-50 translate-middle ${this.css}" style="${this.getStyle()}"><slot></slot></div>`}get css(){return GSAttr.get(this,"css","")}set css(t=""){return GSAttr.set(this,"css",vel)}}class GSContext extends GSElement{#qe=null;#Ve=!1;#_=!1;#ze=!1;static{customElements.define("gs-context",GSContext),Object.seal(GSContext)}static get observedAttributes(){return GSElement.observeAttributes(["visible","title","css","data"])}constructor(){super(),GSItem.validate(this,this.tagName)}attributeCallback(t="",e="",s=""){const r=this;if("data"===t)return this.load(s);if("visible"===t){r.#We.forEach((t=>t.classList.remove("show")));const t=r.#Ye;t&&GSDOM_GSDOM.toggleClass(t,r.visible,"show")}}async getTemplate(t=""){return!t&&this.childElementCount>0?this.#Je():super.getTemplate(t)}connectedCallback(){super.connectedCallback();this.#Ve=!0}disconnectedCallback(){this.#Ve=!1,super.disconnectedCallback()}onReady(){const t=this;t.#_||(t.#_=!0,t.close(),t.attachEvent(document,"gs-component",t.#Ke.bind(t)),t.attachEvent(t.#Ye,"mouseleave",t.close.bind(t)),t.attachEvent(window,"resize",t.#Xe.bind(t)),t.#Ze(),t.#Qe(),t.#Ke(),super.onReady())}reattach(){const t=this;t.#ze=!1,t.removeEvent(document,"contextmenu"),GSDOM_GSDOM.queryAll(document.documentElement,t.target).forEach((e=>t.removeEvent(e,"contextmenu"))),t.#Ke()}get isFlat(){return this.parentElement!==document.body}get anchor(){return"beforeend@body"}get visible(){return GSAttr.getAsBool(this,"visible")}set visible(t=""){return GSAttr.setAsBool(this,"visible",t)}get disabled(){return GSAttr.getAsBool(this,"disabled")}set disabled(t=""){return GSAttr.setAsBool(this,"disabled",t)}get dark(){return GSAttr.getAsBool(this,"dark")}get target(){return GSAttr.get(this,"target")}close(t){t instanceof Event&&t.preventDefault(),this.visible=!1}open(){this.visible=!0}toggle(){this.visible=!this.visible}popup(t=0,e=0){const s=this;if(s.disabled)return;const r=s.#Ye;r&&requestAnimationFrame((()=>{r.style.position="fixed",r.style.top="0px",r.style.left="0px",r.style.transform=`translate(${t}px, ${e}px)`,s.visible=!0}))}createMenu(t=[]){if(!Array.isArray(t))return!1;if(0===t.length)return!1;const e=this,s=e.#ts(t);return GSDOM_GSDOM.setHTML(e.#Ye,s.join("")),e.#Qe(),e.#Ze(),!0}#ts(t=[]){const e=this,s=e.dark?"dropdown-menu-dark":"",r=[];return t.forEach((t=>{if("-"===t)return r.push('<li><hr class="dropdown-divider"/></li>');const n=Array.isArray(t.menu);if(r.push("<li>"),r.push('<a class="dropdown-item" href="#"'),t.action&&r.push(` data-action="${t.action}"`),r.push(`>${t.name} ${n?"&raquo;":""}</a>`),n){const n=e.#ts(t.menu);r.push(`<ul class="submenu dropdown-menu ${s}">`),r.push(n.join("\n")),r.push("</ul>")}r.push("</li>")})),r}get#Ye(){return this.query(".dropdown-menu")}get#es(){return this.queryAll(".dropdown-item",!0)}get#We(){return this.queryAll(".submenu",!0)}#Xe(t){this.close()}#ss(t){GSEvent.prevent(t);const e=this;e.#qe=t.target;const s=e.#Ye?.getBoundingClientRect();if(!s)return;let r=t.clientX,n=t.clientY;const i=r+s.width>window.innerWidth,a=n+s.height>window.innerHeight;return i&&(r=window.innerWidth-s.width),a&&(n=window.innerHeight-s.height),e.#rs(a,i),e.popup(r,n),!0}#rs(t=!1,e=!1){const s=this;requestAnimationFrame((()=>{s.#We.forEach((t=>{t.style.position="absolute",t.style.left="inherit",t.style.right="inherit",t.style.top="inherit",e?t.style.right="100%":t.style.left="100%"}))}))}#Qe(){const t=this;t.#es.filter((t=>t.dataset.action)).forEach((e=>t.attachEvent(e,"click",t.#et.bind(t))))}#et(t){const e=this;t.preventDefault(),e.close();const s=t.target.dataset,r={type:"contextmenu",option:t.target,caller:e.#qe,data:s};GSEvent.send(e,"action",r,!0,!0,!0)}#ns(t){const e=t.target.parentElement,s=e.parentElement,r=GSDOM_GSDOM.query(e,".submenu");requestAnimationFrame((()=>{GSDOM_GSDOM.queryAll(s,".submenu").forEach((t=>t.classList.remove("show"))),r&&(r.style.top=`${r.parentElement.offsetTop}px`,r.classList.add("show"))}))}#Ze(){const t=this;t.#es.forEach((e=>t.attachEvent(e,"mouseover",t.#ns.bind(t))))}async#Ke(){const t=this;if(!t.target)return;if(t.#ze)return;const e=GSDOM_GSDOM.queryAll(document.documentElement,t.target);0!==e.length?(t.#ze=!0,e.forEach((e=>t.attachEvent(e,"contextmenu",t.#ss.bind(t)))),t.removeEvent(document,"gs-components"),t.attachEvent(document,"contextmenu",t.close.bind(t))):t.#Ve&&(await GSUtil.timeout(1e3),requestAnimationFrame((()=>{t.#Ke()})))}#Je(t,e=0){const s=this;t=t||s.children;const r=[],n=0===e?"position-fixed":"submenu";return r.push(`<ul class="${n} dropdown-menu ${s.dark?"dropdown-menu-dark":""}">`),Array.from(t).forEach((t=>{const i=t.childElementCount>0;i&&r.push(s.#is(t));const a=i?s.#Je(t.children,++e):s.#as(t);r.push(a),n&&r.push("</li>")})),r.push("</ul>"),r.join("")}#is(t){return`<li><a class="dropdown-item" href="#">${GSAttr.get(t,"name")} &raquo; </a>`}#as(t){const e=GSAttr.get(t,"name"),s=GSAttr.get(t,"action"),r=GSAttr.get(t,"header");return r?`<li><h6 class="dropdown-header"/>${r}</h6></li>`:e?s?`<li><a class="dropdown-item" href="#" data-action="${s}">${e}</a></li>`:"":'<li><hr class="dropdown-divider"/></li>'}async load(t=""){const e=await GSLoader.loadData(t);if(!GSUtil.isJsonType(e))return;const s=this,r=GSItem.generateItem(e);return GSDOM_GSDOM.setHTML(s,r),GSEvent.deattachListeners(s),s.connectedCallback(),e}}class GSDropdown extends GSElement{#_=!1;static{customElements.define("gs-dropdown",GSDropdown),Object.seal(GSDropdown)}static get observedAttributes(){return GSElement.observeAttributes(["visible","title","css","data"])}constructor(){super(),GSItem.validate(this,this.tagName)}attributeCallback(t="",e="",s=""){const r=this;if("data"===t)return this.load(s);if("visible"===t){r.#We.forEach((t=>t.classList.remove("show")));const t=r.#Ye;if(!t)return;GSDOM_GSDOM.toggleClass(t,r.visible,"show"),requestAnimationFrame((()=>{r.visible?r.#os(t):(t.style.left="",t.style.top="")}))}"css"===t&&(GSDOM_GSDOM.toggleClass(r.#Be,!1,e),GSDOM_GSDOM.toggleClass(r.#Be,!0,s)),"title"===t&&r.#Be&&GSDOM_GSDOM.setHTML(r.#Be,s)}#os(t){const e=window.getComputedStyle(t),s=parseInt(e.width,10),r=parseInt(e.left,10),n=parseInt(window.innerWidth,10),i=parseInt(e.top,10),a=parseInt(e.height,10),o=parseInt(window.innerHeight,10);r+s>n&&(t.style.left=r-(r+s-n)+"px"),i+a>o&&(t.style.top=i-(i+a-o)+"px")}#cs(t){const e=this.#Ye,s=parseInt(window.innerWidth,10),r=(parseInt(window.innerHeight,10),window.getComputedStyle(e)),n=window.getComputedStyle(t),i=parseInt(r.left,10),a=parseInt(r.width,10),o=(parseInt(r.top,10),parseInt(r.height,10),parseInt(n.left,10)),c=parseInt(n.width,10);parseInt(n.top,10),parseInt(n.height,10);o+c+i+a>s&&(t.style.left=`-${c}px`)}async getTemplate(t=""){return!t&&this.childElementCount>0?this.#Je():super.getTemplate(t)}onReady(){const t=this;t.#_||(t.#_=!0,t.close(),t.attachEvent(t.#Ye,"mouseleave",t.close.bind(t)),t.#Ze(),t.#ls(),t.#rs(),super.onReady())}get css(){return GSAttr.get(this,"css")}set css(t=""){return GSAttr.set(this,"css",t)}get title(){return GSAttr.get(this,"title")}set title(t=""){return GSAttr.set(this,"title",t)}get visible(){return GSAttr.getAsBool(this,"visible")}set visible(t=""){return GSAttr.setAsBool(this,"visible",t)}get dark(){return GSAttr.getAsBool(this,"dark")}get isFlat(){return GSAttr.getAsBool(this,"flat",!this.title)}get anchor(){return"afterend@self"}close(){this.visible=!1}open(){this.visible=!0}toggle(){this.visible=!this.visible}createMenu(t=[]){if(!Array.isArray(t))return!1;if(0===t.length)return!1;const e=this,s=e.#ts(t);return GSDOM_GSDOM.setHTML(e.#Ye,s.join("")),e.#ls(),e.#Ze(),!0}#ts(t=[]){const e=this,s=e.dark?"dropdown-menu-dark":"",r=[];return t.forEach((t=>{if("-"===t)return r.push('<li><hr class="dropdown-divider"/></li>');const n=Array.isArray(t.menu);if(r.push("<li>"),r.push('<a class="dropdown-item" href="#" '),r.push(GSItem.getAttrs(el)),r.push(">"),e.rtl,r.push(`${t.name} ${n?"&raquo;":""}`),r.push("</a>"),n){const n=e.#ts(t.menu);r.push(`<ul class="submenu dropdown-menu ${s}">`),r.push(n.join("\n")),r.push("</ul>")}r.push("</li>")})),r}get#Ye(){return this.query(".dropdown-menu")}get#Be(){return this.query(".dropdown-toggle")}get#es(){return this.queryAll(".dropdown-item")}get#We(){return this.queryAll(".submenu")}#ls(){const t=this;t.#es.filter((t=>t.dataset.action)).forEach((e=>t.attachEvent(e,"click",t.#et.bind(t))))}#et(t){t.preventDefault(),this.close();const e={type:"dropdown",source:t};GSEvent.send(this,"action",e,!0)}#ns(t){const e=this,s=t.target.closest("li"),r=s.closest("ul"),n=GSDOM_GSDOM.query(s,".submenu");requestAnimationFrame((()=>{if(GSDOM_GSDOM.queryAll(r,".submenu").forEach((t=>t.classList.remove("show"))),n){const t=s.offsetTop;n.style.top=`${t}px`,n.classList.add("show"),e.#cs(n)}}))}#rs(t=!1,e=!1){this.#We.forEach((t=>{t.style.position="absolute",t.style.left="inherit",t.style.right="inherit",t.style.top="inherit",e?t.style.right="100%":t.style.left="100%"}))}#Ze(){const t=this;t.#es.forEach((e=>t.attachEvent(e,"mouseover",t.#ns.bind(t))))}#Je(t,e=0){const s=this;t=t||s.children;const r=[],n=0===e?"":"submenu";return 0===e&&s.title&&(r.push('<div class="dropdown">'),r.push(`<button class="btn dropdown-toggle ${s.css}" type="button" data-bs-toggle="dropdown">`),r.push(s.title),r.push("</button>")),r.push(`<ul class="${n} dropdown-menu ${s.dark?"dropdown-menu-dark":""}">`),Array.from(t).forEach((t=>{const i=t.childElementCount>0;i&&r.push(s.#is(t));const a=i?s.#Je(t.children,++e):s.#as(t);r.push(a),n&&r.push("</li>")})),r.push("</ul>"),0===e&&s.title&&r.push("</div>"),r.join("")}#is(t){return`<li><a class="dropdown-item" href="#">${GSAttr.get(t,"name")} &raquo; </a>`}#as(t){const e=GSAttr.get(t,"name"),s=GSAttr.get(t,"header");if(s)return`<li><h6 class="dropdown-header"/>${s}</h6></li>`;if(!e)return'<li><hr class="dropdown-divider"/></li>';const r=GSItem.getAttrs(t).trim();return r?`<li><a class="dropdown-item" href="#" ${r} >${e}</a></li>`:""}async load(t=""){const e=await GSLoader.loadData(t);if(!GSUtil.isJsonType(e))return;const s=this,r=GSItem.generateItem(e);return GSDOM_GSDOM.setHTML(s,r),GSEvent.deattachListeners(s),s.connectedCallback(),e}}class GSLayout extends GSElement{static{customElements.define("gs-layout",GSLayout),Object.seal(GSLayout)}constructor(){super(),GSItem.validate(this,this.tagName)}async getTemplate(t=""){const e=this,s=GSItem.genericItems(e).map((t=>e.#Ie(t))),r=await Promise.all(s),n=e.isVertical?"flex-column":"flex-row";return`<div class="${e.isFlat?"":"vh-100"} d-flex flex-fill ${n} ${e.css}" style="${this.getStyle()}">${r.join("")}</div>`}get isFlat(){const t=this;if(t.owner instanceof GSLayout)return!0;const e=t.closest("gs-layout");if(e&&e!==t)return!0;const s=GSComponents.getOwner(t),r=window.getComputedStyle(s);return"flex"===r.display&&"0"!==r.flexGrow}get anchor(){return"afterend@self"}async#Ie(t){const e=this,s=e.#us(t),r=GSAttr.get(t,"id"),n=GSAttr.get(t,"name"),i=GSItem.getBody(t,e.isFlat),a=e.#ds(t),o=a.length>10,c=`<div class="${e.#hs(t,o)}" id="${n||GSID.next()}" ${a}>${i}</div>`;if(s){const s=e.#ms(t);if(0==s)return c;let n="";n=s>0?e.isVertical?"top":"start":e.isVertical?"bottom":"end";const i=`<gs-splitter resize="${n}" split="${e.isVertical?"horizontal":"vertical"}" id="${r}"></gs-splitter>`;return 1==s?[c,i].join(""):[i,c].join("")}return c}#ds(t){const e=this.isVertical?"height":"width",s=GSAttr.getAsNum(t,"max",0),r=GSAttr.getAsNum(t,"min",0);return['style="',s>0?`max-${e}: ${s}px;`:"",r>0?`min-${e}: ${r}px;`:"",'"'].join("")}#hs(t,e=!1){const s=this.#us(t),r=GSAttr.get(t,"css");let n=GSAttr.get(t,"v-pos"),i=GSAttr.get(t,"h-pos");i=i?`justify-content-${i}`:"",n=n?`align-items-${n}`:"";const a=["d-flex",i,n];return 0==s&&0==e&&a.push("flex-fill"),a.push(r),a.join(" ")}#ms(t){const e=t.previousElementSibling,s=t.nextElementSibling;return s||e?s?e&&this.#us(s)?this.#us(e)?0:-1:1:-1:0}#us(t){return GSAttr.getAsBool(t,"resizable",!1)}get isVertical(){return"vertical"===GSAttr.get(this,"type","vertical")}get css(){return GSAttr.get(this,"css")}set css(t=""){return GSAttr.set(this,"css",t)}}class GSList extends GSElement{static{customElements.define("gs-list",GSList),Object.seal(GSList)}static get observedAttributes(){return GSElement.observeAttributes(["data"])}constructor(){super(),GSItem.validate(this,this.tagName)}get css(){return GSAttr.get(this,"css","")}set css(t=""){return GSAttr.set(this,"css",t)}attributeCallback(t="",e="",s=""){if("data"===t)return this.load(s)}async getTemplate(t=""){const e=await this.#P();return`<div class="list-group ${this.css}">${e}</div>`}async#P(){const t=this;return GSItem.genericItems(t).map((e=>t.#Ie(e))).join("")}#Ie(t){const e=this,s=e.#gs(t),r=GSItem.getBody(t),n=GSItem.getCSS(t),i=GSItem.getHref(t),a=GSAttr.dataToString(t),o=GSItem.getAttrs(t),c=GSItem.getIcon(t),l=c?`<i class="${c}"></i>`:"",u=e.#Ss(t)?"active":"";return`<a  ${e.selectable?'is="gs-ext-navlink"':"ignore"} class="list-group-item list-group-item-action ${u} ${n}"\n                href="${i}" ${i&&"#"!==i?`target=${GSItem.getTarget(t)}`:""} ${o} ${a}>${l} ${r||s}</a>`}#gs(t){return GSAttr.get(t,"title")}#Ss(t){return GSAttr.getAsBool(t,"active")}get selectable(){return GSAttr.getAsBool(this,"selectable",!0)}async load(t=""){const e=await GSLoader.loadData(t);if(!GSUtil.isJsonType(e))return;const s=this,r=GSItem.generateItem(e);return GSDOM_GSDOM.setHTML(s,r),GSEvent.deattachListeners(s),s.connectedCallback(),e}}class GSNav extends GSElement{static{customElements.define("gs-nav",GSNav),Object.seal(GSNav)}static get observedAttributes(){return GSElement.observeAttributes(["data"])}constructor(){super(),GSItem.validate(this,this.tagName)}attributeCallback(t="",e="",s=""){if("data"===t)return this.load(s)}async getTemplate(t=""){const e=this,s=GSItem.genericItems(e).map((t=>e.#ps(t)));return`\n          <ul class="nav ${e.#Gs?"":"flex-column"} ${e.#fs}">\n            ${s.join("")}\n          </ul>\n        `}#ps(t){return this.#bs(t)}get#fs(){return this.#vs(this)}get#Gs(){return GSAttr.getAsBool(this,"bar",!0)}#bs(t){return`<li class="nav-item ${this.#ys(t)}">${this.#As(t)}</li>`}#As(t){const e=this,s=GSAttr.dataToString(t),r=e.#vs(t),n=e.#Ds(t),i=e.#Ne(t),a=GSItem.getIcon(t),o=GSItem.getHref(t),c=`${a?`<i class="${a}"></i>`:""} ${i}`,l=o&&"#"!==o?`target=${GSItem.getTarget(t)}`:"",u=GSItem.getAttrs(t);return`<a type="button" role="nav" is="gs-ext-navlink" class="nav-link ${r} ${n}" \n                href="${o}" ${l} id="${GSID.id}-nav" ${u} ${s}>${c}</a>`}#ys(t){return GSAttr.get(t,"css-nav-wrap")}#vs(t){return GSAttr.get(t,"css-nav")}#Ds(t){return this.#Ss(t)?"active":""}#Ss(t){return GSAttr.getAsBool(t,"active")}#Ne(t){return GSAttr.get(t,"title")}async load(t=""){const e=await GSLoader.loadData(t);if(!GSUtil.isJsonType(e))return;const s=this,r=GSItem.generateItem(e);GSDOM_GSDOM.setHTML(s,r),GSEvent.deattachListeners(s),s.connectedCallback()}}class GSOffcanvas extends GSElement{static{customElements.define("gs-offcanvas",GSOffcanvas),Object.seal(GSOffcanvas)}static get observedAttributes(){return GSElement.observeAttributes(["title","visible","backdrop","placement","css","closable"])}constructor(){super(),this.css=this.css||"border shadow-sm"}attributeCallback(t="",e="",s=""){this.#Z(t,e,s),"visible"===t&&GSEvent.send(this,"action",{type:"offcanvas",ok:s})}async getTemplate(t=""){return t?super.getTemplate(t):this.#Ie()}onReady(){const t=this;super.onReady(),t.attachEvent(t.#Ms,"click",t.close.bind(t)),t.autoclose&&(t.attachEvent(t.#Es,"mouseleave",t.close.bind(t)),t.min>0&&t.attachEvent(t.#Es,"mouseenter",t.open.bind(t))),t.#Z(null,!0,!1)}#Z(t="",e="",s=""){if(e===s)return;const r=this;r.#Os&&GSDOM_GSDOM.setHTML(r.#Os,r.title),GSDOM_GSDOM.toggleClass(r.#Es,!0,"visible"),GSDOM_GSDOM.toggleClass(r.#ws,!r.closable,"invisible"),GSDOM_GSDOM.toggleClass(r.#Ms,r.backdrop&&r.visible,"show"),r.#Cs(),r.#Ts(),r.#xs(),r.#Ls(t,e,s),r.#ks(t,e,s)}#Cs(){const t=this;if(!t.autoclose)return;const e=t.visible,s=t.isHorizontal?"width":"height",r=e?t.max:t.min;t.#Es.style.transitionProperty=s,t.#Es.style.transitionDuration=`${t.transitionDuration}s`,t.#Es.style.transitionTimingFunction=t.transitionFunction,t.#Es.style[s]=`${r}px`}#Ts(){const t=this;if(0===t.min&&t.visible)return GSDOM_GSDOM.toggleClass(t.#Es,t.visible,"show");setTimeout((()=>{GSDOM_GSDOM.toggleClass(t.#Es,0!==t.min||t.visible,"show")}),GSDOM_GSDOM.SPEED)}#xs(){const t=this;setTimeout((()=>{GSDOM_GSDOM.toggleClass(t.#Ms,!(t.backdrop&&t.visible),"invisible")}),GSDOM_GSDOM.SPEED)}#Ls(t="",e="",s=""){if("placement"!==t)return;GSDOM_GSDOM.toggleClass(this.#Es,!1,`offcanvas-${e}`),GSDOM_GSDOM.toggleClass(this.#Es,!0,`offcanvas-${s}`)}#ks(t="",e="",s=""){if("css"!==t)return;GSDOM_GSDOM.toggleClass(this.#Es,!1,e),GSDOM_GSDOM.toggleClass(this.#Es,!0,s)}get isVertical(){return!this.isHorizontal}get isHorizontal(){return"start"===this.placement||"end"===this.placement}open(){this.visible=!0}close(){this.visible=!1}toggle(){this.visible=!this.visible}get css(){return GSAttr.get(this,"css","")}get cssTitle(){return GSAttr.get(this,"css-title","fs-5")}get cssHead(){return GSAttr.get(this,"css-head","")}get cssBody(){return GSAttr.get(this,"css-body","")}set css(t=""){GSAttr.set(this,"css",t)}get transitionDuration(){return GSAttr.getAsNum(this,"duration","0.2")}set transitionDuration(t=""){GSAttr.set(this,"duration",t)}get transitionFunction(){return GSAttr.get(this,"transition","linear")}set transitionFunction(t=""){GSAttr.set(this,"transition",t)}get title(){return GSAttr.get(this,"title")}set title(t=""){GSAttr.set(this,"title",t)}get visible(){return GSAttr.getAsBool(this,"visible",!1)}set visible(t=!1){GSAttr.setAsBool(this,"visible",t)}get autoclose(){return GSAttr.getAsBool(this,"autoclose",!1)}set autoclose(t=!1){GSAttr.setAsBool(this,"autoclose",t)}get closable(){return GSAttr.getAsBool(this,"closable",!0)}set closable(t=!0){GSAttr.setAsBool(this,"closable",t),this.#Z()}get placement(){return GSAttr.get(this,"placement",this.target?.dataset?.bsPlacement||"start")}set placement(t=""){return GSAttr.set(this,"placement",t)}get backdrop(){return GSAttr.getAsBool(this,"backdrop",this.target?.dataset?.bsBackdrop||"false")}set backdrop(t=""){return GSAttr.set(this,"backdrop",t)}get scroll(){return GSAttr.getAsBool(this,"scroll",this.target?.dataset?.bsScroll||"false")}set scroll(t=""){return GSAttr.set(this,"scroll",t)}get min(){return GSAttr.getAsNum(this,"min",0)}set min(t=!1){GSAttr.set(this,"min",GSUtil.asNum(t))}get max(){return GSAttr.getAsNum(this,"max",0)}set max(t=!1){GSAttr.set(this,"max",GSUtil.asNum(t))}get#Es(){return this.query(".offcanvas")}get#Os(){return this.query(".offcanvas-title")}get#Ms(){return this.query(".offcanvas-backdrop")}get#ws(){return this.query('.btn-close[data-bs-dismiss="offcanvas"]')}get#$s(){return this.querySelector('[slot="header"]')}#Ie(){const t=this,e=t.title?`<div class="offcanvas-title ${t.cssTitle}">${t.title}</div>`:"",s=t.closable?'<button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"></button>':"",r=e||s||t.#$s?`<div class="offcanvas-header ${t.cssHead}"><slot name="header">${e}${s}</slot></div>`:"";return`\n      <div class="offcanvas offcanvas-${t.placement} overflow-hidden ${t.css}" data-bs-scroll="${t.scroll}" data-bs-backdrop="${t.backdrop}" tabindex="-1">      \n      ${r}\n      <div class="offcanvas-body  ${t.cssBody}">\n        <slot name="body"></slot>\n      </div>\n    </div>\n    <div class="offcanvas-backdrop fade ${t.backdrop&&t.visible?"show":"invisible"}"></div>\n    `}}class GSPopper{static getOffset(t){const e=t.getBoundingClientRect(),s=window.scrollX,r=window.scrollY,n={left:e.left+s,right:e.right+s,top:e.top+r,bottom:e.bottom+r,height:e.height,width:e.width,x:e.x+s,y:e.y+r};return n.centerX=n.left+n.width/2,n.centerY=n.top+n.height/2,n}static boundingRect(t,e){const s=t.getBoundingClientRect(),r=GSPopper.elementPadding(e?t:null),n=r.x,i=r.y,a=t.clientWidth-n,o=t.clientHeight-i,c=s.left+r.left,l=s.top+r.top;return{width:a,height:o,top:l,left:c,x:c,y:l,centerX:a/2+c,centerY:l+o/2}}static elementPadding(t){const e={left:0,right:0,top:0,bottom:0,x:0,y:0};if(!(t instanceof HTMLElement))return e;const s=getComputedStyle(t);return e.left=parseFloat(s.paddingLeft),e.right=parseFloat(s.paddingRight),e.top=parseFloat(s.paddingTop),e.bottom=parseFloat(s.paddingBottom),e.x=e.left+e.right,e.y=e.top+e.bottom,e}static popupFixed(t="top",e,s,r){if(!e)return!1;if(!s)return!1;const n=GSPopper.#_s(t);if(!GSPopper.#Fs(n))return void GSLog.warn(e,`Invalid popover position: ${t}!`);e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.margin="0px",e.style.padding="0px";const i=e.clientHeight/2,a=e.clientWidth/2,o=GSPopper.boundingRect(s,r instanceof HTMLElement),c=GSPopper.#Is(e,r,n),l={x:o.centerX,y:o.centerY,offH:i,offW:a,srcH:e.clientHeight,srcW:e.clientWidth};GSPopper.#Ns(n,l,o,c),e.style.transform=`translate(${l.x}px, ${l.y}px)`}static popupAbsolute(t="top",e,s,r){if(!e)return!1;if(!s)return!1;const n=GSPopper.#_s(t);if(!GSPopper.#Fs(n))return void GSLog.warn(e,`Invalid popover position: ${t}!`);r.style.position="absolute",e.style.position="absolute",e.style.margin="0px",e.style.inset=GSPopper.#Rs(n);const i=e.getBoundingClientRect(),a=r.getBoundingClientRect(),o=GSPopper.getOffset(s),c={x:o.centerX,y:o.centerY},l={x:i.width/2-a.width/2,y:i.height/2-a.height/2};GSPopper.#js(n,c,l,i,a,o),e.style.transform=`translate(${c.x}px, ${c.y}px)`,r.style.transform=`translate(${l.x}px, ${l.y}px)`,r.style.top=l.top?l.top:"",r.style.left=l.left?l.left:""}static#js(t,e,s,r,n,i){t.isTop?(s.y=0,s.left="0px",e.x=e.x-r.width/2,e.y=-1*(r.bottom-i.top+n.height)):t.isBottom?(s.y=0,s.left="0px",e.x=e.x-r.width/2,e.y=i.bottom+n.height):t.isStart?(s.x=0,s.top="0px",e.x=-1*(r.right-i.left+n.width),e.y=e.y-r.height/2):t.isEnd&&(s.x=0,s.top="0px",e.x=i.right+n.width,e.y=e.y-r.height/2)}static#Ns(t,e,s,r){t.isTop?(e.y=s.top-e.srcH-r.size,e.x=e.x-e.offW):t.isBottom?(e.y=s.top+s.height+r.size,e.x=e.x-e.offW):t.isStart?(e.x=s.left-e.srcW-r.size,e.y=e.y-e.offH+r.size):t.isEnd&&(e.x=s.left+s.width+r.size,e.y=e.y-e.offH+r.size)}static#Rs(t){return t.isTop?"auto auto 0px 0px":t.isBottom?"0px auto auto 0px":t.isStart?"0px 0px auto auto":t.isEnd?"0px auto auto 0px":void 0}static#Fs(t){return t.isStart||t.isEnd||t.isTop||t.isBottom}static#_s(t){return{isStart:"start"==t||"left"==t,isEnd:"end"==t||"right"==t,isTop:"top"==t,isBottom:"bottom"==t}}static#Is(t,e,s){if(!e)return{x:0,y:0,size:0,width:0,height:0};let r=0;const n=GSPopper.boundingRect(t),i=GSPopper.boundingRect(e),a=s.isStart||s.isEnd?i.width:i.height,o=n.width/2-a/2,c=n.height/2-a/2;return i.size=a,e.style.position="absolute",s.isStart||s.isEnd?(e.style.left=null,e.style.top="0px",r=s.isStart?a:-1*a,e.style.transform=`translate(${r}px, ${c/2}px)`):(e.style.top=null,e.style.left="0px",r=s.isTop?a:-1*a,e.style.transform=`translate(${o}px, ${r}px)`),i}static{Object.seal(GSPopper),window.GSPopper=GSPopper}}class GSPopover extends GSElement{#Hs=!1;static{customElements.define("gs-popover",GSPopover),Object.seal(GSPopover),GSDOMObserver.registerFilter(GSPopover.#bt,GSPopover.#vt)}static#bt(t){return t instanceof HTMLElement&&((!t.tagName||!t.tagName.startsWith("GS-"))&&(GSPopover.#Us(t)&&!GSPopover.#Ps(t)))}static#vt(t){t.id=t.id||GSID.id;const e=document.createElement("gs-popover");e.ref=`#${t.id}`,requestAnimationFrame((()=>{setTimeout((()=>{t.parentElement.insertAdjacentElement("beforeend",e)}),100)}))}constructor(){super()}onReady(){super.onReady(),this.#At()}#At(){const t=this;t.isHoverTrigger&&(GSEvent.attach(t,t.target,"mouseover",t.show.bind(t)),GSEvent.attach(t,t.target,"mouseout",t.hide.bind(t))),t.isFocusTrigger&&GSEvent.attach(t,document.body,"click",t.#Bs.bind(t))}#P(t){const e=t.querySelector("div.popover-arrow");return GSPopper.popupAbsolute(this.placement,t,this.target,e),t}get#Ie(){const t=this,e=t.title?`<div class="popover-header ${t.cssHead}">${t.title}</div>`:"";return`\n        <div class="popover bs-popover-auto fade ${t.css}" data-popper-placement="${t.placement}" style="${this.getStyle()}" role="tooltip">\n            <div class="popover-arrow"></div>\n            ${e}\n            <div class="popover-body">${t.content}</div>\n        </div>            \n        `}get target(){const t=this;if(t.ref){let e=t.owner;return e=GSDOM_GSDOM.isGSElement(t.owner)?e.self:e,e.querySelector(t.ref)}return t.previousElementSibling||t.parentElement}get css(){return GSAttr.get(this,"css")}set css(t=""){return GSAttr.set(this,"css",t)}get cssHead(){return GSAttr.get(this,"css-head","fs-3")}set cssHead(t=""){return GSAttr.set(this,"css-head",t)}get ref(){return GSAttr.get(this,"ref")}set ref(t=""){return GSAttr.set(this,"ref",t)}get title(){return GSAttr.get(this,"title")||GSAttr.get(this.target,"title")}set title(t=""){return GSAttr.set(this,"title",t)}get placement(){return GSAttr.get(this,"placement",this.target?.dataset?.bsPlacement||"top")}set placement(t=""){return GSAttr.set(this,"placement",t)}get content(){return GSAttr.get(this,"content",this.target?.dataset?.bsContent||"")}set content(t=""){return GSAttr.set(this,"content",t)}get trigger(){return GSAttr.get(this,"trigger",this.target?.dataset?.bsTrigger||"hover focus")}set trigger(t=""){return GSAttr.set(this,"trigger",t)}get isFocusTrigger(){return this.trigger.includes("focus")}get isHoverTrigger(){return this.trigger.includes("hover")}get visible(){return 0!==this.innerHTML.length}get isFlat(){return!0}get anchor(){return"self"}async getTemplate(t=""){return""}show(){const t=this,e=GSDOM_GSDOM.parse(t.#Ie,!0);t.insertAdjacentElement("afterbegin",e),requestAnimationFrame((()=>{t.#P(e),GSDOM_GSDOM.toggleClass(e,!0,"show")}))}hide(){const t=this;return!t.#Hs&&(setTimeout((()=>{GSDOM_GSDOM.setHTML(t,"")}),250),GSDOM_GSDOM.toggleClass(t.firstElementChild,!1,"show"))}toggle(){const t=this;t.visible?t.hide():t.show()}#Bs(t){const e=this;if(e.#Hs)return e.#Hs=!1,void e.hide();const s=!e.isHoverTrigger;t.target==e.target?e.visible?e.#Hs=!0:s&&e.show():s&&e.visible&&e.hide()}static#Ps(t){return(t?.firstElementChild||t?.nextElementSibling)instanceof GSPopover}static#Us(t){return t?.dataset?.bsContent&&"popover"===t?.dataset?.bsToggle}}class GSPopup extends GSElement{#qe=null;#Ve=!1;#_=!1;#ze=!1;static{customElements.define("gs-popup",GSPopup),Object.seal(GSPopup)}static get observedAttributes(){return GSElement.observeAttributes(["visible","css"])}attributeCallback(t="",e="",s=""){const r=this;"visible"===t&&(r.#qs(),GSDOM_GSDOM.toggleClass(r.#Bt,!r.visible,"invisible"))}connectedCallback(){super.connectedCallback();const t=this;t.#Ve=!0,t.attachEvent(t,"form",t.#st.bind(t))}disconnectedCallback(){this.#Ve=!1,super.disconnectedCallback()}async getTemplate(t=""){const e=this,s=await super.getTemplate(t),r=e.visible?"":"invisible";return s&&requestAnimationFrame((()=>{const t=GSDOM_GSDOM.parse(s);for(let s of t.body.children)GSDOM_GSDOM.appendChild(e,s)})),`<div class="position-${e.position} ${e.css} ${r}" style="${this.getStyle()}"><slot></slot></div>`}onReady(){const t=this;t.#_||(t.#_=!0,t.#Vs(),super.onReady())}get isFlat(){return this.parentElement!==document.body}get anchor(){return"beforeend@body"}get#Bt(){return this.query("div")}get css(){return GSAttr.get(this,"css")}set css(t=""){return GSAttr.set(this,"css",t)}get event(){return GSAttr.get(this,"event","click")}set event(t=""){return GSAttr.set(this,"event",t)}get placement(){return GSAttr.get(this,"placement",this?.target?.datalist?.bsPlacement||"")}set placement(t=""){return GSAttr.set(this,"placement",t)}get position(){return GSAttr.get(this,"position","absolute")}set position(t=""){return GSAttr.set(this,"position",t)}get target(){return GSAttr.get(this,"target")}set target(t=""){return GSAttr.set(this,"target",t)}get visible(){return GSAttr.getAsBool(this,"visible",!1)}set visible(t=""){return GSAttr.setAsBool(this,"visible",t)}get autoclose(){return GSAttr.getAsBool(this,"autoclose",!0)}set autoclose(t=""){return GSAttr.getAsBool(this,"autoclose",t)}get hPos(){return GSAttr.getAsNum(this,"h-pos")}set hPos(t=""){return GSAttr.setAsNum(this,"h-pos",t)}get vPos(){return GSAttr.getAsNum(this,"v-pos")}set vPos(t=""){return GSAttr.setAsNum(this,"v-pos",t)}set wMax(t=""){return GSAttr.setAsNum(this,"w-max",t)}get wMax(){return GSAttr.getAsNum(this,"w-max")}set wMin(t=""){return GSAttr.setAsNum(this,"w-min",t)}get wMin(){return GSAttr.getAsNum(this,"w-min")}set hMax(t=""){return GSAttr.setAsNum(this,"h-max",t)}get hMax(){return GSAttr.getAsNum(this,"h-max")}set hMin(t=""){return GSAttr.setAsNum(this,"h-min",t)}get hMin(){return GSAttr.getAsNum(this,"h-min")}close(t){const e=this;if(e.visible=!1,t instanceof Event){t.preventDefault();const s={type:"popup",option:t.target,caller:e.#qe,data:null};GSEvent.send(e,"action",s,!0,!0)}}open(){this.visible=!0}toggle(t){const e=this;if(t)return e.#ss(t);e.visible=!e.visible}popup(t=0,e=0){const s=this,r=s.#Bt;r&&requestAnimationFrame((()=>{s.visible=!0,r.style.top="0px",r.style.left="0px",s.#qs(),r.style.transform=`translate(${t}px, ${e}px)`}))}#qs(){const t=this,e=t.#Bt;e&&(t.visible||(t.style.transform="unset"),t.wMax&&(e.style.maxWidth=`${t.wMax}px`),t.wMin&&(e.style.minWidth=`${t.wMin}px`),t.hMax&&(e.style.maxHeight=`${t.hMax}px`),t.hMin&&(e.style.minHeight=`${t.hMin}px`))}#Xe(t){this.close()}#ss(t){const e=this;if(e.#qe=t,t instanceof Event&&(t.preventDefault(),e.#qe=t.composedPath().filter((t=>!(t instanceof HTMLSlotElement)))[0]),e.placement)return GSPopper.popupFixed(e.placement,e.#Bt,e.#qe),void(e.visible=!0);let s=t.clientX,r=t.clientY;const n=e.#Bt.getBoundingClientRect(),i=s+n.width>window.innerWidth,a=r+n.height>window.innerHeight;return i&&(s=window.innerWidth-n.width),a&&(r=window.innerHeight-n.height),e.popup(s,r),!0}async#Ke(){const t=this;if(!t.target)return;if(t.#ze)return;const e=GSDOM_GSDOM.queryAll(document.documentElement,t.target);0!==e.length?(t.#ze=!0,t.event.split(" ").forEach((s=>{e.forEach((e=>t.attachEvent(e,s,t.#ss.bind(t))))})),t.removeEvent(document,"gs-components")):t.#Ve&&(await GSUtil.timeout(1e3),requestAnimationFrame((()=>{t.#Ke()})))}#Vs(){const t=this;t.#Ke(),t.attachEvent(document,"gs-component",t.#Ke.bind(t)),t.attachEvent(window,"resize",t.#Xe.bind(t)),t.#qs(),t.autoclose&&t.attachEvent(t.#Bt,"mouseleave",t.close.bind(t)),t.visible&&t.popup(t.hPos,t.vPos)}#st(t){const e=this;let s=e.#zs(t,t.target,"submit","GS-POPUP");s&&(GSEvent.prevent(t),s=GSEvent.send(e,"data",{type:"popup",data:t.detail.data,evt:t},!0,!0,!0),s&&e.close())}#zs(t,e,s,r){if(t.detail.type!==s)return!1;return GSComponents_GSComponents.getOwner(e,r)==this}}class GSProgress extends GSElement{static{customElements.define("gs-progress",GSProgress),Object.seal(GSProgress)}static get observedAttributes(){return GSElement.observeAttributes(["min","max","now"])}constructor(){super()}attributeCallback(t="",e="",s=""){const r=this,n=r.#Ws;n&&(GSAttr.set(n,`aria-value${t}`,s),n.style.width=`${r.percentage}%`,r.label&&GSDOM_GSDOM.setHTML(n,r.#Ys()))}#Ys(){const t=this,e={now:t.value,min:t.min,max:t.max,percentage:t.percentage};return GSUtil.fromTemplateLiteral(t.label,e)}async getTemplate(t=""){const e=this,s=e.label?GSUtil.fromTemplateLiteral(e.label,{now:e.value,min:e.min,max:e.max,percentage:e.percentage}):"";return`\n        <div class="progress" style="${this.getStyle()}">\n            <div class="progress-bar ${e.css}" role="progressbar" style="width: ${e.percentage}%" aria-valuenow="${e.value}" aria-valuemin="${e.min}" aria-valuemax="${e.max}">${s}</div>\n        </div>    \n        `}get#Ws(){return this.query(".progress-bar")}get isFlat(){return!0}get anchor(){return"self"}get percentage(){return Math.trunc(this.value/this.max*100)}get value(){return GSAttr.getAsNum(this,"now",0)}set value(t=""){if(!GSUtil.isNumber(t))return!1;const e=this;let s=GSUtil.asNum(t)||e.value;return s>e.max&&(s=e.max),s<e.min&&(s=e.min),GSAttr.set(e,"now",s)}get min(){return GSAttr.getAsNum(this,"min",0)}set min(t=""){return GSAttr.setAsNum(this,"min",0)}get max(){return GSAttr.getAsNum(this,"max",100)}set max(t=""){return GSAttr.setAsNum(this,"max",100)}get css(){return GSAttr.get(this,"css","")}set css(t=""){return GSAttr.set(this,"css",t)}get label(){return GSAttr.get(this,"label","")}set label(t=""){return GSAttr.set(this,"label",t)}increase(t=1){return this.value=this.value+t,!0}decrease(t=1){return this.value=this.value-t,!0}}class GSSplitter extends GSElement{#Js=0;#Ks=!1;static{customElements.define("gs-splitter",GSSplitter),Object.seal(GSSplitter)}constructor(){super()}async getTemplate(t=""){const e=this,s=e.isVertical?"width":"height",r=e.isVertical?"height":"width",n=e.isVertical?"w-resize":"n-resize";return`\n            <style>\n                .splitter {\n                    ${s}: ${e.size}px;\n                    ${r}: 100%;\n                    border-width: 1px;\n                    cursor: ${n};\n                    border-color: darkgray;\n                    border-style: solid;\n                    background-color: lightgray;\n                }                        \n            </style>\n            <div class="splitter ${e.css}" style="${this.getStyle()}"></div>\n        `}get isVertical(){return"vertical"===GSAttr.get(this,"split","vertical")}get css(){return GSAttr.get(this,"css")}set css(t=""){return GSAttr.set(this,"css",t)}get size(){return GSAttr.getAsNum(this,"size",8)}set size(t=""){return GSAttr.setAsNum(this,"size",t)}get resize(){return GSAttr.get(this,"resize","start")}set resize(t=""){return GSAttr.set(this,"resize",t)}get start(){return this.previousElementSibling}get end(){return this.nextElementSibling}get target(){const t=this;let e=t.#Xs?t.start:t.end;return e=e||t.parentElement,e=GSDOM_GSDOM.isGSElement(e)?e.self:e,e instanceof ShadowRoot&&(e=Array.from(e.children).filter((t=>"none"!==window.getComputedStyle(t).display)).pop()),e}connectedCallback(){this.#Ks=!!this.id,super.connectedCallback()}onReady(){this.#Zs(),this.#Qs(),super.onReady()}get#Xs(){const t=this.resize;return"start"===t||"top"===t}get#ms(){return this.query("div")}#Zs(){const t=this;if(!t.#Ks)return;const e=GSID.hashCode(location.origin+location.pathname);let s=localStorage.getItem(`gs-splitter-${e}-${t.id}`);s=GSUtil.asNum(s),s>0&&(t.#Js=s,t.isVertical?t.target.style.width=s+"px":t.target.style.height=s+"px")}#tr(){const t=this,e=window.getComputedStyle(t.target),s=t.isVertical?e.width:e.height,r=GSID.hashCode(location.origin+location.pathname);localStorage.setItem(`gs-splitter-${r}-${t.id}`,s.match(/(\d+)/)[0])}#Qs(){const t=this,e=t.#ms;t.attachEvent(e,"mousedown",t.#er.bind(t),!0)}#er(t){const e=this;GSEvent.prevent(t),e.#Js=e.isVertical?t.clientX:t.clientY,e.attachEvent(document,"mouseup",e.#sr.bind(e),!0),e.attachEvent(document,"mousemove",e.#rr.bind(e))}#sr(t){const e=this;GSEvent.prevent(t),GSEvent.deattachListeners(e),e.#tr(),e.#Qs()}#rr(t){GSEvent.prevent(t);const e=this.isVertical?t.clientX:t.clientY;this.#Z(e)}#Z(t){const e=this;requestAnimationFrame((()=>{e.isVertical?e.#nr(t):e.#ir(t)}))}#nr(t){const e=this,s=e.target,r=e.#Xs?1:-1;let n=(t-e.#Js)*r;n+=s.clientWidth,n=n<0?0:n,s.style.width=n+"px",e.#Js=t}#ir(t){const e=this,s=e.target,r=e.#Xs?1:-1;let n=(t-e.#Js)*r;n+=s.clientHeight,n=n<0?0:n,s.style.height=n+"px",e.#Js=t}}class GSTab extends GSElement{static CSS_PANE="";static CSS_NAV="";static CSS_NAV_WRAP="";static{customElements.define("gs-tab",GSTab),Object.seal(GSTab)}static get observedAttributes(){return GSElement.observeAttributes(["data"])}constructor(){super(),GSItem.validate(this,this.tagName)}attributeCallback(t="",e="",s=""){if("data"===t)return this.load(s)}async getTemplate(t=""){const e=this,s=GSItem.genericItems(e);s.forEach((t=>t.id=GSID.id));const r=s.map((t=>e.#ar(t))).join(""),n=s.map((t=>e.#or(t))).join(""),i=e.#cr(n),a=e.#lr?e.#ur(r):e.#dr(r);return`<div class="${e.#lr?`d-flex align-items-start ${e.#hr}`:e.#hr}">${e.#mr?i+a:a+i}</div>`}get#mr(){return"end"===this.#gr||"bottom"===this.#gr}get#lr(){return"start"===this.#gr||"end"===this.#gr}get#gr(){return GSAttr.get(this,"placement","top")}get#fs(){return GSAttr.get(this,"css-nav","nav-tabs")}get#Sr(){return GSAttr.get(this,"css-pane")}#ur(t){return`\n      <div class="nav flex-column ${GSTab.CSS_NAV} ${this.#fs}" id="v-pills-tab" role="tablist" aria-orientation="vertical">\n        ${t}\n      </div>\n    `}#dr(t){return`\n      <ul class="nav ${GSTab.CSS_NAV} ${this.#fs}" "role="tablist">\n        ${t}\n      </ul>      \n      `}#cr(t){return`     \n        <div class="tab-content flex-fill ${GSTab.CSS_PANE} ${this.#Sr}">\n          ${t}\n        </div>  \n      `}#ar(t){const e=this,s=e.#lr?"":`<li class="nav-item ${GSTab.CSS_NAV_WRAP} ${e.#pr(t)}" role="presentation">`,r=e.#gs(t),n=e.#Gr(t),i=`${n?`<i class="${n}"></i>`:""} ${r}`,a=e.#fr(t);return`${s}\n          <a type="button" role="tab" is="gs-ext-navlink"\n              id="${t.id}-tab" \n              class="nav-link ${e.#br(t)} ${a}" \n              aria-controls="${t.id}-tab"                 \n              data-bs-target="#${t.id}-pane" \n              data-bs-toggle="tab">${i}</a>\n          ${s?"</li>":""}\n      `}#or(t){const e=this;return e.isFlat?e.#vr(t):e.#yr(t)}#yr(t){const e=this,s=e.#Ar(t),r=GSItem.getBody(t),n=GSDOM_GSDOM.parseWrapped(e,r);return GSAttr.set(n,"slot",t.id),GSDOM_GSDOM.appendChild(e,n),`\n      <div  id="${t.id}-pane" aria-labelledby="${t.id}-tab" \n          class="tab-pane fade ${e.#Dr(t)}  ${s}" \n          role="tabpanel">\n          <slot name="${t.id}"></slot>\n      </div>        \n      `}#vr(t){const e=this,s=e.#Ar(t),r=GSItem.getBody(t,e.isFlat);return`\n      <div  id="${t.id}-pane" aria-labelledby="${t.id}-tab" \n          class="tab-pane fade ${e.#Dr(t)}  ${s}" \n          role="tabpanel">\n          ${r}\n      </div>        \n      `}#Mr(t){return GSAttr.getAsBool(t,"active")}#fr(t){return this.#Mr(t)?"active":""}#Ar(t){return this.#Mr(t)?"active show":""}#gs(t){return GSAttr.get(t,"title")}#Gr(t){return GSAttr.get(t,"icon")}#Dr(t){return GSAttr.get(t,"css-pane")}#br(t){return GSAttr.get(t,"css-nav")}#pr(t){return GSAttr.get(t,"css-nav-wrap")}get#hr(){return GSAttr.get(this,"css","")}async load(t=""){const e=await GSLoader.loadData(t);if(!GSUtil.isJsonType(e))return;const s=this,r=GSItem.generateItem(e);GSDOM_GSDOM.setHTML(s,r),GSEvent.deattachListeners(s),s.connectedCallback()}}class GSTooltip extends GSElement{static{customElements.define("gs-tooltip",GSTooltip),Object.seal(GSTooltip),GSDOMObserver.registerFilter(GSTooltip.#bt,GSTooltip.#vt)}static#bt(t){return t instanceof HTMLElement&&((!t.tagName||!t.tagName.startsWith("GS-"))&&(GSTooltip.#Er(t)&&!GSTooltip.#Or(t)))}static#vt(t){t.id=t.id||GSID.id;const e=document.createElement("gs-tooltip");e.ref=`#${t.id}`,requestAnimationFrame((()=>{setTimeout((()=>{t.parentElement.insertAdjacentElement("beforeend",e)}),100)}))}constructor(){super()}onReady(){super.onReady(),this.#At()}#At(){const t=this;t.attachEvent(t.target,"mouseenter",t.show.bind(t)),t.attachEvent(t.target,"mouseleave",t.hide.bind(t))}#wr(){const t=this,e=t.querySelector("div.tooltip-arrow");return GSPopper.popupFixed(t.placement,t.firstElementChild,t.target,e),t.firstElementChild}get#Ie(){return`\n         <div class="tooltip bs-tooltip-auto fade " data-popper-placement="${this.placement}" role="tooltip">\n            <div class="tooltip-arrow"></div>\n            <div class="tooltip-inner">${this.title}</div>\n        </div>        \n        `}get target(){const t=this;if(t.ref){let e=t.owner;return e=GSDOM_GSDOM.isGSElement(t.owner)?e.self:e,e.querySelector(t.ref)}return t.previousElementSibling||t.parentElement}get ref(){return GSAttr.get(this,"ref")}set ref(t=""){return GSAttr.set(this,"ref",t)}get title(){return GSAttr.get(this,"title")||GSAttr.get(this.target,"title")}set title(t=""){return GSAttr.set(this,"title",t)}get placement(){return GSAttr.get(this,"placement",this.target?.dataset?.bsPlacement||"top")}set placement(t=""){return GSAttr.set(this,"placement",t)}get isFlat(){return!0}show(){const t=this;requestAnimationFrame((()=>{const e=GSDOM_GSDOM.parse(t.#Ie,!0);t.insertAdjacentElement("afterbegin",e),t.#wr(),GSDOM_GSDOM.toggleClass(t.firstElementChild,!0,"show")}))}hide(){const t=this;return setTimeout((()=>{Array.from(t.childNodes).forEach((t=>t.remove()))}),250),GSDOM_GSDOM.toggleClass(t.firstElementChild,!1,"show")}toggle(){const t=this;t.childElementCount>0?t.hide():t.show()}static#Or(t){return(t?.firstElementChild||t?.nextElementSibling)instanceof GSTooltip}static#Er(t){return t?.title&&"tooltip"===t?.dataset?.bsToggle}}class GSAttachment{constructor(t,e){this.file=t,this.directory=e}static traverse(t,e){return GSAttachment.#Cr(t,e)}static from(t){return Array.from(t).filter((t=>t instanceof File)).map((t=>new GSAttachment(t)))}get fullPath(){const t=this;return t.directory?`${t.directory}/${t.file.name}`:t.file.name}isImage(){return["image/gif","image/png","image/jpg","image/jpeg","image/svg+xml"].includes(this.file.type)}isVideo(){return["video/mp4","video/quicktime"].includes(this.file.type)}static#Cr(t,e){return e&&GSAttachment.#Tr(t)?GSAttachment.#xr("",GSAttachment.#Lr(t)):Promise.resolve(GSAttachment.#kr(Array.from(t.files||[])).map((t=>new GSAttachment(t))))}static#$r(t){return t.name.startsWith(".")}static#kr(t){return Array.from(t).filter((t=>!GSAttachment.#$r(t)))}static#_r(t){return new Promise((function(e,s){t.file(e,s)}))}static#Fr(t){return new Promise((function(e,s){const r=[],n=t.createReader(),read=()=>{n.readEntries((t=>{t.length>0?(r.push(...t),read()):e(r)}),s)};read()}))}static async#xr(t,e){const s=[];for(const r of GSAttachment.#kr(e))if(r.isDirectory){const t=await GSAttachment.#Fr(r),e=await GSAttachment.#xr(r.fullPath,t);s.push(...e)}else{const e=await GSAttachment.#_r(r);s.push(new GSAttachment(e,t))}return s}static#Tr(t){return Array.from(t.items).some((t=>{const e=t.webkitGetAsEntry&&t.webkitGetAsEntry();return e&&e.isDirectory}))}static#Lr(t){return Array.from(t.items).map((t=>t.webkitGetAsEntry())).filter((t=>null!=t))}}class GSFileBox extends GSElement{static TITLE="Drop files here or click to select";static CSS="border-2 p-4 d-block text-center dash";#Ir=null;constructor(){super()}async getTemplate(t=""){const e=this;return`<style>\n            .dash {\n                border-style: var(--gs-fieldbox-border, dashed) !important;\n                border-color: var(--gs-fieldbox-border-color, lightgrey);\n            }\n            input[type=file] {\n                color : var(--gs-fieldbox-color, transparent);\n            } \n            input[type=file]::file-selector-button {\n\n            }             \n            input[type=file]::file-selector-button:hover {\n            }            \n        </style>\n        <div part="border" class="${e.css}">\n            <label part="label" class="${e.cssLabel}" for="${e.name}">${e.title}</label>\n            <input part="input" class="${e.cssInput}" type="file" id="${e.name}" name="${e.name}" ${e.multiple?"multiple":""} ${e.directory?"directory webkitdirectory":""} >\n            <pre part="list" class="${e.cssList}"></pre>\n        </div>\n        `}onReady(){const t=this,e=t.query("div");t.attachEvent(e,"click",t.#et.bind(t)),t.attachEvent(e,"dragenter",t.#Nr.bind(t)),t.attachEvent(e,"dragover",t.#Nr.bind(t)),t.attachEvent(e,"dragleave",t.#Rr.bind(t)),t.attachEvent(e,"drop",t.#jr.bind(t)),t.attachEvent(e,"paste",t.#Hr.bind(t)),t.attachEvent(e,"change",t.#Ur.bind(t)),super.onReady()}get listEl(){return this.query("pre")}get fileEl(){return this.query("input")}get css(){return GSAttr.get(this,"css",GSFileBox.CSS)}set css(t=""){return GSAttr.set(this,"css")}get cssList(){return GSAttr.get(this,"css-list","")}set cssList(t=""){return GSAttr.set(this,"css-list")}get cssLabel(){return GSAttr.get(this,"css-label","")}set cssLabel(t=""){return GSAttr.set(this,"css-label")}get cssInput(){return GSAttr.get(this,"css-input","d-none")}set cssInput(t=""){return GSAttr.set(this,"css-input")}get multiple(){return GSAttr.getAsBool(this,"multiple",!0)}set multiple(t=""){return GSAttr.setAsBool(this,"mulltiple",t)}get title(){return GSAttr.get(this,"title",GSFileBox.TITLE)}set title(t=""){return GSAttr.set(this,"title",GSFileBox.TITLE)}get name(){return GSAttr.get(this,"name","")}set name(t=""){return GSAttr.set(this,"name","")}get filter(){return GSAttr.get(this,"filter","^image/(gif|png|jpeg)$")}set filter(t=""){return GSAttr.set(this,"filter")}get directory(){return GSAttr.getAsBool(this,"directory",!1)}set directory(t=""){return GSAttr.setAsBool(this,"directory",val)}#et(t){if(t.target instanceof HTMLLabelElement)return;const e=this.fileEl.previousElementSibling;e instanceof HTMLLabelElement&&e.click()}#Nr(t){const e=this;e.#Ir&&clearTimeout(e.#Ir),e.#Ir=window.setTimeout((()=>e.removeAttribute("hover")),200);const s=t.dataTransfer;s&&e.#Pr(s)&&(s.dropEffect="copy",e.setAttribute("hover",""),t.preventDefault())}#Rr(t){t.dataTransfer&&(t.dataTransfer.dropEffect="none"),this.removeAttribute("hover"),GSEvent.prevent(t)}#jr(t){const e=this;e.removeAttribute("hover");const s=t.dataTransfer;s&&e.#Pr(s)&&(e.#Br(s),GSEvent.prevent(t))}#Hr(t){if(!t.clipboardData)return;if(!t.clipboardData.items)return;const e=this.#qr(t.clipboardData.items);if(!e)return;const s=[e];this.#Br(s),t.preventDefault()}#Ur(t){const e=this.fileEl,s=e.files;s&&0!==s.length&&(this.#Br(s),e.value="")}#Pr(t){return Array.from(t.types).indexOf("Files")>=0}#qr(t){const e=this.filter?new RegExp(this.filter):null;for(const s of t)if("file"===s.kind){if(!e)return s.getAsFile();if(e.test(s.type))return s.getAsFile()}return null}#Vr(t){const e=new DataTransfer;t.forEach((t=>e.items.add(t.file))),this.fileEl.files=e.files,this.listEl.textContent=t.map((t=>t.file.name)).join("\n")}async#Br(t){const e=this,s=t instanceof DataTransfer?await GSAttachment.traverse(t,e.directory):GSAttachment.from(t);GSEvent.send(e,"accept",{attachments:s},!0,!1,!0)&&s.length&&(e.#Vr(s),GSEvent.send(e,"accepted",{attachments:s},!0))}static{customElements.define("gs-filebox",GSFileBox),Object.seal(GSFileBox)}}class GSStore extends HTMLElement{static#zr=["rest","query","quark"];#Ve=!1;#Wr="";#Yr=[];#Jr=!1;#Kr=0;#Xr=0;#Zr=1;#Qr=[];#tn=[];#en=0;static{customElements.define("gs-store",GSStore),Object.seal(GSStore)}static get observedAttributes(){return["id","src","limit","skip","remote","filter","sort"]}constructor(){super(),GSItem.validate(this,this.tagName)}attributeChangedCallback(t="",e="",s=""){const r=this;if("id"===t)return GSComponents_GSComponents.remove(e),void GSComponents_GSComponents.store(r);GSComponents_GSComponents.hasSetter(r,t)&&(r[t]=s),"src"===t&&(r.#Yr=[],r.reload())}connectedCallback(){const t=this;t.#Ve=!0,t.id||t.setAttribute("id",GSID.id),GSComponents_GSComponents.store(t)}disconnectedCallback(){this.#Ve=!1,GSComponents_GSComponents.remove(this)}async waitEvent(t=""){if(!t)throw new Error("Event undefined!");const e=this;return new Promise(((s,r)=>{e.once(t,(t=>s(t.detail)))}))}once(t,e){return this.attachEvent(this,t,e,!0)}listen(t,e){return this.attachEvent(this,t,e)}unlisten(t,e){this.removeEvent(this,t,e)}attachEvent(t,e="",s,r=!1){return GSEvent.attach(this,t,e,s,r)}removeEvent(t,e="",s){GSEvent.remove(this,t,e,s)}get mode(){const t=GSAttr.get(this,"mode","query");return GSStore.#zr.includes(t)?t:"query"}set mode(t="query"){if(GSStore.#zr.includes(t))return GSAttr.set(this,"mode",t);console.log(`Invalid mode, allowed: ${GSStore.#zr}`)}get action(){let t="";switch(this.mode){case"query":t="?limit=${limit}&skip=${skip}&sort=${sort}&filter=${filter}";break;case"rest":t="/${limit}/${skip}?sort=${sort}&filter=${filter}"}return GSAttr.get(this,"action",t)}get table(){return GSDOM_GSDOM.closest(this,"GS-TABLE")}get url(){const t=this;return t.#sn(t.src,t.skip,t.limit,t.filter,t.sort)}get src(){return this.#Wr}set src(t=""){this.#Wr=t,this.reload()}get limit(){return this.#Xr}set limit(t=0){this.#Xr=GSUtil.asNum(t),this.reload()}get skip(){return this.#Kr}set skip(t=0){this.#Kr=GSUtil.asNum(t),this.reload()}get remote(){return this.#Jr}set remote(t=!1){this.#Jr=GSUtil.asBool(t),this.reload()}get filter(){return this.#tn}set filter(t){this.#tn=GSUtil.isJson(t)?GSUtil.toJson(t):t,this.reload()}get sort(){return this.#Qr}set sort(t){this.#Qr=GSUtil.isString(t)?JSON.parse(t):t,this.reload()}get data(){return this.#Yr}get total(){return this.#en||this.#Yr.length}get offset(){return(this.page-1)*this.limit}get page(){return this.#Zr}set page(t=1){if(!GSUtil.isNumber(t))throw new Error("Numeric value required!");const e=this;e.#Zr=GSUtil.asNum(t<1?1:t),e.#Zr=e.#Zr>e.pages?e.pages:e.#Zr;const s=e.#Xr*(t-1);e.getData(s,e.#Xr,e.#tn,e.#Qr)}get pages(){const t=this;return 0===t.total||0===t.limit?1:Math.ceil(t.total/t.#Xr)}nextPage(){const t=this;if(t.page!==t.pages)return t.page=t.page+1,t.#Zr}prevPage(){const t=this;if(1!==t.page)return t.page=t.page-1,t.#Zr}lastPage(){const t=this;return t.page=0===t.#Xr?1:t.pages,t.#Zr}firstPage(){return this.page=1,this.#Zr}clear(){this.#en=0,this.setData()}async load(t,e){const s=this;if(!s.#Ve)return!1;const r=t||s.src;if(0===r.length)return!1;(e=e||{}).headers=e.headers||{},e.headers["Content-Type"]="application/json; utf-8",e.headers.Accept="application/json";const n=await fetch(r,e);if(!n.ok)return!1;const i=await n.json();return s.#Z(i),i}#Z(t=[],e=!1){const s=this;let r=t;Array.isArray(t)?s.#en=r.length:Array.isArray(t.data)?(s.#en=t.total,r=t.data):r=[t],s.#Yr=e?s.#Yr.concat(r):r,s.#en<s.#Yr.length&&(s.#en=s.#Yr.length)}setData(t=[],e=!1){const s=this;s.#Z(t,e),s.#rn("data",s.#Yr)}async getData(t=0,e=0,s,r){const n=this;s=n.#nn(s||n.filter),r=n.#in(r||n.sort);let i=[];if(!(GSUtil.isString(s)&&GSUtil.isStringNonEmpty(s))&&n.src&&(n.remote||0==n.data.length)){const a=n.#sn(n.src,t,e,s,r);i=await n.load(a)}if(!n.remote){const a=n.#an();i=GSData.filterData(s,n.#Yr,a),i=GSData.sortData(r,i),e=0===e?i.length:e,i=i.slice(t,t+e)}return n.#rn("data",i),i}reload(){const t=this;if(t.#Ve)return t.getData(t.skip,t.limit,t.filter,t.sort)}#sn(t,e,s,r,n){n=n?JSON.stringify(n):"",r=r?JSON.stringify(r):"";const i={limit:s,skip:e,sort:encodeURIComponent(n),filter:encodeURIComponent(r)};return t+GSUtil.fromLiteral(this.action,i)}async#rn(t="data",e){const s=this;setTimeout((()=>{GSEvent.send(s,t,e,!0)}),1)}#nn(t){let e=[];return("string"==typeof t||Array.isArray(t))&&(e=t),e}#in(t=""){let e;if("string"==typeof t)e=[{col:t}];else if(Array.isArray(t))e=t;else if(GSUtil.isNumber(t)){const s=Math.abs(t);e=new Array(s),e[s-1]={ord:t}}return e}#an(){const t=this.table?.header?.fields;return t||Array.from(this.querySelectorAll("gs-item")).map((t=>t.name))}}class GSColumn extends HTMLElement{static{customElements.define("gs-column",GSColumn)}constructor(){super(),GSItem.validate(this,this.tagName)}render(){const t=this,e=t.sortable?"sorting":"",s=t.width?`style="width:${t.width};"`:"";return`<th scope="col" name="${t.name}" class="${e} ${t.cssHeader}" ${s}>${t.title||t.name}</th>`}renderFilter(){const t=this;if(!t.filter)return"<th></th>";let e="";switch(t.list){case"fixed":e=t.#on();break;case"flexi":e=t.#cn();break;default:e=t.#ln()}return`<th css="${t.cssFilter}">${e}</th>`}#on(){const t=this,e=t.#un(!0);return`<select auto="${t.auto}" name="${t.name}" title="${t.title||t.name}" class="${t.cssField}" >${e}</select>`}#cn(){const t=GSID.next();return this.#ln(t)+`<datalist id="${t}">${this.#un(!1)}</datalist>`}#ln(t=""){const e=this;return`<input auto="${e.auto}" name="${e.name}" title="${e.title||e.name}" class="${e.cssField}" placeholder="${e.title||e.name}" list="${t}">`}#un(t=!1){const e=[];return this.filters.forEach((s=>{const r=GSAttr.getAsBool(s,"default",!1),n=GSAttr.get(s,"value",""),i=GSAttr.get(s,"map",n);let a="";a=t?`<option value="${n}" ${r?"selected":""}>${i}</option>`:`<option value="${i}" data-value="${n}">`,e.push(a)})),e.join("")}get table(){return GSDOM_GSDOM.closest(this,"GS-TABLE")}get cssField(){const t=this.list?"form-select":"form-control";return GSAttr.get(this,"css-field",t)}get filter(){return GSAttr.getAsBool(this,"filter",!1)}get sortable(){const t=this;return!(!t.name||t.counter)&&GSAttr.getAsBool(t,"sortable",!0)}get cssFilter(){return GSAttr.get(this,"css-filter","")}get cssHeader(){return GSAttr.get(this,"css-header","border-end")}get css(){return GSAttr.get(this,"css","")}get width(){return GSAttr.get(this,"width")}get name(){return GSAttr.get(this,"name","")}get title(){return GSAttr.get(this,"title","")}get counter(){return"#"===this.name}get index(){return GSAttr.getAsNum(this,"index",-1)}get format(){return GSAttr.get(this,"format")}get type(){return GSAttr.get(this,"type")}get list(){const t=GSAttr.get(this,"list","").toLowerCase(),e=["fixed","flexi"].includes(t);return e||this.auto?e?t:"":"flexi"}get items(){return GSItem.genericItems(this)}get filters(){return GSItem.genericItems(this.querySelector('gs-item[filter="true"]'))}get maps(){return GSItem.genericItems(this.querySelector('gs-item[map="true"]'))}get auto(){return 0===this.childElementCount}toJSON(){const t=this,e=t.maps.map((t=>[GSAttr.get(t,"value"),GSAttr.get(t,"map")]));return{name:t.name,title:t.title,width:t.width,sortable:t.sortable,idx:t.index,type:t.type,format:t.format,css:t.css,map:e}}}class GSHeader extends HTMLElement{static{customElements.define("gs-header",GSHeader)}get#dn(){return GSDOM_GSDOM.queryAll(this,"gs-column[filter=true]")}get#hn(){return GSDOM_GSDOM.queryAll(this,"gs-column").filter((t=>"false"===GSAttr.get(t,"hidden","false")))}render(){const t=this,e=t.table,s=t.#dn,r=t.#hn,n=[];return n.push(`<thead class="${e.cssHeader}">`),s.length>0&&(n.push(`<tr is="gs-tablefilter" class="${e.cssFilter}">`),r.forEach((t=>n.push(t.renderFilter()))),n.push("</tr>")),n.push(`<tr is="gs-tablesort" class="${e.cssColumns}">`),r.forEach((t=>n.push(t.render()))),n.push("</tr>"),n.push("</thead>"),n.join("")}toJSON(){return this.#hn.map((t=>t.toJSON()))}get table(){return GSDOM_GSDOM.closest(this,"GS-TABLE")}get fields(){return this.#hn.map((t=>GSAttr.get(t,"name")))}}class GSTBody extends HTMLTableSectionElement{#mn=null;static{customElements.define("gs-tbody",GSTBody,{extends:"tbody"}),Object.seal(GSTBody)}connectedCallback(){const t=this;t.id||t.setAttribute("id",GSID.id),GSEvent.attach(t,t,"click",(e=>t.#et(e))),GSEvent.attach(t,t,"contextmenu",(e=>t.#gn(e)),!1,!0),t.#mn=GSDOM_GSDOM.closest(t,"GS-TABLE")}disconnectedCallback(){this.#mn=null,GSEvent.deattachListeners(this)}get index(){return this.table.index}get cssCell(){return this.table.cssCell}get cssRow(){return this.table.cssRow}get cssSelect(){return this.table.cssSelect}get select(){return this.table.select}get multiselect(){return this.table.multiselect}get table(){return this.#mn||GSDOM_GSDOM.closest(this,"GS-TABLE")}render(t,e,s){const r=this;if(!Array.isArray(t))return;const n=[];let i="";e.forEach(((e,a)=>{n.push(`<tr class="${r.cssRow}" data-index=${a}>`),i=Array.isArray(e)?r.#Sn(t,e,a,s):r.#ft(t,e,s),n.push(i),n.push("</tr>")})),0===e.length&&r.table.noDataText&&n.push(r.#pn(t.length)),GSDOM_GSDOM.setHTML(r,n.join("")),GSDOM_GSDOM.queryAll(r,"tr").forEach((t=>{0===t.innerText.trim().length&&t.remove()}))}#pn(t){return`<tr data-ignore="true"><td colspan="${t}" class="text-center fw-bold text-muted">${this.table.noDataText}</td></tr>`}#Sn(t,e,s,r){const n=this,i=[];return t.forEach((t=>{const a="#"===t.name?(s+1+r).toString():e[t.idx];i.push(`<td class="${n.cssCell}">${a||"&nbsp;"}</td>`)})),i.join("")}#ft(t,e,s){const r=this,n=[];return t.forEach(((t,i)=>{const a=r.#Gn(t,e,i+1+s);n.push(a)})),n.join("")}#Gn(t,e,s){let r="#"===t.name?s:e[t.name];const n=t.map?.filter((t=>t[0]===""+r));return r=n?.length>0&&n[0][1]||r,r=this.#fn(t,r),`<td class="${this.cssCell} ${t.css}">${r?.toString()||"&nbsp;"}</td>`}#fn(t,e){if(!t.format)return e;const s=this.#Fe(t,e),r=t.locale||navigator.locale;switch(s){case"timestamp":case"date":const s="true"==t.format?void 0:t.format;return e&&e>0?new GSDate(e).format(s,r):e;case"string":case"boolean":case"number":break;case"currency":const n={style:"currency",currency:t.currency};return new Intl.NumberFormat(r,n).format(e)}return e}#Fe(t,e){return t.type?t.type:e instanceof Date?"date":e instanceof Number?"number":e instanceof Boolean?"boolean":typeof e}#gn(t){}#et(t){const e=this,s=t.target,r=t.shiftKey&e.multiselect;"TD"!==!s.tagName&&e.select&&requestAnimationFrame((()=>{e.#bn(s.closest("tr"),r,t)}))}#bn(t,e=!1,s){const r=this,n=GSAttr.getAsBool(t,"selected");if(e||GSDOM_GSDOM.queryAll(r,"tr").forEach((t=>{GSAttr.set(t,"class",null),GSAttr.set(t,"selected",null)})),"true"===t.dataset.ignore)return;GSAttr.set(t,"class",n?null:r.cssSelect),GSAttr.set(t,"selected",!n||null);const i=[];GSDOM_GSDOM.queryAll(r,"tr[selected=true]").forEach((t=>i.push(parseInt(t.dataset.index)))),GSEvent.send(r,"select",{data:i,evt:s},!0)}}class GSTable extends GSElement{static#vn=["GS-HEADER","GS-STORE"];#yn=!0;#An=!1;#Dn=[];#Yr=[];#Mn=[];#f=null;#En={css:"table","css-header":"table thead","css-row":"table tbody tr","css-cell":"table tbody td"};#On="bg-dark text-light fw-bold";#wn="table table-hover table-striped user-select-none m-0";#Cn="user-select-none table-light";#Tn="";#xn="col";static{customElements.define("gs-table",GSTable),Object.seal(GSTable)}static get observedAttributes(){return GSElement.observeAttributes(["src","select","multiselect","css","css-header","css-filter","css-columns","css-row","css-cell","css-select"])}constructor(){super(),this.#Ln()}#Ln(){const t=this;let e=Array.from(t.children).filter((t=>t.slot&&"extra"!==t.slot));if(e.length>0)throw new Error(`Custom element injection must contain slot="extra" attribute! Element: ${t.tagName}, ID: ${t.id}`);e=Array.from(t.childNodes).filter((t=>!t.slot));if(!GSDOM_GSDOM.isAllowed(e,GSTable.#vn))throw new Error(GSDOM_GSDOM.toValidationError(t,GSTable.#vn))}attributeCallback(t="",e="",s=""){this.#kn(this.#En[t],s)}disconnectedCallback(){const t=this;t.#Dn=[],t.#Yr=[],t.#Mn=[],t.#f=null,super.disconnectedCallback()}async onReady(){const t=this;if(!t.store){const e=GSAttr.get("data");t.#f=await GSComponents_GSComponents.waitFor(e)}super.onReady(),t.contextMenu&&(t.contextMenu.disabled=!0),t.attachEvent(t.self,"sort",(e=>t.#$n(e.detail))),t.attachEvent(t.self,"filter",(e=>t.#_n(e.detail))),t.attachEvent(t.self,"select",(e=>t.#bn(e.detail))),t.attachEvent(t.self,"action",(e=>t.#Fn(e))),t.attachEvent(t,"data",(e=>t.#In(e))),t.store.page=1}get contextMenu(){return this.querySelector("gs-context")}get store(){const t=this;if(t.#f)return t.#f;if(t.#f=t.querySelector("gs-store"),!t.#f){const e=GSAttr.get("data");t.#f=GSDOM_GSDOM.query(`gs-data#${e}`)}return t.#f}get header(){return this.querySelector("gs-header")}get selected(){return this.#Mn}get multiselect(){return this.#An}set multiselect(t=!1){this.#An=GSUtil.asBool(t)}get select(){return this.#yn}set select(t=!0){this.#yn=GSUtil.asBool(t)}get css(){return GSAttr.get(this,"css",this.#wn)}get cssSelect(){return GSAttr.get(this,"css-select",this.#On)}get cssHeader(){return GSAttr.get(this,"css-header",this.#Cn)}get cssRow(){return GSAttr.get(this,"css-row",this.#Tn)}get cssCell(){return GSAttr.get(this,"css-cell",this.#xn)}get cssFilter(){return GSAttr.get(this,"css-filter","")}get cssColumns(){return GSAttr.get(this,"css-columns","")}set css(t=""){GSAttr.set(this,"css",t)}set cssSelect(t=""){GSAttr.set(this,"css-select",t)}set cssHeader(t=""){GSAttr.set(this,"css-header",t)}set cssFilter(t=""){GSAttr.set(this,"css-filter",t)}set cssColumns(t=""){GSAttr.set(this,"css-columns",t)}set cssRow(t=""){GSAttr.set(this,"css-row",t)}set cssCell(t=""){GSAttr.set(this,"css-cell",t)}get noDataText(){return GSAttr.get(this,"no-data","No Data")}set noDataText(t){return GSAttr.set(this,"no-data",t)}#kn(t,e){t&&this.findAll(t,!0).forEach((t=>{GSAttr.set(t,"class",e)}))}#In(t){t.preventDefault();const e=this;e.self&&(e.#Nn(t.detail),setTimeout((()=>GSEvent.send(e.self,"data",t.detail)),10))}#Nn(t){const e=this;if(e.#Yr=t,e.#Mn=[],!e.#Rn)return e.#jn(),e.#Hn(),requestAnimationFrame((()=>e.#Nn(t)));requestAnimationFrame((()=>e.#Un()))}get#Rn(){return this.#Dn.length>0}#jn(){const t=this,e=t.header;t.#Dn=e?e.toJSON():[],t.#Dn.length>0||0!==t.#Yr.length&&t.#Pn(t.#Yr[0])}#Pn(t){const e=[];e.push("<gs-header>"),Array.isArray(t)?(e.push('<gs-column name="#"></gs-column>'),t.forEach(((t,s)=>{const r=`<gs-column name="Col_${s+1}" index=${s}></gs-column>`;e.push(r)}))):Object.keys(t).forEach((t=>{const s=`<gs-column name="${t}"></gs-column>`;e.push(s)})),e.push("</gs-header>");const s=GSDOM_GSDOM.parse(e.join(""),!0);this.appendChild(s)}#Un(){const t=this;t.self.querySelector("tbody").render(t.#Dn,t.#Yr,t.store.offset);const e=t.contextMenu;e&&(e.close(),e.reattach())}#Hn(){const t=this;if(!t.#Rn)return;const e=t.querySelector("gs-header").render(),s=`<table class="${t.css}">${e}<tbody is="gs-tbody"></tbody></table><slot name="extra"></slot>`;GSDOM_GSDOM.setHTML(t.self,s)}#Fn(t){const e=t.detail;e.action=e.data.action,e.data=[...this.#Mn],e.type="table"}#bn(t){const e=this;e.#Mn=[],t.data?.forEach((t=>{const s=e.#Yr[t];s&&e.#Mn.push(s)})),e.contextMenu&&(e.contextMenu.disabled=0===t.data?.length),GSEvent.send(e,"selected",{data:e.#Mn,evt:t.evt})}#$n(t){const e=this;e.store.sort=t||[],GSEvent.send(e,"sort",e.store.sort)}#_n(t){const e=this;e.store.filter=t||[],GSEvent.send(e,"filter",e.store.filter)}}class GSTableSort extends HTMLTableRowElement{#Bn=0;static{customElements.define("gs-tablesort",GSTableSort,{extends:"tr"}),Object.seal(GSTableSort)}connectedCallback(){const t=this;t.id||t.setAttribute("id",GSID.id),GSEvent.attach(t,t,"click",(e=>t.#et(e))),GSComponents.store(t)}disconnectedCallback(){GSComponents.remove(this),GSEvent.deattachListeners(this)}#et(t){const e=this,s=t.composedPath().shift();"TH"===s.tagName&&s.classList.contains("sorting")&&requestAnimationFrame((()=>e.#$n(s,t.shiftKey)))}#$n(t,e=!1){const s=this;let r=GSAttr.getAsNum(t,"order",-1);r=r>0?-1:1,e?(s.#Bn=GSAttr.getAsNum(t,"idx",s.#Bn+1),GSDOM_GSDOM.toggleClass(t,!1,"sorting_desc sorting_asc table-active")):(s.#Bn=1,GSDOM_GSDOM.queryAll(s,"thead th").forEach((t=>{GSAttr.set(t,"idx",null),GSAttr.set(t,"order",null),GSDOM_GSDOM.toggleClass(t,!1,"sorting_desc sorting_asc table-active")}))),t.classList.add(r>0?"sorting_asc":"sorting_desc"),GSAttr.set(t,"idx",s.#Bn),GSAttr.set(t,"order",r),GSDOM_GSDOM.toggleClass(t,!0,"table-active");let n=[];GSDOM_GSDOM.queryAll(s,".sorting_asc, .sorting_desc").forEach((t=>{const e=GSAttr.getAsNum(t,"order",1),s=GSAttr.getAsNum(t,"idx",1),r=GSAttr.get(t,"name",t.innerText),i={ord:e,col:t.cellIndex,name:r,idx:s};n.push(i)})),n=GSData.sortData([{name:"idx",ord:1}],n),GSEvent.send(s,"sort",n,!0)}}class GSTableFilter extends HTMLTableRowElement{#qn=!1;static{customElements.define("gs-tablefilter",GSTableFilter,{extends:"tr"}),Object.seal(GSTableFilter)}connectedCallback(){const t=this;t.id=t.id||GSID.id,t.#qn=null!=GSDOM_GSDOM.query(t,'input[auto="true"],select[auto="true"]'),t.#Vn(),t.#zn(),GSComponents.store(t),requestAnimationFrame((()=>t.#Ur()))}disconnectedCallback(){GSComponents.remove(this),GSEvent.deattachListeners(this)}get root(){return GSDOM_GSDOM.getRoot(this)}#Vn(){const t=this;GSDOM_GSDOM.queryAll(t,"input, select").forEach((e=>GSEvent.attach(t,e,"change",(e=>t.#Ur(e.target)))))}#zn(){const t=this;t.#qn&&GSEvent.attach(t,t.root,"data",(e=>t.#In(e.detail)),!1,!0)}#Ur(t){const e=this,s=[];GSDOM_GSDOM.queryAll(e,"input, select").forEach((t=>{const r=e.#Wn(t);r&&s.push({name:t.name,value:r})})),GSEvent.send(e,"filter",s,!0)}#In(t){}#Wn(t){const e=GSAttr.get(t,"list"),s=this.root.getElementById(e)?.querySelector(`option[value="${t.value}"]`);return s?.dataset?.value||t.value}}class GSPagination extends GSElement{static CSS_ITEM="me-1";static{customElements.define("gs-pager",GSPagination),Object.seal(GSPagination)}constructor(){super()}async getTemplate(t=""){const e=this,s=e.store,r=e.firstlast,n=e.nextprev,i=this.pages,a=[];a.push('<nav><ul class="pagination justify-content-center m-3">'),r&&a.push(e.#Yn(e.first,"first","First page")),n&&a.push(e.#Yn(e.previous,"previous","Previous page"));let o=1;for(;o<=i;)a.push(e.#Yn(o,"","",o==s.page)),o++;return n&&a.push(e.#Yn(e.next,"next","Next page")),r&&a.push(e.#Yn(e.last,"last","Last page")),a.push("</ul></nav>"),a.join("")}#Yn(t="",e="",s="",r=!1){return`<li class="page-item ${GSPagination.CSS_ITEM} ${r?"active":""}"><a class="page-link" name="${e}" title="${s}" href="#" >${t}</a></li>`}#Jn(t){const e=this;requestAnimationFrame((()=>{let t=Math.floor((e.store.page-1)/e.pages)*e.pages+1;e.queryAll('a[name=""]').forEach((s=>{s.parentElement.classList.remove("active","disabled","d-none"),t==e.store.page&&s.parentElement.classList.add("active"),t>e.store.pages&&s.parentElement.classList.add("disabled","d-none"),s.text=t++}))}))}#et(t){const e=this,s=t.target.name||t.target.text;switch(s){case"first":return e.store.firstPage();case"last":return e.store.lastPage();case"next":return e.store.nextPage();case"previous":return e.store.prevPage()}e.store.page=s||e.store.page}onReady(){const t=this;t.attachEvent(t.store,"data",t.#Jn.bind(t)),t.queryAll("a").forEach((e=>t.attachEvent(e,"click",t.#et.bind(t))))}get table(){return GSDOM_GSDOM.closest(this,"GS-TABLE")}get store(){const t=GSAttr.get(this,"store");return t?GSComponents_GSComponents.get(t):this.table.store}get nextprev(){return GSAttr.getAsBool(this,"nextprev",!0)}get firstlast(){return GSAttr.getAsBool(this,"firstlast",!0)}get pages(){return GSAttr.getAsNum(this,"pages",5)}get first(){return GSAttr.get(this,"first","&laquo;")}get last(){return GSAttr.get(this,"last","&raquo;")}get next(){return GSAttr.get(this,"next","&rsaquo;")}get previous(){return GSAttr.get(this,"previous","&lsaquo;")}}class GSNotification extends GSElement{static TOP_START="position-fixed top-0 start-0";static TOP_CENTER="position-fixed top-0 start-50 translate-middle-x";static TOP_END="position-fixed top-0 end-0";static MIDDLE_START="position-fixed top-50 start-0 translate-middle-y";static MIDDLE_CENTER="position-fixed top-50 start-50 translate-middle";static MIDDLE_END="position-fixed top-50 end-0 translate-middle-y";static BOTTOM_START="position-fixed bottom-0 start-0";static BOTTOM_CENTER="position-fixed bottom-0 start-50 translate-middle-x";static BOTTOM_END="position-fixed bottom-0 end-0";static DEFAULT=GSNotification.BOTTOM_END;#Pt=new Set;static get observedAttributes(){return GSElement.observeAttributes(["position"])}connectCallback(){super.connectedCallback()}attributeCallback(t="",e="",s=""){const r=this;e=r.#Kn(e),s=r.#Kn(s);const n=r.query("div");GSDOM_GSDOM.toggleClass(n,!1,e),GSDOM_GSDOM.toggleClass(n,!0,s)}#Kn(t){let e=GSNotification[t];return GSUtil.isString(e)&&e.startsWith("position-")?e:t}async getTemplate(t=""){return`<div class="toast-container ${this.css} ${this.position}" style="z-index: 10000;">\n    <slot name="content"></slot>\n    </div>`}get css(){return GSAttr.get(this,"css","p-3")}set css(t=""){GSAttr.set(this,"css",t)}get position(){return GSAttr.get(this,"position",GSNotification.DEFAULT)}set position(t=""){GSAttr.set(this,"position",t)}get native(){return GSAttr.getAsBool(this,"native",!1)}set native(t=""){GSAttr.setAsBool(this,"native",t)}info(t="",e="",s=!1,r=2){return this.show(t,e,"text-bg-info",s,r)}success(t="",e="",s=!1,r=2){return this.show(t,e,"text-bg-success",s,r)}warn(t="",e="",s=!1,r=2){return this.show(t,e,"text-bg-warning",s,r)}danger(t="",e="",s=!1,r=2){return this.show(t,e,"text-bg-danger",s,r)}primary(t="",e="",s=!1,r=2){return this.show(t,e,"text-bg-primary",s,r)}secondary(t="",e="",s=!1,r=2){return this.show(t,e,"text-bg-secondary",s,r)}dark(t="",e="",s=!1,r=2){return this.show(t,e,"text-bg-dark",s,r)}light(t="",e="",s=!1,r=2){return this.show(t,e,"text-bg-light",s,r)}async show(t="",e="",s="",r=!1,n=2,i){const a=this;if(a.native){let s=await GSNotification.requestPermission();if(s&&(s=a.#Xn(t,e,n,i)),s)return s}return a.#Zn(t,e,s,r,n)}#Zn(t="",e="",s="",r=!1,n=2){const i=`<gs-toast slot="content" css="${s}"  closable="${r}" timeout="${n}" message="${e}" title="${t}"></gs-toast>`,a=GSDOM_GSDOM.parse(i,!0);return this.appendChild(a),a}#Xn(t="",e="",s=2,r={}){const n=this;r.body=r.body||e;const i=new Notification(t,r);n.#Pt.add(i);const a=n.#Qn.bind({notification:i,owner:n});return i.addEventListener("close",a),s>0&&setTimeout(a,1e3*s),i}#Qn(){const t=this;t.notification.close(),t.owner.#Pt.delete(t.notification)}clear(){const t=this;Array.from(t.querySelectorAll("gs-toast")).forEach((t=>t.remove())),t.#Pt.forEach((t=>t.close())),t.#Pt.clear()}static get isNativeSupported(){return"Notification"in self}static get isGranted(){return"granted"===Notification.permission}static async requestPermission(){return!!GSNotification.isNativeSupported&&(GSNotification.isGranted||await Notification.requestPermission(),GSNotification.isGranted)}static{customElements.define("gs-notification",GSNotification),Object.seal(GSNotification)}}class GSToast extends GSElement{static{customElements.define("gs-toast",GSToast),Object.seal(GSToast)}static get observedAttributes(){return GSElement.observeAttributes(["placement","css"])}attributeCallback(t="",e="",s=""){if("css"===t){const t=this.query(".toast");GSDOM_GSDOM.toggleClass(t,!1,e),GSDOM_GSDOM.toggleClass(t,!0,s)}}async getTemplate(t=""){const e=this,s=e.closable?'<button type="button" class="btn-close me-2 m-auto"></button>':"";return`\n        <div class="mt-1 mb-1 toast fade ${e.visible?"show":""} ${e.css}">\n          <div class="d-flex">\n              <div class="toast-body">\n              ${e.message}\n              </div>\n              ${s}\n          </div>\n      </div>    \n    `}onReady(){const t=this,e=t.queryAll("button");Array.from(e).forEach((e=>t.attachEvent(e,"click",t.close.bind(t)))),super.onReady(),t.visible&&t.open()}show(t="",e="",s="",r=!0,n=!1,i=2){const a=this;a.css=s||a.css,a.title=t,a.message=e,a.timeout=i,a.closable=1==n,a.visible=1==r,a.open()}open(){const t=this;requestAnimationFrame((async()=>{GSDOM_GSDOM.toggleClass(this.#ti,!0,"show"),t.timeout<=0||(await GSUtil.timeout(1e3*t.timeout),t.close())}))}close(){this.#Ee()}dismiss(){this.#Ee()}async#Ee(){return GSDOM_GSDOM.toggleClass(this.#ti,!1,"show"),await GSUtil.timeout(GSDOM_GSDOM.SPEED),this.remove()}get#ti(){return this.query(".toast")}get isFlat(){return!0}get title(){return GSAttr.get(this,"title")}set title(t=""){GSAttr.set(this,"title",t)}get message(){return GSAttr.get(this,"message")}set message(t=""){GSAttr.set(this,"message",t)}get css(){return GSAttr.get(this,"css")}set css(t=""){GSAttr.set(this,"css",t)}get timeout(){return GSAttr.getAsNum(this,"timeout",2)}set timeout(t=2){GSAttr.set(this,"timeout",t)}get closable(){return GSAttr.getAsBool(this,"closable")}set closable(t=!0){GSAttr.set(this,"closable",1==t)}get visible(){return GSAttr.getAsBool(this,"visible",!0)}set visible(t=!0){GSAttr.set(this,"visible",1==t)}}class GSSearch extends GSElement{static{customElements.define("gs-search",GSSearch),Object.seal(GSSearch)}async getTemplate(){const t=this;return`\n        <div class="input-group ${t.css}">\n            <i class="input-group-text ${t.iconCSS}"></i>\n            <input type="search"  incremental="true" class="form-control ${t.inputCSS}" placeholder="${t.placeholder}" name="${t.name}">\n        </div>        \n        `}onReady(){const t=this;GSEnvironment.isWebkit?t.attachEvent(t.#ei,"search",t.#si.bind(t)):t.attachEvent(t.#ei,"keydown",t.#si.bind(t)),super.onReady()}#si(t){if(!GSEnvironment.isWebkit&&13!=t.which)return;GSEvent.prevent(t);const e={type:"search",action:"search",value:this.#ei.value};GSEvent.send(this,"action",e,!0,!0,!0)}get#ei(){return this.query("input")}get css(){return GSAttr.get(this,"css","")}set css(t=""){return GSAttr.set(this,"css",t)}get iconCSS(){return GSAttr.get(this,"css-icon","bg-white bi bi-search")}set iconCSS(t=""){return GSAttr.set(this,"css-icon",t)}get inputCSS(){return GSAttr.get(this,"css-input","border-start-0")}set inputCSS(t=""){return GSAttr.set(this,"css-input",t)}get placeholder(){return GSAttr.get(this,"placeholder","search")}set placeholder(t=""){return GSAttr.set(this,"placeholder",t)}get name(){return GSAttr.get(this,"name","search")}set name(t=""){return GSAttr.set(this,"name",t)}}class BaseViewUI extends GSElement{constructor(){super(),this.className="d-flex flex-fill"}onReady(){const t=this;super.onReady(),t.attachEvent(t,"action",t.#J.bind(t)),t.attachEvent(t.table,"filter",(e=>t.refresh())),requestAnimationFrame((()=>t.refresh()))}get recID(){return"id"}get filter(){const t=this.table?.store.filter||[],e={};return t.forEach((t=>e[t.name]=t.value)),e}get store(){return this.table?.store}get table(){return this.query("#table-main")}get#ri(){return GSDOM_GSDOM.query(document.body,"#form-main")}get modal(){return this.query("#modal-main")}get notify(){return GSComponents.get("notification")}inform(t=!1,e){return t?this.notify.info("Info",e):(this.notify.danger("Error",e),t)}#J(t){const e=t.detail.action;GSFunction.isFunction(this[e])&&this[e](t)}async export(){const t=this.tagName.toLowerCase(),e=this.store.data;GSUtil.export([JSON.stringify(e)],`${t}.json`)}async clone(t){const e=this,s=t.detail.data.pop();if(!s)return;const r=Object.assign({},s);r.name=`${s.name} - ${Date.now()}`;try{if(!await e.onCreate(r))throw new Error("Record not cloned!");e.store.setData(r,!0),e.notify.secondary("","Record cloned!")}catch(t){console.log(t),e.notify.danger("",t.message||t.toString())}}async remove(t){const e=this,s=t.detail.data.pop();if(s)try{if(!await e.onRemove(s))throw new Error("Record not removed!");const t=e.store.data.filter((t=>t[e.recID]!==s[e.recID]));e.store.setData(t),e.notify.danger("","Record removed!")}catch(t){console.log(t),e.notify.danger("",t.message||t.toString())}}async details(t){const e=this,s=t.detail.data.pop();if(!s)return!1;e.#ri?.reset(),GSDOM_GSDOM.fromObject(e.#ri,s),e.modal.open();const r=await e.modal.waitEvent("data");try{if(!await e.onUpdate(r.data))throw new Error("Record not updated!");Object.assign(s,r.data),e.store.reload(),e.notify.warn("","Record updated!")}catch(t){console.log(t),e.notify.danger("",t.message||t.toString())}return s}async create(t){const e=this;e.#ri?.reset(),e.modal.open();const s=await e.modal.waitEvent("data");try{if(!await e.onCreate(s.data))throw new Error("Record not created!");e.store.data.push(s.data),e.store.reload(),e.notify.primary("","Record created!")}catch(t){console.log(t),e.notify.danger("",t.message||t.toString())}}async refresh(t){const e=this,s=await e.onLoad(t);e.store&&requestAnimationFrame((()=>{e.store.clear(),s?(e.store.setData(s),e.store.firstPage()):e.store.reload()}))}search(t){this.store.filter=t.detail.value}async onCreate(t){return!0}async onUpdate(t){return!0}async onRemove(t){return!0}async onLoad(t){return!1}}class GSConfiguration extends BaseViewUI{static{customElements.define("gs-admin-view-configuration",GSConfiguration),Object.seal(GSConfiguration)}get waiter(){GSDOM_GSDOM.query(document.body,"#modal-wait")}get modalValidation(){this.query("#modal-validation")}async getTemplate(){return super.getTemplate("//views/configurations.html")}async onLoad(t){const e=await io.greenscreens.Hosts.list(!0===t?.detail.source?.shiftKey);return e.success?e.data:this.inform(e.success,e.msg)}async#ni(t,e){const s=await io.greenscreens.Hosts.setHost(t);this.inform(s.success,s.success?e:s.msg),s.success&&this.refresh()}async onCreate(t){return this.#ni(t,"Data created!")}async onUpdate(t){return this.#ni(t,"Data updated!")}async onRemove(t){const e=await io.greenscreens.Hosts.unsetHost(t);this.inform(e.success,e.success?"Data removed!":e.msg),e.success&&this.refresh()}resetPrinter(t){const e=t.detail.data[0];GSDOM_GSDOM.query(this,"#printer-reset").open(e)}setupPrinter(t){const e=t.detail.data[0];GSDOM_GSDOM.query(this,"#printer-setup").open(e)}async validateServer(t){const e=t.detail.data[0],s=this;s.waiter.open();try{const t=await io.greenscreens.Hosts.validate(e);if(e.controller=obj.data.controller,!t.success)return s.inform(t.success,t.msg)}finally{s.waiter.close()}s.modalValidation.body="<pre>&{o.msg}</pre>",s.modalValidation.open()}}class GSTunnel extends BaseViewUI{static{customElements.define("gs-admin-view-tunnel",GSTunnel),Object.seal(GSTunnel)}async getTemplate(){return super.getTemplate("//views/tunnel.html")}async onLoad(){const t=this,e=t.filter,s=await io.greenscreens.Proxy.list(t.store.page-1,t.store.limit,e);return s.success?s.data:t.inform(s.success,s.msg)}async#ni(t,e){const s=this;if(Tn5250.opt.jvm<16&&"true"==t.unix)return void s.inform(!1,"AF_UNIX not available in JVM < 16");const r=await io.greenscreens.Proxy.save(t);s.inform(r.success,r.success?e:r.msg),r.success&&s.refresh()}async onCreate(t){return this.#ni(t,"Data created!")}async onUpdate(t){return this.#ni(t,"Data updated!")}async onRemove(t){const e=await io.greenscreens.Proxy.remove(t.id);this.inform(e.success,e.success?"Data removed!":e.msg),e.success&&this.refresh()}async start(t){const e=t.detail.data[0],s=await io.greenscreens.Proxy.start(e.id);this.inform(s.success,s.success?"Tunnel started!":s.msg),s.success&&this.refresh()}async stop(t){const e=t.detail.data[0],s=await io.greenscreens.Proxy.stop(e.id);this.inform(s.success,s.success?"Tunnel stopped!":s.msg),s.success&&this.refresh()}async restart(t){const e=t.detail.data[0],s=await io.greenscreens.Proxy.restart(e.id);this.inform(s.success,s.success?"Tunnel restarted!":s.msg),s.success&&this.refresh()}async download(t){const e=t.detail.data[0],s=await io.greenscreens.Proxy.download(e.id);if(!s.success)return this.inform(s.success,s.msg);const r=["auto: true","mode: cloud","cloud: "+location.origin,"token: "+s.data.code,"tls: 1","tlsVerify: true"];Utils.download(e.name+".bin",Utils.fromHex(s.data.msg)),Utils.download("server.config",r.join("\n"))}}class GSCustomization extends BaseViewUI{static{customElements.define("gs-admin-view-customization",GSCustomization),Object.seal(GSCustomization)}async getTemplate(){return super.getTemplate("//views/customizations.html")}async onLoad(){const t=this,e=await io.greenscreens.Scripts.getScripts();if(!e.success)return t.inform(e.success,e.msg);t.header.value=e.data.header,t.footer.value=e.data.footer,t.ui.value=e.data.ui}async save(){console.log("==> Save changes")}get header(){return this.query("#header")}get footer(){return this.query("#footer")}get ui(){return this.query("#ui")}}class GSFilterFido extends BaseViewUI{static{customElements.define("gs-admin-view-filterfido",GSFilterFido),Object.seal(GSFilterFido)}async getTemplate(){return super.getTemplate("//views/filter-fido.html")}get filterSwitch(){return this.query('select[name="filter"]')}onReady(){super.onReady();const t=this;t.modal.large(),t.#ii(),GSEvent.attach(t,t.filterSwitch,"change",t.#ai.bind(t))}async onLoad(){const t=this,e=t.filter,s=await io.greenscreens.Fido.list(t.store.page-1,t.store.limit,e);return s.success?s.data:t.inform(s.success,s.msg)}async#ii(){const t=await io.greenscreens.Fido.isActive();t.success||this.inform(t.success,t.msg),this.filterSwitch.val=t.code}async#ai(t){const e=parseInt(t.target.value,10),s=await io.greenscreens.Fido.activity(e);s.success||me.inform(s.success,s.msg)}async#ni(t,e){const s=await io.greenscreens.Fido.set(t);this.inform(s.success,s.success?e:s.msg),s.success&&this.refresh()}async onCreate(t){return this.#ni(t,"Data created!")}async onUpdate(t){return this.#ni(t,"Data updated!")}async onRemove(t){const e=await io.greenscreens.Fido.remove(t.id);this.inform(e.success,e.success?"Data removed!":e.msg),e.success&&this.refresh()}}class GSFilterIP extends BaseViewUI{static{customElements.define("gs-admin-view-filterip",GSFilterIP),Object.seal(GSFilterIP)}get filterSwitch(){return this.query('select[name="filter"]')}onReady(){super.onReady();const t=this;t.modal.large(),t.#ii(),GSEvent.attach(t,t.filterSwitch,"change",t.#ai.bind(t))}async getTemplate(){return super.getTemplate("//views/filter-ip.html")}async onLoad(){const t=this,e=t.filter,s=await io.greenscreens.Filter.list(t.store.page-1,t.store.limit,e);return s.success?s.data:t.inform(s.success,s.msg)}async#ii(){const t=await io.greenscreens.Filter.isActive();t.success||this.inform(t.success,t.msg),this.filterSwitch.val=t.code}async#ai(t){const e=parseInt(t.target.value,10),s=await io.greenscreens.Filter.activity(e);s.success||me.inform(s.success,s.msg)}async#ni(t,e){const s=await io.greenscreens.Filter.set(t);this.inform(s.success,s.success?e:s.msg),s.success&&this.refresh()}async onCreate(t){return this.#ni(t,"Data created!")}async onUpdate(t){return this.#ni(t,"Data updated!")}async onRemove(t){const e=await io.greenscreens.Filter.remove(t.id);this.inform(e.success,e.success?"Data removed!":e.msg),e.success&&this.refresh()}}class GSFilterMobile extends BaseViewUI{static{customElements.define("gs-admin-view-filtermobile",GSFilterMobile),Object.seal(GSFilterMobile)}get filterSwitch(){return this.query('select[name="filter"]')}onReady(){super.onReady();const t=this;t.modal.large(),t.#ii(),GSEvent.attach(t,t.filterSwitch,"change",t.#ai.bind(t))}async getTemplate(){return super.getTemplate("//views/filter-mobile.html")}async onLoad(){const t=this,e=t.filter,s=await io.greenscreens.Mobile.list(t.store.page-1,t.store.limit,e);return s.success?s.data:t.inform(s.success,s.msg)}async#ii(){const t=await io.greenscreens.Mobile.isActive();t.success||this.inform(t.success,t.msg),this.filterSwitch.val=t.code}async#ai(t){const e=parseInt(t.target.value,10),s=await io.greenscreens.Mobile.activity(e);s.success||me.inform(s.success,s.msg)}async#ni(t,e){const s=await io.greenscreens.Mobile.set(t);this.inform(s.success,s.success?e:s.msg),s.success&&this.refresh()}async onCreate(t){return this.#ni(t,"Data created!")}async onUpdate(t){return this.#ni(t,"Data updated!")}async onRemove(t){const e=await io.greenscreens.Mobile.remove(t.id);this.inform(e.success,e.success?"Data removed!":e.msg),e.success&&this.refresh()}}class GSApiKeys extends BaseViewUI{static{customElements.define("gs-admin-view-apikeys",GSApiKeys),Object.seal(GSApiKeys)}onReady(){super.onReady(),this.modal.large()}async getTemplate(){return super.getTemplate("//views/keys-api.html")}async onLoad(){const t=this,e=t.filter,s=await io.greenscreens.ApiKeys.list(t.store.page-1,t.store.limit,e);return s.success?s.data:t.inform(s.success,s.msg)}async onCreate(t){const e=await io.greenscreens.ApiKeys.add(t);this.inform(e.success,e.success?"Data created!":e.msg),e.success&&this.refresh()}async onUpdate(t){const e=await io.greenscreens.ApiKeys.update(t);this.inform(e.success,e.success?"Data updated!":e.msg),e.success&&this.refresh()}async onRemove(t){const e=await io.greenscreens.ApiKeys.remove(t.id);this.inform(e.success,e.success?"Data removed!":e.msg),e.success&&this.refresh()}async toggle(t){const e=t.detail.data[0];e.active=!("true"==e.active);const s=await io.greenscreens.ApiKeys.update(e.id,e);this.inform(s.success,s.success?"Status changed!":s.msg),s.success&&this.refresh()}}class GSOtp extends BaseViewUI{static{customElements.define("gs-admin-view-otp",GSOtp),Object.seal(GSOtp)}onReady(){super.onReady(),this.modal.large()}async getTemplate(){return super.getTemplate("//views/keys-otp.html")}async onLoad(){const t=this,e=t.filter,s=await io.greenscreens.OAuth.list(t.store.page-1,t.store.limit,e);return s.success?s.data:t.inform(s.success,s.msg)}async onUpdate(t){return this.toggle(t)}async onRemove(t){const e=await io.greenscreens.OAuth.remove(t.id);this.inform(e.success,e.success?"Data removed!":e.msg),e.success&&this.refresh()}async toggle(t){t.active=!("true"==t.active);const e=await io.greenscreens.OAuth.update(t.id,t.active);this.inform(e.success,e.success?"Status changed!":e.msg),e.success&&this.refresh()}}class GSBiometrics extends BaseViewUI{static{customElements.define("gs-admin-view-biometrics",GSBiometrics),Object.seal(GSBiometrics)}async getTemplate(){return super.getTemplate("//views/keys-bio.html")}async onLoad(){const t=this,e=t.filter,s=await io.greenscreens.WebAuth.list(t.store.page-1,t.store.limit,e);return s.success?s.data:t.inform(s.success,s.msg)}async onRemove(t){const e=await io.greenscreens.WebAuth.remove(t);this.inform(e.success,e.success?"Data removed!":e.msg),e.success&&this.refresh()}}class GSPrinting extends BaseViewUI{static{customElements.define("gs-admin-view-printing",GSPrinting),Object.seal(GSPrinting)}async getTemplate(){return super.getTemplate("//views/printing.html")}async onLoad(){const t=this,e=t.filter,s=await io.greenscreens.Printers.list(t.store.page-1,t.store.limit,e);return s.success?s.data:t.inform(s.success,s.msg)}#oi(t){return t.uuid=t.uuid.toUpperCase(),t.host=t.host.toUpperCase(),t.outq=(t.outq||"").toUpperCase(),t.library=(t.library||"").toUpperCase(),t.userName=(t.userName||"").toUpperCase(),t.spoolName=(t.spoolName||"").toUpperCase(),t}async#ni(t,e){const s=this;t=s.#oi(t);const r=await io.greenscreens.Printers.set(t);s.inform(r.success,r.success?e:r.msg),r.success&&s.refresh()}async onCreate(t){return this.#ni(t,"Data created!")}async onUpdate(t){return this.#ni(t,"Data updated!")}async onRemove(t){const e=await io.greenscreens.Printers.remove(t.id);this.inform(e.success,e.success?"Data removed!":e.msg),e.success&&this.refresh()}}class GSScheduler extends BaseViewUI{static{customElements.define("gs-admin-view-scheduler",GSScheduler),Object.seal(GSScheduler)}async getTemplate(){return super.getTemplate("//views/schedulers.html")}async onLoad(){const t=this,e=t.filter;e.type="-1"==e.type?null:parseInt(e.type)||null,e.status=parseInt(e.status)||0;const s=await io.greenscreens.Scheduler.list(t.store.page-1,t.store.limit,e.type,e.status);return s.success?s.data:t.inform(s.success,s.msg)}async#ni(t,e){const s=await io.greenscreens.Scheduler.save(t);this.inform(s.success,s.success?e:s.msg),s.success&&this.refresh()}async onCreate(t){return this.#ni(t,"Data created!")}async onUpdate(t){return this.#ni(t,"Data updated!")}async onRemove(t){const e=await io.greenscreens.Scheduler.remove(t.id);this.inform(e.success,e.success?"Data removed!":e.msg),e.success&&this.refresh()}async run(t){const e=t.detail.data[0],s=await io.greenscreens.Scheduler.runNow(e.id);this.inform(s.success,s.success?"Task started!":s.msg)}}class GSUsers extends BaseViewUI{static{customElements.define("gs-admin-view-users",GSUsers),Object.seal(GSUsers)}get waiter(){GSDOM_GSDOM.query(document.body,"#modal-wait")}async getTemplate(){return super.getTemplate("//views/users.html")}async onLoad(){const t=this,e=t.filter,s=await io.greenscreens.Users.list(t.store.page-1,t.store.limit,e);return s.success?s.data:t.inform(s.success,s.msg)}#oi(t){return t.confid=parseInt(t.confid||0),t.devtype=parseInt(t.devtype||0),t.driver=parseInt(t.driver||0),t.drawer1=parseInt(t.drawer1||-1),t.drawer2=parseInt(t.drawer2||-1),t.enhanced=parseInt(t.enhanced||0),t.uuid=(t.uuid||"").toUpperCase(),t.host=(t.host||"").toUpperCase(),t.user=(t.user||"").toUpperCase(),t.display=(t.display||"").toUpperCase(),t.outq=(t.outq||"").toUpperCase(),t.program=(t.program||"").toUpperCase(),t.printer=t.printer||"Default",t}async#ni(t,e){const s=this;t=s.#oi(t);const r=await io.greenscreens.Users.save(t);s.inform(r.success,r.success?e:r.msg),r.success&&s.refresh()}async onCreate(t){return this.#ni(t,"Data created!")}async onUpdate(t){return this.#ni(t,"Data updated!")}async onRemove(t){const e=await io.greenscreens.Users.remove(t.id);this.inform(e.success,e.success?"Data removed!":e.msg),e.success&&this.refresh()}async resync(){const t=await io.greenscreens.Users.commit();this.inform(t.success,t.success?"Data resync started!":t.msg)}async commit(){const t=this;t.waiter.open();try{const e=await io.greenscreens.Users.commit();t.inform(e.success,e.success?"Data commited to server!":e.msg)}finally{t.waiter.close()}}}class GSWorkstations extends BaseViewUI{static{customElements.define("gs-admin-view-services",GSWorkstations),Object.seal(GSWorkstations)}async getTemplate(){return super.getTemplate("//views/services.html")}async onLoad(){const t=await io.greenscreens.Tweaks.list();return t.success?t.data:this.inform(t.success,t.msg)}async onUpdate(t){const e=this;e.modal.convert(t);const s=await io.greenscreens.Tweaks.set(t.module,t.property,t.value);if(!s.success)return e.inform(s.success,s.msg);e.refresh()}async details(t){const e=t.detail.data[0];return this.modal.updateValue(e.value),super.details(t)}}class GSWorkstations_GSWorkstations extends BaseViewUI{#ci=[];static{customElements.define("gs-admin-view-workstations",GSWorkstations_GSWorkstations),Object.seal(GSWorkstations_GSWorkstations)}async getTemplate(){return super.getTemplate("//views/workstations.html")}onReady(){super.onReady();const t=this;t.table.on("selected",t.#li.bind(t))}async onLoad(){const t=this,e=t.filter,s=await io.greenscreens.Manage.listSessions(t.store.page-1,t.store.limit,e);return s.success?s.data:t.inform(s.success,s.msg)}async messageByFilter(t){const e=prompt("Enter message to send");if(!(e?.trim().length>0))return;const s=this.filter;s.message=e;const r=io.greenscreens.Manage.sendMessage(s);this.inform(r.success,r.success?"Message sent":` Error sending message: "${r.msg}"`)}async killByFilter(t){const e=this,s=e.filter,r=await io.greenscreens.Manage.killSessions(s);return e.inform(r.success,r.success?"Devices killed!":r.msg),r.success&&e.refresh(),!0}async message(t){const e=t.detail.data[0],s=prompt("Enter message to send");if(!(s?.trim().length>0))return;e.message=s;const r=io.greenscreens.Manage.sendMessage(e.sessionID,e.deviceID,s);this.inform(r.success,r.success?"Message sent":` Error sending message: "${r.msg}"`)}async kill(t){const e=t.detail.data[0],s=await io.greenscreens.Manage.killDevice(e);this.inform(s.success,s.success?"Device killed!":s.msg),s.success&&this.refresh()}async logging(t){const e=t.detail.data[0],s=await io.greenscreens.Manage.loging(e);if(!s.success)return this.inform(s.success,s.msg);if("false"===s.msg){const t=location.origin+"/services/logs?id="+s.code;globalThis.open(t)}}#li(t){if(!t.detail.evt?.shiftKey)return;const e=t.detail.data[0];this.onScreen(e)}onScreen(t){const e=this;let s=e.#ci[t?.deviceID];if(s&&!s.closed)return;s=globalThis.open(location.origin+"/terminal/?d=0&k=0","","target=blank,width=800,height=600,scrollbasrs=no,toolbar=no,titlebar=yes"),s.onclose=()=>delete e.terminal[t.deviceID],s.focus();const r=setInterval((()=>{s.Tn5250&&(e.#ci[t.deviceID]=s,s.document.title="Terminal - "+t.uuid+" - "+t.host+" - "+t.display,clearInterval(r),s.Tn5250.Keyboard.listen("command",((r,n,i,a)=>{"PF5"===a&&e.updateScreen(s,t)})),e.updateScreen(s,t))}),1e3)}async updateScreen(t,e){const s=io.greenscreens.Manage.getScreen(e.sessionID,e.deviceID);s.success&&t.Tn5250.Application.test(t.Tn5250.Binary.fromHex(s.msg))}}class GSWebmodules extends BaseViewUI{static{customElements.define("gs-admin-view-webmodules",GSWebmodules),Object.seal(GSWebmodules)}async getTemplate(){return super.getTemplate("//views/modules.html")}async onLoad(){const t=await io.greenscreens.WebModules.list();return t.success?t.data:this.inform(t.success,t.msg)}async start(t){const e=t.detail.data[0],s=await io.greenscreens.WebModules.start(e.name);this.inform(s.success,s.success?"Module started!":s.msg)}async stop(t){const e=t.detail.data[0],s=await io.greenscreens.WebModules.stop(e.name);this.inform(s.success,s.success?"Module stopped!":s.msg)}async restart(t){const e=t.detail.data[0],s=await io.greenscreens.WebModules.restart(e.name);this.inform(s.success,s.success?"Module restarted!":s.msg)}}class GSDialog extends GSModal{constructor(){super();const t=this;t.cssHeader="p-3 dialog-title",t.cssTitle="fs-5 fw-bold",t.cssBody="p-0"}get dialogTemplate(){return""}get dialogTitle(){return""}get autoOpen(){return GSAttr.getAsBool(this,"autoopen",!0)}async onReady(){super.onReady();const t=this;t.on("data",t.#In.bind(t)),t.on("error",t.#ui.bind(t));const e=await GSLoader.getTemplate(t.dialogTemplate);requestAnimationFrame((()=>{GSDOM_GSDOM.setHTML(t,e),t.title=t.dialogTitle,t.autoOpen&&t.open()}))}get waiter(){GSDOM_GSDOM.query(document.body,"#modal-wait")}get notify(){return GSComponents.get("notification")}async loadData(){return null}async onConfirm(t){return!0}inform(t=!1,e){return t?this.notify.info("Info",e):(this.notify.danger("Error",e),t)}#ui(t){this.notify.danger("Error","Some fields are invalid!")}async open(){const t=this,e=await t.loadData();!1!==e&&(super.open(),setTimeout((()=>t.#Z(e)),50))}#Z(t){GSDOM_GSDOM.queryAll(this,"form").forEach((e=>GSDOM_GSDOM.fromObject(e,t)))}async#In(t){GSEvent.prevent(t);const e=this;try{await e.onConfirm(t.detail.data)&&e.close()}catch(t){console.log(t),e.notify.danger("Error",t.message||"Error handling dialog data!")}}}class GSAbout extends GSModal{static#di="6.0.0.";static#hi="15.09.2022. 15:00:00";static{customElements.define("gs-admin-dialog-about",GSAbout),Object.seal(GSAbout)}constructor(){super(),this.align="center"}onReady(){super.onReady();this.confirm(void 0,this.#Ie)}get#Ie(){return`\n        <div slot="body" class="text-center">\n            <div>Version : <span>${GSAbout.#di}</span></div>\n            <div>Build : <span>${GSAbout.#hi}</span></div>\n        </div>\n        `}}class GSCertBlocked extends GSDialog{static{customElements.define("gs-admin-dialog-certblocked",GSCertBlocked),Object.seal(GSCertBlocked)}get dialogTemplate(){return"//dialogs/certificates-blocked.html"}get dialogTitle(){return"Blocked Certificates"}async loadData(){const t=await io.greenscreens.Server.getBlocked();return t.success?{list:t.msg}:this.inform(!1,t.msg)}async onConfirm(t){const e=await io.greenscreens.Server.setBlocked(t.list);return this.inform(e.success,e.success?"Data saved!":e.msg),e.success}}class GSCertClient extends GSDialog{static{customElements.define("gs-admin-dialog-certclient",GSCertClient),Object.seal(GSCertClient)}get dialogTemplate(){return"//dialogs/certificates-client.html"}get dialogTitle(){return"Generate Client Certificates"}async onConfirm(t){const e=await io.greenscreens.Certificate.generateClient(t);if(this.inform(e.success,e.success?"Certificate saved!":e.msg),e.success){const t=Utils.fromHex(e.msg),s=new Uint8Array(t);Utils.download(e.code,s)}return e.success}}class GSCertImport extends GSDialog{static{customElements.define("gs-admin-dialog-certimport",GSCertImport),Object.seal(GSCertImport)}onReady(){super.onReady();this.large()}get dialogTemplate(){return"//dialogs/certificates-import.html"}get dialogTitle(){return"Import Certificates"}async onConfirm(t){const e=await io.greenscreens.Certificate.setFromPEM(t.rootCAPub,t.rootCAPriv,t.serverPub,t.serverPriv,t.rootPass,t.serverPass);return this.inform(e.success,e.success?"Data saved!":e.msg),e.success}}class GSCertOpt extends GSDialog{static{customElements.define("gs-admin-dialog-certopt",GSCertOpt),Object.seal(GSCertOpt)}onReady(){super.onReady(),this.large()}get dialogTemplate(){return"//dialogs/certificates-options.html"}get dialogTitle(){return"Certificate Options"}async loadData(){const t=await io.greenscreens.Certificate.loadConfig();return t.success?(t.data.alternativeNames=t.data.alternativeNames||"",t.data.commonNameServer||(t.data.commonNameServer=location.hostname),t.data.alternativeNames.indexOf(location.hostname)<0&&(t.data.alternativeNames=t.data.alternativeNames+"\n"+location.hostname),t.data):this.inform(!1,t.msg)}async onConfirm(t){const e=await io.greenscreens.Certificate.saveConfig(t);return this.inform(e.success,e.success?"Data saved!":e.msg),e.success}}class GSLoginAdmin extends GSDialog{static{customElements.define("gs-admin-dialog-loginadm",GSLoginAdmin),Object.seal(GSLoginAdmin)}get dialogTemplate(){return"//dialogs/login-admin.html"}get dialogTitle(){return"Admin Login"}async loadData(){const t=await io.greenscreens.Server.getConfig();return t.success?(delete t.data.password,t.data):this.inform(!1,t.msg)}async onConfirm(t){const e=await io.greenscreens.Server.newAuth(t);return this.inform(e.success,e.success?"Data saved!":e.msg),e.success}}class GSLoginDefaults extends GSDialog{static{customElements.define("gs-admin-dialog-logindefs",GSLoginDefaults),Object.seal(GSLoginDefaults)}get dialogTemplate(){return"//dialogs/login-defaults.html"}get dialogTitle(){return"Login Defaults"}async loadData(){const t=await io.greenscreens.Server.getDefaults();return t.success?(delete t.data.password,t.data):this.inform(!1,t.msg)}async onConfirm(t){const e=await io.greenscreens.Server.setDefaults(t);return this.inform(e.success,e.success?"Data saved!":e.msg),e.success}}class GSOtpOptions extends GSDialog{static{customElements.define("gs-admin-dialog-otpopt",GSOtpOptions),Object.seal(GSOtpOptions)}get dialogTemplate(){return"//dialogs/otp-options.html"}get dialogTitle(){return"OTP Options"}async loadData(){const t=await io.greenscreens.Server.getOtp();return t.success?t.data:this.inform(!1,t.msg)}async onConfirm(t){const e=await io.greenscreens.Server.setOtp(t);return this.inform(e.success,e.success?"Data saved!":e.msg),e.success}}class GSRegisterOtp extends GSDialog{static#mi="/barcode/generator?group=Two%20Dimensional&type=QR&composite=&zoom=4&format=png&eci=26&attGS1=0&attQR1=&attQR2=3&b64=";static{customElements.define("gs-admin-dialog-otpreg",GSRegisterOtp),Object.seal(GSRegisterOtp)}onReady(){super.onReady();this.cancelable=!1,this.align="center"}get dialogTemplate(){return"//dialogs/register-otp.html"}get dialogTitle(){return"Admin OTP Access"}get#gi(){return GSDOM_GSDOM.query(this,"#key")}get#Si(){return GSDOM_GSDOM.query(this,"#qrcode")}get#pi(){return GSDOM_GSDOM.query(this,"#qlink")}get#Gi(){return GSDOM_GSDOM.query(this,"#scratchcodes")}async loadData(){const t=this,e=await io.greenscreens.OAuth.register();return e.success?(t.#fi(e.data),t.#bi(e.data),t.#vi(e.data),e.data):t.inform(!1,e.msg)}#fi(t){this.#gi.innerHTML=t.key,this.#Gi.innerHTML=t.scratchCodes?.join("&nbsp;&nbsp;")}async#bi(t){const e=this,s=btoa(t.url),r=`${location.origin}${GSRegisterOtp.#mi}${s}`;e.#Si.src=r,e.#Si.title=r,e.#pi.href=r}async#vi(t){if(!t)return;const e=t.scratchCodes,s=["Green Screens Admin OTP Codes","\n\n","User : ",t.userName,"\n\n","Key : ",t.key,"\n\n","Recovery Keys : "];e.every((function(t){return s.push(t),s.push(" "),!0})),Utils.download("Green_Screens_Admin_OTP.txt",s.join(""))}}class GSNetwork extends GSDialog{static{customElements.define("gs-admin-dialog-network",GSNetwork),Object.seal(GSNetwork)}get dialogTemplate(){return"//dialogs/network.html"}get dialogTitle(){return"Netowrk Options"}async loadData(){const t=await io.greenscreens.Server.getInterface();return t.data.restart=0,t.success?t.data:this.inform(!1,t.msg)}async onConfirm(t){t.restart=1===parseInt(t.restart),t.redirect=1===parseInt(t.redirect),t.nodes=1===parseInt(t.nodes);const e=await io.greenscreens.Server.setInterface(t);return this.inform(e.success,e.success?"Data saved!":e.msg),e.success}}class GSSystem extends GSDialog{static{customElements.define("gs-admin-dialog-system",GSSystem),Object.seal(GSSystem)}onReady(){super.onReady(),this.large()}get dialogTemplate(){return"//dialogs/system.html"}get dialogTitle(){return"System Options"}async loadData(){const t=await io.greenscreens.Server.getConfig();return t.success?(delete t.data.password,t.data):this.inform(!1,t.msg)}async onConfirm(t){const e=await io.greenscreens.Server.setConfig(t);return this.inform(e.success,e.success?"Data saved!":e.msg),e.success}}class GSPrinterReset extends GSDialog{#Yr=null;static{customElements.define("gs-admin-dialog-printer-reset",GSPrinterReset),Object.seal(GSPrinterReset)}get dialogTemplate(){return"//dialogs/printer-reset.html"}get dialogTitle(){return"Printer Reset"}async open(t){this.#Yr={uuid:t.uuid,host:t.name},super.open()}async loadData(){return this.#Yr}async onConfirm(t){t.host=t.name;const e=await io.greenscreens.Printer.reset(t);return this.inform(e.success,e.success?"Printer reset complete!":e.msg.replace(/\n/g,"<br>")),e.success}}class GSPrinterSetup extends GSDialog{#Yr=null;static{customElements.define("gs-admin-dialog-printer-setup",GSPrinterSetup),Object.seal(GSPrinterSetup)}get dialogTemplate(){return"//dialogs/printer-setup.html"}get dialogTitle(){return"Printer Setup"}get hpt(){return GSDOM_GSDOM.query(this,"#hostTransform")}get hptOptions(){return GSDOM_GSDOM.queryAll(this,"input,select").filter((t=>"true"==t.dataset.hpt))}onReady(){super.onReady();const t=this;setTimeout((()=>{t.attachEvent(t.hpt,"change",t.#yi.bind(t))}),1e3)}async open(t){this.#Yr={uuid:t.uuid,host:t.name},super.open()}async loadData(){return this.#Yr}async onConfirm(t){t.host=t.name,t.hostTransform=1===parseInt(t.hostTransform);const e=await io.greenscreens.Printer.setup(t);return this.inform(e.success,e.success?"Printer setup complete!":e.msg.replace(/\n/g,"<br>")),e.success}#yi(t){this.hptOptions.forEach((e=>GSAttr.toggle(e,"disabled","0"==t.target.value)))}}})();
//# sourceMappingURL=io.greenscreens.webadmin.js.map