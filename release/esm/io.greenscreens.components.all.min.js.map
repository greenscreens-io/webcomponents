{"version":3,"file":"io.greenscreens.components.all.min.js","sources":["../../modules/base/GSVersion.mjs","../../modules/base/style.mjs","../../modules/base/GSLog.mjs","../../modules/base/GSUtil.mjs","../../modules/base/GSFunction.mjs","../../modules/base/GSID.mjs","../../modules/base/GSAttr.mjs","../../modules/base/GSCSSMap.mjs","../../modules/base/GSDate.mjs","../../modules/base/GSData.mjs","../../modules/base/GSDOM.mjs","../../modules/base/GSEvents.mjs","../../modules/base/GSAbortController.mjs","../../modules/base/GSDOMObserver.mjs","../../modules/base/GSDynamicStyle.mjs","../../modules/base/GSCacheStyles.mjs","../../modules/base/GSAdoptedEngine.mjs","../../modules/base/GSLoader.mjs","../../modules/base/GSTemplateCache.mjs","../../modules/base/GSAttributeHandler.mjs","../../modules/base/GSBeep.mjs","../../modules/base/GSEnvironment.mjs","../../modules/base/GSPromise.mjs","../../modules/base/GSEvent.mjs","../../modules/base/GSEventBus.mjs","../../modules/base/GSGesture.mjs","../../modules/base/GSItem.mjs","../../modules/base/GSLocalization.mjs","../../modules/base/GSPopper.mjs","../../modules/base/GSQueryCSS.mjs","../../modules/base/GSQuery.mjs","../../modules/base/GSRouter.mjs","../../modules/base/GSTheme.mjs","../../modules/helpers/BinaryTree.mjs","../../modules/helpers/DoublyLinkedList.mjs","../../modules/helpers/LinkedList.mjs","../../modules/helpers/Stack.mjs","../../modules/helpers/Queue.mjs","../../modules/helpers/Tree.mjs","../../modules/data/DataSelector.mjs","../../modules/data/ReadWriteRegistry.mjs","../../modules/data/AbstractReadWrite.mjs","../../modules/data/ReadWrite.mjs","../../modules/data/CachedReadWrite.mjs","../../modules/data/TreeNode.mjs","../../modules/data/TreeReader.mjs","../../modules/lib.mjs","../../modules/directives/dataset.mjs","../../modules/directives/literal.mjs","../../modules/directives/css-map.mjs","../../modules/properties/verificator.mjs","../../modules/properties/autocapitalize.mjs","../../modules/properties/autocomplete.mjs","../../modules/properties/autocorrect.mjs","../../modules/properties/buttonType.mjs","../../modules/properties/color.mjs","../../modules/properties/environment.mjs","../../modules/properties/inputType.mjs","../../modules/properties/nav.mjs","../../modules/properties/orientation.mjs","../../modules/properties/placement.mjs","../../modules/properties/position.mjs","../../modules/properties/protocol.mjs","../../modules/properties/size.mjs","../../modules/properties/arrayConverter.mjs","../../modules/controllers/AdoptedController.mjs","../../modules/controllers/AttributeController.mjs","../../modules/controllers/ContentController.mjs","../../modules/controllers/DataController.mjs","../../modules/controllers/ElementMoveController.mjs","../../modules/controllers/LocalizationController.mjs","../../modules/controllers/OrientationController.mjs","../../modules/controllers/TemplateController.mjs","../../modules/controllers/ThemeController.mjs","../../modules/controllers/SlotController.mjs","../../modules/GSElement.mjs","../../modules/controllers/ElementNavigationController.mjs","../../modules/controllers/GroupController.mjs","../../modules/components/Router.mjs","../../modules/components/Accordion.mjs","../../modules/components/AccordionItem.mjs","../../modules/components/Alert.mjs","../../modules/components/Button.mjs","../../modules/components/Calendar.mjs","../../modules/components/Card.mjs","../../modules/components/Center.mjs","../../modules/components/Menu.mjs","../../modules/components/Context.mjs","../../modules/components/Compare.mjs","../../modules/components/Controller.mjs","../../modules/components/Copyright.mjs","../../modules/components/DataHandler.mjs","../../modules/components/Dialog.mjs","../../modules/components/Drawer.mjs","../../modules/components/Dropdown.mjs","../../modules/components/Email.mjs","../../modules/components/Form.mjs","../../modules/components/FormGroup.mjs","../../modules/components/FormPanel.mjs","../../modules/components/Group.mjs","../../modules/components/Icon.mjs","../../modules/components/Indent.mjs","../../modules/components/Image.mjs","../../modules/components/Layout.mjs","../../modules/components/Link.mjs","../../modules/components/List.mjs","../../modules/components/ListItem.mjs","../../modules/components/Mouse.mjs","../../modules/components/Movable.mjs","../../modules/components/Nav.mjs","../../modules/components/NavItem.mjs","../../modules/components/Overlay.mjs","../../modules/components/Pager.mjs","../../modules/components/Popup.mjs","../../modules/components/Popover.mjs","../../modules/components/Progress.mjs","../../modules/components/Spinner.mjs","../../modules/components/Splitter.mjs","../../modules/components/tab/Tab.mjs","../../modules/components/tab/TabPanel.mjs","../../modules/components/tab/TabGroup.mjs","../../modules/components/Table.mjs","../../modules/components/Tag.mjs","../../modules/components/Text.mjs","../../modules/components/Tooltip.mjs","../../modules/components/Template.mjs","../../modules/components/ext/controllers/CopySelectController.mjs","../../modules/components/ext/controllers/MaskController.mjs","../../modules/components/ext/controllers/MultipatternController.mjs","../../modules/components/ext/controllers/NumberController.mjs","../../modules/components/ext/controllers/PasswordController.mjs","../../modules/components/ext/controllers/TextController.mjs","../../modules/components/ext/controllers/InteractiveController.mjs","../../modules/components/ext/controllers/ComboController.mjs","../../modules/components/ext/controllers/ListController.mjs","../../modules/components/ext/controllers/ValidityController.mjs","../../modules/components/ext/ReactiveInput.mjs","../../modules/components/ext/GSComboExt.mjs","../../modules/components/ext/GSDataListExt.mjs","../../modules/components/ext/GSInputElement.mjs","../../modules/components/ext/GSTextArea.mjs","../../modules/components/breadcrumb/Breadcrumb.mjs","../../modules/components/breadcrumb/BreadcrumbItem.mjs","../../modules/components/filebox/Attachment.mjs","../../modules/components/filebox/FileBox.mjs","../../modules/components/intl/TimeFormat.mjs","../../modules/components/intl/DateFormat.mjs","../../modules/components/intl/YearFormat.mjs","../../modules/components/intl/CurrencyFormat.mjs","../../modules/components/steps/StepStyle.mjs","../../modules/components/steps/Step.mjs","../../modules/components/steps/Steps.mjs","../../modules/components/toast/Notification.mjs","../../modules/components/toast/Toast.mjs","../../modules/components/tree/controllers/AbstractTreeController.mjs","../../modules/components/tree/controllers/TreeController.mjs","../../modules/components/tree/TreeItem.mjs","../../modules/components/tree/Tree.mjs","../../modules/components/ServiceWorkker.mjs","../../modules/extra/Chart.mjs","../../modules/extra/Highlight.mjs","../../modules/extra/Markdown.mjs","../../modules/extra/Monaco.mjs"],"sourcesContent":["/*\r\n * Copyright (C) 2015, 202$ Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSVersion class\r\n * @module base/GSVersion\r\n */\r\n\r\n/**\r\n * A class with library version / build\r\n * @class\r\n */\r\nexport class GSVersion {\r\n\r\n    static get version() {\r\n        return '2.0.0';\r\n    }\r\n\r\n    static get build() {\r\n        return 2025.0131;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Required CSS Styles for WebCompoents, regardless Bootstrap CSS.\r\n */\r\nexport const gsstyles = `.z-10k{z-index:10000 !important;}\r\n.gs-hide,gs-item{display:none !important;}\r\ngs-popover,gs-tooltip{position:fixed;top:0px;left:0px;},\r\n.d-contents{display:contents;}';\r\ngs-button-group::part(.btn-group){box-shadow:rgba(72, 72, 72, 0.4) 0px 0.125rem 0.25rem;}\r\ngs-group>gs-button::part(button) {box-shadow: none;}\r\ngs-group>gs-button:not(:last-child)::part(button) {border-top-right-radius: 0;border-bottom-right-radius: 0;}\r\ngs-group>gs-button:not(:first-child)::part(button) {margin-left: calc(var(--bs-border-width) * -5);border-top-left-radius: 0;border-bottom-left-radius: 0;}\r\ngs-layout {width: 100%;height: 100%;}\r\ngs-split-panel{flex: 1 1 auto !important;}\r\ninput[is=\"gs-ext-input\"][type=\"date\"]:before {content: attr(data-value);}\r\ninput[is=\"gs-ext-input\"][type=\"date\"]::-webkit-datetime-edit, input::-webkit-inner-spin-button, input::-webkit-clear-button {visibility: hidden;display: inline-block;}\r\ninput[is=\"gs-ext-input\"][type=\"date\"]::-webkit-calendar-picker-indicator {position: relative;top: 0px;right: 0;color: black;opacity: 0.5;}\r\n`;","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSLog class\r\n * @module base/GSLog\r\n */\r\n\r\n/** \r\n * Internal logging mechanism\r\n * @Class\r\n */\r\nexport class GSLog {\r\n\r\n\t/**\r\n\t * static flag is loging enabled or disabled\r\n\t */\r\n\tstatic logging = true;\r\n\tstatic tracing = false;\r\n\r\n\t/**\r\n\t * Log info message\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} msg \r\n\t */\r\n\tstatic info(el, msg) {\r\n\t\tthis.#print(el, msg, true, 'info');\r\n\t}\r\n\r\n\t/**\r\n\t * Log warn message\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} msg \r\n\t */\r\n\tstatic warn(el, msg) {\r\n\t\tthis.#print(el, msg, true, 'warn');\r\n\t}\r\n\r\n\t/**\r\n\t * Log error message\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} msg \r\n\t */\r\n\tstatic error(el, msg) {\r\n\t\tthis.#print(el, msg, true, 'error');\r\n\t}\r\n\r\n\t/**\r\n\t * Debug messages only if tracing flag enabled\r\n\t * @param {*} el \r\n\t * @param {*} msg \r\n\t */\r\n\tstatic trace(el, msg) {\r\n\t\tif (GSLog.tracing) this.#print(el, msg, false, 'error');\r\n\t}\r\n\r\n\t/**\r\n\t * Generic logging function\r\n\t * @param {HTMLElement} el Element to log (optional)\r\n\t * @param {String} msg Message to log\r\n\t * @param {Boolean} forced - when logging disabled globaly, use this to force logging\r\n\t */\r\n\tstatic log(el, msg, forced) {\r\n\t\tthis.#print(el, msg, forced);\r\n\t}\r\n\r\n\tstatic #print(el, msg, forced, type) {\r\n\t\tif (!(forced || this.logging)) return;\r\n\t\tconst tmp = el ? `${el.nodeName} -> ${el.id}: ${msg}` : msg;\r\n\t\tlet fn = console[type || 'log'];\r\n\t\tfn = typeof fn === 'function' ? fn : console.log;\r\n\t\tfn(tmp);\r\n\t\tif (msg instanceof Error) fn(msg);\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.seal(GSLog);\r\n\t}\r\n}\r\n\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSUtil class\r\n * @module base/GSUtil\r\n */\r\n\r\nimport { GSLog } from \"./GSLog.mjs\";\r\n\r\n/**\r\n * A generic set of static functions used across GS WebComponents framework\r\n * @class\r\n */\r\nexport class GSUtil {\r\n\r\n\tstatic FLAT = globalThis.GS_FLAT == true;\r\n\tstatic ALPHANUM = /^[a-zA-Z0-9-_]+$/;\r\n\tstatic #JSON_NORMALIZE = /(['\"])?([a-z0-9A-Z_]+)(['\"])?\\s*:/g;\r\n\r\n\tstatic isNumber = (n) => { return !isNaN(parseFloat(n)) && isFinite(n); };\r\n\r\n\tstatic isDate = (v) => { return v instanceof Date };\r\n\r\n\tstatic isBool = (v) => { return typeof v === 'boolean' || v instanceof Boolean };\r\n\r\n\tstatic isString = value => typeof value === 'string';\r\n\r\n\tstatic isNull = value => value === null || value === undefined;\r\n\r\n\tstatic toBinary = (value = 0) => value.toString(2);\r\n\r\n\tstatic asBool = (val = false) => val?.toString().trim().toLowerCase() === 'true';\r\n\r\n\tstatic fromLiteral = (str = '', obj) => str.replace(/\\${(.*?)}/g, (x, g) => obj[g]);\r\n\r\n\tstatic reverse = (str) => (str || \"\").split(\"\").reverse().join(\"\");\r\n\r\n\tstatic capitalize = (word = '') => word ? word[0].toUpperCase() + word.slice(1).toLowerCase() : '';\r\n\r\n\tstatic capitalizeAll = (word = '', split = ' ') => word.split(split).map((v, i) => GSUtil.capitalize(v)).join(split);\r\n\r\n\tstatic capitalizeAttr = (word = '') => word.split('-').map((v, i) => i ? GSUtil.capitalize(v) : v).join('');\r\n\r\n\tstatic initerror = () => { throw new Error('This class cannot be instantiated') };\r\n\r\n\tstatic isInstance = (el) => el instanceof el.constructor;\r\n\r\n\tstatic isPrimitive = (o) => !Array.isArray(o) && (this.isBool(o) || this.isDate(o) || this.isNumber(o) || this.isString(o));\r\n\r\n\tstatic range = (val = 0, min = 10, max = 100) => (Math.max(Math.min(max, val), min));\r\n\r\n\tstatic extractNumber = (val = '') => val.match(/[\\d,\\.]*\\d/)?.[0];\r\n\r\n\tstatic nonNull = value => !GSUtil.isNull(value);\r\n\r\n\tstatic asArray(val) {\r\n\t\treturn Array.isArray(val) ? val : [val];\r\n\t}\r\n\r\n\tstatic asNum(val, dft = 0, language) {\r\n\t\tlanguage = language || GSUtil.language;\r\n\t\tif (GSUtil.isString(val)) {\r\n\t\t\tconst sep = GSUtil.numberSeparator(language);\r\n\t\t\tval = GSUtil.extractNumber(val)?.replaceAll(sep, '') || val;\r\n\t\t}\r\n\t\treturn GSUtil.isNumber(val) ? parseFloat(val) : dft;\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Validate string for url format\r\n\t * @param {String} url \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isURL = (url = '') => /^(https?:\\/\\/|\\/{1,2}|\\.\\/{1})(\\S*\\/*){1,}/i.test(url.trim());\r\n\r\n\tstatic isHTML = (val = '') => val.trim().startsWith('<') && val.trim().endsWith('>');\r\n\r\n\t/**\r\n\t * Generate random set of characters\r\n\t * @param {String} pattern \r\n\t * @param {String} charset \r\n\t * @returns {String}\r\n\t */\r\n\tstatic generateUUID = (pattern = \"xxxx-xxxx-xxxx-xxxx-xxxx\", charset = \"abcdef0123456789\") => pattern.replace(/[x]/g, () => charset[Math.floor(Math.random() * charset.length)]);\r\n\r\n\t/**\r\n\t * Get browser default language\r\n\t * @returns {String}\r\n\t */\r\n\tstatic get language() {\r\n\t\treturn navigator.language ? navigator.language : navigator.languages[0];\r\n\t}\r\n\r\n\t/**\r\n\t * Convert string to regex isntance\r\n\t * @param {*} val \r\n\t * @param {*} flags \r\n\t * @returns \r\n\t */\r\n\tstatic toRegex(val, flags) {\r\n\t\tif (val instanceof RegExp) return val;\r\n\t\treturn GSUtil.isStringEmpty(val) ? undefined : new RegExp(val, flags);\r\n\t}\r\n\r\n\t/**\r\n\t * Find number separator for given language\r\n\t * @param {string} language \r\n\t * @returns \r\n\t */\r\n\tstatic decimalSeparator(language) {\r\n\t\treturn Intl.NumberFormat(language).format(1.1)[1];\r\n\t}\r\n\r\n\t/**\r\n\t * Find decimal separator for given language\r\n\t * @param {string} language \r\n\t * @returns \r\n\t */\r\n\tstatic numberSeparator(language) {\r\n\t\treturn Intl.NumberFormat(language).format(1000)[1];\r\n\t}\r\n\r\n\t/**\r\n\t * Try to find data format based on language\r\n\t * @param {string} language \r\n\t * @returns \r\n\t */\r\n\tstatic getDateFormat(language = undefined) {\r\n\t\tconst formatted = new Intl.DateTimeFormat(language).format(new Date(2000, 0, 2));\r\n\t\treturn formatted\r\n\t\t\t.replace('2000', 'YYYY')\r\n\t\t\t.replace('01', 'MM')\r\n\t\t\t.replace('1', 'M')\r\n\t\t\t.replace('02', 'DD')\r\n\t\t\t.replace('2', 'D');\r\n\t}\r\n\r\n\t/**\r\n\t * Sanitize text for HTML generation\r\n\t * @param {string} string \r\n\t * @returns \r\n\t */\r\n\tstatic sanitize(string = '') {\t\t\r\n\t\tconst map = {\r\n\t\t\t'&': '&amp;',\r\n\t\t\t'<': '&lt;',\r\n\t\t\t'>': '&gt;',\r\n\t\t\t'\"': '&quot;',\r\n\t\t\t\"'\": '&#x27;',\r\n\t\t\t\"/\": '&#x2F;',\r\n\t\t\t\"\\n\": '<br>',\r\n\t\t\t\"\\r\": '<br>',\r\n\t\t\t\"\\t\": '&nbsp;&nbsp;&nbsp;&nbsp;',\r\n\t\t\t' ': '&nbsp;',\r\n\t\t\t'\\\\': '&#x5C;',\r\n\t\t\t'`': '&#x60;'\r\n\t\t};\r\n\t\tconst reg = new RegExp(`[${Object.keys(map).join('')}]`, 'ig');\r\n\t\treturn string.replace(reg, (match) => (map[match]));\r\n\t}\r\n\t\t\r\n\tstatic isJsonString(val = '') {\r\n\t\treturn typeof val == 'string' && (val.startsWith('{') || val.startsWith('['));\r\n\t}\r\n\r\n\t/**\r\n\t * Check if provided parameter is of JSON type\r\n\t * @param {String|object} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isJsonType(val = '') {\r\n\t\treturn !GSUtil.isNull(val) && (Array.isArray(val) || typeof val == \"object\");\r\n\t}\r\n\r\n\t/**\r\n\t * Check if provided paramter is JSON\r\n\t * @param {String|object} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isJson(val = '') {\r\n\t\treturn GSUtil.isJsonString(val) || GSUtil.isJsonType(val);\r\n\t}\r\n\r\n\t/**\r\n\t * Convert provided paramter to JSON\r\n\t * @param {String|object} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic toJson(val = '', dft = {}, normalize = true) {\r\n\t\tif (GSUtil.isJsonString(val)) return JSON.parse(normalize ? GSUtil.normalizeJson(val) : val);\r\n\t\tif (GSUtil.isJsonType(val)) return val;\r\n\t\tif (val) GSLog.warn(null, `Invalid data to convert into JSON: ${val}`);\r\n\t\treturn dft;\r\n\t}\r\n\r\n\t/**\r\n\t * Normalize unquoted JSON\r\n\t * @param {String} val \r\n\t * @returns {String}\r\n\t */\r\n\tstatic normalizeJson(val = '') {\r\n\t\treturn val?.replace(GSUtil.#JSON_NORMALIZE, '\"$2\": ');\r\n\t}\r\n\r\n\t/**\r\n\t * Makes string value safe, always return value\r\n\t * @param {String|object} val \r\n\t * @returns {String}\r\n\t */\r\n\tstatic normalize(val, def = '') {\r\n\t\treturn (val ?? def).toString().trim();\r\n\t}\r\n\r\n\t/**\r\n\t * Convert string separated values into an array\r\n\t * @param {String} val \r\n\t * @param {String} separator \r\n\t * @returns {Array<String>}\r\n\t */\r\n\tstatic toStringArray(val = '', separator = ' ') {\r\n\t\treturn val.split(separator).map(v => v.trim()).filter(v => v.length > 0);\r\n\t}\r\n\r\n\t/**\r\n\t * Transform text based on CSS text attribute format\r\n\t * @param {String} format \r\n\t * @param {String} value \r\n\t * @returns {String}\r\n\t */\r\n\tstatic textTransform(format = '', value = '') {\r\n\t\tswitch (format) {\r\n\t\t\tcase 'lowercase':\r\n\t\t\t\tvalue = value.toLowerCase();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'uppercase':\r\n\t\t\t\tvalue = value.toUpperCase();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'capitalize':\r\n\t\t\t\tvalue = GSUtil.capitalizeAll(value);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert parameterized string literal as template to string \r\n\t * \r\n\t * \t const template = 'Example text: ${text}';\r\n\t *   const result = interpolate(template, {text: 'Foo Boo'});\r\n\t * \r\n\t * @param {String} tpl \r\n\t * @param {Object} params \r\n\t * @returns {function}\r\n\t */\r\n\tstatic fromTemplateLiteral(tpl, params) {\r\n\t\tconst names = Object.keys(params);\r\n\t\tconst vals = Object.values(params);\r\n\t\treturn new Function(...names, `return \\`${tpl}\\`;`)(...vals);\r\n\t}\r\n\r\n\t/**\r\n\t * Decode HTML entities (&nbsp; &laquot; etc...)\r\n\t * @param {string} text \r\n\t * @returns {string}\r\n\t */\r\n\tstatic decodeHTMLEntities(text) {\r\n\t\tconst textArea = document.createElement('textarea');\r\n\t\ttextArea.innerHTML = text;\r\n\t\treturn textArea.value;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert string pointer to object\r\n\t * @param {String} value \r\n\t * @returns {*}\r\n\t */\r\n\tstatic parseValue(value) {\r\n\t\tif (!GSUtil.isString(value)) return;\r\n\t\tif (!GSUtil.isStringNonEmpty(value)) return;\r\n\t\tlet o = window;\r\n\t\tlet fn = null;\r\n\t\tvalue.trim().split('.').forEach((v, i, a) => {\r\n\t\t\tif (!o) return;\r\n\t\t\tif (i < a.length - 1) {\r\n\t\t\t\treturn o = o[v];\r\n\t\t\t}\r\n\t\t\tfn = o[v];\r\n\t\t});\r\n\t\treturn fn;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if strings has data\r\n\t * \r\n\t * @param {String} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isStringNonEmpty(val = '') {\r\n\t\treturn !GSUtil.isStringEmpty(val);\r\n\t}\r\n\r\n\t/**\r\n\t * Check if strings is empty\r\n\t * \r\n\t * @param {String} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isStringEmpty(val = '') {\r\n\t\treturn GSUtil.normalize(val).trim().length === 0;\r\n\t}\r\n\r\n\t/**\r\n\t * match two strings, or first is not set\r\n\t * \r\n\t * @param {String} left \r\n\t * @param {String} right \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isStringMatch(left, right) {\r\n\t\tconst lmatch = GSUtil.isStringNonEmpty(left);\r\n\t\tconst rmatch = GSUtil.isStringNonEmpty(right);\r\n\t\tif (lmatch && rmatch) {\r\n\t\t\treturn left.trim().toLowerCase() === right.trim().toLowerCase();\r\n\t\t}\r\n\t\treturn lmatch === rmatch;\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * Async version of timeout\r\n\t * \r\n\t * @async\r\n\t * @param {Number} time \r\n\t * @param {number|AbortSignal} signal Abort object\r\n\t * @returns {Promise<void>}\r\n\t */\r\n\tstatic async timeout(time = 0, signal) {\r\n\t\tif (time <= 0) return;\r\n\t\tsignal = GSUtil.isNumber(signal) ? AbortSignal.timeout(signal) : signal;\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tconst iid = setTimeout(resolve.bind(null, true), time);\r\n\t\t\tif (signal instanceof AbortSignal) {\r\n\t\t\t\tsignal.addEventListener('abort', () => {\r\n\t\t\t\t\tclearTimeout(iid);\r\n\t\t\t\t\treject(new Error('aborted timeout'));\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Download provided data\r\n\t * \r\n\t * @async\r\n\t * @param {Array} data \r\n\t * @param {String} name File name\r\n\t * @param {String} type Mime type, default octet/stream\r\n\t */\r\n\tstatic async export(data, name, type = 'octet/stream') {\r\n\r\n\t\tconst blob = new Blob(data, { type: type });\r\n\t\tconst url = URL.createObjectURL(blob);\r\n\t\ttry {\r\n\t\t\tconst a = document.createElement(\"a\");\r\n\t\t\ta.href = url;\r\n\t\t\ta.download = name;\r\n\t\t\ta.click();\r\n\r\n\t\t\tawait GSUtil.timeout(2000);\r\n\r\n\t\t} finally {\r\n\t\t\tURL.revokeObjectURL(url);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Registration helper function, replacement for class static initializers\r\n\t * Mostly to support Safari browser.\r\n\t * \r\n\t * GSUtil.register(null, GSUtil, null, true, false, true);\r\n\t * \r\n\t * @param {String} name Custom element name\r\n\t * @param {HTMLElement} clazz Class extensing at least HTMLElement\r\n\t * @param {String} ext If existing tag extended, this is tagName\r\n\t * @param {Boolean} seal Should class be sealed\r\n\t * @param {Boolean} freeze Should class be freezed\r\n\t * @param {Boolean} expose Should class be exposed to \"self\"\r\n\t * \r\n\t * @returns {void}\r\n\t */\r\n\tstatic register(name, clazz, ext, seal = true, freeze = false, expose = false) {\r\n\t\tif (!HTMLElement.isPrototypeOf(clazz)) return;\r\n\t\tif (customElements.get(name)) return;\r\n\t\tcustomElements.define(name, clazz, { extends: ext?.toLowerCase() });\r\n\t\tif (seal && !Object.isSealed(clazz)) Object.seal(clazz);\r\n\t\tif (freeze && !Object.isFrozen(clazz)) Object.freeze(clazz);\r\n\t\tif (expose) self[clazz.name] = clazz;\r\n\t}\r\n\r\n\t/**\r\n\t * Import and initialize source in JavaScript modules\r\n\t * Standard eval or new Function can not be used\r\n\t * @param {String} src \r\n\t * @returns {*}\r\n\t */\r\n\tstatic async importSource(src) {\r\n\t\tconst blob = new Blob([src], { type: \"text/javascript\" });\r\n\t\tconst url = URL.createObjectURL(blob);\r\n\t\ttry {\r\n\t\t\treturn await import(url);\r\n\t\t} finally {\r\n\t\t\tURL.revokeObjectURL(url);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Use Clipboard API to write to the clipboard\r\n\t * @returns \r\n\t */\r\n\tstatic async writeToClipboard(value = '') {\r\n\t\tconst result = await navigator.permissions.query({ name: \"clipboard-write\" })\r\n\t\tif (result.state === \"granted\" || result.state === \"prompt\") {\r\n\t\t   return navigator.clipboard.writeText(value);\r\n\t\t}\r\n\t\treturn '';\r\n\t}\r\n\r\n\t/**\r\n\t * Use Clipboard API to read from the clipboard\r\n\t * @returns \r\n\t */\r\n\tstatic async readFromClipboard() {\r\n\t\tconst result = await navigator.permissions.query({ name: \"clipboard-read\" })\r\n\t\tif (result.state === \"granted\" || result.state === \"prompt\") {\r\n\t\t   return navigator.clipboard.readText();\r\n\t\t}\r\n\t\treturn '';\r\n\t}\t\r\n\r\n\tstatic {\r\n\t\tObject.seal(GSUtil);\r\n\t\tglobalThis.GSUtil = GSUtil;\r\n\t}\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSFunction class\r\n * @module base/GSFunction\r\n */\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A set of static functions used for processing functions\r\n * @class\r\n */\r\nexport class GSFunction {\r\n\r\n    /**\r\n     * Check if object is of type function\r\n     * \r\n     * @param {function} fn \r\n     * @returns {Boolean}\r\n     */\r\n    static isFunction = (fn) => typeof fn === 'function';\r\n\r\n    static isFunctionNative(fn) {\r\n        return GSFunction.isFunction(fn) && fn.toString().includes('native code');\r\n    }\r\n\r\n    /**\r\n     * Check if object has function\r\n     * \r\n     * @param {Object} o \r\n     * @param {function} fn \r\n     * @returns {Boolean}\r\n     */\r\n    static hasFunction(o, fn) {\r\n        return o && GSFunction.isFunction(o[fn]);\r\n    }\r\n\r\n    /**\r\n     * Check if class has defined getter\r\n     * @param {*} own \r\n     * @param {*} name \r\n     * @returns \r\n     */\r\n    static hasGetter(own, name) {\r\n        return GSFunction.isFunctionDefined(own, name, 'get');\r\n    }\r\n\r\n    /**\r\n     * * Check if class has defined setter\r\n     * @param {*} own \r\n     * @param {*} name \r\n     * @returns \r\n     */\r\n    static hasSetter(own, name) {\r\n        return GSFunction.isFunctionDefined(own, name, 'set');\r\n    }\r\n\r\n    /**\r\n     * Check if class instance has defined function\r\n     * @param {object} own Class instance\r\n     * @param {string} name Function name to check\r\n     * @param {string} fn Function name to check\r\n     * @returns {boolean} Returns true if getter exist\r\n     */\r\n    static isFunctionDefined(own, name, fn) {\r\n        const desc = own ? Reflect.getOwnPropertyDescriptor(own.__proto__, name) : false;\r\n        return desc && typeof desc[fn] === 'function';\r\n    }\r\n\r\n    /**\r\n     * Check if object is of type async function\r\n     * \r\n     * @param {function} fn \r\n     * @returns  {Boolean}\r\n     */\r\n    static isFunctionAsync(fn) {\r\n        if (!GSFunction.isFunction(fn)) return false;\r\n        const AsyncFunction = GSFunction.callFunctionAsync.constructor\r\n        let isValid = fn instanceof AsyncFunction;\r\n        if (!isValid) isValid = fn[Symbol.toStringTag] == \"AsyncFunction\";\r\n        return isValid;\r\n    }\r\n\r\n    /**\r\n     * Check if object is of type generator function\r\n     * \r\n     * @param {function} fn \r\n     * @returns {Boolean}\r\n     */\r\n    static isFunctionGenerator(fn) {\r\n        if (!GSFunction.isFunction(fn)) return false;\r\n        const GeneratorFunction = (function*(){}).constructor;\r\n        return fn instanceof GeneratorFunction;\r\n    }\r\n\r\n    /**\r\n     * Generic asynchronous function caller\r\n     * \r\n     * @async\r\n     * @param {function} fn \r\n     * @param {Object} owner \r\n     * @returns  {Promise}\r\n     * @throws {Error} \r\n     */\r\n    static async callFunctionAsync(fn, owner) {\r\n        const args = arguments ? Array.from(arguments).slice(2) : [];\r\n        return await fn.apply(owner || null, args);\r\n    }\r\n\r\n    /**\r\n     * Generic synchronous function caller\r\n     * \r\n     * @param {function} fn \r\n     * @param {Object} owner \r\n     * @returns {Object}\r\n     * @throws {Error}\r\n     */\r\n    static callFunctionSync(fn, owner) {\r\n        const args = arguments ? Array.from(arguments).slice(2) : [];\r\n        return fn.apply(owner || null, args);\r\n    }\r\n\r\n    /**\r\n     * Generic function caller\r\n     * \r\n     * @param {function} fn \r\n     * @param {Object} owner \r\n     * @returns {Object}\r\n     */\r\n    static async callFunction(fn, owner, native = true) {\r\n        fn = GSUtil.isString(fn) ? GSFunction.parseFunction(fn) : fn;\r\n        if (!GSFunction.isFunction(fn)) return;\r\n        if (!native && GSFunction.isFunctionNative(fn)) return;\r\n        const args = arguments ? Array.from(arguments).slice(3) : [];\r\n        if (GSFunction.isFunctionAsync(fn)) {\r\n            return await GSFunction.callFunctionAsync(fn, owner, ...args);\r\n        }\r\n        return GSFunction.callFunctionSync(fn, owner, ...args);\r\n    }\r\n\r\n    /**\r\n     * Convert string pointer to function call\r\n     * \r\n     * @param {String} value \r\n     * @returns  {function}\r\n     */\r\n    static parseFunction(value) {\r\n        const fn = GSUtil.parseValue(value);\r\n        return GSFunction.isFunction(fn) ? fn : null;\r\n    }\r\n\r\n    static async #contextualize(fn, context, args) {\r\n        if (!GSFunction.isFunction(fn)) return;\r\n        const isAsync = GSFunction.isFunctionAsync(fn);\r\n        if (isAsync) {\r\n            return await fn.apply(context, args);\r\n        } else {\r\n            return fn.apply(context, args);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Wrap function into a single call - loop first call executed\r\n     * @param {function} fn Function to be called\r\n     * @param {*} context Instance at which to call the function\r\n     * @returns {*} Function result\r\n     */\r\n    static callOnceFifo(fn, context) {\r\n        let cnt = false;\r\n        return async (...args) => {\r\n            if (cnt) return;\r\n            cnt = true;\r\n            const own = context || this;\r\n            return await GSFunction.#contextualize(fn, own, args);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Wrap function into a single call - loop last call executed\r\n     * @param {function} fn Function to be called\r\n     * @param {*} context Instance at which to call the function\r\n     * @returns {*} Function result\r\n     */\r\n    static callOnceLifo(fn, context) {\r\n        let cnt = 0;\r\n        return (...args) => {\r\n            if (cnt < 0) return;\r\n            cnt++;\r\n            const own = context || this;\r\n            return new Promise((accept, reject) => {\r\n                queueMicrotask(async () => {\r\n                    if (cnt <= 0) return;\r\n                    cnt--;\r\n                    if (cnt !== 0) return;\r\n                    try {\r\n                        const o = await GSFunction.#contextualize(fn, own, args);\r\n                        accept(o);\r\n                    } catch (e) {\r\n                        reject(e);\r\n                    } finally {\r\n                        cnt = -1;\r\n                    }\r\n                });\r\n            });\r\n        }\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSFunction);\r\n        globalThis.GSFunction = GSFunction;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSID class\r\n * @module base/GSID\r\n */\r\n\r\n/**\r\n * Generic unique ID generator for element\r\n * @class\r\n */\r\nexport class GSID {\r\n\r\n\tstatic #id = 0;\r\n\r\n\t/**\r\n\t * Reset ID counter to 0\r\n\t */\r\n\tstatic reset() {\r\n\t\tthis.#id = 0;\r\n\t}\r\n\r\n\t/**\r\n\t * Get next unique generated ID\r\n\t * @param {*} prefx Value to prepend to ID counter\r\n\t * @returns {String} A generated ID\r\n\t */\r\n\tstatic next(prefx = 'GSId-') {\r\n\t\treturn `${prefx}${this.#id++}`;\r\n\t}\r\n\r\n\t/**\r\n\t * Auto generate next ID\r\n\t * @returns {String} A generated ID\r\n\t */\r\n\tstatic get id() {\r\n\t\treturn this.next();\r\n\t}\r\n\r\n\t/**\r\n\t * Calculate hashcode from string (Java compatible)\r\n\t * @param {*} s A text fro mwhich hashcode is calculated \r\n\t * @returns {Number} Generated numeric hashcode\r\n\t */\r\n\tstatic hashCode(s) {\r\n\t\tconst l = (s || '').length;\r\n\t\tlet h = 0, i = 0;\r\n\t\tif (l === 0) return h;\r\n\t\twhile (i < l) {\r\n\t\t\th = (h << 5) - h + s.charCodeAt(i++) | 0;\r\n\t\t}\r\n\t\treturn h;\r\n\t}\r\n\r\n\t/**\r\n\t * Set element id if not set already\r\n\t * @param {HTMLElement} el \r\n\t */\r\n\tstatic setIf(el) {\r\n\t\tif (el) {\r\n\t\t\tel.id = typeof el.id !== 'string' ? GSID.id : el.id || GSID.id;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.freeze(GSID);\r\n\t}\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\nconst isProxy = Symbol(\"isProxy\")\r\n\r\n/**\r\n * A module loading GSAttr class\r\n * @module base/GSAttr\r\n */\r\n\r\n/**\r\n * A generic set of static functions to handle DOM Attributes\r\n * @class\r\n */\r\nexport class GSAttr {\r\n\r\n\t/**\r\n\t * Check if given element is of type HTMLElement\r\n\t * NOTE: GSDOM.isHTMLElement duplicate - prevent circular import\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isHTMLElement(el) {\r\n\t\treturn el instanceof HTMLElement;\r\n\t}\r\n\r\n\t/**\r\n\t  * Generic function to change element node attribute\r\n\t  * \r\n\t  * @param {HTMLElement} el Target to receive attribute value\r\n\t  * @param {String} name Attribute name\r\n\t  * @param {Boolean} val Attribute value\r\n\t  */\r\n\tstatic toggle(el, name, val = false) {\r\n\t\tif (!GSAttr.isHTMLElement(el)) return;\r\n\t\tif (val) {\r\n\t\t\tel.setAttribute(name, '');\r\n\t\t} else {\r\n\t\t\tel.removeAttribute(name);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Generic function to change elment node attribute\r\n\t * \r\n\t * @param {HTMLElement} el Target to receive attribute value\r\n\t * @param {String} name Attribite name\r\n\t * @param {String} val Attribute value\r\n\t */\r\n\tstatic set(el, name, val) {\r\n\t\tif (!GSAttr.isHTMLElement(el)) return;\r\n\t\tif (GSUtil.normalize(val)) {\r\n\t\t\tel.setAttribute(name, val);\r\n\t\t} else {\r\n\t\t\tel.removeAttribute(name);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Generic function to get element node attribute\r\n\t * \r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {String} val Default value\r\n\t * @returns {String}\r\n\t */\r\n\tstatic get(el, name = '', val = '') {\r\n\t\tif (!GSAttr.isHTMLElement(el)) return val;\r\n\t\tif (!GSUtil.isInstance(el)) return val;\r\n\t\tconst v = el.getAttribute(name) ?? val;\r\n\t\treturn GSUtil.normalize(v);\r\n\t}\r\n\r\n\t/**\r\n\t * Get attribute as boolean type\r\n\t * \r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {String} val Default value\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic getAsBool(el, name = '', val = 'false') {\r\n\t\tconst attr = GSAttr.get(el, name, val);\r\n\t\treturn GSUtil.asBool(attr, val);\r\n\t}\r\n\r\n\t/**\r\n\t * Get attribute as numberic type\r\n\t * \r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {String} val Default value\r\n\t * @returns {Number}\r\n\t */\r\n\tstatic getAsNum(el, name = '', val = '0') {\r\n\t\tconst attr = GSAttr.get(el, name, val);\r\n\t\treturn GSUtil.asNum(attr, val);\r\n\t}\r\n\r\n\t/**\r\n\t * Get attribute as JSON object type\r\n\t * \r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {String} val Default value\r\n\t * @returns {JSON}\r\n\t */\r\n\tstatic getAsJson(el, name = '', val = '0') {\r\n\t\tconst attr = GSAttr.get(el, name, val);\r\n\t\treturn GSUtil.toJson(attr);\r\n\t}\r\n\r\n\t/**\r\n\t * Store data into attribute as boolean\r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {Boolean} val Default value\r\n\t */\r\n\tstatic setAsBool(el, name = '', val = 'false') {\r\n\t\tGSAttr.set(el, name, GSUtil.asBool(val), false);\r\n\t\t/*\r\n\t\tif (!GSAttr.isHTMLElement(el)) return;\r\n\t\tel.toggleAttribute(name, GSUtil.asBool(val));\r\n\t\t*/\r\n\t}\r\n\r\n\t/**\r\n\t * Store data into attribute as numeric\r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {Number} val Default value\r\n\t */\r\n\tstatic setAsNum(el, name = '', val = '0') {\r\n\t\tGSAttr.set(el, name, GSUtil.asNum(val), NaN);\r\n\t}\r\n\r\n\t/**\r\n\t * Store data into attribute as JSON string\r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {string} val Default value\r\n\t */\r\n\tstatic setAsJson(el, name = '', val = '0') {\r\n\t\tGSAttr.set(el, name, JSON.stringify(val), '{}');\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON object to attribute string \r\n\t * @param {*} obj \r\n\t * @returns {String}\r\n\t */\r\n\tstatic flattenJson(obj) {\r\n\t\treturn Object.entries(obj || {}).map(kv => `${kv[0]}=${kv[1]}`).join(' ');\r\n\t}\r\n\r\n\t/**\r\n\t * Apply JSON object to element attributes\r\n\t * @param {*} obj \r\n\t */\r\n\tstatic jsonToAttr(obj, el) {\r\n\t\tif (!GSAttr.isHTMLElement(el)) return;\r\n\t\tObject.entries(obj || {})\r\n\t\t.filter(kv => kv[0] != 'items')\r\n\t\t.filter(kv => kv[0][0] != '#')\r\n\t\t.filter(kv => kv[0][0] != '$')\r\n\t\t.map(kv => GSAttr.set(el, kv[0], kv[1]));\r\n\t}\r\n\r\n\t/**\r\n\t * Convert list of data attributes into a string list\r\n\t * @param {HTMLElement} el \r\n\t * @returns {String}\r\n\t */\r\n\tstatic dataToString(el) {\r\n\t\treturn Array.from(el.attributes)\r\n\t\t\t.filter(v => v.name.startsWith('data-'))\r\n\t\t\t.map(v => `${v.name}=\"${v.value}\"`)\r\n\t\t\t.join(' ');\r\n\t}\r\n\r\n\t/**\r\n\t * Convert list of element attributes into a flat list separated by given separator (default ' ')\r\n\t * @param {HTMLMediaElement} el \r\n\t * @param {String} sep \r\n\t * @returns {String}\r\n\t */\r\n\tstatic flatten(el, sep = ' ') {\r\n\t\treturn Array.from(el?.attributes || []).map(a => `${a.name}=\"${a.value}\"`).join(sep);\r\n\t}\r\n\r\n\t/**\r\n\t * Generic attribute retriever \r\n\t * opt format { prop: {type:Number, attribute: 'alt-prop-name'}}\r\n\t * @param {HTMLElement} host The host element to proxify\r\n\t * @param {Object} [opt={}] Options object describing attribute mapping and types\r\n\t * @param {String} [recursive='items'] Property name for recursive proxification of children\r\n\t * @returns {Proxy}\r\n\t */\r\n\tstatic proxify(host, opt = {}, recursive = 'items') {\r\n\r\n\t\tconst instance = new Proxy(host, {\r\n\t\t\t\r\n\t\t\tset(target, prop, value) {\r\n\t\t\t\t\r\n\t\t\t\tif (prop === 'self') return;\r\n\t\t\t\tif (prop === 'dataset') return target.dataset = value;\r\n\t\t\t\tif (typeof prop === 'symbol') return target[prop] = value;\r\n\r\n\t\t\t\tconst type = opt[prop]?.type;\r\n\t\t\t\tprop = opt[prop]?.attribute || prop;\r\n\t\t\t\t\r\n\t\t\t\tswitch(type) {\r\n\t\t\t\t\tcase Boolean :\r\n\t\t\t\t\t\tGSAttr.toggle(target, prop,  GSUtil.asBool(value));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase Number :\r\n\t\t\t\t\t\tGSAttr.setAsNum(target, prop, value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase Object :\r\n\t\t\t\t\tcase Array :\r\n\t\t\t\t\t\tGSAttr.set(target, prop, JSON.stringify(value));\r\n\t\t\t\t\tdefault:\t\t\t\t\t\r\n\t\t\t\t\t\tGSAttr.set(target, prop, value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\r\n\t\t\tget(target, prop) {\r\n\t\t\t\t\r\n\t\t\t\tif (prop === 'self') return target;\r\n\t\t\t\tif (prop === 'dataset') return target.dataset;\r\n\t\t\t\tif (typeof prop === 'symbol') return target[prop];\r\n\t\t\t\tif (prop === 'isProxy') return isProxy;\r\n\t\t\t\tif (prop === recursive) return Array.from(target.children).map(el => GSAttr.proxify(el, opt, recursive)); \r\n\t\t\t\t\r\n\t\t\t\tconst tmp = opt; // Object.hasOwn(opt, prop) ? opt : target;\r\n\t\t\t\t\r\n\t\t\t\tconst type = tmp[prop]?.type;\r\n\t\t\t\tconst safe = tmp[prop]?.unsafe ? true : false;\r\n\t\t\t\tconst dflt = tmp[prop]?.default;\r\n\t\t\t\tconst multi = tmp[prop]?.multi === true;\r\n\t\t\t\t\r\n\t\t\t\tprop = tmp[prop]?.attribute || prop;\r\n\t\t\t\tlet val = target.hasAttribute(prop) ? GSAttr.get(target, prop) : target[prop];\r\n\r\n\t\t\t\tif (GSFunction.isFunction(val)) return val.bind(target);\r\n\t\t\t\t\r\n\t\t\t\tswitch(type) {\r\n\t\t\t\t\tcase Boolean :\r\n\t\t\t\t\t\treturn target.hasAttribute(prop);\r\n\t\t\t\t\tcase Number :\r\n\t\t\t\t\t\treturn GSUtil.asNum(val, 0);\r\n\t\t\t\t\tcase Object :\r\n\t\t\t\t\t\treturn GSUtil.toJson(val, {});\r\n\t\t\t\t\tcase Array :\r\n\t\t\t\t\t\treturn GSUtil.toJson(val, []);\r\n\t\t\t\t\tdefault:\t\t\t\t\t\r\n\t\t\t\t\t\tval = safe ? (val || dflt || '') : (val || dflt || undefined);\r\n\t\t\t\t\t\treturn multi ? GSUtil.toStringArray(val) : val;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\treturn instance;\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.seal(GSAttr);\r\n\t\tglobalThis.GSAttr = GSAttr;\r\n\t}\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\n\r\n/**\r\n * A module loading GSCSSMap class\r\n * @module base/GSCSSMap\r\n */\r\n\r\n/**\r\n * Wrapper around computedStyleMap to support Firefox and WebKit Mode\r\n * @class\r\n */\r\nexport class GSCSSMap {\r\n\r\n    static #modern = globalThis.document?.body?.computedStyleMap ? true : false;\r\n\r\n    #map;\r\n\r\n    constructor(element) {\r\n        const me = this;\r\n        me.#map = GSCSSMap.#getMap(element);\r\n    }\r\n\r\n    get(name) {\r\n        const me = this;\r\n        if (!me.#map) return undefined;\r\n        return GSCSSMap.#modern ? me.#map.get(name) : me.#map[GSUtil.capitalizeAttr(name)];\r\n    }\r\n\r\n    asText(name) {\r\n        return (this.get(name) || '')?.toString();\r\n    }\r\n\r\n    asBool(name) {\r\n        const val = this.get(name);\r\n        return GSUtil.asBool(GSCSSMap.#modern ? val?.value : val);\r\n    }\r\n\r\n    asNum(name) {\r\n        let val = this.get(name);\r\n        if (GSCSSMap.#modern && GSFunction.isFunction(val?.to)) {\r\n            if (val.unit !== 'number') val = val.to('px');\r\n        }\r\n        if (GSCSSMap.#modern) return GSUtil.asNum(val?.value);\r\n        const num = val?.match(/\\d*(\\.\\d*)?/g).filter(v => GSUtil.isNumber(v)).shift();\r\n        return GSUtil.asNum(num);\r\n    }\r\n\r\n    matches(name, value) {\r\n        return this.asText(name) == value;\r\n    }\r\n\r\n    /**\r\n     * Support for Firefox/Gecko to get element computedStyleMap\r\n     * @param {HTMLElement} el \r\n     * @returns {CSSStyleDeclaration}\r\n     */\r\n    static #getMap(el) {\r\n        if (GSCSSMap.#modern) return el.computedStyleMap();\r\n        if (globalThis.window?.getComputedStyle) return globalThis.window.getComputedStyle(el);\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Support for Firefox/Gecko to get element computedStyleMap item\r\n     * @param {HTMLElement} el \r\n     * @returns {}\r\n     */\r\n    static styleValue(el, name) {\r\n        return GSCSSMap.getComputedStyledMap(el).get(name);\r\n    }\r\n\r\n    /**\r\n     * Support for Firefox/Gecko to get element computedStyleMap\r\n     * @param {HTMLElement} element \r\n     * @returns {GSCSSMap}\r\n     */\r\n    static getComputedStyledMap(element) {\r\n        return new GSCSSMap(element);\r\n    }\r\n\r\n    static #normalize(str) {\r\n        if (!str) return '';\r\n        str = String(str).replace(/\\s*([>~+])\\s*/g, ' $1 ');\r\n        return str.replace(/(\\s+)/g, ' ').trim();\r\n    }\r\n\r\n    static #split(str, on) {\r\n        return str.split(on).map(x => x.trim()).filter(x => x);\r\n    }\r\n\r\n    static #containsAny(selText, ors) {\r\n        return selText ? ors.some(x => selText.includes(x)) : false;\r\n    }\r\n\r\n    /**\r\n     * Find css defined rules by css selector\r\n     * @param {String} selector \r\n     * @returns {CSSStyleRule}\r\n     */\r\n    static findRule(selector) {\r\n        const me = GSCSSMap;\r\n        const logicalORs = me.#split(me.#normalize(selector), ',');\r\n        const sheets = Array.from(globalThis.document.styleSheets);\r\n        const ruleArrays = sheets.map(x => Array.from(x.cssRules || []));\r\n        const allRules = ruleArrays.reduce((all, x) => all.concat(x), []);\r\n        return allRules.filter((x) => me.#containsAny(me.#normalize(x.selectorText), logicalORs));\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSCSSMap);\r\n        globalThis.GSCSSMap = GSCSSMap;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A module loading GSDate class\r\n * @module base/GSDate\r\n */\r\n\r\n/**\r\n * Custom Date class to help handling calendar and date formatting\r\n * \r\n * @class\r\n */\r\nexport class GSDate extends Date {\r\n\r\n    static DEFAULT_FORMAT = 'YYYY-MM-DDTHH:mm:ssZ';\r\n    static REGEX_FORMAT = /\\[([^\\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g\r\n\r\n    #language = navigator.language;\r\n\r\n    format(val = GSDate.DEFAULT_FORMAT, language) {\r\n        const me = this;\r\n        if (language) me.language = language;\r\n        const obj = me.asJSON();\r\n        return val.replace(GSDate.REGEX_FORMAT, (match, val) => val || obj[match]);\r\n    }\r\n\r\n    /**\r\n     * Build array days/weeks for a month\r\n     * @returns {Array<string>}\r\n     */\r\n    build() {\r\n        const me = this;\r\n        const last = me.last.getDate();\r\n        const first = me.first.getDay();\r\n\r\n        const mondayFirst = me.#isMondayFirst();\r\n\r\n        const dayOffset = mondayFirst ? -2 : -1;\r\n        const days = first === 0 ? [] : ' '.repeat(first + dayOffset).split(' ');\r\n        /*\r\n        const emptyDays =  first === 0 ? 0 : first + dayOffset;\r\n        const days = Array.from({ length: emptyDays }, () => '');\r\n        */\r\n        let i = 1;\r\n        while (i <= last) {\r\n            days.push(i.toString());\r\n            i++;\r\n        }\r\n\r\n        while (days.length % 7 != 0) days.push('');\r\n\r\n        return days;\r\n    }\r\n\r\n    get language() {\r\n        return this.#language;\r\n    }\r\n\r\n    set language(val) {\r\n        this.#language = val || navigator.language;\r\n    }\r\n\r\n    get year() {\r\n        return this.getFullYear();\r\n    }\r\n\r\n    set year(val = 0) {\r\n        this.setFullYear(val);\r\n    }\r\n\r\n    get month() {\r\n        return this.getMonth();\r\n    }\r\n\r\n    set month(val = 0) {\r\n        this.setMonth(val);\r\n    }\r\n\r\n    get day() {\r\n        return this.getDate();\r\n    }\r\n\r\n    set day(val = 0) {\r\n        this.setDate(val);\r\n    }\r\n\r\n    /**\r\n     * First date of the month\r\n     * @returns {Date}\r\n     */\r\n    get first() {\r\n        return new GSDate(this.getFullYear(), this.getMonth(), 1);\r\n    }\r\n\r\n    /**\r\n     * Last date of the month\r\n     * @returns {Date}\r\n     */\r\n    get last() {\r\n        return new GSDate(this.getFullYear(), this.getMonth() + 1, 0);\r\n    }\r\n\r\n    get YY() {\r\n        return String(this.YYYY).slice(-2);\r\n    }\r\n\r\n    get YYYY() {\r\n        return this.getFullYear();\r\n    }\r\n\r\n    get M() {\r\n        return this.getMonth() + 1;\r\n    }\r\n\r\n    get MM() {\r\n        return this.M.toString().padStart(2, '0');\r\n    }\r\n\r\n    get MMM() {\r\n        return this.#toLocale({ month: 'short' });\r\n    }\r\n\r\n    get MMMM() {\r\n        return this.#toLocale({ month: 'long' });\r\n    }\r\n\r\n    get D() {\r\n        return this.getDate().toString();\r\n    }\r\n\r\n    get DD() {\r\n        return this.D.padStart(2, '0');\r\n    }\r\n\r\n    get d() {\r\n        return this.getDay().toString();\r\n    }\r\n\r\n    get dd() {\r\n        return this.ddd.slice(0, 2);\r\n    }\r\n\r\n    get ddd() {\r\n        return this.#toLocale({ weekday: 'short' });\r\n    }\r\n\r\n    get dddd() {\r\n        return this.#toLocale({ weekday: 'long' });\r\n    }\r\n\r\n    get H() {\r\n        return this.getHours().toString();\r\n    }\r\n\r\n    get HH() {\r\n        return this.H.padStart(2, '0');\r\n    }\r\n\r\n    get h() {\r\n        return this.#formatHour(1);\r\n    }\r\n\r\n    get hh() {\r\n        return this.#formatHour(2);\r\n    }\r\n\r\n    get a() {\r\n        return this.#meridiem(true);\r\n    }\r\n\r\n    get A() {\r\n        return this.#meridiem(false);\r\n    }\r\n\r\n    get m() {\r\n        return this.getMinutes().toString();\r\n    }\r\n\r\n    get mm() {\r\n        return this.m.padStart(2, '0');\r\n    }\r\n\r\n    get s() {\r\n        return this.getSeconds().toString();\r\n    }\r\n\r\n    get ss() {\r\n        return this.s.padStart(2, '0');\r\n    }\r\n\r\n    get SSS() {\r\n        return this.getMilliseconds().toString().padStart(3, '0');\r\n    }\r\n\r\n    get Z() {\r\n        return this.#zoneStr();\r\n    }\r\n\r\n    get ZZ() {\r\n        return this.Z.replace(':', '');\r\n    }\r\n\r\n    get Q() {\r\n        return Math.ceil(this.M / 3);\r\n    }\r\n\r\n    get k() {\r\n        return (this.getHours() + 1).toString();\r\n    }\r\n\r\n    get kk() {\r\n        return this.k.padStart(2, '0');\r\n    }\r\n\r\n    get W() {\r\n        const date = new Date(this.getTime());\r\n        date.setHours(0, 0, 0, 0);\r\n        date.setDate(date.getDate() + 3 - (date.getDay() + 6) % 7);\r\n        const week1 = new Date(date.getFullYear(), 0, 4);\r\n        return 1 + Math.round(((date.getTime() - week1.getTime()) / 86400000 - 3 + (week1.getDay() + 6) % 7) / 7);\r\n    }\r\n\r\n    get WW() {\r\n        return this.W.toString().padStart(2, '0');\r\n    }\r\n\r\n    get x() {\r\n        return this.getTime();\r\n    }\r\n\r\n    get X() {\r\n        return Math.floor(this.x / 1000);\r\n    }\r\n\r\n    asJSON() {\r\n        const me = this;\r\n        return {\r\n            YY: me.YY,\r\n            YYYY: me.YYYY,\r\n            M: me.M,\r\n            MM: me.MM,\r\n            MMM: me.MMM,\r\n            MMMM: me.MMMM,\r\n            D: me.D,\r\n            DD: me.DD,\r\n            d: me.d,\r\n            dd: me.dd,\r\n            ddd: me.ddd,\r\n            dddd: me.dddd,\r\n            H: me.H,\r\n            HH: me.HH,\r\n            h: me.h,\r\n            hh: me.hh,\r\n            a: me.a,\r\n            A: me.A,\r\n            m: me.m,\r\n            mm: me.mm,\r\n            s: me.s,\r\n            ss: me.ss,\r\n            SSS: me.SSS,\r\n            Z: me.Z,\r\n            ZZ: me.ZZ,\r\n            Q: me.Q,\r\n            k: me.k,\r\n            kk: me.kk,\r\n            W: me.W,\r\n            WW: me.WW,\r\n            x: me.x,\r\n            X: me.X\r\n        }\r\n    }\r\n\r\n    static monthList(short = false, language = navigator.language, capitalize = true) {\r\n        const tmp = new GSDate();\r\n        tmp.language = language;\r\n        tmp.setDate(1);\r\n        tmp.setMonth(0);\r\n        const days = [];\r\n        let val = null;\r\n        let d = 12;\r\n        while (d--) {\r\n            val = short ? tmp.MMM : tmp.MMMM;\r\n            val = capitalize ? tmp.#capitalize(val) : val;\r\n            days.push(val);\r\n            tmp.setMonth(tmp.getMonth() + 1);\r\n        }\r\n        return days;\r\n    }\r\n\r\n    static dayList(short = false, language = navigator.language, capitalize = true) {\r\n        const tmp = new GSDate();\r\n        tmp.language = language;\r\n        const mondayFirst = tmp.#isMondayFirst();\r\n        const offset = mondayFirst ? 1 : 0;\r\n        tmp.setDate(tmp.getDate() - tmp.getDay() + offset);\r\n        const days = [];\r\n        let val = null;\r\n        let d = 7;\r\n        while (d--) {\r\n            val = short ? tmp.ddd : tmp.dddd;\r\n            val = capitalize ? tmp.#capitalize(val) : val;\r\n            days.push(val);\r\n            tmp.setDate(tmp.getDate() + 1);\r\n        }\r\n        return days;\r\n    }\r\n\r\n    #isMondayFirst() {\r\n        // TODO Firefox does not support it\r\n        return new Intl.Locale(this.#language)?.weekInfo?.firstDay === 1;\r\n    }\r\n\r\n    #capitalize(val = '') {\r\n        return val.charAt(0).toUpperCase() + val.slice(1);\r\n    }\r\n\r\n    #toLocale(opt) {\r\n        return this.toLocaleString(this.#language, opt);\r\n    }\r\n\r\n    #formatHour(size) {\r\n        return (this.getHours() % 12 || 12).toString().padStart(size, '0');\r\n    }\r\n\r\n    #meridiem(isLowercase) {\r\n        const opt = { hour: '2-digit', hour12: true };\r\n        const val = this.#toLocale(opt).split(' ').pop(-1);\r\n        return isLowercase ? val.toLowerCase() : val;\r\n    }\r\n\r\n    #zoneStr() {\r\n        const me = this;\r\n        const negMinutes = -1 * me.getTimezoneOffset();\r\n        const minutes = Math.abs(negMinutes)\r\n        const hourOffset = Math.floor(minutes / 60)\r\n        const minuteOffset = minutes % 60;\r\n\r\n        const seg1 = negMinutes <= 0 ? '+' : '-';\r\n        const seg2 = hourOffset.toString().padStart(2, '0');\r\n        const seg3 = minuteOffset.toString().padStart(2, '0');\r\n\r\n        return `${seg1}${seg2}:${seg3}`;\r\n    }\r\n\r\n    static parse(value, format, language) {\r\n        format = format || GSUtil.getDateFormat(language);\r\n        const regex = GSDate.#getFormattedDateRegex(format);\r\n        return GSDate.#parseFormattedDate(value, regex);\r\n    }\r\n    \r\n    static #getFormattedDateRegex(format) {\r\n        return new RegExp(\r\n            '^\\\\s*' + format.toUpperCase().replaceAll(/([MDY])\\1*/g, '(?<$1>\\\\d+)') + '\\\\s*$'\r\n        );\r\n    }\r\n\r\n    static #parseFormattedDate(value, regex) {\r\n\r\n        const { groups } = value.match(regex) ?? {};\r\n\r\n        if (!groups) return null;\r\n\r\n        const y = Number(groups.Y);\r\n        const m = Number(groups.M);\r\n        const d = Number(groups.D);\r\n\r\n        // Validate range of year and month\r\n        if (y < 1000 || y > 2999) return null;\r\n        if (m < 1 || m > 12) return null;\r\n\r\n        const date = new Date(y, m - 1, d);\r\n\r\n        // Validate day of month exists\r\n        if (d !== date.getDate()) return null;\r\n\r\n        return isNaN(date.valueOf()) ? null : date;\r\n    }\r\n\r\n    /**\r\n     * Check if a year is a leap year\r\n     * @param {number} year \r\n     * @returns {Boolean}\r\n     */\r\n    static isLeapYear(year) {\r\n        return (year % 4 === 0 && year % 100 !== 0) || (year % 400 === 0);\r\n    }\r\n\r\n    static {\r\n        globalThis.GSDate = GSDate;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSData class\r\n * @module base/GSData\r\n */\r\n\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSDate } from \"./GSDate.mjs\";\r\nimport { GSAttr } from \"./GSAttr.mjs\";\r\n\r\n/**\r\n * A set of static functions used for loading resources\r\n * @class\r\n */\r\nexport class GSData {\r\n\r\n    static PROPERTIES = { name: {}, type: {}, format: {}, currency: {}, language: {}, extract: {}, key: { type: Boolean } };\r\n\r\n    /**\r\n     * Removes duplicates from list\r\n     * @param {Array} data \r\n     * @returns {Array}\r\n     */\r\n    static unique(data) {\r\n        return Array.from(new Set(data));\r\n    }\r\n\r\n    static compareArrays = (a, b) => a.length === b.length && a.every((element, index) => element === b[index]);\r\n\r\n    /**\r\n     * Check if two arrays are equal\r\n     * \r\n     * @param {Array} a \r\n     * @param {Array} b \r\n     * @returns {Boolean}\r\n     */\r\n    static arraysEqual(a, b) {\r\n\r\n        if (!Array.isArray(a)) return false;\r\n        if (!Array.isArray(b)) return false;\r\n        if (a === b) return true;\r\n\r\n        a = a.toSorted();\r\n        b = b.toSorted();\r\n\r\n        return GSData.compareArrays(a, b);\r\n    }\r\n\r\n    /**\r\n     * Simple array merge, without duplicates. Used by observableAttributes\r\n     * TODO: improve https://www.geeksforgeeks.org/how-to-convert-array-of-objects-into-unique-array-of-objects-in-javascript/\r\n     * @param {Array} first \r\n     * @param {Array} second \r\n     * @param {Boolean} advanced Used when data is Object instead of string\r\n     * @returns {Array}\r\n     */\r\n    static mergeArrays(first = [], second = [], advanced = false) {\r\n        if (advanced) {\r\n            return [...new Set([...first, ...second].map(JSON.stringify))].map(JSON.parse);\r\n        }\r\n        return [...first, ...second].filter((value, index, arr) => arr.indexOf(value) === index);\r\n    }\r\n\r\n    /**\r\n     * Simple Object merge\r\n     * @param {*} list \r\n     * @returns \r\n     */\r\n    static mergeObjects(list = []) {\r\n        let o = {};\r\n        list.filter(o => o).forEach(it => o = { ...o, ...it });\r\n        return o;\r\n    }\r\n\r\n    /**\r\n     * Convert data to format by given definition.\r\n     * @param {object} cfg {name:'field_name' , type:'date', format:'d/m/y', currency:'eur', language:'hr', extract:'REGEX'}\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    static format(cfg, val) {\r\n\r\n        const type = GSData.#toType(cfg, val);\r\n        const language = cfg.language || GSUtil.language;\r\n        const rule = GSUtil.toRegex(cfg.extract, 'g');\r\n        val = rule ? val.match(rule)[0] : val;\r\n\r\n        // intercept overrides; used b GS-TABLE cell Ui remapping\r\n        if (cfg.childElementCount > 0) {\r\n            const el = cfg.querySelector(`gs-item[value=\"${val}\"]`);\r\n            return GSAttr.get(el, \"map\", val);\r\n        }\r\n\r\n        switch (type) {\r\n            case 'timestamp':\r\n                if (val instanceof Date) return val;\r\n                if (GSUtil.isNumber(val)) return new GSDate(val).format(cfg.format, language);\r\n                if (cfg.format) return GSDate.parse(val, cfg.format, language);\r\n                return Date.parse(val);\r\n            case 'date':\r\n                if (val instanceof Date) return val;\r\n                const fmt = GSUtil.asBool(cfg.format) ? undefined : cfg.format;\r\n                if (GSUtil.isString(val)) return GSDate.parse(val, fmt, language);\r\n                return val && val != 0 ? new GSDate(val).format(fmt, language) : val;\r\n            case 'string':\r\n            case 'text':\r\n                if (val instanceof Date) {\r\n                    const fmt = cfg.format || GSUtil.getDateFormat(language);\r\n                    return new GSDate(val).format(fmt, language);\r\n                };\r\n                break;\r\n            case 'boolean':\r\n                return GSUtil.asBool(val, false);\r\n            case 'number':\r\n                return GSUtil.asNum(val, val, language);\r\n            case 'currency':\r\n                if (GSUtil.isString(val)) val = GSUtil.asNum(val);\r\n                const opt = { style: 'currency', currency: cfg.currency };\r\n                return new Intl.NumberFormat(language, opt).format(val);\r\n        }\r\n\r\n        return val;\r\n    }\r\n\r\n    static #toType(cfg, val) {\r\n        if (cfg.type) return cfg.type;\r\n        if (val instanceof Date) return 'date';\r\n        if (val instanceof Number) return 'number';\r\n        if (val instanceof Boolean) return 'boolean';\r\n        return typeof val;\r\n    }\r\n\r\n    /**\r\n     * Filter array of records \r\n     * @param {Array} data Array of JSON objects or array of array of primitive types\r\n     * @param {Array<object>|String} filter Check filterComplex function for details\r\n     * @param {Array<String>} fields List of Object properties to check, if not set, all are checked\r\n     * @returns {Array}\r\n     */\r\n    static *filter(data = [], filter = [], fields, limit = 0) {\r\n        let cnt = 0;\r\n        let sts = false;\r\n        for (let rec of data) {\r\n            sts = GSData.filterRecord(rec, filter, fields);\r\n            if (sts) {\r\n                cnt++\r\n                yield rec;\r\n            }\r\n            if (limit > 0 && cnt >= limit) break;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Filter array of records \r\n     * @param {Array} data Array of JSON objects or array of array of primitive types\r\n     * @param {Array<object>|String} filter Check filterComplex function for details\r\n     * @param {Array<String>} fields List of Object properties to check, if not set, all are checked\r\n     * @returns {Array}\r\n     */\r\n    static filterData(data = [], filter = [], fields, limit = 0) {\r\n        data = Array.isArray(data) ? data : [data];\r\n        filter = Array.isArray(filter) ? filter : [filter];\r\n        if (filter.length === 0) return data;\r\n        return [...GSData.filter(data, filter, fields, limit)];\r\n    }\r\n\r\n    /**\r\n     * Filter single record to a matchign critheria\r\n     * @param {Array<object>|String} filter Check filterComplex function for details\r\n     * @param {Array} data Array of JSON objects or array of array of primitive types\r\n     * @param {Array<String>} fields List of Object properties to check, if not set, all are checked\r\n     * @returns {Array}\r\n     */\r\n    static filterRecord(rec, filter, fields) {\r\n        const isSimple = GSUtil.isPrimitive(filter);\r\n        return isSimple ? GSData.filterSimple(rec, filter, fields) : GSData.filterComplex(rec, filter, fields);\r\n    }\r\n\r\n    /**\r\n     * Check if JSON object contains a value in any of defined properties\r\n     * @param {Object} rec Json object to check\r\n     * @param {String} filter Value to search for\r\n     * @param {Array<string>} fields List of properties to serach\r\n     * @returns {Boolean} Return true if any of given properties (or all) contains provided value\r\n     */\r\n    static filterSimple(rec, filter = '', fields) {\r\n        filter = filter.toLowerCase();\r\n        fields = fields || Object.keys(rec);\r\n        let value = null;\r\n        for (let key of fields) {\r\n            value = rec[key];\r\n            if (GSData.filterValue(value, filter)) return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Check if object contains data in selected properties\r\n     * @todo Add support for eq,gt,lt,like,or operators\r\n     * @param {Object|Array} rec Json object or array of primitive values to check\r\n     * @param {Array<Object>} filter List of filter objects in format\r\n     *        [{name: idx[num] || name[string], value: ''  , op:'eq'}]\r\n     *        Where:\r\n     *           - name is numeric index only if rec is array of primitive values ([1,'a','b',4]...etc)\r\n     *           - name is string if rec is JSON object\r\n     * @returns {Boolean} Flag indicating if record is matched to a given filter critheria\r\n     */\r\n    static filterComplex(rec, filter, fields) {\r\n\r\n        let primitive = false;\r\n        let found = true;\r\n        let value = null;\r\n\r\n        for (let flt of filter) {\r\n\r\n            primitive = GSUtil.isPrimitive(flt);\r\n            if (primitive) {\r\n                found = found && GSData.filterSimple(rec, flt, fields);\r\n            } else {\r\n                value = rec[flt.name];\r\n                if (flt.name) {\r\n                    found = found && GSData.filterValue(value, flt)\r\n                } else {\r\n                    found = found && GSData.filterSimple(rec, flt.value, fields);\r\n                }\r\n            }\r\n\r\n            if (!found) break;\r\n        }\r\n\r\n        return found;\r\n    }\r\n\r\n    static filterValue(value, filter) {\r\n        const toCheck = GSUtil.isPrimitive(filter) ? filter : filter.value;\r\n        if (GSUtil.isDate(value)) {\r\n            return GSData.matchDate(value, filter);\r\n        } else if (GSUtil.isNumber(value)) {\r\n            return GSData.matchNumber(value, GSUtil.asNum(toCheck, null), filter.op);\r\n        } else {\r\n            return (GSUtil.normalize(value)).toLocaleLowerCase().includes(GSUtil.normalize(toCheck).toLocaleLowerCase());\r\n        }\r\n    }\r\n\r\n    static matchDate(val, filter, language) {\r\n\r\n        if (typeof filter === 'string') {\r\n            const value = '' + filter;\r\n            const local = val.toLocaleDateString(language);\r\n            const iso = val.toISOString();\r\n            return local.includes(value) || iso.includes(value);\r\n        }\r\n\r\n        if (!filter.value) return false;\r\n\r\n        const qry = filter.value instanceof Date ? 'date' : typeof filter.value;\r\n\r\n        switch (qry) {\r\n            case 'number':\r\n                return GSData.matchNumber(val.getTime(), filter.value, filter.op);\r\n            case 'date':\r\n                return GSData.matchNumber(val.getTime(), filter.value.getTime(), filter.op);\r\n        }\r\n\r\n        return GSData.matchDate(val, '' + filter.value, filter.language);\r\n    }\r\n\r\n    /**\r\n     * Match number by operator\r\n     * @param {*} value \r\n     * @param {*} query \r\n     * @param {*} operator \r\n     */\r\n    static matchNumber(value = 0, query = 0, operator = 'eq') {\r\n        switch (operator) {\r\n            case 'gt': return query > value;\r\n            case 'lt': return query < value;\r\n            case 'ge': return query >= value;\r\n            case 'le': return query <= value;\r\n        }\r\n        return value === query;\r\n    }\r\n\r\n    /**\r\n     * Sort data\r\n     * @param {*} data \r\n     * @param {*} sort \r\n     * @returns {Array}\r\n     */\r\n    static sortData(data, sort) {\r\n        if (sort.length === 0) return data;\r\n        return data.toSorted((a, b) => GSData.sortPair(a, b, sort));\r\n    }\r\n\r\n    /**\r\n     * Sort two values, recursion supported\r\n     * @param {*} v1 Array of primitive types or JSON object\r\n     * @param {*} v2 Array of primitive types or JSON object\r\n     * @param {Number} sort -1 | 0 | 1 (descending, as id, ascending )\r\n     * @returns {Number} -1 | 0 | 1\r\n     */\r\n    static sortPair(a, b, sort) {\r\n\r\n        const isArray = Array.isArray(a);\r\n        let sts = 0;\r\n\r\n        sort.forEach((o, i) => {\r\n            if (!o) return;\r\n            const ord = GSUtil.isNumber(o) ? o : o.ord;\r\n            const idx = GSUtil.isNumber(o.col) ? o.col : i;\r\n            const key = isArray ? idx : o.name;\r\n            const v1 = a[key];\r\n            const v2 = b[key];\r\n\r\n            sts = GSData.compare(v1, v2, ord, sts);\r\n        });\r\n\r\n        return sts;\r\n    }\r\n\r\n    /**\r\n     * Compare two values, recursion supported\r\n     * @param {*} v1 \r\n     * @param {*} v2 \r\n     * @param {Number} order -1 | 0 | 1 (descending, as id, ascending )\r\n     * @param {Number} sts previous value\r\n     * @returns {Number} -1 | 0 | 1\r\n     */\r\n    static compare(v1, v2, order, sts) {\r\n        if (GSUtil.isNumber(v1) && GSUtil.isNumber(v2)) {\r\n            return sts || GSData.compareNum(v1, v2, order);\r\n        } else if (GSUtil.isString(v1) || GSUtil.isString(v2)) {\r\n            return sts || GSData.compareString(v1, v2, order);\r\n        } else if (GSUtil.isBool(v1) || GSUtil.isBool(v2)) {\r\n            return sts || GSData.compareBool(v1, v2, order);\r\n        } else if (GSUtil.isDate(v1) || GSUtil.isDate(v2)) {\r\n            return sts || GSData.compareNum(Number(v1), Number(v2), order);\r\n        }\r\n        return sts;\r\n    }\r\n\r\n    /**\r\n     * Safely compare two boolean values\r\n     * @param {Boolean} v1 \r\n     * @param {Boolean} v2 \r\n     * @param {Number} ord \r\n     * @returns {Number} -1 | 0 | 1\r\n     */\r\n    static compareBool(v1, v2, ord) {\r\n        v1 = v1 ? 1 : 0;\r\n        v2 = v2 ? 1 : 0;\r\n        return GSData.compareNum(v1, v2, ord);\r\n    }\r\n\r\n    /**\r\n     * Compare two string values \r\n     * @param {String} v1 \r\n     * @param {String} v2 \r\n     * @param {Number} ord \r\n     * @returns {Number} -1, 1, 0\r\n     */\r\n    static compareString(v1, v2, ord) {\r\n        const s1 = (v1 || '').toString();\r\n        const s2 = (v2 || '').toString();\r\n        return ord < 0 ? s2.localeCompare(s1) : s1.localeCompare(s2);\r\n    }\r\n\r\n    /**\r\n     * Compare two numeric values\r\n     * @param {Number} v1 \r\n     * @param {Number} v2 \r\n     * @param {Number} ord positive = ascending, negative - descending \r\n     * @returns {Number} < 0 or 1 or > 0\r\n     */\r\n    static compareNum(v1, v2, ord) {\r\n        return ord < 0 ? v2 - v1 : v1 - v2;\r\n    }\r\n\r\n    /**\r\n     * Write value to JSON object into structured name.\r\n     * Name subelements are separated by dot (users.name etc.).\r\n     * @param {Object} obj \r\n     * @param {String} name  \r\n     * @param {Boolean} ignoreNull  \r\n     * @param {Object} value \r\n     */\r\n    static writeToObject(obj, name, value, ignoreNull = true) {\r\n        if (ignoreNull && GSUtil.isNull(value)) return;\r\n\r\n        const seg = name.split('.');\r\n        if (seg.length === 1) {\r\n            return GSData.#writeSingleToObject(obj, name, value);\r\n        }\r\n\r\n        const tree = seg.slice(0, -1);\r\n        const key = seg.slice(-1)[0];\r\n\r\n        tree.forEach(v => {\r\n            if (!obj.hasOwnProperty(v)) obj[v] = {};\r\n            obj = obj[v];\r\n        });\r\n\r\n        return GSData.#writeSingleToObject(obj, key, value);\r\n    }\r\n\r\n    static #writeSingleToObject(obj, name, value) {\r\n        if (obj.hasOwnProperty(name)) {\r\n            if (!Array.isArray(obj[name])) {\r\n                obj[name] = [obj[name]];\r\n            }\r\n            if (Array.isArray(value)) {\r\n                obj[name] = obj[name].concat(value);\r\n            } else {\r\n                obj[name].push(value);\r\n            }\r\n        } else {\r\n            obj[name] = value;\r\n        }\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Read object property by supporting arrays\r\n     * name can be plain name or name[idx]\r\n     * @param {*} obj \r\n     * @param {String} name \r\n     * @returns {*}\r\n     */\r\n    static readFromProperty(obj, name, partial = false) {\r\n        if (GSUtil.isNull(obj)) return;\r\n        const r = /\\[\\d+\\]$/g;\r\n        const isArray = r.test(name);\r\n        let n = name;\r\n        let i = '';\r\n\r\n        if (isArray) {\r\n            n = name.replace(r, '')\r\n            i = name.match(r).shift().match(/\\d+/).shift();\r\n            i = GSUtil.asNum(i);\r\n            obj = obj.hasOwnProperty(n) ? obj[n][i] : null;\r\n        } else if (obj.hasOwnProperty(n)) {\r\n            obj = partial ? obj[n] || obj : obj[n];\r\n        } else {\r\n            obj = null;\r\n        }\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Read value from JSON object by structured name.\r\n     * Name subelements are separated by dot (users.name etc.).\r\n     * @param {Object} obj \r\n     * @param {String} name \r\n     * @returns {*}\r\n     */\r\n\tstatic readFromObject(obj, name) {\r\n        if (obj?.hasOwnProperty(name)) return GSData.readFromProperty(obj, name);\r\n\t\treturn name ? name.split('.').reduce((a, v) => GSData.readFromProperty(a, v), obj) : undefined;\r\n\t}\r\n\t\r\n    /**\r\n     * Check if named path exist within the object\r\n     * @param {Object} obj \r\n     * @param {String} name \r\n     * @returns {Boolean}\r\n     */\r\n\tstatic objectPathExist(obj, name) {\r\n        return GSData.readFromObject(obj, name) !== undefined;\r\n\t}\r\n\r\n    /**\r\n     * Create a deep clone of an object\r\n     * @param {Object} obj \r\n     * @returns {Object}\r\n     */\r\n    static deepClone(obj) {\r\n        return JSON.parse(JSON.stringify(obj));\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSData);\r\n        globalThis.GSData = GSData;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDOM class\r\n * @module base/GSDOM\r\n */\r\n\r\nimport { GSAttr } from \"./GSAttr.mjs\";\r\nimport { GSCSSMap } from \"./GSCSSMap.mjs\";\r\nimport { GSData } from \"./GSData.mjs\";\r\nimport { GSLog } from \"./GSLog.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A generic set of static functions to handle DOM tree and DOM elements\r\n * @class\r\n */\r\nexport class GSDOM {\r\n\r\n\tstatic QUERY_FOCUSABLE = \"a[href]:not([tabindex='-1']),area[href]:not([tabindex='-1']),input:not([disabled]):not([tabindex='-1']),select:not([disabled]):not([tabindex='-1']),textarea:not([disabled]):not([tabindex='-1']),button:not([disabled]):not([tabindex='-1']),iframe:not([tabindex='-1']),[tabindex]:not([tabindex='-1']),[contentEditable=true]:not([tabindex='-1'])\";\r\n\tstatic QUERY_INPUT = \"input:not([type='hidden']):not(disabled):not(readonly),select:not([type='hidden']):not(disabled):not(readonly),textarea:not([type='hidden']):not(disabled):not(readonly)\";\r\n\tstatic #FORMEL = ['INPUT', 'SELECT', 'TEXTAREA', 'OUTPUT'];\r\n\t//static #CLEANUP1 = /(\\n*\\t*)*(?=\\n\\t*)/g\r\n\tstatic #CLEANUP1 = /(?:\\n+\\t*)+/g\r\n\r\n\t// Timeout for removing element\r\n\tstatic SPEED = 300;\r\n\r\n\t/**\r\n\t * Find active (focused) element\t\r\n\t * @returns {HTMLElement} Focused element\r\n\t */\r\n\tstatic get activeElement() {\r\n\t\treturn GSDOM.active(document.activeElement);\r\n\t}\r\n\r\n\t/**\r\n\t * Find active (focused) element\r\n\t * @param {HTMLElement} el Starting node\r\n\t * @returns {HTMLElement} Focused element\r\n\t */\r\n\tstatic active(el) {\r\n\t\treturn el.shadowRoot?.activeElement ? GSDOM.active(el.shadowRoot?.activeElement) : el;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if element is visible\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isVisible(el) {\r\n\t\tif (!GSDOM.isHTMLElement(el)) return false;\r\n\t\tconst css = GSCSSMap.getComputedStyledMap(el);\r\n\t\tconst visibility = !css.matches('visibility', 'hidden');\r\n\t\tconst display = !css.matches('display', 'none');\r\n\t\tconst opacity = css.asNum('opacity') > 0;\r\n\t\tconst rect = el.getBoundingClientRect();\r\n\t\tconst size = (rect.width > 0 && rect.height > 0);\r\n\t\treturn size && opacity && visibility && display;\r\n\t}\r\n\r\n\t/**\r\n\t* Parse string into html DOM\r\n\t*\r\n\t* @param {String} html Source to parse\r\n\t* @param {Boolean} single Return first element or all\r\n\t* @param {String} mime Src mime type\r\n\t* @return {HTMLElement}\r\n\t*/\r\n\tstatic parse(html = '', single = false, mime = 'text/html') {\r\n\t\ttry {\r\n\t\t\tconst parser = new DOMParser();\r\n\t\t\tconst doc = parser.parseFromString(html, mime);\r\n\t\t\treturn single ? (doc?.head?.firstElementChild || doc?.body?.firstElementChild) : doc;\r\n\t\t} catch (e) {\r\n\t\t\tGSLog.error(null, e);\r\n\t\t\tthrow e;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Parse source and auto wrap if required\r\n\t * @param {GSElement} own \r\n\t * @param {String} src \r\n\t * @returns {HTMLElement}\r\n\t */\r\n\tstatic parseWrapped(own, src = '', forceWrap = false) {\r\n\r\n\t\tconst doc = GSDOM.parse(src);\r\n\t\tconst head = GSDOM.#fromNode(doc.head.children);\r\n\t\tconst body = GSDOM.#fromNode(doc.body.children);\r\n\r\n\t\tconst nodes = [...head, ...body];\r\n\r\n\t\tconst wrap = forceWrap || nodes.length !== 1;\r\n\r\n\t\tconst tpl = GSDOM.wrap(own, wrap ? null : nodes.shift());\r\n\r\n\t\twhile (nodes.length > 0) tpl.appendChild(nodes.shift());\r\n\r\n\t\treturn tpl;\r\n\t}\r\n\r\n\t/**\r\n\t * The same as link function, with default wrapper element\r\n\t * \r\n\t * @param {HTMLElement} own Owner element to which target is linked\r\n\t * @param {HTMLElement} target Target elemetn to link to owner\r\n\t * @returns {HTMLElement} Return target\r\n\t */\r\n\tstatic wrap(own, target) {\r\n\t\treturn GSDOM.link(own, target || document.createElement('gs-block'));\r\n\t}\r\n\r\n\t/**\r\n\t * Create reference between two HTMLElements\r\n\t * \r\n\t * @param {HTMLElement} own Owner element to which target is linked\r\n\t * @param {HTMLElement} target Target elemetn to link to owner\r\n\t * @returns {HTMLElement} Return target\r\n\t */\r\n\tstatic link(own, target) {\r\n\t\ttarget.setAttribute('proxy', `#${own.id}`);\r\n\t\tif (own.slot) target.setAttribute('slot', own.slot);\r\n\t\treturn target;\r\n\t}\r\n\r\n\tstatic #fromNode(nodes) {\r\n\t\treturn Array.from(nodes || []).filter(el => !GSDOM.isText(el));\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given value is part of HTMLFormElement\r\n\t * @param {string | HTMLElement} el \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isFormElement(el) {\r\n\t\tconst name = GSUtil.isString(el) ? el : el?.tagName;\r\n\t\treturn GSDOM.#FORMEL.includes(name);\r\n\t}\r\n\r\n\t/**\r\n\t * Return all form elements for a given root element\r\n\t * @param {HTMLElement} el \r\n\t * @param {Boolean} shadow \r\n\t * @returns \r\n\t */\r\n\tstatic formElements(el, shadow = false) {\r\n\t\treturn GSDOM.queryAll(el, GSDOM.#FORMEL.map(v => v.toLowerCase()), shadow);\r\n\t}\r\n\r\n\t/**\r\n\t * Check if element is button\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isButtonElement(el) {\r\n\t\treturn (el instanceof HTMLButtonElement)\r\n\t\t\t|| el?.tagName === 'GS-BUTTON'\r\n\t\t\t|| GSDOM.hasClass(el, 'btn');\r\n\t}\r\n\r\n\t/**\r\n\t  * Check if given element is of given type \r\n\t  * \r\n\t  * @param {HTMLElement} el\r\n\t  * @param {String|class} type Tag Name, class name or Class\r\n\t  * @returns {Boolean}\r\n\t  */\r\n\tstatic isElement(el, type) {\r\n\r\n\t\tconst isArgs = type && el;\r\n\t\tif (!isArgs) return false;\r\n\r\n\t\tconst isStr = GSUtil.isString(type);\r\n\r\n\t\tif (!isStr) return el instanceof type;\r\n\r\n\t\tconst ownClazz = customElements.get(type.toLowerCase());\r\n\t\tif (ownClazz && el instanceof ownClazz) return el;\r\n\r\n\t\tconst it = GSDOM.inheritance(el);\r\n\t\tfor (let pel of it) {\r\n\t\t\tif (pel?.constructor?.name === type) return el;\r\n\t\t}\r\n\r\n\t\tif (type.toUpperCase() === el.tagName) return el;\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type HTMLSelectElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isSelect(el) {\r\n\t\treturn el instanceof HTMLSelectElement;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type HTMLSlotElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isSlotElement(el) {\r\n\t\treturn el instanceof HTMLSlotElement;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type HTMLElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isTemplateElement(el) {\r\n\t\treturn el instanceof HTMLTemplateElement;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type HTMLElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isHTMLElement(el) {\r\n\t\treturn el instanceof HTMLElement;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type SVGElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isSVGElement(el) {\r\n\t\treturn el instanceof SVGElement;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type Text\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isText(el) {\r\n\t\treturn el instanceof Text;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type Comment\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isComment(el) {\r\n\t\treturn el instanceof Comment;\r\n\t}\r\n\r\n\t/*\r\n\t * Check if given element is of type GSElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isGSElement(el) {\r\n\t\tif (!el?.clazzName) return false;\r\n\t\tconst it = GSDOM.inheritance(el);\r\n\t\tfor (let v of it) {\r\n\t\t\tif (!v) break;\r\n\t\t\tif (v?.clazzName === 'GSElement') return true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if standard element extended with GS\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isGSExtra(el) {\r\n\t\treturn el?.getAttribute('is')?.indexOf('GS-') === 0;\r\n\t}\r\n\r\n\t/**\r\n\t * Get all child GSElement\t\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Array<HTMLElement>}\r\n\t */\r\n\tstatic getChilds(el) {\r\n\t\treturn Array.from(el?.childNodes || []).filter(e => GSDOM.isGSElement(e));\r\n\t}\r\n\r\n\t/**\r\n\t * Hide html element\r\n\t * @param {HTMLElement} el \r\n\t * @param {Boolean} orientation \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic hide(el, orientation = false) {\r\n\t\treturn el?.classList?.add(orientation ? 'gs-hide-orientation' : 'gs-hide');\r\n\t}\r\n\r\n\t/**\r\n\t * Show html element\r\n\t * @param {HTMLElement} el \r\n\t * @param {Boolean} orientation \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic show(el, orientation = false) {\r\n\t\treturn el?.classList?.remove(orientation ? 'gs-hide-orientation' : 'gs-hide');\r\n\t}\r\n\r\n\t/**\r\n\t * Add node as next in list of nodes\r\n\t * @param {HTMLElement} target \r\n\t * @param {HTMLElement} newEl \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic addSibling(target, newEl) {\r\n\t\tconst injectable = GSDOM.isHTMLElement(newEl) || GSDOM.isSVGElement(newEl);\r\n\t\tconst isOK = GSDOM.isHTMLElement(target) && injectable;\r\n\t\tconst invalid = target === newEl && target.parentNode === newEl || target.nextElementSibling === newEl;\r\n\t\treturn isOK && !invalid ? target.parentNode.insertBefore(newEl, target.nextElementSibling) : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Add child node to a target\r\n\t * @param {HTMLElement} target \r\n\t * @param {HTMLElement} newEl \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic appendChild(target, newEl) {\r\n\t\tconst isok = GSDOM.isHTMLElement(target) && GSDOM.isHTMLElement(newEl);\r\n\t\treturn isok && target !== newEl ? target.appendChild(newEl) : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Add node to a target at specified place\r\n\t * @param {HTMLElement} target \r\n\t * @param {HTMLElement} newEl \r\n\t * @param {String} placement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic insertAdjacent(target, newEl, placement) {\r\n\t\tconst isok = GSDOM.isHTMLElement(target) && GSDOM.isHTMLElement(newEl);\r\n\t\tconst invalid = target === newEl && target.parentNode === newEl\r\n\t\treturn isok && !invalid ? target.insertAdjacentElement(placement, newEl) : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Remove genarated componnt from parent\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic removeElement(el) {\r\n\t\treturn GSDOM.parent(el)?.removeChild(el);\r\n\t}\r\n\r\n\t/**\r\n\t * Walk node tree\r\n\t * \r\n\t * @param {HTMLLegendElement} node Start node to walk from \r\n\t * @param {Boolean} closest Direction down (false) or up (true)\r\n\t * @param {Boolean} all  Filter HTMLElements (false) only or text also (true) (only down)\r\n\t * @param {Boolean} shadow Traverse shadow DOM also (only down)\r\n\t * @returns {Iterable}\r\n\t */\r\n\tstatic walk(node, closest = false, all = false, shadow = true) {\r\n\t\treturn closest ? GSDOM.parentAll(node) : GSDOM.childAll(node, all, shadow);\r\n\t}\r\n\r\n\t/**\r\n\t * Traverse DOM tree top-to-bottom\r\n\t * \r\n\t * @param {*} node Start node\r\n\t * @param {*} all  Include all elements (Text,Comment, HTMLElements)\r\n\t * @param {*} shadow Include traversing across shadow tree\r\n\t * @param {*} child Inernal, do not use\r\n\t * @returns {Iterable}\r\n\t */\r\n\tstatic *childAll(node, all = false, shadow = true, child = false) {\r\n\t\tif (!node) return;\r\n\t\tif (child) yield node;\r\n\t\tif (shadow) yield* GSDOM.childAll(node.shadowRoot, all, shadow, true);\r\n\t\tconst list = all ? node.childNodes : node.children;\r\n\t\tif (!list) return;\r\n\t\tfor (let child of list) {\r\n\t\t\tyield* GSDOM.childAll(child, all, shadow, true);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Get parent element\r\n\t * \r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement}\r\n\t */\r\n\tstatic parent(el) {\r\n\t\treturn el ? (el.parentElement || el.parentNode || el.host) : null;\r\n\t}\r\n\r\n\t/**\r\n\t * Parent element iterator\r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement}\r\n\t * @iterator\r\n\t */\r\n\tstatic *parentAll(el) {\r\n\t\tlet e = GSDOM.parent(el);\r\n\t\twhile (e) {\r\n\t\t\tyield e;\r\n\t\t\te = GSDOM.parent(e);\r\n\t\t}\r\n\t\tif (e) return yield e;\r\n\t}\r\n\r\n\t/**\r\n\t * Element prototype iterator\r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement}\r\n\t * @iterator\r\n\t */\r\n\tstatic *inheritance(el) {\r\n\t\tlet e = el.__proto__;\r\n\t\twhile (e) {\r\n\t\t\tyield e;\r\n\t\t\te = e.__proto__;\r\n\t\t}\r\n\t\tif (e) return yield e;\r\n\t}\r\n\r\n\t/**\r\n\t * Recursively find offsetparent; used in positional offset calculation\r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement}\r\n\t */\r\n\tstatic offsetParent(el) {\r\n\t\tlet offset = el?.offsetParent;\r\n\t\tif (offset) return offset;\r\n\t\tconst it = GSDOM.parentAll(el);\r\n\t\tfor (const c of it) {\r\n\t\t\toffset = c.offsetParent;\r\n\t\t\tif (offset) break;\r\n\t\t}\r\n\t\treturn offset;\r\n\t}\r\n\r\n\t/**\r\n\t * Get root element whch might be shadow root, GSElement, any parent element\r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement|ShadowRoot}\r\n\t */\r\n\tstatic root(el) {\r\n\r\n\t\tif (!el) return null;\r\n\r\n\t\tconst it = GSDOM.parentAll(el);\r\n\t\tfor (let v of it) {\r\n\t\t\tif (v instanceof ShadowRoot) return v;\r\n\t\t\tif (v instanceof HTMLBodyElement) return v;\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * Get WebComponent owning element inside rendered shadow root\r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement}\r\n\t */\r\n\tstatic component(el) {\r\n\t\treturn GSDOM.parent(GSDOM.root(el));\r\n\t}\r\n\r\n\t/**\r\n\t * Get node index between siblings\r\n\t * @param {HTMLElement} node \r\n\t * @returns {Number}\r\n\t */\r\n\tstatic getElementIndex(node) {\r\n\t\tif (!GSDOM.isHTMLElement(node)) return 0;\r\n\t\treturn [...node.parentElement.children].indexOf(node);\r\n\t}\r\n\r\n\t/**\r\n\t * Find element by ID within DOM Tree across Shadow DOM\r\n\t * @param {HTMLElement} el Root node to start from\r\n\t * @param {String} id Element id\r\n\t * @returns {HTMLElement} \r\n\t */\r\n\tstatic getByID(el, id) {\r\n\t\tif (typeof el === 'string') return GSDOM.getByID(document.documentElement, el);\r\n\t\tif (!(el && id)) return null;\r\n\t\tconst it = GSDOM.walk(el, false);\r\n\t\tfor (let o of it) {\r\n\t\t\tif (o.id === id) return o;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * Query DOM Tree up to find closest element across Shadow DOM\r\n\t * @param {HTMLElement} el Root node to start from\r\n\t * @param {String} qry CSS query\r\n\t * @param {Number} level How many levels to walk, 0 = all\r\n\t * @returns {HTMLElement} \r\n\t */\r\n\tstatic closest(el, qry, levels = 0) {\r\n\t\tif (typeof el === 'string') return GSDOM.closest(document.documentElement, qry);\r\n\t\tif (!(el && qry)) return null;\r\n\t\tlevels = GSUtil.asNum(levels, 0);\r\n\t\tconst limit = levels > 0;\r\n\t\tconst it = GSDOM.walk(el, true);\r\n\t\tfor (let o of it) {\r\n\t\t\tif (GSDOM.matches(o, qry)) return o;\r\n\t\t\tif (limit && --levels == 0) return null;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * Query DOM tree with support for Shadow DOM\r\n\t * \r\n\t * @param {HTMLElement} el Root node to start from\r\n\t * @param {String} qry CSS query\r\n\t * @returns {HTMLElement} \r\n\t */\r\n\tstatic query(el, qry, all = false, shadow = true) {\r\n\t\tif (typeof el === 'string') return GSDOM.query(document.documentElement, el, all, shadow);\r\n\t\tif (!(el && qry)) return null;\r\n\t\tif (GSDOM.matches(el, qry)) return GSDOM.#proxy(el);\r\n\t\tconst it = GSDOM.walk(el, false, all, shadow);\r\n\t\tfor (let o of it) {\r\n\t\t\tif (GSDOM.matches(o, qry)) return GSDOM.#proxy(o);\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * Query DOM tree with support for Shadow DOM\r\n\t * \r\n\t * @param {HTMLElement} el Root node to start from\r\n\t * @param {String} qry CSS query\r\n\t * @returns {Array<HTMLElement>}\r\n\t*/\r\n\tstatic queryAll(el, qry, all = false, shadow = true) {\r\n\t\tif (typeof el === 'string') return GSDOM.queryAll(document.documentElement, el, all, shadow);\r\n\t\tconst res = [];\r\n\t\tif (!(el && qry)) return res;\r\n\t\tconst it = GSDOM.walk(el, false, all, shadow);\r\n\t\tfor (let o of it) {\r\n\t\t\tif (GSDOM.matches(o, qry)) res.push(GSDOM.#proxy(o));\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n\r\n\t/**\r\n\t * Overide native to prevent DOM issue when input field name=id\r\n\t * @returns{Proxy}\r\n\t */\r\n\tstatic #proxy(el) {\r\n\t\tif (el.tagName !== 'FORM') return el;\r\n\t\tif (!GSDOM.isHTMLElement(el.id)) return el;\r\n\t\treturn new Proxy(el, {\r\n\t\t\tget: function (target, prop, receiver) {\r\n\t\t\t\tif (prop === '_owner_') return target;\r\n\t\t\t\tif (prop === 'id') return target.getAttribute('id');\r\n\t\t\t\tconst res = Reflect.get(target, prop);\r\n\t\t\t\treturn GSFunction.isFunction(res) ? res.bind(target) : res;\r\n\t\t\t},\r\n\t\t\tset: function (target, prop, value) {\r\n\t\t\t\treturn target[prop] = value;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Match element against CSS query\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} qry \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic matches(el, qry) {\r\n\t\t// return el && qry && typeof el.matches === 'function' && el.matches(qry);\r\n\t\treturn el && typeof el.matches === 'function' && el.matches(qry);\r\n\t}\r\n\r\n\t/**\r\n\t * Set html text to provided element.\r\n\t * NOTE: Done intentionaly like this to prevent source validation warning.\r\n\t *       Use sanitizer when not any more experimental feature;\r\n\t *       Watch for default Sanitizer.getDefaultConfiguration()\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} val \r\n\t * @param {Boolean} sanitize \r\n\t * @param {Sanitizer} sanitizer \r\n\t * @returns {void}\r\n\t */\r\n\tstatic setHTML(el, val = '', sanitize = false, sanitizer) {\r\n\t\tconst isValid = el instanceof ShadowRoot || el instanceof HTMLElement || el instanceof HTMLTemplateElement;\r\n\t\tif (!isValid) return;\r\n\t\tif (sanitize && el?.setHTML) {\r\n\t\t\tsanitizer ? el.setHTML(val, { sanitizer }) : el.setHTML(val);\r\n\t\t} else {\r\n\t\t\tel.innerHTML = val instanceof Document ? val.body.innerHTML : val;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Set text to provided element\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} val \r\n\t * @returns {void}\r\n\t */\r\n\tstatic setText(el, val = '') {\r\n\t\tif (el) el.textContent = val;\r\n\t}\r\n\r\n\t/**\r\n\t * Set style to an element\r\n\t * @param {HTMLElement|string} el \r\n\t * @param {Object} obj \r\n\t */\r\n\tstatic css(el, obj) {\r\n\t\tif (GSUtil.isString(el)) el = GSDOM.queryAll(el);\r\n\t\tif (GSDOM.isHTMLElement(el)) el = [el];\r\n\t\tif (!(Array.isArray(el) && el.length > 0)) return false;\r\n\t\trequestAnimationFrame(() => {\r\n\t\t\tel.forEach(it => {\r\n\t\t\t\tObject.entries(obj).forEach(kv => {\r\n\t\t\t\t\tit.style[kv[0]] = kv[1];\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Safe way to toggle CSS class on element, multipel classes are supported in space separated string list\r\n\t * @param {HTMLElement|string} el \r\n\t * @param {*} val list of css classes in space separated string\r\n\t * @param {Boolean} sts True to add, false to remove\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic toggleClass(el, val, sts) {\r\n\t\tif (GSUtil.isString(el)) el = GSDOM.queryAll(el);\r\n\t\tif (GSDOM.isHTMLElement(el)) el = [el];\r\n\t\tif (!(Array.isArray(el) && el.length > 0)) return false;\r\n\t\tif (!val || val.trim().length == 0) return false;\r\n\t\tval = val.split(' ').filter(v => v && v.trim().length > 0);\r\n\t\tif (GSUtil.isNull(sts)) return val.forEach(v => {\r\n\t\t\tel.forEach(it => it.classList.toggle(v));\r\n\t\t});\r\n\t\tel.forEach(it => {\r\n\t\t\tsts ? it.classList.add.apply(it.classList, val) : it.classList.remove.apply(it.classList, val);\r\n\t\t});\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t * Toggle element visibility\r\n\t * @param {HTMLElement|string} el \r\n\t * @param {Boolean} sts \r\n\t */\r\n\tstatic toggle(el, sts) {\r\n\t\treturn GSDOM.toggleClass(el, 'd-none', GSUtil.isNull(sts) ? sts : !sts);\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if element contains a css class\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic hasClass(el, val = '') {\r\n\t\treturn el?.classList?.contains(val);\r\n\t}\r\n\r\n\t/**\r\n\t * Alternative way to clear fields instead of form.reset()\r\n\t * @param {HTMLElement} owner \r\n\t * @param {String} qry \r\n\t */\r\n\tstatic clearInputs(owner, qry = 'input, textarea, output') {\r\n\t\tconst root = GSDOM.unwrap(owner);\r\n\t\trequestAnimationFrame(() => {\r\n\t\t\troot.querySelectorAll(qry).forEach((el) => el.value = '');\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Get proper value from element\r\n\t * @param {HTMLElement} el \r\n\t * @param {Boolean} defaults Set default value for form reset \r\n\t * @returns {String|Number}\r\n\t */\r\n\tstatic getValue(el, defaults = false) {\r\n\t\tlet val = null;\r\n\t\tswitch (el.type) {\r\n\t\t\tcase 'datetime-local':\r\n\t\t\tcase 'number':\r\n\t\t\t\tval = el.value ? el.valueAsNumber : el.value;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'select-multiple':\r\n\t\t\t\tval = Array.from(el.selectedOptions).map(o => o.value);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'checkbox':\r\n\t\t\t\tif (GSUtil.isStringNonEmpty(el.value)) {\r\n\t\t\t\t\tval = el.checked ? el.value : null;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tval = el.checked;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tval = el.value;\r\n\t\t}\r\n\r\n\t\tif (GSUtil.isNull(val) && defaults) {\r\n\t\t\tval = el.defaultValue;\r\n\t\t}\r\n\t\treturn val;\r\n\t}\r\n\r\n\t/**\r\n\t * Get value from form element\r\n\t * @param {HTMLElement} el \r\n\t * @param {Boolean} defaults Set default value for form reset \r\n\t * @returns {String}\r\n\t */\r\n\tstatic toValue(el, defaults = false) {\r\n\t\tif (!GSDOM.isHTMLElement(el)) return undefined;\r\n\t\tlet value = GSDOM.getValue(el, defaults);\r\n\t\tif ('text' === el.type) {\r\n\t\t\tconst map = GSCSSMap.styleValue(el, 'text-transform');\r\n\t\t\tif (map) value = GSUtil.textTransform(map.value, value);\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\t/**\r\n\t * Set element value, taking chekbox into consideration\r\n\t * @param {HTMLElement} el \r\n\t * @param {String|Boolean|Number} val \r\n\t * @param {Boolean} defaults Set default value for form reset\r\n\t */\r\n\tstatic fromValue(el, val, defaults = false) {\r\n\t\tif (!GSDOM.isHTMLElement(el)) return;\r\n\t\tconst data = Array.isArray(val) ? val[0] || '' : val;\r\n\r\n\t\tswitch (el.type) {\r\n\t\t\tcase 'checkbox':\r\n\t\t\t\tif (GSUtil.isStringNonEmpty(el.value)) {\r\n\t\t\t\t\tel.checked = data === el.value;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tel.checked = data == true;\r\n\t\t\t\t}\r\n\t\t\t\tif (defaults) el.defaultValue = el.checked;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tel.value = GSUtil.normalize(data);\r\n\t\t\t\tif (defaults) el.defaultValue = el.value;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Convert form elements into JSON object\r\n\t * @param {HTMLElement} owner \r\n\t * @param {String} qry \r\n\t * @param {Boolean} invalid Should include invalid fields\r\n\t * @param {Boolean} defaults Set default value for form reset\r\n\t * @returns {Object}\r\n\t */\r\n\tstatic toObject(owner, qry = 'input, textarea, select, output', invalid = true, defaults = false) {\r\n\t\tconst root = GSDOM.unwrap(owner);\r\n\t\tconst params = {};\r\n\t\tGSDOM.queryAll(root, qry)\r\n\t\t\t.filter(el => el.name)\r\n\t\t\t.filter(el => el.dataset.ignore !== 'true')\r\n\t\t\t.filter(el => invalid ? true : el.checkValidity())\r\n\t\t\t.forEach(el => GSDOM.fromElement2Object(el, params, defaults));\r\n\t\treturn params;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON Object into HTMLElements (input)\r\n\t * @param {HTMLElement} owner Root selector (form)\r\n\t * @param {Object} obj Data source key/value pairs\r\n\t * @param {String} qry Element type selector,defaults to form elements \r\n\t * @param {Boolean} defaults Set default value for form reset  \r\n\t * @returns {Object}\r\n\t */\r\n\tstatic fromObject(owner, obj, qry = 'input, textarea, select, output', defaults = false) {\r\n\t\tobj = GSUtil.toJson(obj);\r\n\t\t// if (Object.entries(obj).length === 0) return;\r\n\t\tconst root = GSDOM.unwrap(owner);\r\n\t\tconst list = GSDOM.queryAll(root, qry); // root.querySelectorAll(qry);\r\n\t\tArray.from(list).forEach(el => GSDOM.fromObject2Element(el, obj, defaults));\r\n\t\treturn obj;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON Object into HTMLElement (input)\r\n\t * @param {HTMLElement} owner Element to populate\r\n\t * @param {Object} obj Data source key/value pairs\r\n\t * @param {Boolean} defaults Set default value for form reset\r\n\t */\r\n\tstatic fromObject2Element(el, obj, defaults = false) {\r\n\t\tif (!GSData.objectPathExist(obj, el?.name)) return;\r\n\t\tconst val = GSData.readFromObject(obj, el.name);\r\n\t\tif (el.type !== 'radio') {\r\n\t\t\tGSDOM.fromValue(el, val, defaults);\r\n\t\t} else if (el.value === val) el.checked = true;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert HTMLElement (input) value to JSON Object  \r\n\t * @param {HTMLElement} owner Element value source\r\n\t * @param {Object} obj Object to populate \r\n\t * @param {Boolean} defaults Set default value for form reset\r\n\t */\r\n\tstatic fromElement2Object(el, obj, defaults = false) {\r\n\t\tif (el.type !== 'radio') {\r\n\t\t\t//params[el.name] = GSDOM.toValue(el);\r\n\t\t\tGSData.writeToObject(obj, el.name, GSDOM.toValue(el, defaults));\r\n\t\t} else if (el.checked) {\r\n\t\t\t//params[el.name] = GSDOM.toValue(el);\r\n\t\t\tGSData.writeToObject(obj, el.name, GSDOM.toValue(el, defaults));\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Convert HTMLElement into a JSON object\r\n\t * @param {HTMLElement|Array} own \r\n\t * @param {Boolean} recursive \r\n\t * @param {Boolean} plain  If false, will include #tagName\r\n\t * @param {Object} definitions Json data type definitions\t\r\n\t * @returns {Object}\r\n\t */\r\n\tstatic toJson(own, recursive = true, plain = false, definitions) {\r\n\t\tif (Array.isArray(own)) return own.map(o => GSDOM.toJson(o, recursive,plain,definitions));\r\n\t\tconst obj = {};\r\n\t\tif (!GSDOM.isHTMLElement(own)) return obj;\r\n\r\n\t\tif (!plain) obj['#tagName'] = own.tagName.toLowerCase();\r\n\t\tobj['$text'] = own.innerText;\r\n\r\n\t\t//obj.dataset = Object.assign({}, own.dataset);\r\n\r\n\t\tconst props = definitions || GSDOM.allProperties(own);\r\n\t\tArray.from(own.attributes).forEach(v => {\r\n\t\t\tconst type = props[v.name]?.type;\r\n\t\t\tswitch (type) {\r\n\t\t\t\tcase Boolean:\r\n\t\t\t\t\tobj[v.name] = own.hasAttribute(v.name);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Number:\r\n\t\t\t\t\tobj[v.name] = GSAttr.getAsNum(own, v.name);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tobj[v.name] = v.value;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (recursive) {\r\n\t\t\tconst children = Array.from(own.children).map(el => GSDOM.toJson(el, recursive, plain, definitions));\r\n\t\t\tif (children.length > 0) obj.items = children;\r\n\t\t}\r\n\r\n\t\treturn obj;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON object to DOM/html\r\n\t * @param {Object} obj \r\n\t * @param {Boolean} asString As string or HTMLElement Tree \r\n\t * @param {String} tag \r\n\t */\r\n\tstatic fromJson(obj, tag = 'gs-item', asString = false) {\r\n\t\treturn asString ? GSDOM.fromJsonAsString(obj, tag) : GSDOM.fromJsonAsDOM(obj, tag);\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON object to DOM tree\r\n\t * @param {Object} obj \r\n\t * @param {String} tag \r\n\t * @returns {HTMLElement|Array}\r\n\t */\r\n\tstatic fromJsonAsDOM(obj, tag = 'gs-item') {\r\n\t\tif (!obj) return null;\r\n\r\n\t\tconst isPrimitive = GSUtil.isNumber(obj) || GSUtil.isString(obj);\r\n\t\tif (isPrimitive) return GSDOM.fromJsonAsDOM({ title: obj }, tag);\r\n\r\n\t\tconst isArray = Array.isArray(obj);\r\n\t\tif (isArray) return obj.map(o => GSDOM.fromJsonAsDOM(o, tag));\r\n\r\n\t\tconst name = obj['#tagName'] || tag;\r\n\t\tconst el = document.createElement(name);\r\n\r\n\t\tObject.keys(obj)\r\n\t\t\t.filter(v => v != 'items')\r\n\t\t\t.filter(v => v[0] != '#')\r\n\t\t\t.filter(v => v[0] != '$')\r\n\t\t\t.forEach(v => el.setAttribute(v, obj[v]));\r\n\r\n\t\tif (obj[\"#def\"]) {\r\n\t\t\tel[Symbol.for(\"#def\")] = obj[\"#def\"];\r\n\t\t}\r\n\r\n\t\tif (Array.isArray(obj.items)) {\r\n\t\t\tobj.items.forEach(o => {\r\n\t\t\t\tconst sub = GSDOM.fromJsonAsDOM(o, tag);\r\n\t\t\t\tel.appendChild(sub);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn el;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON object to HTML source\r\n\t * @param {Object} obj \r\n\t * @param {String} tag \r\n\t * @returns {String}\r\n\t */\r\n\tstatic fromJsonAsString(obj, tag = 'gs-item') {\r\n\t\tif (!obj) return null;\r\n\r\n\t\tif (Array.isArray(obj)) return obj.map(o => GSDOM.fromJsonAsString(o)).join('');\r\n\r\n\t\tconst name = obj['#tagName'] || tag;\r\n\t\tconst src = [];\r\n\t\tsrc.push(`<${name} `);\r\n\r\n\t\tObject.keys(obj)\r\n\t\t\t.filter(v => v != 'items')\r\n\t\t\t.filter(v => v[0] != '#')\r\n\t\t\t.filter(v => v[0] != '$')\r\n\t\t\t.forEach(v => src.push(` ${v}=\"${obj[v]}\" `));\r\n\r\n\t\tsrc.push(`>`);\r\n\r\n\t\tif (Array.isArray(obj.items)) {\r\n\t\t\tobj.items.forEach(o => {\r\n\t\t\t\tconst sub = GSDOM.fromJsonAsString(o, tag);\r\n\t\t\t\tsrc.push(sub);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tsrc.push(`</${name}>`);\r\n\r\n\t\treturn src.join('');\r\n\t}\r\n\r\n\t/**\r\n\t * Convert URL hash key/value to form elements\r\n\t * @param {HTMLElement} owner \r\n\t */\r\n\tstatic fromURLHashToForm(owner) {\r\n\t\tlocation.hash.slice(1).split('&')\r\n\t\t\t.filter(v => v.length > 1)\r\n\t\t\t.forEach(v => {\r\n\t\t\t\tconst d = v.split('=');\r\n\t\t\t\tGSDOM.setValue(`input[name=${d[0]}]`, d[1], owner);\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Return element shadowRoot or self\r\n\t * @param {HTMLElement} owner \r\n\t * @returns {HTMLElement|shadowRoot}\r\n\t */\r\n\tstatic unwrap(owner) {\r\n\t\treturn owner ? owner.self || owner : document;\r\n\t}\r\n\r\n\t/**\r\n\t * Enable input on all input elements under provided owner\r\n\t * @param {HTMLElement} own \r\n\t * @param {String} qry Default to form\r\n\t */\r\n\tstatic enableInput(own, qry = 'input, select, textarea, .btn', all = true, group = '') {\r\n\t\tlet list = GSDOM.queryAll(own, qry);\r\n\t\tif (!all && group) list = list.filter(el => GSUtil.asBool(el.dataset[group]))\r\n\t\tlist.forEach(el => el.removeAttribute('disabled'));\r\n\t}\r\n\r\n\t/**\r\n\t * Disable input on all input elements under provided owner\r\n\t * @param {HTMLElement} own \r\n\t * @param {String} qry Default to form\r\n\t */\r\n\tstatic disableInput(own, qry = 'input, select, textarea, .btn', all = true, group = '') {\r\n\t\tGSDOM.queryAll(own, qry)\r\n\t\t\t.filter(el => all ? true : !el.disabled)\r\n\t\t\t.forEach(el => {\r\n\t\t\t\tel.setAttribute('disabled', '');\r\n\t\t\t\tif (group) el.dataset[group] = true;\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Set value to a element by css selector\r\n\t * @param {String} qry \r\n\t * @param {String} val \r\n\t * @param {HTMLElement} own\r\n\t * @param {Boolean} defaults Set default value for form reset \r\n\t */\r\n\tstatic setValue(qry, val, own, defaults = false) {\r\n\t\tconst el = GSDOM.queryAll(own, qry);\r\n\t\tel.forEach(it => GSDOM.fromValue(it, val, defaults));\r\n\t}\r\n\r\n\t/**\r\n\t * Find text nodes\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Array<string>}\r\n\t */\r\n\tstatic textNodesUnder(el) {\r\n\t\tconst walk = document.createTreeWalker(el || document, NodeFilter.SHOW_TEXT, null, false);\r\n\t\tconst a = [];\r\n\t\tlet n;\r\n\t\twhile (n = walk.nextNode()) a.push(n);\r\n\t\treturn a;\r\n\t}\r\n\r\n\t/**\r\n\t * Remove invalid text characters from html element nodes\r\n\t * @param {HTMLElement} root \r\n\t */\r\n\tstatic cleanHTML(root) {\r\n\t\tconst ts = GSDOM.textNodesUnder(root || document).filter(t => t.wholeText.trim().length === 0);\r\n\t\tts.filter(el => el.nextSibling instanceof Text).forEach(el => el.remove());\r\n\t\tts.forEach(t => t.nodeValue = t.wholeText.replaceAll(/\\u0020{4}/g, '\\t').replaceAll(GSDOM.#CLEANUP1, ''));\r\n\t}\r\n\r\n\t/**\r\n\t * Validate against provided list, if child elements allowed inside provided element\r\n\t * @param {HTMLElement} el Element which child list to validate\r\n\t * @param {String} tagName Expected owner element tag name\r\n\t * @param {String} whiteList Uppercase list of tag names allowed as child\r\n\t * @param {String} slotList List of named slots allowed\r\n\t * @param {Boolean} asState return state as bool or throw an error (default)\r\n\t * @returns {Boolean} return true if validation is ok.\r\n\t * @throws {Error}\r\n\t */\r\n\tstatic validate(own, tagName, whiteList, asState = false) {\r\n\t\tif (own.tagName !== tagName) {\r\n\t\t\tif (asState) return false;\r\n\t\t\tthrow new Error(`Owner element : ${own.tagName}, id:${own.id} is not of excpected type: ${tagName}`);\r\n\t\t}\r\n\t\tconst ok = GSDOM.isAllowed(Array.from(own.childNodes), whiteList);\r\n\t\tif (ok) return true;\r\n\t\tif (asState) return false;\r\n\t\tconst msg = GSDOM.toValidationError(own, whiteList);\r\n\t\tthrow new Error(msg);\r\n\t}\r\n\r\n\t/**\r\n\t * Check against provided list, if child elements allowed inside provided element\r\n\t * @param {HTMLElement|Array<HTMLElement>} el Element which childs to validate against provided list\r\n\t * @param {String} whiteList Uppercase list of tag names allowed as child nodes\r\n\t * @param {String} slotList List of elements with named  slots allowed\r\n\t * @returns {Boolean} return tr ue if validation is ok.\r\n\t */\r\n\tstatic isAllowed(el, whiteList) {\r\n\t\tif (Array.isArray(el)) return el.filter(el => GSDOM.isAllowed(el, whiteList)).length === 0;\r\n\t\tconst allowElement = !(el instanceof Text || el instanceof Comment);\r\n\t\tconst allowTag = !whiteList.includes(el.tagName);\r\n\t\treturn allowElement && allowTag;\r\n\t}\r\n\r\n\tstatic toValidationError(own, whiteList) {\r\n\t\tconst list = `<${whiteList.join('>, <')}>`;\r\n\t\treturn `${own.tagName} ID: ${own.id} allows as a child nodes only : ${list}!`;\r\n\t}\r\n\r\n\t/**\r\n\t * Inject css directly into a shadowRoot of an element\r\n\t * \r\n\t * @async\r\n\t * @param {HTMLElement} own \r\n\t * @param {String} url \r\n\t * @returns {Promise<boolean>}\r\n\t */\r\n\tstatic async injectCSS(own, url) {\r\n\t\tif (!own?.shadowRoot instanceof ShadowRoot) return false;\r\n\t\tlet sts = true;\r\n\t\ttry {\r\n\t\t\tconst res = await fetch(url);\r\n\t\t\tif (!res.ok) return;\r\n\t\t\tconst css = await res.text();\r\n\t\t\tconst sheet = new CSSStyleSheet();\r\n\t\t\tsheet.replaceSync(css);\r\n\t\t\town.shadowRoot.adoptedStyleSheets = [sheet];\r\n\t\t} catch (e) {\r\n\t\t\tGSLog.error(null, e);\r\n\t\t\tsts = false;\r\n\t\t}\r\n\t\treturn sts;\r\n\t}\r\n\r\n\t/**\r\n\t * Reset form element\r\n\t * @param {*} element \r\n\t * @returns \r\n\t */\r\n\tstatic reset(element) {\r\n\t\tif(GSDOM.isFormElement(element)) {\r\n\t\t\tif (!GSDOM.resetSelect(element)) {\r\n\t\t\t\telement.dataset.typed = false;\r\n\t\t\t\telement.value = element.defaultValue;\r\n\t\t\t\tGSDOM.#dispatch(element);\r\n\t\t\t\treturn true;\t\r\n\t\t\t}\r\n\t\t} \t\t\r\n\t}\r\n\r\n\t/**\r\n\t * Reset select element to default value\r\n\t * @param {HTMLSelectElement} element \r\n\t */\r\n\tstatic resetSelect(element) {\r\n\t\tif (GSDOM.isSelect(element)) {\r\n\t\t\tArray.from(element.options).forEach(el => el.selected = el.hasAttribute('selected'));\r\n\t\t\tGSDOM.#dispatch(element);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\t\r\n\tstatic #dispatch(element) {\r\n\t\telement.dispatchEvent(new Event('change', { bubbles: true, composed: true }));\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Extract and merge all static properties definition from WebComponent instance\r\n\t * @param {GSElement} obj \r\n\t * @returns {Object}\r\n\t */\r\n\tstatic allProperties(obj) {\r\n\t\tconst list = [...GSDOM.inheritance(obj)].map(o => o.properties).filter(o => o);\r\n\t\tlist.push(obj.constructor?.properties || obj.properties);\r\n\t\treturn GSData.mergeObjects(list);\r\n\t}\r\n\r\n\t/**\r\n\t * Return element template ref\r\n\t * @param {GSElement} host \r\n\t * @returns \r\n\t */\r\n\tstatic templateRef(host) {\r\n\t\tif (!host) return;\r\n\t\tif (host.tagName === 'GS-TEMPLATE') return host.src;\r\n\t\treturn host.template || host.query?.('template', false);\r\n\t}\r\n\t\t\r\n\tstatic {\r\n\t\tObject.seal(GSDOM);\r\n\t\tglobalThis.GSDOM = GSDOM;\r\n\t\tglobalThis.dispatchEvent?.(new CustomEvent('gs-base-ready', {\r\n\t\t\tdetail: {\r\n\t\t\tmessage: 'GS Base is ready',\r\n\t\t\ttime: new Date(),\r\n\t\t\t}\r\n\t\t}));\t\t\r\n\t}\r\n}\r\n\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSEvents class\r\n * @module base/GSEvents\r\n */\r\n\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSID } from \"./GSID.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSLog } from \"./GSLog.mjs\";\r\n\r\n/**\r\n * Class for handling events, also a registry of all GS-* element listeners\r\n * @Class\r\n */\r\nexport class GSEvents {\r\n\r\n\tstatic #rid = 0;\r\n\tstatic #protect = false;\r\n\tstatic #cache = new Map();\r\n\r\n\tstatic #loaded = false;\r\n\tstatic #suspended = 0; // Corrected typo\r\n\r\n\tget altContext() {\r\n\t\treturn GSEvents.#protect;\r\n\t}\r\n\r\n\tset altContext(val) {\r\n\t\tGSEvents.#protect = GSUtil.asBool(val, true);\r\n\t}\r\n\r\n\t/**\r\n\t * Disable browser console and default context menu\r\n\t */\r\n\tstatic protect() {\r\n\t\tGSEvents.listen(globalThis, null, 'contextmenu', GSEvents.#onContext);\r\n\t\tGSEvents.listen(globalThis.document, null, 'keydown', GSEvents.#onKeyDown);\r\n\t}\r\n\r\n\tstatic #onContext(event) {\r\n\t\tif (GSEvents.#protect || !event.shiftKey) GSEvents.prevent(event);\r\n\t}\r\n\r\n\tstatic #onKeyDown(event) {\r\n\t\tconst code = event.code;\r\n\t\tif (code == 'F12') { // Prevent F12\r\n\t\t\treturn false;\r\n\t\t} else if (event.ctrlKey && event.shiftKey && code == 'KeyI') { // Prevent Ctrl+Shift+I\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Wait for web page to completely load, then send event to target element\r\n\t * DOMContentLoaded vs load ?!\r\n\t * @async\r\n\t * @param {HTMLElement} target \r\n\t * @param {String} name \r\n\t * @param {function} callback \r\n\t * @param {Promise<number>} timeout \r\n\t */\r\n\tstatic async waitPageLoad(target, name = 'loaded', callback, timeout = 0, prevent = true) {\r\n\t\tif (!GSEvents.#loaded) {\r\n\t\t\ttry {\r\n\t\t\t\tawait GSEvents.wait(globalThis.window, 'load', timeout, prevent);\r\n\t\t\t\tGSEvents.#loaded = true;\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error('Error waiting for page load:', e); // Improved error handling\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (GSEvents.#loaded) {\r\n\t\t\tawait GSFunction.callFunction(callback);\r\n\t\t\tGSEvents.sendSuspended(target, name);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Async version of event listener\r\n\t * \r\n\t * @async\r\n\t * @param {HTMLElement} own \r\n\t * @param {String} name \r\n\t * @param {Number} timeout  \r\n\t * @param {Boolean} prevent \r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic wait(own, name = '', timeout = 0, prevent = true) {\r\n\t\tif (GSUtil.isStringEmpty(name)) throw new Error('Event undefined!');\r\n\t\tif (!GSUtil.isNumber(timeout)) throw new Error('Invalid timeout value!');\r\n\t\tif (timeout > 0) return GSEvents.once(own, null, name, null, timeout);\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tGSEvents.once(own, null, name, e => {\r\n\t\t\t\tif (prevent) GSEvents.prevent(e);\r\n\t\t\t\tresolve(e);\r\n\t\t\t}, timeout);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Async version of animation frame\r\n\t * \r\n\t * @async\r\n\t * @param {function} callback \r\n\t * @param {Boolean} chaind Prevent consequtive chained calls.\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic async waitAnimationFrame(callback, chained = false) {\r\n\r\n\t\tif (chained) {\r\n\t\t\tif (typeof callback !== 'function') return;\r\n\t\t\tif (GSEvents.#suspended > 0) return GSFunction.callFunction(callback);\r\n\t\t\tGSEvents.#suspended++;\r\n\t\t}\r\n\r\n\t\treturn new Promise((accept, reject) => {\r\n\t\t\trequestAnimationFrame(async () => {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst o = await GSFunction.callFunction(callback);\r\n\t\t\t\t\taccept(o);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\treject(e);\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tif (chained && GSEvents.#suspended > 0) GSEvents.#suspended--;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Listen for an event on a given element or query\r\n\t * @param {*} own \r\n\t * @param {*} qry \r\n\t * @param {*} event \r\n\t * @param {*} callback \r\n\t * @param {*} opt \r\n\t * @returns {boolean|Array<boolean>} \r\n\t */\r\n\tstatic listen(own, qry, event, callback, opt = false) {\r\n\t\tif (!qry && own) return own.addEventListener(event, callback, opt);\r\n\t\treturn GSDOM.queryAll(own, qry).map(el => el.addEventListener(event, callback, opt));\r\n\t}\r\n\r\n\t/**\r\n\t * Unlisten for an event on a given element or query\r\n\t * @param {*} own \r\n\t * @param {*} qry \r\n\t * @param {*} event \r\n\t * @param {*} callback \r\n\t * @returns {boolean|Array<boolean>} \r\n\t */\r\n\tstatic unlisten(own, qry, event, callback) {\r\n\t\tif (!qry && own) return own.removeEventListener(event, callback);\r\n\t\treturn GSDOM.queryAll(own, qry).map(el => el.removeEventListener(event, callback));\r\n\t}\r\n\r\n\tstatic on = GSEvents.listen;\r\n\tstatic off = GSEvents.unlisten;\r\n\r\n\t/**\r\n\t * Wait for an event. Also, trigger on timeout if event not triggered.\r\n\t * @param {HTMLElement} own \r\n\t * @param {String} qry Optional selector within owner\r\n\t * @param {String} event Event name to wait for\r\n\t * @param {*} callback Function to call \r\n\t * @param {Number | AbortSignal} timeout If GT 0, retrun Promise\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic once(own, qry, event, callback, timeout = 0) {\r\n\t\tconst signal = GSEvents.#toSignal(timeout);\r\n\t\tif (signal && signal.internal) {\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tGSEvents.listen(own, qry, event, evt => {\r\n\t\t\t\t\tsignal.removeEventListener('abort', reject);\r\n\t\t\t\t\tcallback?.(evt);\r\n\t\t\t\t\tresolve(evt);\r\n\t\t\t\t}, { once: true, signal: signal });\r\n\t\t\t\tsignal.addEventListener('abort', reject);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn GSEvents.listen(own, qry, event, callback, { once: true, signal: signal });\r\n\t}\r\n\r\n\t/**\r\n\t * Generic prevent event bubling\r\n\t * \r\n\t * @param {Event} e \r\n\t */\r\n\tstatic prevent(e, full = true) {\r\n\t\tif (GSFunction.hasFunction(e, 'preventDefault')) e.preventDefault();\r\n\t\tif (GSFunction.hasFunction(e, 'stopPropagation')) e.stopPropagation();\r\n\t\tif (full && GSFunction.hasFunction(e, 'stopImmediatePropagation')) e.stopImmediatePropagation();\r\n\t}\r\n\r\n\t/**\r\n\t * Generic event disaptcher.\r\n\t * NOTE: If expecting to catch return value, do not use async in listeners\r\n\t * \r\n\t * @param {HTMLElement} sender element that send event\r\n\t * @param {String} name  Event name to trigger \r\n\t * @param {Object} obj Data object to send \r\n\t * @param {Boolean} bubbles Send event to parent\r\n\t * @param {Boolean} composed Send event across shadowDom\r\n\t * @param {Boolean} cancelable Event is cancelable\r\n\t * @returns {Boolean} false if event is cancelable, and at least one of the event handlers which received event called Event.preventDefault(). Otherwise true.\r\n\t */\r\n\tstatic send(sender = document, name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n\t\tif (!GSUtil.isString(name) || name.length === 0) return false;\r\n\t\tconst opt = { detail: obj, bubbles: bubbles, composed: composed, cancelable: cancelable };\r\n\t\tconst event = new CustomEvent(name, opt);\r\n\t\treturn sender?.dispatchEvent(event);\r\n\t}\r\n\r\n\t/**\r\n\t * Convert event type to native event\r\n\t * @param {String} type \r\n\t * @param {Object} opt \r\n\t * @returns {Event}\r\n\t */\r\n\tstatic toEvent(type, opt) {\r\n\t\tlet evt = null;\r\n\t\tswitch (type) {\r\n\t\t\tcase 'copy':\r\n\t\t\tcase 'cut':\r\n\t\t\tcase 'paste':\r\n\t\t\t\tevt = new ClipboardEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'blur':\r\n\t\t\tcase 'focus':\r\n\t\t\tcase 'focusin':\r\n\t\t\tcase 'focusout':\r\n\t\t\t\tevt = new FocusEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'input':\r\n\t\t\tcase 'beforeinput':\r\n\t\t\t\tevt = new InputEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'keydown':\r\n\t\t\tcase 'keyup':\r\n\t\t\tcase 'keypress':\r\n\t\t\t\tevt = new KeyboardEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'dblclick':\r\n\t\t\tcase 'mousedown':\r\n\t\t\tcase 'mouseenter':\r\n\t\t\tcase 'mouseleave':\r\n\t\t\tcase 'mousemove':\r\n\t\t\tcase 'mouseout':\r\n\t\t\tcase 'mouseover':\r\n\t\t\tcase 'mouseup':\r\n\t\t\t\tevt = new MouseEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'submit':\r\n\t\t\t\tevt = new SubmitEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'touchstart':\r\n\t\t\tcase 'touchend':\r\n\t\t\tcase 'touchmove':\r\n\t\t\tcase 'touchcancel':\r\n\t\t\t\tevt = new TouchEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'whell':\r\n\t\t\t\tevt = new WheelEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'pointerover':\r\n\t\t\tcase 'pointerenter':\r\n\t\t\tcase 'pointerdown':\r\n\t\t\tcase 'pointermove':\r\n\t\t\tcase 'pointerup':\r\n\t\t\tcase 'pointercancel':\r\n\t\t\tcase 'pointerout':\r\n\t\t\tcase 'pointerleave':\r\n\t\t\tcase 'pointerrawupdate':\r\n\t\t\tcase 'gotpointercapture':\r\n\t\t\tcase 'lostpointercapture':\r\n\t\t\t\tevt = new PointerEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tevt = new CustomEvent(type, opt);\r\n\t\t}\r\n\t\treturn evt;\r\n\t}\r\n\r\n\t/**\r\n\t * Helper to fix some Firefox issues, detect event\r\n\t * @param {Event} e \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isMouseOrPointerEvent(e) {\r\n\t\treturn e instanceof MouseEvent || e instanceof PointerEvent;\r\n\t}\r\n\r\n\t/** \r\n\t * Generic event disaptcher in suspended rendering\r\n\t * \r\n\t * @param {HTMLElement} sender element that send event\r\n\t * @param {String} name  Event name to trigger\r\n\t * @param {Object} obj Data object to send \r\n\t * @param {Boolean} bubbles Send event to parent\r\n\t * @param {Boolean} composed Send event across shadowDom\r\n\t * @param {Boolean} cancelable Event is cancelable\r\n\t * @returns {void} \r\n\t */\r\n\tstatic sendSuspended(sender = document, name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n\t\treturn requestAnimationFrame(() => {\r\n\t\t\tGSEvents.send(sender, name, obj, bubbles, composed, cancelable);\r\n\t\t});\r\n\t}\r\n\r\n\t/** \r\n\t * Generic event disaptcher delayed in miliseconds\r\n\t * \r\n\t * @param {Number} timeout Time to delay event\r\n\t * @param {HTMLElement} sender element that send event\r\n\t * @param {String} name  Event name to trigger\r\n\t * @param {Object} obj Data object to send \r\n\t * @param {Boolean} bubbles Send event to parent\r\n\t * @param {Boolean} composed Send event across shadowDom\r\n\t * @param {Boolean} cancelable Event is cancelable\r\n\t * @returns {Number} setTimeout id for cancelation\r\n\t */\r\n\tstatic sendDelayed(timeout = 1, sender = document, name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n\t\treturn setTimeout(() => GSEvents.send(sender, name, obj, bubbles, composed, cancelable), timeout);\r\n\t}\r\n\r\n\t/**\r\n\t* Generic event listener appender\r\n\t * @param {HTMLElement} own Event owner\r\n\t * @param {HTMLElement} el Owner element to monitor\r\n\t * @param {String} name Event name to monitor\r\n\t * @param {Function} fn Callback to trigger on event\r\n\t * @param {Boolean} once Monitor event only once\r\n\t * @param {Boolean} capture Allow event capture\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic attach(own, el, name = '', fn, once = false, capture = false) {\r\n\t\tif (!el) return false;\r\n\t\tif (!(window instanceof Window || el.isConnected)) return false;\r\n\t\tif (!GSFunction.isFunction(fn)) return false;\r\n\t\tif (!GSFunction.hasFunction(el, 'addEventListener')) return false;\r\n\t\tconst me = this;\r\n\t\tconst obj = me.#eventKey(own, el, name, fn);\r\n\t\tconst elmap = me.#getElementMap(own);\r\n\t\tconst map = me.#eventMap(elmap, obj.key);\r\n\t\tmap.set(obj.fnkey, obj);\r\n\t\tobj.capture = capture;\r\n\t\tif (once) {\r\n\t\t\tobj.once = (e) => {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tobj.fn(e);\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tme.remove(obj.own, obj.el, obj.name, obj.once);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tObject.defineProperty(obj.once, 'gsid', { value: fn.gsid, writable: false });\r\n\t\t}\r\n\t\tel.addEventListener(name, once ? obj.once : obj.fn, { once: once, capture: capture });\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t* Generic event listener remover\r\n\t * @param {HTMLElement} own Event owner\r\n\t * @param {HTMLElement} el Owner element to monitor\r\n\t * @param {String} name Event name to moinitor\r\n\t * @param {Function} fn Callback to trigger on event\r\n\t */\r\n\tstatic remove(own, el, name = '', fn) {\r\n\t\tconst me = this;\r\n\t\tconst obj = me.#eventKey(own, el, name, fn);\r\n\t\tconst elmap = me.#getElementMap(own);\r\n\t\tconst map = me.#eventMap(elmap, obj.key);\r\n\t\tconst cfg = map.get(obj.fnkey);\r\n\t\tif (cfg) {\r\n\t\t\tmap.delete(cfg.fnkey);\r\n\t\t\tme.#removeListener(cfg);\r\n\t\t} else if (obj.fnkey === obj.key) {\r\n\t\t\tfor (let m of map.values()) {\r\n\t\t\t\tmap.delete(m.fnkey);\r\n\t\t\t\tme.#removeListener(m);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (map.size === 0) elmap.delete(obj.key);\r\n\t\tif (elmap.size === 0) me.#cache.delete(own);\r\n\t}\r\n\r\n\t/**\r\n\t * Release internal engine event listeners\r\n\t * @param {HTMLElement} own Event owner\r\n\t */\r\n\tstatic detachListeners(own) {\r\n\t\tconst me = this;\r\n\t\tconst map = me.#removeElementMap(own);\r\n\t\tif (!map) return;\r\n\r\n\t\tconst it = map.values();\r\n\t\tfor (let m of it) {\r\n\t\t\tfor (let o of m.values()) {\r\n\t\t\t\tme.#removeListener(o);\r\n\t\t\t}\r\n\t\t\tm.clear();\r\n\t\t}\r\n\t\tmap.clear();\r\n\t}\r\n\r\n\t/**\r\n\t * Generate an event key object\r\n\t * @param {*} el \r\n\t * @param {*} name \r\n\t * @param {*} fn \r\n\t * @returns {Object}\r\n\t */\r\n\tstatic #eventKey(own, el, name = '', fn = '') {\r\n\t\tif (!el) return false;\r\n\t\tconst me = this;\r\n\t\tconst elid = me.#getElementID(el);\r\n\t\tconst fnid = me.#getCallbackID(fn);\r\n\t\tconst key = GSID.hashCode(`${elid}${name}`);\r\n\t\tconst fnkey = GSID.hashCode(`${elid}${name}${fnid || ''}`);\r\n\t\treturn { own: own, fn: fn, el: el, name: name, key: key, fnkey: fnkey };\r\n\t}\r\n\r\n\t/**\r\n\t * Get or create a map holding an event map\r\n\t * @param {Map<HTMLElement, Object>} elmap\r\n\t * @param {HTMLElement} key\r\n\t * @returns {Map<HTMLElement, Object>}\r\n\t */\r\n\tstatic #eventMap(elmap, key) {\r\n\t\tconst me = this;\r\n\t\tlet map = elmap.get(key);\r\n\t\tif (!map) {\r\n\t\t\tmap = new Map();\r\n\t\t\telmap.set(key, map);\r\n\t\t}\r\n\t\treturn map;\r\n\t}\r\n\r\n\tstatic #getCallbackID(fn) {\r\n\t\tif (!GSFunction.isFunction(fn)) return null;\r\n\t\tif (!fn.gsid) Object.defineProperty(fn, 'gsid', { value: GSID.next(), writable: false });\r\n\t\treturn fn.gsid;\r\n\t}\r\n\r\n\tstatic #getElementID(el) {\r\n\t\tlet elid = el[Symbol.for('gs-event-id')];\r\n\t\tif (!elid) {\r\n\t\t\telid = GSID.id;\r\n\t\t\tel[Symbol.for('gs-event-id')] = elid;\r\n\t\t}\r\n\t\treturn elid;\r\n\t}\r\n\r\n\t/**\r\n\t * Get or create a map holding an event map\r\n\t * @param {HTMLElement} own\r\n\t * @returns {Map<HTMLElement, Object>}\r\n\t */\r\n\tstatic #getElementMap(own) {\r\n\t\tconst me = this;\r\n\t\treturn me.#eventMap(me.#cache, own);\r\n\t}\r\n\r\n\tstatic #removeElementMap(own) {\r\n\t\tconst me = this;\r\n\t\tconst map = me.#cache.get(own);\r\n\t\tif (!map) return;\r\n\t\tme.#cache.delete(own);\r\n\t\treturn map;\r\n\t}\r\n\r\n\tstatic #removeListener(o) {\r\n\t\to.el.removeEventListener(o.name, o.once ? o.once : o.fn, { capture: o.capture });\r\n\t\to.el = null;\r\n\t\to.fn = null;\r\n\t\to.once = null;\r\n\t}\r\n\r\n\t/**\r\n\t * Internal helper, converter to Abortignal\r\n\t * @param {*} timeout \r\n\t */\r\n\tstatic #toSignal(timeout = 0) {\r\n\t\tif (GSUtil.isNumber(timeout) && timeout > 0) {\r\n\t\t\ttimeout = AbortSignal.timeout(timeout);\r\n\t\t\ttimeout.internal = true;\r\n\t\t\treturn timeout;\r\n\t\t}\r\n\t\tif (timeout instanceof AbortSignal) return timeout;\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\t/**\r\n\t * Monitor GSElement 'action' events and trigger class functions if available.\r\n\t * @param {HTMLElement} owner \r\n\t * @param {String} type \r\n\t */\r\n\tstatic monitorAction(owner, type) {\r\n\t\towner.on('action', (e) => {\r\n\t\t\tconst me = owner;\r\n\t\t\tconst data = e.detail;\r\n\t\t\tconst action = GSUtil.isString(data) ? data : data.action || data.data?.action;\r\n\t\t\tGSEvents.onAction(me, action, type, e);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Trigger class function defined in 'action' attribute\r\n\t * @param {HTMLElement} owner \r\n\t * @param {String} action \r\n\t * @param {String} prefix \r\n\t * @param {Event} evt \r\n\t * @returns {*} Action result or false\r\n\t */\r\n\tstatic async onAction(owner, action, prefix, evt) {\r\n\r\n\t\tconst callback = GSEvents.findAction(owner, action, prefix);\r\n\t\tif (!callback) return;\r\n\r\n\t\tGSEvents.prevent(evt);\r\n\t\tlet sts = false;\r\n\t\ttry {\r\n\t\t\tif (GSFunction.isFunctionAsync(callback)) {\r\n\t\t\t\tsts = await callback(evt);\r\n\t\t\t} else {\r\n\t\t\t\tsts = callback(evt);\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tsts = e;\r\n\t\t\tif (!GSFunction.isFunction(owner.onError)) throw e;\r\n\t\t\towner.onError(e);\r\n\t\t}\r\n\t\treturn sts;\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Find object instance action by name\r\n\t * @param {Object} owner \r\n\t * @param {String} action \r\n\t * @returns {Function}\r\n\t */\r\n\tstatic findAction(owner, action = '', prefix = '') {\r\n\t\tlet sts = false;\r\n\t\tif (!action) return sts;\r\n\t\tconst me = owner;\r\n\t\taction = GSUtil.capitalizeAttr(GSUtil.capitalize(action));\r\n\t\tprefix = GSUtil.capitalizeAttr(GSUtil.capitalize(prefix));\r\n\t\tconst name = `on${prefix}${action}`;\r\n\t\tif (globalThis.GS_LOG_ACTION) GSLog.warn(owner, `Action : ${name}`);\r\n\t\tconst fn = me[name];\r\n\t\tsts = GSFunction.isFunction(fn);\r\n\t\tsts = sts && !GSFunction.isFunctionNative(fn);\r\n\t\treturn sts ? me[name].bind(me) : null\r\n\t}\r\n\r\n\tstatic #onResize() {\r\n\t\tclearTimeout(GSEvents.#rid);\t\t\t\r\n\t\tGSEvents.#rid = setTimeout(async () => {\r\n\t\t\tawait GSEvents.waitAnimationFrame();\r\n\t\t\tGSEvents.send(window, 'resized');\r\n\t\t}, 100);\r\n\t}\r\n\r\n\t/**\r\n\t * Helper tool to notify when window resized. \r\n\t * Can be activated only once.\r\n\t * Trigger 'resized' event on window on resize timeout.\r\n\t */\r\n\tstatic resizeMonitor() {\r\n\t\tconst me = GSEvents;\r\n\t\tconst own = document.documentElement;\r\n\t\tconst obj = me.#eventKey(own, window, 'resize', me.#onResize);\r\n\t\tconst elmap = me.#getElementMap(own);\r\n\t\tconst def = elmap.get(obj.key)?.get(obj.fnkey);\r\n\t\tif (!def) me.attach(own, window, 'resize', me.#onResize);\r\n\t}\r\n\r\n\tstatic {\r\n\t\t//GSEvents.resizeMonitor();\r\n\t\tObject.freeze(GSEvents);\r\n\t\tglobalThis.GSEvents = GSEvents;\r\n\t\tGSEvents.waitPageLoad();\r\n\t}\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\nimport { GSEvents } from \"./GSEvents.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n\r\n/**\r\n * A module loading GSAbortController class\r\n * @module base/GSAbortController\r\n */\r\n\r\n/**\r\n * Extend native AbortController with timeout \r\n * @class\r\n */\r\nexport class GSAbortController extends AbortController {\r\n\r\n    #iid = 0;\r\n\r\n    constructor(timeout = 0) {\r\n        super();\r\n        if (!GSUtil.isNumber(timeout)) throw new Error('Timeout parameter must be number');\r\n        const me = this;\r\n        if (timeout) me.#iid = setTimeout(me.abort.bind(me), timeout);\r\n        me.signal.addEventListener('abort', () => clearInterval(me.#iid));\r\n    }\r\n\r\n    wait(timeout = 0) {\r\n        return GSEvents.wait(this.signal, 'abort', timeout);\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSLog } from \"./GSLog.mjs\";\r\n\r\n/**\r\n * A module loading GSDOMObserver class\r\n * @module base/GSDOMObserver\r\n */\r\n\r\n/**\r\n * Generic HTMLElement node add/remove from DOM tree.\r\n * This Class accepts filter/callback function registration\r\n * as creation of independent observers for each Shadow DOM.\r\n * NOTE: Shadow dom must have independent observers!!!\r\n * Mostly used for dynamic attaching events to the elements not extended with is=\"gs-*\"\r\n * @class\r\n * @extends MutationObserver\r\n */\r\nexport class GSDOMObserver extends MutationObserver {\r\n\r\n    static #filtersAdd = new Map();\r\n    static #filtersDel = new Map();\r\n\r\n    /**\r\n     * Observe element for insertion / deletion\r\n     * @param {HTMLElement} el A HTMLElement instance to observe for child changes\r\n     * @param {Object} opt A JSON configuration object\r\n     * @returns {Boolean} A status of successful observer registration\r\n     */\r\n    observe(el, opt) {\r\n        const cfg = opt || { childList: true, subtree: true };\r\n        return super.observe(el, cfg);\r\n    }\r\n\r\n    /**\r\n     * Create a new observer instance for given root element\r\n     * @param {HTMLElement} el An element to monitor for changes \r\n     * @param {Object} opt A JSON configuration object\r\n     * @returns {GSDOMObserver}\r\n     */\r\n    static create(el, opt) {\r\n        const observer = new GSDOMObserver(GSDOMObserver.#onObserve);\r\n        observer.observe(el, opt);\r\n        return observer;\r\n    }\r\n\r\n    /**\r\n     * Get add or remove filter\r\n     * @param {Boolean} forRemove If \"true\", return injection filter functions, else removal functions\r\n     * @returns {Map<Function, Function>} Returns map of filter functions\r\n     */\r\n    static #getFilter(forRemove = false) {\r\n        return forRemove ? GSDOMObserver.#filtersDel : GSDOMObserver.#filtersAdd;\r\n    }\r\n\r\n    /**\r\n     * Is there any filter registered\r\n     */\r\n    static get #hasFilters() {\r\n        return GSDOMObserver.#hasFiltersAdd || GSDOMObserver.#hasFiltersDel;\r\n    }\r\n\r\n    static get #hasFiltersAdd() {\r\n        return GSDOMObserver.#filtersAdd.size > 0;\r\n    }\r\n\r\n    static get #hasFiltersDel() {\r\n        return GSDOMObserver.#filtersDel.size > 0;\r\n    }\r\n\r\n    /**\r\n     * Observer callback to filter elements\r\n     * @param {*} mutations \r\n     */\r\n    static #onObserve(mutations) {\r\n        if (!GSDOMObserver.#hasFilters) return;\r\n        mutations.forEach((mutation) => {\r\n            if (GSDOMObserver.#hasFiltersAdd) mutation.addedNodes.forEach(el => GSDOMObserver.#walk(el, GSDOMObserver.#filtersAdd));\r\n            if (GSDOMObserver.#hasFiltersDel) mutation.removedNodes.forEach(el => GSDOMObserver.#walk(el, GSDOMObserver.#filtersDel));\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Walk node tree\r\n     * @param {HTMLElement} rootEL node root\r\n     * @param {Map} filters\r\n     * @returns {Boolean} \r\n     */\r\n    static #walk(rootEL, filters) {\r\n        if (filters.size === 0) return false;\r\n        GSDOMObserver.#parse(rootEL, filters);\r\n        rootEL.childNodes.forEach(el => GSDOMObserver.#walk(el, filters));\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Call filter and callback function if node accepted\r\n     * @param {HTMLElement} el node root\r\n     * @param {Map} filters\r\n     * @returns {void}\r\n     */\r\n    static #parse(el, filters) {\r\n        filters.forEach((v, k) => {\r\n            try {\r\n                if (k(el)) v(el);\r\n            } catch (e) {\r\n                GSLog.error(null, e);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Execute observer logic \r\n     * \r\n     * @param {HTMLElement} el node root\r\n     * @param {Function} filter function to filter nodes\r\n     * @param {Function} callback function to be called on selected node\r\n     * \r\n     * @returns {Boolean}\r\n     */\r\n    static #exec(el, filter, callback) {\r\n        if (el instanceof HTMLElement == false) return false;\r\n        const tmp = new Map();\r\n        tmp.set(filter, callback);\r\n        return GSDOMObserver.#walk(el, tmp);\r\n    }\r\n\r\n    /**\r\n     * Check if parameter is function\r\n     * @param {function} fn \r\n     * @returns {Boolean} true if parameter is function type\r\n     */\r\n    static #isFunction(fn) {\r\n        return typeof fn === 'function';\r\n    }\r\n\r\n    /**\r\n     * Check if registration functions are valid\r\n     * @param {Function} filter function to filter nodes\r\n     * @param {Function} callback function to be called on selected node\r\n     * @returns {Boolean}\r\n     */\r\n    static #isFunctions(filter, callback) {\r\n        return GSDOMObserver.#isFunction(filter) && GSDOMObserver.#isFunction(callback);\r\n    }\r\n\r\n    /**\r\n     * Register element filter\r\n     * \r\n     * @param {Function} filter - filter function returns true\r\n     * @param {Function} callback - result function\r\n     * @param {Boolean} forRemove - call on node remove or add\r\n     * @param {HTMLElement} target - element to monitor\r\n     * @returns {Boolean} Returns true if filter registered\r\n     */\r\n    static registerFilter(filter, callback, forRemove = false, target) {\r\n\r\n        if (!GSDOMObserver.#isFunctions(filter, callback)) return false;\r\n\r\n        GSDOMObserver.#getFilter(forRemove).set(filter, callback);\r\n\r\n        // initially loaded does not trigger \r\n        if (!forRemove) GSDOMObserver.#exec(target || document.body, filter, callback);\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Unregister element filter\r\n     * \r\n     * @param {Function} fn Filter function\r\n     * @param {Boolean} forRemove Call on node remove or add\r\n     * \r\n     * @returns {Boolean} Returns true if unregistered\r\n     */\r\n    static unregisterFilter(fn, forRemove = false) {\r\n        return GSDOMObserver.#isFunction(fn) ? GSDOMObserver.#getFilter(forRemove).delete(fn) : false;\r\n    }\r\n\r\n    /**\r\n     * Static constructor with default body monitoring\r\n     */\r\n    static {\r\n        Object.freeze(GSDOMObserver);\r\n        globalThis.GSDOMObserver = GSDOMObserver;\r\n        GSDOMObserver.create(document.documentElement);\r\n    }\r\n\r\n}\r\n\r\n\r\n/*\r\nGSDOMObserver.registerFilter((el)=>{ return el.tagName ==='DIV'}, (el) => {\r\n    console.log(el);\r\n});\r\n*/\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSID } from \"./GSID.mjs\";\r\n\r\n/**\r\n * A dynamic CSSStyleSheet used for dynamic programmable changed\r\n * css classes attached to a WebComponent html template elements.\r\n * Programmatically changing dynamic class elements will not reflect \r\n * element style properties.\r\n */\r\nexport class GSDynamicStyle extends CSSStyleSheet {\r\n\r\n    /**\r\n     * Constructor for DynamicStlye\r\n     * @param {String} id Unique name for easier filtering  \r\n     */\r\n    constructor(id = 'dynamic') {\r\n        super();\r\n        this.id = id || GSID.id;\r\n    }\r\n\r\n\t/**\r\n\t * Remove dynamic element rule\r\n\t * @param {String} id  \r\n\t */\r\n\tdeleteRule(id = '') {\r\n        const me = this;\r\n\t\tArray.from(me.cssRules)\r\n\t\t\t.map((v, i) => v.selectorText === `.${id}` ? i : -1)\r\n\t\t\t.filter(v => v > -1)\r\n\t\t\t.forEach(v => me.deleteRule(v));\r\n\t}    \r\n\r\n    /**\r\n     * Get individual rule from dynamic styles cache\r\n     * @param {String} id CSS class name\r\n     * @returns {CSSRule} \r\n     */\r\n    getRule(id = '') {\r\n        return Array.from(this.cssRules).filter(v => v.selectorText === `.${id}`).pop();\r\n    }\r\n\r\n    /**\r\n     * Set dynamic element rule. Accepts string or json object representation\r\n     * @param {String} id Unique css class name used\r\n     * @param {string|object} style CSS style properties to apply\r\n     */\r\n    setRule(id, style = '', sync = false) {\r\n\r\n        const me = this;\r\n\r\n        if (!id) return;\r\n\r\n\t\tlet rule = me.getRule(id);\r\n\t\tif (!rule) {\r\n\t\t\tme.insertRule(`.${id} {}`);\r\n\t\t\treturn me.setRule(id, style, sync);\r\n\t\t}        \r\n\r\n        if (!style) return rule;\r\n\r\n        let data = [];\r\n        if (typeof style === 'string') {\r\n            data = style.replaceAll('\\n', '').split(';').map(v => v.trim().split(':')).filter(v => v.length === 2);\r\n        } else {\r\n            data = Object.entries(style);\r\n        }\r\n\r\n        if (sync) {\r\n            data.forEach(kv => me.#updateRule(rule, kv[0], kv[1]));\r\n        } else {\r\n            requestAnimationFrame(() => {\r\n                data.forEach(kv => me.#updateRule(rule, kv[0], kv[1]));\r\n            });\r\n        }\r\n\r\n        return rule;\r\n    }\r\n\r\n    #updateRule(rule, prop = '', style = '') {\r\n        style = (style || '').toString();\r\n        const isImportant = style.includes('!important');\r\n        style = style.replace('!important', '');\r\n        prop = prop.trim();\r\n        rule.style.setProperty(prop, style, isImportant ? 'important' : '');\r\n    }\r\n\r\n    /**\r\n     * Find element dynamic style attached. \r\n     * Will search for a StyleSheet within element shadow addoptedStyleSheet by element data-sheet property.\r\n     * @param {HTMLElement} source A html element continaing dynamically injected html style\r\n     * @returns {CSSStyleSheet} An instance of dynamic stylesheet containing dynamic rules\r\n     */\r\n\tstatic dynamicStyleSheet(source) {\r\n\t\t// find shadow root (or document)\r\n\t\tconst root = GSDOM.root(source);\r\n        const id = source.dataset.sheet || 'dynamic';\r\n\t\t// find custom; dynamic style\r\n\t\treturn GSDynamicStyle.dynamicStyleSheetByID(root, id);\r\n\t}\r\n\r\n    /**\r\n     * Fnd custom dynamic style\r\n     * @param {Document} root Document or shadowDom\r\n     * @param {String} id Dynamic CSS name\r\n     * @returns {CSSStyleSheet} An instance of dynamic stylesheet containing dynamic rules\r\n     */\r\n    static dynamicStyleSheetByID(root, id) {\r\n\t\treturn Array.from(root?.adoptedStyleSheets).filter(el => el.id === id).pop();\r\n    }\r\n\r\n\t/**\r\n\t * Find dynamic style & rule for element\r\n\t * @param {HTMLElement} source A html element with dynamic style attached  (with data-gs-class attribute set)\r\n\t * @returns {CSSStyleRule} Instance of dynamic css class \r\n\t */\r\n\tstatic dynamicRule(source) {\r\n\t\tconst style = GSDynamicStyle.dynamicStyleSheet(source);\r\n\t\treturn style?.getRule(source.dataset.gsClass);\t\t\r\n\t}\r\n\r\n    /**\r\n     * Fnd custom dynamic rule\r\n     * @param {Document} root Document or shadowDom\r\n     * @param {String} id Dynamic CSS name\r\n    * @returns {CSSStyleRule} Instance of dynamic css class \r\n     */    \r\n    static dynamicRuleByID(root, id) {\r\n        const style = GSDynamicStyle.dynamicStyleSheetByID(root, 'dynamic');\r\n        return style?.getRule(id);\r\n    }\r\n\r\n    /**\r\n     * Find element dynamic style\r\n     * @param {HTMLElement} source \r\n     * @returns {CSSStyle} Element dynamic style or default style if dynamic not defined\r\n     */\r\n\tstatic dynamicStyle(source) {\r\n\t\tconst rule = GSDynamicStyle.dynamicRule(source);\r\n\t\treturn rule?.style; // || source.style;\r\n\t}\r\n\r\n    /**\r\n     * Find element dynamic style\r\n     * @param {Document} source Document or shadowDOM\r\n     * @returns {CSSStyle} Element dynamic style or default style if dynamic not defined\r\n     */\r\n\tstatic dynamicStyleByID(root, id) {\r\n\t\tconst rule = GSDynamicStyle.dynamicRuleByID(root, id);\r\n\t\treturn rule?.style; // || source.style;\r\n\t}\r\n\r\n    /**\r\n     * Apply CSS properties to the element style.\r\n     * Will search for a StyleSheet within element shadow addoptedStyleSheet by element data-gs-class property.\r\n     * @param {HTMLElement} source Element with dynamic style attached (with data-gs-class attribute set)\r\n     * @param {Object} opt A JSON object of css arguments to apply \r\n     * @returns {CSSStyle} A copy of modifid CSSStyle object \r\n     */\r\n\tstatic applyDynamicStyle(source, opt) {\r\n        requestAnimationFrame(() => {\r\n            const style = GSDynamicStyle.dynamicStyle(source);\r\n            return Object.assign(style, opt);\r\n        });\r\n\t}\r\n    \r\n    /**\r\n     * \r\n     * @param {Document || ShadowRoot} root Element with dynamic style attached\r\n     * @param {String} id Dynamic CSS style name\r\n     * @param {Object} opt A JSON object of css arguments to apply \r\n     * @returns {CSSStyle} A copy of modifid CSSStyle object \r\n     */\r\n\tstatic applyDynamicStyleByID(root, id, opt) {\r\n        requestAnimationFrame(() => {\r\n            const style = GSDynamicStyle.dynamicStyleByID(root, id);\r\n            return Object.assign(style, opt);\r\n        });\r\n\t}     \r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSCacheStyles class\r\n * @module head/GSCacheStyles\r\n */\r\n\r\nimport { GSDynamicStyle } from \"./GSDynamicStyle.mjs\";\r\nimport { GSID } from \"./GSID.mjs\";\r\nimport { GSLog } from \"./GSLog.mjs\";\r\n\r\nimport { gsstyles } from \"./style.mjs\";\r\n\r\n/**\r\n * Cache for dynamically loaded styles.\r\n * Used to share styles among GS-* WebComponents\r\n * @class\r\n */\r\nexport class GSCacheStyles {\r\n\r\n\tstatic #store = new Map();\r\n\r\n\t/**\r\n\t * Create a new CSSStyleSheet\r\n\t * @param {String} id Unique ID\r\n\t * @returns {CSSStyleSheet} Created instance\r\n\t */\r\n\tstatic create(id) {\r\n\t\tconst sheet = new GSDynamicStyle(id);\r\n\t\tthis.#store.set(id, sheet);\r\n\t\treturn sheet;\r\n\t}\r\n\r\n\t/**\r\n\t * Store initialized stylesheet under the unique ID\r\n\t * @param {String} id \r\n\t * @param {CSSStyleSheet} style \r\n\t * @returns {CSSStyleSheet} Stored stylesheet\r\n\t */\r\n\tstatic set(id, style) {\r\n\r\n\t\tconst me = this;\r\n\r\n\t\tif (style instanceof CSSStyleSheet) {\r\n\t\t\tme.#store.set(id, style);\r\n\t\t}\r\n\r\n\t\tif (style && typeof style === 'string') {\r\n\t\t\tconst sheet = GSCacheStyles.create(id);\r\n\t\t\tsheet.replaceSync(style);\r\n\t\t}\r\n\r\n\t\treturn me.get(id);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Remove stylesheet by unique ID\r\n\t * @param {String} id \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic remove(id) {\r\n\t\treturn this.#store.delete(id);\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve stylesheet by unique ID\r\n\t * @param {String} id \r\n\t * @returns {CSSStyleSheet}\r\n\t */\r\n\tstatic get(id) {\r\n\t\treturn this.#store.get(id);\r\n\t}\r\n\r\n\t/**\r\n\t * Get list of dynamic styles\r\n\t * @returns {CSSStyleSheet}\r\n\t */\r\n\tstatic get dynamic() {\r\n\r\n\t\tconst me = GSCacheStyles;\r\n\t\tconst id = 'gs-dynamic';\r\n\t\t\r\n\t\tlet sheet = me.get(id);\r\n\t\tif (!sheet) {\r\n\t\t\tsheet = GSCacheStyles.create(id);\r\n\t\t\tdocument.adoptedStyleSheets = GSCacheStyles.styles;\r\n\t\t}\r\n\t\t\r\n\t\treturn sheet;\r\n\t}\r\n\r\n\t/**\r\n\t * Get individual rule from dynamic styles cache\r\n\t * @param {String} id \r\n\t * @returns {CSSRule}\r\n\t */\r\n\tstatic getRule(id = '') {\r\n\t\treturn GSCacheStyles.dynamic.getRule(id);\r\n\t}\r\n\r\n\t/**\r\n\t * Set dynamic element rule. Accepts string or json object representation\r\n\t * @param {String} id \r\n\t * @param {string|object} style \r\n\t */\r\n\tstatic setRule(id = '', style = '', sync = false) {\r\n\t\treturn GSCacheStyles.dynamic.setRule(id, style, sync);\r\n\t}\r\n\r\n\t/**\r\n\t * Remove dynamic element rule\r\n\t * @param {String} id  \r\n\t */\r\n\tstatic deleteRule(id = '') {\r\n\t\tGSCacheStyles.dynamic.deleteRule(id);\r\n\t}\r\n\r\n\t/**\r\n\t * Return list of registered style sheets\r\n\t * @returns {Array<CSSStyleSheet>}\r\n\t */\r\n\tstatic get styles() {\r\n\t\treturn Array.from(new Map([...GSCacheStyles.#store].sort((a, b) => String(a[0]).localeCompare(b[0]))).values());\r\n\t}\r\n\r\n\t/**\r\n\t * Inject CSS used by framework across all shadows\r\n\t * @param {string} css CSS string to inject\r\n\t * @param {number} [hash=0] Optional hash for the style\r\n\t */\r\n\tstatic adopt(css = '', hash = 0) {\r\n\t\tif (!css) return;\r\n\t\ttry {\r\n\t\t\thash = hash || GSID.hashCode(css);\r\n\t\t\tGSCacheStyles.set(hash, css);\r\n\t\t\tdocument.adoptedStyleSheets = GSCacheStyles.styles;\r\n\t\t} catch (e) {\r\n\t\t\tGSLog.error(null, e);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.freeze(GSCacheStyles);\r\n\t\tglobalThis.GSCacheStyles = GSCacheStyles;\r\n\t\tGSCacheStyles.adopt(gsstyles);\r\n\t}\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\nimport { GSDOM } from './GSDOM.mjs';\r\nimport { GSEvents } from './GSEvents.mjs';\r\nimport { GSDOMObserver } from './GSDOMObserver.mjs';\r\nimport { GSCacheStyles } from './GSCacheStyles.mjs';\r\n\r\nconst adoptedId = Symbol();\r\nconst observer = Symbol();\r\n\r\n/**\r\n * Monitor HTMLStyleElement & HTMLLinkElement (of type stylesheet) for changes.\r\n * Every such element marked with data-adoptable=\"true\" will be cached and\r\n * will trigger gs-adopted event to notify component controller to update adoptableStyleSheet list\r\n */\r\nexport class GSAdoptedEngine {\r\n\r\n  static timeout = 1000; // Default timeout for adopting stylesheets\r\n  static #timerID = 0;\r\n  static #ID = Date.now();\r\n  static #scheduled = false;\r\n\r\n  static #init() {\r\n    const me = GSAdoptedEngine;\r\n    me.observe(document.head);\r\n    me.#preload();\r\n    me.#timerID = setInterval(() => me.#adopt(), me.timeout);\r\n  }\r\n\r\n  static #clear() {\r\n    const me = GSAdoptedEngine;\r\n    clearInterval(me.#timerID);\r\n    me.#timerID = undefined;\r\n  }\r\n\r\n  static #adopt() {\r\n    const me = GSAdoptedEngine;\r\n    const sheets = me.#adoptable;\r\n    if (sheets.length == 0) return me.#clear();\r\n    sheets.map(s => me.#adoptSheet(s));\r\n    me.update();\r\n  }\r\n\r\n  static update() {\r\n    const me = GSAdoptedEngine;\r\n    if (me.#scheduled) return;\r\n    me.#scheduled = true;\r\n    queueMicrotask(() => {\r\n      requestAnimationFrame(() => {\r\n        try {\r\n          document.adoptedStyleSheets = me.#sorted;\r\n          document.adoptedStyleSheets.id = ++me.#ID;\r\n        } finally {\r\n          me.#scheduled = false;\r\n          globalThis.dispatchEvent(new CustomEvent('gs-adopted'));\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  static #asText(sheet) {\r\n    return Object.values(sheet.cssRules).map(o => o.cssText).join('');\r\n  }\r\n\r\n  static #adoptLink(el) {\r\n    const me = GSAdoptedEngine;\r\n    GSAdoptedEngine.#monitorAttributes(el);\r\n    Array.from(document.styleSheets).filter(s => s.ownerNode === el).map(s => me.#adoptSheet(s));\r\n  }\r\n\r\n  static #adoptSheet(sheet) {\r\n    const me = GSAdoptedEngine;\r\n    const style = me.#asText(sheet);\r\n    return me.#adoptStyle(sheet.ownerNode, style);\r\n  }\r\n\r\n  static #adoptStyle(ownerNode, style) {\r\n    const me = GSAdoptedEngine;\r\n    const sheet = new CSSStyleSheet();\r\n    sheet.replaceSync(style);\r\n    sheet.id = ++me.#ID;\r\n    ownerNode[adoptedId] = sheet.id;\r\n    me.#store(ownerNode, sheet);\r\n    return sheet;\r\n  }\r\n\r\n  static #store(ownerNode, sheet) {\r\n    GSCacheStyles.set(sheet.id, sheet);\r\n  }\r\n\r\n  static #remove(ownerNode, sheet) {\r\n    GSCacheStyles.remove(sheet.id);\r\n    ownerNode[observer]?.disconnect?.();\r\n    ownerNode[observer] = undefined;\r\n  }\r\n\r\n  static get #sorted() {\r\n    return GSCacheStyles.styles;\r\n  }\r\n\r\n  /**\r\n   * List of adoptable styles or links. Filter only those with dataset.adoptable=true\r\n   * @returns {HTMLStyleElement|HTMLLinkElement}\r\n   */\r\n  static get #adoptable() {\r\n    return Object.values(document.styleSheets)\r\n      .filter(o => o.ownerNode)\r\n      .filter(o => o.ownerNode.dataset.adoptable)\r\n      .filter(o => !o.ownerNode[adoptedId]);\r\n  }\r\n\r\n  static #preload() {\r\n    GSDOM.queryAll(document.head, 'link[rel=\"preload\"][as=\"style\"]')\r\n    .forEach(el => {\r\n      el.remove();\r\n      document.head.appendChild(el);\r\n    });\r\n  }\r\n\r\n  static #onAttributeChange(mutationList) {\r\n    mutationList.forEach((mutation) => {\r\n       const id = mutation.target[adoptedId];\r\n       const style = GSCacheStyles.get(id);\r\n       if(style) style.disabled = mutation.target.hasAttribute('disabled');\r\n    });\r\n    GSAdoptedEngine.update();\r\n  }\r\n  \r\n  static #monitorAttributes(element) {\r\n    const me = GSAdoptedEngine;\r\n    const callback = me.#onAttributeChange.bind(me);\r\n    const observer = new MutationObserver(callback);\r\n    observer.observe(element, {\r\n      attributeFilter: [\"disabled\"],\r\n      attributeOldValue: true,\r\n      subtree: false,\r\n    });\r\n    return observer;\r\n  }\r\n  \r\n  /**\r\n   * Filter style and link(css) elements which will be shared\r\n   * with all web components. Filter only those marked with data-adoptable\r\n   * @param {HTMLElement} el \r\n   * @returns {Boolean} Return true if monitored element is selected for further processing\r\n   */\r\n  static #onMonitorFilter(el) {\r\n    return (Boolean(el.dataset?.adoptable))\r\n      && (\r\n        (el instanceof HTMLLinkElement && (el.rel === 'stylesheet' || el.as === \"style\"))\r\n        || el instanceof HTMLStyleElement\r\n      );\r\n  }\r\n\r\n  /**\r\n   * When style added to the HTML page, attach it to the WebComponents\r\n   * @param {HTMLStyleElement|HTMLLinkElement} el \r\n   */\r\n  static #onMonitorConnect(el) {\r\n    const me = GSAdoptedEngine;\r\n    if (el instanceof HTMLStyleElement) {\r\n      me.#adoptStyle(el, el.innerText);\r\n      me.update();\r\n    } else if (el instanceof HTMLLinkElement) {\r\n      GSEvents.wait(el, 'load', 0, false).then(e => {\r\n        if (el.rel === 'preload') return el.rel = \"stylesheet\";\r\n        me.#adoptLink(e.target);\r\n        me.update();\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * When style removed, remove from adoptable and update\r\n   * @param {HTMLElement} el \r\n   */\r\n  static #onMonitorDisconnect(el) {\r\n    const me = GSAdoptedEngine;\r\n    me.#sorted.filter(o => o.id === el[adoptedId])\r\n          .forEach(o => me.#remove(el, o));\r\n    me.update();\r\n  }\r\n\r\n  /**\r\n   * Observe DOM tree for mutations\r\n   * @param {HTMLElement} owner Root element to watch DOM tree from \r\n   */\r\n  static observe(owner) {\r\n    const me = GSAdoptedEngine;\r\n    GSDOMObserver.registerFilter(me.#onMonitorFilter, me.#onMonitorConnect, false, owner);\r\n    GSDOMObserver.registerFilter(me.#onMonitorFilter, me.#onMonitorDisconnect, true, owner);\r\n  }\r\n\r\n  static {\r\n    this.#init();\r\n  }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSLoader class\r\n * @module base/GSLoader\r\n */\r\n\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSLog } from \"./GSLog.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSVersion } from \"./GSVersion.mjs\";\r\n\r\n/**\r\n * A set of static functions used for loading resources\r\n * @class\r\n */\r\nexport class GSLoader {\r\n\r\n    static TEMPLATE_URL = globalThis.GS_TEMPLATE_URL || location.origin;\r\n    static ROUTER_URL = globalThis.GS_ROUTER_URL || location.origin;\r\n\r\n    static NO_CACHE = false;\r\n    static UNIQUE = GSVersion.build;\r\n\r\n    static {\r\n        const rootURL = GSLoader.#defaultURL;\r\n        if (!globalThis.GS_TEMPLATE_URL) {\r\n            GSLoader.TEMPLATE_URL = rootURL;\r\n            globalThis.GS_TEMPLATE_URL = rootURL;\r\n        }\r\n\r\n        if (!globalThis.GS_ROUTER_URL) {\r\n            GSLoader.ROUTER_URL = rootURL;\r\n            globalThis.GS_ROUTER_URL = rootURL;\r\n        }\r\n\r\n        //const hasKey = Object.hasOwn(self, 'GS_NO_CACHE');\r\n        const hasKey = 'GS_NO_CACHE' in self;\r\n        if (hasKey) {\r\n            GSLoader.NO_CACHE = globalThis.GS_NO_CACHE === true;\r\n            if (localStorage) localStorage.setItem('GS_NO_CACHE', GSLoader.NO_CACHE);\r\n        }\r\n        GSLoader.NO_CACHE = localStorage ? localStorage.getItem('GS_NO_CACHE') == 'true' : false;\r\n\r\n    }\r\n\r\n    static get #defaultURL() {\r\n        const url = location.href.split('?').pop();\r\n        const seg = url.split('/');\r\n        return url.endsWith('/') ? url : seg.slice(0, -1).join('/');\r\n    }\r\n\r\n    /**\r\n     * Convert partial URL to a real URL\r\n     * @param {String} url \r\n     * @return {String}\r\n     */\r\n    static normalizeURL(url = '', base = false) {\r\n\r\n        url = url || '';\r\n        let path = null;\r\n        const isFile = location.pathname.split('/').pop(-1).includes('\\.');\r\n        const isExt = url.includes('extension:/');\r\n        const isUrl = url.startsWith('http');\r\n\r\n        if (isUrl || isExt) {\r\n            path = url;\r\n        } else if (url.startsWith('/')) {\r\n            path = `${location.origin}/${url}`;\r\n        } else if (isFile) {\r\n            path = `${location.origin}${location.pathname}/../${url}`;\r\n        } else {\r\n            path = `${location.origin}${location.pathname}/${url}`;\r\n        }\r\n\r\n        path = path.split('://').map(v => v.replaceAll(/\\/{2,}/g, '/')).join('://');\r\n        const uri = new URL(path);\r\n\r\n        // to handle caching\r\n        //if (!base && GSLoader.NO_CACHE) uri.searchParams.append('_dc', Date.now());\r\n        if (!base) {\r\n            const val = GSLoader.NO_CACHE ? Date.now() : GSLoader.UNIQUE;\r\n            uri.searchParams.append('_dc', val);\r\n        }\r\n\r\n        return uri.href;\r\n    }\r\n\r\n    /**\r\n     * Extrach parent path from provided URL string\r\n     * @param {String} url \r\n     * @param {Number} level How many levels to go up the chain\r\n     * @returns {String}\r\n     */\r\n    static parentPath(url = '', level = 1) {\r\n        return (url || '').split('/').slice(0, -1 * level).join('/') + '/';\r\n    }\r\n\r\n    /**\r\n     * Used to load router definition from virtual path\r\n     * \r\n     * @async\r\n     * @param {String} def\r\n     * @return {Promise<string>}\r\n     */\r\n    static async getRouter(def = '') {\r\n\r\n        if (!def) return def;\r\n\r\n        const isRef = def.startsWith('#');\r\n        if (isRef) {\r\n            const el = GSDOM.query(document.documentElement, def);\r\n            return el ? GSUtil.toJson(el.innerHTML) : {};\r\n        }\r\n\r\n        const isHTML = GSUtil.isHTML(def);\r\n        if (isHTML) return def;\r\n\r\n        def = GSLoader.#getRouterURL(def);\r\n        return GSLoader.loadSafe(def, 'GET', null, true);\r\n    }\r\n\r\n    /**\r\n     * Decode template URL into a real URL\r\n     * @param {String} url \r\n     * @return {String}\r\n     */\r\n    static #getRouterURL(url = '') {\r\n        url = url.startsWith('//') ? GSLoader.#routerURL + '/' + url : url;\r\n        return GSLoader.normalizeURL(url);\r\n    }\r\n\r\n    /**\r\n     * Retrieve default template url\r\n     * @return {String}\r\n     */\r\n    static get #routerURL() {\r\n        return GSLoader.normalizeURL(GSLoader.#routerPath, true);\r\n    }\r\n\r\n    /**\r\n     * Retrieve defult template path\r\n     * @return {String}\r\n     */\r\n    static get #routerPath() {\r\n        return GSLoader.ROUTER_URL ? GSLoader.ROUTER_URL.replace('//', '/') : '';\r\n    }\r\n\r\n    /**\r\n     * Used for override to get predefined template\r\n     * Can be html source or url, checks if load or not\r\n     * \r\n     * @async\r\n     * @param {String} def\r\n     * @return {Promise<string>}\r\n     */\r\n    static async getTemplate(def = '') {\r\n\r\n        if (!def) return def;\r\n\r\n        const isRef = def.startsWith('#');\r\n        if (isRef) {\r\n            const el = GSDOM.query(document.documentElement, def);\r\n            return el ? el.innerHTML : def;\r\n        }\r\n\r\n        const isHTML = GSUtil.isHTML(def);\r\n        if (isHTML) return def;\r\n\r\n        def = GSLoader.#getTemplateURL(def);\r\n        return GSLoader.loadSafe(def);\r\n    }\r\n\r\n    /**\r\n     * Decode template URL into a real URL\r\n     * @param {String} url \r\n     * @return {String}\r\n     */\r\n    static #getTemplateURL(url = '') {\r\n        /*\r\n        const isDirect =  /^(https?:\\/\\/)/i.test(url);\r\n        url = isDirect ? url : GSLoader.#templateURL + '/' + url;\r\n        */\r\n        url = url.startsWith('//') ? GSLoader.#templateURL + '/' + url : url;\r\n        return GSLoader.normalizeURL(url);\r\n    }\r\n\r\n    /**\r\n     * Retrieve default template url\r\n     * @return {String}\r\n     */\r\n    static get #templateURL() {\r\n        return GSLoader.normalizeURL(GSLoader.#templatePath, true);\r\n    }\r\n\r\n    /**\r\n     * Retrieve defult template path\r\n     * @return {String}\r\n     */\r\n    static get #templatePath() {\r\n        return GSLoader.TEMPLATE_URL ? GSLoader.TEMPLATE_URL.replace('//', '/') : '';\r\n    }\r\n\r\n    /**\r\n     * Load html template (used for template cache)\r\n     * \r\n     * @async\r\n     * @param {String} val Full or partial url path\r\n     * @param {String} method HTTP methog get|put|post\r\n     * @returns {Promise<string>}\r\n     * @throws {Error}\r\n     */\r\n    static async loadTemplate(val = '', method = 'GET') {\r\n        const url = GSLoader.#getTemplateURL(val);\r\n        return await GSLoader.load(url, method);\r\n    }\r\n\r\n    /**\r\n     * Load remote data as text (for loading templates)\r\n     * \r\n     * @async\r\n     * @param {String} val Full or partial url path\r\n     * @param {String} method HTTP method get|put|post\r\n     * @param {Object} headers HTTP request headers in JSON key/value pairs\r\n     * @param {Boolean} asjson Parse returned data as JSON\r\n     * @param {} body Data to send in a request \r\n     * @returns {Promise<object|string>}\r\n     */\r\n    static async load(val = '', method = 'GET', headers, asjson = false, body) {\r\n        let data = null;\r\n        const ct = 'Content-Type';\r\n        headers = { ...headers };\r\n        headers[ct] = asjson ? 'application/json; utf-8' : headers[ct] || 'text/plain';\r\n        headers.Accept = 'application/json';\r\n        const url = GSLoader.normalizeURL(val, true);\r\n        const opt = { method: method, headers: headers };\r\n        if (method === 'POST' || method === 'PUT' && body) {\r\n            // TODO - detect if binary\r\n            opt.body = JSON.stringify(body);\r\n        }\r\n        const res = await fetch(url, opt);\r\n        if (res.ok) data = asjson ? await res.json() : await res.text();\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * Load remote data without throwing an exception\r\n     * \r\n     * @async\r\n     * @param {String} url Full or partial url path\r\n     * @param {String} method http method GET|POST|PUT\r\n     * @param {Object} headers return json or string\r\n     * @param {Boolean} asjson return json or string\r\n     * @param {Object} dft default value\r\n     * @returns {Promise<object|string>}\r\n     */\r\n    static async loadSafe(url = '', method = 'GET', headers, asjson = false, dft, body) {\r\n        try {\r\n            if (url) return GSLoader.load(url, method, headers, asjson, body);\r\n        } catch (e) {\r\n            GSLog.error(null, e);\r\n        }\r\n        if (dft) return dft;\r\n        return asjson ? {} : '';\r\n    }\r\n\r\n\r\n    /**\r\n     * Load data from various sources\r\n     * \r\n     * @async\r\n     * @param {JSON|func|url} val \r\n     * @returns {Promise}\r\n     */\r\n    static async loadData(val = '') {\r\n\r\n        const isJson = GSUtil.isJson(val);\r\n        const func = !isJson && GSFunction.parseFunction(val);\r\n        const isFunc = func && GSFunction.isFunction(func);\r\n        const isData = !isFunc && GSUtil.parseValue(val);\r\n\r\n        if (isData || isJson) val = GSUtil.toJson(val);\r\n\r\n        if (isFunc) val = await GSFunction.callFunction(func);\r\n\r\n        if (!GSUtil.isJsonType(val)) return;\r\n\r\n        return val;\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSLoader);\r\n        globalThis.GSLoader = GSLoader;\r\n    }\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2022  Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSTemplateCache class\r\n * @module templating/GSTemplateCache\r\n */\r\n\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSLoader } from \"./GSLoader.mjs\";\r\nimport { GSLog } from \"./GSLog.mjs\";\r\n\r\n/**\r\n * Template cache to store loaded and preprocessed templates for reuse\r\n * @class\r\n */\r\nexport class GSTemplateCache {\r\n\r\n\tstatic #store = new Map();\r\n\r\n\t/**\r\n\t * Store pre-processed template into a cache under given name. \r\n\t * Name is usually a path to a template.\r\n\t * @param {String} name Name of a template\r\n\t * @param {HTMLTemplateElement} template Preprocessed template\r\n\t */\r\n\tstatic store(name, template) {\r\n\t\tthis.#store.set(name, template);\r\n\t}\r\n\r\n\t/**\r\n\t * Remove template from cache\r\n\t * @param {String} name Name of a template\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic remove(name) {\r\n\t\treturn this.#store.delete(name);\r\n\t}\r\n\r\n\t/**\r\n\t * Get template from cache by its name.\r\n\t * @param {*} name Name of a template\r\n\t * @returns {HTMLTemplateElement}\r\n\t */\r\n\tstatic load(name) {\r\n\t\treturn this.#store.get(name);\r\n\t}\r\n\r\n\t/**\r\n\t * Helper function to retrieve already existing template by name,\r\n\t * or inject a new one if it does not exist already and return template instance.\r\n\t * @param {String} name \r\n\t * @param {String} template \r\n\t * @returns {HTMLTemplateElement}\r\n\t */\r\n\tstatic getOrCreate(name, template) {\r\n\t\tconst me = GSTemplateCache;\r\n\t\tlet el = me.load(name);\r\n\t\tif (el) return el;\r\n\t\tel = me.create(template);\r\n\t\tme.store(name, el);\r\n\t\treturn el;\r\n\t}\r\n\r\n\t/**\r\n\t * Create template element from loaded template source\r\n\t * \r\n\t * @param {String} template \r\n\t * @returns {HTMLTemplateElement}\r\n\t */\r\n\tstatic create(template) {\r\n\t\tconst el = document.createElement('template');\r\n\t\tGSDOM.setHTML(el, template);\r\n\t\treturn el;\r\n\t}\r\n\r\n\t/**\r\n\t * Clone data from template element\r\n\t * \r\n\t * @param {HTMLTemplateElement} template \r\n\t * @returns {HTMLTemplateElement}\r\n\t */\r\n\tstatic clone(template) {\r\n\t\treturn GSDOM.isTemplateElement(template) ? template.content.cloneNode(true) : null;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if template is retrieved from function\r\n\t * \r\n\t * @param {String} tpl \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isFunctionTemplate(tpl) {\r\n\t\tconst fn = GSFunction.parseFunction(tpl);\r\n\t\treturn GSFunction.isFunction(fn) ? fn : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if template is retrieved from html code\r\n\t * \r\n\t * @param {String} tpl \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isHTMLTemplate(tpl) {\r\n\t\tconst val = tpl ? tpl.trim() : '';\r\n\t\t//return (val.startsWith('<') && val.endsWith('>')) ? tpl : false;\r\n\t\treturn /^<(.*)>$/s.test(val) ? tpl : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if template is retrieved from URL\r\n\t * \r\n\t * @param {String} tpl \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isURLTemplate(tpl) {\r\n\t\tconst val = tpl ? tpl.trim() : '';\r\n\t\treturn /^(https?:\\/\\/|.{0,2}\\/{1,2})/i.test(val) ? tpl : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Initialize loaded template\r\n\t * \r\n\t * @param {Boolean} cached Set to true to auto cache if template does not exist\r\n\t * @param {String} name Template name\r\n\t * @param {String} template Template source\r\n\t * @returns {HTMLTemplateElement} Template instance\r\n\t */\r\n\tstatic initTemplate(cached = false, name = '', template) {\r\n\t\tconst me = GSTemplateCache;\r\n\t\tif (cached) return me.getOrCreate(name, template);\r\n\t\treturn me.create(template);\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve template from given HTML text\r\n\t * \r\n\t * @param {Boolean} cached Set to true to auto cache if template does not exist\r\n\t * @param {String} name Template name\r\n\t * @param {String} tpl Template source\r\n\t * @returns {HTMLTemplateElement} Template instance\r\n\t */\r\n\tstatic loadHTMLTemplate(cached = false, name = '', tpl) {\r\n\t\tconst me = GSTemplateCache;\r\n\t\tconst o = me.isHTMLTemplate(tpl);\r\n\t\tif (!o) return o;\r\n\t\treturn me.initTemplate(cached, name, o);\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve template from given URL\r\n\t * \r\n\t * @async\r\n\t * @param {Boolean} cached Set to true to auto cache if template does not exist\r\n\t * @param {String} name Template name\r\n\t * @param {String} template Template source\r\n\t * @returns {Promise<HTMLTemplateElement>} Template instance\r\n\t */\r\n\tstatic async loadURLTemplate(cached = false, name = '', tpl) {\r\n\t\tconst me = GSTemplateCache;\r\n\t\ttry {\r\n\t\t\tlet template = null;\r\n\t\t\tif (cached) template = me.load(tpl);\r\n\t\t\tif (template) return template;\r\n\t\t\ttemplate = await GSLoader.loadTemplate(tpl);\r\n\t\t\treturn me.initTemplate(cached, name, template);\r\n\t\t} catch (e) {\r\n\t\t\tGSLog.error(me, e);\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve template from given function\r\n\t * \r\n\t * @async\r\n\t * @param {Boolean} cached Set to true to auto cache if template does not exist\r\n\t * @param {String} name Template name\r\n\t * @param {String} template Template source\r\n\t * @returns {Promise<HTMLTemplateElement>} Template instance\r\n\t */\r\n\tstatic async loadFunctionTemplate(cached = false, name = '', tpl) {\r\n\t\tconst me = GSTemplateCache;\r\n\t\tconst fn = me.isFunctionTemplate(tpl);\r\n\t\tif (!fn) return fn;\r\n\t\ttry {\r\n\t\t\tlet template = null;\r\n\t\t\tif (me.cached) template = me.load(o);\r\n\t\t\tif (template) return template;\r\n\t\t\ttemplate = GSFunction.isFunctionAsync(fn) ? await fn() : fn();\r\n\t\t\treturn me.initTemplate(cached, name, template);\r\n\t\t} catch (e) {\r\n\t\t\tGSLog.error(null, e);\r\n\t\t}\r\n\t\treturn fn;\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve and cache html template for element\r\n\t * \r\n\t * @async\r\n\t * @param {Boolean} cached Set to true to auto cache if template does not exist\r\n\t * @param {String} name Template name\r\n\t * @param {String} template Template source\r\n\t * @returns {Promise<HTMLTemplateElement>} Template instance\r\n\t */\r\n\tstatic async loadTemplate(cached = false, name = '', tpl) {\r\n\r\n\t\tif (!name) return false;\r\n\t\tif (!tpl) return false;\r\n\r\n\t\tconst me = GSTemplateCache;\r\n\r\n\t\t// try to load override template (by GSElement tag name)\r\n\t\tlet template = false;\r\n\r\n\t\tif (tpl.indexOf('#') == 0) {\r\n\t\t\t// return document.getElementById(tpl.slice(1));\r\n\t\t\treturn GSDOM.query(`template[id=\"${tpl.slice(1)}\"]`, true);\r\n\t\t}\r\n\r\n\t\tif (!template) {\r\n\t\t\ttemplate = me.loadHTMLTemplate(cached, name, tpl);\r\n\t\t}\r\n\r\n\t\tif (!template) {\r\n\t\t\ttemplate = await me.loadFunctionTemplate(cached, name, tpl);\r\n\t\t}\r\n\r\n\t\tif (!template) {\r\n\t\t\ttemplate = await me.loadURLTemplate(cached, name, tpl);\r\n\t\t}\r\n\r\n\t\treturn template;\r\n\t}\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSLog } from \"./GSLog.mjs\";\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSAttr } from \"./GSAttr.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSEvents } from \"./GSEvents.mjs\";\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSTemplateCache } from \"./GSTemplateCache.mjs\";\r\n\r\n/**\r\n * A module GSAttributeHandler GSAttr class\r\n * @module base/GSDOM\r\n */\r\n\r\n/**\r\n * Attributes to control click actions for buttons and links.\r\n * Used for meta linking between UI elements\r\n * \r\n * Attributes handled:\r\n * - data-gs-action - trigger action event\r\n * - data-gs-anchor - where to anchor injected html (self, beforebegin, afterbegin, etc.)\r\n * - data-gs-attribute - toggle element attribute (receive k=v;k1=v1 or JSON format)\r\n * - data-gs-call - calls a function on a given target (multiple functions supported)\r\n * - data-gs-event - emit event (can bubble or compose)\r\n * - data-gs-exec - execute a function (alternative to the call)\r\n * - data-gs-inject - inject HTML content; used for WebComponent append\r\n * - data-gs-property - togle element property (receive k=v;k1=v1 or JSON format)\r\n * - data-gs-swap - swap HTML content; used for WebComponent replacement\r\n * - data-gs-target - CSS query for a target or targets\r\n * - data-gs-template - template to load and inject template\r\n * - data-gs-timeout - a timeout between class toggle\r\n * - data-gs-toggle - toggle CSS classes on a given target\r\n * - data-gs-trigger - triggers an event on a given target\r\n * - data-gs-value - value to pass to a gs-call or gs-trigger\r\n *\r\n * NOTE: \r\n * data-gs-swap and gs-inject uses data-gs-anchor to determine \r\n * where to inject html. If not, set, innerHTML is used\r\n * \r\n * data-gs-target determine element on which to execute,\r\n * if not specified, it means current element\r\n * \r\n * @class\r\n */\r\nexport class GSAttributeHandler {\r\n\r\n    static #reverse = Symbol();\r\n    static #link = Symbol();\r\n\r\n    static DEFINITION = {\r\n        action: { attribute: 'data-gs-action' },\r\n        anchor: { attribute: 'data-gs-anchor' },\r\n        attribute: { attribute: 'data-gs-attribute' },\r\n        call: { attribute: 'data-gs-call' },\r\n        \r\n        event: { attribute: 'data-gs-event' },\r\n        bubbles: { attribute: 'data-gs-bubbles', type: Boolean },\r\n        composed: { attribute: 'data-gs-composed', type: Boolean },\r\n\r\n        exec: { attribute: 'data-gs-exec' },\r\n        inject: { attribute: 'data-gs-inject' },\r\n        property: { attribute: 'data-gs-property' },\r\n        swap: { attribute: 'data-gs-swap' },\r\n        target: { attribute: 'data-gs-target' },\r\n        template: { attribute: 'data-gs-template' },\r\n        toggle: { attribute: 'data-gs-toggle' },\r\n        trigger: { attribute: 'data-gs-trigger' },\r\n        value: { attribute: 'data-gs-value' },\r\n\r\n        hashed: { attribute: 'data-gs-hashed', type: Boolean },\r\n\r\n        calls: { attribute: 'data-gs-call', multi: true },\r\n        toggles: { attribute: 'data-gs-toggle', multi: true },\r\n        timeout: { attribute: 'data-gs-timeout', type: Number },\r\n        triggers: { attribute: 'data-gs-trigger', multi: true },\r\n    }\r\n\r\n    #host;\r\n    #proxy;\r\n    #active = false;\r\n    #callback;\r\n\r\n    constructor(el) {\r\n        const me = this;\r\n        me.#host =  el.isProxy ? el.self : el;\r\n        me.#callback = me.handle.bind(me);\r\n        me.#proxy = el.isProxy ? el : GSAttributeHandler.proxify(me.#host);\r\n    }\r\n\r\n    /**\r\n     * Main function to process element data-gs-* attributes\r\n     * @param {Event} e \r\n     */\r\n    handle(e) {\r\n        const me = this;\r\n        me.targets.forEach(el => me.#handleTarget(me.#host, el, e));\r\n    }\r\n\r\n    /**\r\n     * Process each individual data-gs-* attribute\r\n     * @param {GSElement} host \r\n     * @param {String|HTMLElement} target \r\n     * @param {Event} evt \r\n     */\r\n    #handleTarget(host, target, evt) {\r\n        const me = this;\r\n        me.#handleBinding(target, evt);\r\n        me.#handleAction(target);\r\n        me.#handleSwap(host, target);\r\n        me.#handleInject(host, target);\r\n        me.#handleAttribute(target);\r\n        me.#handleProperty(target);\r\n        me.#handleToggle(target);\r\n        me.#handleTrigger(target, evt);\r\n        me.#handleEvent(host, evt);\r\n        me.#handleCall(host, target, evt);\r\n        me.#handleExec(host, target, evt);\r\n        me.#handleTemplate(host, target);\r\n    }\r\n\r\n    /**\r\n     * Bind provided value to the form or form element\r\n     * @param {HTMLFormElement|HTMLInputElement} target \r\n     * @param {Event} evt \r\n     * @returns \r\n     */\r\n    #handleBinding(target, evt) {\r\n        const source = evt?.target?.field || evt?.target?.form || evt?.target;\r\n        const isForm = source instanceof HTMLFormElement;\r\n        const isField = GSDOM.isFormElement(source);\r\n        if (!(isField || isForm)) return;\r\n        if (isField) {\r\n            target[source.name] = GSDOM.getValue(source);\r\n        } else {\r\n            Object.assign(target, GSDOM.toObject(source));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Trigger 'action' event on target to execute specific function\r\n     * @param {GSElement} target \r\n     */\r\n    #handleAction(target) {\r\n        if (this.action) GSEvents.send(target, 'action', this.action, true, true);\r\n    }\r\n\r\n    /**\r\n     * Set target attribute value\r\n     * @param {HTMLElement} target \r\n     * @returns \r\n     */\r\n    #handleAttribute(target) {\r\n        const me = this;\r\n\r\n        if (me.inject) target = GSDOM.query(target, me.inject);\r\n        if (me.swap) target = GSDOM.query(target, me.swap);\r\n\r\n        if (me.isAttributeJSON) {\r\n            const obj = GSUtil.toJson(me.attribute);\r\n            return GSAttr.jsonToAttr(target, obj);\r\n        }\r\n        const attrs = me.attributes;\r\n        attrs.forEach(v => me.#toggleAttribute(target, v[0], me.value || v[1]));\r\n    }\r\n\r\n    /**\r\n     * Set value to target propery\r\n     * @param {GSElement} target \r\n     * @returns \r\n     */\r\n    #handleProperty(target) {\r\n        const me = this;\r\n        if (me.inject) target = GSDOM.query(target, me.inject);\r\n        if (me.swap) target = GSDOM.query(target, me.swap);\r\n        if (me.isPropertyJSON) {\r\n            const obj = GSUtil.toJson(me.property);\r\n            return Object.assign(target, obj);\r\n        }\r\n        const props = me.properties;\r\n        props.forEach(v => me.#toggleProperty(target, v[0], me.value || v[1]));\r\n    }\r\n\r\n    #toggleAttribute(target, name, value) {\r\n\r\n        if (GSUtil.isBool(target[name])) {\r\n            return GSAttr.toggle(target, name, !target[name]);\r\n        } else if (GSUtil.isNumber(target[name])) {\r\n            value = GSUtil.asNum(value);\r\n        }\r\n        GSAttr.set(target, name, value);\r\n    }\r\n\r\n    #toggleProperty(target, name, value) {\r\n        if (GSUtil.isBool(target[name])) {\r\n            if (GSUtil.isStringEmpty(value)) {\r\n                target[name] = !target[name];\r\n            } else {\r\n                target[name] = GSUtil.asBool(value);\r\n            }\r\n        } else if (GSUtil.isNumber(target[name])) {\r\n            target[name] = GSUtil.asNum(value);\r\n        } else {\r\n            target[name] = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Toggle target css class\r\n     * @param {HTMLElement} target \r\n     */\r\n    async #handleToggle(target) {\r\n        const me = this;\r\n        const tout = me.timeout * 1000;\r\n        let toggles = me.toggles;\r\n        if (tout === 0) {\r\n            toggles.forEach(v => GSDOM.toggleClass(target, v));\r\n        } else {\r\n            if (target[me.#symbol]) toggles = toggles.slice().reverse();\r\n            for (const v of toggles) {\r\n                await GSUtil.timeout(tout);\r\n                GSDOM.toggleClass(target, v);\r\n            }\r\n            target[me.#symbol] = !target[me.#symbol];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Calls a function on a target\r\n     * @param {GSElement} host \r\n     * @param {HTMLElement} target \r\n     * @param {Event} evt \r\n     */\r\n    #handleCall(host, target, evt) {\r\n        const val = GSUtil.isJsonString(host.value) ? GSUtil.toJson(host.value) : host.value;\r\n        this.calls.forEach(v => GSFunction.callFunction(target[v], target, true, val || evt));\r\n    }\r\n\r\n    /**\r\n     * Calls a function on a target\r\n     * @param {*} host \r\n     * @param {*} target \r\n     * @param {*} evt \r\n     * @returns \r\n     */\r\n    #handleExec(host, target, evt) {\r\n        if (!this.exec) return;\r\n        try {\r\n            new Function(this.exec).bind(target)(evt);\r\n        } catch (e) {\r\n            GSLog.error(target, e);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Send an event to a target\r\n     * @param {HTMLElement} target \r\n     * @param {Event} evt \r\n     */\r\n    #handleTrigger(target, evt) {\r\n        this.triggers.forEach(v => GSEvents.send(target, v, evt));\r\n    }\r\n\r\n    #handleEvent(host, evt) {\r\n        //host.emit?.(this.event, evt, this.bubbles, this.composed, true);\r\n        GSEvents.send(host, this.event, evt, this.bubbles, this.composed, true);\r\n    }\r\n\r\n    #handleContent(host, target, value, clean = false) {\r\n        const me = this;\r\n        if (value) {\r\n            let src = '';\r\n            const useDef = GSUtil.asBool(value);\r\n            if (useDef) {\r\n                src = GSDOM.fromJsonAsString(me.definition);\r\n            } else {                \r\n                src = me.#toHTML(value);                \r\n            }\r\n\r\n            const content = GSDOM.parse(src, true);\r\n\r\n            if (!useDef) {\r\n                GSAttr.jsonToAttr(me.definition, content);\r\n            }\r\n\r\n            if (clean) { \r\n                target.innerHTML = '';\r\n            }\r\n\r\n            content.dataset.gsHashed = me.hashed;\r\n            me.#applyContent(host, target, content);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * Inject HTML to target\r\n     * @param {GSElement} host \r\n     * @param {HTMLElement} target \r\n     */\r\n    #handleInject(host, target) {\r\n        this.#handleContent(host, target, this.inject, false);\r\n    }\r\n\r\n    /**\r\n     * Swap inner HTML on a target\r\n     * @param {HTMLElement} target \r\n     */\r\n    #handleSwap(host, target) {\r\n        this.#handleContent(host, target, this.swap, true);\r\n    }\r\n\r\n    /**\r\n     * Convert value as URL to a tempalte or as a component name to inject\r\n     * @param {String} value \r\n     * @returns {String}\r\n     */\r\n    #toHTML(value = '') {\r\n        return value.indexOf('/') < 0 ? `<${value}></${value}>` : `<gs-template flat src=\"${value}\"></gs-template>`;\r\n    }\r\n\r\n    /**\r\n     * Load HTML template and apply to a target\r\n     * @param {GSElement} host \r\n     * @param {HTMLElement} target \r\n     */\r\n    async #handleTemplate(host, target) {\r\n        const tpl = await GSTemplateCache.loadTemplate(true, this.template, this.template);\r\n        this.#applyTemplate(host, target, tpl);\r\n    }\r\n\r\n    /**\r\n     * Apply htmltemplate to a target\r\n     * @param {GSElement} host \r\n     * @param {HTMLElement} target \r\n     * @param {HTMLTemplateElement} template \r\n     */    \r\n    #applyTemplate(host, target, template) {\r\n        const content = GSTemplateCache.clone(template);\r\n        this.#applyContent(host, target, content);\r\n    }\r\n\r\n    /**\r\n     * Apply html template to a target\r\n     * @param {GSElement} host \r\n     * @param {HTMLElement} target \r\n     * @param {HTMLTemplateElement} content \r\n     */    \r\n    #applyContent(host, target, content) {\r\n        if (host?.anchor) {\r\n            GSDOM.insertAdjacent(target, content, host.anchor);\r\n        } else {\r\n            GSDOM.appendChild(target, content);\r\n        }\r\n    }\r\n\r\n    attach(name = 'click') {\r\n        const me = this;\r\n        if (!me.#active) {\r\n            GSEvents.on(me.#host, null, name, me.#callback);\r\n            me.#active = true;\r\n        }\r\n    }\r\n\r\n    detach(name = 'click') {\r\n        //GSEvents.detachListeners(this.#host);\r\n        const me = this;\r\n        GSEvents.off(me.#host, null, name, me.#callback);\r\n        me.#active = false;\r\n    }\r\n\r\n    get #symbol() {\r\n        return GSAttributeHandler.#reverse;\r\n    }\r\n\r\n    get targets() {\r\n        const me = this;\r\n        switch (me.target) {\r\n            case 'this':\r\n            case 'self':\r\n                return [me.#host];\r\n            case 'owner':\r\n                //return [GSDOM.root(me.#host)];\r\n                return [me.#host.parentComponent];\r\n            case 'parent':\r\n                return [me.#host.parentElement];\r\n        }\r\n        const list = GSDOM.queryAll(document.body, me.target, false, true).filter(el => el.tagName !== 'GS-ITEM'); \r\n        if (list.length === 0) list.push(me.#host);\r\n        return list;\r\n    }\r\n\r\n    get host() { return this.#host; }\r\n\r\n    get definition() { return this.#proxy[Symbol.for('#def')]; }\r\n\r\n    get action() { return this.#proxy.action; }\r\n    get anchor() { return this.#proxy.anchor; }\r\n    get attribute() { return this.#proxy.attribute; }\r\n    get exec() { return this.#proxy.exec; }\r\n    get event() { return this.#proxy.event; }\r\n    get bubbles() { return this.#proxy.bubbles; }\r\n    get composed() { return this.#proxy.composed; }\r\n    get call() { return this.#proxy.call; }\r\n    get inject() { return this.#proxy.inject; }\r\n    get property() { return this.#proxy.property; }\r\n    get swap() { return this.#proxy.swap; }\r\n    get target() { return this.#proxy.target; }\r\n    get toggle() { return this.#proxy.toggle; }\r\n    get trigger() { return this.#proxy.trigger; }\r\n    get timeout() { return this.#proxy.timeout; }\r\n    get template() { return this.#proxy.template; }\r\n    get value() { return this.#proxy.value; }\r\n    get hashed() { return this.#proxy.hashed; }\r\n\r\n    get calls() { return this.#proxy.calls; }\r\n    get toggles() { return this.#proxy.toggles; }\r\n    get triggers() { return this.#proxy.triggers; }\r\n\r\n    get attributes() {\r\n        const val = this.#proxy.attribute || '';\r\n        return val.split(/[,;]/g).map(v => v.split('=')).filter(v => GSUtil.isStringNonEmpty(v[0]));\r\n    }\r\n\r\n    get properties() {\r\n        const val = this.#proxy.property || '';\r\n        return val.split(/[,;]/g).map(v => v.split('=')).filter(v => GSUtil.isStringNonEmpty(v[0]));\r\n    }\r\n\r\n    /**\r\n     * Is property value JSON\r\n     */\r\n    get isPropertyJSON() {\r\n        return GSUtil.isJson(this.property);\r\n    }\r\n\r\n    /**\r\n     * Is element attribute value JSON\r\n     */\r\n    get isAttributeJSON() {\r\n        return GSUtil.isJson(this.attribute);\r\n    }\r\n\r\n    /**\r\n     * Wrap any element into data-gs-* handler\r\n     * @param {HTMLElement} el \r\n     * @returns {Proxy}\r\n     */\r\n    static proxify(el) {\r\n        return GSAttr.proxify(el, GSAttributeHandler.DEFINITION);\r\n    }\r\n\r\n    /**\r\n     * Process data-gs-* attributes on a element\r\n     * @param {HTMLElement} el \r\n     * @param {Event} e \r\n     * @returns \r\n     */\r\n    static process(el, e) {\r\n        if (!el?.hasAttribute('data-gs-target')) return;\r\n        let me = el[GSAttributeHandler.#link];\r\n        if (!(me instanceof GSAttributeHandler)) {\r\n            me = new GSAttributeHandler(el);\r\n            el[GSAttributeHandler.#link] = me;\r\n        }\r\n        me.handle(e);\r\n    }\r\n\r\n    /**\r\n     * Create a new attribute handler instance\r\n     * @param {HTMLElement} el \r\n     * @returns \r\n     */\r\n    static create(el) {\r\n        const me = new GSAttributeHandler(el);\r\n        me.attach();\r\n        return me;\r\n    }\r\n\r\n    /**\r\n     * Clone element attributes (GS-ITEM to real WebComponent)\r\n     * @param {HTMLElement} from \r\n     * @param {HTMLElement} to \r\n     * @param {boolean} override If 'false' will skip existing attributes\r\n     */\r\n    static clone(from, to, override = true) {\r\n        const def = GSAttributeHandler.DEFINITION;\r\n        Object.values(def)\r\n            .filter(o => from.hasAttribute(o.attribute))\r\n            .filter(o => override || !to.hasAttribute(o.attribute))          \r\n            .forEach(o => to.setAttribute(o.attribute, from.getAttribute(o.attribute)));\r\n    }\r\n\r\n    /**\r\n     * Check if component is bindable to events\r\n     * @param {HTMLElement} el \r\n     * @returns \r\n     */\r\n    static isBindable(el) {\r\n        const def = GSAttributeHandler.DEFINITION;\r\n        return Object.values(def)\r\n            .filter(o => el.hasAttribute(o.attribute))\r\n            .length > 0;\r\n\r\n    }\r\n\r\n    static {\r\n        const def = GSAttributeHandler.DEFINITION;\r\n        Object.values(def).forEach(o => Object.freeze(o));\r\n        Object.freeze(def);\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSBeep class\r\n * @module base/GSBeep\r\n */\r\n\r\n\r\n/**\r\n * A helper class to use browser AudiContext to make tones\r\n * @class\r\n */\r\nexport class GSBeep {\r\n\r\n    static audioCtx = globalThis.AudioContext || globalThis.webkitAudioContext || globalThis.audioContext;\r\n\r\n    /**\r\n     * Helper function to emit a beep sound in the browser using the Web Audio API.\r\n     * \r\n     * @param {number} duration - The duration of the beep sound in milliseconds.\r\n     * @param {number} frequency - The frequency of the beep sound.\r\n     * @param {number} volume - The volume of the beep sound.\r\n     * @param {string} tyoe - The sound type (sine, square, sawtooth, triangle, custom)\r\n     * \r\n     * @returns {Promise} - A promise that resolves when the beep sound is finished.\r\n     */\r\n    static beep(duration = 200, frequency = 440, volume = 1, type = 'sine') {\r\n        return new Promise((resolve, reject) => {\r\n            try{\r\n                if (!GSBeep.isAvailable) return resolve();\r\n                const context = new GSBeep.audioCtx();\r\n                const oscillatorNode = context.createOscillator();\r\n                const gainNode = context.createGain();\r\n                oscillatorNode.connect(gainNode);\r\n\r\n                // Set the oscillator frequency in hertz\r\n                oscillatorNode.frequency.value = frequency;\r\n\r\n                // Set the type of oscillator\r\n                oscillatorNode.type = type;\r\n                gainNode.connect(context.destination);\r\n\r\n                // Set the gain to the volume\r\n                gainNode.gain.value = volume * 0.01;\r\n\r\n                // Start audio with the desired duration\r\n                oscillatorNode.start(context.currentTime);\r\n                oscillatorNode.stop(context.currentTime + duration * 0.001);\r\n\r\n                // Resolve the promise when the sound is finished\r\n                oscillatorNode.onended = () => resolve();                \r\n            }catch(error) {\r\n                reject(error);\r\n            }\r\n        });\r\n    }\r\n\r\n    static get isAvailable() {\r\n        const {isActive, hasBeenActive } =  navigator.userActivation;\r\n        return isActive || hasBeenActive;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSEnvironment class\r\n * @module base/GSEnvironment\r\n */\r\n\r\n/**\r\n * A set of static functions used for detecting browser environment\r\n * such as OS, orientation, browser type etc.\r\n * @class\r\n */\r\nexport class GSEnvironment {\r\n\r\n    /**\r\n     * Check if page is inside mobile device\r\n     * @returns {Boolean}\r\n     */\r\n    static get isMobile() {\r\n        if (navigator.userAgentData) return navigator.userAgentData.mobile;\r\n        return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\r\n    }\r\n\r\n    /** \r\n     * Check if page is inside desktop\r\n     * @returns {Boolean}\r\n     */\r\n    static get isDesktop() {\r\n        return !GSEnvironment.isMobile;\r\n    }\r\n\r\n    static get isWebkit() {\r\n        return /webkit/.test(navigator.userAgent.toLowerCase());\r\n    }\r\n\r\n    /**\r\n     * Check if value match current URL scheme\r\n     * @param {*} val \r\n     */  \r\n    static isValidProtocol(val = '') {\r\n        if (!val) return true;\r\n        return location.protocol.slice(0, -1) === val;\r\n\t}\r\n\r\n    /**\r\n     * Check if value match current browser type\r\n     * @param {String} val \r\n     * @returns {Boolean}\r\n     */\r\n    static isValidBrowser(val = '') {\r\n        if (!val) return true;\r\n        const strVal = val.toLowerCase();\r\n        if (navigator.userAgentData) {\r\n            let sts = false;\r\n            navigator.userAgentData.brands.forEach((v) => {\r\n                if (v.brand.toLowerCase().includes(strVal)) {\r\n                    sts = true;\r\n                }\r\n            });\r\n            return sts;\r\n        }\r\n        const strAgt = navigator.userAgent.toLocaleLowerCase() || '';\r\n        const isEdge = strAgt.includes('edg');\r\n        if (isEdge && strVal.startsWith('edg')) return true;\r\n        return !isEdge && strAgt.includes(strVal);\r\n    }\r\n\r\n    /**\r\n     * Returns if environment matched\r\n     * dektop, mobile, tablet, android, linux, windows, macos, ios\r\n     * @returns {Boolean}\r\n     */\r\n    static isValidEnvironment(val = '') {\r\n\r\n        if (!val) return true\r\n\r\n        if (val === 'desktop') {\r\n            return GSEnvironment.isDesktop;\r\n        }\r\n\r\n        if (val === 'mobile') {\r\n            return GSEnvironment.isMobile;\r\n        }\r\n\r\n        return GSEnvironment.isDevice(val);\r\n    }\r\n\r\n    /**\r\n     * Returns true if device /os is valid\r\n     * @param {String} val \r\n     * @returns {Boolean}\r\n     */\r\n    static isDevice(val = '') {\r\n        if (!val) return true;\r\n        const strVal = val.toLowerCase();\r\n\r\n        if (navigator.userAgentData && navigator.userAgentData.platform) {\r\n            const platform = navigator.userAgentData.platform.toLowerCase();\r\n            return platform === strVal;\r\n        }\r\n\r\n        const strAgt = navigator.userAgent.toLocaleLowerCase();\r\n        return strAgt.indexOf(strVal) > 1;\r\n    }\r\n\r\n    /**\r\n     * Returns if orientation matched\r\n     * horizontal, vertical, portrait, landscape\r\n     * retuns true if value not set\r\n     * \r\n     * @param {String} val\r\n     * @returns {Boolean}\r\n     */\r\n    static isValidOrientation(val = '') {\r\n\r\n        if (!val) return true;\r\n\r\n        if (!screen.orientation) return true;\r\n\r\n        const otype = screen.orientation.type;\r\n\r\n        if (otype.includes('portrait')) {\r\n            return val === 'portrait' || val === 'vertical';\r\n        }\r\n\r\n        if (otype.includes('landscape')) {\r\n            return val === 'landscape' || val === 'horizontal';\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSEnvironment);\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A module loading GSPromise class\r\n * @module base/GSPromise\r\n */\r\n\r\n/**\r\n * A Promise wrapper for timeouted and cancelable events\r\n * @class\r\n */\r\nexport class GSPromise {\r\n\r\n    #signal;\r\n    #callback;\r\n    #callbacks;\r\n    #resolve;\r\n    #reject;\r\n    #promise;\r\n\r\n    /**\r\n     * \r\n     * @param {*} callback \r\n     * @param {Number|AbortSignal} signal Timeout or custom signal\r\n     */\r\n    constructor(callback, signal) {\r\n        const me = this;\r\n        me.#callback = callback;\r\n        me.#signal = signal instanceof AbortSignal ? signal : null;\r\n        me.#signal = GSUtil.isNumber(signal) ? AbortSignal.timeout(signal) : me.#signal;\r\n        me.#callbacks = {\r\n            abort: me.#onAbort.bind(me)\r\n        };\r\n    }\r\n\r\n    await() {\r\n        const me = this;\r\n        if (me.#promise) return me.#promise;\r\n        me.#signal?.addEventListener('abort', me.#callbacks.abort);\r\n        me.#promise = new Promise(me.#wrap.bind(me));\r\n        return me.#promise;\r\n    }\r\n\r\n    get aborted() {\r\n        return this.#signal?.aborted === true;\r\n    }\r\n\r\n    #wrap(resolve, reject) {\r\n        const me = this;\r\n        me.#resolve = resolve;\r\n        me.#reject = reject;\r\n        try {\r\n            me.#callback(me.#onResolve.bind(me), me.#onReject.bind(me));\r\n        } catch (e) {\r\n            me.#clear();\r\n            reject(e);\r\n        }\r\n    }\r\n\r\n    #onAbort() {\r\n        const me = this;\r\n        me.#clear();\r\n        me.#reject(new Error('Promise aborted!'));\r\n    }\r\n\r\n    #onResolve(o) {\r\n        const me = this;\r\n        me.#clear();\r\n        return me.aborted ? null : me.#resolve(o);\r\n    }\r\n\r\n    #onReject(e) {\r\n        const me = this;\r\n        me.#clear();\r\n        return me.aborted ? null : me.#reject(e);\r\n    }\r\n\r\n    #clear() {\r\n        const me = this;\r\n        me.#signal?.removeEventListener('abort', me.#callbacks.abort);\r\n    }\r\n\r\n\t/**\r\n\t * Execute array of promises sequentially\r\n\t * @param {Array<Promise>} ps \r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic sequential(ps) {\r\n\t\tif (!Array.isArray(ps)) ps = [];\r\n\t\treturn ps.reduce((p, next) => p.then(next), Promise.resolve());\r\n\t}\r\n\r\n    static {\r\n        globalThis.GSPromise = GSPromise;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSPromise } from \"./GSPromise.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A module loading GSEvent class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Class extending native event with additional features\r\n * @Class\r\n */\r\nexport class GSEvent extends EventTarget {\r\n\r\n    #listeners = new Set();\r\n\r\n    #list(type = '', listener) {\r\n        const me = this;\r\n        const list = Array.from(me.#listeners);\r\n        return me.#isFunction(listener) ?\r\n            list.filter(o => o.type === type && o.listener === listener)\r\n            :\r\n            list.filter(o => o.type === type);\r\n    }\r\n\r\n    #isFunction(fn) {\r\n        return typeof fn === 'function';\r\n    }\r\n\r\n    /**\r\n     * Listen for events\r\n     * \r\n     * @param {String} type Event name to be listened\r\n     * @param {Function} listener  Callback to be called on event trigger\r\n     * @param {Number} timeout It event timeout set, return AbortSignal\r\n     * @param {boolean|AbortController} abortable If abortable set, return AbortController\r\n     */\r\n    on(type = '', listener, timeout = 0, abortable = false) {\r\n        if (!type) return reject('Event undefined!');\r\n        const controller = abortable instanceof AbortController ? abortable : (abortable ? new GSAbortController(timeout) : null);\r\n        const signal = controller || timeout == 0 ? controller?.signal : AbortSignal.timeout(timeout);\r\n        this.addEventListener(type, listener, { signal: signal });\r\n        return controller || signal;\r\n    }\r\n\r\n    /**\r\n     * Listen for events only once\r\n     * \r\n     * @param {String} type Event name to be listened\r\n     * @param {Function} listener  Callback to be called on event trigger\r\n     * @param {Number} timeout It event timeout set, return AbortSignal\r\n     * @param {boolean|AbortController} abortable If abortable set, return AbortController\r\n     */\r\n    once(type, listener, timeout = 0, abortable = false) {\r\n        if (!type) return reject('Event undefined!');\r\n        const me = this;\r\n        const wrap = (e) => {\r\n            listener(e);\r\n            me.#listeners.delete(wrap);\r\n        }\r\n        wrap.type = type;\r\n        wrap.listener = listener;\r\n        wrap.timeout = timeout;\r\n        wrap.controller = abortable instanceof AbortController ? abortable : (abortable ? new GSAbortController(timeout) : null);\r\n        wrap.signal = wrap.controller || timeout == 0 ? wrap.controller?.signal : AbortSignal.timeout(timeout);\r\n        me.addEventListener(type, wrap, { once: true, signal: wrap.signal });\r\n        return wrap.controller || wrap.signal;\r\n    }\r\n\r\n    /**\r\n     * Stop listening for events\r\n     * \r\n     * @param {String} type Event name to be listened\r\n     * @param {Function} listener  Callback to be called on event trigger\r\n     */\r\n    off(type = '', listener) {\r\n        this.removeEventListener(type, listener);\r\n    }\r\n\r\n    /**\r\n     * Send event to listeners\r\n     * \r\n     * @param {String} type Event name to be listened\r\n     * @param {Object} data  Data to send \r\n     * @param {Number} delayed Emit event delay in miliseconds\r\n     */\r\n    emit(type = '', data, delayed = 0) {\r\n        const me = this;\r\n        if (delayed === true) {\r\n            return queueMicrotask(() => me.#send(type, data));\r\n        }\r\n        delayed = GSUtil.asNum(delayed, 0);\r\n        if (delayed <= 0) return me.#send(type, data);\r\n        return setTimeout(() => me.#send(type, data), delayed);\r\n    }\r\n\r\n    #send(type = '', data) {\r\n        const evt = new CustomEvent(type, { detail: data });\r\n        return this.dispatchEvent(evt);\r\n    }\r\n\r\n    /**\r\n     * Wait for an event using GSPromise wrapper\r\n     * @param {String} type Event name to be listened\r\n     * @param {AbortSignal} signal Used to abort listener\r\n     * @returns {Event}\r\n    */\r\n    wait(type = '', signal) {\r\n        const me = this;\r\n        const callback = (resolve, reject) => {\r\n            me.once(type, resolve);\r\n        }\r\n        return new GSPromise(callback, signal).await();\r\n    }\r\n\r\n    listen(type, listener) { this.on(type, listener); }\r\n    unlisten(type, listener) { this.off(type, listener); }\r\n\r\n    /**\r\n     * Remove all listeners\r\n     */\r\n    unbind() {\r\n        const me = this;\r\n        Array.from(me.#listeners).forEach(o => {\r\n            super.removeEventListener(o.type, o.listener);\r\n        });\r\n        me.#listeners.clear();\r\n    }\r\n\r\n    addEventListener(type, listener, opt) {\r\n        const me = this;\r\n        if (!me.#isFunction(listener)) return false;\r\n        me.#listeners.add({ type: type, listener: listener });\r\n        return super.addEventListener(type, listener, opt);\r\n    }\r\n\r\n    removeEventListener(type, listener) {\r\n        const me = this;\r\n        const list = me.#list(type, listener);\r\n        list.forEach(o => {\r\n            super.removeEventListener(o.type, o.listener);\r\n            me.#listeners.delete(o);\r\n        });\r\n    }\r\n\r\n    static {\r\n        Object.freeze(GSEvent);\r\n        globalThis.GSEvent = GSEvent;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSEventBus class\r\n * @module base/GSEventBus\r\n */\r\n\r\nimport { GSEvent } from './GSEvent.mjs';\r\n\r\n/**\r\n * Class for handling shared events among components\r\n * Difference from native BroadcastChannel is :\r\n *  - support for multiple named events\r\n *  - does not work across different pages\r\n * @Class\r\n */\r\nexport class GSEventBus {\r\n\r\n    static #registry = new Map();\r\n\r\n    /**\r\n     * Static event emiter. If named event does not exist, create a new one\r\n     * \r\n     * @param {String} name EventBus name\r\n     * @param {String} type Event name\r\n     * @param {Object} data Dat to send\r\n     * \r\n     * @returns {boolean|object}\r\n     */\r\n    static send(name = '', type = '', data) {\r\n        return GSEventBus.register(name).emit(type, data);\r\n    }\r\n\r\n    /**\r\n     * Check if named event bus already exists\r\n     * \r\n     * @param {String} name \r\n     * @returns {Boolean}\r\n     */\r\n    static exist(name = '') {\r\n        return name && GSEventBus.#registry.has(name);\r\n    }\r\n\r\n    /**\r\n     * Register a named event bus. If already exists, will return existsing instance.\r\n     * @param {String} name unique bus name\r\n     * @returns {GSEventBus}\r\n     */\r\n    static register(name = '') {\r\n        if (!GSEventBus.exist(name)) {\r\n            GSEventBus.#registry.set(name, new GSEvent());\r\n        }\r\n        return GSEventBus.#registry.get(name);\r\n    }\r\n\r\n    /**\r\n     * Unregister named event bus from registry.\r\n     * @param {String} name unique buss name\r\n     * @returns {Boolean} State of removal.\r\n     */\r\n    static unregister(name = '') {\r\n        const bus = GSEventBus.#registry.get(name);\r\n        if (bus?.unbind) bus.unbind();\r\n        return GSEventBus.#registry.delete(name);\r\n    }\r\n\r\n    static {\r\n        Object.freeze(GSEventBus);\r\n        globalThis.GSEventBus = GSEventBus;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSGesture class\r\n * @module base/GSGesture\r\n */\r\nimport { GSEvents } from \"./GSEvents.mjs\";\r\n\r\n/**\r\n * A class for handling touch swipe and long press events.\r\n * @class\r\n */\r\nexport class GSGesture {\r\n\r\n    #xDiff = 0;\r\n    #yDiff = 0;\r\n    #xDown = null;\r\n    #yDown = null;\r\n    #element = null;\r\n    #bindings = null;\r\n\r\n    #swipe = false;\r\n    #tap = false;\r\n    #longPress = false;\r\n\r\n    // setTimeout id for longpress\r\n    #delay = 0;\r\n\r\n    // longpress delay\r\n    static timeout = 1500;\r\n\r\n    /**\r\n     * Constructor to attach Gesture featuer to an HTML element\r\n     * @param {HTMLElement} element \r\n     * @param {Boolean} swipe Monitor swipe gesture\r\n     * @param {Boolean} tap Monitor tap gesture\r\n     * @param {Boolean} longPress Monitor long press gesture\r\n     */\r\n    constructor(element, swipe, tap, longPress) {\r\n        const me = this;\r\n        me.#swipe = swipe;\r\n        me.#tap = tap;\r\n        me.#longPress = longPress;\r\n        me.#xDown = null;\r\n        me.#yDown = null;\r\n        me.#element = typeof (element) === 'string' ? document.querySelector(element) : element;\r\n\r\n        me.#bindings = {\r\n            move: me.#handleTouchMove.bind(me),\r\n            start: me.#handleTouchStart.bind(me),\r\n            end: me.#handleTouchEnd.bind(me)\r\n        };\r\n        GSEvents.attach(me.#element, me.#element, 'touchmove', me.#bindings.move, false);\r\n        GSEvents.attach(me.#element, me.#element, 'touchstart', me.#bindings.start, false);\r\n        GSEvents.attach(me.#element, me.#element, 'touchend', me.#bindings.end, false);\r\n    }\r\n\r\n    /**\r\n     * Remove gesture events from element\r\n     */\r\n    unbind() {\r\n        const me = this;\r\n        GSEvents.remove(me.#element, me.#element, 'touchmove', me.#bindings.move);\r\n        GSEvents.remove(me.#element, me.#element, 'touchstart', me.#bindings.start);\r\n        GSEvents.remove(me.#element, me.#element, 'touchend', me.#bindings.end);\r\n    }\r\n\r\n    #handleTouchStart(evt) {\r\n        const me = this;\r\n        me.#xDown = evt.touches[0].clientX;\r\n        me.#yDown = evt.touches[0].clientY;\r\n        if (me.#longPress) setTimeout(me.#onLongPress.bind(me), GSGesture.timeout);\r\n    }\r\n\r\n    #handleTouchEnd(evt) {\r\n        clearTimeout(this.#delay);\r\n    }\r\n\r\n    #handleTouchMove(evt) {\r\n\r\n        const me = this;\r\n\r\n        if (!me.#xDown || !me.#yDown) {\r\n            return;\r\n        }\r\n\r\n        if (!me.#swipe) return;\r\n\r\n        const xUp = evt.touches[0].clientX;\r\n        const yUp = evt.touches[0].clientY;\r\n\r\n        if (me.#longPress) {\r\n            const isMoving = Math.abs(me.#xDiff) > 10 && Math.abs(me.#yDiff) > 10;\r\n            if (isMoving) clearTimeout(me.#delay);\r\n        }\r\n\r\n        me.#xDiff = me.#xDown - xUp;\r\n        me.#yDiff = me.#yDown - yUp;\r\n\r\n        // Most significant.\r\n        const isHorisontal = Math.abs(me.#xDiff) > Math.abs(me.#yDiff);\r\n\r\n        let name = '';\r\n        if (isHorisontal) {\r\n            name = me.#xDiff > 0 ? 'swipe-left' : 'swipe-right';\r\n        } else {\r\n            name = me.#yDiff > 0 ? 'swipe-up' : 'swipe-down';\r\n        }\r\n\r\n        GSEvents.send(me.#element, name, evt);\r\n\r\n        // Reset values.\r\n        me.#xDown = null;\r\n        me.#yDown = null;\r\n    }\r\n\r\n    #onLongPress() {\r\n        GSEvents.send(me.#element, 'long-press');\r\n    }\r\n\r\n    /**\r\n     * Return number of fingers used in touch event\r\n     * @param {Event} e \r\n     * @returns {Number}\r\n     */\r\n    static fingers(e) {\r\n        return e.detail.touches?.length;\r\n    }\r\n\r\n    /**\r\n     * Attach swipe event to a element\r\n     * @param {HTMLElement} element \r\n     * @returns {GSGesture}\r\n     */\r\n    static attach(element, swipe = true, tap = false, longPress = false) {\r\n        return new GSGesture(element, swipe, tap, longPress);\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSAttr } from \"./GSAttr.mjs\";\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\n\r\n/**\r\n * A module loading GSItem class\r\n * @module base/GSItem\r\n */\r\n\r\n/**\r\n * Static class for handling generic configurable tag GS-ITEM\r\n */\r\nexport class GSItem extends HTMLElement {\r\n\r\n\tstatic #tags = ['GS-ITEM', 'TEMPLATE']\r\n\r\n\tstatic properties = {\r\n\t\tactive: { type: Boolean },\r\n\t\tdisabled: { type: Boolean },\r\n\t\tselected: { type: Boolean },\r\n\t\tautofocus: { type: Boolean },\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tGSItem.validate(this);\r\n\t}\r\n\r\n\t/**\r\n\t * Return template content of GS-ITEM element (if exists)\r\n\t * \r\n\t * @param {HTMLElement} el \r\n\t * @returns {String}\r\n\t */\r\n\tget body() {\r\n\t\tlet tpl = GSAttr.get(this, 'template');\r\n\t\tif (tpl) return `<gs-template flat src=\"${tpl}\"></gs-template>`;\r\n\t\ttpl = this.querySelector('template');\r\n\t\treturn tpl?.innerHTML || '';\r\n\t}\r\n\r\n\t/**\r\n\t * Get first level of generic gs-item elements\r\n\t * @param {HTMLElement} root \r\n\t * @returns {Array<HTMLElement>} \r\n\t */\r\n\tget items() {\r\n\t\treturn Array.from(this.children).filter(el => el.tagName == 'GS-ITEM')\r\n\t}\r\n\r\n\tget name() {\r\n\t\treturn GSAttr.get(this, 'name', '');\r\n\t}\r\n\r\n\t/**\r\n\t * Get parent GS-* component\r\n\t */\r\n\tget parentComponent() {\r\n\t\treturn GSDOM.parentAll(this).filter(x => x instanceof GSElement).next()?.value;\r\n\t}\r\n\t\t\r\n\tasJSON(recursive = true) {\r\n\t\treturn GSDOM.toJson(this, recursive);\r\n\t}\r\n\r\n\t/**\r\n\t * Validate that parent element contains only specific childrens\r\n\t * @param {*} own \r\n\t * @param {*} tagName \r\n\t * @returns \r\n\t */\r\n\tstatic validate(own, tagName = 'GS-ITEM') {\r\n\t\treturn GSDOM.validate(own, tagName, GSItem.#tags);\r\n\t}\r\n\r\n\t/**\r\n\t * Get first level of generic gs-item element, used for configuring gs-* components\r\n\t * @param {HTMLElement} root \r\n\t * @returns {Array<HTMLElement>} \r\n\t */\r\n\tstatic collect(root) {\r\n\t\tif (!GSDOM.isHTMLElement(root)) return [];\r\n\t\treturn Array.from(root.children).filter(el => el.tagName == 'GS-ITEM')\r\n\t}\r\n\t\t\r\n\t/**\r\n\t * Convert GS-ITEM list to JSON\r\n\t * @param {HTMLElement} root Element containing GS-ITEM childs \r\n\t * @returns {Array} Arary of JSON objects\r\n\t */\r\n\tstatic toJSON(root) {\r\n\t\treturn GSItem.collect(root).map(el => el.asJSON(true));\r\n\t}\r\n\r\n\t/**\r\n\t * Make GS-ITEM attributes JSON compatible \r\n\t * @param {*} root \r\n\t * @param {*} definition \r\n\t * @returns \r\n\t */\r\n    static proxify(root, definition) {        \r\n        return GSItem.collect(root).map(el => GSAttr.proxify(el, definition));\r\n    }\r\n\r\n\tstatic {\r\n\t\tcustomElements.define('gs-item', GSItem);\r\n\t\tObject.seal(GSItem);\r\n\t}\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\nimport { GSID } from './GSID.mjs';\r\nimport { GSLoader } from './GSLoader.mjs';\r\nimport { GSPromise } from './GSPromise.mjs';\r\nimport { GSEvents } from './GSEvents.mjs';\r\nimport { GSUtil } from './GSUtil.mjs';\r\n\r\n/**\r\n * A module loading GSLocalization class\r\n * @module base/GSLocalization\r\n */\r\n\r\nconst GS_LOCALIZATION_LANGUAGE = globalThis.GS_LOCALIZATION_LANGUAGE || document.documentElement.lang || navigator.language;\r\n\r\n/**\r\n * Generic text translation engine.\r\n * Each JSON langauge file is of 2 files format \r\n * default.json  {'UI text', 'KEY_NAME'}\r\n * language.json {$language$: 'langauge_name', KEY_NAME : 'translation text'}\r\n * @class\r\n */\r\nclass GSLocalizationImpl {\r\n\r\n    #languages = new Map();\r\n    #queue = new Set();\r\n    #queued = false;\r\n\r\n    #url = globalThis.GS_LOCALIZATION_URL;\r\n    #default = GS_LOCALIZATION_LANGUAGE;\r\n    #language;\r\n\r\n    constructor() {\r\n        this.load();\r\n    }\r\n\r\n    /**\r\n     * Default page langugae, use page language, or browser languge if value not set\r\n     */\r\n    get default() {\r\n        return this.#default;\r\n    }\r\n\r\n    set default(val = '') {\r\n        this.#default = val || GS_LOCALIZATION_LANGUAGE;\r\n    }\r\n\r\n    /**\r\n     * Language to which to translate\r\n     */\r\n    get lang() {\r\n        return this.#language || this.default;\r\n    }\r\n\r\n    set lang(val = '') {\r\n        this.#language = val;\r\n    }\r\n\r\n    /**\r\n     * URL from where to load JSON translation documents\r\n     */\r\n    get url() {\r\n        return this.#url;\r\n    }\r\n\r\n    set url(val = '') {\r\n        this.#url = val || globalThis.GS_LOCALIZATION_URL;\r\n    }\r\n\r\n    translate(language = '', value = '') {\r\n        const me = this;\r\n        if (GSUtil.isStringEmpty(language)) return value;\r\n        if (!me.#languages.has(language)) {\r\n            me.load(language);\r\n            return value;\r\n        }\r\n        const deft = me.#getLanguage('default');\r\n        const lang = me.#getLanguage(language);\r\n        const texthash = deft.get(GSID.hashCode(value));\r\n        return texthash ? lang.get(texthash) || value : value;\r\n    }\r\n\r\n    reset() {\r\n        const me = this;\r\n        me.#default = GS_LOCALIZATION_LANGUAGE;\r\n        me.#language = undefined;\r\n        me.load();\r\n    }\r\n\r\n    load(language = 'default') {\r\n        const me = this;\r\n        if (GSUtil.isStringEmpty(language)) return;\r\n        if (GSUtil.isStringEmpty(me.url)) return;\r\n        if (me.#languages.has(language)) return;\r\n        me.#queue.add(language);\r\n        if (me.#queued) return;\r\n        me.#queued = true;\r\n        queueMicrotask(async () => {\r\n            const promises = Array.from(me.#queue.values()).map(l => me.loadWait(l));\r\n            await GSPromise.sequential(promises);\r\n            me.#queued = false;\r\n        });\r\n\r\n    }\r\n\r\n    async loadWait(language) {\r\n        const me = this;\r\n        if (GSUtil.isStringEmpty(language)) return;\r\n        if (GSUtil.isStringEmpty(me.url)) return;\r\n        const headers = {\r\n            'Cache-Control': 'no-cache',\r\n            'Pragma': 'no-cache'\r\n        };\r\n        const url = GSLoader.normalizeURL(`${me.url}/${language}.json`);\r\n        let res = await GSLoader.loadSafe(url, 'GET', headers, true);\r\n        if (!res && language.indexOf('-') > 0) res = await me.loadWait(language.split('-')[0]);\r\n        if (!res) return false;\r\n        me.#queue.delete(language);\r\n        me.#store(language, res);\r\n    }\r\n\r\n    /**\r\n     * Store object properties as set of key-value pairs,\r\n     * keys are not stores as name, but as hash calc\r\n     * values double stored as a hash-key/value and hash-value/hash-key\r\n     * \r\n     * @param {string} lang \r\n     * @param {object} obj \r\n     * @returns \r\n     */\r\n    #store(lang, obj) {\r\n        if (!(obj && lang)) return false;\r\n        const isDefault = lang === 'default';\r\n        const map = this.#getLanguage(lang);\r\n        Object.entries(obj).forEach((kv) => {\r\n            const hk = GSID.hashCode(kv[0].trim());\r\n            map.set(hk, isDefault ? GSID.hashCode(kv[1]) : kv[1]);\r\n        });\r\n        GSEvents.send(window, 'gs-language', { details: lang });\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Get language map. Create a new one if not found.\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    #getLanguage(val = '') {\r\n        const me = this;\r\n        if (!me.#languages.has(val)) {\r\n            me.#languages.set(val, new Map());\r\n        }\r\n        return me.#languages.get(val);\r\n    }\r\n\r\n}\r\n\r\nexport const GSLocalization = new GSLocalizationImpl();","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSPopper class\r\n * @module base/GSPopper\r\n */\r\n\r\nimport { GSLog } from \"./GSLog.mjs\";\r\nimport { GSCSSMap } from \"./GSCSSMap.mjs\";\r\nimport { GSDynamicStyle } from \"./GSDynamicStyle.mjs\";\r\n\r\n/**\r\n * A generic set of static functions used across GS WebComponents framework\r\n * used for placing elements at fixed positions.\r\n * Also used to replace Bootstrap popper.\r\n * @class\r\n */\r\nexport class GSPopper {\r\n\r\n\t/**\r\n\t * A simple wrapper to get element DOMRect\r\n\t * @param {HTMLElement} el \r\n\t * @returns {DOMRect}\r\n\t */\r\n\tstatic asRect(el) {\r\n\t\treturn el.getBoundingClientRect();\r\n\t}\r\n\r\n\t/**\r\n\t * Get element offset position\r\n\t * Returns absolute position {left:0, top:0, width:0, height:0,centeY:0 centerX:0}\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Object} \r\n\t */\r\n\tstatic getOffset(el) {\r\n\t\tconst rect = GSPopper.asRect(el);\r\n\t\tconst sx = window.scrollX;\r\n\t\tconst sy = window.scrollY;\r\n\t\tconst obj = {\r\n\t\t\tleft: rect.left + sx,\r\n\t\t\tright: rect.right + sx,\r\n\t\t\ttop: rect.top + sy,\r\n\t\t\tbottom: rect.bottom + sy,\r\n\t\t\theight: rect.height,\r\n\t\t\twidth: rect.width,\r\n\t\t\tx: rect.x + sx,\r\n\t\t\ty: rect.y + sy\r\n\t\t};\r\n\t\tobj.centerX = obj.left + (obj.width / 2);\r\n\t\tobj.centerY = obj.top + (obj.height / 2);\r\n\t\treturn obj;\r\n\t}\r\n\r\n\t/**\r\n\t * Return element position and size without padding\r\n\t * Returned objext is the same format as native getBoundingRect\r\n\t * @param {HTMLElement} element \r\n\t * @returns {Object} \r\n\t */\r\n\tstatic boundingRect(element, calcPadding) {\r\n\r\n\t\tconst rect = GSPopper.asRect(element);\r\n\t\tconst padding = GSPopper.elementPadding(calcPadding ? element : null);\r\n\r\n\t\tconst paddingX = padding.x;\r\n\t\tconst paddingY = padding.y;\r\n\r\n\t\tconst elementWidth = element.clientWidth - paddingX;\r\n\t\tconst elementHeight = element.clientHeight - paddingY;\r\n\r\n\t\tconst elementX = rect.left + padding.left;\r\n\t\tconst elementY = rect.top + padding.top;\r\n\r\n\t\tconst centerX = (elementWidth / 2) + elementX;\r\n\t\tconst centerY = elementY + (elementHeight / 2);\r\n\r\n\t\treturn {\r\n\t\t\twidth: elementWidth,\r\n\t\t\theight: elementHeight,\r\n\t\t\ttop: elementY,\r\n\t\t\tleft: elementX,\r\n\t\t\tx: elementX,\r\n\t\t\ty: elementY,\r\n\t\t\tcenterX: centerX,\r\n\t\t\tcenterY: centerY\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * Calculate element padding\r\n\t * @param {HTMLElement} element \r\n\t * @returns {Object}\r\n\t */\r\n\tstatic elementPadding(element) {\r\n\r\n\t\tconst obj = {\r\n\t\t\tleft: 0,\r\n\t\t\tright: 0,\r\n\t\t\ttop: 0,\r\n\t\t\tbottom: 0,\r\n\t\t\tx: 0,\r\n\t\t\ty: 0\r\n\t\t};\r\n\r\n\t\tconst isEl = element instanceof HTMLElement;\r\n\t\tif (!isEl) return obj;\r\n\t\tconst css = GSCSSMap.getComputedStyledMap(element);\r\n\r\n\t\tobj.left = css.asNum('padding-left');\r\n\t\tobj.right = css.asNum('padding-right');\r\n\t\tobj.top = css.asNum('padding-top');\r\n\t\tobj.bottom = css.asNum('padding-bottom');\r\n\t\tobj.x = obj.left + obj.right;\r\n\t\tobj.y = obj.top + obj.bottom;\r\n\r\n\t\treturn obj;\r\n\t}\r\n\r\n\t/**\r\n\t * Fixed positioning on a viewport.\r\n\t * @param {String} placement Location on target element top|bottom|left|right\r\n\t * @param {HTMLElement} source Element to show\r\n\t * @param {HTMLElement} target Element location at which to show\r\n\t * @param {Boolean} arrow if true, will calculate arrow position\r\n\t * @returns {void}\r\n\t */\r\n\tstatic popupFixed(placement = 'top', source, target, arrow) {\r\n\r\n\t\tif (!(source && target)) return false;\r\n\r\n\t\tconst pos = GSPopper.#fromPlacement(placement);\r\n\r\n\t\tif (!GSPopper.#isPlacementValid(pos)) {\r\n\t\t\tGSLog.warn(source, `Invalid popover position: ${placement}!`);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst style = GSDynamicStyle.dynamicStyle(source);\r\n\t\tif (!style) return;\r\n\r\n\t\tconst css = {\r\n\t\t\tposition: 'fixed',\r\n\t\t\ttop: '0px',\r\n\t\t\tleft: '0px',\r\n\t\t\tmargin: '0px',\r\n\t\t\tpadding: '0px',\r\n\t\t\ttransform: '',\r\n\t\t\ttranslate: ''\r\n\t\t};\r\n\r\n\t\tObject.assign(style, css);\r\n\r\n\t\tconst offh = source.clientHeight / 2;\r\n\t\tconst offw = source.clientWidth / 2;\r\n\r\n\t\tconst rect = GSPopper.boundingRect(target, arrow instanceof HTMLElement);\r\n\t\tconst arect = GSPopper.#updateArrow(source, arrow, pos);\r\n\r\n\t\tconst obj = {\r\n\t\t\tx: rect.centerX,\r\n\t\t\ty: rect.centerY,\r\n\t\t\toffH: offh,\r\n\t\t\toffW: offw,\r\n\t\t\tsrcH: source.clientHeight,\r\n\t\t\tsrcW: source.clientWidth\r\n\t\t}\r\n\r\n\t\tGSPopper.#calcFixed(pos, obj, rect, arect);\r\n\t\tstyle.translate = `${obj.x}px ${obj.y}px`;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Place element around target element. Bootstrap support for popup etc.\r\n\t * @param {String} placement Location on target element top|bottom|left|right\r\n\t * @param {HTMLElement} source Element to show\r\n\t * @param {HTMLElement} target Element location at which to show\r\n\t * @param {Boolean} arrow if true, will calculate arrow position\r\n\t * @returns {void}\r\n\t */\r\n\tstatic popupAbsolute(placement = 'top', source, target, arrow) {\r\n\r\n\t\tif (!(source && target)) return false;\r\n\r\n\t\tconst pos = GSPopper.#fromPlacement(placement);\r\n\r\n\t\tif (!GSPopper.#isPlacementValid(pos)) {\r\n\t\t\tGSLog.warn(source, `Invalid popover position: ${placement}!`);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst style = GSDynamicStyle.dynamicStyle(source);\r\n\t\tconst astyle = GSDynamicStyle.dynamicStyle(arrow);\r\n\t\tif (!style) return;\r\n\t\t\r\n\t\tconst css = {\r\n\t\t\tinset: GSPopper.#inset(pos),\r\n\t\t\tposition: 'absolute',\r\n\t\t\tmargin: '0px',\r\n\t\t\ttop: '0px',\r\n\t\t\tleft: '0px',\r\n\t\t\twidth: 'max-content',\r\n\t\t\theight: 'max-content',\t\t\t\r\n\t\t\ttransform: '',\r\n\t\t\ttranslate: ''\r\n\t\t};\r\n\r\n\t\tObject.assign(style, css);\r\n\t\tastyle.position = 'absolute';\r\n\r\n\t\tconst srect = GSPopper.asRect(source);\r\n\t\tconst arect = GSPopper.asRect(arrow);\r\n\t\tconst offset = GSPopper.getOffset(target);\r\n\r\n\t\tconst obj = {\r\n\t\t\tx: offset.centerX,\r\n\t\t\ty: offset.centerY\r\n\t\t}\r\n\r\n\t\tconst arr = {\r\n\t\t\tx: (srect.width / 2) - (arect.width / 2),\r\n\t\t\ty: (srect.height / 2) - (arect.height / 2)\r\n\t\t}\r\n\r\n\t\tGSPopper.#calcAbsolute(pos, obj, arr, srect, arect, offset);\r\n\r\n\t\tconst aopt = {\r\n\t\t\ttranslate: `${arr.x}px ${arr.y}px`,\r\n\t\t\ttop: arr.top ? arr.top : '',\r\n\t\t\tleft: arr.left ? arr.left : ''\r\n\t\t}\r\n\r\n\t\tconst opt = {\r\n\t\t\ttranslate : `${obj.x}px ${obj.y}px`\r\n\t\t};\r\n\r\n\t\tObject.assign(style, opt);\r\n\t\tObject.assign(astyle, aopt);\r\n\t}\r\n\r\n\tstatic #calcAbsolute(pos, obj, arr, srect, arect, offset) {\r\n\t\tif (pos.isTop) {\r\n\t\t\tarr.y = 0;\r\n\t\t\tarr.left = '0px';\r\n\t\t\tobj.x = obj.x - (srect.width / 2);\r\n\t\t\tobj.y = -1 * (srect.bottom - offset.top + arect.height);\r\n\t\t} else if (pos.isBottom) {\r\n\t\t\tarr.y = 0;\r\n\t\t\tarr.left = '0px';\r\n\t\t\tobj.x = obj.x - (srect.width / 2);\r\n\t\t\tobj.y = offset.bottom + arect.height;\r\n\t\t} else if (pos.isStart) {\r\n\t\t\tarr.x = 0;\r\n\t\t\tarr.top = '0px';\r\n\t\t\tobj.x = -1 * (srect.right - offset.left + arect.width);\r\n\t\t\tobj.y = obj.y - (srect.height / 2);\r\n\t\t} else if (pos.isEnd) {\r\n\t\t\tarr.x = 0;\r\n\t\t\tarr.top = '0px';\r\n\t\t\tobj.x = offset.right + arect.width;\r\n\t\t\tobj.y = obj.y - (srect.height / 2);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic #calcFixed(pos, obj, trect, arect) {\r\n\t\tif (pos.isTop) {\r\n\t\t\tobj.y = trect.top - obj.srcH - arect.size;\r\n\t\t\tobj.x = obj.x - obj.offW;\r\n\t\t} else if (pos.isBottom) {\r\n\t\t\tobj.y = trect.top + trect.height + arect.size;\r\n\t\t\tobj.x = obj.x - obj.offW;\r\n\t\t} else if (pos.isStart) {\r\n\t\t\tobj.x = trect.left - obj.srcW - arect.size;\r\n\t\t\tobj.y = obj.y - obj.offH + arect.size;\r\n\t\t} else if (pos.isEnd) {\r\n\t\t\tobj.x = trect.left + trect.width + arect.size;\r\n\t\t\tobj.y = obj.y - obj.offH + arect.size;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic #inset(obj) {\r\n\t\tif (obj.isTop) {\r\n\t\t\treturn 'auto auto 0px 0px';\r\n\t\t} else if (obj.isBottom) {\r\n\t\t\treturn '0px auto auto 0px';\r\n\t\t} else if (obj.isStart) {\r\n\t\t\treturn '0px 0px auto auto';\r\n\t\t} else if (obj.isEnd) {\r\n\t\t\treturn '0px auto auto 0px';\r\n\t\t}\r\n\t}\r\n\r\n\tstatic #isPlacementValid(obj) {\r\n\t\treturn obj.isStart || obj.isEnd || obj.isTop || obj.isBottom;\r\n\t}\r\n\r\n\tstatic #fromPlacement(placement) {\r\n\t\treturn {\r\n\t\t\tisStart: placement == 'start' || placement == 'left',\r\n\t\t\tisEnd: placement == 'end' || placement == 'right',\r\n\t\t\tisTop: placement == 'top',\r\n\t\t\tisBottom: placement == 'bottom'\r\n\t\t}\r\n\t}\r\n\r\n\tstatic #updateArrow(element, arrow, pos) {\r\n\r\n\t\tif (!arrow) return { x: 0, y: 0, size: 0, width: 0, height: 0 };\r\n\r\n\t\tlet shift = 0;\r\n\t\tconst erect = GSPopper.boundingRect(element);\r\n\t\tconst arect = GSPopper.boundingRect(arrow);\r\n\r\n\t\tconst size = pos.isStart || pos.isEnd ? arect.width : arect.height;\r\n\r\n\t\tconst arrowPosW = (erect.width / 2) - (size / 2);\r\n\t\tconst arrowPosH = (erect.height / 2) - (size / 2);\r\n\r\n\t\tarect.size = size;\r\n\r\n\t\tconst opt = {};\r\n\r\n\t\topt.position = 'absolute';\r\n\r\n\t\tif (pos.isStart || pos.isEnd) {\r\n\t\t\topt.left = '';\r\n\t\t\topt.top = '0px';\r\n\t\t\tshift = 0; //pos.isStart ? size : -1 * size;\r\n\t\t\topt.translate = `${shift}px ${arrowPosH / 2}px`;\r\n\t\t} else {\r\n\t\t\topt.top = '';\r\n\t\t\topt.left = '0px';\r\n\t\t\tshift = 0; //pos.isTop ? size : -1 * size;\r\n\t\t\topt.translate = `${arrowPosW}px ${shift}px`;\r\n\t\t}\r\n\r\n\t\tGSDynamicStyle.applyDynamicStyle(arrow, opt);\r\n\r\n\t\treturn arect;\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.seal(GSPopper);\r\n\t\tglobalThis.GSPopper = GSPopper;\r\n\t}\r\n}\r\n\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSCSSMap } from \"./GSCSSMap.mjs\";\r\n\r\n/**\r\n * Proxy class to handle chained css.\r\n * Used internally, see GSQuery class.\r\n */\r\nexport class GSQueryCSS {\r\n\r\n    #map = null;\r\n\r\n    constructor(element) {\r\n        if (!GSDOM.isHTMLElement(element)) throw new Error('Only HTMLElement type allowed!');\r\n        this.#map = new GSCSSMap(element);\r\n    }\r\n\r\n    #isFunc(property) {\r\n        return GSFunction.hasFunction(this.#map, property);\r\n    }\r\n\r\n    get(object, property, receiver) {\r\n        return (value, dft) => {\r\n            const me = this;\r\n            if (GSUtil.isNull(value)) return me.#map.get(property);\r\n            if (me.#isFunc(property)) return me.#map[property](value, dft);\r\n            object[property] = value;\r\n            return receiver;\r\n        }\r\n    }\r\n\r\n    static wrap(element) {\r\n        return new Proxy(element.style, new GSQueryCSS(element));\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSQueryCSS } from \"./GSQueryCSS.mjs\";\r\n\r\n/**\r\n * Proxy class for wrapping HTMLElement, allowing to use GS query across shadow dom\r\n * and css operations for easier property get /set\r\n * \r\n * const el = GSQuery.wrap(document.body);\r\n * el.query('div') // query across shadow dom\r\n * el.css = {width:'100px'} // easier way to set css\r\n * \r\n * // chained css property setup\r\n * el.css.width('100px').background('red')\r\n * \r\n * // retrieve calculated value\r\n * console.log(el.css.background)\r\n * console.log(el.css.asNum('width'))\r\n */\r\nexport class GSQuery {\r\n\r\n    #css = null;\r\n\r\n    constructor(element) {\r\n        if (!Array.isArray(element)) this.#css = GSQueryCSS.wrap(element);\r\n    }\r\n\r\n    get(object, property) {\r\n        if (property === 'css') return this.#css;\r\n        if (property === 'query') {\r\n            return (value, all, shadow) => {\r\n                const el = GSDOM.query(object, value, all, shadow);\r\n                return GSQuery.wrap(el);\r\n            }\r\n        }\r\n        if (property === 'queryAll') {\r\n            return (value, all, shadow) => {\r\n                const el = GSDOM.queryAll(object, value, all, shadow);\r\n                return GSQuery.wrap(el);\r\n            }\r\n        }\r\n        return object[property];\r\n    }\r\n\r\n    set(object, property, value) {\r\n        switch (property) {\r\n            case 'css':\r\n                if (Array.isArray(object)) {\r\n                    object.forEach(element => element[property] = value);\r\n                } else {\r\n                    GSDOM.css(object, value);\r\n                }\r\n                break;\r\n            default:\r\n                object[property] = value;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    static instance(node) {\r\n        return new Proxy(node, new GSQuery(node));\r\n    }\r\n\r\n    static wrap(node) {\r\n        if (GSDOM.isHTMLElement(node)) return GSQuery.instance(node);\r\n        if (!Array.isArray(node)) return node;\r\n        node = node.map(element => GSQuery.wrap(element));\r\n        return GSQuery.instance(node);\r\n    }\r\n\r\n    static all(own, qry, all, shadow) {\r\n        return GSQuery.wrap(GSDOM.queryAll(own, qry, all, shadow));\r\n    }\r\n\r\n    static first(own, qry, all, shadow) {\r\n        return GSQuery.wrap(GSDOM.query(own, qry, all, shadow));\r\n    }\r\n\r\n    static {\r\n        Object.freeze(GSQuery);\r\n        globalThis.GSQuery = GSQuery;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSRouter class\r\n * @module base/GSRouter\r\n */\r\n\r\nimport { GSLog } from \"./GSLog.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSData } from \"./GSData.mjs\";\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSEvents } from \"./GSEvents.mjs\";\r\nimport { GSLoader } from \"./GSLoader.mjs\";\r\nimport { GSAttributeHandler } from \"./GSAttributeHandler.mjs\";\r\n\r\n/**\r\n * Class for handling hash based routing.\r\n * Class uses GSAttributeHandler and optional JSON definition to handle routing.\r\n * \r\n * Use globalThis.GS_ROUTER_URL before loading this module to define JSON definition file location\r\n * @Class\r\n */\r\nexport class GSRouter {\r\n\r\n    #logging = true;\r\n    #enabled = false;\r\n    #hashCallback = null;\r\n    #definition = {};\r\n\r\n    constructor() {\r\n        this.#hashCallback = this.#onHashChange.bind(this);\r\n    }\r\n\r\n    /**\r\n     * Loda JSON definition for routing from JSON document.\r\n     * @param {string} url \r\n     * @returns \r\n     */\r\n    async loadDefinition(url) {\r\n        return GSLoader.getRouter(url);\r\n    }\r\n\r\n    /**\r\n     * Initialize routing from provided URL\r\n     * @param {string} url \r\n     * @param {number} wait in ms\r\n     */\r\n    async initialize(url, wait = 0) {\r\n        const me = this;\r\n        if (GSUtil.isStringNonEmpty(url)) {\r\n            me.#definition = await me.loadDefinition(url);\r\n        }\r\n        if (wait > 0) {\r\n            await GSEvents.waitPageLoad(null, null, null, wait);\r\n        }\r\n        me.enable();\r\n        me.#onHashChange();        \r\n    }\r\n\r\n    /**\r\n     * Enable routing\r\n     */\r\n    enable() {\r\n        if (this.#enabled) return;\r\n        GSEvents.on(globalThis, null, 'hashchange', this.#hashCallback);\r\n        this.#enabled = true;\r\n    }\r\n\r\n    /**\r\n     * Disable routing\r\n     */\r\n    disable() {\r\n        GSEvents.off(globalThis, null, 'hashchange', this.#hashCallback);\r\n        this.#enabled = false;\r\n    }\r\n\r\n    /**\r\n     * Register a single route with options\r\n     * @param {string} route Abstract url for a route\r\n     * @param {Object} options \r\n     */\r\n    register(route, options) {\r\n        this.#definition[route] = options;\r\n    }\r\n\r\n    /**\r\n     * Unregister a single route\r\n     * @param {string} route \r\n     */\r\n    unregister(route) {\r\n        delete this.#definition[route];\r\n    }\r\n\r\n    /**\r\n     * Get URL hashbang without hash\r\n     */\r\n    get hash() {\r\n        return location.hash.slice(1);\r\n    }\r\n\r\n    /**\r\n     * Return routing definition object\r\n     */\r\n    get definition() {\r\n        return GSData.deepClone(this.#definition);\r\n    }\r\n\r\n    get log() {\r\n        return this.#logging;\r\n    }\r\n\r\n    set log(val) {\r\n        this.#logging = GSUtil.asBool(val);\r\n    }\r\n\r\n    #onHashChange() {\r\n        const me = this;\r\n        const def = me.#definition[\"#def\"] || {};\r\n        const defaults = me.#definition[\"#defaults\"] || {};\r\n        const route = me.#definition[me.hash];\r\n        if (route) {\r\n            const el = GSDOM.fromJson(Object.assign({}, route, def, defaults));\r\n            el.dataset.gsHashed = true;\r\n            const px = GSAttributeHandler.proxify(el);\r\n            GSAttributeHandler.process(px);\r\n        } else if (me.#logging) {\r\n            GSLog.warn(null, `No routing definition found for: ${me.hash}`);\r\n        }\r\n    }\r\n\r\n    static {\r\n        if (globalThis.GS_DEFINITION_URL) {\r\n            new GSRouter().initialize(globalThis.GS_DEFINITION_URL, globalThis.GS_ROUTER_WAIT);\r\n        }\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSTheme class\r\n * @module base/GSTheme\r\n */\r\n\r\n/**\r\n * Switch between dark and light mode\r\n * @Class\r\n */\r\nexport class GSTheme {\r\n\r\n    static #STORAGE = 'gs-theme-mode';\r\n\r\n    /**\r\n     * Changes the theme to 'dark mode' and save settings to local stroage.\r\n     * Basically, replaces/toggles every CSS class that has '-light' class with '-dark'\r\n     * @param {HTMLElement} el \r\n     */\r\n    static darkMode(el) {\r\n        GSTheme.#switch(el, 'light', 'dark');\r\n    }\r\n\r\n    /**\r\n     * Changes the theme to 'light mode' and save settings to local stroage.\r\n     * @param {HTMLElement} el \r\n     */\r\n    static lightMode(el) {\r\n        GSTheme.#switch(el, 'dark', 'light');\r\n    }\r\n\r\n    static #switch(el, from = 'light', to = 'dark') {\r\n\r\n        const root = el || document.body;\r\n\r\n        // TODO  switch dark/light mode ?!??!? \r\n\r\n        // save last state\r\n        GSTheme.theme = to;\r\n    }\r\n\r\n    static get theme() {\r\n        return localStorage.getItem(GSTheme.#STORAGE);\r\n    }\r\n\r\n    static set theme(val) {\r\n        localStorage.setItem(GSTheme.#STORAGE, val);\r\n        window.dispatchEvent(new CustomEvent('gs-theme', { detail: val }));\r\n        const htmlEl = document.head.parentElement;\r\n        if (val) {\r\n            htmlEl.dataset.bsTheme = val;\r\n        } else {\r\n            delete htmlEl.dataset.bsTheme;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get system default theme by media query\r\n     * @returns {String} dark|light \r\n     */\r\n    static getSystemDefaultTheme() {\r\n        const darkThemeMq = window.matchMedia('(prefers-color-scheme: dark)');\r\n        return darkThemeMq.matches ? 'dark' : 'light';\r\n    }\r\n\r\n    static #onTheme(e) {\r\n        const q = new URLSearchParams(location.hash.slice(1));\r\n        GSTheme.theme = q.get('theme');\r\n    }\r\n\r\n    static #setup() {\r\n        window.addEventListener('hashchange', GSTheme.#onTheme)\r\n        let settings = localStorage.getItem(GSTheme.#STORAGE);\r\n        if (settings == null) {\r\n            settings = GSTheme.getSystemDefaultTheme();\r\n        }\r\n\r\n\r\n        if (settings == 'dark') return GSTheme.darkMode();\r\n        if (settings == 'light') return GSTheme.lightMode();\r\n        // TODO switch\r\n\r\n    }\r\n\r\n    static {\r\n        GSTheme.#setup();\r\n        globalThis.GSTheme = GSTheme;\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/*\r\nconst tree = new BinaryTree(1, 'AB');\r\n\r\ntree.insert(1, 11, 'AC');\r\ntree.insert(1, 12, 'BC');\r\ntree.insert(12, 121, 'BG', { right: true });\r\n\r\n[...tree.preOrderTraversal()].map(x => x.value);\r\n// ['AB', 'AC', 'BC', 'BCG']\r\n\r\n[...tree.inOrderTraversal()].map(x => x.value);\r\n// ['AC', 'AB', 'BC', 'BG']\r\n\r\ntree.value;                // 'AB'\r\ntree.hasChildren;          // true\r\n\r\ntree.find(12).isLeaf;           // false\r\ntree.find(121).isLeaf;          // true\r\ntree.find(121).parent.value;    // 'BC'\r\ntree.find(12).left;             // null\r\ntree.find(12).right.value;      // 'BG'\r\n\r\ntree.remove(12);\r\n\r\n[...tree.postOrderTraversal()].map(x => x.value);\r\n// ['AC', 'AB']\r\n*/\r\n\r\n/**\r\n * Binary Tree Node data holder\r\n */\r\nexport class BinaryTreeNode {\r\n\r\n    constructor(key, value = key, parent = null) {\r\n        this.key = key;\r\n        this.value = value;\r\n        this.parent = parent;\r\n        this.left = null;\r\n        this.right = null;\r\n    }\r\n\r\n    /**\r\n     * Check if both left and right are empty.\r\n     */\r\n    get isLeaf() {\r\n        return this.left === null && this.right === null;\r\n    }\r\n\r\n    /**\r\n     * Check if node has children\r\n     */\r\n    get hasChildren() {\r\n        return !this.isLeaf;\r\n    }\r\n\r\n    /**\r\n     * Check if node is main root node \r\n     */\r\n    get isRoot() {\r\n        return this.parent ? false : true;\r\n    }\r\n\r\n    /**\r\n     * Get main root node\r\n     */\r\n    get root() {\r\n        return this.parent?.root || this;\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * Binary tree implementation\r\n */\r\nexport class BinaryTree extends BinaryTreeNode {\r\n\r\n    constructor(key, value = key) {\r\n        super(key, value);\r\n    }\r\n\r\n    /**\r\n     * Generator method that traverses the binary tree in in-order, \r\n     * using the yield* syntax to recursively delegate traversal to itself.\r\n     * @param {BinaryTreeNode} node \r\n     */\r\n    *inOrderTraversal(node = this) {\r\n        if (node.left) yield* this.inOrderTraversal(node.left);\r\n        yield node;\r\n        if (node.right) yield* this.inOrderTraversal(node.right);\r\n    }\r\n\r\n    /**\r\n     * Generator method that traverses the binary tree in post-order, \r\n     * using the yield* syntax to recursively delegate traversal to itself.\r\n     * @param {BinaryTreeNode} node \r\n     */\r\n    *postOrderTraversal(node = this) {\r\n        if (node.left) yield* this.postOrderTraversal(node.left);\r\n        if (node.right) yield* this.postOrderTraversal(node.right);\r\n        yield node;\r\n    }\r\n\r\n    /**\r\n     * Generator method that traverses the binary tree in pre-order, \r\n     * using the yield* syntax to recursively delegate traversal to itself.\r\n     * @param {BinaryTreeNode} node \r\n     */\r\n    *preOrderTraversal(node = this) {\r\n        yield node;\r\n        if (node.left) yield* this.preOrderTraversal(node.left);\r\n        if (node.right) yield* this.preOrderTraversal(node.right);\r\n    }\r\n\r\n    /**\r\n     * Uses the preOrderTraversal() method to find the given parent node and \r\n     * insert a new child BinaryTreeNode either as the left or right child, \r\n     * depending on the passed options object.\r\n     * @param {*} parentNodeKey \r\n     * @param {*} key \r\n     * @param {*} value \r\n     * @param {*} options \r\n     * @returns {boolean} Return true if data inserted\r\n     */\r\n    insert(\r\n        parentNodeKey,\r\n        key,\r\n        value = key,\r\n        { left, right } = { left: true, right: true }\r\n    ) {\r\n        for (let node of this.preOrderTraversal()) {\r\n            if (node.key === parentNodeKey) {\r\n                const canInsertLeft = left && node.left === null;\r\n                const canInsertRight = right && node.right === null;\r\n                if (!canInsertLeft && !canInsertRight) return false;\r\n                if (canInsertLeft) {\r\n                    node.left = new BinaryTreeNode(key, value, node);\r\n                    return true;\r\n                }\r\n                if (canInsertRight) {\r\n                    node.right = new BinaryTreeNode(key, value, node);\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Uses the preOrderTraversal() method to remove a BinaryTreeNode from the binary tree.\r\n     * @param {*} key \r\n     * @returns \r\n     */\r\n    remove(key) {\r\n        for (let node of this.preOrderTraversal()) {\r\n            if (node.left.key === key) {\r\n                node.left = null;\r\n                return true;\r\n            }\r\n            if (node.right.key === key) {\r\n                node.right = null;\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Uses the preOrderTraversal() method to retrieve the given node in the binary tree.\r\n     * @param {*} key \r\n     * @returns \r\n     */\r\n    find(key) {\r\n        for (let node of this.preOrderTraversal()) {\r\n            if (node.key === key) return node;\r\n        }\r\n        return undefined;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/*\r\nconst list = new DoublyLinkedList();\r\n\r\nlist.insertFirst(1);\r\nlist.insertFirst(2);\r\nlist.insertFirst(3);\r\nlist.insertLast(4);\r\nlist.insertAt(3, 5);\r\n\r\nlist.size;                      // 5\r\nlist.head.value;                // 3\r\nlist.head.next.value;           // 2\r\nlist.tail.value;                // 4\r\nlist.tail.previous.value;       // 5\r\n[...list].map(e => e.value);    // [3, 2, 1, 5, 4]\r\n\r\nlist.removeAt(1);               // 2\r\nlist.getAt(1).value;            // 1\r\nlist.head.next.value;           // 1\r\n[...list].map(e => e.value);    // [3, 1, 5, 4]\r\n\r\nlist.reverse();\r\n[...list].map(e => e.value);    // [4, 5, 1, 3]\r\n\r\nlist.clear();\r\nlist.size;                      // 0\r\n*/\r\n\r\n/**\r\n *  Linear data structure following doubly linked list order of operations.\r\n */\r\nexport class Node {\r\n\r\n    value = null;\r\n    next = null;\r\n    previous = null;\r\n\r\n    constructor(value, next = null, previous = null) {\r\n        this.value = value;\r\n        this.next = next;\r\n        this.previous = previous;\r\n    }\r\n\r\n    /**\r\n     * Use internally only or make sure node is deatached\r\n     */\r\n    release() {\r\n        this.value = undefined;\r\n        this.next = undefined;\r\n        this.previous = undefined;\r\n    }\r\n\r\n    toJSON() {\r\n        return this.value;\r\n    }\r\n}\r\n\r\nexport class DoublyLinkedList {\r\n\r\n    #nodes = [];\r\n\r\n    /**\r\n     * Number of elements in the list\r\n     */\r\n    get size() {\r\n        return this.#nodes.length;\r\n    }\r\n\r\n    /**\r\n     * First element in the list\r\n     */\r\n    get head() {\r\n        return this.size ? this.#nodes[0] : null;\r\n    }\r\n\r\n    /**\r\n     * Last elemet in the list\r\n     */\r\n    get tail() {\r\n        return this.size ? this.#nodes[this.size - 1] : null;\r\n    }\r\n\r\n    /**\r\n     * Create new linked node\r\n     * @param {*} value \r\n     * @param {*} nextNode \r\n     * @param {*} previousNode \r\n     * @returns \r\n     */\r\n    create(value, nextNode, previousNode) {\r\n        return new Node(value, nextNode, previousNode);\r\n    }\r\n\r\n    /**\r\n     * Insert data to the given position in the list\r\n     * @param {*} index \r\n     * @param {*} value \r\n     * @param {*} safe \r\n     * @returns \r\n     */\r\n    insertAt(index, value, safe) {\r\n        if (!this.#validate(index, safe)) return false;\r\n\r\n        const previousNode = this.#nodes[index - 1] || null;\r\n        const nextNode = this.#nodes[index] || null;\r\n        const node = this.create(value, nextNode, previousNode);\r\n\r\n        if (previousNode) previousNode.next = node;\r\n        if (nextNode) nextNode.previous = node;\r\n        this.#nodes.splice(index, 0, node);\r\n    }\r\n\r\n    /**\r\n     * Insert data to the beginning of the list\r\n     * @param {*} value \r\n     */\r\n    insertFirst(value) {\r\n        this.insertAt(0, value);\r\n    }\r\n\r\n    /**\r\n     * Insert data to the end of the list\r\n     * @param {*} value \r\n     */\r\n    insertLast(value) {\r\n        this.insertAt(this.size, value);\r\n    }\r\n\r\n    /**\r\n     * Retrieves the data in the given index\r\n     * @param {Number} index \r\n     * @returns \r\n     */\r\n    getAt(index) {\r\n        return this.#nodes[index];\r\n    }\r\n\r\n    indexOf(val) {\r\n        return this.#nodes.indexOf(val);\r\n    }\r\n\r\n    /**\r\n     * Remove the data at the given index\r\n     * @param {*} index \r\n     * @param {*} safe \r\n     * @returns \r\n     */\r\n    removeAt(index, safe) {\r\n\r\n        if (!this.#validate(index, safe)) return false;\r\n\r\n        const previousNode = this.#nodes[index - 1] || null;\r\n        const nextNode = this.#nodes[index + 1] || null;\r\n\r\n        if (previousNode) previousNode.next = nextNode;\r\n        if (nextNode) nextNode.previous = previousNode;\r\n\r\n        return this.#nodes.splice(index, 1);\r\n    }\r\n\r\n    /**\r\n     * Clear list\r\n     */\r\n    clear(full = true) {\r\n        if (full) this.#nodes.forEach(o => o.release());\r\n        this.#nodes = [];\r\n    }\r\n\r\n    /**\r\n     * Reverse data order\r\n     */\r\n    reverse() {\r\n        this.#nodes = this.#nodes.reduce((acc, { value }) => {\r\n            const nextNode = acc[0] || null;\r\n            const node = new Node(value, nextNode, null);\r\n            if (nextNode) nextNode.previous = node;\r\n            return [node, ...acc];\r\n        }, []);\r\n    }\r\n\r\n    toArray() {\r\n        return this.#nodes.map(e => e.value);\r\n    }\r\n\r\n    toJSON() {\r\n        return this.#nodes;\r\n    }\r\n\r\n    *[Symbol.iterator]() {\r\n        yield* this.#nodes;\r\n    }\r\n\r\n    #validate(index, safe = false) {\r\n        const isInvalid = this.#isInvalidIndex(index);\r\n        if (isInvalid) {\r\n            if (safe) {\r\n                console.log(this.#error());\r\n            } else {\r\n                throw new Error(this.#error());\r\n            }\r\n        }\r\n        return !isInvalid;\r\n    }\r\n\r\n    #isInvalidIndex(index) {\r\n        return !Number.isInteger(index) || index < 0 || index > this.size;\r\n    }\r\n\r\n    #error() {\r\n        return `Invalid index. Current length is ${this.size}.`;\r\n    }\r\n\r\n    /**\r\n     * Convert array to linked list\r\n     * @param {*} data \r\n     * @returns \r\n     */\r\n    static from(data) {\r\n        const list = new DoublyLinkedList();\r\n        if (Array.isArray(data)) data.forEach(v => list.insertLast(v));\r\n        return list;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/*\r\nconst list = new LinkedList(1);\r\n\r\nlist.append(2).append(3).append(4);\r\n\r\n*/\r\n\r\n/**\r\n * Node data holder\r\n */\r\nexport class LinkedList {\r\n\r\n    #value = null;\r\n    #next = null;\r\n    #previous = null;\r\n\r\n    constructor(value, next = null, previous = null) {\r\n        this.#value = value;\r\n        this.#next = next;\r\n        this.#previous = previous;\r\n    }\r\n\r\n    remove() {\r\n        this.#previous.#next = this.#next;\r\n        this.#next.#previous = this.#previous;\r\n        this.#release();\r\n    }\r\n\r\n    /**\r\n     * Append node after \r\n     * @param {*} node \r\n     */\r\n    append(node) {\r\n        node = this.#wrap(node);\r\n        node.#next = this.#next;\r\n        node.#previous = this;\r\n        this.#next = node;\r\n        return node;\r\n    }\r\n\r\n    /**\r\n     * Insert node before\r\n     * @param {*} node \r\n     */\r\n    insert(node) {\r\n        node = this.#wrap(node);\r\n        node.#previous = this.#previous;\r\n        node.#next = this;\r\n        this.#previous = node;\r\n        return node;\r\n    }\r\n\r\n    update(val) {\r\n        this.#value = val;\r\n        return this;\r\n    }\r\n\r\n    #wrap(node) {\r\n        return node instanceof LinkedList ? node : new LinkedList(node);\r\n    }\r\n\r\n    /**\r\n     * Use internally only or make sure node is deatached\r\n     */\r\n    #release() {\r\n        this.#value = undefined;\r\n        this.#next = undefined;\r\n        this.#previous = undefined;\r\n    }\r\n\r\n    toJSON() {\r\n        return this.#value;\r\n    }\r\n\r\n    get head() {\r\n        return this.previous?.head || this;\r\n    }\r\n\r\n    get tail() {\r\n        return this.next?.tail || this;\r\n    }\r\n\r\n    get next() {\r\n        return this.#next;\r\n    }\r\n\r\n    get previous() {\r\n        return this.#previous;\r\n    }\r\n\r\n    get value() {\r\n        return this.#value;\r\n    }\r\n\r\n    static isNode(val) {\r\n        return val instanceof LinkedList;\r\n    }\r\n\r\n    /**\r\n     * Convert array to linked list\r\n     * @param {*} data \r\n     * @returns \r\n     */\r\n    static from(data) {\r\n        if (!Array.isArray(data)) return null;\r\n        const root = new LinkedList();\r\n        data.reduce((node, val, idx) => idx === 1 ? root.update(node).append((val)) : node.append(val));\r\n        return root;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n *  Linear data structure following last in, first out (LIFO) order of operations.\r\n */\r\nexport class Stack extends Array {\r\n    \r\n    push(item) {\r\n        this.unshift(item);\r\n    }\r\n\r\n    pop() {\r\n        return this.shift();\r\n    }\r\n\r\n    peek() {\r\n        return this[0];\r\n    }\r\n\r\n    isEmpty() {\r\n        return this.length === 0;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n *  Linear data structure following first in, first out (FIFO) order of operations.\r\n */\r\nexport class Queue extends Array {\r\n    \r\n    enqueue(item) {\r\n        this.push(item);\r\n    }\r\n\r\n    dequeue() {\r\n        return this.shift();\r\n    }\r\n\r\n    peek() {\r\n        return this[0];\r\n    }\r\n\r\n    isEmpty() {\r\n        return this.length === 0;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Tree Node data holder\r\n */\r\nexport class Tree {\r\n\r\n    value;\r\n\r\n    #key = null;\r\n    #parent = null;\r\n    #children;\r\n\r\n    #folder = false;\r\n    #level = 0;\r\n\r\n    constructor(key, value = key, parent = null, level = 0) {\r\n        this.#key = key;\r\n        this.#parent = parent;\r\n        this.#folder = value?.leaf === false;\r\n        this.#level = parent ? parent.level + 1 : level;\r\n        this.#children = this.#folder ? [] : undefined;\r\n        this.value = value;\r\n    }\r\n\r\n    /**\r\n     * Return tree list from root to this node.\r\n     */\r\n    get subtree() {\r\n        return Array.from(this.up(undefined, false, true, true));\r\n    }\r\n\r\n    get levelID() {\r\n        return this.subtree.map(o => o.level).join('.');\r\n    }\r\n\r\n    /**\r\n     * Unique node canonical form\r\n     */\r\n    get nodeID() {\r\n        //if (this.parent?.level < 0) return this.index;\r\n        return this.subtree.map(o => o.index).join('.');\r\n    }\r\n\r\n    get path() {\r\n        return this.subtree.map(o => o.key).join('/');\r\n    }\r\n\r\n    get index() {\r\n        return this.parent?.nodes.indexOf(this) || 0;\r\n    }\r\n\r\n    get size() {\r\n        return this.#children?.length || -1;\r\n    }\r\n\r\n    get level() {\r\n        return this.#level;\r\n    }\r\n\r\n    /**\r\n     * Check if node is main root node \r\n     */\r\n    get isRoot() {\r\n        return this.parent ? false : true;\r\n    }\r\n\r\n    /**\r\n     * Check if #children is empty\r\n     */\r\n    get isLeaf() {\r\n        return !this.#folder;\r\n    }\r\n\r\n    get isFolder() {\r\n        return this.#folder;\r\n    }\r\n\r\n    /**\r\n     * Check if has #childrens\r\n     */\r\n    get hasChildren() {\r\n        return this.#folder && this.size > 0;\r\n    }\r\n\r\n    /**\r\n     * Get parent node, readonly\r\n     */\r\n    get key() {\r\n        this.#key ??= this.nodeID;\r\n        return this.#key;\r\n    }\r\n\r\n    get nodes() {\r\n        return this.#children;\r\n    }\r\n\r\n    /**\r\n     * Get parent node, readonly\r\n     */\r\n    get parent() {\r\n        return this.#parent;\r\n    }\r\n\r\n    /**\r\n     * Get main root node\r\n     */\r\n    get root() {\r\n        return this.parent?.root || this;\r\n    }\r\n\r\n    /**\r\n     * Check if there are more siblings \r\n     */\r\n    get hasMore() {\r\n        return this.#parent?.size > this.index + 1;\r\n    }\r\n\r\n    get firstChild() {\r\n        return this.hasMore ? this.#children[0] : undefined;\r\n    }\r\n\r\n    get lastChild() {\r\n        return this.hasMore ? this.#children[this.#children.length - 1] : undefined;\r\n    }\r\n\r\n    get next() {\r\n        return this.down(this, false, false).next().value || this.nextSibling || this.parent?.nextSibling;\r\n    }\r\n\r\n    get previous() {\r\n        const node = this.previousSibling;\r\n        return (node?.hasChildren) ? node.lastChild : node || this.up(this, false, false).next().value;\r\n    }\r\n\r\n    get nextSibling() {\r\n        return this.hasMore ? this.#parent.#children[this.index + 1] : undefined;\r\n    }\r\n\r\n    get previousSibling() {\r\n        return this.index > 0 ? this.#parent.#children[this.index - 1] : undefined;\r\n    }\r\n\r\n    /**\r\n     * Clear all #children\r\n     */\r\n    clear() {\r\n        if (this.#children) {\r\n            this.#children.forEach(o => o.release?.());\r\n            this.#children = [];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Used internally, if called externally, \r\n     * make sure node is removed from parent \r\n     */\r\n    release() {\r\n        this.clear();\r\n        this.#key = null;\r\n        this.value = null;\r\n        this.#parent = null;\r\n    }\r\n\r\n    /**\r\n     * Walk down the tree\r\n     * @param {Tree} node starting node\r\n     * @param {Boolean} values yield values instead nodes\r\n     * @param {Boolean} inclusive include self\r\n     * @param {Boolean} reverse Order direction\r\n     * @param {Boolean} flat Navigate all nodes out of subtree\r\n     */\r\n    *down(node = this, values = false, inclusive = true, reverse = false, flat = false) {\r\n        const o = values ? node.value : node;\r\n        if (inclusive && !reverse && node.level > -1) yield o;\r\n        if (node.#children?.length) {\r\n            for (let child of node.#children) {\r\n                yield* this.down(child, values, true, reverse, flat);\r\n            }\r\n        }\r\n        if (flat) {\r\n            const item = node.nextSibling || node.parent.nextSibling;\r\n            if (item) yield* this.down(item, values, true, reverse, flat);\r\n        }\r\n        /*\r\n        */\r\n        if (inclusive && reverse && node.level > -1) yield o;\r\n    }\r\n\r\n    /**\r\n     * Walk up the tree\r\n     * @param {Tree} node starting node\r\n     * @param {Boolean} values yield values instead nodes\r\n     * @param {Boolean} inclusive include self\r\n     * @param {Boolean} reverse Order direction\r\n     */\r\n    *up(node = this, values = false, inclusive = true, reverse = false, flat = false) {\r\n        const o = values ? node.value : node;\r\n        if (inclusive && !reverse && node.level > -1) yield o;\r\n        if (flat) {\r\n            let item = node.previousSibling;\r\n            item = item?.isFolder ? item.lastChild : item;\r\n            if (item) yield* this.up(item, values, true, reverse, flat);\r\n        }        \r\n        if (node.parent) {\r\n            yield* this.up(node.parent, values, true, reverse, flat);\r\n        }\r\n        if (inclusive && reverse && node.level > -1) yield o;\r\n    }\r\n\r\n    /**\r\n     * Walk through all nodes\r\n     * @param {*} node \r\n     */\r\n    walk = this.down;\r\n\r\n    /**\r\n     * Simulate array function \"forEach\"\r\n     * @param {*} callback \r\n     * @param {*} flat If set, will iterate all nodes, otherwise only cildrens and subtrees\r\n     * @param {*} reverse If set, will iterate up the tree\r\n     * @returns \r\n     */\r\n    forEach(callback, flat = false, reverse = false) {\r\n        this.every((node, index) => {\r\n            callback(node, index);\r\n            return true;\r\n        }, flat, reverse);\r\n    }\r\n\r\n    /**\r\n     * Simulate array function \"every\"\r\n     * @param {*} callback \r\n     * @param {*} flat If set, will iterate all nodes, otherwise only cildrens and subtrees\r\n     * @param {*} reverse If set, will iterate up the tree\r\n     * @returns \r\n     */    \r\n    every(callback, flat = false, reverse = false) {\r\n        const it = this.iterate(flat, reverse);\r\n        let sts = true;\r\n        let i = 0;\r\n        for (let node of it) {\r\n            sts = callback(node, i++);\r\n            if (!sts) break;\r\n        }\r\n        return sts;\r\n    }\r\n\r\n    /**\r\n     * Simulate array function \"find\"\r\n     * @param {*} callback \r\n     * @param {*} flat If set, will iterate all nodes, otherwise only cildrens and subtrees\r\n     * @param {*} reverse If set, will iterate up the tree\r\n     * @returns \r\n     */    \r\n    find(callback, flat = false, reverse = false) {\r\n        const it = this.iterate(flat, reverse);\r\n        let i = 0;\r\n        for (let node of it) {\r\n            if (callback(node, i++)) return node;\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    /**\r\n     * Simulate array function \"filter\"\r\n     * @param {*} callback \r\n     * @param {*} flat If set, will iterate all nodes, otherwise only childrens and subtrees\r\n     * @param {*} reverse If set, will iterate up the tree\r\n     * @returns \r\n     */    \r\n    filter(callback, flat, reverse) {\r\n        return [...this.#filtered(callback, flat, reverse)];\r\n    }\r\n\r\n    *#filtered(callback, flat, reverse) {\r\n        const it = this.iterate(flat, reverse);\r\n        for (let node of it) {\r\n            let res = callback(node);\r\n            if (res) yield node;\r\n        }        \r\n    }\r\n\r\n    /**\r\n     * Iterate all nodes\r\n     * @param {boolean} flat If set, will iterate all nodes, otherwise only cildrens and subtrees\r\n     * @param {boolean} reverse If set, will iterate up the tree\r\n     */\r\n    *iterate(flat, reverse) {\r\n        reverse ? yield* this.up(this, false, false, false, flat) : yield* this.down(this, false, false,  false, flat);\r\n    }\r\n\r\n    /**\r\n     * Add a new Tree to the tree.\r\n     * @param {*} key \r\n     * @param {*} value \r\n     * @returns \r\n     */\r\n    append(key, value = key) {\r\n        let newOne = undefined;\r\n        if (key instanceof Tree) {\r\n            key.#parent = this;\r\n            key.#level = this.#level + 1;\r\n            newOne = key;\r\n        } else {\r\n            newOne = new Tree(key, value, this);\r\n        }\r\n        this.#folder = true;\r\n        this.#children ??= [];\r\n        this.#children.push(newOne);\r\n        return newOne;\r\n    }\r\n\r\n    /**\r\n     * Uses the walk() method and Array.prototype.push() \r\n     * to add a new Tree to the tree.\r\n     * @param {*} parentNodeKey \r\n     * @param {*} key \r\n     * @param {*} value \r\n     * @returns \r\n     */\r\n    insert(parentNodeKey, key, value = key) {\r\n        for (let node of this.walk()) {\r\n            if (node.key === parentNodeKey) {\r\n                const newOne = new Tree(key, value, node);\r\n                this.#folder = true;\r\n                this.#children ??= [];\r\n                node.#children.push(newOne);\r\n                return newOne;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Remove node from tree. If key is set, will search for first node with matching key.\r\n     * @param {*} key \r\n     * @returns \r\n     */\r\n    remove(key) {\r\n\r\n        const me = this;\r\n\r\n        if (key) {\r\n            const node = me.findByKey(key);\r\n            node?.remove();\r\n            return node;\r\n        }\r\n\r\n        if (me.isRoot) throw new Error('Root node can\\'t be removed!');\r\n        const node = me.parent;\r\n        const filtered = node.#children.filter(c => c !== me);\r\n        if (filtered.length !== node.#children.length) {\r\n            node.#children = filtered;\r\n            return me;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Uses the walk() method to retrieve the given node in the tree.\r\n     * @param {*} key \r\n     * @returns \r\n     */\r\n    findByKey(key) {\r\n        for (let node of this.walk()) {\r\n            if (node.key === key) return node;\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    /**\r\n     * Convert tree into array list\r\n     * @returns \r\n     */\r\n    flatten(values, inclusive, reverse) {\r\n        return [...this.down(this, values, inclusive, reverse)];\r\n    }\r\n\r\n    /**\r\n     * Load JSON data into tree\r\n     * @param {*} data \r\n     */\r\n    fromJSON(data) {\r\n        if (data) Tree.from(this, data);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Used by JSON.stringify to properly export as JSON\r\n     * @returns \r\n     */\r\n    toJSON() {\r\n        if (this.level < 0) return this.#children?.map(o => o.toJSON()) || {};\r\n        return this.isLeaf ? { key: this.key, value: this.value } :\r\n            {\r\n                key: this.key,\r\n                value: this.value,\r\n                items: this.#children.map(o => o.toJSON())\r\n            };\r\n    }\r\n\r\n    /**\r\n     * Make node iterable\r\n     */\r\n    *[Symbol.iterator]() {\r\n        yield* this.down();\r\n    }\r\n\r\n    /**\r\n     * Convert JSON tree into Linked Tree \r\n     * @param {*} data \r\n     * @returns \r\n     */\r\n    static from(parent, data) {\r\n        const raw = data || parent;\r\n        const hasParent = parent instanceof Tree;\r\n        if (Array.isArray(raw)) {\r\n            if (!hasParent) throw new Error('Parent required when data is array');\r\n            raw.forEach(o => Tree.from(parent, o));\r\n            return parent;\r\n        }\r\n        const { items, ...obj } = raw;\r\n        const tree = new Tree(obj.key, obj, data ? parent : undefined);\r\n        if (hasParent) parent.append(tree);\r\n        if (items) Tree.from(tree, items);\r\n        return tree;\r\n    }\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\n\r\n/**\r\n * A module loading GSAbstractReadWrite class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Generic Class for data read/write for various components such as grid/form/dynamic menu etc.\r\n * @Class\r\n */\r\nexport class DataSelector  {\r\n\r\n    static #SELECT = Symbol('select');\r\n\r\n    /**\r\n     * Store selected record ID\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    static addSelected(val) {\r\n        if (!val) return false;\r\n\r\n        if (Array.isArray(val)) {\r\n            val[DataSelector.#SELECT] = true;\r\n        } else {\r\n            GSUtil.asArray(val).forEach(o => o[DataSelector.#SELECT] = true);\r\n        }\r\n        return val;\r\n    }\r\n\r\n    /**\r\n     * Remove selected record ID\r\n     * @param {*} val \r\n     */\r\n    static removeSelected(val) {\r\n        if (!val) return false;\r\n        delete val[DataSelector.#SELECT];\r\n        return val;\r\n    }\r\n\r\n    /**\r\n     * Remove all selections\r\n     */\r\n    static clearSelected(data) {\r\n        const me = this;\r\n        GSUtil.asArray(data).forEach(o => me.removeSelected(o));\r\n    }\r\n\r\n    /**\r\n     * Return list of all selected record id's\r\n     */\r\n    static getSelected(data = []) {\r\n        const me = this;        \r\n        return me.isSelected(data) || GSUtil.asArray(data).filter(o => me.isSelected(o));\r\n    }\r\n\r\n    /**\r\n     * Check if record id is in list of selected records\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    static isSelected(val) {\r\n        return val ? val[DataSelector.#SELECT] === true : false;\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSEvent } from \"../base/GSEvent.mjs\";\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\n\r\n/**\r\n * A module loading GSReadWriteRegistry class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Global registry for GSAbstractReadWrite instances - data read/write \r\n * @Class\r\n */\r\nclass GSReadWriteRegistryImpl extends GSEvent {\r\n\r\n    static #instance = null;\r\n    static #INTERNAL = Symbol();\r\n\r\n    #handlers = new Map();\r\n\r\n    #map = new Map();\r\n\r\n    constructor(key) {\r\n        if (key != GSReadWriteRegistryImpl.#INTERNAL) throw new Error('Creating new instance not allowed.');\r\n        super();\r\n    }\r\n\r\n    /**\r\n     * Register data handler\r\n     * @param {string} type unique handler name\r\n     * @param {GSReadWriteRegistry} clazz \r\n     */\r\n    addHandler(type, clazz) {        \r\n        this.#handlers.set(type, clazz);\r\n    }\r\n\r\n    /**\r\n     * Unregister data handler\r\n     * @param {string} type unique handler name\r\n     */\r\n    removeHandler(type) {        \r\n        this.#handlers.delete(type);\r\n    }\r\n\r\n    /**\r\n     * Get registered handler by name\r\n     * @param {string} type unique handler name\r\n     */    \r\n    getHandler(type) {\r\n        return this.#handlers.get(type);\r\n    }\r\n\r\n    /**\r\n     * Initialize data handler instance\r\n     * @param {string} type unique handler name\r\n     * @param {string} name unique instance name\r\n     * @param {GSReadWriteRegistry} clazz \r\n     */    \r\n    newHandler(type, name, enabled) {\r\n        const clazz = this.getHandler(type);\r\n        return clazz ? new clazz(name, enabled) : undefined;\r\n    }\r\n\r\n    /**\r\n     * Register GSAbstractReadWrite instance or inherited classes\r\n     * @param {GSAbstractReadWrite} obj \r\n     */\r\n    register(obj) {\r\n        const me = this;\r\n        me.#verify(obj);\r\n        const cache = me.find(obj.id);\r\n        if (cache == obj) return;\r\n        if (cache) throw new Error(`Key (${obj.id}) already exist in read/write registry!`);\r\n        me.#map.set(obj.id, obj);\r\n        me.emit(`register-${obj.id}`, obj);\r\n        me.emit(`register`, obj);\r\n    }\r\n\r\n    /**\r\n     * Unregister GSAbstractReadWrite instance or inherited classes\r\n     * @param {GSAbstractReadWrite} obj \r\n     * @returns {boolean} Deletion status\r\n     */\r\n    unregister(obj) {\r\n        const me = this;\r\n        if (GSUtil.isString(obj)) obj = me.find(obj);\r\n        me.#verify(obj);\r\n        const sts = me.#map.delete(obj.id);\r\n        if (sts) {\r\n            me.emit(`unregister-${obj.id}`, obj);\r\n            me.emit(`unregister`, obj);\r\n        }\r\n        return sts;\r\n    }\r\n\r\n    /**\r\n     * Find registered handler\r\n     * @param {string} val \r\n     * @returns \r\n     */\r\n    find(val) {\r\n        return this.#map.get(val);\r\n    }\r\n\r\n    /**\r\n     * Wait for specific habdler to be either registered or unregistered\r\n     * @param {string} id \r\n     * @param {number|AbortSignal} signal Cancelation in timeout or provided signal\r\n     * @param {boolean} register Listen for register or unregister\r\n     * @returns \r\n     */\r\n    async wait(id = '', signal, register = true) {\r\n        if (!id) throw new Error('GSReadWrite ID not valid.');\r\n        const me = this;\r\n        if (register) {\r\n            const rw = me.find(id);\r\n            if (rw) return rw;\r\n        }\r\n        const type = register ? 'register' : 'unregister';\r\n        await super.wait(`${type}-${id}`, signal);\r\n        return me.find(id);\r\n    }\r\n\r\n    /**\r\n     * Reset the registry\r\n     */\r\n    resetRegistry() {\r\n        this.#handlers.clear();\r\n        this.#map.clear();\r\n    }\r\n\r\n    #verify(obj) {\r\n        //if (!(obj instanceof GSAbstractReadWrite)) throw new Error('Invalid parameter type.');\r\n    }\r\n\r\n    static get #self() {\r\n        if (!GSReadWriteRegistryImpl.#instance) GSReadWriteRegistryImpl.#instance = new GSReadWriteRegistryImpl(GSReadWriteRegistryImpl.#INTERNAL);\r\n        return GSReadWriteRegistryImpl.#instance;\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSReadWriteRegistryImpl);\r\n        globalThis.GSReadWriteRegistry = GSReadWriteRegistryImpl.#self;\r\n    }\r\n\r\n}\r\n\r\nexport const GSReadWriteRegistry = globalThis.GSReadWriteRegistry;\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSID } from \"../base/GSID.mjs\";\r\nimport { GSEvent } from \"../base/GSEvent.mjs\";\r\nimport { GSReadWriteRegistry } from \"./ReadWriteRegistry.mjs\";\r\nimport { DataSelector } from \"./DataSelector.mjs\";\r\n\r\n/**\r\n * A module loading GSAbstractReadWrite class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Generic Class for data read/write for various components such as grid/form/dynamic menu etc.\r\n * @Class\r\n */\r\nexport class GSAbstractReadWrite extends GSEvent {\r\n\r\n    static #SELECT = Symbol('select');\r\n\r\n    #id = null;\r\n    #processors = null;\r\n\r\n    constructor(name, enabled = true) {\r\n        super();\r\n        const me = this;\r\n        me.#id = name || GSID.next();\r\n        if (enabled) me.enable();\r\n    }\r\n\r\n    /**\r\n     * Data preprocessor to register\r\n     * @param {object} processor\r\n     */\r\n    addProcessor(processor) {\r\n        if (!processor) return;\r\n        this.#processors ??= new Set();\r\n        this.#processors.add(processor);\r\n    }\r\n\r\n    /**\r\n     * Data preprocessor to remove\r\n     * @param {object} processor \r\n     */    \r\n    removeProcessor(processor) {\r\n        if (processor) this.#processors?.delete(processor);\r\n    }\r\n\r\n    /**\r\n     * Unique data handler name\r\n     * @returns {string} \r\n     */\r\n    get id() {\r\n        return this.#id;\r\n    }\r\n\r\n    /**\r\n     * Register into global data handler registry\r\n     */\r\n    enable() {\r\n        const me = this;\r\n        GSReadWriteRegistry.register(me);\r\n        me.emit('enabled');\r\n    }\r\n\r\n    /**\r\n     * Unregister from global data handler registry\r\n     */\r\n    disable() {\r\n        const me = this;\r\n        GSReadWriteRegistry.unregister(me);\r\n        me.emit('disabled');\r\n    }\r\n\r\n    /**\r\n     * Check if data handler is registered in global registry\r\n     * @returns {boolean}\r\n     */\r\n    get isRegistered() {\r\n        return GSReadWriteRegistry.find(this.id) ? true : false;\r\n    }\r\n\r\n    /**\r\n     * Generic event dispatcher, can be overriden to controll when to fire event\r\n     * @param {*} owner \r\n     * @param {*} type \r\n     * @param {*} data \r\n     * @param {*} error \r\n     */\r\n    notify(owner, type, data, error) {\r\n        this.emit(error ? 'error' : type, { type: type, error: error, owner: owner, data: data }, true);\r\n    }\r\n\r\n    /**\r\n     * Initiate data read from remote\r\n     * @param {HTMLElement} owner \r\n     * @returns {Array|Object} JSON data response\r\n     */\r\n    async read(owner) {\r\n        const me = this;\r\n        let data = null;\r\n        try {\r\n            data = await me.onRead(owner);\r\n            me.#processors?.forEach(c => c.postRead?.(data));\r\n            if (data) me.notify(owner, 'read', data);\r\n        } catch (e) {\r\n            me.notify(owner, 'read', data, e);\r\n            throw e;\r\n        }\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * Initiate data write to remote\r\n     * @param {HTMLElement} owner \r\n     * @returns {Array|Object} JSON data response\r\n     */\r\n    async write(owner, data) {\r\n        const me = this;\r\n        let result = null;\r\n        try {\r\n            result = await me.onWrite(owner, data);\r\n            me.#processors?.forEach(c => c.postWrite?.(data));\r\n            if (result) me.notify(owner, 'write', data);\r\n        } catch (e) {\r\n            me.notify(owner, 'write', data, e);\r\n            throw e;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Override in inherited class to implement read logic\r\n     * @param {} owner \r\n     * @returns \r\n     */\r\n    async onRead(owner) {\r\n        throw new Error('Extend base GSAbstractReadWrite to implement read operation');\r\n    }\r\n\r\n    /**\r\n     * Store selected record ID\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    addSelected(val) {\r\n        if (!val) return false;\r\n        DataSelector.addSelected(val);\r\n        const me = this;\r\n        me.emit('selection-add', val);\r\n        me.emit('select');\r\n        return val;\r\n    }\r\n\r\n    /**\r\n     * Remove selected record ID\r\n     * @param {*} val \r\n     */\r\n    removeSelected(val) {\r\n        if (!val) return false;\r\n        DataSelector.removeSelected(val);\r\n        const me = this;\r\n        me.emit('selection-remove', val);\r\n        me.emit('select');\r\n        return val;\r\n    }\r\n\r\n    /**\r\n     * Remove all selections\r\n     */\r\n    clearSelected(data) {\r\n        DataSelector.clearSelected(data);\r\n        const me = this;\r\n        me.emit('selection-clear');\r\n        me.emit('select');\r\n    }\r\n\r\n    /**\r\n     * Return list of all selected record id's\r\n     */\r\n    getSelected(data = []) {\r\n        return DataSelector.getSelected(data);\r\n    }\r\n\r\n    /**\r\n     * Check if record id is in list of selected records\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    isSelected(val) {\r\n        return DataSelector.isSelected(val);\r\n    }\r\n\r\n    /**\r\n     * Get list of selected records.\r\n     * Override in inherited class\r\n     */\r\n    get selected() {\r\n        return [];\r\n    }\r\n\r\n    /**\r\n     * Override in inherited class to implement write logic\r\n     * @param {} owner \r\n     * @param {} data\r\n     * @returns \r\n     */\r\n    async onWrite(owner, data) {\r\n        throw new Error('Extend base GSAbstractReadWrite to implement write operation');\r\n    }\r\n\r\n    /**\r\n     * Reset the abstract read/write handler\r\n     */\r\n    reset() {\r\n        this.#processors = null;\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSFunction } from \"../base/GSFunction.mjs\";\r\nimport { GSLoader } from \"../base/GSLoader.mjs\";\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\nimport { GSAbstractReadWrite } from \"./AbstractReadWrite.mjs\";\r\nimport { GSReadWriteRegistry } from \"./ReadWriteRegistry.mjs\";\r\n\r\n/**\r\n * A module loading GSReadWrite class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Generic Class for QUERY/REST data read/write for various components such as grid/form/dynamic menu etc.\r\n * Also, Green Screens Quark Engine or external functions are supported.\r\n * If mode=\"\", instance is used as local reader. \r\n * Use events to detect read/write requests or manually populate using this.setData([...]) \r\n * @Class\r\n */\r\nexport class GSReadWrite extends GSAbstractReadWrite {\r\n\r\n    static #TYPE = \"remote\";\r\n\r\n    static #MODES = ['', 'rest', 'query', 'quark'];\r\n    static #METHOD = ['GET', 'PUT', 'POST', 'DELETE'];\r\n\r\n    #src = '';\r\n    #headers = {};\r\n    #reader = 'GET';\r\n    #writer = 'POST';\r\n    #action = '';\r\n    #mode = '';\r\n\r\n    #key = null;\r\n\r\n    #skip = 0;\r\n    #limit = 0;\r\n\r\n    #sort = [];\r\n    #filter = [];\r\n\r\n    /**\r\n     * Instance constructor\r\n     * @param {string} name Unique handler name\r\n     * @param {boolean} enabled Automatically register in global registry. \r\n     */\r\n    constructor(name, enabled) {\r\n        super(name, enabled);\r\n    }\r\n\r\n    /**\r\n     * Handler type\r\n     */\r\n    get type() {\r\n        return GSReadWrite.#TYPE;\r\n    }\r\n\r\n    /**\r\n     * Handler operational mode\r\n     * rest, query, quark \r\n     * @returns {string} Operational mode\r\n     */\r\n    get mode() {\r\n        return GSUtil.normalize(this.#mode);\r\n    }\r\n\r\n    /**\r\n     * Handler operational mode\r\n     * Values: '', query, rest, quark\r\n     * @var {String} \r\n     */\r\n    set mode(val) {\r\n        const me = this;\r\n        val = GSUtil.normalize(val);\r\n        const isok = GSReadWrite.#MODES.includes(val);\r\n        if (!isok) throw new Error(null, `Invalid mode, allowed: ${GSReadWrite.#MODES}`);\r\n        if (me.#mode === 'quark' && me.#mode != val) {\r\n            me.#reader = 'GET';\r\n            me.#writer = 'POST';\r\n        }\r\n        return this.#mode = val;\r\n    }\r\n\r\n    /**\r\n     * HTTP method for reader (query/rest)\r\n     * @returns {string} Values GET,POST,PUT\r\n     */\r\n    get reader() {\r\n        return this.#reader;\r\n    }\r\n\r\n    /**\r\n     * HTTP method for reader (query/rest)\r\n     * Values GET,POST,PUT\r\n     * @var {String} \r\n     */\r\n    set reader(val) {\r\n        const me = this;\r\n        const isok = me.isQuark ? true : GSReadWrite.#METHOD.includes(val);\r\n        if (!isok) throw new Error(null, `Invalid method, allowed: ${GSReadWrite.#METHOD}`);\r\n        return me.#reader = val;\r\n    }\r\n\r\n    /**\r\n     * HTTP method for writer (query/rest)\r\n     * @returns {string} Values POST,PUT\r\n     */\r\n    get writer() {\r\n        return this.#writer;\r\n    }\r\n\r\n    /**\r\n     * HTTP method for writer (query/rest)\r\n     * Values POST,PUT\r\n     * @var {String} \r\n     */\r\n    set writer(val) {\r\n        const me = this;\r\n        const isok = me.isQuark ? true : GSReadWrite.#METHOD.includes(val);\r\n        if (!isok) throw new Error(null, `Invalid method, allowed: ${GSReadWrite.#METHOD}`);\r\n        return this.#writer = val;\r\n    }\r\n\r\n    /**\r\n     * Custom HTTP headers\r\n     * @returns {Object} Json structure\r\n     */\r\n    get headers() {\r\n        return { ...this.#headers };\r\n    }\r\n\r\n    /**\r\n     * Custom HTTP headersas String or Json structure\r\n     * @var {Object} \r\n     */\r\n    set headers(val = {}) {\r\n        val = GSUtil.toJson(val);\r\n        const me = this;\r\n        me.#headers = { ...val };\r\n    }\r\n\r\n    /**\r\n     * Record key field\r\n     */\r\n    get key() {\r\n        return this.#key;\r\n    }\r\n\r\n    /**\r\n     * Record key field\r\n     * @var {String} \r\n     */\r\n    set key(val) {\r\n        this.#key = val;\r\n    }\r\n\r\n    /**\r\n     * Base URL part\r\n     * @returns {string} \r\n     */\r\n    get src() {\r\n        return this.#src;\r\n    }\r\n\r\n    /**\r\n     * Base URL part\r\n     * @var {String} \r\n     */\r\n    set src(val = '') {\r\n        const me = this;\r\n        me.#src = val;\r\n    }\r\n\r\n    /**\r\n     * Number of records to return\r\n     * @returns {Number} \r\n     */\r\n    get limit() {\r\n        return this.#limit;\r\n    }\r\n\r\n    /**\r\n     * Number of records to return\r\n     * @var {Number} \r\n     */\r\n    set limit(val = 10) {\r\n        this.#limit = GSUtil.asNum(val, 10);\r\n    }\r\n\r\n    /**\r\n     * Number of records to skip\r\n     * @returns {Number} \r\n     */\r\n    get skip() {\r\n        return this.#skip;\r\n    }\r\n\r\n    /**\r\n     * Number of records to skip\r\n     * @var {Number} \r\n     */\r\n    set skip(val = 0) {\r\n        this.#skip = GSUtil.asNum(val, 0);\r\n    }\r\n\r\n    /**\r\n     * Filter data in format \r\n     * [{name: idx[num] || name[string], value: ''  , op:'eq'}]\r\n     * @returns {Array<Object>} \r\n     */\r\n    get filter() {\r\n        return this.#filter;\r\n    }\r\n\r\n    set filter(val) {\r\n        const me = this;\r\n        val = val || [];\r\n        val = GSUtil.isJson(val) ? GSUtil.toJson(val) : val;\r\n        me.#filter = Array.isArray(val) ? val : [val];\r\n    }\r\n\r\n    /**\r\n     * Sort data in format\r\n     * [{col: idx[num] || name[string]  , op: -1 | 1 }]\r\n     * @returns {Array<Object>} \r\n     */\r\n    get sort() {\r\n        return this.#sort;\r\n    }\r\n\r\n    set sort(val) {\r\n        const me = this;\r\n        val = val || [];\r\n        val = GSUtil.isJson(val) ? GSUtil.toJson(val) : val;\r\n        me.#sort = Array.isArray(val) ? val : [val];\r\n    }\r\n\r\n    /**\r\n     * Generated URL segment based on selected mode (query/rest)\r\n     * - quark - JSON path to CRUD object; ie. io.greenscreens.CRUD\r\n     * - rest - url rest format, ie. /${limit}/${skip}?sort=${sort}&filter=${filter}\r\n     * - query - url format, ie. ?limit=${limit}&skip=${skip}&sort=${sort}&filter=${filter}\r\n     * @returns {string} \r\n     */\r\n    get action() {\r\n        const me = this;\r\n        let def = '';\r\n        switch (me.mode) {\r\n            case 'query':\r\n                def = '?limit=${limit}&skip=${skip}&sort=${sort}&filter=${filter}';\r\n                break;\r\n            case 'rest':\r\n                def = '/${limit}/${skip}?sort=${sort}&filter=${filter}';\r\n                break;\r\n        }\r\n        return me.#action || def;\r\n    }\r\n\r\n    /**\r\n     * Set custom URL segment to be attached to based 'src'.\r\n     * Format depends on mode[query|rest]\r\n     * @var {String}\r\n     */\r\n    set action(val = '') {\r\n        const me = this;\r\n        me.#action = val;\r\n    }\r\n\r\n    /**\r\n    * Generate URL from src and mode type\r\n    */\r\n    get url() {\r\n        const me = this;\r\n        return me.#toURL(me.#src, me.#skip, me.#limit, me.#filter, me.#sort);\r\n    }\r\n\r\n    #toURL(src, skip, limit, filter, sort) {\r\n        const me = this;\r\n        if (GSUtil.isStringEmpty(src)) throw new Error('Attribute \"src\" not set!');\r\n        sort = sort ? JSON.stringify(sort) : '';\r\n        filter = filter ? JSON.stringify(filter) : '';\r\n        const opt = { limit: limit, skip: skip, sort: encodeURIComponent(sort), filter: encodeURIComponent(filter) };\r\n        return src + GSUtil.fromLiteral(me.action, opt);\r\n    }\r\n\r\n    /**\r\n     * If handler is local for manual data entry\r\n     * @returns {boolean}\r\n     */\r\n    get isOffline() {\r\n        return this.mode === '';\r\n    }\r\n\r\n    /**\r\n     * If handler is for Green Screens Quark Engine or custom global function.\r\n     * @returns {boolean}\r\n     */\r\n    get isQuark() {\r\n        return this.mode === 'quark';\r\n    }\r\n\r\n    /**\r\n     * If handler is for HTTP requests (query|rest)\r\n     * @returns {boolean}\r\n     */\r\n    get isRemote() {\r\n        return ['rest', 'query'].includes(this.mode);\r\n    }\r\n\r\n    /**\r\n     * Override in inherited class\r\n     * @param {} owner Calling HTMLElement\r\n     * @returns {Array<Object>} Json Array data loaded \r\n     */\r\n    async onRead(owner) {\r\n        const me = this;\r\n        if (me.isOffline) return;\r\n        if (!me.#reader) return super.onRead(owner);\r\n        if (me.isRemote) return await GSLoader.load(me.url, me.#reader, me.#headers, true);\r\n        if (!me.isQuark) return;\r\n        const fn = GSFunction.parseFunction(me.#reader);\r\n        if (!fn) throw new Error('Reader quark function not found!')\r\n        return fn(me.skip, me.limit, me.filter, me.sort);\r\n    }\r\n\r\n    /**\r\n     * Override in inherited class\r\n     * @param {} owner Calling HTMLElement\r\n     * @param {Object} data JSON object to send to the remote\r\n     * @returns {Object} Json Object with write response\r\n     */\r\n    async onWrite(owner, data) {\r\n        const me = this;\r\n        if (me.isOffline) return;\r\n        if (!me.#writer) return super.onWrite(owner);\r\n        if (!me.isRemote) return await GSLoader.load(me.url, me.#writer, me.#headers, true, data);\r\n        if (!me.isQuark) return;\r\n        const fn = GSFunction.parseFunction(me.#writer);\r\n        if (!fn) throw new Error('Writer quark function not found!')\r\n        return fn(data);\r\n    }\r\n\r\n    /**\r\n     * Reset the read/write handler\r\n     */\r\n    reset() {\r\n        this.#src = '';\r\n        this.#headers = {};\r\n        this.#reader = 'GET';\r\n        this.#writer = 'POST';\r\n        this.#action = '';\r\n        this.#mode = '';\r\n        this.#key = null;\r\n        this.#skip = 0;\r\n        this.#limit = 0;\r\n        this.#sort = [];\r\n        this.#filter = [];\r\n    }\r\n\r\n    /**\r\n     * Register generic handler under unique name.\r\n     * @param {string} name Unique handler name\r\n     * @returns {GSReadWrite} Data handler instance\r\n     */\r\n    static register(name) {\r\n        return new GSReadWrite(name, true);\r\n    }\r\n\r\n    static {\r\n        GSReadWriteRegistry.addHandler(GSReadWrite.#TYPE, GSReadWrite);\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSData } from \"../base/GSData.mjs\";\r\nimport { GSReadWrite } from \"./ReadWrite.mjs\";\r\nimport { GSReadWriteRegistry } from \"./ReadWriteRegistry.mjs\";\r\n\r\n/**\r\n * A module loading GSCachedReadWrite class\r\n * @module base/GSCachedReadWrite\r\n */\r\n\r\n/**\r\n * ReadWrite with cached memory data. \r\n * @Class\r\n */\r\nexport class GSCachedReadWrite extends GSReadWrite {\r\n\r\n    static #TYPE = 'cached';\r\n\r\n    #data = [];\r\n\r\n    #reformat(data = []) {\r\n\r\n        let records = [];\r\n        if (Array.isArray(data)) {\r\n            records = data;\r\n        } else if (Array.isArray(data.data)) {\r\n            records = data.data;\r\n        } else {\r\n            records = [data];\r\n        }\r\n\r\n        return records;\r\n    }\r\n\r\n    #postFilter(data) {\r\n        const me = this;\r\n        data = GSData.sortData(data, me.sort);        \r\n        let limit = me.limit === 0 ? data.length : me.limit;\r\n        data = data.slice(me.skip, me.skip + limit);\r\n        return data;\r\n    }\r\n\r\n    clear() {\r\n        this.clearSelected(this.#data);\r\n        this.#data = [];\r\n    }\r\n\r\n    append(data) {\r\n        if(!data) return false;\r\n        const me = this;\r\n        data = me.#reformat(data);\r\n        me.#data = me.#data.concat(data);\r\n        return me.#data;\r\n    }\r\n\r\n    remove(data) {\r\n        const me = this;\r\n        me.removeSelected(data);\r\n        me.#data = me.#data.filter(o => o =! data);\r\n        return me.#data;\r\n    }\r\n\r\n    /**\r\n     * Override in inherited class\r\n     * @param {} owner Calling HTMLElement\r\n     * @returns {Array<Object>} Json Array data loaded \r\n     */\r\n    async onRead(owner) {\r\n        const me = this;\r\n\r\n        if (me.#data.length === 0) {\r\n            const data = await super.onRead();\r\n            me.#data = me.#reformat(data);\r\n        }\r\n\r\n        let data = GSData.filterData(me.#data, me.filter, me.fields, me.limit);\r\n        data = me.#postFilter(data);\r\n        return data;\r\n    }\r\n\r\n    async onWrite(owner, data) {\r\n        return this.append(data);        \r\n    }\r\n\r\n    disable() {\r\n        this.#data = [];\r\n        super.disable();\r\n    }\r\n\r\n    set search(val) {\r\n        const me = this;\r\n        me.filter = val ? [{value : val}] : [];\r\n        me.read();\r\n        /*\r\n        let data = GSData.filterData(me.#data, [{value : val}]);\r\n        data = me.#postFilter(data);\r\n        me.notify(me, 'read', data);\r\n        */\r\n    }\r\n\r\n    clearSelected() {\r\n        return super.clearSelected(this.#data);\r\n    }\r\n\r\n    /**\r\n     * Return list of all selected record id's\r\n     */\r\n    get selected() {\r\n        return super.getSelected(this.#data);\r\n    }\r\n\r\n    /**\r\n     * Handler type\r\n     */\r\n    get type() {\r\n        return GSCachedReadWrite.#TYPE;\r\n    }\r\n\r\n    /**\r\n     * Reset the cached read/write handler\r\n     */\r\n    reset() {\r\n        this.clear();\r\n        super.reset();\r\n    }\r\n\r\n    /**\r\n     * Register generic handler under unique name.\r\n     * @param {string} name Unique handler name\r\n     * @returns {GSReadWrite} Data handler instance\r\n     */\r\n    static register(name) {\r\n        return new GSCachedReadWrite(name, true);\r\n    }\r\n\r\n    static {\r\n        GSReadWriteRegistry.addHandler(GSCachedReadWrite.#TYPE, GSCachedReadWrite);\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { Tree } from \"../helpers/Tree.mjs\";\r\n\r\n/**\r\n * A module loading TreeNode class\r\n * @module data/TreeNode\r\n */\r\n\r\n/**\r\n * UI mediator between Tree linked nodes and WebComponents\r\n * @Class\r\n */\r\nexport class TreeNode extends Tree {\r\n\r\n    #multi = false;\r\n    #opened = false;\r\n    #focused = false;\r\n    #selected = false;\r\n    \r\n    #focusedNode = undefined;\r\n    #selectedNode = undefined;\r\n    #controllers = undefined;\r\n\r\n    constructor(key, value = key, parent = null, level = 0) {\r\n        super(key, value, parent, level);\r\n\r\n        if (value?.select === true || (this.multi && parent?.selected)) this.selected = true;\r\n        if (value?.focus === true) this.focused = true;\r\n        if (value?.open === true) this.opened = true;\r\n    }\r\n\r\n    addController(controller) {\r\n        const root = this.root;\r\n        (root.#controllers ??= new Set()).add(controller);\r\n    }\r\n\r\n    removeController(controller) {\r\n        this.root.#controllers?.delete(controller);\r\n    }\r\n\r\n    /**\r\n     * Is multi selection available\r\n     */\r\n    get multi() {\r\n        return this.root.#multi === true;\r\n    }\r\n\r\n    set multi(val) {\r\n        this.root.#multi = val === true;\r\n    }\r\n\r\n    get visible() {\r\n        if (this.level < 0) return true;\r\n        return this.parent?.opened;\r\n    }\r\n\r\n    /**\r\n     * select single node, removing seelction flag from all other nodes\r\n     */\r\n    get opened() {\r\n        if (this.level < 0) return true;\r\n        return this.isLeaf ? this.parent?.opened : this.#opened;\r\n    }\r\n\r\n    set opened(val) {\r\n        val = val === true;\r\n        if (val) {\r\n            this.expand();\r\n        } else {\r\n            this.collapse();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Focus single node, removing focus flag from all other nodes\r\n     */\r\n    get focused() {\r\n        return this.#focused;\r\n    }\r\n\r\n    set focused(val) {\r\n        val = val === true;\r\n        const root = this.root;\r\n        const changed = this.#focused != val;\r\n        const focusedNode = root.focusedNode();\r\n        \r\n        root.#focusedNode = undefined;        \r\n        this.#focused = val;\r\n        if (focusedNode && focusedNode !== this) {\r\n            focusedNode.focused = false;\r\n        }\r\n\r\n        if (val) root.#focusedNode = this;\r\n        if (changed) root.#controllers?.forEach((c) => c.onFocusChanged?.(this));\r\n    }\r\n\r\n    /**\r\n     * Select single or multi node, depending on multi selection flag\r\n     * If single, remove selection flag from all other nodes\r\n     */\r\n    get selected() {\r\n        return this.#selected;\r\n    }\r\n\r\n    set selected(val) {\r\n        val = val === true;\r\n        const root = this.root;\r\n        const selectedNode = root.selectedNode();\r\n        const changed = this.#selected != val;\r\n        this.#selected = val;\r\n        if (val) {\r\n            if (selectedNode && selectedNode !== this && !root.multi) {\r\n                selectedNode.selected = false;\r\n            }\r\n            root.#selectedNode = this;\r\n        }\r\n        if (changed) {\r\n            root.#controllers?.forEach((c) => c.onSelectionChanged?.(this, selectedNode));\r\n            if (root.multi) root.#controllers?.forEach((c) => c.onSelectionChanged?.(this.parent, selectedNode));\r\n        } \r\n    }\r\n\r\n    get isPartialySelected() {\r\n        return this.selected && this.hasChildren && this.nodes.length > this.nodes.filter(n => n.selected).length;\r\n    }\r\n\r\n    /* hide from public\r\n    get host() {\r\n        return this[Symbol.for('gs-element')];\r\n    }\r\n\r\n    set host(el) {\r\n        this[Symbol.for('gs-element')] = el;\r\n    }\r\n    */\r\n\r\n    selectAll() {\r\n        const root = this.root;\r\n        if (!root.multi) {\r\n            this.deselectAll();\r\n            this.selected = true;\r\n            return\r\n        }\r\n        this.#selectionFlag(true);\r\n        root.#selectedNode = this;\r\n        root.#controllers?.forEach((c) => c.onSelectAll?.(root));\r\n    }\r\n\r\n    deselectAll() {\r\n        const root = this.root;\r\n        this.#selectionFlag(false);\r\n        root.#selectedNode = undefined;\r\n        root.#controllers?.forEach((c) => c.onDeselectAll?.(root));\r\n    }\r\n\r\n    /**\r\n     * Return last focused node\r\n     * @returns \r\n     */\r\n    focusedNode() {\r\n        const node = this.root.#focusedNode;\r\n        return node?.focused ? node : undefined;\r\n    }\r\n\r\n    /**\r\n     * Return last selected node\r\n     * @returns \r\n     */\r\n    selectedNode() {\r\n        const node = this.root.#selectedNode;\r\n        return node?.selected ? node : undefined;\r\n    }\r\n\r\n    /**\r\n     * List all selected nodes.\r\n     * @returns \r\n     */\r\n    selectedNodes() {\r\n        const root = this.root;\r\n        if (!root.multi) {\r\n            const node = root.selectedNode()\r\n            return node?.selected ? [node] : [];\r\n        }\r\n        return Array.from(root.walk().filter(o => o.selected));\r\n    }\r\n\r\n    /**\r\n     * Call from external controller data must be refresshed (to notify UI optionally)\r\n     * @param {*} root \r\n     */\r\n    refresh(root) {\r\n        root = root || this.root;\r\n        root.#controllers?.forEach((c) => c.onRefresh?.(this));\r\n    }\r\n\r\n    /**\r\n     * Notify controllers about data loading (from async controller)\r\n     * @param {*} root \r\n     */\r\n    loading(root) {\r\n        root = root || this.root;\r\n        root.#controllers?.forEach((c) => c.onLoad?.(this));\r\n    }\r\n\r\n    expandAll(root) {\r\n        const me = this;\r\n        root = root || me.root;\r\n        for (let node of this.walk()) {\r\n            if (!node.isLeaf) node.expand(root);\r\n        }\r\n    }\r\n\r\n    collapseAll(root) {\r\n        const me = this;\r\n        root = root || me.root;\r\n        for (let node of this.walk()) {\r\n            if (!node.isLeaf) node.collapse(root);\r\n        }\r\n    }\r\n\r\n    expand(root) {\r\n        const me = this;\r\n        root = root || me.root;\r\n        if (!me.parent?.opened) {\r\n            me.parent?.expand(root);\r\n        }\r\n        const update = !me.opened;\r\n        me.#opened = true;\r\n        if (update) me.#expanded(root);\r\n        //me.nodes?.filter( n => !n.opened).forEach(c => c.refresh(root));\r\n        me.nodes?.forEach(c => c.refresh(root));\r\n    }\r\n\r\n    collapse(root) {\r\n        const me = this;\r\n        root = root || me.root;\r\n        const update = me.#opened || me.parent.#opened;\r\n        me.nodes?.filter(n => n.opened || n.parent.opened).forEach(o => o.collapse(root));\r\n        //me.nodes?.forEach(o => o.collapse(root));\r\n        me.#opened = false;\r\n        if (update) me.#collapsed(root);\r\n    }\r\n\r\n    select(val = true) {\r\n        this.selected = val === true;\r\n    }\r\n\r\n    #expanded(root) {\r\n        root.#controllers?.forEach((c) => c.onExpand?.(this));\r\n    }\r\n\r\n    #collapsed(root) {\r\n        root.#controllers?.forEach((c) => c.onCollapse?.(this));\r\n    }\r\n\r\n    release() {\r\n        if (this.#selected) this.selected = false;\r\n        super.release();\r\n    }\r\n\r\n    append(key, value = key) {\r\n        const me = this;\r\n        const node = super.append(key, value);\r\n        if (node) me.root.#controllers?.forEach((c) => c.onAppend?.(me, node));\r\n        return node;\r\n    }\r\n\r\n    insert(parentNodeKey, key, value = key) {\r\n        const me = this;\r\n        const node = super.insert(parentNodeKey, key, value);\r\n        if (node) me.root.#controllers?.forEach((c) => c.onInsert?.(me, node));\r\n        return node;\r\n    }\r\n\r\n    remove() {\r\n        const node = super.remove();\r\n        if (node) this.root.#controllers?.forEach((c) => c.onInsert?.(node));\r\n        return node;\r\n    }\r\n\r\n    #selectionFlag(val = false) {\r\n        val = val === true\r\n        for (let node of this.walk()) {\r\n            node.selected = val;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Load JSON data into tree\r\n     * @param {*} data \r\n     */\r\n    fromJSON(data) {\r\n        if (data) TreeNode.from(this, data);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Used by JSON.stringify to properly export as JSON\r\n     * @returns \r\n     */\r\n    toJSON() {\r\n        if (this.level < 0) return this.nodes?.map(o => o.toJSON()) || {};\r\n        const obj = Object.assign({\r\n            key: this.key,\r\n            opened: this.#opened,\r\n            focused: this.#focused,\r\n            selected: this.#selected,\r\n            items: undefined\r\n        }, this.value);\r\n        obj.items = this.nodes?.map(o => o.toJSON());\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Reset the tree node\r\n     */\r\n    reset() {\r\n        this.#multi = false;\r\n        this.#opened = false;\r\n        this.#focused = false;\r\n        this.#selected = false;\r\n        this.#focusedNode = undefined;\r\n        this.#selectedNode = undefined;\r\n        this.#controllers = undefined;\r\n    }\r\n\r\n    static get root() {\r\n        return new TreeNode(null, null, null, -1);\r\n    }\r\n\r\n    /**\r\n     * Convert JSON tree into Linked Tree \r\n     * @param {*} data \r\n     * @returns \r\n     */\r\n    static from(parent, data) {\r\n        const raw = data || parent;\r\n        const hasParent = parent instanceof TreeNode;\r\n        if (Array.isArray(raw)) {\r\n            if (!hasParent) return TreeNode.from(TreeNode.root, raw);\r\n            raw.forEach(o => TreeNode.from(parent, o));\r\n            return parent;\r\n        }\r\n        const { items, ...obj } = raw;\r\n        obj.leaf = !Array.isArray(items);\r\n        const tree = new TreeNode(obj.key, obj, data ? parent : undefined);\r\n        if (items) TreeNode.from(tree, items);\r\n        if (hasParent) parent.append(tree);\r\n        return tree;\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSReadWrite } from \"./ReadWrite.mjs\";\r\nimport { GSReadWriteRegistry } from \"./ReadWriteRegistry.mjs\";\r\nimport { TreeNode } from \"./TreeNode.mjs\";\r\n\r\n/**\r\n * A module loading GSTreeReader class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Generic Class for reading Tree nodes\r\n * @Class\r\n */\r\nexport class GSTreeReader extends GSReadWrite {\r\n\r\n    #data = TreeNode.root;\r\n\r\n    /**\r\n     * Instance constructor\r\n     * @param {string} name Unique handler name\r\n     * @param {boolean} enabled Automatically registe in global registry. \r\n     */\r\n    constructor(name, enabled) {\r\n        super(name, enabled);\r\n    }\r\n\r\n    async write(val) {\r\n        throw new Error('Writer not available for TreeReader')\r\n    }\r\n\r\n    async read(owner) {\r\n        const me = this;\r\n        let node = undefined;\r\n        const data = await super.read(owner);\r\n        if (!this.#data) {\r\n            node = TreeNode.from(data);\r\n            this.#data = node;\r\n        } else {\r\n            const parent = me.filter?.length > 0 ? me.#data.findByKey(me.filter[0]) : me.#data;\r\n            parent.clear();\r\n            node = parent.fromJSON(data);\r\n        }\r\n        me.filter = undefined;\r\n        me.notify(owner, 'read', node);\r\n        return node;\r\n    }\r\n\r\n    disable() {\r\n        super.disable();\r\n        this.#data?.release();\r\n    }\r\n\r\n    notify(owner, type, data, error) {\r\n        const isNode = data instanceof TreeNode;\r\n        if (!error && !isNode && type === 'read') return;\r\n        super.notify(owner, type, data, error);\r\n    }\r\n\r\n    /**\r\n     * Called from Tree when node is expanded \r\n     * @param {*} node \r\n     */\r\n    async onExpand(node) {\r\n        if (node.hasChildren) return;\r\n        node.loading();\r\n        this.filter = node.key;\r\n        return await this.read();\r\n    }\r\n\r\n    get data() {\r\n        return this.#data;\r\n    }\r\n\r\n    /**\r\n     * Reset the tree data\r\n     */\r\n    resetData() {\r\n        this.#data = TreeNode.root;\r\n    }\r\n\r\n    /**\r\n     * Register generic handler under unique name.\r\n     * @param {string} name Unique handler name\r\n     * @returns {GSTreeReader} Data handler instance\r\n     */\r\n    static register(name) {\r\n        return new GSTreeReader(name, true);\r\n    }\r\n\r\n    static {\r\n        GSReadWriteRegistry.addHandler('tree', GSTreeReader);\r\n    }\r\n\r\n}","// Lit 3.0 Google\r\nconst litUrl = globalThis.GS_LIT_URL || '/bootstrap-lit/assets/lib/lit-all.min.js';\r\nconst litModule = await import(litUrl);\r\n\r\n// small helper to print this exports (or any other module); use it when upgrading to a new Lit version to regenerte export list below\r\nexport const printModuleExports = (module) => console.log(Object.keys(module || litModule).map(v => `export const ${v} = litModule.${v};`).join('\\n'));\r\n\r\nexport const ReactiveController = litModule.ReactiveController;\r\nexport const ReactiveElement = litModule.ReactiveElement;\r\nexport const AsyncDirective = litModule.AsyncDirective;\r\nexport const AsyncReplaceDirective = litModule.AsyncReplaceDirective;\r\nexport const CSSResult = litModule.CSSResult;\r\nexport const Directive = litModule.Directive;\r\nexport const LitElement = litModule.LitElement;\r\nexport const PartType = litModule.PartType;\r\nexport const TemplateResultType = litModule.TemplateResultType;\r\nexport const UnsafeHTMLDirective = litModule.UnsafeHTMLDirective;\r\nexport const UntilDirective = litModule.UntilDirective;\r\nexport const _$LE = litModule._$LE;\r\nexport const _$LH = litModule._$LH;\r\nexport const adoptStyles = litModule.adoptStyles;\r\nexport const asyncAppend = litModule.asyncAppend;\r\nexport const asyncReplace = litModule.asyncReplace;\r\nexport const cache = litModule.cache;\r\nexport const choose = litModule.choose;\r\nexport const classMap = litModule.classMap;\r\nexport const clearPart = litModule.clearPart;\r\nexport const createRef = litModule.createRef;\r\nexport const css = litModule.css;\r\nexport const defaultConverter = litModule.defaultConverter;\r\nexport const directive = litModule.directive;\r\nexport const getCommittedValue = litModule.getCommittedValue;\r\nexport const getCompatibleStyle = litModule.getCompatibleStyle;\r\nexport const getDirectiveClass = litModule.getDirectiveClass;\r\nexport const guard = litModule.guard;\r\nexport const html = litModule.html;\r\nexport const ifDefined = litModule.ifDefined;\r\nexport const insertPart = litModule.insertPart;\r\nexport const isCompiledTemplateResult = litModule.isCompiledTemplateResult;\r\nexport const isDirectiveResult = litModule.isDirectiveResult;\r\nexport const isPrimitive = litModule.isPrimitive;\r\nexport const isServer = litModule.isServer;\r\nexport const isSingleExpression = litModule.isSingleExpression;\r\nexport const isTemplateResult = litModule.isTemplateResult;\r\nexport const join = litModule.join;\r\nexport const keyed = litModule.keyed;\r\nexport const literal = litModule.literal;\r\nexport const live = litModule.live;\r\nexport const map = litModule.map;\r\nexport const noChange = litModule.noChange;\r\nexport const notEqual = litModule.notEqual;\r\nexport const nothing = litModule.nothing;\r\nexport const range = litModule.range;\r\nexport const ref = litModule.ref;\r\nexport const removePart = litModule.removePart;\r\nexport const render = litModule.render;\r\nexport const repeat = litModule.repeat;\r\nexport const setChildPartValue = litModule.setChildPartValue;\r\nexport const setCommittedValue = litModule.setCommittedValue;\r\nexport const staticHtml = litModule.staticHtml;\r\nexport const staticSvg = litModule.staticSvg;\r\nexport const styleMap = litModule.styleMap;\r\nexport const supportsAdoptingStyleSheets = litModule.supportsAdoptingStyleSheets;\r\nexport const svg = litModule.svg;\r\nexport const templateContent = litModule.templateContent;\r\nexport const unsafeCSS = litModule.unsafeCSS;\r\nexport const unsafeHTML = litModule.unsafeHTML;\r\nexport const unsafeSVG = litModule.unsafeSVG;\r\nexport const unsafeStatic = litModule.unsafeStatic;\r\nexport const until = litModule.until;\r\nexport const when = litModule.when;\r\nexport const withStatic = litModule.withStatic;","import { Directive, directive, nothing } from \"../lib.mjs\";\r\n\r\nconst definition = {\r\n    'action': 'gsAction',\r\n    'anchor': 'gsAnchor',\r\n    'attribute': 'gsAttribute',\r\n    'call': 'gsCall',\r\n    'exec': 'gsExec',\r\n    'inject': 'gsInject',\r\n    'property': 'gsProperty',\r\n    'swap': 'gsSwap',\r\n    'target': 'gsTarget',\r\n    'template': 'gsTemplate',\r\n    'toggle': 'gsToggle',\r\n    'trigger': 'gsTrigger',\r\n    'value': 'gsValue',\r\n    'calls':'gsCall',\r\n    'toggles':'gsToggle',\r\n    'timeout':'gsTimeout',\r\n    'triggers':'gsTrigger'\r\n};\r\n\r\nconst template = {\r\n    'gsAction': undefined,\r\n    'gsAnchor': undefined,\r\n    'gsAttribute': undefined,\r\n    'gsCall': undefined,\r\n    'gsExec': undefined,\r\n    'gsInject': undefined,\r\n    'gsProperty': undefined,\r\n    'gsSwap': undefined,\r\n    'gsTarget': undefined,\r\n    'gsTemplate': undefined,\r\n    'gsToggle': undefined,\r\n    'gsTrigger': undefined,\r\n    'gsValue': undefined,\r\n    'gsCall': undefined,\r\n    'gsToggle': undefined,\r\n    'gsTimeout': undefined,\r\n    'gsTrigger': undefined\r\n};\r\n\r\nclass DatasetDirective extends Directive {\r\n\r\n    render(obj) {\r\n        console.log(obj);\r\n        return nothing;\r\n    }\r\n\r\n    update(part, [obj, flat = true]) {\r\n\r\n        if (!obj) return nothing;\r\n        const dataset = part.element.dataset;\r\n        const srcset = obj.dataset || obj;\r\n        const isDataset = srcset instanceof DOMStringMap;\r\n\r\n        if (isDataset) {\r\n            Object.assign(dataset, srcset);\r\n        } \r\n        \r\n        if (flat) this.#remap(dataset, obj);\r\n\r\n        return nothing;\r\n    }\r\n\r\n    #remap(dataset, obj) {\r\n        const opt = Object.assign({}, template);\r\n        const list = Object.entries(obj).filter(v => Object.hasOwn(definition, v[0]));\r\n        if (list.length > 0) {\r\n            list.forEach(kv => opt[definition[kv[0]]] = kv[1]);\r\n            Object.keys(opt)\r\n            .filter(k => opt[k] !== undefined)\r\n            .forEach(k => dataset[k] = opt[k]);\r\n        }\r\n    }\r\n}\r\n\r\nexport const dataset = directive(DatasetDirective);\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { html } from '../lib.mjs';\r\n\r\n/**\r\n * Generic object property descriptor getter\r\n * @param {Object} instance \r\n * @returns {PropertyDescriptor}\r\n */\r\nfunction descriptors(instance) {\r\n  return Object.entries(Object.getOwnPropertyDescriptors(instance));\r\n}\r\n\r\n/**\r\n * List of all object property descriptors \r\n * @param {Object} instance Object instance \r\n * @returns {Array<PropertyDescriptor>}\r\n */\r\nfunction listProperties(instance) {\r\n  return descriptors(instance)\r\n    .filter(e => typeof e[1].value !== 'function')\r\n    .map(e => e[0]);\r\n}\r\n\r\n/**\r\n * List all object property getters\r\n * @param {Object} instance \r\n * @returns {Array}\r\n */\r\nfunction listGetters(instance) {\r\n  return descriptors(Reflect.getPrototypeOf(instance))\r\n    .filter(e => typeof e[1].get === 'function' && e[0] !== '__proto__')\r\n    .map(e => e[0]);\r\n}\r\n\r\n/**\r\n * List of all gettable properties from an object\r\n * @param {Object} instance \r\n * @returns {Array}\r\n */\r\nfunction listGettable(instance) {\r\n  return new Set([...listGetters(instance), ...listProperties(instance)]);\r\n}\r\n\r\n/**\r\n * Parse string literal template into Lit html instance\r\n * @param {*} tpl \r\n * @param {*} params \r\n * @returns {function}\r\n */\r\nexport function literalTemplate(tpl, params) {\r\n  const names = Array.from(listGettable(params));\r\n  const vals = names.map(v => params[v]);\r\n  names.push('html');\r\n  vals.push(html);\r\n  return new Function(...names, `return html\\`${tpl}\\`;`)(...vals);\r\n}","/**\r\n * A clone of classMap directive to support CSS directive.\r\n * Lit classs is not expoed, so we have to clone it and create our own.\r\n */\r\n\r\nimport { Directive, PartType, directive, noChange } from \"../lib.mjs\";\r\n\r\nclass CssMapDirective extends Directive {\r\n\r\n    constructor(partInfo) {\r\n        super(partInfo);\r\n        if (partInfo.type !== PartType.ATTRIBUTE ||\r\n            partInfo.name !== 'css' ||\r\n            partInfo.strings?.length > 2) {\r\n            throw new Error('`classMap()` can only be used in the `css` attribute ' +\r\n                'and must be the only part in the attribute.');\r\n        }\r\n    }\r\n\r\n    render(classInfo) {\r\n        // Add spaces to ensure separation from static classes\r\n        return (' ' +\r\n            Object.keys(classInfo)\r\n                .filter((key) => classInfo[key])\r\n                .join(' ') +\r\n            ' ');\r\n    }\r\n\r\n    update(part, [classInfo]) {\r\n\r\n        // Remember dynamic classes on the first render\r\n        if (this._previousClasses === undefined) {\r\n            this._previousClasses = new Set();\r\n            if (part.strings !== undefined) {\r\n                this._staticClasses = new Set(part.strings\r\n                    .join(' ')\r\n                    .split(/\\s/)\r\n                    .filter((s) => s !== ''));\r\n            }\r\n\r\n            for (const name in classInfo) {\r\n                if (classInfo[name] && !this._staticClasses?.has(name)) {\r\n                    this._previousClasses.add(name);\r\n                }\r\n            }\r\n            return this.render(classInfo);\r\n        }\r\n\r\n        const classList = part.element.classList;\r\n\r\n        // Remove old classes that no longer apply\r\n        for (const name of this._previousClasses) {\r\n            if (!(name in classInfo)) {\r\n                classList.remove(name);\r\n                this._previousClasses.delete(name);\r\n            }\r\n        }\r\n\r\n        // Add or remove classes based on their classMap value\r\n        for (const name in classInfo) {\r\n            // We explicitly want a loose truthy check of `value` because it seems\r\n            // more convenient that '' and 0 are skipped.\r\n            const value = !!classInfo[name];\r\n            if (value !== this._previousClasses.has(name) &&\r\n                !this._staticClasses?.has(name)) {\r\n                if (value) {\r\n                    classList.add(name);\r\n                    this._previousClasses.add(name);\r\n                } else {\r\n                    classList.remove(name);\r\n                    this._previousClasses.delete(name);\r\n                }\r\n            }\r\n        }\r\n        return noChange;\r\n    }\r\n}\r\n\r\n/**\r\n * A directive that applies dynamic CSS classes.\r\n *\r\n * This must be used in the `css` attribute and must be the only part used in\r\n * the attribute. It takes each property in the `classInfo` argument and adds\r\n * the property name to the element's `classList` if the property value is\r\n * truthy; if the property value is falsey, the property name is removed from\r\n * the element's `css`.\r\n *\r\n * For example `{foo: bar}` applies the class `foo` if the value of `bar` is\r\n * truthy.\r\n *\r\n * @param classInfo\r\n */\r\nexport const cssMap = directive(CssMapDirective);\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport const notEmpty = (newVal, oldVal) => newVal !== oldVal && newVal;\r\nexport const numGT0 = (newVal, oldVal) => newVal !== oldVal && Number(newVal) > 0;\r\nexport const numGE0 = (newVal, oldVal) => newVal !== oldVal && Number(newVal) >= 0;\r\nexport const numLT0 = (newVal, oldVal) => newVal !== oldVal && Number(newVal) < 0;\r\nexport const numLE0 = (newVal, oldVal) => newVal !== oldVal && Number(newVal) <= 0;\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport const AutocapitalizeTypes = ['', 'none', 'off', 'on', 'sentences', 'words', 'characters'];\r\n\r\nexport const autocapitalize = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && AutocapitalizeTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport const AutocompleteTypes = ['', 'off', 'on'];\r\n\r\nexport const autocomplete = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && AutocompleteTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport const AutocorrectTypes = ['', 'on', 'off'];\r\n\r\nexport const autocorrect = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && AutocorrectTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport class ButtonTypes {\r\n\r\n    static values = ['button', 'reset', 'submit'];\r\n\r\n    static is(val) {\r\n        return ButtonTypes.values.includes(val);\r\n    }\r\n\r\n    static isReset(val) {\r\n        return ButtonTypes.values.indexOf(val) === 1;\r\n    }\r\n\r\n    static isSubmit(val) {\r\n        return ButtonTypes.values.indexOf(val) === 2;\r\n    }\r\n} \r\n\r\nexport const buttonType = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && ButtonTypes.is(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport const ColorTypes = ['', 'primary', 'secondary', 'dark', 'light', 'info', 'warning', 'danger', 'alert', 'link', 'success'];\r\n\r\nexport const color = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && ColorTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport const EnvironmentTypes = ['', 'desktop', 'mobile', 'tablet', 'android', 'linux', 'windows', 'macos', 'ios'];\r\n\r\nexport const environment = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && EnvironmentTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport const InputTypes = [\r\n   { type: 'checkbox', ignore: true},\r\n   { type: 'radio', ignore: true},\r\n   { type: 'switch', ignore: true},\r\n   { type: 'range', ignore: true},\r\n   { type: 'number', native: true},\r\n   { type: 'email', native: true},\r\n   { type: 'url',  native: true},\r\n   { type: 'file', native: true}, \r\n   { type: 'text'},\r\n   { type: 'password'}\r\n];\r\n\r\nexport const inputType = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && InputTypes.filter(o => o.type === newVal).length === 1;\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport const NavTypes = ['', 'pills', 'tabs', 'underline'];\r\n\r\nexport const nav = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && NavTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport class OrientationTypes {\r\n\r\n    static values =  ['', 'horizontal', 'vertical', 'portrait', 'landscape'];\r\n\r\n    static includes(val) {\r\n        return OrientationTypes.values.includes(val);\r\n    }\r\n\r\n    static isVertical(val) {\r\n        const idx = OrientationTypes.values.indexOf(val);\r\n        return idx === 2 || idx === 3;\r\n    }\r\n\r\n    static isHorizontal(val) {\r\n        const idx = OrientationTypes.values.indexOf(val);\r\n        return idx === 1 || idx === 4;\r\n    }\r\n\r\n}\r\n\r\nexport const orientation = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && OrientationTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport class PlacementTypes {\r\n\r\n    static values = ['center', 'left', 'right', 'start', 'end', 'top', 'bottom'];\r\n\r\n    static includes(val) {\r\n        return PlacementTypes.values.includes(val);\r\n    }\r\n\r\n    static isVertical(val) {\r\n        return PlacementTypes.values.indexOf(val) > 4;\r\n    }\r\n\r\n    static isHorizontal(val) {\r\n        const idx = PlacementTypes.values.indexOf(val)\r\n        return idx > 0 && idx < 5;\r\n    }\r\n\r\n    static isCenter(val) {\r\n        return PlacementTypes.values.indexOf(val) === 0;\r\n    }\r\n\r\n    static isBefore(val) {\r\n        return ['left', 'start', 'top'].includes(val);\r\n    }\r\n\r\n    static isAfter(val) {\r\n        return ['right', 'end', 'bottom'].includes(val);\r\n    }\r\n}\r\n\r\n\r\nexport const placement = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && PlacementTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport class PositionTypes {\r\n\r\n    static values = ['absolute', 'fixed', 'relative', 'sticky', 'static'];\r\n\r\n    static includes(val) {\r\n        return PositionTypes.values.includes(val);\r\n    }\r\n}\r\n\r\n\r\nexport const position = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && PositionTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport const ProtocolTypes = ['', 'http', 'https'];\r\n\r\nexport const protocol = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && ProtocolTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport const SizeTypes = { 'default' : '', 'normal': '',  'medium': '', 'small': 'sm', 'large': 'lg', 'big' : 'lg', 'extra' : 'xl' };\r\n\r\nexport const size = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && Object.hasOwn(SizeTypes, newVal);\r\n    }\r\n\r\n};","export const stringArrayConverter = {\r\n    fromAttribute: (value, type) => {\r\n        return (value || '').split(',');\r\n    },\r\n    toAttribute: (value, type) => {\r\n        return (value || []).join(',');\r\n    }\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDynamicStyle } from '../base/GSDynamicStyle.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSCacheStyles } from '../base/GSCacheStyles.mjs';\r\n\r\n/**\r\n * Controller register self to gs-adopted event listener list.\r\n * Every time even gs-adopted is triggered by the GSAdoptedEngien class,\r\n * all registerd controller will be processed for reapplaying stylesheet \r\n * Also, this controlelr takes care of adding custom dynamic styles \r\n * to the end fo the list.\r\n * \r\n * Custom dynamic styles are used internally by the components for dynamic \r\n * style changes to preven dom node polution; \r\n * Style  changes  are not visible directly on DOM node.\r\n */\r\nexport class AdoptedController {\r\n\r\n  #host;\r\n  #dynamic;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    AdoptedController.#controllers.add(me);\r\n    me.#adopt();\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    AdoptedController.#controllers.delete(me.#host);\r\n    me.#host.removeController(me);\r\n  }\r\n\r\n  /**\r\n   * Initialize dynamic style for component instance\r\n   * Call it from constructor for style to be applied to the current component\r\n   * @param {String} name CSS class name\r\n   * @param {Object|String} values CSS class styles to be applied\r\n   * @returns {CSSStyleRule} An instance of a CSS class\r\n   */\r\n  style(name, values, isGlobal = false) {\r\n    const me = this;\r\n    let style = null;\r\n    if (isGlobal) {\r\n      style = GSCacheStyles.dynamic;\r\n    } else {\r\n      me.#dynamic = me.#dynamic ?? new GSDynamicStyle('dynamic');      \r\n      style = me.#dynamic;\r\n    }    \r\n    if (values === null && style.rules.length > 0 ) return style.removeRule(name);\r\n    return style.setRule(name, values, true);\r\n  }\r\n\r\n  #adopt(forced = false) {\r\n    const me = this;\r\n    if (!me.#sheets) return;\r\n    if (forced || me.#changed) {\r\n      const sheets = [...document.adoptedStyleSheets];\r\n      // support for lit \"static styles = css``\"\r\n      const internal = Array.from(me.#sheets);\r\n      if (me.#dynamic) internal.push(me.#dynamic);\r\n      me.#root.adoptedStyleSheets = [...sheets, ...internal];\r\n    }\r\n  }\r\n\r\n  get #changed() {\r\n    return document.adoptedStyleSheets.id !== this.#sheets?.id;\r\n  }\r\n\r\n  get #root() {\r\n    return this.#host.renderRoot;\r\n  }\r\n\r\n  get #sheets() {\r\n    return this.#root?.adoptedStyleSheets;\r\n  }\r\n\r\n  /**\r\n   * Global listener for gs-adopted event triggered from GSAdoptedEngine\r\n   */\r\n  static #controllers = new Set();\r\n\r\n  static #onAdopted(e) {\r\n    requestAnimationFrame(() => {\r\n      AdoptedController.#controllers.forEach(c => c.#adopt());\r\n    });\r\n  }\r\n\r\n  static #init() {\r\n    const me = AdoptedController;\r\n    GSEvents.on(window, null, 'gs-adopted', me.#onAdopted);\r\n  }\r\n\r\n  static {\r\n    this.#init();\r\n  }\r\n\r\n}  \r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSAttributeHandler } from \"../base/GSAttributeHandler.mjs\";\r\nimport { GSDOM } from \"../base/GSDOM.mjs\";\r\n\r\n/**\r\n * Attributes to control click actions for buttons and links.\r\n * Used to brings meta linking between UI elements\r\n */\r\nexport class AttributeController extends GSAttributeHandler {\r\n\r\n  constructor(host) {\r\n    super(host);\r\n    const me = this;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.attach(me.#eventName);\r\n    // me.host.on('notify', e => me.onNotify(e));\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.host.removeController(me);\r\n    me.detach(me.#eventName);\r\n  }\r\n\r\n  onNotify(evt) {\r\n    const me = this;\r\n    me.handle(evt);\r\n  }\r\n\r\n  get #eventName() {\r\n    const tag = this.host?.tagName.toLowerCase();\r\n    const clazz = this.host?.clazzName;\r\n    const isFormEl = GSDOM.isFormElement(this.host);\r\n    const v1 = ['gs-form', 'gs form-group'].includes(tag);\r\n    const v2 = ['GSFormGroupElement'].includes(clazz);\r\n    return v1 || v2 || isFormEl ? 'change' : 'click';\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Handle rendered content cleanup (remove by default)\r\n * Set \"keep\" to the component to prevent rendered content removal.\r\n */\r\nexport class ContentController {\r\n\r\n  #host;\r\n  #ref;\r\n  #refs = new Set();\r\n\r\n  constructor(host) {\r\n    this.#host = host;\r\n    host.addController(this);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#removeContent();\r\n    me.#host = null;\r\n    me.#refs = null;\r\n    me.#ref = null;\r\n  }\r\n\r\n  hostUpdated() {\r\n    const me = this;\r\n    if (!me.#isSelf() && me.#target) me.#refs.add(me.#target);\r\n  }\r\n\r\n  get contentRef() {\r\n    return this.#ref;\r\n  }\r\n\r\n  get #options() {\r\n    return this.#host?.renderOptions;\r\n  }\r\n\r\n  get #target() {\r\n    return this.#options?.renderBefore?.previousElementSibling;\r\n  }\r\n\r\n  #isSelf() {\r\n    const me = this;\r\n    const target = me.#target;\r\n    const root = me.#host?.renderRoot;\r\n    const shadow = me.#host?.shadowRoot;\r\n    return (target === shadow || target == root);\r\n  }\r\n\r\n  #removeContent() {\r\n    const me = this;\r\n    if (!me.#host?.keep) {\r\n      Array.from(me.#refs).forEach(el => el?.remove());\r\n      me.#refs.clear();\r\n    }\r\n  }\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSLog } from \"../base/GSLog.mjs\";\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\nimport { DataSelector } from \"../data/DataSelector.mjs\";\r\nimport { GSReadWriteRegistry } from \"../data/ReadWriteRegistry.mjs\";\r\n\r\n/**\r\n * Controller between component and DataReadWrite.\r\n */\r\nexport class DataController {\r\n\r\n  #host;\r\n\r\n  #readCallback;\r\n  #writeCallback;\r\n  #errorCallback;\r\n  #selectCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#readCallback = me.#onRead.bind(me);\r\n    me.#writeCallback = me.#onWrite.bind(me);\r\n    me.#errorCallback = me.#onError.bind(me);\r\n    me.#selectCallback = me.#onSelect.bind(me);\r\n    me.#host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.#listen(false);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#unlisten();\r\n    me.#host.removeController(me);\r\n  }\r\n\r\n  async read(obj) {\r\n    return this.store?.read(this.#host);\r\n  }\r\n\r\n  async write(obj) {\r\n    return this.store?.write(this.#host, obj);\r\n  }\r\n\r\n  async storage() {\r\n    return GSReadWriteRegistry.wait(this.storeID);\r\n  }\r\n\r\n  sort(val) {\r\n    if (!this.store) return;\r\n    this.store.sort = val;\r\n    return this.store.read();\r\n  } \r\n\r\n  filter(val) {\r\n    if (!this.store) return;\r\n    this.store.filter = val;\r\n    return this.store.read();\r\n  }\r\n\r\n  search(val) {\r\n    if (!this.store) return;\r\n    this.store.search = val;\r\n  }\r\n\r\n  firstPage() {\r\n    this.page = 1;\r\n  }\r\n\r\n  lastPage() {\r\n    this.nextPage();\r\n  }\r\n\r\n  nextPage() {\r\n    this.page = this.page + 1;\r\n  }\r\n\r\n  prevPage() {\r\n    this.page = this.page - 1;\r\n  }\r\n\r\n  get selected() {\r\n    return this.store?.selected;\r\n  }\r\n\r\n  isSelected(val) {\r\n    return this.#selector.isSelected(val);\r\n  }\r\n\r\n  addSelected(val) {\r\n    return this.#selector.addSelected(val);\r\n  }\r\n  \r\n  removeSelected(val) {\r\n    return this.#selector.removeSelected(val);\r\n  }\r\n\r\n  clearSelected(data) {\r\n    return this.#selector.clearSelected(data);\r\n  }\r\n\r\n  getSelected(data) {\r\n    return GSUtil.asArray(data).filter(o => DataSelector.isSelected(o));\r\n  }\r\n\r\n  get #selector() {\r\n    return this.store || DataSelector;\r\n  }\r\n\r\n  get store() {\r\n    return GSReadWriteRegistry.find(this.storeID);\r\n  }\r\n\r\n  get storeID() {\r\n    return this.#host?.storage;\r\n  }\r\n\r\n  get page() {\r\n    const store = this.store;\r\n    return store ? Math.floor(store.skip / Math.max(store.limit, 1)) + 1 : 1;\r\n  }\r\n\r\n  set page(val) {\r\n    val = Math.max(1, GSUtil.asNum(val, 1));    \r\n    const store = this.store;\r\n    if (store) {\r\n      store.skip = val > 0 ? (store.limit * val) - store.limit : 0;\r\n      store.read(this.#host);\r\n    }\r\n  }\r\n\r\n  async #listen(read = true) {\r\n    const me = this;\r\n    const storage = await me.storage();\r\n    if (storage) {\r\n      storage.on('read', me.#readCallback);\r\n      storage.on('write', me.#writeCallback);\r\n      storage.on('error', me.#errorCallback);\r\n      storage.on('select', me.#selectCallback);\r\n      if (read) storage.read(me.#host);\r\n    }\r\n  }\r\n\r\n  #unlisten() {\r\n    const me = this;\r\n    const storage = me.store;\r\n    if (storage) {\r\n      storage.off('read', me.#readCallback);\r\n      storage.off('write', me.#writeCallback);\r\n      storage.off('error', me.#errorCallback);\r\n      storage.off('select', me.#selectCallback);\r\n    }\r\n  }\r\n\r\n  #onSelect(e) {\r\n    this.#host.requestUpdate?.();\r\n  }\r\n\r\n  #onRead(e) {\r\n    const me = this;\r\n    me.#host.onDataRead?.(e.detail.data);\r\n    me.#notify('data-read', e.detail.data);\r\n  }\r\n\r\n  #onWrite(e) {\r\n    const me = this;\r\n    me.#host.onDataWrite?.(e.detail.data);\r\n    me.#notify('data-write', e.detail.data);\r\n  }\r\n\r\n  #onError(e) {\r\n    const me = this;\r\n    GSLog.error(me.#host, e);\r\n    me.#host.onDataError?.(e);\r\n    me.#notify('data-error', e.detail.data);\r\n  }\r\n\r\n  #notify(name, data) {\r\n    this.#host.emit(name, data, true, false, true);\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Controller for elment move events, properly handling mouse events.\r\n */\r\nexport class ElementMoveController {\r\n\r\n  #host;\r\n  #element;\r\n  #attached = false;\r\n\r\n  #cursorX = 0;\r\n  #cursorY = 0;\r\n\r\n  #mouseUpCallback;\r\n  #mouseDownCallback;\r\n  #mouseMoveCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n    me.#mouseUpCallback = me.#onMouseUp.bind(me);\r\n    me.#mouseDownCallback = me.#onMouseDown.bind(me);\r\n    me.#mouseMoveCallback = me.#onMouseMove.bind(me);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host = null;\r\n  }\r\n\r\n  attach(element) {\r\n    const me = this;\r\n    if (!me.#attached) {\r\n      me.#element = element;\r\n      me.#attached = true;\r\n      me.#host.attachEvent(me.#element, 'mousedown', me.#mouseDownCallback);\r\n    }\r\n  }\r\n\r\n  reset() {\r\n    const me = this;\r\n    me.#cursorX = 0;\r\n    me.#cursorY = 0;\r\n    me.#host.removeEvent(document, 'mouseup', me.#mouseUpCallback);\r\n    me.#host.removeEvent(document, 'mousemove', me.#mouseMoveCallback);\r\n  }\r\n\r\n  /**\r\n  * Call host onStartMove function\r\n  * @param {MouseEvent} e \r\n  */\r\n  #onMouseDown(e) {\r\n    const me = this;\r\n    me.#host.prevent(e);\r\n    me.#cursorX = e.clientX;\r\n    me.#cursorY = e.clientY;\r\n    me.#host.onStartMove?.(e, me.#cursorX, me.#cursorY);\r\n    me.#host.attachEvent(document, 'mouseup', me.#mouseUpCallback, true);\r\n    me.#host.attachEvent(document, 'mousemove', me.#mouseMoveCallback);\r\n  }\r\n\r\n  /**\r\n   * Remove mousemove listener and call host onEndMove function\r\n   * @param {MouseEvent} e \r\n   */\r\n  #onMouseUp(e) {\r\n    const me = this;\r\n    me.#host.prevent(e);\r\n    me.#host.removeEvent(document, 'mousemove', me.#mouseMoveCallback);\r\n    return me.#host.onEndMove?.(e, me.#cursorX, me.#cursorY);\r\n  }\r\n\r\n  /**\r\n   * Call host onMouseMove function\r\n   * @param {MouseEvent} e \r\n   */\r\n  #onMouseMove(e) {\r\n    const me = this;\r\n    me.#host.prevent(e);\r\n\r\n    me.#host.onMouseMove?.(e, me.#cursorX, me.#cursorY);\r\n\r\n    if (me.#cursorX < e.clientX) {\r\n      me.#host.onCursorRight?.(e, me.#cursorX, me.#cursorY);\r\n    } else if (me.#cursorX > e.clientX) {\r\n      me.#host.onCursorLeft?.(e, me.#cursorX, me.#cursorY);\r\n    }\r\n\r\n    if (me.#cursorY < e.clientY) {\r\n      me.#host.onCursorUp?.(e, me.#cursorX, me.#cursorY);\r\n    } else if (me.#cursorY > e.clientY) {\r\n      me.#host.onCursorDown?.(e, me.#cursorX, me.#cursorY);\r\n    }\r\n\r\n    me.#cursorX = e.clientX;\r\n    me.#cursorY = e.clientY;\r\n\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\n\r\n/**\r\n * Listens for theme change and update component to apply new theme.\r\n * External theme changes only if component theme is not set.\r\n * Bootstrap uses CSS selector for theme in form of attribute value [data-bs-theme=\"***\"]\r\n * Compoennt and all first level childern in shadow dom are updated\r\n */\r\nexport class LocalizationController {\r\n\r\n  #host;\r\n  #language;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#language = host.language;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    LocalizationController.#controllers.add(this);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    LocalizationController.#controllers.delete(me);\r\n    me.#host.removeController(me);\r\n  }\r\n\r\n  hostUpdate() {\r\n    const me = this;\r\n    if (me.#language !== me.#host?.language) {\r\n      me.#language === me.#host?.language;\r\n      me.updateLanguage(me.#language);\r\n    }\r\n  }\r\n\r\n  updateLanguageExt(langauge) {\r\n    if (!this.#language) this.updateLanguage(langauge);\r\n  }\r\n\r\n  updateLanguage(lang) {\r\n    if (!lang) return;\r\n    this.#host.requestUpdate();\r\n  }\r\n\r\n  static #controllers = new Set();\r\n\r\n  static #onLanguage(e) {\r\n    const me = LocalizationController;\r\n    me.#controllers.forEach(c => c.updateLanguageExt(e.detail));\r\n  }\r\n\r\n  static #init() {\r\n    GSEvents.on(window, null, 'gs-language', LocalizationController.#onLanguage);\r\n  }\r\n\r\n  static {\r\n    LocalizationController.#init();\r\n  }\r\n\r\n}  \r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Handle screen orientation events.\r\n * Trigger rerender to optionally hide element if \r\n * screen orientation is not supported\r\n */\r\nexport class OrientationController {\r\n\r\n    static #hosts = new Set();\r\n    #host;\r\n    \r\n    constructor(host) {\r\n      this.#host = host;\r\n      host.addController(this);\r\n    }\r\n    \r\n    hostConnected() {\r\n      OrientationController.#hosts.add(this);\r\n      this.update();\r\n    }\r\n    \r\n    hostDisconnected() {\r\n      const me = this;\r\n      OrientationController.#hosts.delete(me);\r\n      me.#host.removeController(me);      \r\n      me.#host = null;\r\n    }\r\n\r\n    update() {\r\n      this.#host.requestUpdate();\r\n    }\r\n\r\n    static #onOrientation(e) {\r\n      Array.from(OrientationController.#hosts).forEach(h => h.update());\r\n    }\r\n    \r\n    static {\r\n      screen.orientation.addEventListener('change', OrientationController.#onOrientation);\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\nimport { GSTemplateCache } from \"../base/GSTemplateCache.mjs\";\r\nimport { GSDOM } from \"../base/GSDOM.mjs\";\r\n\r\n/**\r\n * Handle element template and signal rerender when ready\r\n * Sequencial template load is used to prevent multiple request for the same URL\r\n */\r\nexport class TemplateController {\r\n\r\n  #host;\r\n  #template;\r\n  #lastRef;\r\n\r\n  static #scheduled = false;\r\n  static #tasks = new Set();\r\n  static #cache = new Map();\r\n  static #refs = new Set();\r\n\r\n  static get isPrefetch() {\r\n    return globalThis.GS_TEMPLATE_PREFETCH || false;\r\n  }\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(this);\r\n  }\r\n\r\n  // inherited\r\n  hostConnected() {\r\n    const me = this;\r\n    /* \r\n    if(TemplateController.isPrefetch) {\r\n      me.hostUpdate();\r\n    }\r\n    */\r\n  }\r\n\r\n  // inherited\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host = null;\r\n    me.#lastRef = null;\r\n    me.#template = null;\r\n  }\r\n\r\n  // inherited\r\n  hostUpdate() {\r\n    const me = this;\r\n    if (me.#template) return;\r\n    const ref = me.templateRef;\r\n    if (me.#lastRef !== ref) {\r\n      me.#template = TemplateController.#cache.get(ref);\r\n      me.#lastRef = ref;\r\n      if (ref && !me.#template) {\r\n        TemplateController.#schedule(this);\r\n      }\r\n    }\r\n  }\r\n\r\n  // inherited\r\n  hostUpdated() {\r\n    const me = this;\r\n    if (me.#template) {\r\n      const host = me.#host;\r\n      //me.hostDisconnected();\r\n      host.removeController(me);\r\n      host.templateInjected?.();\r\n    }\r\n\r\n  }\r\n\r\n  async #load() {\r\n    const me = this;\r\n    const ref = me.templateRef;\r\n    if (!ref) return;\r\n    /* prevents double load, but also creates a render issue\r\n    if (TemplateController.#refs.has(ref)) {\r\n      // already scheduled\r\n      return;\r\n    }\r\n    TemplateController.#refs.add(ref);\r\n    */\r\n    let template = null;\r\n    const isTplEl = ref instanceof HTMLTemplateElement;\r\n    const cacheable = GSUtil.isString(ref);\r\n    if (cacheable) {\r\n      template = TemplateController.#cache.get(ref);\r\n    }\r\n    if (!template) {\r\n      try {\r\n        template = isTplEl ? ref : await GSTemplateCache.loadTemplate(true, ref, ref);\r\n      } catch (err) {\r\n        TemplateController.#refs.delete(ref);\r\n        throw err;\r\n      }\r\n      if (cacheable) {\r\n        TemplateController.#cache.set(ref, template);\r\n      }\r\n    }\r\n\r\n    // slot element msut be added only once \r\n    if (template) {\r\n      me.#template = template.cloneNode(true);\r\n      if (me.#host.dataset.xTemplate !== 'true') {\r\n        me.#host.dataset.xTemplate = 'true';\r\n        Array.from(me.#template.content.children)\r\n          .filter(el => el.hasAttribute('slot'))\r\n          .forEach(el => me.#host?.appendChild(el));\r\n      }\r\n      Array.from(me.#template.content.children)\r\n        .filter(el => el.hasAttribute('slot'))\r\n        .forEach(el => el.remove());\r\n      me.#host?.requestUpdate();\r\n    }\r\n  }\r\n\r\n  get isTemplateElement() {\r\n    return this.#host?.tagName === 'GS-TEMPLATE';\r\n  }\r\n\r\n  get template() {\r\n    return this.#template;\r\n  }\r\n\r\n  get templateRef() {\r\n    return GSDOM.templateRef(this.#host);\r\n  }\r\n\r\n  static async #process(tasks) {\r\n    const list = Array.from(tasks);\r\n    for (let item of list) {\r\n      await item.#load();\r\n      tasks.delete(item);\r\n    }\r\n  }\r\n\r\n  static #schedule(task) {\r\n    const me = TemplateController;\r\n    me.#tasks.add(task);\r\n    if (!me.#scheduled) {\r\n      me.#scheduled = true;\r\n      queueMicrotask(() => me.#process(me.#tasks).finally(me.#scheduled = false));\r\n    }\r\n  }\r\n\r\n}  \r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\n\r\n/**\r\n * Listens for theme change and update component to apply new theme.\r\n * External theme changes only if component theme is not set.\r\n * Bootstrap uses CSS selector for theme in form of attribute value [data-bs-theme=\"***\"]\r\n * Compoennt and all first level childern in shadow dom are updated\r\n */\r\nexport class ThemeController {\r\n\r\n  #host;\r\n  #theme;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#theme = host.theme;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    ThemeController.#controllers.add(this);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    ThemeController.#controllers.delete(me);\r\n    me.#host.removeController(me);\r\n  }\r\n\r\n  hostUpdate() {\r\n    const me = this;\r\n    if (me.#theme !== me.#host?.theme) {\r\n      me.#theme === me.#host?.theme;\r\n      me.updateTheme(me.#theme);\r\n    }\r\n  }\r\n\r\n  updateThemeExt(theme) {\r\n    if (!this.#theme) this.updateTheme(theme);\r\n  }\r\n\r\n  updateTheme(theme) {\r\n    if (!theme) return;\r\n    const me = this;\r\n    GSAttr.set(me.#host, 'data-bs-theme', theme);\r\n    const children = me.#host?.renderRoot?.children || [];\r\n    Array.from(children).forEach(el => GSAttr.set(el, 'data-bs-theme', theme));\r\n  }\r\n\r\n  static #controllers = new Set();\r\n\r\n  static #onTheme(e) {\r\n    const me = ThemeController;\r\n    me.#controllers.forEach(c => c.updateThemeExt(e.detail));\r\n  }\r\n\r\n  static #init() {\r\n    GSEvents.on(window, null, 'gs-theme', ThemeController.#onTheme);\r\n  }\r\n\r\n  static {\r\n    ThemeController.#init();\r\n  }\r\n\r\n}  \r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Handle event when template slot changes\r\n */\r\nexport class SlotController {\r\n\r\n    #host;\r\n    \r\n    constructor(host) {\r\n      this.#host = host;\r\n      host.addController(this);\r\n    }\r\n    \r\n    hostConnected() {\r\n      const me = this;\r\n      const target = me.#host.renderRoot || me.#host;\r\n      me.#host.attachEvent(target, 'slotchange', me.#onSlotChanged.bind(me));\r\n    }\r\n    \r\n    hostDisconnected() {\r\n      const me = this;\r\n      me.#host.removeController(me);      \r\n      me.#host = null;\r\n    }\r\n\r\n    #onSlotChanged(e) {\r\n      if (typeof e.target.assignedElements === 'function') {\r\n        e.target.assignedElements().forEach(el => {\r\n          el.onSlotInjected?.(e.target);\r\n        });\r\n      }\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { templateContent, noChange, LitElement } from './lib.mjs';\r\n\r\nimport { GSEvents } from './base/GSEvents.mjs';\r\nimport { GSEnvironment } from './base/GSEnvironment.mjs';\r\nimport { GSFunction } from './base/GSFunction.mjs';\r\nimport { GSLocalization } from './base/GSLocalization.mjs';\r\nimport { AdoptedController } from './controllers/AdoptedController.mjs';\r\nimport { ContentController } from './controllers/ContentController.mjs';\r\nimport { AttributeController } from './controllers/AttributeController.mjs';\r\nimport { LocalizationController } from './controllers/LocalizationController.mjs';\r\nimport { OrientationController } from './controllers/OrientationController.mjs';\r\nimport { TemplateController } from './controllers/TemplateController.mjs';\r\nimport { orientation } from './properties/orientation.mjs';\r\nimport { protocol } from './properties/protocol.mjs';\r\nimport { environment } from './properties/environment.mjs';\r\nimport { ThemeController } from './controllers/ThemeController.mjs';\r\nimport { notEmpty } from './properties/verificator.mjs';\r\nimport { DataController } from './controllers/DataController.mjs';\r\nimport { GSDOM } from './base/GSDOM.mjs';\r\nimport { GSData } from './base/GSData.mjs';\r\nimport { GSUtil } from './base/GSUtil.mjs';\r\nimport { SlotController } from './controllers/SlotController.mjs';\r\nimport { GSAttributeHandler } from './base/GSAttributeHandler.mjs';\r\n\r\n/**\r\n * Main WebComponent used by all other GS-* components\r\n */\r\nexport class GSElement extends LitElement {\r\n\r\n  static properties = {\r\n    flat: { type: Boolean },\r\n    rtl: { type: Boolean, reflect: true },\r\n    hide: { type: Boolean, reflect: true },\r\n    padding: { type: Number },\r\n    margin: { type: Number },\r\n    rounded: { type: Boolean },\r\n    bordered: { type: Boolean },\r\n    shadow: { type: Boolean },\r\n    keep: { type: Boolean },\r\n\r\n    onready: {},\r\n    css: {},\r\n    theme: {},\r\n\r\n    os: {},\r\n    browser: {},\r\n    language: { reflect: true, hasChanged: notEmpty },\r\n    environment: environment,\r\n    orientation: orientation,\r\n    protocol: protocol,\r\n\r\n    template: {}\r\n  }\r\n\r\n  #adopted;\r\n  #uiHandler;\r\n  #orientation;\r\n  #localization;\r\n  #dataController;\r\n  #slotController;\r\n  #themes\r\n  #template;\r\n  #content;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.css = '';\r\n    me.language = \"\";\r\n    me.#adopted = new AdoptedController(me);\r\n    me.#content = new ContentController(me);\r\n    me.#localization = new LocalizationController(me);\r\n    me.#orientation = new OrientationController(me);\r\n    //me.#template = new TemplateController(me);\r\n    me.#themes = new ThemeController(me);\r\n    me.#slotController = new SlotController(me);\r\n  }\r\n\r\n  attributeChangedCallback(name, oldValue, newValue) {\r\n    super.attributeChangedCallback(name, oldValue, newValue);\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    const me = this;\r\n    const tpl = GSDOM.templateRef(me);\r\n    if (tpl) me.#template = new TemplateController(me);    \r\n    if (me.isBindable) me.binded();\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    GSEvents.detachListeners(this);\r\n    super.disconnectedCallback();\r\n  }\r\n\r\n  /**\r\n   * Override Lit element createRenderRoot function.\r\n   * If flat, do not create shadowDom, render within self\r\n   * @returns \r\n   */\r\n  createRenderRoot() {\r\n    return this.flat ? this : super.createRenderRoot();\r\n  }\r\n\r\n  /**\r\n   * Override Lit element firstUpdated function.\r\n   * Here we call attribute script onready if available\r\n   * Make sure that inherited classes calls super.firstUpdated\r\n   */\r\n  firstUpdated() {\r\n    super.firstUpdated();\r\n    const me = this;\r\n    if (me.onready) {\r\n      const owner = me.onready.startsWith('this') ? this : window;\r\n      GSFunction.callFunction(me.onready, owner);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Override Lit element willUpdate function.\r\n   * Make sure that inherited classes calls super.willUpdate\r\n   * @param {*} changed \r\n   */\r\n  willUpdate(changed) {\r\n    const me = this;\r\n    if (changed.has('storage')) {\r\n      me.#dataController?.hostDisconnected();\r\n      me.#dataController = undefined;\r\n      if (me.storage) {\r\n        me.#dataController = new DataController(me);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Called when this element injected in some slot\r\n   * @param {*} slot \r\n   */\r\n  onSlotInjected(slot) {\r\n\r\n  }\r\n\r\n  /**\r\n   * Override Lit element render function and control rendering\r\n   * @returns {*} Parsed lit html structure\r\n   */\r\n  render() {\r\n    return this.isAllowRender && !this.hide ? this.renderUI() : '';\r\n  }\r\n\r\n  /**\r\n   * Actual render function to override in inherited components\r\n   * @returns {*} Parsed lit html structure\r\n   */\r\n  renderUI() {\r\n    return this.renderTemplate();\r\n  }\r\n\r\n  /**\r\n   * Render html from provided template element or template url\r\n   * @returns {*}\r\n   */\r\n  renderTemplate() {\r\n    return this.templateRef ? templateContent(this.templateRef) : noChange;\r\n  }\r\n\r\n  /**\r\n   * Render this class css attributes.\r\n   * @returns {Object} JSON object with CSS properties\r\n   */\r\n  renderClass() {\r\n    const me = this;\r\n    const obj = {\r\n      'border': me.bordered,\r\n      'shadow-sm': me.shadow,\r\n      'rounded': me.rounded,\r\n      [`p-${me.padding}`]: me.padding >= 0,\r\n      [`m-${me.margin}`]: me.margin >= 0\r\n    };\r\n    return me.mapCSS(me.css, obj);\r\n  }\r\n\r\n  /**\r\n   * Called when asynchronnous template is injected into component\r\n   */\r\n  templateInjected() {\r\n    \r\n\t}\r\n\r\n  /**\r\n   * Attach bindings\r\n   */\r\n  binded() {\r\n    this.#uiHandler ??= new AttributeController(this);\r\n  }\r\n\r\n  /**\r\n   * Handle bindings \r\n   * @param {*} e \r\n   */\r\n  handle(e) {\r\n    this.#uiHandler?.handle(e);\r\n  }\r\n\r\n  /**\r\n   * Parse CSS string into JSON object\r\n   * @param {String} css CSS string to parse into JSON object\r\n   * @param {Object} obj JSON object to witch to add parsed CSS\r\n   * @returns {Object} css parsed JSON object \r\n   */\r\n  mapCSS(css, obj, flag = true) {\r\n    obj = obj || {};\r\n    (css || '').split(' ')\r\n      .map(v => v.trim())\r\n      .filter(v => v.length > 0)\r\n      .map(v => obj[v.trim()] = flag);\r\n    return obj;\r\n  }\r\n\r\n  /**\r\n   * Initialize dynamic style for component.\r\n   * Call it from constructor for style to be applied to the component\r\n   * Creates a dynamic StyleSheet which holds dynamic StyleRules for template elements\r\n   * @param {String} id \r\n   * @param {String|Object} value \r\n   * @param {boolean} isGlobal \r\n   * @returns {CSSStyleRule}\r\n   */\r\n  dynamicStyle(id, value, isGlobal = false) {\r\n    return this.#adopted.style(id, value, isGlobal);\r\n  }\r\n\r\n  /**\r\n   * Find element by its ID\r\n   * @param {String} name \r\n   * @returns {HTMLElement}\r\n   */\r\n  getByID(query = '') {\r\n    return GSDOM.getByID(this, query);\r\n  }\r\n\r\n  /**\r\n   * Find closest top element by CSS selector\r\n   * @param {String} query \r\n   * @param {Number} levels - walk limit\r\n   * @returns {HTMLElement}\r\n   */\r\n  closest(query = '', levels = -1) {\r\n    return GSDOM.closest(this, query, levels);\r\n  }\r\n\r\n  /**\r\n   * Find element by CSS selector (top level is this element)\r\n   * @param {String} name \r\n   * @returns {HTMLElement}\r\n   */\r\n  query(query = '', shadow = false) {\r\n    return GSDOM.query(this, query, false, shadow);\r\n  }\r\n\r\n  /**\r\n   * Find multiple elements by CSS selector (top level is this element)\r\n   * @param {String} query \r\n   * @returns {Array<HTMLElement>}\r\n   */\r\n  queryAll(query = '', shadow = false) {\r\n    return GSDOM.queryAll(this, query, false, shadow);\r\n  }\r\n\r\n  /**\r\n   * Generic component signal\r\n   * @param {Boolean} bubbles  Does buuble to upper nodes\r\n   * @param {Boolean} composed Does traverse from shadow DOM \r\n   */\r\n  notify(bubbles = true, composed = false, data) {\r\n    this.emit('notify', data, bubbles, composed, true);\r\n  }\r\n\r\n  /**\r\n   * Send event\r\n   * @param {String} name \r\n   * @param {Object} obj \r\n   * @param {Boolean} bubbles \r\n   * @param {Boolean} composed \r\n   * @param {Boolean} cancelable \r\n   */\r\n  emit(name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n    return GSEvents.send(this, name, obj, bubbles, composed, cancelable);\r\n  }\r\n\r\n  /**\r\n   * Wait for event to happen\r\n   * @async\r\n   * @param {String} name \r\n   * @returns {Promise}\r\n   */\r\n  waitEvent(name = '', timeout = 0) {\r\n    return GSEvents.wait(this, name, timeout);\r\n  }\r\n\r\n  /**\r\n   * Listen once for triggered event\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  once(name, func) {\r\n    return this.listen(name, func, true);\r\n  }\r\n\r\n  /**\r\n   * Alternative function for event listen\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  on(name, func, once = false) {\r\n    return this.listen(name, func, once);\r\n  }\r\n\r\n  /**\r\n   * Alternative function for event unlisten\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  off(name, func) {\r\n    return this.unlisten(name, func);\r\n  }\r\n\r\n  /**\r\n   * Prevent event firing up the DOM tree\r\n   * @param {Event} e \r\n   */\r\n  prevent(e) {\r\n    GSEvents.prevent(e);\r\n  }\r\n\r\n  /**\r\n   * Attach event to this element\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  listen(name, func, once = false) {\r\n    return this.attachEvent(this, name, func, once);\r\n  }\r\n\r\n  /**\r\n   * Remove event from this element\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  unlisten(name, func) {\r\n    return this.removeEvent(this, name, func);\r\n  }\r\n\r\n  /**\r\n  * Generic event listener appender\r\n  * \r\n  * @param {HTMLElement} el Element on which to monitor for named events\r\n  * @param {String} name Event name to watch for\r\n  * @param {Function} fn Event trigger callback\r\n  * @param {Boolean} once Listen only once\r\n  * @returns {Boolean} State if attachment was successful\r\n  */\r\n  attachEvent(el, name = '', fn, once = false) {\r\n    return GSEvents.attach(this, el, name, fn, once);\r\n  }\r\n\r\n  /**\r\n  * Generic event listener remove\r\n  * @param {HTMLElement} el Element on which to monitor for named events\r\n  * @param {String} name Event name to watch for\r\n  * @param {Function} fn Event trigger callback\r\n  * @returns {Boolean} State if attachment was successful\t\r\n  */\r\n  removeEvent(el, name = '', fn) {\r\n    return GSEvents.remove(this, el, name, fn);\r\n  }\r\n\r\n  /**\r\n   * Generic element hide function\r\n   */\r\n  toggle() {\r\n    this.hide = !this.hide;\r\n  }\r\n\r\n  translate(value) {\r\n    return GSLocalization.translate(this.language, value);\r\n  }\r\n\r\n  get direction() {\r\n    if (GSUtil.isNull(this.rtl)) return undefined;\r\n    return this.rtl ? 'rtl' : 'ltr';\r\n  }\r\n\r\n  /**\r\n   * Check if component is bindable to process data-gs-atributes\r\n   */\r\n  get isBindable() {\r\n    //return this.dataset.gsTarget;\r\n    return GSAttributeHandler.isBindable(this);\r\n  }\r\n\r\n  /**\r\n   * Return true if current element or chadow dom child is focused\r\n   */\r\n  get isFocused() {\r\n    return this === document.activeElement;\r\n  }\r\n\r\n  /**\r\n   * Element tag name\r\n   */\r\n  get tag() {\r\n    return this.tagName.toLowerCase();\r\n  }\r\n\r\n  /**\r\n   * Reference to cached template if set\r\n   */\r\n  get templateRef() {\r\n    return this.#template?.template;\r\n  }\r\n\r\n  /**\r\n   * Reference to rendered content\r\n   */\r\n  get contentRef() {\r\n    return this.#content.contentRef;\r\n  }\r\n\r\n  /**\r\n   * Reference to data controller if initialized\r\n   */\r\n  get dataController() {\r\n    return this.#dataController;\r\n  }\r\n\r\n  /**\r\n  * Check if element is allowed to be rendered\r\n  * @returns {Boolean} \r\n  */\r\n  get isAllowRender() {\r\n    return this.isValidEnvironment\r\n      && this.isValidBrowser\r\n      && this.isValidOS\r\n      && this.isValidProtocol\r\n      && this.isValidOrientation;\r\n  }\r\n\r\n  /**\r\n   * Returns if environment matched\r\n   * dektop, mobile, tablet, android, linux, winwdows, macos\r\n   * @returns {Boolean} \r\n   */\r\n  get isValidEnvironment() {\r\n    return GSEnvironment.isValidEnvironment(this.environment ?? '');\r\n  }\r\n\r\n  /**\r\n   * Return true if element can be rendered bysed on OS matching\r\n   * linux, windows...etc\r\n   * @returns {Boolean} \r\n   */\r\n  get isValidOS() {\r\n    return GSEnvironment.isDevice(this.os ?? '');\r\n  }\r\n\r\n  /**\r\n   * Returns if orientation matched for element rendering\r\n   * horizontal | landscape), vertical | portrait), ; return true if not set\r\n   * @returns {Boolean} \r\n   */\r\n  get isValidOrientation() {\r\n    return GSEnvironment.isValidOrientation(this.orientation ?? '');\r\n  }\r\n\r\n  /**\r\n   * Returns if browser matched, used to determine rendering/removal\r\n   * @returns {Boolean} \r\n   */\r\n  get isValidBrowser() {\r\n    return GSEnvironment.isValidBrowser(this.browser ?? '');\r\n  }\r\n\r\n  /**\r\n   * Returns if browser matched, used to determine rendering/removal\r\n   * @returns {Boolean} \r\n   */\r\n  get isValidProtocol() {\r\n    return GSEnvironment.isValidProtocol(this.protocol ?? '');\r\n  }\r\n\r\n  /**\r\n   * Internal attribute set if component is genrated by other components\r\n   */\r\n  get isGenerated() {\r\n    return this.hasAttribute('generated');\r\n  }\r\n\r\n  /**\r\n   * Get parent GS-* component\r\n   */\r\n  get parentComponent() {\r\n    return GSDOM.parentAll(this).filter(x => x instanceof GSElement).next()?.value;\r\n  }\r\n\r\n  /**\r\n   * Get this class name\r\n   */\r\n  get clazzName() {\r\n    return this.constructor.name;\r\n  }\r\n\r\n  get definitions() {\r\n    const list = [...GSDOM.inheritance(this)].map(o => o.constructor?.properties).filter(o => o);\r\n    list.push(this.constructor?.properties);\r\n    return GSData.mergeObjects(list);\r\n  }\r\n\r\n  /**\r\n   * Get instance of internal styles\r\n   */\r\n  get elementStyles() {\r\n    return this.constructor.elementStyles.map(s => Object.values(s).filter(o => o instanceof CSSStyleSheet).pop()).pop();\r\n  }\r\n\r\n  /**\r\n   * Internal shadow styles rule\r\n   * @param {*} name \r\n   * @returns \r\n   */\r\n  cssRule(name) {\r\n    return Array.from(this.elementStyles.rules).filter(r => r.selectorText === name).pop();\r\n  }\r\n\r\n  /**\r\n   * Set dynamic CSS rule \r\n   * See GSIcon hot it is done\r\n   * @param {*} rule \r\n   * @param {*} name \r\n   * @param {*} value \r\n   */\r\n  setCSSProperty(rule, name, value) {\r\n    this.cssRule(rule).style.setProperty(name, value);\r\n  }\r\n\r\n  /**\r\n   * Extract and merge all static properties definition from WebComponent instance\r\n   * @param {GSElement} obj \r\n   * @returns {Object}\r\n   */\r\n  static allProperties(obj) {\r\n    return GSDOM.allProperties(obj);\r\n  }\r\n\r\n  /**\r\n   * Register class as WebComponent to the browser\r\n   * @param {String} name \r\n   * @param {class} clazz Optional, if not set, use self\r\n   * @param {Object} opt Options, used only when extending non HTMLElement class  \r\n   */\r\n  static define(name, clazz, opt) {\r\n    if (!customElements.get(name)) {\r\n      customElements.define(name, clazz || this, opt);\r\n    }\r\n  }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSElement } from \"../GSElement.mjs\";\r\n\r\n/**\r\n * Controller for child element navigation / selection / focusing\r\n */\r\nexport class ElementNavigationController {\r\n\r\n  #host;\r\n  #attached;\r\n  #focused;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host = null;\r\n    me.#attached = false;\r\n  }\r\n\r\n  get circular() {\r\n    return this.#host?.circular === true;\r\n  }\r\n\r\n  get multiple() {\r\n    return this.#host?.multiple === true;\r\n  }\r\n\r\n  get focused() {\r\n    return this.#focused;\r\n  }\r\n\r\n  get selected() {\r\n    return this.#host.active;\r\n  }\r\n\r\n  /**\r\n   * Called on first update from host component\r\n   */\r\n  init() {\r\n\r\n  }\r\n\r\n  /**\r\n   * Called on first update from host component\r\n   */  \r\n  attach(el) {\r\n    const me = this;\r\n    if (me.#attached) return;\r\n    me.#attached = true;\r\n    me.#host.attachEvent(el, 'keydown', e => me.onKeyDown(e));\r\n    me.#host.attachEvent(el, 'keyup', e => me.onKeyUp(e));\r\n    me.#host.attachEvent(el, 'click', e => me.onClick(e));\r\n    me.#host.attachEvent(el, 'focusin', e => me.onFocusIn(e));\r\n    me.#host.attachEvent(el, 'focusout', e => me.onFocusOut(e));\r\n  }\r\n\r\n  previous() {\r\n    const me = this;\r\n    let el = me.#focused?.previousElementSibling;\r\n    while (el?.disabled) el = el.previousElementSibling;\r\n    if (me.circular && !el) el = me.lastElementChild;\r\n    el?.focus();\r\n  }\r\n\r\n  next() {\r\n    const me = this;\r\n    let el = me.#focused?.nextElementSibling;\r\n    while (el?.disabled) el = el.nextElementSibling;\r\n    if (me.circular && !el) el = me.firstElementChild;\r\n    el?.focus();\r\n  }\r\n\r\n  /**\r\n   * Reset focus / selection\r\n   */\r\n  reset() {\r\n    const me = this;\r\n    const active = me.selected;\r\n    if (me.multiple) {\r\n      active.forEach(el => {\r\n        el.active = false;\r\n        el.blur();\r\n      });\r\n    } else if (active) {\r\n      active.active = false;\r\n      active.blur();\r\n    }\r\n    me.#focused = undefined;\r\n    me.#host?.emit('group-reset', undefined, true);\r\n  }\r\n\r\n  /**\r\n   * Callback when child element selected\r\n   * @param {*} el \r\n   */\r\n  #onSelected(el) {\r\n    const me = this;\r\n    me.#host?.onSelected?.(el);\r\n    me.#host?.emit('group-selected', el, true);\r\n  }\r\n\r\n  /**\r\n   * Callback when child element deselected\r\n   * @param {*} el \r\n   */\r\n  #onDeselected(el) {\r\n    this.#host?.onDeselected?.(el);\r\n    this.#host?.emit('group-deselected', el, true);\r\n  }\r\n\r\n  /**\r\n   * Callback when child element focused\r\n   * @param {*} el \r\n   */\r\n  #onFocused(el) {\r\n    this.#host?.onFocused?.(el);\r\n    this.#host?.emit('group-focused', el, true);\r\n  }\r\n\r\n  /**\r\n   * Element navigation filter where we can select if focused element is navigable\r\n   * @param {*} el \r\n   * @returns \r\n   */\r\n  #isNavigable(el) {\r\n    return this.#host?.isNavigable ? this.#host?.isNavigable(el) : true;\r\n  }\r\n\r\n  #focus(el) {\r\n    const me = this;\r\n    if (!me.#isNavigable(el)) return;\r\n    me.#focused = el;\r\n    if (el) {\r\n      me.#onFocused(me.#focused);\r\n    }\r\n  }\r\n\r\n  #toggle(el) {\r\n    if (!el) return;\r\n    const me = this;\r\n    if (!me.#isNavigable(el)) return;\r\n    if (el.active) {\r\n      me.#onSelected(el);\r\n    } else {\r\n      me.#onDeselected(el);\r\n    }\r\n  }\r\n\r\n  #select(el) {\r\n    const me = this;\r\n    if (!me.#isNavigable(el)) return;\r\n\r\n    const active = me.selected;\r\n    if (active && !me.multiple) {\r\n      active.active = false;\r\n      me.#toggle(active);\r\n    }\r\n\r\n    if (me.multiple) {\r\n      el.active = !el.active;\r\n    } else {\r\n      el.active = true;\r\n    }\r\n    me.#toggle(el);\r\n  }\r\n\r\n  onFocusOut(e) {\r\n    const me = this;\r\n    //if (me.#focused === e.target) me.#focused = undefined;\r\n  }\r\n\r\n  onFocusIn(e) {\r\n    if (!e.target.isNav) return;\r\n    const me = this;\r\n    if(e.relatedTarget?.isNav) {\r\n      me.#focus(e.target)\r\n    } else {\r\n      me.selected?.focus();\r\n    }\r\n\r\n  }\r\n\r\n  onClick(e) {\r\n    const me = this;\r\n    const el = e.composedPath()\r\n    .filter(el => el instanceof GSElement)\r\n    .filter(el => el.parentComponent === me.#host).pop();\r\n    if (!me.#isNavigable(el)) return;\r\n    if (e.ctrlKey) me.reset();\r\n    me.#onDeselected(me.selected);\r\n    me.#select(el);\r\n  }\r\n\r\n  onKeyDown(e) {\r\n    const me = this;\r\n    if (!e.target.isNav) return;\r\n    switch (e.code) {\r\n      case 'ArrowUp':\r\n      case 'ArrowLeft':\r\n        me.previous();\r\n        break;\r\n      case 'ArrowDown':\r\n      case 'ArrowRight':\r\n        me.next();\r\n        break;\r\n    }\r\n\r\n  }\r\n\r\n  onKeyUp(e) {\r\n    const me = this;\r\n    if (!e.target.isNav) return;\r\n    switch (e.code) {\r\n      case 'Space':\r\n      case 'Enter':\r\n        me.#focused?.click();\r\n        break;\r\n    }\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSEventBus } from \"../base/GSEventBus.mjs\";\r\n\r\n/**\r\n * Controller for multiple elements groups\r\n */\r\nexport class GroupController {\r\n\r\n  #host;\r\n\r\n  #busEvent;\r\n  #busCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    if (me.#host.group) {\r\n      me.#busCallback = me.#onBusEvent.bind(me);\r\n      me.#busEvent = GSEventBus.register(me.#host.clazzName);\r\n      me.#busEvent.on(me.#host.group, me.#busCallback);\r\n    }\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#busEvent?.off(me.#host.group, me.#busCallback);\r\n    me.#host.removeController(me);\r\n    me.#host = null;\r\n  }\r\n\r\n  #onBusEvent(e) {\r\n    this.#host.onBusEvent?.(e);\r\n  }\r\n\r\n  notify(data) {\r\n    const me = this;\r\n    me.#busEvent?.emit(me.#host.group, {owner: me.#host, item:data}); \t\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSRouter } from '../base/GSRouter.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSRouterElement extends GSElement {\r\n\r\n  #router = null;\r\n\r\n  static properties = {\r\n    url: {},\r\n    disabled: { type: Boolean },\r\n    logging: { type: Boolean }\r\n  };\r\n\r\n  constructor() {\r\n    super();\r\n    this.logging = false;\r\n    this.#router = new GSRouter();\r\n    this.#router.log = false;\r\n  }\r\n\r\n  renderUI() {\r\n    return '';\r\n  }\r\n\r\n  updated(changed) {\r\n    this.#router.log = this.logging;\r\n    if (changed.has('url')) {\r\n      this.#router.initialize(this.url);\r\n    }\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    this.#router?.disable();\r\n    this.#router = null;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-router');\r\n  }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\n\r\nexport class GSAccordionElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    autoclose: { type: Boolean },\r\n    cssItem: { reflect: true, attribute: 'css-item' },\r\n    cssHeader: { reflect: true, attribute: 'css-header' },\r\n    cssBody: { reflect: true, attribute: 'css-body' },\r\n    data: { type: Array }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.data = this.settings;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\"\r\n       @notify=\"${me.#onNotify.bind(me)}\"\r\n       @click=\"${me.#onClick}\" \r\n       @keyup=\"${me.#onKeyUp}\" \r\n       class=\"accordion ${classMap(me.renderClass())}\">\r\n       ${this.#renderItems()}\r\n       <slot></slot></div>`\r\n  }\r\n\r\n  get items() {\r\n    return this.queryAll('gs-accordion-item');\r\n  }\r\n\r\n  get settings() {\r\n    const cfg = this.constructor.properties;\r\n    return GSItem.collect(this).map(el => GSAttr.proxify(el, cfg));\r\n  }\r\n\r\n  close() {\r\n    this.#state(false);\r\n  }\r\n\r\n  open() {\r\n    this.#state(true);\r\n  }\r\n\r\n  onDataRead(data) {\r\n    this.data = data;\r\n  }\r\n\r\n  #renderItems() {\r\n    return this.data.map(o => {\r\n      return html`<gs-accordion-item generated\r\n        .opened=\"${ifDefined(o.disabled === true)}\" \r\n        message=\"${ifDefined(o.message)}\" \r\n        template=\"${ifDefined(o.template)}\" \r\n        title=\"${ifDefined(o.title)}\"></gs-accordion-item>`;\r\n    });\r\n  }\r\n\r\n  #state(val = false) {\r\n    this.items.forEach(el => el.opened = val);\r\n    this.notify();\r\n  }\r\n\r\n  #onNotify(e) {\r\n    const me = this;\r\n    if (me.autoclose && e.target.opened) {\r\n      me.items.filter(el => el != e.target).forEach(el => el.opened = false);\r\n    }\r\n  }\r\n\r\n  #onClick(e) {\r\n    const isItemCloser = e?.composedPath()[0]?.matches('.accordion-button');\r\n    if(isItemCloser) e.target.toggle?.();\r\n  }\r\n\r\n  #onKeyUp(e) {\r\n    switch (e.code) {\r\n      case 'ArrowLeft':\r\n        e.target.close?.();\r\n        break;\r\n      case 'ArrowRight':\r\n        e.target.open?.();\r\n        break;\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-accordion');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { html } from '../lib.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSAccordionItemElement extends GSElement {\r\n\r\n  static properties = {\r\n    cssHeader: { reflect: true, attribute: 'css-header' },\r\n    cssBody: { reflect: true, attribute: 'css-body' },\r\n    message: { reflect: true, },\r\n    title: { reflect: true, },\r\n    opened: { type: Boolean, reflect: true },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  shouldUpdate(changedProperties) {\r\n    return this.owner?.tagName === 'GS-ACCORDION';\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const owner = me.owner;\r\n    const cssHeader = me.cssHeader || owner?.cssHeader;\r\n    const cssBody = me.cssBody || owner?.cssBody;\r\n    return html`<div class=\"accordion-item ${me.css}\">\r\n             <h2 class=\"accordion-header\">\r\n               <button type=\"button\" \r\n                class=\"accordion-button  ${cssHeader} ${me.opened ? '' : 'collapsed'}\"> \r\n                 ${me.translate(me.title)}\r\n               </button>\r\n             </h2>\r\n             <div class=\"accordion-collapse collapse  ${cssBody} ${me.opened ? 'show' : ''}\">\r\n               <div class=\"accordion-body\">\r\n                   ${me.translate(me.message)}\r\n                   ${me.renderTemplate()}\r\n                   <slot></slot>\r\n               </div>\r\n             </div>      \r\n     </div>`\r\n  }\r\n\r\n  open() {\r\n    this.notify(true);\r\n  }\r\n  \r\n  close() {\r\n    this.notify(false);\r\n  }\r\n\r\n  toggle() {\r\n    this.notify(!this.opened);\r\n  }\r\n\r\n  notify(val = false) {\r\n    const me = this;\r\n    me.opened = val;\r\n    super.notify();\r\n  }\r\n\r\n  get owner() {\r\n    return this.closest('gs-accordion') || GSDOM.component(this);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-accordion-item');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, ref, html, ifDefined } from '../lib.mjs';\r\nimport { color } from '../properties/index.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\n\r\nexport class GSAlertElement extends GSElement {\r\n\r\n    static properties = {\r\n        message: { reflect: true },\r\n        color: { ...color },\r\n        closed: { reflect: true, type: Boolean },\r\n        closable: { reflect: true, type: Boolean },\r\n        delay: { reflect: true, type: Number },\r\n    }\r\n\r\n    #ref;\r\n    #pause = false;\r\n    #interval = 0;\r\n    #last = 0;\r\n    #data;\r\n\r\n    constructor() {\r\n        super();\r\n        this.delay = 1;\r\n        this.#ref = createRef();\r\n        this.#data = this.#proxify(this);\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        clearInterval(this.#interval);\r\n        super.disconnectedCallback();\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div role=\"alert\" dir=\"${ifDefined(me.direction)}\" ${ref(me.#ref)} \r\n            @mouseover=\"${() => me.#pause = true}\"\r\n            @mouseout=\"${() => me.#pause = false}\"\r\n            class=\"alert fade ${classMap(me.renderClass())}\" >\r\n            ${me.#first}\r\n            ${me.renderTemplate()}\r\n            <slot></slot>\r\n            ${me.#second}\r\n        </div>`;\r\n    }\r\n\r\n    firstUpdated(changed) {\r\n        this.#handleBillboard();\r\n        super.firstUpdated(changed);\r\n    }\r\n\r\n    updated(changed) {\r\n        if (!changed.has('opened')) return;\r\n        this.#handleBillboard();\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            'show': !me.closed,\r\n            'alert-dismissible': me.closable,\r\n            [`alert-${this.color}`]: me.color,\r\n\r\n        }\r\n        return css;\r\n    }\r\n\r\n    open() {\r\n        this.notify(false);\r\n    }\r\n\r\n    close() {\r\n        this.notify(true);\r\n    }\r\n\r\n    toggle() {\r\n        this.notify(!this.closed);\r\n    }\r\n\r\n    notify(val = false) {\r\n        const me = this;\r\n        me.closed = val;\r\n        if (me.closed) setTimeout(() => { me.#ref.value.classList.toggle('d-none', true) }, 250);\r\n        super.notify();\r\n    }\r\n\r\n    get isBillboard() {\r\n        return this.#data?.length > 0;\r\n    }\r\n\r\n    get #message() {\r\n        return this.translate(this.message);\r\n    }\r\n\r\n    get #first() { return this.rtl ? this.#button : this.#message; };\r\n\r\n    get #second() { return this.rtl ? this.#message : this.#button; };\r\n\r\n    get #button() {\r\n        return this.closable ? html`<button type=\"button\" class=\"btn-close\" aria-label=\"Close\" @click=\"${this.close}\"></button>` : '';\r\n    }\r\n\r\n    /**\r\n     * Proxify GS-ITEM elements to easily read attributes\r\n     */\r\n    #proxify(root) {\r\n        return GSItem.collect(root).map(el => GSAttr.proxify(el, {message:{}}));\r\n    }\r\n\r\n    #handleBillboard() {\r\n        const me = this;\r\n        if (me.closed) {\r\n            clearInterval(me.#interval);\r\n            me.#interval = 0;\r\n        } else {\r\n            me.#billboard();\r\n        }        \r\n    }\r\n\r\n    #billboard() {\r\n        const me = this;\r\n        if (!me.isBillboard) return;\r\n        const items = me.#data;\r\n        if (me.message) {\r\n            me.#last = -1;\r\n        } else {\r\n            me.message = items[0].message;\r\n        }\r\n        me.#interval = setInterval(() => {\r\n            if (me.#pause) return;\r\n            me.#last++;\r\n            if (me.#last >= items.length ) me.#last = 0;\r\n            me.message = items[me.#last].message;\r\n        }, me.delay * 1000);\r\n    }\r\n\r\n    static {\r\n        this.define('gs-alert');\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, ifDefined, html, ref, createRef } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color, size, buttonType, ButtonTypes, SizeTypes } from '../properties/index.mjs';\r\n\r\nexport class GSButtonElement extends GSElement {\r\n\r\n  static properties = {\r\n    type: { ...buttonType }, // reset, submit\r\n    size: { ...size }, // small, large, normal\r\n    color: { ...color },\r\n    clickCss: { attribute : 'click-css'},\r\n    hoverCss: { attribute : 'hover-css'},\r\n    toggleColor: { ...color, attribute : 'toggle-color' },\r\n    autofocus: { type: Boolean },\r\n    disabled: { type: Boolean, reflect: true },\r\n    outline: { type: Boolean, reflect: true },\r\n    active: { type: Boolean, reflect: true },\r\n    toggling: { type: Boolean },\r\n    icon: {},\r\n    title: {},\r\n    tooltip: {},\r\n    text: {},\r\n    url: {}\r\n  };\r\n\r\n  #refEl = createRef();\r\n  #refIco = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    this.type = 'button';\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    if (this.autofocus && !this.disabled) this.focus();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<button part=\"button\" role=\"button\" ${ref(me.#refEl)}\r\n        dir=\"${ifDefined(me.direction)}\"\r\n        type=\"${ifDefined(me.type)}\" \r\n        class=\"btn ${classMap(me.renderClass())}\" \r\n        title=\"${ifDefined(me.#tooltip)}\"\r\n        ?disabled=${me.disabled}\r\n        @mouseover=\"${me.#onMouseOver}\"\r\n        @mouseout=\"${me.#onMouseOut}\"\r\n        @click=\"${me.#onClick}\">\r\n          ${me.#first} ${me.#second}</button>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const size = SizeTypes[me.size];\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'active': me.active,\r\n      'focus-ring': document.activeElement === me,\r\n      [`text-${me.text}`]: me.text,\r\n      [`btn-${size}`]: size,\r\n      [`btn-outline-${me.color}`]: me.outline,\r\n      [`btn-${me.color}`]: !me.outline && me.color,\r\n      [`btn-${me.toggleColor}`]: me.active && me.toggleColor,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  click() {\r\n    this.#refEl.value?.click();\r\n  }\r\n\r\n  focus() {\r\n    requestAnimationFrame(() => this.#refEl.value?.focus());\r\n  }\r\n\r\n  toggle() {\r\n    this.active = !this.active;\r\n  }\r\n\r\n  #onClick(e) {\r\n    const me = this;\r\n    if(me.toggling) me.toggle();\r\n    me.iconEl?.animate?.();\r\n    me.#onHref(e)\r\n    if (me.dataset.event) return me.emit(me.dataset.event, null, me.dataset.bubbles, me.dataset.composed, true);\r\n    if (me.isReset) return me.form?.reset();\r\n    if (me.isSubmit) return me.form?.submit();\r\n    me.notify();\r\n  }\r\n\r\n  #onHref(e) {\r\n    const me = this;\r\n    if (!me.url) return;\r\n    if (me.url.startsWith('#')) {\r\n      location.hash = me.url;\r\n    } else {\r\n      location.href = me.url;\r\n    }\r\n  }\r\n\r\n  #onMouseOver() {\r\n    this.iconEl?.hover?.(true);\r\n  }\r\n\r\n  #onMouseOut() {\r\n    this.iconEl?.hover?.(false);\r\n  }\r\n\r\n  get isReset() {\r\n    return ButtonTypes.isReset(this.type);\r\n  }\r\n\r\n  get isSubmit() {\r\n    return ButtonTypes.isSubmit(this.type);\r\n  }\r\n\r\n  get iconEl() {\r\n    return this.#refIco.value;\r\n  }\r\n\r\n  get form() {\r\n    return this.closest('gs-form, form');\r\n  }\r\n\r\n  get #title() {\r\n    return this.translate(this.title);\r\n  }\r\n\r\n  get #tooltip() {\r\n    return this.translate(this.tooltip);\r\n  }\r\n\r\n  get #first() { return this.rtl ? this.#title : this.#iconHtml; };\r\n\r\n  get #second() { return this.rtl ? this.#iconHtml : this.#title; };\r\n\r\n  get #iconHtml() { return this.icon ? this.#renderIcon : html`<slot name=\"icon\"></slot>`; }\r\n\r\n  get #renderIcon() {\r\n    return  html`\r\n    <gs-icon ${ref(this.#refIco)} \r\n    name=\"${this.icon}\" \r\n    click-css=\"${ifDefined(this.clickCss)}\" \r\n    hover-css=\"${ifDefined(this.hoverCss)}\" \r\n    data-delay=\"1\"></gs-icon>`;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-button');\r\n  }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { unsafeHTML, classMap, html, ifDefined, css } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSDate } from '../base/GSDate.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { notEmpty, numGE0 } from '../properties/index.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\nexport class GSCalendarElement extends GSElement {\r\n\r\n  static styles = css`.year::-webkit-outer-spin-button,.year::-webkit-inner-spin-button {-webkit-appearance: none;margin: 0;} .year {-moz-appearance: textfield;} .day:focus{font-weight: bold;}`\r\n\r\n  static properties = {\r\n    date: {},\r\n    target: {},\r\n    format: { hasChanged: notEmpty },\r\n    editable: { type: Boolean },\r\n    range: { type: Number },\r\n    year: { type: Number },\r\n    month: { type: Number, hasChanged: numGE0 },\r\n    day: { type: Number, hasChanged: numGE0 },\r\n    minYear: { attribute: 'year-min', type: Number },\r\n    maxYear: { attribute: 'year-max', type: Number },\r\n    arrovPrev: { attribute: 'arrow-prev' },\r\n    arrowNext: { attribute: 'arrow-next' },\r\n    cssDays: { attribute: 'css-days' },\r\n    cssToday: { attribute: 'css-today' },\r\n    cssWeeks: { attribute: 'css-weeks' },\r\n    cssMonth: { attribute: 'css-month' },\r\n    cssYear: { attribute: 'css-year' },\r\n    cssNav: { attribute: 'css-nav' },\r\n    cssHeader: { attribute: 'css-header' },\r\n    cssSelected: { attribute: 'css-selected' },\r\n  }\r\n\r\n  #date;\r\n  #selected;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.#date = new GSDate();\r\n    me.#date.day = 1;\r\n    me.#selected = new GSDate();\r\n    me.#date.language = GSUtil.language;\r\n    me.#selected.language = GSUtil.language;\r\n    \r\n    me.language = GSUtil.language;\r\n    me.day = me.#selected.day;\r\n    me.month = me.#selected.month;\r\n    me.year = me.#selected.year;\r\n    \r\n    me.editable = false;\r\n    me.range = 5;\r\n    me.minYear = 1900;\r\n    me.maxYear = 2100;\r\n    me.arrowPrev = '&#10094;';\r\n    me.arrowNext = '&#10095;';\r\n    me.cssNav = 'btn-light';\r\n    me.cssToday = 'btn-secondary';\r\n    me.cssSelected = 'btn-primary';\r\n    me.cssWeeks = 'fw-bold text-bg-dark';\r\n    me.cssYear = 'form-control fs-5 fw-bold border-0 text-center m-1 p-0';\r\n    me.cssMonth = 'form-control fs-3 fw-bold border-0 text-center m-1 p-0';\r\n  }\r\n\r\n  get date() {\r\n    const me = this;\r\n    //return this.#date.toISOString();\r\n    return new Proxy(this.#date, {\r\n      set(target, prop, value) {\r\n        if (typeof target[prop] != 'function') {\r\n          target[prop] = value;\r\n          me.#update();\r\n        }\r\n        return true;\r\n      },\r\n      get(target, prop, receiver) {\r\n        const value = target[prop];\r\n        if (value instanceof Function) {\r\n          return function (...args) {\r\n            try {\r\n              return value.apply(this === receiver ? target : this, args);\r\n            } finally {\r\n              me.#update();\r\n            }\r\n          };\r\n        }\r\n        return value;\r\n      }\r\n    });\r\n  }\r\n\r\n  previousMonth() {\r\n    const me = this;\r\n    if (me.month == 0) {\r\n      me.month = 11;\r\n      me.year--;\r\n    } else {\r\n      me.month--;\r\n    }\r\n  }\r\n\r\n  nextMonth() {\r\n    const me = this;\r\n    if (me.month == 11) {\r\n      me.month = 0;\r\n      me.year++;\r\n    } else {\r\n      me.month++;\r\n    }\r\n  }\r\n\r\n  previousYear() {\r\n    this.year--;\r\n  }\r\n\r\n  nextYear() {\r\n    this.year++;\r\n  }\r\n\r\n  formatted(date) {\r\n    const me = this;\r\n    return (date || me.#date).format(me.format, me.language);\r\n  }\r\n\r\n  updated() {\r\n    const me = this;\r\n    const date = new GSDate(me.#date);\r\n    me.#updateTarget(date);\r\n    me.emit('date', { type: 'calendar', date: date, val: me.formatted(date) }, true, true);\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    me.#date.day = 1;\r\n    me.#date.month = me.month;\r\n    me.#date.year = me.year;\r\n    me.#date.day = me.day;\r\n    me.#date.language = me.language;\r\n\r\n    const week = GSDate.dayList(true, me.language).map(v => html`<div class=\"col\">${v}</div>`);\r\n    const months = me.#monthsHTML();\r\n    const year = me.#yearHTML();\r\n\r\n    return html`\r\n          <div class=\"container-fluid text-center ${classMap(me.renderClass())}\"\r\n          dir=\"${ifDefined(me.direction)}\"\r\n          @keydown=\"${me.#onKey}\"\r\n          @click=\"${me.#onDay}\">\r\n          <div class=\"row align-items-center ${me.cssHeader} header\">\r\n              <div class=\"col-auto\">\r\n                  <a href=\"#\" @click=\"${me.previousMonth}\" class=\"btn ${me.cssNav} arrow prev\">${unsafeHTML(me.arrowPrev)}</a>\r\n              </div>\r\n              <div class=\"col\"></div>\r\n              <div class=\"col-auto\">\r\n                  ${months}\r\n                  ${year}\r\n              </div>\r\n              <div class=\"col\"></div>\r\n              <div class=\"col-auto\">\r\n                  <a href=\"#\" @click=\"${me.nextMonth}\" class=\"btn ${me.cssNav} arrow next\">${unsafeHTML(me.arrowNext)}</a>\r\n              </div>\r\n          </div>\r\n          <div class=\"row weeks ${me.cssWeeks}\">${week}</div>\r\n          ${unsafeHTML(me.#daysHTML())}\r\n      </div>`;\r\n  }\r\n\r\n  #updateTarget(date) {\r\n    const me = this;\r\n    if (!me.target) return;\r\n    const tgt = GSDOM.query(document.documentElement, me.target);\r\n    if (!tgt) return;\r\n\r\n    if (tgt instanceof HTMLInputElement) {\r\n      if (tgt.type === 'date') return tgt.valueAsDate = date;\r\n      return tgt.value = me.formatted(date);\r\n    }\r\n    GSDOM.setHTML(tgt, me.formatted(date));\r\n  }\r\n\r\n  #update() {\r\n    const me = this;\r\n    me.#selected.day = 1;\r\n    me.#selected.month = me.#date.month;\r\n    me.#selected.year = me.#date.year;\r\n    me.#selected.day = me.#date.day;\r\n    me.#selected.language = me.#date.language;\r\n\r\n    me.day = me.#date.day;\r\n    me.month = me.#date.month;\r\n    me.year = me.#date.year;\r\n    me.language = me.#date.language;\r\n  }\r\n\r\n  #isToday(v, date) {\r\n    const me = this;\r\n    return v && GSUtil.asNum(v) === date.day && date.month === me.#date.month && me.#date.year === date.year;\r\n  }\r\n\r\n  #daysHTML() {\r\n    const me = this;\r\n    const today = new GSDate();\r\n    today.language = me.language;\r\n    const list = me.#date.build(me.language);\r\n    const result = list\r\n      .map(v => {\r\n        const c1 = me.#isToday(v, today) ? me.cssToday : '';\r\n        const c2 = me.#isToday(v, me.#selected) ? me.cssSelected : '';\r\n\r\n        const d = v ? `<a tabindex=\"0\" href=\"#\" class=\"btn shadow-none ${c2} ${c1} day\" data-day=\"${v}\">${v}</a>` : ''\r\n        return `<div class=\"col p-0\">${d}</div>`;\r\n      })\r\n      .map((v, i) => {\r\n        if (i === 0) return `<div class=\"row days\">${v}`;\r\n        const isBreak = i % 7 == 0;\r\n        return isBreak ? `</div><div class=\"row days\">${v}` : v;\r\n      });\r\n    result.push('</div>');\r\n    return result.join('');\r\n  }\r\n\r\n  #monthsHTML() {\r\n    const me = this;\r\n    const current = me.#date.MMMM;\r\n    const months = GSDate.monthList(false, me.language);\r\n    const list = months.map((v, i) => html`<option value=\"${i}\" selected=${ifDefined(current == v ? true : undefined)}>${v}</option>`);\r\n    return html`<select @change=\"${me.#onMonth}\" name=\"month\" class=\"month ${me.cssMonth}\" value=\"${months.indexOf(current)}\">${list}</select>`;\r\n  }\r\n\r\n  #yearHTML() {\r\n\r\n    const me = this;\r\n\r\n    const options = [];\r\n    let minYear = me.minYear;\r\n    let maxYear = me.maxYear;\r\n\r\n    if (me.range > 0) {\r\n      const year = new GSDate().year;\r\n      minYear = year - me.range;\r\n      maxYear = year + me.range;\r\n      me.#optionsHTML(options, minYear, maxYear);\r\n    }\r\n\r\n    if (!me.editable) {\r\n      return html`<select @change=\"${me.#onYear}\" name=\"year\" class=\"year ${me.cssYear}\" data-gs-min=\"${minYear}\" data-gs-max=\"${maxYear}\">${options}</select>`;\r\n    }\r\n\r\n    const isList = me.editable && me.range && options.length > 0;\r\n    const listID = isList ? GSID.next : null;\r\n    const list = isList ? html`<datalist id=\"${listID}\">${options}</datalist>` : '';\r\n\r\n    return html`<input name=\"year\" \r\n      type=\"number\" \r\n      list=\"${ifDefined(listID)}\"\r\n      class=\"year ${me.cssYear}\" \r\n      @change=\"${me.#onYear}\" \r\n      min=\"${minYear}\" \r\n      max=\"${maxYear}\"\r\n      value=\"${me.#date.getFullYear()}\">\r\n      ${list}`;\r\n  }\r\n\r\n  #optionsHTML(options, minYear = 0, maxYear = 0) {\r\n    const me = this;\r\n    let val = minYear;\r\n    while (val <= maxYear) {\r\n      if (me.editable) {\r\n        options.push(html`<option value=\"${val}\" selected=${ifDefined(val == me.year ? true : undefined)}>`);\r\n      } else {\r\n        options.push(html`<option value=\"${val}\" selected=${ifDefined(val == me.year ? true : undefined)}>${val}</option>`);\r\n      }\r\n      val++;\r\n    }\r\n\r\n    return options;\r\n  }\r\n\r\n  #onDay(e) {\r\n    GSEvents.prevent(e);\r\n    if (!e.target.classList.contains('day')) return;\r\n    const me = this;\r\n    const day = GSUtil.asNum(e.target.dataset.day, me.day);\r\n\r\n    me.#selected.day = 1;\r\n    me.#selected.month = me.month;\r\n    me.#selected.year = me.year;\r\n    me.#selected.day = day;\r\n\r\n    me.day = day;\r\n  }\r\n\r\n  #onMonth(e) {\r\n    this.month = e.target.selectedIndex;\r\n  }\r\n\r\n  #onYear(e) {\r\n    const yearEl = e?.target;\r\n    if (yearEl?.validity.valid) {\r\n      this.year = yearEl.value;\r\n    }\r\n  }\r\n\r\n  #onKey(e) {\r\n    // console.log(e);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-calendar');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, css, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { placement, PlacementTypes } from '../properties/placement.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\nexport class GSCardElement extends GSElement {\r\n\r\n  static styles = css`.card-header, .card-footer{ background-color: inherit; color: inherit;}`;\r\n\r\n  static properties = {\r\n\r\n    imageStyle: { type: Object, attribute: 'image-style', reflect : true },\r\n\r\n    overlay: { type: Boolean },\r\n    placement: { ...placement },\r\n    align: { ...placement },\r\n\r\n    image: {},\r\n    title: {},\r\n    subtitle: {},\r\n    text: {},\r\n    footer: {},\r\n    header: {},\r\n\r\n    colorText: { attribute: 'color-text' },\r\n    colorBack: { attribute: 'color-back' },\r\n    colorBorder: { attribute: 'color-border' },\r\n\r\n    cssTitle: { attribute: 'css-title' },\r\n    cssSubtitle: { attribute: 'css-subtitle' },\r\n    cssText: { attribute: 'css-text' },\r\n    cssFooter: { attribute: 'css-footer' },\r\n    cssHeader: { attribute: 'css-header' },\r\n    cssBody: { attribute: 'css-body' },\r\n    cssImage: { attribute: 'css-image' },\r\n\r\n  }\r\n\r\n  #styleID = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    this.border = false;\r\n    this.shadow = false;\r\n    this.align = 'start';\r\n    this.placement = 'top';\r\n    this.imageStyle = this.imageStyle || {};\r\n    this.dynamicStyle(this.#styleID);\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const content =  me.isVertical ? me.#renderVertical() : me.#renderHorizontal();\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\" class=\"card ${classMap(me.renderClass())}\">${content}</div>`;\r\n  }\r\n\r\n  #renderVertical() {\r\n    const me = this;\r\n    return [me.#imageTop, me.#header, me.#body, me.#footer, me.#imageBottom];\r\n  }\r\n\r\n  #renderHorizontal() {\r\n    const me = this;\r\n    const start = PlacementTypes.isBefore(me.placement);\r\n    const startClass = start ? 'col-4' : 'col-8';\r\n    const endClass = start ? 'col-8' : 'col-4';\r\n    const startHtml = start ? me.#images : me.#body;\r\n    const endHtml =  start ? me.#body : me.#images;\r\n    return html`<div class=\"row g-0\">\r\n        <div class=\"${startClass}\">\r\n            ${startHtml}\r\n        </div>\r\n        <div class=\"${endClass}\">\r\n          ${endHtml}\r\n        </div>\r\n      </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      border: me.border || me.colorBorder,\r\n      [`text-${me.align}`]: me.align,\r\n      [`text-${me.colorText}`]: me.colorText,\r\n      [`bg-${me.colorBack}`]: me.colorBack,\r\n      [`border-${me.colorBorder}`]: me.colorBorder,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  get isVertical() {\r\n    return PlacementTypes.isVertical(this.placement);\r\n  }\r\n\r\n  get isHorizontal() {\r\n    return PlacementTypes.isHorizontal(this.placement);\r\n  }\r\n\r\n  get #body() {\r\n    const me = this;\r\n    return html`<div class=\"${me.overlay ? 'card-img-overlay' : 'card-body'} ${me.cssBody}\">\r\n      <h5 class=\"card-title  ${me.cssTitle}\"><slot name=\"title\">${me.translate(me.title)}</slot></h5>\r\n      <h6 class=\"card-subtitle  ${me.cssSubtitle}\"><slot name=\"subtitle\">${me.translate(me.subtitle)}</slot></h6>\r\n      <p class=\"card-text ${me.cssText}\"><slot name=\"text\">${me.translate(me.text)}</slot></p>\r\n      <slot name=\"body\"></slot>\r\n    </div>    \r\n    `;\r\n  }\r\n\r\n  get #header() {\r\n    return this.overlay ? '' : html`<div class=\"card-header  ${this.cssHeader}\"><slot name=\"header\">${this.header}</slot></div>`;\r\n  }\r\n\r\n  get #footer() {\r\n    return this.overlay ? '' : html`<div class=\"card-footer ${this.cssFooter}\"><slot name=\"footer\">${this.footer}</slot></div>`;\r\n  }\r\n\r\n  get #imageSlot() {\r\n    return html`<slot name=\"image\"></slot>`;\r\n  }\r\n\r\n  get #image() {\r\n    const me = this;\r\n    const css = me.isHorizontal ? 'img-fluid' : 'card-img';\r\n    me.dynamicStyle(me.#styleID, me.imageStyle);\r\n    return html`<img src=\"${me.image}\" class=\"rounded-${me.placement} ${css} ${me.cssImage} ${me.#styleID}\" alt=\"...\">`;\r\n  }\r\n\r\n  get #images() {\r\n    return this.image ? this.#image : this.#imageSlot;\r\n  }\r\n\r\n  get #imageTop() {\r\n    return this.placement === 'top' ? this.#images : '';\r\n  }\r\n\r\n  get #imageBottom() {\r\n    return this.placement === 'bottom' ? this.#images : '';\r\n  }\r\n\r\n  static {\r\n    this.define('gs-card');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSCenterElement extends GSElement {\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\"\r\n      class=\"position-absolute top-50 start-50 translate-middle ${classMap(me.renderClass())}\">\r\n    ${me.renderTemplate()}<slot></slot></div>`;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-center');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSMenuElement class\r\n * @module components/GSMenuElement\r\n */\r\n\r\nimport { classMap, ifDefined, html, ref, createRef } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { dataset } from '../directives/dataset.mjs';\r\nimport { GroupController } from '../controllers/GroupController.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\n/**\r\n * Renderer for panel layout \r\n * @class\r\n * @extends {Component}\r\n */\r\nexport class GSMenuElement extends GSElement {\r\n\r\n    static properties = {\r\n        storage: {},\r\n        auto: { type: Boolean, reflect: true },\r\n        opened: { type: Boolean, reflect: true },\r\n        dark: { type: Boolean },\r\n        reverse: { type: Boolean },\r\n        offset: { type: Number },\r\n        data: { type: Array },\r\n    }\r\n\r\n    // GS-ITEM attributes mapping\r\n    static options = {\r\n        name: {},\r\n        title: {},\r\n        header: {},\r\n        color: {},\r\n        icon: {},\r\n        url: { default: '#' }\r\n    }\r\n\r\n    #menuRef = createRef();\r\n    #styleID = GSID.id;\r\n    #controller = null;\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;\r\n        me.offset = 0;\r\n        me.dynamicStyle(me.#styleID);\r\n        me.data = me.#proxify(me);\r\n        me.#controller = new GroupController(this);\r\n    }\r\n\r\n    onBusEvent(e) {\r\n       if (e.detail.owner != this) {\r\n            this.opened = false;\r\n       }\r\n     }\r\n\r\n    willUpdate(changed) {\r\n        super.willUpdate(changed);\r\n        if (changed.has('opened') && !this.opened) {\r\n            this.#closeSubmenus();\r\n        }\r\n    }\r\n\r\n    updated() {\r\n        this.#updatePosition();\r\n        if (this.opened) {\r\n            this.#controller.notify();\r\n        }\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<ul \r\n            ${ref(me.#menuRef)}\r\n            dir=\"${ifDefined(me.direction)}\"\r\n            class=\"dropdown-menu ${classMap(me.renderClass())}\"\r\n            data-gs-class=\"${me.#styleID}\"\r\n            data-menu=\"true\"\r\n            @mouseover=\"${me.#onMouseOver}\"\r\n            @mouseleave=\"${me.#onMouseLeave}\"\r\n            @keydown=\"${me.#onKeyDown}\"\r\n            @click=\"${me.#onClick}\">\r\n            ${me.#items(me.data)}\r\n        </ul>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            'submenu': me.dataset.submenu,\r\n            'dropdown-menu-dark': me.dark,\r\n            [me.#styleID]: true,\r\n            'show': me.opened,\r\n            'dropend': !me.reverse,\r\n            'dropstart': me.reverse,\r\n        }\r\n        return css;\r\n    }\r\n\r\n    close() {\r\n        this.opened = false;\r\n    }\r\n\r\n    open() {\r\n        this.opened = true;\r\n    }\r\n\r\n    toggle() {\r\n        this.opened = !this.opened;\r\n    }\r\n\r\n    /**\r\n     * Show at x/y position on the screen\r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @param {HTMLElement} caller\r\n     * @returns {void}\r\n     */\r\n    popup(x = 0, y = 0, caller) {\r\n\r\n        const me = this;\r\n        // offset to render under the mouse,\r\n        // important for GSGrid for better UI experience\r\n        const offset = GSUtil.asNum(me.offset, 0);\r\n        let target = caller;\r\n\r\n        if (GSEvents.isMouseOrPointerEvent(x)) {\r\n            const e = x;\r\n            target = e.target;\r\n            y = e.clientY;\r\n            x = e.clientX;\r\n            let offset = GSDOM.offsetParent(me);\r\n            offset = offset ? offset.getBoundingClientRect() : null;\r\n            x = x - (offset?.left || 0);\r\n            y = y - (offset?.top || 0);\r\n        }\r\n\r\n        const cfg = { clientX: x - offset, clientY: y - offset, target: target };\r\n\r\n        requestAnimationFrame(() => {\r\n            const style = {\r\n                position: 'fixed',\r\n                top: '0px',\r\n                left: '0px',\r\n                translate: `${cfg.clientX}px ${cfg.clientY}px`\r\n            };\r\n            const rule = me.dynamicStyle(me.#styleID);\r\n            Object.assign(rule.style, style);\r\n        });\r\n        me.open();\r\n\r\n    }\r\n\r\n    onDataRead(data) {\r\n        this.data = data;\r\n    }\r\n\r\n    #items(root) {\r\n        const me = this;\r\n        return root.map(el => me.#item(el));\r\n    }\r\n\r\n    #item(el) {\r\n        const me = this;\r\n        const isSub = el.items?.length > 0;\r\n        if (isSub) return me.#renderSubmenu(el);\r\n        if (!(el.header || el.name)) return me.#renderDivider();\r\n        return el.header ? me.#renderHeader(el) : me.#renderMenu(el);\r\n    }\r\n\r\n    #renderHeader(el) {\r\n        return html`<li data-inert=\"true\"><h6 class=\"dropdown-header\">${this.#renderIcon(el)}${el.header}</h6></li>`;\r\n    }\r\n\r\n    #renderDivider() {\r\n        return html`<li data-inert=\"true\"><hr class=\"dropdown-divider\"></li>`;\r\n    }\r\n\r\n    #renderSubmenu(el) {\r\n        const me = this;\r\n        return html`<li>\r\n            <a class=\"dropdown-item dropdown-toggle\" data-toggle=\"true\" href=\"#\">\r\n                <div class=\"d-inline-block w-100\">${me.#renderIcon(el)}${el.name}</div>\r\n            </a>\r\n            <gs-menu auto \r\n                .data=${el.items} \r\n                ?dark=${me.dark} \r\n                ?reverse=\"${me.reverse}\" \r\n                language=\"${ifDefined(me.language)}\" \r\n                data-submenu=\"true\">\r\n            </gs-menu>\r\n        </li>`;\r\n    }\r\n\r\n    #renderIcon(el) {\r\n        return el.icon ? html`<gs-icon css=\"mx-1\" name=\"${el.icon}\"></gs-icon>` : '';\r\n    }\r\n\r\n    #renderMenu(el) {\r\n        return html`<li>\r\n                <gs-button css=\"dropdown-item shadow-none\" \r\n                    ${dataset(el, false)}\r\n                    url=\"${el.url}\"\r\n                    title=\"${el.name}\" \r\n                    language=\"${ifDefined(this.language)}\" \r\n                    icon=\"${ifDefined(el.icon)}\" \r\n                    text=\"${ifDefined(el.color)}\"\r\n                    data-gs-target=\"${ifDefined(el.target || 'self')}\"\r\n                    data-gs-action=\"${ifDefined(el.action)}\">\r\n                </gs-button></li>`;\r\n    }\r\n\r\n    /**\r\n     * Proxify GS-ITEM elements to easily read attributes\r\n     */\r\n    #proxify(root) {\r\n        return GSItem.collect(root).map(el => GSAttr.proxify(el, GSMenuElement.options));\r\n    }\r\n\r\n    #closeSubmenus(menu) {\r\n        GSDOM.queryAll(this.renderRoot, 'gs-menu', false, false)\r\n            .filter(el => el != menu)\r\n            .forEach(el => el.close());\r\n    }\r\n\r\n    #onKeyDown(e) {\r\n        const me = this;\r\n        switch (e.key) {\r\n            case 'Escape':\r\n                me.close();\r\n                break;\r\n        }\r\n    }\r\n\r\n    #onClick(e) {\r\n        GSEvents.prevent(e);\r\n        const me = this;\r\n        const submenu = me.#toSubmenu(e);\r\n        submenu?.close();\r\n        if (me.auto) me.close();\r\n    }\r\n\r\n    #onMouseLeave(e) {\r\n        GSEvents.prevent(e);\r\n        if (this.auto) this.close();\r\n    }\r\n\r\n    #onMouseOver(e) {\r\n        GSEvents.prevent(e);\r\n        const me = this;\r\n        const submenu = me.#toSubmenu(e);\r\n        me.#closeSubmenus(submenu);\r\n        submenu?.open();\r\n    }\r\n\r\n    #toSubmenu(e) {\r\n        const menuItem = e.target.closest('li');\r\n        return menuItem?.querySelector('gs-menu');\r\n    }\r\n\r\n    #updatePosition() {\r\n        const me = this;\r\n        if (!me.opened) return;\r\n        const rule = me.dynamicStyle(me.#styleID);\r\n        if (me.isSubmenu) {\r\n            const opt = { translate: `0px -25px` };\r\n            if (me.reverse) {\r\n                opt.left = 'inherited';\r\n                opt.right = '100%';\r\n            } else {\r\n                opt.right = 'inherited';\r\n                opt.left = '100%';\r\n            }\r\n            Object.assign(rule.style, opt);\r\n        } else {\r\n            rule.style.translate = null;\r\n            const rect = me.#menu.getBoundingClientRect();\r\n            const offset = window.innerWidth - rect.right;\r\n            me.reverse = offset - 5 < 0;\r\n            if (me.reverse) rule.style.translate = `${offset - 2}px`;\r\n        }\r\n    }\r\n\r\n    get isSubmenu() {\r\n        return this.dataset.submenu;\r\n    }\r\n\r\n    get #menu() {\r\n        return this.#menuRef.value;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-menu');\r\n    }\r\n}\r\n","/*GSContextElement\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSContextElement class\r\n * @module components/GSContextElement\r\n */\r\n\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSMenuElement } from './Menu.mjs';\r\n\r\n/**\r\n * Renderer for context menu\r\n * @class\r\n * @extends {GSMenuElement}\r\n */\r\nexport class GSContextElement extends GSMenuElement {\r\n\r\n    static properties = {\r\n        target: {},\r\n        filter: {},\r\n        altContext: { type: Boolean, attribute: 'altcontext' },\r\n        disabled: { type: Boolean },\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;        \r\n        me.auto = true;\r\n        if (me.#isInTable) {\r\n            me.slot = \"extra\";\r\n            me.target = \"tbody\";\r\n            me.filter = \"[selected]\";\r\n            me.offset =\"4\";\r\n        }\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        const me = this;\r\n        me.attachEvent(window, 'resize', me.close.bind(me));        \r\n        if (!me.slot) me.#attachTarget();\r\n    }\r\n    \r\n    onSlotInjected(slot) {\r\n        this.#attachTarget();\r\n    }\r\n\r\n    #attachTarget() {\r\n        const me = this;        \r\n        const owner = GSDOM.parent(me.assignedSlot || me);\r\n        let targets = me.target ? GSDOM.queryAll(owner, me.target) : [owner];\r\n        if (!targets.length) targets = GSDOM.queryAll(document.documentElement, me.target);\r\n        targets.forEach(target => me.attachEvent(target, 'contextmenu', me.#onPopup.bind(me)));\r\n    }\r\n\r\n    #match(e) {\r\n        const me = this;\r\n        return e.composedPath().filter(el => el.matches)\r\n            .filter(el => el.matches(me.filter ? me.filter : me.target));\r\n    }\r\n\r\n    #onPopup(e) {\r\n        const me = this;\r\n        if (e.shiftKey && me.altContext) return;\r\n        const list = me.#match(e);\r\n        if (list.length === 0) return;\r\n        GSEvents.prevent(e);\r\n        me.popup(e);\r\n        return true;\r\n    }\r\n\r\n    get #isInTable() {\r\n        return this.parentComponent?.tagName === 'GS-TABLE';\r\n    }\r\n\r\n    /**\r\n     * Show submenu at x/y position on the screen\r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @returns {void}\r\n     */\r\n    popup(x = 0, y = 0, caller) {\r\n        return this.disabled ? false : super.popup(x, y, caller);\r\n    }\r\n\r\n    static {\r\n        this.define('gs-context');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, css, html, ifDefined, ref } from '../lib.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color, notEmpty } from '../properties/index.mjs';\r\nimport { ElementMoveController } from '../controllers/ElementMoveController.mjs';\r\n\r\nexport class GSCompareElement extends GSElement {\r\n\r\n  static styles = css`.slider {\r\n         --gs-position : 50%;\r\n          left : var(--gs-position);\r\n          width: 8px;\r\n          height: 100%;\r\n          border-width: 1px;\r\n          cursor: w-resize;\r\n          border-color: darkgray;\r\n          border-style: solid;\r\n          background-color: lightgray;\r\n      }\r\n      .clipper {\r\n        --gs-position : 50%;\r\n        clip-path: inset(0px var(--gs-position) 0px 0px);\r\n      }\r\n    `;\r\n\r\n  static properties = {\r\n    background: { ...color },\r\n    width: { type: Number },\r\n    height: { type: Number },\r\n    before: { hasChanged: notEmpty },\r\n    after: { hasChanged: notEmpty },\r\n  }\r\n\r\n  #styleID = GSID.id;\r\n\r\n  #elRef = createRef();\r\n  #clipRef = createRef();\r\n  #slideRef = createRef();\r\n\r\n  #mouseController;\r\n  #elPosition;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.width = 0;\r\n    me.height = 0;\r\n    me.dynamicStyle(me.#styleID);\r\n    me.#mouseController = new ElementMoveController(me);\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    this.#mouseController.attach(this.#splitter);\r\n    super.firstUpdated(changed);\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    const me = this;\r\n    const dynamic = me.#dynamic;\r\n    dynamic.width = me.width > 0 ? `${me.width}px` : '';\r\n    dynamic.height = me.height > 0 ? `${me.height}px` : '';\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div ${ref(me.#elRef)} \r\n         dir=\"${ifDefined(me.direction)}\"\r\n         @loaded=\"${me.#onLoad}\" \r\n         @dblclick=\"${me.#onDoubleClick}\"\r\n         data-gs-class=\"${me.#styleID}\"\r\n         class=\"${classMap(me.renderClass())}\">\r\n      <div class=\"overflow-hidden position-absolute top-0 start-0 overflow-hidden\"><slot name=\"before\">${me.#before}</slot></div>\r\n      <div ${ref(me.#clipRef)} class=\"overflow-hidden position-absolute top-0 start-0 overflow-hidden clipper\"><slot name=\"after\">${me.#after}</slot></div>\r\n      <div ${ref(me.#slideRef)} class=\"slider position-absolute top-0><slot name=\"control\"></slot></div>\r\n    </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      \"position-relative\": true,\r\n      \"user-select-none\": true,\r\n      \"d-contents\": me.isAuto,\r\n      \"h-100\": me.isAuto,\r\n      \"w-100\": me.isAuto,\r\n      \"overflow-hidden\": true,\r\n      [`bg-${me.background}`]: me.background,\r\n      [`${me.#styleID}`]: true\r\n    }\r\n    return css;\r\n  }\r\n\r\n  /**\r\n   * Handles resizing based on mouse move event\r\n   * @param {MouseEvent} e \r\n   */\r\n  onStartMove(e) {\r\n    this.#elPosition = this.#splitter.getBoundingClientRect();\r\n  }\r\n\r\n  onMouseMove(e) {\r\n    const me = this;\r\n    const offset = me.#elPosition.left;\r\n    const width = me.#elPosition.width;\r\n    const pos = GSUtil.range(e.clientX - offset, 0, width);\r\n    const pct = (pos / width) * 100;\r\n    me.#update(pct);\r\n  }\r\n\r\n  get isAuto() {\r\n    return this.width == 0 || this.height == 0;\r\n  }\r\n\r\n  get isFixed() {\r\n    return !this.isAuto;\r\n  }\r\n\r\n  get #dynamic() {\r\n    return this.dynamicStyle(this.#styleID).style;\r\n  }\r\n\r\n  get #before() {\r\n    return this.before ? html`<img @load=\"${this.#onLoad}\" src=\"${me.before}\"></img>` : '';\r\n  }\r\n\r\n  get #after() {\r\n    return this.after ? html`<img @load=\"${this.#onLoad}\" src=\"${me.after}\"></img>` : '';\r\n  }\r\n\r\n  get #isAuto() {\r\n    return this.width === 0 || this.height === 0;\r\n  }\r\n\r\n  get #splitter() {\r\n    return this.#elRef.value;\r\n  }\r\n\r\n  get #slider() {\r\n    return this.#slideRef.value;\r\n  }\r\n\r\n  get #clip() {\r\n    return this.#clipRef.value;\r\n  }\r\n\r\n  #onLoad(e) {\r\n    const me = this;\r\n    if (me.#isAuto) {\r\n      const el = e.target;\r\n      me.height = me.height || el.height;\r\n      me.width = me.width || el.width;\r\n    }\r\n  }\r\n\r\n  #onDoubleClick(e) {\r\n    const me = this;\r\n    me.prevent(e);\r\n    me.#update();\r\n    me.#mouseController.reset();\r\n  }\r\n\r\n  #update(pct = 50) {\r\n    const me = this;\r\n    me.#clip.style.setProperty('--gs-position', `${100 - pct}%`);\r\n    me.#slider.style.setProperty('--gs-position', `${pct}%`);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-compare');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\n\r\n/**\r\n * Helper component to enable controller attachment to the GS WebComponent.\r\n * It is used to simplify and separate templates from logic.\r\n */\r\nexport class GSControllerElement extends GSElement {\r\n\r\n  static properties = {\r\n    module: {},\r\n    controller: {},\r\n  }\r\n\r\n  #clazz = false;\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  updated(changes) {\r\n    super.updated(changes);\r\n    const me = this;\r\n    if (me.isConnected && me.isValid) {\r\n      me.#initialize();\r\n    }\r\n  }\r\n\r\n  get isValid() {\r\n    return this.parentElement instanceof GSElement;\r\n  }\r\n\r\n  async #initialize() {\r\n\r\n    const me = this;\r\n    const host = me.parentElement;\r\n\r\n    if (me.#clazz) return;\r\n\r\n    let clazz = globalThis[me.controller];\r\n    if (!clazz && me.module) {\r\n      const url = GSLoader.normalizeURL(me.module);\r\n      const module = await import(url);\r\n      clazz = module[me.controller];\r\n    }\r\n\r\n    if (clazz) {\r\n      new clazz(host);\r\n      me.#clazz = clazz;\r\n      globalThis[me.controller] = clazz;\r\n    }\r\n\r\n  }\r\n\r\n  static {\r\n    this.define('gs-controller');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\nexport class GSCopyrightElement extends GSElement {\r\n\r\n  static properties = {\r\n    year: { reflect: true, type: Number },\r\n    company: { reflect: true },\r\n    url: { reflect: true },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.flat = true;\r\n    this.css = 'fixed-bottom d-flex justify-content-center align-items-center mt-1 p-2 text-muted';\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    if (!(me.isCompany && me.isYear)) return '';\r\n    const year = new Date().getFullYear();\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\" class=\"${classMap(me.renderClass())}\"><a target=\"_blank\" href=\"${me.url ? me.url : '#'}\"><small>&copy; ${me.company} ${me.year}. - ${year}.</small></a></div>`;\r\n  }\r\n\r\n  get isCompany() {\r\n    return GSUtil.isStringNonEmpty(this.company);\r\n  }\r\n\r\n  get isYear() {\r\n    return GSUtil.isStringNonEmpty(this.year);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-copyright');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSLog } from '../base/GSLog.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSFunction } from '../base/GSFunction.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { numGT0 } from '../properties/verificator.mjs';\r\nimport { GSReadWriteRegistry } from '../data/ReadWriteRegistry.mjs';\r\nimport { GSData } from '../base/GSData.mjs';\r\n\r\n/**\r\n * A module loading GSDataHandler class\r\n * @module components/GSDataHandler\r\n */\r\n\r\n/**\r\n * GUI element for easier access to the GSReadWrite/GSTreeReader\r\n * @class\r\n * @extends {GSElement}\r\n */\r\nexport class GSDataHandler extends GSElement {\r\n\r\n    static properties = {\r\n        storage: { state: true },\r\n        src: { reflect: true },\r\n        action: { reflect: true },\r\n        mode: { reflect: true },\r\n        reader: { reflect: true },\r\n        writer: { reflect: true },\r\n        limit: { type: Number, reflect: true },\r\n        skip: { type: Number, reflect: true },\r\n        filter: { type: Array, reflect: true },\r\n        sort: { type: Array, reflect: true },\r\n        type: {},\r\n        autoload: { type: Boolean },\r\n        autorefresh: { type: Number, reflect: true, hasChanged: numGT0 },\r\n    }\r\n\r\n    #iid = 0;\r\n    #config = null;\r\n    #handler = null;\r\n    #lifoReadRef = null;\r\n    #lifoWriteRef = null;\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;\r\n        me.storage = me.storage || me.id;\r\n        me.autorefresh = 0;\r\n        me.autoload = false;\r\n        me.flat = true;\r\n        me.filter = [];\r\n        me.sort = [];\r\n        me.limit = 0;\r\n        me.skip = 0;\r\n        me.src = '';\r\n        me.type = 'remote';\r\n        me.mode = 'query';\r\n        me.reader = 'GET';\r\n        me.writer = 'POST';\r\n        if (me.#isInTable) {\r\n            me.slot = \"extra\";\r\n          }\r\n        if (!me.isGenerated && !me.id) throw new Error('Element ID is required attribute!');\r\n        GSItem.validate(me, me.tagName);\r\n    }\r\n    \r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        const me = this;\r\n        me.storage = me.storage || me.id;\r\n        const itemHolder = me.isGenerated && me.childElementCount === 0 ? me.parentComponent : me;\r\n        me.#config = GSItem.proxify(itemHolder, GSData.PROPERTIES);\r\n        me.#initLIFO(true);\r\n        me.#initLIFO(false);\r\n    }\r\n    \r\n    disconnectedCallback() {\r\n        super.disconnectedCallback();\r\n        const me = this;\r\n        me.#handler?.disable();\r\n        me.#handler?.removeProcessor(me);\r\n        me.#lifoReadRef = null;\r\n        me.#lifoWriteRef = null;\r\n        clearTimeout(me.#iid);\r\n    }\r\n    \r\n    firstUpdated() {\r\n        const me = this;\r\n        me.#handler = GSReadWriteRegistry.newHandler(me.type, me.storage, false);\r\n        if (me.#config?.length > 0) me.#handler?.addProcessor(me);\r\n        me.#updateHandler(true);                \r\n    }\r\n\r\n    willUpdate(changed) {\r\n        super.willUpdate(changed);\r\n        const me = this;\r\n        me.#updateHandler();\r\n        if (changed.has('autorefresh')) me.schedule(me.autorefresh);\r\n    }\r\n\r\n    #updateHandler(first = false) {\r\n        const me = this;\r\n        if (!me.#handler) return;\r\n\r\n        me.#handler.src = me.src;\r\n        me.#handler.key = me.key;\r\n        me.#handler.mode = me.mode;\r\n        me.#handler.action = me.action;\r\n        me.#handler.reader = me.reader;\r\n        me.#handler.writer = me.writer;\r\n\r\n        me.#handler.limit = me.limit;\r\n        me.#handler.skip = me.skip;\r\n        me.#handler.sort = me.formatSort(me.sort);\r\n        me.#handler.filter = me.formatFilter(me.filter);\r\n        if (me.autoload) me.read();\r\n        if (first) {\r\n            me.#handler.enable();\r\n            // to prevent double read by this component and table\r\n            if (me.autoload) {\r\n                me.dataController?.read();\r\n            } \r\n        }\r\n    }\r\n\r\n    get isDebug() {\r\n        return this.dataset.gsDebug;\r\n    }\r\n\r\n    get handler() {\r\n        return this.#handler;\r\n    }\r\n\r\n    get isRegistered() {\r\n        return this.#handler?.isRegistered === true;\r\n    }\r\n\r\n    get isOffline() {\r\n        return this.#handler?.isOffline;\r\n    }\r\n\r\n    get isCached() {\r\n        return this.#handler?.type == 'cached';\r\n    }\r\n\r\n    set search(val) {\r\n        if (this.#handler) this.#handler.search = val;\r\n    }\r\n\r\n    get key() {\r\n        return this.#config.filter(o => o.key).map(o => o.name).pop() || null;\r\n    }\r\n\r\n    /**\r\n     * Filter data in format \r\n     * [{name: idx[num] || name[string], value: ''  , op:'eq'}]\r\n     */\r\n    formatFilter(val) {\r\n        val = this.#formated(val);\r\n        return Array.isArray(val) ? val : [];\r\n    }\r\n\r\n    /**\r\n     * Sort data in format\r\n     * [{col: idx[num] || name[string]  , op: -1 | 1 }]\r\n     */\r\n    formatSort(val) {\r\n        val = this.#formated(val);\r\n        let sort = undefined;\r\n        if (typeof val === 'string') {\r\n            sort = [{ col: val }];\r\n        } else if (Array.isArray(val)) {\r\n            sort = val;\r\n        } else if (GSUtil.isNumber(val)) {\r\n            const idx = Math.abs(val);\r\n            sort = new Array(idx);\r\n            sort[idx - 1] = { ord: val };\r\n        }\r\n        return sort || [];\r\n    }\r\n\r\n    schedule(time = 0) {\r\n        const me = this;\r\n        time = GSUtil.asNum(time) * 1000;\r\n        clearInterval(me.#iid);\r\n        if (time > 0) me.#iid = setInterval(() => {\r\n            me.read(me);\r\n        }, time);\r\n    }\r\n\r\n    read() {\r\n        return this.#lifoReadRef();\r\n    }\r\n\r\n    write(data, append = false) {\r\n        return this.#lifoWriteRef(data, append);\r\n    }\r\n\r\n    load() {\r\n        return this.read();\r\n    }\r\n\r\n    save(data) {\r\n        return this.write(data);\r\n    }\r\n\r\n    /**\r\n     * Return list of all selected record id's\r\n     */\r\n    get selected() {\r\n        return this.#handler?.selected;\r\n    }\r\n\r\n    /**\r\n     * Store selected record ID\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    addSelected(val) {\r\n        return this.#handler?.addSelected(val);\r\n    }\r\n\r\n    /**\r\n     * Remove selected record ID\r\n     * @param {*} val \r\n     */\r\n    removeSelected(val) {\r\n        return this.#handler?.removeSelected(val);\r\n    }\r\n\r\n    /**\r\n     * Remove all selections\r\n     */\r\n    clearSelected(data) {\r\n        return this.#handler?.clearSelected();\r\n    }\r\n\r\n    /**\r\n     * Callback for data read result\r\n     */\r\n    onDataRead(obj) {\r\n        if (this.isDebug) GSLog.log(this, 'Data Read: ' + JSON.stringify(obj));\r\n    }\r\n\r\n    /**\r\n     * Callback for data write result\r\n     * @param {*} obj \r\n     */\r\n    onDataWrite(obj) {\r\n        if (this.isDebug) GSLog.log(this, 'Data write: ' + JSON.stringify(obj));\r\n    }\r\n\r\n    /**\r\n     * Process data after receive, before notifying \r\n     * @param {*} data \r\n     */\r\n    postRead(data) {\r\n        const me = this;\r\n        if (!Array.isArray(data)) data = [data];\r\n        data.forEach(r => {\r\n            me.#config.forEach(c => {\r\n                let val = r[c.name];\r\n                if (!GSUtil.isNull(val)) {\r\n                    val = GSData.format(c, val);\r\n                    r[c.name] = val;\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Callback on data red/write error\r\n     * @param {*} obj \r\n     */\r\n    onDataError(obj) {\r\n        if (this.isDebug) GSLog.log(this, 'Data error: ' + JSON.stringify(obj));\r\n    }\r\n\r\n    #verifyHandler() {\r\n        const me = this;\r\n        if (me.isOffline || me.isRegistered) return;\r\n        throw new Error('Data handler not initialized!');\r\n    }\r\n\r\n    #initLIFO(read = true) {\r\n        const me = this;\r\n        if (read) {\r\n            me.#lifoReadRef = GSFunction.callOnceLifo(me.#lifoReadRefCallback, me);\r\n        } else {\r\n            me.#lifoWriteRef = GSFunction.callOnceLifo(me.#lifoWriteRefCallback, me);\r\n        }\r\n    }\r\n\r\n    #lifoReadRefCallback() {\r\n        const me = this;\r\n        me.#initLIFO(true);\r\n        return me.#lifoCall(true);\r\n    }\r\n\r\n    #lifoWriteRefCallback(data, append) {\r\n        const me = this;\r\n        me.#initLIFO(false);\r\n        return me.#lifoCall(false, data, append);\r\n    }\r\n    \r\n    #lifoCall(read = true, data, append) {\r\n        const me = this;\r\n        me.#verifyHandler();        \r\n        if (read) return me.#handler?.read(me);        \r\n        if (!append) me.#handler.clear();\r\n        return me.#handler?.write(me, data);\r\n    }\r\n\r\n    #formated(val) {\r\n        return GSUtil.isJsonString(val) ? JSON.parse(val) : val;\r\n    }\r\n\r\n    get #isInTable() {\r\n        return this.parentComponent?.tagName === 'GS-TABLE';\r\n    }\r\n\r\n    static {\r\n        this.define('gs-data-handler');\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, css, html, ifDefined, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { size, SizeTypes } from '../properties/size.mjs';\r\n\r\nexport class GSDialogElement extends GSElement {\r\n\r\n  static CSS = 'rounded shadow-sm';\r\n  static HEADER_CSS = 'p-3';\r\n  static TITLE_CSS = 'fs-5 fw-bold text-muted';\r\n  static ALIGN = 'end';\r\n  static CANCEL = 'Cancel';\r\n  static CONFIRM = 'Ok';\r\n\r\n  static #STACK = [];\r\n\r\n  static styles = css`dialog{--bs-modal-width: 500px;width:var(--bs-modal-width);outline:none;}dialog::backdrop{backdrop-filter: blur(4px);}`;\r\n\r\n  static properties = {\r\n\r\n    standard: { reflect: true, type: Boolean },\r\n    opened: { reflect: true, type: Boolean },\r\n    cancelable: { reflect: true, type: Boolean },\r\n    closable: { reflect: true, type: Boolean },\r\n    escapable: { reflect: true, type: Boolean },\r\n    disabled: { reflect: true, type: Boolean },\r\n\r\n    size: size,\r\n\r\n    title: { reflect: true },\r\n    message: { reflect: true },\r\n    cancelText: { reflect: true, attribute: 'text-cancel' },\r\n    confirmText: { reflect: true, attribute: 'text-confirm' },\r\n\r\n    minWidth: { reflect: true, type: Number, attribute: 'min-width' },\r\n    buttonAlign: { reflect: true, attribute: 'button-align' },\r\n\r\n    iconCancel: { reflect: true, attribute: 'icon-cancel' },\r\n    iconConfirm: { reflect: true, attribute: 'icon-confirm' },\r\n\r\n    colorCancel: { attribute: 'color-cancel' },\r\n    colorConfirm: { attribute: 'color-confirm' },\r\n\r\n    cssCancel: { attribute: 'css-cancel' },\r\n    cssConfirm: { attribute: 'css-confirm' },\r\n\r\n    cssTitle: { attribute: 'css-title' },\r\n    cssHeader: { attribute: 'css-header' },\r\n    cssFooter: { attribute: 'css-footer' },\r\n    cssBody: { attribute: 'css-body' },\r\n    cssContent: { attribute: 'css-content' },\r\n\r\n  }\r\n\r\n  #pass = false;\r\n  #styleID = GSID.id;\r\n  #dialogRef = createRef();\r\n  #btnConfirmRef = createRef();\r\n  #btnCancelRef = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    const clazz = GSDialogElement;\r\n    me.opened = false;\r\n    me.standard = false;\r\n    me.cancelable = false;\r\n    me.closable = false;\r\n    me.escapable = false;\r\n    me.disabled = false;\r\n    me.shadow = false;\r\n    me.rounded = false;\r\n\r\n    me.minWidth = 0;\r\n    me.css = clazz.CSS;\r\n    me.cssTitle = clazz.TITLE_CSS;\r\n    me.cssHeader = clazz.HEADER_CSS;\r\n    me.buttonAlign = clazz.ALIGN;\r\n    me.cancelText = clazz.CANCEL;\r\n    me.confirmText = clazz.CONFIRM;\r\n    me.colorCancel = 'secondary';\r\n    me.colorConfirm = 'primary';\r\n    me.dynamicStyle(me.#styleID);\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    super.disconnectedCallback();\r\n    GSDialogElement.#updateStack();\r\n  }\r\n\r\n  firstUpdated() {\r\n    super.firstUpdated();\r\n    this.#pass = true;\r\n  }\r\n\r\n  _shouldUpdate(changed) {\r\n    const me = this;\r\n    return me.opened === true || me.#pass;\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    const me = this;\r\n    const allowed = me.opened === true || me.#pass;\r\n    // initially hidden dialogs rendering are posponed\r\n    if (!allowed) {\r\n      GSUtil.timeout(1000).then(() => {\r\n        queueMicrotask(() => { \r\n          const allowed = me.opened === true || me.#pass;\r\n          if (!allowed) {\r\n            me.#pass = true;\r\n            if (me.isConnected) me.requestUpdate();\r\n          }\r\n        });          \r\n      });\r\n    }\r\n    return allowed;\r\n  }\r\n\r\n  updated(changed) {\r\n    super.updated(changed);\r\n    if (changed.has('opened')) {\r\n      this.#onOpenChanged();\r\n    }\r\n  }\r\n\r\n  #onOpenChanged() {\r\n    const me = this;\r\n    let state = null;\r\n    if (me.opened) {\r\n      GSDialogElement.#STACK.push(me);\r\n      state = 'opening';\r\n      if (me.standard) {\r\n        me.#dialog?.open();\r\n      } else {\r\n        me.#dialog?.showModal();\r\n      }\r\n      me.#focusable()?.focus();\r\n    } else {\r\n      state = 'closing';\r\n      if (me.isHashed) location.hash = '';\r\n      GSDialogElement.#STACK.pop();\r\n      me.#dialog?.close();\r\n    }\r\n    me.notify(true, false, state);\r\n  }\r\n\r\n  #renderConfirm() {\r\n    const me = this;\r\n    if (!me.closable) return '';\r\n    return html`<gs-button  ${ref(me.#btnConfirmRef)} \r\n      @click=\"${me.#onConfirm.bind(me)}\" \r\n      icon=\"${ifDefined(me.iconConfirm)}\"\r\n      language=\"${ifDefined(me.language)}\"\r\n      .disabled=\"${me.disabled}\"  \r\n      css=\"${ifDefined(me.cssConfirm)}\" \r\n      color=\"${ifDefined(me.colorConfirm)}\" \r\n      title=\"${me.confirmText}\">\r\n      </gs-button>`;\r\n  }\r\n\r\n  #renderCancel() {\r\n    const me = this;\r\n    if (!me.cancelable) return '';\r\n    return html`<gs-button ${ref(me.#btnCancelRef)}\r\n      @click=\"${me.#onCancel.bind(me)}\" \r\n      icon=\"${ifDefined(me.iconCancel)}\"\r\n      language=\"${ifDefined(me.language)}\"\r\n      css=\"${ifDefined(me.cssCancel)}\" \r\n      color=\"${ifDefined(me.colorCancel)}\" \r\n      title=\"${me.cancelText}\">\r\n      </gs-button>`;\r\n  }\r\n\r\n  #renderFooter() {\r\n    const me = this;\r\n    const isFooter = me.cancelable || me.closable;\r\n    if (!isFooter) return '';\r\n    return html`<div class=\"card-footer d-flex user-select-none justify-content-${me.buttonAlign} ${me.cssFooter}\">\r\n       <slot name=\"actions\"></slot>\r\n      ${me.#renderCancel()} &nbsp;${me.#renderConfirm()}\r\n      </div>`;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const styles = {\r\n      'min-width': me.minWidth > 0 ? `${me.minWidth}px` : undefined\r\n    };\r\n    me.dynamicStyle(me.#styleID, styles);\r\n    return html`\r\n        <dialog tabindex=\"-1\" ${ref(me.#dialogRef)} \r\n            dir=\"${ifDefined(me.direction)}\"\r\n            @close=\"${me.#onCancel.bind(me)}\"\r\n            @cancel=\"${me.#onCancel.bind(me)}\"\r\n            @keydown=\"${me.#onKeyDown.bind(me)}\"\r\n            @form=\"${me.#onForm.bind(me)}\"\r\n            @confirm=\"${me.#onConfirm.bind(me)}\"\r\n            @submit=\"${me.#onSubmit.bind(me)}\"\r\n            class=\"${classMap(me.renderClass())}\">\r\n            <div class=\"card ${me.cssContent}\">\r\n                <div class=\"card-header user-select-none ${me.cssHeader}\">\r\n                  <div class=\"card-title ${me.cssTitle}\">\r\n                    <slot name=\"title\">${me.translate(me.title)}</slot>\r\n                  </div>\r\n                </div>\r\n                <div class=\"card-body ${me.cssBody}\">\r\n                  <slot name=\"body\">\r\n                  ${me.translate(me.message)}\r\n                  ${me.renderTemplate()}\r\n                  </slot>\r\n                  </div>\r\n                  ${me.#renderFooter()}\r\n                  </div>\r\n                  <slot name=\"extra\"></slot>\r\n                  <div class=\"toast-container position-fixed\"></slot></div>\r\n                  </dialog>\r\n                  `;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const size = SizeTypes[me.size];\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'dialog': true,\r\n      'p-0': true,\r\n      'border-0': true,\r\n      [me.#styleID]: true,\r\n      [`modal-${size}`]: size ? true : false\r\n    }\r\n    return css;\r\n  }\r\n\r\n  /**\r\n   * Generic modal popup function\r\n   * @param {string} title Modal title\r\n   * @param {string} message Modal message \r\n   * @param {boolean} closable Can user close it (close button)\r\n   * @param {boolean} cancelable Is cancel button available\r\n   * @returns {Promise}\r\n   */\r\n  info(title = '', message = '', closable = false, cancelable = false) {\r\n    const me = this;\r\n    me.title = title;\r\n    me.message = message;\r\n    me.closable = closable;\r\n    me.cancelable = cancelable;\r\n    me.escapable = cancelable;\r\n    me.open();\r\n    if (closable || cancelable) return me.waitEvent('click-action');\r\n  }\r\n\r\n  confirm(title = '', message = '') {\r\n    return this.info(title, message, true, false);\r\n  }\r\n\r\n  prompt(title = '', message = '') {\r\n    return this.info(title, message, true, true);\r\n  }\r\n\r\n  reset(data, index = 0) {\r\n    index = GSUtil.asNum(index, 0);\r\n    const me = this;\r\n    me.forms?.forEach?.(f => { f.reset(); f.data = data; });\r\n    const tab = me.tab;\r\n    if (tab && index > -1) tab.index = index;\r\n  }\r\n\r\n  open() {\r\n    this.opened = true;\r\n  }\r\n\r\n  close() {\r\n    this.opened = false;\r\n  }\r\n\r\n  toggle() {\r\n    this.opened = !this.opened;\r\n  }\r\n\r\n  /**\r\n   * Retrun true if dialog is opened by hashbang.\r\n   * Used to clear the hashbang on close\r\n   */\r\n  get isHashed() {\r\n    return GSUtil.asBool(this.dataset.gsHashed);\r\n  }\r\n\r\n  get form() {\r\n    return this.query('gs-form', true);\r\n  }\r\n\r\n  get forms() {\r\n    return this.queryAll('gs-form', true);\r\n  }\r\n\r\n  get tab() {\r\n    return this.query('gs-tab', true);\r\n  }\r\n\r\n  get #dialog() {\r\n    return this.#dialogRef.value;\r\n  }\r\n\r\n  get #btnConfirm() {\r\n    return this.#btnConfirmRef.value;\r\n  }\r\n\r\n  get #btnCancel() {\r\n    return this.#btnCancelRef.value;\r\n  }\r\n\r\n  /**\r\n   * Return active button\r\n   * @returns {HTMLButtonElement|GSButton}\r\n   */\r\n  #focusable() {\r\n    const me = this;\r\n    const form = me.queryAll(GSDOM.QUERY_INPUT, true).filter(el => GSDOM.isVisible(el)).shift();\r\n    if (form) return form;\r\n    if (me.cancelable) return me.#btnCancel;\r\n    if (me.closable) return me.#btnConfirm;\r\n    return me;\r\n  }\r\n\r\n  async #onConfirm(e) {\r\n    const me = this;\r\n    if (me.disabled) return;\r\n    const ret = await Promise.all(me.forms?.map?.(form => form.submit()));\r\n    if (ret.indexOf(false) < 0) me.close();\r\n  }\r\n\r\n  #onCancel(e) {\r\n    const me = this;\r\n    me.close();\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n    const me = this;\r\n    if (e.key === 'Escape') {\r\n      GSEvents.prevent(e);\r\n      if (me.cancelable || me.escapable) {\r\n        me.close();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle injected form events\r\n   * @param {*} e \r\n   */\r\n  #onForm(e) {\r\n    let sts = true;\r\n    const me = this;\r\n    const data = e.detail;\r\n    switch (data.type) {\r\n      case 'submit':\r\n        sts = me.emit('data', data.data, false, false, true);\r\n        if (!sts) GSEvents.prevent(e);\r\n        //me.opened = false;\r\n        break;\r\n      case 'valid':\r\n        me.disabled = data.data === false;\r\n        break;\r\n    }\r\n    return sts;\r\n  }\r\n\r\n  #onSubmit(e) {\r\n    debugger;\r\n  }\r\n\r\n  static #updateStack() {\r\n    GSDialogElement.#STACK = GSDialogElement.#STACK.filter(v => v.isConnected);\r\n  }\r\n\r\n  /**\r\n   * Return number of dialogs in a stack\r\n   */\r\n  static get size() {\r\n    return GSDialogElement.#STACK.length;\r\n  }\r\n\r\n  static get top() {\r\n    GSDialogElement.#updateStack();\r\n    const size = GSDialogElement.size;\r\n    return size === 0 ? null : GSDialogElement.#STACK[size - 1];\r\n  }\r\n\r\n  static get opened() {\r\n    GSDialogElement.#updateStack();\r\n    return Array.from(GSDialogElement.#STACK);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-dialog');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, unsafeHTML, html, ifDefined } from '../lib.mjs';\r\nimport { placement, PlacementTypes } from '../properties/placement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSDrawerElement extends GSElement {\r\n\r\n  static properties = {\r\n    autoclose: { reflect: true, type: Boolean },\r\n    closable: { reflect: true, type: Boolean },\r\n    backdrop: { reflect: true, type: Boolean },\r\n    expanded: { reflect: true, type: Boolean },\r\n    scroll: { reflect: true, type: Boolean },\r\n\r\n    min: { reflect: true, type: Number},\r\n    max: { reflect: true},\r\n    fingers: { reflect: true, type: Number},\r\n    placement: {...placement},\r\n    \r\n    transition: { reflect: true },\r\n    duration: { reflect: true, type: Number },\r\n\r\n    title: { reflect: true},\r\n\r\n    cssTitle: { reflect: true, attribute: \"css-title\"},\r\n    cssHead: { reflect: true, attribute: \"css-head\" },\r\n    cssBody: { reflect: true, attribute: \"css-body\" },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.placement = 'start';\r\n    me.cssTitle = 'fs-5';\r\n    me.transition = 'linear';\r\n    me.duration = 0.2;\r\n    me.min = 0;\r\n    me.max = 'auto';\r\n    me.fingers = 2;\r\n    me.on('mouseleave', me.#onLeave.bind(me));\r\n    me.on('mouseenter', me.#onEnter.bind(me));\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`${unsafeHTML(me.#style)}\r\n    <div tabindex=\"-1\" dir=\"${ifDefined(me.direction)}\"\r\n     class=\"offcanvas overflow-hidden anime ${classMap(me.renderClass())}\">\r\n      ${me.#header}\r\n      <div class=\"offcanvas-body  ${me.cssBody}\">\r\n        ${me.renderTemplate()}\r\n        <slot name=\"body\"></slot>\r\n      </div>\r\n    </div>${me.#backdrop}`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'show': true,\r\n      'anime-open' : me.expanded,\r\n      'anime-close' : !me.expanded,\r\n      [`offcanvas-${me.placement}`]: me.placement,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  get #style() {\r\n    const me = this;\r\n    const pos = me.isHorizontal ? 'width' : 'height';\r\n    return `<style>\r\n    .anime {\r\n      transition-property: ${pos} !important;\r\n      transition-duration: ${me.duration}s  !important;\r\n      transition-timing-function: ${me.transition} !important;\r\n    }\r\n    .anime-open {\r\n        ${pos} : ${me.max}${GSUtil.isNumber(me.max) ? 'px':''} !important;\r\n    }\r\n    .anime-close {\r\n      ${pos} : ${me.min}${GSUtil.isNumber(me.min) ? 'px':''} !important;\r\n    }    \r\n    </style>`;\r\n  }\r\n\r\n  get #backdrop() {\r\n    const me = this;\r\n    if (!me.backdrop) return '';\r\n    return html`<div class=\"offcanvas-backdrop fade ${me.expanded ? 'show' : 'invisible'}\" @click=\"${me.close}\"></div>`;\r\n  }\r\n\r\n  get #button() {\r\n    const me = this;\r\n    return me.closable ? html`<button type=\"button\" class=\"btn-close text-reset\" @click=\"${me.close}\"></button>` : '';\r\n  }\r\n\r\n  get #title() {\r\n    const me = this;\r\n    return me.title ? html`<div class=\"offcanvas-title ${me.cssTitle}\">${me.translate(me.title)}</div>` : '';\r\n  }\r\n\r\n  get #header() {\r\n    const me = this;\r\n    return me.#hasHeader ? html`<div class=\"offcanvas-header ${me.cssHead}\"><slot name=\"header\">${me.#title}${me.#button}</slot></div>` : '';\r\n  }\r\n\r\n  get #headSlot() {\r\n    return this.querySelector('[slot=\"header\"]');\r\n  }\r\n\r\n  get #hasHeader() {\r\n    return this.title || this.closable || this.#headSlot;\r\n  }\r\n\r\n  #notify(val) {\r\n    const me = this;\r\n    me.expanded = val == true;\r\n    me.notify();\r\n  }\r\n\r\n  #onLeave() {\r\n    const me = this;\r\n    if (me.autoclose) me.close();\r\n  }\r\n\r\n  #onEnter() {\r\n    const me = this;\r\n    if (me.min > 0) me.open();\r\n  }\r\n\r\n  open() {\r\n    this.#notify(true);\r\n  }\r\n\r\n  close() {\r\n    this.#notify(false);\r\n  }\r\n\r\n  toggle() {\r\n    this.#notify(!this.expanded);\r\n  }\r\n\r\n  get isHorizontal() {\r\n    return !this.isVertical;\r\n  }\r\n\r\n  get isVertical() {\r\n    return PlacementTypes.isVertical(this.placement);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-drawer');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDropdownElement class\r\n * @module components/GSDropdownElement\r\n */\r\n\r\nimport { html, ifDefined } from '../lib.mjs';\r\nimport { cssMap } from '../directives/css-map.mjs';\r\nimport { color } from '../properties/color.mjs';\r\nimport { GSMenuElement } from './Menu.mjs';\r\n\r\n/**\r\n * Renderer for panel layout \r\n * @class\r\n * @extends {GSMenuElement}\r\n */\r\nexport class GSDropdownElement extends GSMenuElement {\r\n\r\n    static properties = {\r\n        icon: {},\r\n        text: {...color},\r\n        color: {...color},\r\n        size: {},\r\n        title: {},\r\n        tooltip: {},\r\n        group: {},\r\n        simple: {type:Boolean}\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.auto = true;\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div class=\"dropdown\"  dir=\"${ifDefined(me.direction)}\">\r\n                ${me.#renderButton()}\r\n                ${super.renderUI()}\r\n            </div>`;\r\n    }\r\n\r\n    #buttonClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            'btn': true,\r\n            [`btn-${me.color}`] : me.color ? true : false,\r\n            'dropdown-toggle': !me.simple,\r\n            'shadow-none' : true,\r\n        }\r\n        return css;\r\n    }\r\n\r\n    #renderButton() {\r\n        const me = this;\r\n        return html`<gs-link css=\"${cssMap(me.#buttonClass())}\"\r\n            url=\"#\"         \r\n            icon=\"${ifDefined(me.icon)}\"\r\n            text=\"${ifDefined(me.text)}\"\r\n            size=\"${ifDefined(me.size)}\"\r\n            title=\"${ifDefined(me.title)}\"\r\n            tooltip=\"${ifDefined(me.tooltip)}\"\r\n            @notify=\"${me.toggle}\">\r\n            </gs-link>`;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-dropdown');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { css, html, unsafeHTML } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\n/**\r\n * Safe email rendering to protect from spam bots.\r\n */\r\nexport class GSEmailElement extends GSElement {\r\n\r\n  static shadowRootOptions = { mode: 'closed' }\r\n\r\n  static style = css`.e-mail:before {\r\n    content: attr(data-website) \"\\0040\" attr(data-user);\r\n    unicode-bidi: bidi-override;\r\n    direction: rtl;\r\n    }`;\r\n\r\n  static properties = {\r\n    user: { reflect: true },\r\n    domain: { reflect: true },\r\n    dev: { type: Boolean }\r\n  }\r\n\r\n  #user;\r\n  #domain;\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  willUpdate(changes) {\r\n    super.willUpdate(changes);\r\n    this.#updateUser();\r\n    this.#updateDomain()\r\n  }\r\n\r\n  renderUI() {\r\n    return html`${unsafeHTML(this.#style)}<a @click=\"${this.#onClick}\" class=\"e-mail\" data-user=\"${this.#user}\" data-website=\"${this.#domain}\"  href=\"mailto://\"></a>`;\r\n  }\r\n\r\n  get #style() {\r\n    return '<style>.e-mail:before { content: attr(data-website) \"\\u0040\" attr(data-user); unicode-bidi: bidi-override; direction: rtl; }</style>';\r\n  }\r\n\r\n  get #url() {\r\n    return `mailto://${GSUtil.reverse(this.dataset.user)}@${GSUtil.reverse(this.dataset.domain)}`;\r\n  }\r\n\r\n  #updateUser() {\r\n    const me = this;\r\n    const dataset = me.dataset;\r\n    if (me.user) {\r\n      me.#user = dataset.user || GSUtil.reverse(me.user);\r\n      if (me.dev) dataset.user = me.#user;\r\n      me.user = '';\r\n    }\r\n  }\r\n\r\n  #updateDomain() {\r\n    const me = this;\r\n    const dataset = me.dataset;\r\n    if (me.domain) {\r\n      me.#domain = dataset.domain || GSUtil.reverse(me.domain);\r\n      if (me.dev) dataset.domain = me.#domain;\r\n      me.domain = '';\r\n    }\r\n  }\r\n\r\n  #onClick(e) {\r\n    const me = this;\r\n    me.prevent(e);\r\n    window.location.href = me.#url;\r\n    //window.open(me.#url, '_blank');  \r\n  }\r\n\r\n  static {\r\n    this.define('gs-email');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, html, ifDefined, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSLog } from '../base/GSLog.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\n\r\nexport class GSFormElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    disabled: { type: Boolean },\r\n    data: { type: Object },\r\n\r\n    name: { reflect : true},\r\n    rel: { reflect : true},\r\n    acceptCharset : {reflect : true, attribute: 'accept-charset'},\r\n    autocapitalize: { reflect : true},\r\n    autocomplete: { reflect : true},\r\n\r\n    action: { reflect : true},\r\n    enctype: { reflect : true},\r\n    method: { reflect : true},\r\n    novalidate: { reflect : true, type: Boolean},\r\n    target: { reflect : true},\r\n\r\n    block: { type: Boolean },\r\n    beep: { type: Boolean },\r\n    timeout: { type: Number }\r\n  }\r\n\r\n  #formRef = createRef();\r\n  #lastState = undefined;\r\n\r\n  constructor() {\r\n    super();\r\n    this.data = {};\r\n    this.disabled = false;\r\n    this.method = \"dialog\";\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<form ${ref(me.#formRef)}\r\n      id=\"${ifDefined(me.name)}\"\r\n      name=\"${ifDefined(me.name)}\"\r\n      dir=\"${ifDefined(me.direction)}\"\r\n      @change=\"${me.#onChange}\"\r\n      @blur=\"${me.#onBlur}\"\r\n      @invalid=\"${me.#onInvalid}\"\r\n      @submit=\"${me.submit}\"\r\n      @reset=\"${me.reset}\"\r\n      method=\"${me.method}\"\r\n      \r\n      rel=\"${ifDefined(me.rel)}\"\r\n      acceptCharset=\"${ifDefined(me.acceptCharset)}\"\r\n      autocapitalize=\"${ifDefined(me.autocapitalize)}\"\r\n      autocomplete=\"${ifDefined(me.autocomplete)}\"\r\n      action=\"${ifDefined(me.action)}\"\r\n      enctype=\"${ifDefined(me.enctype)}\"\r\n      target=\"${ifDefined(me.target)}\"\r\n\r\n      ?novalidate=\"${me.novalidate}\">\r\n      <slot></slot>\r\n    </form>`;\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    const me = this;\r\n    me.dataController?.read();\r\n  }\r\n  \r\n  updated(changed) {\r\n    const me = this;\r\n    if (changed.has('disabled')) {\r\n      if (me.disabled) {\r\n        me.disable();\r\n      } else {\r\n        me.enable();\r\n      }\r\n    }\r\n    if (changed.has('data')) {\r\n      if (GSUtil.isNull(me.data)) {\r\n        me.reset();\r\n      } else {\r\n        me.asJSON = Object.assign(me.asJSON, me.data);\r\n      }\r\n    }\r\n  }\r\n\r\n  templateInjected() {\r\n    const me = this;\r\n    me.#doFilter(me.#filterField);\r\n    me.invalid[0]?.focus();\r\n\t}  \r\n\r\n  async reset(e) {\r\n    const me = this;\r\n    const internal = e?.target === me.form;\r\n\r\n    if (internal) {\r\n      me.elements.forEach(el => GSDOM.reset(el));\r\n      await me.dataController?.read(me.asJSON);\r\n    } else {\r\n      me.data = {};\r\n      me.form.reset();\r\n    }\r\n  }\r\n\r\n  async submit(e) {\r\n    GSEvents.prevent(e);\r\n    const me = this;\r\n    if (me.disabled) return;\r\n    if (!me.validate()) return;\r\n    const json = me.asJSON;\r\n    await me.dataController?.write(json);\r\n    const data = { type: 'submit', data: json, source: e, owner : me};\r\n    return me.emit('form', data, true, true, true);\r\n  }\r\n\r\n  #button(type) {\r\n    return this.query(`button[type=\"${type}\"]`, true);\r\n  }\r\n\r\n  get submitButton() {\r\n    return this.#button('submit');\r\n  }\r\n  \r\n  get resetButton() {\r\n    return this.#button('reset');\r\n  }\r\n  \r\n  get form() {\r\n    return this.#formRef.value;\r\n  }\r\n  \r\n  /**\r\n  * Overide native to pickup all form elements, including ones in shadow dom\r\n  */\r\n  get elements() {\r\n    return this.#childrens(true);\r\n  }\r\n\r\n  get fields() {\r\n    return this.elements;\r\n  }\r\n\r\n  get inputs() {\r\n    return this.elements;\r\n  }\r\n\r\n  get invalid() {\r\n    return this.inputs.filter(el => !el.validity.valid);\r\n  }\r\n\r\n  get asJSON() {\r\n    const data = {};\r\n    this.elements.forEach(field => GSDOM.fromElement2Object(field, data));    \r\n    return data;\r\n  }\r\n\r\n  set asJSON(data) {\r\n    const me = this;\r\n    //me.form.reset(); do not use, create a circular calls\r\n    me.elements.forEach(field => GSDOM.fromObject2Element(field, data));    \r\n    me.#doFilter(me.#filterField);\r\n    me.validate();\r\n  }\r\n\r\n  get isValid() {\r\n    return this.elements\r\n      .filter(el => !el.disabled)\r\n      .filter(el => !el.validity.valid).length === 0;\r\n  }\r\n\r\n  checkValidity() {\r\n    return this.form.checkValidity() && \r\n    this.elements\r\n      .filter(el => !el.disabled)\r\n      .filter(el => !el.checkValidity()).length === 0;;\r\n  }\r\n\r\n  reportValidity() {\r\n    this.elements\r\n      .filter(el => !el.disabled)\r\n      .filter(el => !el.validity?.valid)\r\n      .forEach(el => el.reportValidity() );\r\n    return this.form.reportValidity();\r\n  }\r\n\r\n  validate() {\r\n    const me = this;\r\n    let isValid = me.checkValidity();\r\n    if (!isValid) me.reportValidity();\r\n    isValid = me.onValidate(isValid);\r\n    me.#toggle(isValid);\r\n    me.#notify(isValid);\r\n    me.invalid[0]?.focus();\r\n    return isValid;\r\n  }\r\n\r\n  disable() {\r\n    GSDOM.disableInput(this, 'gs-form-group, input, textarea, select, .btn', false, 'gsForm');\r\n  }\r\n\r\n  enable() {\r\n    GSDOM.enableInput(this, 'gs-form-group, input, textarea, select, .btn', false, 'gsForm');\r\n  }\r\n\r\n  onDataRead(data) {\r\n    this.data = data;\r\n  }\r\n\r\n  onDataWrite(data) {\r\n\r\n  }\r\n\r\n  onDataError(e) {\r\n    GSLog.error(this, e);\r\n  }\r\n\r\n  /**\r\n   * Called only if field is valid and changed\r\n   * @param {HTMLInputElement|HTMLSelectElement|HTMLTextAreaElement} el \r\n   */\r\n  onFieldChange(el) {\r\n\r\n  }\r\n\r\n  /**\r\n   * Called only if field is invalid\r\n   * @param {HTMLInputElement|HTMLSelectElement|HTMLTextAreaElement} el \r\n   */\r\n  onFieldInvalid(el) {\r\n\r\n  }\r\n\r\n  onValidate(sts) {\r\n\r\n    return sts;\r\n  }\r\n\r\n  #onInvalid(e) {\r\n    const me = this;\r\n    me.prevent(e);\r\n    const field = me.#findField(e);\r\n    if(field) me.onFieldInvalid(field);\r\n    me.#toggle(false);\r\n    me.#notify(false);\r\n  }\r\n\r\n  #onBlur(e) {\r\n    const me = this;\r\n    me.prevent(e);\r\n    me.#toggle(me.isValid);\r\n    me.#notify(me.isValid);\r\n  }\r\n\r\n  #onChange(e) {\r\n    const me = this;\r\n    me.prevent(e);\r\n    const field = me.#findField(e);\r\n    if (field) {\r\n      me.#doFilter(field);\r\n      me.handle(e);\r\n      if (field.validity.valid) me.onFieldChange(field);\r\n    }\r\n    me.#toggle(me.isValid);\r\n    me.#notify(me.isValid);\r\n  }\r\n\r\n  #notify(isValid = false) {\r\n    const me = this;\r\n    if (me.#lastState === isValid) return;\r\n    me.#lastState = isValid;\r\n    const data = { type: 'valid', data: isValid, owner : me};\r\n    me.emit('form', data, true, true);    \r\n  }\r\n\r\n  #toggle(isValid = false) {\r\n    const me = this;\r\n    const btn = me.submitButton;\r\n    if (btn) btn.disabled = !isValid;\r\n  }  \r\n\r\n  #findField(e) {\r\n    if (!(e instanceof Event)) return;\r\n    const me = this;\r\n    let field = e.target;\r\n    if (e.composed) {\r\n      field = e.composedPath()\r\n        .filter(el => me.#isField(el))\r\n        .pop();\r\n    }\r\n    if(!me.#isField(field)) field = me.#findField(e.detail);\r\n    return me.#isField(field) ? field : null;\r\n  }\r\n\r\n  #isField(el) {\r\n    return el?.matches?.('input,select,textarea');\r\n  }\r\n\r\n  /**\r\n   * Filter field disabled status\r\n   * @param {HTMLInputElement} field \r\n   */\r\n  #doFilter(field) {\r\n    \r\n    if(!field) return;\r\n    \r\n    const me = this;\r\n\r\n    const value = me.#fieldValue(field);\r\n    const fldName = me.dataset.gsfDisable;\r\n    const fldVal = me.dataset.gsfValue;\r\n    const matched = fldName && field.name === fldName;\r\n    const flag = matched && value === fldVal;\r\n    if (matched) {\r\n      me.elements\r\n        .filter(el => el.name != fldName)\r\n        .forEach(el => el.disabled = flag);\r\n    } \r\n\r\n  }\r\n\r\n  /**\r\n   * Initialy, field might not be set just yet (if it is selectable),\r\n   * so we need to take valeu fro mgs-item definition\r\n   * @param {*} field \r\n   * @returns \r\n   */\r\n  #fieldValue(field) {\r\n    let value = field.tagName === 'GS-FORM-GROUP' ? field.field?.value : field.value;\r\n    if (field.selectable && GSUtil.isNull(value)) {\r\n      value = GSAttr.get(this.query('gs-item[selected]'), 'value');\r\n    }\r\n    return value;\r\n  }\r\n\r\n  #childrens(shadow = false) {\r\n    return this.queryAll('input,select,output,textarea', shadow);\r\n  }\r\n\r\n  get #filterField() {\r\n    const me = this;\r\n    return me.elements.filter(el => el.name === me.dataset.gsfDisable).pop();\r\n  }\r\n\r\n  static {\r\n    this.define('gs-form');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, ref, html, unsafeHTML, ifDefined } from '../lib.mjs';\r\nimport { inputType, numGT0, numGE0, autocapitalize, autocorrect, autocomplete } from '../properties/index.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\n\r\nexport class GSFormGroupElement extends GSElement {\r\n\r\n  static CSS_LABEL_CELL = 'col-md-4 col-sm-4 col-xs-2';\r\n  static CSS_LABEL = 'user-select-none fw-small fw-light text-secondary';\r\n  static CSS_ICON = 'text-primary me-2 fs-5';\r\n  static ICON = 'info-circle-fill';\r\n\r\n  static #SELECTOPT = {\r\n    name : {},\r\n    value : {},\r\n    selected : {type: Boolean}\r\n  }\r\n\r\n  static properties = {\r\n    icon: {},\r\n    layout: {},\r\n    placement: {},\r\n\r\n    label: {},\r\n    description: {},\r\n    placeholder: {reflect: true},\r\n\r\n    pattern: {},\r\n    mask: {},\r\n    \r\n    form: {},\r\n    wrap: {},\r\n    spellcheck: {},\r\n\r\n    type: { ...inputType },\r\n    name: {},\r\n    list: {},\r\n    accept: {},   \r\n    value: {},\r\n\r\n    lang: {reflect: true},\r\n    title: {reflect: true},\r\n    rows: { type: Number, reflect: true, hasChanged: numGT0 },\r\n    cols: { type: Number, reflect: true, hasChanged: numGT0 },\r\n    step: { type: Number, reflect: true, hasChanged: numGT0 },\r\n    min: { type: Number, reflect: true, hasChanged: numGE0 },\r\n    max: { type: Number, reflect: true, hasChanged: numGT0 },\r\n    minLength: { type: Number, reflect: true, hasChanged: numGE0 },\r\n    maxLength: { type: Number, reflect: true, hasChanged: numGT0 },\r\n\r\n    reverse: { type: Boolean },\r\n    selectable: { type: Boolean },\r\n\r\n    autoid: { type: Boolean },\r\n    autocopy: { type: Boolean, reflect: true },\r\n    autoselect: { type: Boolean, reflect: true },\r\n\r\n    autocapitalize: { ...autocapitalize, reflect: true },\r\n    autocorrect: { ...autocorrect, reflect: true },\r\n    autocomplete: { reflect: true },\r\n    autofocus: { type: Boolean, reflect: true },\r\n    autoselect: { type: Boolean, reflect: true },\r\n\r\n    disabled: { type: Boolean, reflect: true },\r\n    checked: { type: Boolean, reflect: true },\r\n    multiple: { type: Boolean, reflect: true },\r\n    reveal: { type: Boolean, reflect: true },\r\n    readonly: { type: Boolean, reflect: true },\r\n    required: { type: Boolean, reflect: true },\r\n\r\n    invalidMessage: {reflect: true, attribute: 'invalid-message' },\r\n\r\n    cellField: { attribute: 'cell-field' },\r\n    cellLabel: { attribute: 'cell-label' },\r\n    cssLabel: { attribute: 'css-label' },\r\n    cssField: { attribute: 'css-field' },\r\n\r\n    block: { type: Boolean },\r\n    beep: { type: Boolean },\r\n    timeout: { type: Number }\r\n  }\r\n\r\n  #styleID = GSID.id;\r\n  #inputRef = createRef();\r\n  #ouptutRef = createRef();\r\n  #patterns = [];\r\n  #options = [];\r\n\r\n  constructor() {\r\n    super();\r\n    this.#validateAllowed();\r\n    this.dynamicStyle(this.#styleID);\r\n    this.rows = 0;\r\n    this.cols = 0;\r\n    this.type = 'text';\r\n    this.placement = 'top';\r\n    this.layout = 'horizontal';\r\n    this.invalidMessage = 'Invalid input',\r\n    this.icon = GSFormGroupElement.ICON;\r\n    this.cssLabel = GSFormGroupElement.CSS_LABEL;\r\n    this.cellLabel = GSFormGroupElement.CSS_LABEL_CELL;\r\n  }\r\n  \r\n  connectedCallback() {\r\n    const me = this;\r\n    const form = me.formComponent;\r\n    me.layout = GSAttr.get(form, 'layout', me.layout);\r\n\r\n    if (!me.form && form) me.form = form.name;\r\n\r\n    if (me.selectable) {\r\n      me.#options = GSItem.proxify(me, GSFormGroupElement.#SELECTOPT);\r\n    } else {\r\n      me.#patterns = GSItem.collect(me)\r\n      .filter(el => el.dataset.pattern)\r\n      .map(el => new RegExp(el.dataset.pattern));\r\n    }      \r\n    super.connectedCallback();\r\n  }\r\n\r\n  updated(changed) {\r\n    const me = this;\r\n    me.#onRange();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    switch (me.layout) {\r\n      case 'floating': return me.#renderFloating();\r\n      case 'vertical': return me.#renderVertical();\r\n      default: return me.#renderHorizontal();\r\n    }\r\n  }\r\n\r\n\r\n  #renderFloating() {\r\n    const me = this;\r\n    return html`\r\n    <div  dir=\"${ifDefined(me.direction)}\" class=\"row ${classMap(me.renderClass())}\">\r\n       <div class=\"form-floating ${me.#cssCheck} ${me.#cellField}\">\r\n          ${me.#renderInput()}\r\n          ${me.#renderOutput()}\r\n          ${me.#renderLabel()}\r\n       </div>\r\n       ${me.#renderInfo()}\r\n    </div>\r\n    <slot></slot>`;\r\n  }\r\n\r\n  #renderVertical() {\r\n    const me = this;\r\n    return html`\r\n    <div  dir=\"${ifDefined(me.direction)}\" class=\"row ${classMap(me.renderClass())}\">\r\n      <div class=\"col-12 text-md-start ${me.cellLabel}\">\r\n          ${me.#renderLabel()}\r\n      </div>\r\n       <div class=\"${me.#cssCheck} ${me.#cellField}\">\r\n          ${me.#renderInput()}\r\n          ${me.#renderOutput()}\r\n       </div>\r\n       ${me.#renderInfo()}   \r\n    </div>      \r\n    <slot></slot>`;\r\n  }\r\n\r\n  #renderHorizontal() {\r\n    const me = this;\r\n    return html`\r\n    <div  dir=\"${ifDefined(me.direction)}\" class=\"row form-group ${classMap(me.renderClass())}\">    \r\n       <slot name=\"header\"></slot>\r\n       ${me.#renderLabelWrap()}\r\n       ${me.#renderField()}\r\n       ${me.#renderInfo()}\r\n       <slot name=\"footer\"></slot>\r\n    </div>\r\n    <slot></slot>`;\r\n  }\r\n\r\n  #renderLabel() {\r\n    const me = this;\r\n    return html`<label class=\"${me.#cssLabel} ${me.cssLabel} user-select-none\" for=\"${me.name}\">${me.translate(me.label)}</label>`;\r\n  }\r\n\r\n  #renderLabelWrap() {\r\n    const me = this;\r\n    return html`<div class=\" text-md-end ${me.cellLabel}\">${me.#renderLabel()}</div>`;\r\n  }\r\n\r\n  #renderIcon() {\r\n    const me = this;\r\n    return me.#isIcon ? html`<gs-icon size=\"5\" css=\"${GSFormGroupElement.CSS_ICON}}\" name=\"${me.icon}\"></gs-icon>` : html`<slot name=\"icon\"></slot>`;\r\n  }\r\n\r\n  #renderTooltip() {\r\n    const me = this;\r\n    const tgt = me.#isIcon ? '@parent' : `[name='${me.name}']`;\r\n    return me.description ? html`<gs-tooltip local language=\"${ifDefined(me.language)}\" placement=\"${me.placement}\" title=\"${me.description}\" target=${ifDefined(tgt)}></gs-tooltip>` : '';\r\n  }\r\n\r\n  #renderInfo() {\r\n    const me = this;\r\n    const tooltip = me.#renderTooltip();\r\n    if (tooltip && me.#isIcon) return html`\r\n    <div class=\"col-auto\">\r\n       ${tooltip}\r\n       ${me.#renderIcon()}\r\n    </div>`;\r\n    return tooltip;\r\n  }\r\n\r\n  #renderField() {\r\n    const me = this;\r\n    return html`\r\n    <div class=\"${me.#cssCheck} ${me.#cellField}\">\r\n       <slot name=\"body\">${me.#renderInput()}${me.#renderOutput()}</slot>\r\n    </div>`;\r\n  }\r\n\r\n  #renderOutput() {\r\n    const me = this;\r\n    if (!me.isRange) return \"\";\r\n    return html`<span ${ref(me.#ouptutRef)} class=\"position-absolute px-1\">${me.value}</span>`;\r\n  }\r\n\r\n  #renderInput() {\r\n\r\n    const me = this;\r\n\r\n    const idattr = me.autoid ? me.name : undefined;\r\n    const val = me.isFieldset ? me.value.split(',') : me.value;\r\n\r\n    if (Array.isArray(val)) {\r\n      const wrap = me.dataset.radioLayout === 'vertical';\r\n      return val.map((it, i) => { return { v: it, id: `${me.name}_${i}` } })\r\n        .map((o, i) => me.#fieldSet(me.name + i, o.v, me.#inputHTML(o.id, me.name, o.v), wrap));\r\n    }\r\n\r\n    if (me.selectable) return me.#selectHTML(idattr, me.name, me.value);\r\n\r\n    if (me.#isTextArea) return me.#textArea(idattr, me.name, me.value);\r\n\r\n    return me.#inputHTML(idattr, me.name, me.value);\r\n  }\r\n\r\n  #fieldSet(id, val, fld, vertical = false) {\r\n    const me = this;\r\n    return vertical ?\r\n      html`<div class=\"me-3\">${fld}<label for=\"${id}\" class=\"ms-1\">${me.translate(val)}</label></div>`\r\n      :\r\n      html`<span class=\"me-3\">${fld}<label for=\"${id}\" class=\"ms-1\">${me.translate(val)}</label></span>`;\r\n  }\r\n\r\n  #initStyle() {\r\n    const me = this;\r\n    const style = {\r\n      transform: me.reverse && me.isRange ? 'rotateY(180deg)' : ''\r\n    }\r\n    me.dynamicStyle(me.#styleID, style);    \r\n  }\r\n\r\n  #renderOptions() {\r\n    const me = this;\r\n    return me.#options.map( el => html`<option value=\"${el.value}\" ?selected=${el.selected}>${el.name || el.innerText || el.value }</option>`);\r\n  }\r\n\r\n  #selectHTML(id, name, value) {\r\n    const me = this;\r\n    me.#initStyle();\r\n\r\n    return html`<select ${ref(me.#inputRef)}\r\n            id=${ifDefined(id)} \r\n            @change=\"${me.#onChange.bind(me)}\"\r\n            @blur=\"${me.#onBlur.bind(me)}\"\r\n        \r\n            name=\"${name}\"             \r\n            form=\"${ifDefined(me.form)}\"\r\n            class=\"${me.#cssField} ${me.cssField} ${me.#styleID}\" \r\n\r\n            ?autofocus=\"${me.autofocus}\"\r\n            ?autocopy=\"${me.autocopy}\"\r\n            ?autoselect=\"${me.autoselect}\"\r\n            ?readonly=\"${me.readonly}\"\r\n            ?required=\"${me.required}\"\r\n            ?disabled=\"${me.disabled}\">\r\n            ${me.#renderOptions()}\r\n            </select>`;\r\n  }\r\n\r\n  get #isTextArea() {\r\n    const me = this;\r\n    return (me.rows > 0 || me.cols > 0) && me.type === 'text';\r\n  }\r\n\r\n  get #listHTML() {\r\n    const me = this;\r\n    let list = '';\r\n    if (me.list) {\r\n      const root = me.parentComponent || me.parentElement;\r\n      const el = GSDOM.query(root, `datalist[id=\"${me.list}\"]`, true);\r\n      if (el) list = html`${unsafeHTML(el.outerHTML)}`;\r\n    }\r\n    return list;\r\n  }\r\n\r\n  get #isBlock() {\r\n    return this.block || this.formComponent?.block || false;\r\n  }\r\n\r\n  get #isBeep() {\r\n    return this.beep || this.formComponent?.beep || false;\r\n  }\r\n  \r\n  #timeout() {\r\n    return this.timeout || this.formComponent?.timeout || 0;\r\n  }\r\n\r\n  #textArea(id, name, value) {\r\n    const me = this;\r\n    me.#initStyle();\r\n    const placeholder = me.placeholder ? me.translate(me.placeholder, false) : null;\r\n    const title = me.title ? me.translate(me.title, false) : null;\r\n\r\n    return html`<textarea  is=\"gs-ext-text\" \r\n            ${ref(me.#inputRef)}\r\n            id=${ifDefined(id)}\r\n            @input=\"${me.#onRange.bind(me)}\"\r\n            @change=\"${me.#onChange.bind(me)}\"\r\n            @blur=\"${me.#onBlur.bind(me)}\"\r\n            @invalid=\"${me.#onInvalid.bind(me)}\"\r\n            lang=\"${ifDefined(me.lang)}\"\r\n            minlength=\"${ifDefined(me.minLength)}\"\r\n            maxlength=\"${ifDefined(me.maxLength)}\"\r\n            cols=\"${me.cols}\"\r\n            rows=\"${me.rows}\"\r\n\r\n            ?block=\"${me.#isBlock}\"\r\n            ?beep=\"${me.#isBeep}\"\r\n            timeout=\"${me.#timeout()}\"\r\n\r\n            spellcheck=\"${ifDefined(me.spellcheck)}\" \r\n            wrap=\"${ifDefined(me.wrap)}\" \r\n            form=\"${ifDefined(me.form)}\" \r\n            name=\"${name}\" \r\n            value=\"${ifDefined(value)}\"\r\n            placeholder=\"${ifDefined(placeholder)}\"\r\n            title=\"${ifDefined(title)}\"\r\n    \r\n            class=\"${me.#cssField} ${me.cssField} ${me.#styleID}\" \r\n\r\n            autocomplete=\"${ifDefined(me.autocomplete)}\"\r\n            autocorrect=\"${ifDefined(me.autocorrect)}\"\r\n            autocapitalize=\"${ifDefined(me.autocapitalize)}\"\r\n\r\n            ?autofocus=\"${me.autofocus}\"            \r\n            ?readonly=\"${me.readonly}\"\r\n            ?required=\"${me.required}\"\r\n            ?disabled=\"${me.disabled}\"      \r\n      ></textarea>`;\r\n  }\r\n\r\n  #inputHTML(id, name, value) {\r\n    const me = this;\r\n    const type = me.isSwitch ? 'checkbox' : me.type;\r\n    let title = me.isRange ? me.value : me.title;\r\n    title = title ? me.translate(me.title, false) : title;\r\n\r\n    const placeholder = me.placeholder ? me.translate(me.placeholder, false) : null;\r\n    const description = me.description ? me.translate(me.description, false) : null;\r\n    \r\n    me.#initStyle();\r\n\r\n    return html`<input is=\"gs-ext-input\" \r\n            ${ref(me.#inputRef)}\r\n            id=${ifDefined(id)} \r\n            @input=\"${me.#onRange.bind(me)}\"\r\n            @change=\"${me.#onChange.bind(me)}\"\r\n            @blur=\"${me.#onBlur.bind(me)}\"\r\n            @invalid=\"${me.#onInvalid.bind(me)}\"\r\n        \r\n            name=\"${name}\" \r\n            type=\"${type}\" \r\n            form=\"${ifDefined(me.form)}\"\r\n            value=\"${ifDefined(value)}\"\r\n            title=\"${ifDefined(title)}\"\r\n\r\n            ?block=\"${me.#isBlock}\"\r\n            ?beep=\"${me.#isBeep}\"\r\n            timeout=\"${me.#timeout()}\"\r\n\r\n            class=\"${me.#cssField} ${me.cssField} ${me.#styleID}\" \r\n\r\n            placeholder=\"${ifDefined(placeholder)}\"\r\n            description=\"${ifDefined(description)}\"\r\n\r\n            .multipattern=\"${ifDefined(me.#patterns)}\"\r\n            mask=\"${ifDefined(me.mask)}\"\r\n            pattern=\"${ifDefined(me.pattern)}\"\r\n            list=\"${ifDefined(me.list)}\"\r\n            accept=\"${ifDefined(me.accept)}\"\r\n             \r\n            step=\"${ifDefined(me.step)}\"\r\n            min=\"${ifDefined(me.min)}\"\r\n            max=\"${ifDefined(me.max)}\"\r\n            lang=\"${ifDefined(me.lang)}\"\r\n\r\n            minlength=\"${ifDefined(me.minLength)}\"\r\n            maxlength=\"${ifDefined(me.maxLength)}\"\r\n\r\n            autocomplete=\"${ifDefined(me.autocomplete)}\"\r\n            autocorrect=\"${ifDefined(me.autocorrect)}\"\r\n            autocapitalize=\"${ifDefined(me.autocapitalize)}\"\r\n\r\n            ?autofocus=\"${me.autofocus}\"\r\n            ?autocopy=\"${me.autocopy}\"\r\n            ?autoselect=\"${me.autoselect}\"\r\n            ?multiple=\"${me.multiple}\"\r\n            ?checked=\"${me.checked}\"\r\n            ?readonly=\"${me.readonly}\"\r\n            ?required=\"${me.required}\"\r\n            ?disabled=\"${me.disabled}\"\r\n            ?reveal=\"${me.reveal}\"\r\n            >${me.#listHTML}`;\r\n  }\r\n\r\n  get #cssField() {\r\n    const me = this;\r\n    if (me.selectable) return 'form-select ms-0';\r\n    if (me.isCheckable) return 'form-check-input ms-0';\r\n    if (me.isRange) return 'form-range';\r\n    return 'form-control';\r\n  }\r\n\r\n  get #cssLabel() {\r\n    const me = this;\r\n    if (me.isCheckable) return 'form-check-label';\r\n    if (me.isFloating) return 'ms-2';\r\n    return me.isVertical ? 'form-label' : '';\r\n  }\r\n\r\n  get #cssCheck() {\r\n    const me = this;\r\n    if (me.isCheckable) {\r\n      //return me.#isSwitch ? 'form-check form-switch ps-3 fs-5' : 'form-check';\r\n      if (me.isSwitch) return 'form-check form-switch ps-3 fs-5';\r\n      return me.isFieldset ? '' : 'form-check';\r\n    }\r\n    return '';\r\n  }\r\n\r\n  get #cellField() {\r\n    const me = this;\r\n    const val = (me.isHorizontal) ? '6' : '11';\r\n    return me.cellField || `col-md-${val} col-sm-${val} col-xs-11`;\r\n  }\r\n\r\n  get #isIcon() {\r\n    return GSUtil.isStringNonEmpty(this.icon);\r\n  }\r\n\r\n  #onRange(e) { \r\n    this.emit('input', e);\r\n  }\r\n\r\n  #onBlur(e) {\r\n    this.emit('blur', e, true, true);\r\n  }\r\n\r\n  #onChange(e) {\r\n    const me = this;\r\n    if (me.isRange) me.value = e.target?.value;\r\n    me.emit('change', e, true, true);\r\n  }\r\n\r\n  #onInvalid(e) {\r\n    this.emit('invalid', e, true, true);\r\n  }\r\n\r\n  #validateAllowed() {\r\n    const me = this;\r\n    const slots = ['header', 'body', 'footer'];\r\n    let list = Array.from(me.children).filter(el => el.slot && !slots.includes(el.slot));\r\n    if (list.length > 0) throw new Error(`Custom element injection must contain slot=\"header|body|footer\" attribute! Element: ${me.tagName}, ID: ${me.id}`);\r\n    list = Array.from(me.children).filter(el => !el.slot);\r\n    const tagList = ['GS-ITEM', 'DATALIST'];\r\n    const allowed = GSDOM.isAllowed(list, tagList);\r\n    if (!allowed) throw new Error(GSDOM.toValidationError(me, tagList));\r\n  }\r\n\r\n  translate(value = '', sanitize) {\r\n    value = super.translate(value);\r\n    return sanitize? GSUtil.sanitize(value) : value;\r\n  }\r\n\r\n  get isFloating() {\r\n    return this.layout === 'floating';\r\n  }\r\n\r\n  get isHorizontal() {\r\n    return this.layout === 'horizontal';\r\n  }\r\n\r\n  get isVertical() {\r\n    return this.layout === 'vertical';\r\n  }\r\n\r\n  get isFieldset() {\r\n    const me = this;\r\n    return me.type === 'radio' && me.value?.includes(',');\r\n  }\r\n\r\n  get isCheckable() {\r\n    const me = this;\r\n    return me.isCheck || me.isRadio || me.isSwitch;\r\n  }\r\n\r\n  get isChecked() {\r\n    return this.field?.checked;\r\n  }\r\n\r\n  get isCheck() {\r\n    return this.type === 'checkbox';\r\n  }\r\n\r\n  get isRadio() {\r\n    return this.type === 'radio';\r\n  }\r\n\r\n  get isSwitch() {\r\n    return this.type === 'switch';\r\n  }\r\n\r\n  get isNumber() {\r\n    return this.type === 'number';\r\n  }\r\n\r\n  get isRange() {\r\n    return this.type === 'range';\r\n  }\r\n\r\n  get isText() {\r\n    return this.type === 'text';\r\n  }\r\n\r\n  get isPassword() {\r\n    return this.type === 'passsword';\r\n  }\r\n\r\n  get isEmail() {\r\n    return this.type === 'email';\r\n  }\r\n\r\n  get isURL() {\r\n    return this.type === 'url';\r\n  }\r\n\r\n  get isFile() {\r\n    return this.type === 'file';\r\n  }\r\n\r\n  get field() {\r\n    return this.#inputRef.value;\r\n  }\r\n\r\n  get formComponent() {\r\n    return GSDOM.closest(this, 'gs-form');\r\n  }\r\n\r\n  static {\r\n    this.define('gs-form-group');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, html, ifDefined, ref, repeat } from '../lib.mjs';\r\nimport { GSLog } from '../base/GSLog.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSFormGroupElement } from './FormGroup.mjs';\r\n\r\n// TODO: Make generic JSON to template generator, \r\n// then create string template and apply it to the lit html function.\r\n// Use all properties exstractor from super components and use type definition for bool proeprties.\r\n// Use xtype(#tagName) to define component type and use it to create component instance.\r\n\r\n/**\r\n * Component is responsible for auto-building gs-form and gs-form-group elements\r\n * from either JSON data or GS-ITEM elements.\r\n */\r\nexport class GSFormPanelElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    data: { type: Array },\r\n  }\r\n\r\n  #formRef = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    this.data = this.#proxify;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const data = me.data || {};\r\n    const items = me.data?.items || [];\r\n    return html`<gs-form ${ref(me.#formRef)}\r\n\r\n      .storage=\"${ifDefined(data.storage)}\" \r\n      ?disabled=${ifDefined(data.disabled)}.\r\n      .data=\"${ifDefined(data.data)}\"\r\n      \r\n      .name=\"${ifDefined(data.name)}\"\r\n      .rel=\"${ifDefined(data.rel)}\"\r\n      .acceptCharset=\"${ifDefined(data.acceptCharset)}\"\r\n      .autocapitalize=\"${ifDefined(data.autocapitalize)}\"\r\n      .autocomplete=\"${ifDefined(data.autocomplete)}\"\r\n\r\n      .action=\"${ifDefined(data.action)}\"\r\n      .enctype=\"${ifDefined(data.enctype)}\"\r\n      .method=\"${ifDefined(data.method)}\"\r\n      ?novalidate=\"${ifDefined(data.novalidate)}\"\r\n      .target=\"${ifDefined(data.target)}\"\r\n\r\n      ?block=\"${ifDefined(data.block)}\"\r\n      ?beep=\"${ifDefined(data.beep)}\"\r\n      .timeout=\"${ifDefined(data.timeout)}\"\r\n\r\n      ?flat=\"${ifDefined(data.flat)}\"\r\n      ?rtl=\"${ifDefined(data.rtl)}\"\r\n      ?hide=\"${ifDefined(data.hide)}\"\r\n      ?padding=\"${ifDefined(data.padding)}\"\r\n      ?margin=\"${ifDefined(data.margin)}\"\r\n      ?rounded=\"${ifDefined(data.rounded)}\"\r\n      ?bordered=\"${ifDefined(data.bordered)}\"\r\n      ?shadow=\"${ifDefined(data.shadow)}\"\r\n      ?keep=\"${ifDefined(data.keep)}\"\r\n      .css=\"${ifDefined(data.css)}\"\r\n      .theme=\"${ifDefined(data.theme)}\"\r\n      .os=\"${ifDefined(data.os)}\"\r\n      .browser=\"${ifDefined(data.browser)}\"\r\n      .language=\"${ifDefined(data.language)}\"\r\n      .environment=\"${ifDefined(data.environment)}\"\r\n      .orientation=\"${ifDefined(data.orientation)}\"\r\n      .protocol=\"${ifDefined(data.protocol)}\"\r\n      .template=\"${ifDefined(data.template)}\"      \r\n      >\r\n      <slot>\r\n        ${repeat(items, (item) => me.#renderFormGroup(me.data, item))}\r\n      </slot>\r\n    </gs-form>`;\r\n  }\r\n\r\n  #renderFormGroup(definition, item) {\r\n    return html`<gs-form-group \r\n      .icon=\"${ifDefined(item.icon)}\"\r\n      .layout=\"${ifDefined(item.layout)}\"\r\n      .placement=\"${ifDefined(item.placement)}\"\r\n\r\n      .label=\"${ifDefined(item.label)}\"\r\n      .description=\"${ifDefined(item.description)}\"\r\n      .placeholder=\"${ifDefined(item.placeholder)}\"\r\n      \r\n      .pattern=\"${ifDefined(item.pattern)}\"\r\n      .mask=\"${ifDefined(item.mask)}\"\r\n\r\n      .form=\"${ifDefined(item.form)}\"\r\n      .formaction=\"${ifDefined(item.formaction)}\"\r\n      .formenctype=\"${ifDefined(item.formenctype)}\"\r\n      .formmethod=\"${ifDefined(item.formmethod)}\"\r\n      .formnovalidate=\"${ifDefined(item.formnovalidate)}\"\r\n      .formtarget=\"${ifDefined(item.formtarget)}\"\r\n      .wrap=\"${ifDefined(item.wrap)}\"\r\n      .spellcheck=\"${ifDefined(item.spellcheck)}\"\r\n\r\n      .type=\"${ifDefined(item.type)}\"\r\n      .name=\"${ifDefined(item.name)}\"\r\n      .list=\"${ifDefined(item.list)}\"\r\n      .accept=\"${ifDefined(item.accept)}\"\r\n      .value=\"${ifDefined(item.value)}\"\r\n      \r\n      .lang=\"${ifDefined(item.lang)}\"\r\n      .title=\"${ifDefined(item.title)}\"\r\n      .cols=\"${ifDefined(item.cols)}\"\r\n      .rows=\"${ifDefined(item.rows)}\"\r\n      .step=\"${ifDefined(item.step)}\"\r\n      .min=\"${ifDefined(item.min)}\"\r\n      .max=\"${ifDefined(item.max)}\"\r\n      .maxlength=\"${ifDefined(item.maxlength)}\"\r\n      .minlength=\"${ifDefined(item.minlength)}\"\r\n\r\n      ?reverse=\"${ifDefined(item.reverse)}\"\r\n      ?selectable=\"${ifDefined(item.selectable)}\"\r\n\r\n      ?autoid=\"${ifDefined(item.autoid)}\"\r\n      ?autocopy=\"${ifDefined(item.autocopy)}\"\r\n      ?autoselect=\"${ifDefined(item.autoselect)}\"\r\n\r\n      .autocapitalize=\"${ifDefined(item.autocapitalize)}\"\r\n      .autocorrect=\"${ifDefined(item.autocorrect)}\"\r\n      .autocomplete=\"${ifDefined(item.autocomplete)}\"\r\n\r\n      ?autofocus=\"${ifDefined(item.autofocus)}\"\r\n      ?autoselect=\"${ifDefined(item.autoselect)}\"\r\n\r\n      ?disabled=\"${ifDefined(item.disabled)}\"\r\n      ?checked=\"${ifDefined(item.checked)}\"\r\n      ?multiple=\"${ifDefined(item.multiple)}\"\r\n      ?reveal=\"${ifDefined(item.reveal)}\"\r\n      ?readonly=\"${ifDefined(item.readonly)}\"\r\n      ?required=\"${ifDefined(item.required)}\"\r\n\r\n      .invalidMessage=\"${ifDefined(item.invalidMessage)}\"  \r\n      \r\n      ?block=\"${ifDefined(item.block || definition.block)}\"\r\n      ?beep=\"${ifDefined(item.beep || definition.beep)}\"\r\n      ?timeout=\"${ifDefined(item.timeout || definition.timeout)}\"\r\n\r\n      ?flat=\"${ifDefined(item.flat)}\"\r\n      ?rtl=\"${ifDefined(item.rtl)}\"\r\n      ?hide=\"${ifDefined(item.hide)}\"\r\n      ?padding=\"${ifDefined(item.padding)}\"\r\n      ?margin=\"${ifDefined(item.margin)}\"\r\n      ?rounded=\"${ifDefined(item.rounded)}\"\r\n      ?bordered=\"${ifDefined(item.bordered)}\"\r\n      ?shadow=\"${ifDefined(item.shadow)}\"\r\n      ?keep=\"${ifDefined(item.keep)}\"\r\n      .css=\"${ifDefined(item.css)}\"\r\n      .theme=\"${ifDefined(item.theme)}\"\r\n      .os=\"${ifDefined(item.os)}\"\r\n      .browser=\"${ifDefined(item.browser)}\"\r\n      .language=\"${ifDefined(item.language || definition.language)}\"\r\n      .environment=\"${ifDefined(item.environment)}\"\r\n      .orientation=\"${ifDefined(item.orientation)}\"\r\n      .protocol=\"${ifDefined(item.protocol)}\"\r\n      .template=\"${ifDefined(item.template)}\">\r\n      </gs-form-group>`;\r\n  }\r\n\r\n  get form() {\r\n    return this.#formRef.value;\r\n  }\r\n\r\n  onDataRead(data) {\r\n    this.data = data;\r\n  }\r\n\r\n  onDataError(e) {\r\n    GSLog.error(this, e);\r\n  }\r\n\r\n  get #proxify() {\r\n    return GSItem.collect(this).map(el => GSAttr.proxify(el, GSFormGroupElement.properties));\r\n  }\r\n\r\n  static {\r\n    this.define('gs-form-panel');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSGroupElement class\r\n * @module components/GSGroupElement\r\n */\r\n\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSAttributeHandler } from '../base/GSAttributeHandler.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { ElementNavigationController } from '../controllers/ElementNavigationController.mjs';\r\nimport { GroupController } from '../controllers/GroupController.mjs';\r\nimport { classMap, createRef, html, render, ifDefined, ref } from '../lib.mjs';\r\n\r\n/**\r\n * Renderer for grouped elements such as Buttons, Navs, Tabs and lists.\r\n * Components handles grouped elements navigation, selection and focus.\r\n * \r\n * @class\r\n * @extends { GSElement }\r\n */\r\nexport class GSGroupElement extends GSElement {\r\n\r\n  static properties = {\r\n    // multiple lists with single select across \r\n    group : {},\r\n    storage: {},    \r\n    circular: { type: Boolean },\r\n    multiple: { type: Boolean },\r\n    data: { type: Array },\r\n  }\r\n\r\n  #elRef = createRef();\r\n  #controller;\r\n  #controllerGroup;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.data = me.initData();\r\n    me.#controller = new ElementNavigationController(me);\r\n    me.#controllerGroup = new GroupController(me);\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    const me = this;\r\n    // allow single setting at the container component to apply to the child\r\n    Array.from(me.children).forEach(it => {\r\n      GSAttributeHandler.clone(me, it, false);\r\n    });\r\n  }  \r\n\r\n\r\n  #prerender() {\r\n    const me = this;\r\n    me.queryAll('[generated]').forEach(el => el.remove());\r\n    if (me.data.length > 0) {\r\n      const items = me.renderItems();\r\n      const tpl = document.createElement('template');\r\n      render(items, tpl);\r\n      Array.of(...tpl.children).forEach(el => GSDOM.appendChild(me, el));\r\n    }\r\n  }\r\n  \r\n  firstUpdated(changed) {\r\n    const me = this;\r\n    me.#controller.init();\r\n    me.#controller.attach(me.#elRef.value);\r\n    super.firstUpdated(changed);\r\n    //me.#prerender();\r\n  }  \r\n\r\n  willUpdate(changed) {\r\n    const me = this;\r\n    if (changed.has('data')) {      \r\n      me.#prerender();\r\n    }\r\n    super.willUpdate(changed);\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div ${ref(me.#elRef)} \r\n      dir=\"${ifDefined(me.direction)}\"\r\n      class=\"${classMap(me.renderClass())}\">\r\n      ${me.renderWrappedUI()}\r\n      </div>`;\r\n  }\r\n\r\n  renderWrappedUI(name) {\r\n    const me = this;\r\n    return html`<div \r\n      class=\"${classMap(me.renderWrappedClass())}\">\r\n      <slot name=\"${ifDefined(name)}\"></slot>\r\n      </div>`;\r\n  }\r\n\r\n  renderWrappedClass() {\r\n    return {};\r\n  }\r\n\r\n  renderItems() {\r\n    return '';\r\n  }\r\n\r\n  initData() {\r\n    return this.settings(GSItem);\r\n  }\r\n\r\n  previous() {\r\n    this.#controller.previous();\r\n  }\r\n\r\n  next() {\r\n    this.#controller.next();\r\n  }\r\n\r\n  /**\r\n   * Reset focus / selection\r\n   */\r\n  reset() {\r\n    this.#controller.reset();\r\n  }\r\n\r\n  /**\r\n   * Element navigation filter where we can select if focused element is navigable\r\n   * @param {*} el \r\n   * @returns \r\n   */\r\n  isNavigable(el) {\r\n    return el?.tagName === this.childTagName;\r\n  }\r\n\r\n  onDataRead(data) {\r\n    this.data = data;\r\n  }\r\n\r\n  onBusEvent(e) {\r\n    let owner, item;  \r\n    ({owner, item} = e.detail);\r\n    if (owner != this) {\r\n      if (!item?.disabled || owner?.selectable) {\r\n        this.reset();\r\n      }\r\n    }\r\n  }\r\n  \r\n  onSelected(el) {\r\n    this.#controllerGroup.notify(el);\r\n  }\r\n\r\n  get focused() {\r\n    return this.#controller.focused;\r\n  }\r\n\r\n  get selected() {\r\n    return this.#controller.selected;\r\n  }\r\n\r\n  get childTagName() {\r\n    return '';\r\n  }\r\n    \r\n  get items() {\r\n    const me = this;\r\n    return me.queryAll(me.childTagName);\r\n  }\r\n\r\n  get generated() {\r\n    const me = this;\r\n    return this.queryAll(`${me.childTagName}[generated]`);\r\n  }\r\n\r\n  get active() {\r\n    const me = this;\r\n    if (me.multiple) return me.queryAll(`${me.childTagName}[active]`);\r\n    return me.query(`${me.childTagName}[active]`);\r\n  }\r\n\r\n  settings(el) {\r\n    const tagName = customElements.getName(el)?.toUpperCase() || 'GS-ITEM';\r\n    const cfg = GSElement.allProperties(el);\r\n    const items = Array.from(this.children).filter(e => e.tagName === tagName ).map(el => GSAttr.proxify(el, cfg));\r\n    const active = items.filter(el => el.active);\r\n    active.forEach((el, idx) => el.active = idx === 0);\r\n    return items;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-group');\r\n  }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, css, html, ifDefined, createRef, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { notEmpty, numGT0 } from '../properties/index.mjs';\r\nimport { color } from '../properties/color.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\nexport class GSIconElement extends GSElement {\r\n\r\n  static styles = css`\r\n    :host {\r\n      --gs-icon-super-color : cornflowerblue;\r\n      --gs-icon-content : '';\r\n    }\r\n    i::after {\r\n      top: -8px;\r\n      font-size: 0.7em;\r\n      position: relative;\r\n      content: var(--gs-icon-content);\r\n      content: attr(data-super);\r\n      color: var(--gs-icon-super-color);\r\n    }`;\r\n\r\n  static properties = {\r\n    name: { reflect: true, hasChanged: notEmpty },\r\n    size: { reflect: true, type: Number, hasChanged: numGT0 },\r\n    color: { reflect: true, ...color },\r\n    superColor: { attribute : 'super-color'},\r\n    super: { reflect: true },\r\n    clickCss: { attribute : 'click-css'},\r\n    hoverCss: { attribute : 'hover-css'},\r\n    _clicked: { attribute:false},\r\n    _hovered: { attribute:false},\r\n  }\r\n\r\n  #ref = createRef();\r\n  \r\n  constructor() {\r\n    super();\r\n    //this.flat = true;\r\n  }\r\n\r\n  /*\r\n  firstUpdated() {\r\n    super.firstUpdated();\r\n    this.#embdeded = GSDOM.matches(this.parentComponent, '[icon]');\r\n  }\r\n  */\r\n\r\n  updated(changed) {\r\n    if (changed.has('_clicked')) {\r\n      if (this._clicked) this.#postAnimate();\r\n    } \r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    me.setCSSProperty(':host', '--gs-icon-super-color', me.superColor);\r\n    return html`<i  ${ref(me.#ref)}\r\n       class=\"bi ${classMap(me.renderClass())}\"\r\n       data-super=\"${ifDefined(me.super)}\"\r\n       @click=\"${me.animate}\"\r\n       @mouseover=\"${me.#onMouseOver}\"\r\n       @mouseout=\"${me.#onMouseOut}\"></i>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      [`text-${me.color}`]: me.color,\r\n      [`bi-${me.name}`]: me.name,\r\n      'fs': me.size > 0,\r\n      [`fs-${me.size}`]: me.size > 0,\r\n      [me.clickCss]: me._clicked,\r\n      [me.hoverCss]: me._hovered,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  async #postAnimate() {\r\n    const me = this;\r\n    const delay = GSUtil.asNum(me.dataset.delay, 1);\r\n    if (delay > 0) {\r\n      await GSUtil.timeout(delay * 1000);\r\n      me._clicked = false;\r\n    }    \r\n  }\r\n\r\n  #onMouseOver(e) {\r\n    this.hover(true);\r\n  }\r\n\r\n  #onMouseOut(e) {\r\n    this.hover(false);\r\n  }\r\n\r\n  animate() {\r\n    const me = this;\r\n    me._hovered = false;\r\n    me._clicked = true;\r\n  }\r\n\r\n  hover(sts = false) {\r\n    const me = this;\r\n    if (sts) {\r\n      me._clicked = false;\r\n    }\r\n    me._hovered = sts;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-icon');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { css, html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { numGT0 } from '../properties/index.mjs';\r\n\r\nexport class GSIndentElement extends GSElement {\r\n\r\n  static styles = css`.indent {\r\n      --gs-indent : 10px;\r\n      margin-left: var(--gs-indent);\r\n      margin-right: var(--gs-indent);\r\n    }`;\r\n\r\n  static properties = {\r\n    flat: { type: Boolean },\r\n    size: { type: Number, hasChanged: numGT0 },\r\n    multiplier: { type: Number, hasChanged: numGT0 }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.size = 1;\r\n    me.multiplier = 10;\r\n  }\r\n\r\n  renderUI() {\r\n    const size = this.size * this.multiplier;\r\n    return html`<span class=\"indent\" style=\"--gs-indent: ${size}px;\"></span>`;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-indent');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, html, ifDefined, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { notEmpty, numGE0 } from '../properties/index.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\nconst numdef = { reflect: true, type: Number, hasChanged: numGE0 };\r\n\r\nexport class GSImageElement extends GSElement {\r\n\r\n  static properties = {\r\n    src: { hasChanged: notEmpty },\r\n    width: numdef,\r\n    height: numdef,\r\n    opacity: numdef,\r\n    invert: numdef,\r\n    grayscale: numdef,\r\n    brightness: numdef,\r\n    blur: numdef,\r\n    contrast: numdef,\r\n    saturate: numdef,\r\n    hue: numdef,\r\n    sepia: numdef,\r\n\r\n    alt: {},\r\n    loading: {}\r\n\r\n  }\r\n\r\n  #imageRef = createRef();\r\n  #styleID = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    this.dynamicStyle(this.#styleID);\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    this.#update();\r\n    return this.src;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<img ${ref(me.#imageRef)} \r\n            @load=\"${me.#onLoad}\"\r\n            src=\"${me.src}\" \r\n            alt=\"${me.alt}\" \r\n            loading=\"${ifDefined(me.loading)}\" \r\n            class=\"${me.#styleID}\" \r\n            data-gs-class=\"${me.#styleID}\">\r\n          </img>`;\r\n  }\r\n\r\n  get complete() {\r\n    return this.#imageRef.value?.complete || false;\r\n  }\r\n\r\n  get #dynamic() {\r\n    return this.dynamicStyle(this.#styleID).style;\r\n  }\r\n\r\n  #renderStyle() {\r\n    const me = this;\r\n    const filter = me.#buildFilter();\r\n    const css = {\r\n      width: me.width > 0 ? me.width : undefined,\r\n      height: me.height > 0 ? me.height : undefined,\r\n      filter: filter.length > 0 ? filter.join(' ') : ''\r\n    }\r\n    return css;\r\n  }\r\n\r\n  #buildFilter() {\r\n    const me = this;\r\n    const o = [];\r\n\r\n    if (me.blur > 0) o.push(`blur(${me.blur}px)`);\r\n    if (me.invert > 0) o.push(`invert(${me.invert})`);\r\n    if (me.opacity > 0) o.push(`opacity(${me.opacity})`);\r\n    if (me.contrast > 0) o.push(`contrast(${me.contrast})`);\r\n    if (me.grayscale > 0) o.push(`grayscale(${me.grayscale})`);\r\n    if (me.brightness > 0) o.push(`brightness(${me.brightness})`);\r\n\r\n    if (me.hue > 0) o.push(`hue-rotate(${me.hue}deg)`);\r\n    if (me.sepia > 0) o.push(`sepia(${me.sepia}%)`);\r\n    if (me.saturate > 0) o.push(`saturate(${me.saturate}%)`);\r\n\r\n    return o;\r\n  }\r\n\r\n  #update() {\r\n    const me = this;\r\n    const dynamic = me.#dynamic;\r\n    dynamic.filter = me.#buildFilter().join(' ').trim();\r\n    dynamic.width = me.width > 0 ? `${me.width}px` : '';\r\n    dynamic.height = me.height > 0 ? `${me.height}px` : '';\r\n  }\r\n\r\n  #onLoad(e) {\r\n    const el = e.target;\r\n    const me = this;\r\n    if (el) {\r\n      me.height = me.height || el.height;\r\n      me.width = me.width || el.width;\r\n      me.emit('loaded', { width: el.width, height: el.height, element: el }, true);\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-image');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSLayout class\r\n * @module components/GSLayoutElement\r\n */\r\n\r\nimport { classMap, html, ifDefined, templateContent } from '../lib.mjs';\r\nimport { orientation, OrientationTypes } from '../properties/orientation.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\n\r\n/**\r\n * Renderer for panel layout \r\n * @class\r\n * @extends {Component}\r\n */\r\nexport class GSLayoutElement extends GSElement {\r\n\r\n    static properties = {\r\n        type: { ...orientation }\r\n    }\r\n\r\n    // GS-ITEM attributes mapping\r\n    static options = {\r\n        id : {},\r\n        type: {},\r\n        min: { type: Number },\r\n        max: { type: Number },\r\n        size: { type: Number },\r\n        resizable: { type: Boolean },\r\n        autofit: { type: Boolean },\r\n        vPos: { attribute: 'h-pos' },\r\n        hPos: { attribute: 'v-pos' },\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;\r\n        me.autofit = true;  \r\n        me.#items(me).map((el, idx, els) => me.#dyncss(el, idx, els, 0));\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        if ( this.autofit && GSDOM.root(this) === document.body) document.body.classList.add('vh-100');\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        const list = me.#items(me).map((el, idx, els) => me.#build(el, idx, els));\r\n        return html`<div  dir=\"${ifDefined(me.direction)}\" class=\"d-flex flex-fill w-100 h-100 ${classMap(me.renderClass())}\">${list}</div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const horizontal = OrientationTypes.isHorizontal(me.type);\r\n        return {\r\n            ...super.renderClass(),\r\n            'flex-column': horizontal\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Proxify GS-ITEM elements to easily read attributes\r\n     */\r\n    #items(root) {\r\n        return GSItem.collect(root).map(el => GSAttr.proxify(el, GSLayoutElement.options));\r\n    }\r\n\r\n    #resizable(el) {\r\n        return el.size > 0 || el.min > 0 || el.max > 0 || el.resizable;\r\n    }\r\n\r\n    #dyncss(el, idx, els, lev = 0) {\r\n        const me = this;\r\n        me.#items(el.self).map((it, idx, items) => me.#dyncss(it, idx, items, lev+1));\r\n        if(me.#resizable(el)) me.dynamicStyle(`gsd-${lev}-${idx}`);\r\n    }\r\n\r\n    #build(el, idx, els, lev = 0) {\r\n\r\n        const me = this;\r\n        const type = el.self.parentElement.type || 'vertical';\r\n\r\n        const list = me.#items(el.self).map((it, idx, items) => me.#build(it, idx, items, lev+1));\r\n        \r\n        const min = el.min;\r\n        const max = el.max;\r\n        const template = el.template;\r\n        const tplEl = me.#elementTemplate(el);\r\n\r\n        const tc = `#${tplEl?.id}` !== template;\r\n\r\n        const dir = el.type || type || 'vertical';\r\n        const horizontal = OrientationTypes.isHorizontal(dir);\r\n        \r\n        const col = list.length > 0 && horizontal ? 'flex-column' : '';\r\n\r\n        const did = `gsd-${lev}-${idx}`;\r\n        const css = me.#panelCSS(el, col, did);\r\n        const style = me.#panelStyle(el, horizontal);\r\n        me.dynamicStyle(did, style);\r\n\r\n        const slot = el.name ? html`<slot name=\"${el.name}\"></slot>` : '';\r\n        const src = html`<div id=\"${ifDefined(el.id)}\" class=\"d-flex ${classMap(css)}\">\r\n            ${list}\r\n            ${templateContent(tplEl)}\r\n            ${template && tc ? html`<gs-template flat src=\"${template}\"></gs-template>` : ''}\r\n            ${slot}\r\n            </div>`;\r\n\r\n        if (!el.resizable) return src;\r\n\r\n        const resize = (idx === els.length - 1) ? 'end' : 'start';\r\n        const splitter = me.#splitter(min, max, type, resize);\r\n\r\n        if (idx === els.length - 1) return [splitter , src];\r\n        return [src, splitter];\r\n    }\r\n    \r\n    #elementTemplate(el) {\r\n        const tplEl = el.self.firstElementChild;\r\n        return tplEl instanceof HTMLTemplateElement ? tplEl : undefined;\r\n    }\r\n\r\n    #panelCSS(el, col, did) {\r\n\r\n        const resizable = this.#resizable(el);\r\n        const grow = resizable ? '' : 'flex-grow-1';\r\n\r\n        let vpos = el.vPos;\r\n        let hpos = el.hPos;\r\n\r\n        hpos = hpos ? `align-items-${hpos}` : '';\r\n        vpos = vpos ? `justify-content-${vpos}` : '';\r\n\r\n        const css = this.mapCSS(el.css, {\r\n            [did] : resizable,\r\n            [col] : col,\r\n            [grow] : grow,\r\n            [hpos] : hpos,\r\n            [vpos] : vpos\r\n        });\r\n    \r\n        return css;        \r\n    }\r\n\r\n    #panelStyle(el, horizontal) {\r\n        const min = el.size || el.min;\r\n        const max = el.max || el.size;\r\n        const style = {};\r\n        if (horizontal) {\r\n            style['min-height'] = min > 0 ? `${min}px` : undefined;\r\n            style['max-height'] = max > 0 ? `${max}px` : undefined;\r\n        } else {\r\n            style['min-width'] = min > 0 ? `${min}px` : undefined;\r\n            style['max-width'] = max > 0 ? `${max}px` : undefined;\r\n        }\r\n        return style;        \r\n    }\r\n\r\n    #splitter(min, max, dir, resize) {\r\n        return html`<gs-splitter split=\"${dir}\" resize=\"${resize}\" min=\"${min}\" max=\"${max}\"></gs-splitter>`;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-layout');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, ifDefined, html, createRef, ref } from '../lib.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color } from '../properties/index.mjs';\r\nimport { dataset } from '../directives/dataset.mjs';\r\n\r\nexport class GSLinklement extends GSElement {\r\n\r\n  static properties = {\r\n    clickCss: { attribute : 'click-css'},\r\n    hoverCss: { attribute : 'hover-css'},\r\n    autofocus: { type: Boolean },\r\n    disabled: { type: Boolean, reflect: true },\r\n    size: { type: Number },\r\n    text: { ...color },\r\n    color: { ...color },\r\n    url: {},\r\n    ping: {},\r\n    icon: {},\r\n    title: {},\r\n    tooltip: {},\r\n    target: {}\r\n  };\r\n\r\n  #refEl = createRef();\r\n  #refIco = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    this.url = '#';\r\n    // this.text = 'primary'; // do not set as default -> gs-dropdown\r\n    // this.target = '_blank'; // not used \r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    if (this.autofocus && !this.disabled) this.focus();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`\r\n      <a ${ref(me.#refEl)}  \r\n        dir=\"${ifDefined(me.direction)}\"\r\n        title=\"${ifDefined(me.translate(me.tooltip))}\" \r\n        href=\"${ifDefined(me.url)}\" \r\n        ping=\"${ifDefined(me.ping)}\" \r\n        target=\"${ifDefined(me.target)}\"\r\n        class=\"${classMap(me.renderClass())}\" \r\n        ?disabled=${me.disabled} \r\n        @mouseover=\"${me.#onMouseOver}\"\r\n        @mouseout=\"${me.#onMouseOut}\"        \r\n        @click=\"${me.#onClick}\">\r\n        ${me.#first}${me.#second}\r\n        </a>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'active': me.active,      \r\n      [`fs-${me.size}`]: me.size > 0,\r\n      [`text-${me.text}`]: me.text,\r\n      [`bg-${me.color}`]: me.color\r\n    }\r\n    return css;\r\n  }\r\n\r\n  click() {\r\n    this.#refEl.value?.click();\r\n  }\r\n\r\n  focus() {\r\n    requestAnimationFrame(() => this.#refEl.value?.focus());\r\n  }\r\n\r\n  get iconEl() {\r\n    return this.#refIco.value;\r\n  }\r\n\r\n  #onClick(e) {\r\n    const me = this;\r\n    me.iconEl?.animate();\r\n    me.notify();\r\n    if (me.url === '#' || GSUtil.isStringEmpty(me.url)) {\r\n      GSEvents.prevent(e);\r\n      me.handle(e);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  #onMouseOver() {\r\n    this.iconEl?.hover(true);\r\n  }\r\n\r\n  #onMouseOut() {\r\n    this.iconEl?.hover(false);\r\n  }\r\n\r\n  get #title() {\r\n    return this.translate(this.title);\r\n  }\r\n\r\n  get #first() { return this.rtl ? this.#title : this.#iconHtml; };\r\n\r\n  get #second() { return this.rtl ? this.#iconHtml : this.#title; };\r\n\r\n  get #iconHtml() { return this.icon ? this.#renderIcon : html`<slot name=\"icon\"></slot>`; }\r\n\r\n  get #renderIcon() {\r\n    return  html`\r\n    <gs-icon css=\"mx-1\" ${ref(this.#refIco)} \r\n    name=\"${this.icon}\" \r\n    size=\"${this.size}\" \r\n    click-css=\"${ifDefined(this.clickCss)}\" \r\n    hover-css=\"${ifDefined(this.hoverCss)}\" \r\n    data-delay=\"1\"></gs-icon>`;\r\n  }\r\n\r\n  /**\r\n   * Generate clickable link\r\n   * @param {*} options \r\n   * @param {*} css \r\n   * @param {*} before \r\n   * @param {*} after \r\n   * @returns \r\n   */\r\n  static generate(options, css, before, after) {\r\n    const opt = options;\r\n    return html`<a class=\"${classMap(css)}\"\r\n        tabindex=\"0\"    \r\n        ${dataset(opt, true)}\r\n        part=\"${ifDefined(opt.part)}\"\r\n        tooltip=\"${ifDefined(opt.tooltip)}\"\r\n        href=\"${ifDefined(opt.url)}\">        \r\n        ${before || ''}\r\n        ${ifDefined(opt.title)}\r\n        <slot></slot> \r\n        ${after || ''}\r\n    </a>`;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-link');\r\n  }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { html, ifDefined } from '../lib.mjs';\r\nimport { GSGroupElement } from './Group.mjs';\r\n\r\nexport class GSListElement extends GSGroupElement {\r\n\r\n  static properties = {\r\n    selectable: { reflect: true, type: Boolean }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.circular = false;\r\n    this.multiple = false;\r\n    this.selectable = false;\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    return this.data.length > 0 || this.items.length > 0;\r\n  }\r\n\r\n  renderClass() {\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'list-group': true,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  renderWrappedUI() {\r\n    return html`<slot></slot>`;\r\n  }\r\n\r\n  reset() {\r\n    this.items.forEach(el => el.reset());\r\n    this.notify();\r\n  }\r\n\r\n  renderItems() {    \r\n    return this.data.map(o => {\r\n      return html`<gs-list-item generated\r\n        .active=\"${ifDefined(o.active === true)}\"\r\n        .autofocus=\"${ifDefined(o.autofocus === true)}\"\r\n        .disabled=\"${ifDefined(o.disabled === true)}\" \r\n        icon=\"${ifDefined(o.icon)}\" \r\n        href=\"${ifDefined(o.href)}\" \r\n        target=\"${ifDefined(o.target)}\" \r\n        title=\"${ifDefined(o.title)}\"></gs-list-item>`;\r\n    });\r\n  }\r\n\r\n  isNavigable(el) {\r\n    return super.isNavigable(el) && this.selectable;\r\n  }\r\n\r\n  get childTagName() {\r\n    return 'GS-LIST-ITEM';\r\n  }\r\n\r\n  static {\r\n    this.define('gs-list');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, ifDefined, html, createRef, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\nexport class GSListItemElement extends GSElement {\r\n\r\n  static properties = {\r\n    url: {},\r\n    target: {},\r\n    title: {},\r\n    icon: {},\r\n    size: { type: Number },\r\n    autofocus: { type: Boolean, reflect: true },\r\n    disabled: { type: Boolean, reflect: true },\r\n    active: { type: Boolean, reflect: true }\r\n  }\r\n\r\n  #initial;\r\n  #refEl = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    this.binded();\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    this.#initial = this.active;\r\n  }\r\n\r\n  shouldUpdate(changedProperties) {\r\n    return this.parentComponent?.tagName === 'GS-LIST';\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n        // allow single setting at the gs-list to apply to the child\r\n        // GSAttributeHandler.clone(this.parentComponent, this, false);\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<a  tabindex=\"0\" ${ref(me.#refEl)}\r\n       href=\"${ifDefined(me.href)}\" \r\n       target=\"${ifDefined(me.target)}\" \r\n       class=\"${classMap(me.renderClass())}\">\r\n        ${me.#renderFirst()} \r\n        ${me.#renderSecond()}\r\n        <slot>${me.renderTemplate()}</slot>\r\n      </a>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'list-group-item': true,\r\n      'list-group-item-action': true,\r\n      [`fs-${me.size}`]: me.size > 0,\r\n      [me.#itemCSS] : true,\r\n      'active': me.active && me.isSelectable()\r\n    }\r\n    return me.mapCSS(me.#itemStatusCSS, css);\r\n  }\r\n\r\n  isSelectable() {\r\n    return !GSUtil.asBool(this.disabled) || GSUtil.asBool(this.parentComponent.selectable);\r\n  }\r\n\r\n  #renderIcon() {\r\n    const me = this;\r\n    return me.icon ? html`<gs-icon name=\"${me.icon}\" size=\"${me.size}\"></gs-icon>` : html`<slot name=\"icon\"></slot>`;\r\n  }\r\n\r\n  #renderText() {\r\n    return this.title ? html`<span>${this.translate(this.title)}</span>` : html`<slot name=\"title\"></slot>`;\r\n  }\r\n\r\n  #renderFirst() {\r\n    return this.rtl ? this.#renderText() : this.#renderIcon();\r\n  }\r\n\r\n  #renderSecond() {\r\n    return this.rtl ? this.#renderIcon() : this.#renderText();\r\n  }\r\n\r\n  toggle() {\r\n    this.active = !this.active;\r\n  }\r\n\r\n  reset() {\r\n    this.active = this.autofocus || this.#initial || false;\r\n  }\r\n\r\n  click() {\r\n    this.#refEl.value?.click();\r\n  }\r\n\r\n  focus() {\r\n    requestAnimationFrame(() => this.#refEl.value?.focus());\r\n  }\r\n\r\n  get href() {\r\n    return this.url ? this.url : '#';\r\n  }\r\n\r\n  get #activeCSS() {\r\n    return this.parentComponent.dataset?.cssActive || '';\r\n  }\r\n\r\n  get #inactiveCSS() {\r\n    return this.parentComponent.dataset?.cssInactive || '';\r\n  }\r\n\r\n  get #itemCSS() {\r\n    return this.parentComponent.dataset?.cssItem || '';\r\n  }\r\n\r\n  get #itemStatusCSS() {\r\n    return this.active && this.isSelectable() ? this.#activeCSS : this.#inactiveCSS;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-list-item');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\n/**\r\n * For debugging purposes for floating element such as popup, popover, menus... \r\n * https://developer.mozilla.org/en-US/docs/Web/CSS/CSSOM_view/Coordinate_systems\r\n */\r\nexport class GSMouseElement extends GSElement {\r\n\r\n  static properties = {\r\n    pageX: { type: Number },\r\n    pageY: { type: Number },\r\n    screenX: { type: Number },\r\n    screenY: { type: Number },\r\n    clientX: { type: Number },\r\n    clientY: { type: Number },       \r\n    offsetX: { type: Number },       \r\n    offsetY : { type: Number }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    this.attachEvent(window, 'mousemove', this.#onMouse.bind(this));\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`\r\n    Offset(${me.offsetX}, ${me.offsetY}) \r\n    Viewport(${me.clientX}, ${me.clientY}) \r\n    Page(${me.pageX}, ${me.pageY}) \r\n    Screen(${me.screenX}, ${me.screenY})`;\r\n  }\r\n\r\n  #onMouse(e) {\r\n    const me = this;\r\n    me.offsetX = e.offsetX;\r\n    me.offsetY = e.offsetY;\r\n    me.clientX = e.clientX;\r\n    me.clientY = e.clientY;\r\n    me.pageX = e.pageX;\r\n    me.pageY = e.pageY;\r\n    me.screenX = e.screenX;\r\n    me.screenY = e.screenY;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-mouse');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, css, html, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color } from '../properties/color.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\n/**\r\n * This component allow moving contained elements acroos UI\r\n */\r\nexport class GSMovableElement extends GSElement {\r\n\r\n  static styles = css`\r\n  :host {\r\n      --gs-width : inherited;\r\n      --gs-height : inherited;\r\n      --gs-min-width: inherited;\r\n      --gs-max-width: inherited;\r\n      --gs-min-height: inherited;\r\n      --gs-max-height: inherited;\r\n  }\r\n  .gs-movable {\r\n    left: var(--mouse-x) !important;\r\n    top: var(--mouse-y) !important;\r\n   }`;\r\n\r\n  static properties = {\r\n    shadow: { type: Boolean},\r\n    border: { type: Boolean},\r\n    color: { reflect: true, ...color }\r\n  }\r\n\r\n  #styleID = GSID.id;\r\n  #refEl = createRef();\r\n  #enabled = false;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.dynamicStyle(me.#styleID);\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    const me = this;\r\n    const root = document.documentElement;\r\n    me.attachEvent(root, 'mousemove', me.#onMove.bind(me));\r\n    me.attachEvent(root, 'mousedown', me.#onMouseDown.bind(me));\r\n    me.attachEvent(root, 'mouseup', me.#onMouseUp.bind(me));\r\n  }\r\n\r\n  firstUpdated() {\r\n    super.firstUpdated();\r\n    const me = this;\r\n    const rule = me.dynamicStyle(me.#styleID);\r\n    Object.assign(rule.style, {cursor: 'move'});\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div ${ref(me.#refEl)} \r\n      data-gs-class=\"${me.#styleID}\"\r\n      class=\"${classMap(me.renderClass())}\"\r\n      @mousedown=\"${() => me.#enabled = true}\"\r\n      @mouseup=\"${() => me.#enabled = false}\">\r\n      <slot></slot>\r\n      </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'gs-movable' : true,\r\n      [me.#styleID]: true,\r\n      'position-absolute' : true,\r\n      'border' : me.border,\r\n      'shadow-sm' : me.shadow,\r\n      [`text-${me.color}`]: me.color,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  #updateCursor(move) {\r\n    const me = this;\r\n    const rule = me.dynamicStyle(me.#styleID);\r\n    Object.assign(rule.style, {'user-select': move ? 'none' : ''});\r\n  }\r\n\r\n  #onMove(e) {\r\n    if (this.#enabled) {\r\n      const style = this.#refEl.value.style;\r\n      style?.setProperty('--mouse-x', e.clientX + \"px\");\r\n      style?.setProperty('--mouse-y', e.clientY + \"px\");\r\n    }\r\n  }\r\n\r\n  #onMouseDown(e) {\r\n    this.#updateCursor(true);\r\n  }\r\n\r\n  #onMouseUp(e) {\r\n    this.#updateCursor(false);\r\n  }\r\n\r\n\r\n  static {\r\n    this.define('gs-movable');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { html, ifDefined } from '../lib.mjs';\r\nimport { GSGroupElement } from './Group.mjs';\r\nimport { PlacementTypes, nav, placement } from '../properties/index.mjs';\r\n\r\nexport class GSNavElement extends GSGroupElement {\r\n\r\n  static properties = {\r\n    type: nav,\r\n    placement: placement,\r\n    vertical: { type: Boolean }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.circular = true;\r\n    this.multiple = false;\r\n    this.type = 'pills';\r\n    this.placement = 'start';\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    return this.data.length > 0 || this.query('gs-nav-item');\r\n  }\r\n  \r\n  renderWrappedClass() {\r\n    const me = this;\r\n    const isBefore = PlacementTypes.isBefore(me.placement);\r\n    const isTab = me.type === 'tabs';\r\n    const css = {\r\n      'nav': true,\r\n      [`nav-${me.type}`]: me.type,\r\n      'flex-column': me.vertical,\r\n      'border-bottom-0': me.vertical,\r\n      'border-end': isTab && isBefore && me.vertical,\r\n      'border-start': isTab && !isBefore && me.vertical,\r\n      [`justify-content-${me.placement}`]: !me.vertical\r\n    }\r\n    return css;\r\n  }\r\n\r\n  /**\r\n   * Render items based on data propprty (might be from gs-item)\r\n   * @returns \r\n   */\r\n  renderItems() {\r\n    return this.data.map(o => {\r\n      return html`<gs-nav-item generated\r\n        .active=\"${o.active === true}\"\r\n        .autofocus=\"${o.autofocus === true}\"\r\n        .disabled=\"${ifDefined(o.disabled === true)}\" \r\n        icon=\"${ifDefined(o.icon)}\" \r\n        href=\"${ifDefined(o.href)}\" \r\n        target=\"${ifDefined(o.target)}\" \r\n        title=\"${ifDefined(o.title)}\"></gs-nav-item>`;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Callback when child element focused\r\n   * @param {*} el \r\n   */\r\n  onFocused(el) {\r\n    // el?.click();\r\n  }\r\n\r\n  get childTagName() {\r\n    return 'GS-NAV-ITEM';\r\n  }\r\n\r\n  static {\r\n    this.define('gs-nav');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, ifDefined, html, createRef, ref } from '../lib.mjs';\r\nimport { NavTypes, PlacementTypes } from '../properties/index.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSNavItemElement extends GSElement {\r\n\r\n  static properties = {\r\n    href: {},\r\n    target: {},\r\n    title: {},\r\n    icon: {},\r\n    disabled: { type: Boolean },\r\n    autofocus: { type: Boolean },\r\n    active: { type: Boolean, reflect: true },\r\n    tooltip: {} // Add tooltip property\r\n  }\r\n\r\n  #refEl = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  shouldUpdate(changedProperties) {\r\n    return this.parentComponent?.tagName === 'GS-NAV';\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    if (this.autofocus && !this.disabled) this.focus();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div class=\"nav-item ${classMap(me.renderClass())}\">${me.#button}</div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    return this.mapCSS(this.#itemsCSS, super.renderClass());\r\n  }\r\n\r\n  reset() {\r\n    this.active = this.autofocus || false;\r\n  }\r\n\r\n  click() {\r\n    this.#refEl.value?.click();\r\n  }\r\n\r\n  focus() {\r\n    requestAnimationFrame(() => this.#refEl.value?.focus());\r\n  }\r\n\r\n  get isNav() {\r\n    return true;\r\n  }\r\n\r\n  get vertical() {\r\n    return this.parentComponent.vertical || false;\r\n  }\r\n\r\n  get placement() {\r\n    return this.parentComponent.placement;\r\n  }\r\n\r\n  get url() {\r\n    return this.href && this.target ? this.href : '#';\r\n  }\r\n\r\n  get #title() {\r\n    return html`<slot>${this.translate(this.title)}</slot>`;\r\n  }\r\n\r\n  get #icon() {\r\n    return this.icon ? html`<gs-icon name=\"${this.icon}\"></gs-icon>` : html`<slot name=\"icon\"></slot>`;\r\n  }\r\n\r\n  get #first() {\r\n    return this.rtl ? this.#title : this.#icon;\r\n  }\r\n\r\n  get #second() {\r\n    return this.rtl ? this.#icon : this.#title;\r\n  }\r\n\r\n  get #button() {\r\n    const me = this;\r\n    let obj = me.mapCSS(me.#buttonCSS, {});\r\n    if (me.active) obj = me.mapCSS(me.#buildCSS + ' ' + me.#activeCSS, obj);\r\n    return html`<a tabindex=\"0\" type=\"button\" role=\"nav\" \r\n     ${ref(me.#refEl)}\r\n     class=\"nav-link ${classMap(obj)}\"\r\n     href=\"${ifDefined(me.url)}\" \r\n     target=\"${ifDefined(me.target)}\"\r\n     title=\"${ifDefined(me.tooltip)}\"> \r\n        ${me.#first} \r\n        ${me.#second}\r\n      </a>`;\r\n  }\r\n\r\n  get #itemsCSS() {\r\n    return this.parentComponent.dataset?.cssItem || '';\r\n  }\r\n\r\n  get #buttonCSS() {\r\n    return this.parentComponent.dataset?.cssButton || '';\r\n  }\r\n\r\n  get #activeCSS() {\r\n    return this.parentComponent.dataset?.cssActive || '';\r\n  }\r\n\r\n  get #navType() {\r\n    return NavTypes.indexOf(this.parentComponent.type);\r\n  }\r\n\r\n  // fiix for shadowed DOM, parent class=\"nav nav-pills..\" \r\n  // do not cross shadow dom, so item elements does not see CSS\r\n  // we have to simulate\r\n  get #buildCSS() {\r\n    const isVertical = this.vertical;\r\n    const isBefore = PlacementTypes.isBefore(this.placement);\r\n    switch (this.#navType) {\r\n      // pills\r\n      case 1: return 'rounded text-bg-primary';\r\n      // tabs\r\n      case 2:\r\n        if (isVertical) {\r\n          if (isBefore) {\r\n            return 'shadow-none border border-end-0';\r\n          } else {\r\n            return 'shadow-none border border-start-0';\r\n          }\r\n        }\r\n        return 'shadow-none border border-bottom-0';\r\n      // underline\r\n      case 3: return 'shadow-none border-bottom border-3 fw-medium';\r\n      default:\r\n        return '';\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-nav-item');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { svg, html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\n\r\nexport class GSOverlayElement extends GSElement {\r\n\r\n    static properties = {\r\n        color: {},\r\n        target: {},\r\n        autoremove: { type: Boolean },\r\n        opened: { type: Boolean },\r\n        opacity: { type: Number },\r\n        padding: { type: Number },\r\n        radius: { type: Number },\r\n    }\r\n\r\n    #styleID = GSID.id;\r\n    #styleID2 = GSID.id;\r\n\r\n    constructor() {\r\n        super();\r\n        //this.color = 'rgb(0,0,0)';\r\n        this.color = '#000';\r\n        this.opacity = 0.7;\r\n        this.padding = 1;\r\n        this.radius = 6;\r\n        this.dynamicStyle(this.#styleID);\r\n        this.dynamicStyle(this.#styleID2);\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        const me = this;\r\n        me.attachEvent(window, 'resize', () => me.requestUpdate());\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        if (!me.opened) return '';\r\n        const path = me.#path;\r\n        return path ? html`<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:space=\"preserve\"\r\n            xmlnsXlink=\"http://www.w3.org/1999/xlink\"\r\n            version=\"1.1\" preserveAspectRatio=\"xMinYMin slice\"\r\n            viewBox=\"0 0 ${window.innerWidth} ${window.innerHeight}\"\r\n            class=\"gs-overlay gs-overlay-animated ${me.#styleID}\"\r\n            @click=\"${me.reset.bind(me)}\">\r\n            ${path}\r\n        </svg>` : '';\r\n    }\r\n\r\n    async firstUpdated(changed) {\r\n        const me = this;\r\n        const opt = {\r\n            fillRule: \"evenodd\",\r\n            clipRule: \"evenodd\",\r\n            strokeLinejoin: \"round\",\r\n            strokeMiterlimit: \"2\",\r\n            zIndex: \"10000\",\r\n            position: \"fixed\",\r\n            top: \"0\",\r\n            left: \"0\",\r\n            width: \"100%\",\r\n            height: \"100%\"\r\n        };\r\n        me.dynamicStyle(me.#styleID, opt);\r\n        super.firstUpdated(changed);\r\n    }\r\n\r\n    open() {\r\n        this.opened = true;\r\n    }\r\n\r\n    close() {\r\n        this.opened = false;\r\n    }\r\n\r\n    toggle() {\r\n        this.opened = !this.opened;\r\n    }\r\n\r\n    reset() {\r\n        const me = this;\r\n        if (me.autoremove) me.close();\r\n    }\r\n\r\n    get #path() {\r\n        const me = this;\r\n        const el = GSDOM.query(me.target);\r\n        if (!me.target) return '';\r\n        const pathStr = me.#createSVGPathString(el);\r\n        const opt = { fill: me.color, opacity: me.opacity, pointerEvents: 'auto', cursor: 'auto' };\r\n        me.dynamicStyle(me.#styleID2, opt);\r\n        return svg`<path class=\"${me.#styleID2}\"  d=\"${pathStr}\"></path>`;\r\n    }\r\n\r\n    #createSVGPathString(target) {\r\n\r\n        const me = this;\r\n        const windowX = window.innerWidth;\r\n        const windowY = window.innerHeight;\r\n\r\n        const rect = target.getBoundingClientRect();\r\n\r\n        const padding = me.padding;\r\n        const radius = me.radius;\r\n\r\n        const width = rect.width + padding * 2;\r\n        const height = rect.height + padding * 2;\r\n\r\n        // prevent glitches when stage is too small for radius\r\n        const limitedRadius = Math.min(radius, width / 2, height / 2);\r\n\r\n        // no value below 0 allowed + round down\r\n        const normalizedRadius = Math.floor(Math.max(limitedRadius, 0));\r\n\r\n        const highlightBoxX = rect.x - padding + normalizedRadius;\r\n        const highlightBoxY = rect.y - padding;\r\n        const highlightBoxWidth = width - normalizedRadius * 2;\r\n        const highlightBoxHeight = height - normalizedRadius * 2;\r\n\r\n        const val = `M${windowX},0L0,0L0,${windowY}L${windowX},${windowY}L${windowX},0Z\r\n            M${highlightBoxX},${highlightBoxY} \r\n            h${highlightBoxWidth} \r\n            a${normalizedRadius},${normalizedRadius} 0 0 1 ${normalizedRadius},${normalizedRadius} \r\n            v${highlightBoxHeight} \r\n            a${normalizedRadius},${normalizedRadius} 0 0 1 -${normalizedRadius},${normalizedRadius} \r\n            h-${highlightBoxWidth} \r\n            a${normalizedRadius},${normalizedRadius} 0 0 1 -${normalizedRadius},-${normalizedRadius} \r\n            v-${highlightBoxHeight} \r\n            a${normalizedRadius},${normalizedRadius} 0 0 1 ${normalizedRadius},-${normalizedRadius} z`;\r\n        return val.replace(/[\\t\\n]/g, ' ');\r\n    }\r\n\r\n    static {\r\n        this.define('gs-overlay');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, html, ifDefined, map, range, ref } from '../lib.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { size, SizeTypes } from '../properties/index.mjs';\r\n\r\nexport class GSPagerElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    size: { ...size },\r\n    first: { type: Boolean },\r\n    last: { type: Boolean },\r\n    next: { type: Boolean },\r\n    previous: { type: Boolean },\r\n    pages: { type: Number },\r\n\r\n    labelFirst: { attribute: 'label-first' },\r\n    labelLast: { attribute: 'label-last' },\r\n    labelNext: { attribute: 'label-next' },\r\n    labelPrevious: { attribute: 'label-previous' },\r\n\r\n    cssItem: { attribute: 'css-item' },\r\n\r\n  }\r\n\r\n  #ref = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.pages = 5;\r\n    me.labelFirst = '&laquo;';\r\n    me.labelLast = '&raquo;';\r\n    me.labelNext = '&rsaquo;';\r\n    me.labelPrevious = '&lsaquo;';\r\n    if (me.#isInTable) {\r\n      me.slot = \"extra\";\r\n    }\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const half = Math.floor((me.pages - 1) / 2);\r\n    const page = me.dataController?.page || 0;\r\n    const start = page - half < 1 ? 1 : page - half;\r\n    const end = page > 0 ? page + half : me.pages;\r\n\r\n    return html`<nav \r\n        dir=\"${ifDefined(me.direction)}\"\r\n        @click=\"${me.#onClick}\"\r\n        @keyup=\"${me.#onKeyUp}\"\r\n        @keydown=\"${me.#onKeyDown}\">\r\n        <ul ${ref(me.#ref)} class=\"${classMap(me.renderClass())}\">\r\n        ${me.#renderFirst()}\r\n        ${me.#renderPrevious()}\r\n        ${map(range(start, end + 1), (i) => me.#renderItem(i, '', '', i  === page))}\r\n        ${me.#renderNext()}\r\n        ${me.#renderLast()}\r\n        </ul></nav>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const size = me.size ? SizeTypes[me.size] || me.size : '';\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'pagination': true,\r\n      [`pagination-${size}`]: size,\r\n\r\n    }\r\n    return css;\r\n  }\r\n\r\n  updated() {\r\n    const target = this.#ref.value;\r\n    if (target && this.isFocused) {\r\n      target.querySelector('.active > a')?.focus();\r\n    }\r\n  }\r\n\r\n  onDataRead() {\r\n    this.requestUpdate();\r\n  }\r\n\r\n  #renderFirst() {\r\n    return this.first ? this.#renderItem(this.labelFirst, 'first', 'First page') : '';\r\n  }\r\n\r\n  #renderLast() {\r\n    return this.last ? this.#renderItem(this.labelLast, 'last', 'Last page') : '';\r\n  }\r\n\r\n  #renderPrevious() {\r\n    return this.previous ? this.#renderItem(this.labelPrevious, 'previous', 'Previous page') : '';\r\n  }\r\n\r\n  #renderNext() {\r\n    return this.next ? this.#renderItem(this.labelNext, 'next', 'Next page') : '';\r\n  }\r\n\r\n  #renderItem(text = '', name = '', title = '', active = false) {\r\n    const me = this;\r\n    text = GSUtil.decodeHTMLEntities(text);\r\n    return html`<li class=\"page-item ${active ? 'active' : ''}\">\r\n              <a class=\"page-link ${this.cssItem}\" \r\n                 name=\"${name}\" \r\n                 title=\"${me.translate(title)}\" \r\n                 href=\"#\">${me.translate(text)}</a>\r\n            </li>`;\r\n  }\r\n\r\n  #onClick(e) {\r\n\r\n    const me = this;\r\n    const el = this.#toTarget(e, 'a');\r\n    if (!el) return;\r\n\r\n    const ctrl = me.dataController;\r\n    if (!ctrl) return;\r\n\r\n    const val = el.name || el.text;\r\n    me.emit(val, el);\r\n    \r\n    switch (val) {\r\n      case 'first':\r\n        return ctrl.firstPage();\r\n      case 'last':\r\n        return ctrl.lastPage();\r\n      case 'next':\r\n        return ctrl.nextPage();\r\n      case 'previous':\r\n        return ctrl.prevPage();\r\n    }\r\n\r\n    ctrl.page = val;\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n    const current = this.#toTarget(e, 'li');\r\n    let el = null;\r\n    switch (e.code) {\r\n      case 'ArrowLeft':\r\n        el = current?.previousElementSibling;\r\n        break;\r\n      case 'ArrowRight':\r\n        el = current?.nextElementSibling;\r\n        break;\r\n    }\r\n    el = el?.querySelector('a');\r\n    el?.focus();\r\n  }\r\n\r\n  #onKeyUp(e) {\r\n    if (e.code === 'Space') {\r\n      this.#toTarget(e, 'a')?.click();\r\n    }\r\n  }\r\n\r\n  #toTarget(e, name) {\r\n    const el = e.target.closest(name) || e.target;\r\n    return el.tagName === name.toUpperCase() ? el : undefined;\r\n  }\r\n\r\n  get #isInTable() {\r\n    return this.parentComponent?.tagName === 'GS-TABLE';\r\n  }\r\n  \r\n  static {\r\n    this.define('gs-pagination');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, ref, classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { placement, position } from '../properties/index.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSPopper } from \"../base/GSPopper.mjs\";\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\n\r\nexport class GSPopupElement extends GSElement {\r\n\r\n  static properties = {\r\n    placement: { ...placement },\r\n    position: { ...position },\r\n    trigger: {},\r\n    target: {},\r\n    autoclose: { type: Boolean },\r\n    autofocus: { type: Boolean },\r\n    opened: { type: Boolean },\r\n    hPos: { type: Number, attribute: 'h-pos' },\r\n    vPos: { type: Number, attribute: 'v-pos' },\r\n    wMin: { type: Number, attribute: 'w-min' },\r\n    wMax: { type: Number, attribute: 'w-max' },\r\n    hMin: { type: Number, attribute: 'h-min' },\r\n    hMax: { type: Number, attribute: 'h-max' },\r\n\r\n  }\r\n\r\n  #caller = null;\r\n  #panelRef = createRef();\r\n  #styleID = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    this.autofocus = true;\r\n    this.autoclose = true;\r\n    this.trigger = 'click';\r\n    this.position = 'absolute';\r\n    this.placement = 'bottom';\r\n    this.dynamicStyle(this.#styleID);\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    const me = this;\r\n    me.#attachTarget(); // Fixed typo: #attachTaraget -> #attachTarget\r\n    me.attachEvent(window, 'resize', me.close.bind(me));\r\n    me.on('mouseleave', me.#onAuto.bind(me));\r\n  }\r\n\r\n  firstUpdated(changedProperties) {\r\n    const me = this;\r\n    requestAnimationFrame(() => {\r\n      me.#resize();\r\n      me.#reposition();\r\n    });\r\n    super.firstUpdated();\r\n  }\r\n\r\n  updated() {\r\n    const me = this;\r\n    me.#reposition();\r\n    if (me.autofocus) me.focus();\r\n    me.notify();\r\n    me.#postPopup();\r\n  }\r\n\r\n  willUpdate(changedProperties) {\r\n    if (changedProperties.has('opened')) {\r\n      this.#postPopup();\r\n    }\r\n    return super.willUpdate(changedProperties); \r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div \r\n      ${ref(me.#panelRef)}\r\n      dir=\"${ifDefined(me.direction)}\"\r\n      class=\"fade ${classMap(me.renderClass())}\"\r\n      data-gs-class=\"${me.#styleID}\"\r\n      @keydown=\"${me.#onKeyDown}\">\r\n      ${me.renderTemplate()}\r\n      <slot></slot>\r\n    </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'show': me.opened,\r\n      //'d-none' : !me.opened,\r\n      [me.#styleID]: true,\r\n      [`position-${me.position}`]: me.position,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  focus() {\r\n    this.query('[tabindex], input, select, textarea, button, a', true)?.focus();\r\n  }\r\n\r\n  open() {\r\n    this.opened = true;\r\n  }\r\n\r\n  close() {\r\n    this.opened = false;\r\n  }\r\n\r\n  toggle() {\r\n    this.opened = !this.opened;\r\n  }\r\n\r\n  /**\r\n   * Show popup at x/y position on the screen\r\n   * @param {Number} x \r\n   * @param {Number} y \r\n   * @returns {void}\r\n   */\r\n  popup(x = 0, y = 0) {\r\n    const me = this;\r\n    const obj = {\r\n      top: '0px',\r\n      left: '0px',\r\n      translate: `${x}px ${y}px`\r\n    };\r\n    me.#resize(obj);\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n    const me = this;\r\n    switch (e.key) {\r\n      case 'Escape':\r\n        me.close();\r\n        break;\r\n    }\r\n  }\r\n\r\n  #reposition() {\r\n    const me = this;\r\n    //if (!me.opened) return;\r\n    if (me.vPos || me.hPos) {\r\n      const opt = {\r\n        top: '0px',\r\n        left: '0px',\r\n        translate: `${me.hPos}px ${me.vPos}px`\r\n      };\r\n      const rule = me.dynamicStyle(me.#styleID);\r\n      Object.assign(rule.style, opt);\r\n    } else if (me.target) {\r\n      let target = GSDOM.query(document.documentElement, me.target);\r\n      target = target.renderRoot?.firstElementChild || target;\r\n      GSPopper.popupFixed(me.placement, me.#panel, target);\r\n    }\r\n\r\n  }\r\n\r\n  #resize(obj = {}) {\r\n    const me = this;\r\n    const rule = me.dynamicStyle(me.#styleID);\r\n    if (me.wMax) obj['max-width'] = `${me.wMax}px`;\r\n    if (me.wMin) obj['min-width'] = `${me.wMin}px`;\r\n    if (me.hMax) obj['max-height'] = `${me.hMax}px`;\r\n    if (me.hMin) obj['min-height'] = `${me.hMin}px`;\r\n    Object.assign(rule.style, obj);\r\n  }\r\n\r\n  #onPopup(e) {\r\n    const me = this;\r\n    me.#caller = e;\r\n    if (e instanceof Event) {\r\n      GSEvents.prevent(e);\r\n      me.#caller = e.composedPath().filter(e => (!(e instanceof HTMLSlotElement))).shift();\r\n    }\r\n\r\n    if (me.placement) {\r\n      GSPopper.popupFixed(me.placement, me.#panel, me.#caller);\r\n      me.opened = true;\r\n      return;\r\n    }\r\n\r\n    let x = e.clientX, y = e.clientY;\r\n    const rect = me.#panel.getBoundingClientRect();\r\n    const overflowH = x + rect.width > window.innerWidth;\r\n    const overflowV = y + rect.height > window.innerHeight;\r\n\r\n    if (overflowH) x = window.innerWidth - rect.width;\r\n    if (overflowV) y = window.innerHeight - rect.height;\r\n\r\n    me.popup(x, y);\r\n    return true;\r\n  }\r\n\r\n  #postPopup() {\r\n    const me = this;\r\n    const rule = me.dynamicStyle(me.#styleID);\r\n    Object.assign(rule.style, {display: me.opened ? '' : 'none'}); \r\n  }\r\n\r\n  #attachTarget() { // Fixed typo: #attachTaraget -> #attachTarget\r\n    const me = this;\r\n    const targets = GSDOM.queryAll(document.documentElement, me.target);\r\n    me.trigger.split(' ').forEach(evt => {\r\n      targets.forEach(target => me.attachEvent(target, evt, me.#onPopup.bind(me)));\r\n    });\r\n  }\r\n\r\n  #onAuto(e) {\r\n    if (this.autoclose) this.close();\r\n  }\r\n\r\n  get #panel() {\r\n    return this.#panelRef.value;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-popup');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, ref, classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { placement } from '../properties/index.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSPopper } from '../base/GSPopper.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\n\r\nexport class GSPopoverElement extends GSElement { // Fixed typo: GSPopoverlement -> GSPopoverElement\r\n\r\n  static properties = {\r\n    placement: { ...placement },\r\n    target: {},\r\n    trigger: {},\r\n    title: {},\r\n    content: {},\r\n    opened: { type: Boolean },\r\n  }\r\n\r\n  #arrowRef = createRef();\r\n  #panelRef = createRef();\r\n  #styleID = GSID.id;\r\n  #arrowID = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    // added to the GSCacheStyle\r\n    //this.style.position = 'fixed';\r\n    this.placement = 'top';\r\n    this.trigger = 'hover';\r\n    this.content = '';\r\n    this.dynamicStyle(this.#styleID);\r\n    this.dynamicStyle(this.#arrowID);\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.connectedCallback();\r\n    const me = this;\r\n    me.#attachEvents();\r\n    me.#reposition();\r\n    super.firstUpdated(changed);\r\n  }\r\n  \r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    this.#reposition();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const head = me.title ? html`<div class=\"popover-header ${me.cssHead}\">${me.translate(me.title)}</div>` : '';\r\n    return html`\r\n    <div ${ref(me.#panelRef)} \r\n        dir=\"${ifDefined(me.direction)}\"\r\n        data-popper-placement=\"${me.placement}\"\r\n        class=\"${classMap(me.renderClass())}\" \r\n        data-gs-class=\"${me.#styleID}\" \r\n        role=\"tooltip\">\r\n        <div ${ref(me.#arrowRef)} \r\n          class=\"popover-arrow ${me.#arrowID}\" \r\n          data-gs-class=\"${me.#arrowID}\">\r\n        </div>\r\n        ${head}\r\n        <div class=\"popover-body\">\r\n          ${me.renderTemplate()}\r\n          ${me.content}\r\n          <slot></slot>\r\n        </div>\r\n    </div>            \r\n    `;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'popover': true,\r\n      'bs-popover-auto': true,\r\n      'fade': true,\r\n      'show': me.opened,\r\n      [me.#styleID]: true\r\n    }\r\n    return css;\r\n  }\r\n\r\n  open() {\r\n    this.opened = true;\r\n  }\r\n\r\n  close() {\r\n    this.opened = false;\r\n  }\r\n\r\n  toggle() {\r\n    this.opened = !this.opened;\r\n  }\r\n\r\n  get isFocusTrigger() {\r\n    return this.trigger.includes('focus');\r\n  }\r\n\r\n  get isHoverTrigger() {\r\n    return this.trigger.includes('hover');\r\n  }\r\n\r\n  get #ref() {\r\n    const me = this;\r\n    switch (me.target) {\r\n      case '@parent':\r\n        return this.parentElement;\r\n      case '@previous':\r\n        return this.previousElementSibling;\r\n      case '@next':\r\n        return this.nextElementSibling;\r\n      default:\r\n        return GSDOM.query(document.body, me.target);\r\n    }\r\n  }\r\n\r\n  #reposition() {\r\n    const me = this;\r\n    const source = me.#panel;\r\n    if (!source) return;\r\n    if (me.opened) {\r\n      GSPopper.popupAbsolute(me.placement, source, me.#ref, me.#arrow);\r\n    } else {\r\n      me.dynamicStyle(me.#styleID, {top:'-1000px', left:'-1000px'});\r\n    }\r\n  }\r\n\r\n  // https://javascript.info/mousemove-mouseover-mouseout-mouseenter-mouseleave\r\n  #attachEvents() {\r\n\r\n    const me = this;\r\n    const el = me.#ref;\r\n\r\n    if (me.isHoverTrigger) {\r\n      GSEvents.attach(me, el, 'mouseover', me.open.bind(me));\r\n      GSEvents.attach(me, el, 'mouseleave', me.close.bind(me));\r\n    }\r\n\r\n    if (me.isFocusTrigger) {\r\n      GSEvents.attach(me, el, 'click', me.#onFocus.bind(me));\r\n      GSEvents.attach(me, me.#panel, 'mouseleave', me.close.bind(me));\r\n      GSEvents.attach(me, window, 'click', me.close.bind(me));\r\n    }\r\n\r\n  }\r\n\r\n  #onFocus(e) {\r\n    GSEvents.prevent(e);\r\n    this.toggle();\r\n  }\r\n  \r\n  get #arrow() { return this.#arrowRef.value; }\r\n  get #panel() { return this.#panelRef.value; }\r\n\r\n  static {\r\n    this.define('gs-popover');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { html, classMap, ifDefined } from '../lib.mjs';\r\nimport { literalTemplate } from '../directives/literal.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\nexport class GSProgressElement extends GSElement {\r\n\r\n  static properties = {\r\n    min: { reflect: true, type: Number },\r\n    max: { reflect: true, type: Number },\r\n    step: { reflect: true, type: Number },\r\n    value: { reflect: true, type: Number },\r\n    label: { reflect: true }\r\n  }\r\n\r\n  #styleID = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    this.min = 0;\r\n    this.step = 1;\r\n    this.max = 100;\r\n    this.value = 0;\r\n    this.styles = { width: '0%' };\r\n    this.dynamicStyle(this.#styleID);\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'progress-bar' : true,\r\n      [me.#styleID] : true\r\n    }\r\n    return css;\r\n  }  \r\n\r\n  renderUI() {\r\n    const me = this;\r\n    me.#updateStyle();\r\n    const obj = {min :me.min, max:me.max, step:me.step, value:me.value, percentage:me.percentage};\r\n    return html`\r\n    <div class=\"progress\" @keydown=\"${me.#onKeySelect}\" dir=\"${ifDefined(me.direction)}\">\r\n        <div class=\"${classMap(me.renderClass())}\" \r\n             \r\n             role=\"progressbar\"\r\n             tabindex=\"0\">\r\n             ${literalTemplate(me.label, obj)}\r\n        </div>\r\n    </div>    \r\n    `;\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    const me = this;\r\n    if (changed.has('value')) {\r\n      let val = me.step + changed.get('value');\r\n      val = me.#update(val, val);\r\n      changed.set('value', val);\r\n    }\r\n  }\r\n\r\n  updated(changed) {\r\n    if (changed.has('value')) {\r\n      this.notify();\r\n    }\r\n  }\r\n\r\n  increase(val) {\r\n    const me = this;\r\n    val = GSUtil.isNumber(val) ? val : me.step;\r\n    me.value = me.#update(me.value + val, me.value);\r\n    return true;\r\n  }\r\n\r\n  decrease(val) {\r\n    const me = this;\r\n    val = GSUtil.isNumber(val) ? val : me.step;\r\n    me.value = me.#update(me.value - val, me.value);\r\n    return true;\r\n  }\r\n\r\n  get percentage() {\r\n    const me = this;\r\n    return Math.trunc((me.value / me.max) * 100);\r\n  }\r\n\r\n  #updateStyle() {\r\n    const me = this;\r\n    me.styles.width = `${me.percentage}%`;\r\n    me.dynamicStyle(me.#styleID, me.styles);\r\n  }\r\n\r\n  #update(val, old = 0) {\r\n    val = GSUtil.asNum(val, GSUtil.asNum(old));\r\n    const me = this;\r\n    if (val > me.max) val = me.max;\r\n    if (val < me.min) val = me.min;\r\n    return val;\r\n  }\r\n\r\n  #onKeySelect(e) {\r\n    const me = this;\r\n    switch (e.code) {\r\n      case 'ArrowUp' :\r\n      case 'ArrowRight' :\r\n          return me.increase();\r\n      case 'ArrowLeft' :\r\n      case 'ArrowDown' :\r\n         return me.decrease();\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-progress');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, css, html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color } from '../properties/index.mjs';\r\n\r\nexport class GSSpinnerElement extends GSElement {\r\n\r\n    static styles = css`.spinner-border { border: var(--bs-spinner-border-width) solid currentcolor; border-right-color: transparent; }`;\r\n\r\n    static properties = {\r\n        color: { ...color, reflect: true },\r\n        small: { type: Boolean, reflect: true },\r\n        pulsar: { type: Boolean }\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div class=\"${classMap(me.renderClass())}\" role=\"status\"></div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            \"spinner-border\": !me.pulsar,\r\n            \"spinner-grow\": me.pulsar,\r\n            [`text-${me.color}`]: me.color,\r\n            [`spinner-border-sm`]: !me.pulsar && me.small,\r\n            [`spinner-grow-sm`]: me.pulsar && me.small,\r\n        }\r\n        return css;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-spinner');\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSSplitterElement class\r\n * @module components/GSSplitterElement\r\n */\r\n\r\nimport { classMap, createRef, ref, html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSCSSMap } from '../base/GSCSSMap.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { notEmpty, numGT0, placement } from '../properties/index.mjs';\r\nimport { ElementMoveController } from '../controllers/ElementMoveController.mjs';\r\n\r\n/**\r\n * Renderer for element splitter\r\n * @class\r\n * @extends {Component}\r\n */\r\nexport class GSSplitterElement extends GSElement {\r\n\r\n    static properties = {\r\n        // Check if splitter use vertical or horizontal splitting\r\n        split: { reflect: true },\r\n        // start|end|top|bottom\r\n        resize: { ...placement, hasChanged: notEmpty },\r\n        size: { type: Number, hasChanged: numGT0 }\r\n    }\r\n\r\n    #cursor = 0;\r\n    #styleID = GSID.id;\r\n    #styleTGT = GSID.id;\r\n    #elRef = createRef();\r\n    #mouseController;\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;\r\n        me.size = 8;\r\n        me.resize = 'start';\r\n        me.dynamicStyle(me.#styleID);\r\n        me.#load();\r\n        me.#mouseController = new ElementMoveController(me);\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        super.disconnectedCallback();\r\n        //this.dynamicStyle(this.#styleTGT, null, true);\r\n    }\r\n\r\n    firstUpdated(changed) {\r\n        super.firstUpdated(changed);\r\n        const me = this;\r\n        me.#mouseController.attach(me.#splitter);\r\n        //const shadow = GSDOM.root(me.target) instanceof ShadowRoot;\r\n        //me.dynamicStyle(me.#styleTGT, {}, !shadow);\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div ${ref(me.#elRef)} \r\n            @dblclick=\"${me.#onDoubleClick}\"\r\n            data-gs-class=\"${me.#styleID}\" \r\n            class=\"${classMap(me.renderClass())}\">\r\n            <slot></slot>\r\n        </div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            'splitter': true,\r\n            [me.#styleID]: true\r\n        }\r\n        return css;\r\n    }\r\n\r\n    updated(changedProperties) {\r\n        const me = this;\r\n        me.#cssUpdate();\r\n    }\r\n\r\n    /**\r\n    * Lock UI for mouse events to enable resizing over embedded iframes\r\n    * @param {MouseEvent} e \r\n    */\r\n    onStartMove(e) {\r\n        const me = this;\r\n        me.#cursor = me.isVertical ? e.clientX : e.clientY;\r\n        me.#lock(true);\r\n        GSEvents.send(globalThis, 'gs-split', { start: true });\r\n    }\r\n\r\n    /**\r\n     * Handles resizing based on mouse move event\r\n     * @param {MouseEvent} e \r\n     */\r\n    onMouseMove(e) {\r\n        const me = this;\r\n        const pos = me.isVertical ? e.clientX : e.clientY;\r\n        me.#updateMouse(pos);\r\n    }\r\n\r\n    /**\r\n     * Save last position and unlock mouse UI events when resizing finished\r\n     * @param {*} e \r\n     */\r\n    onEndMove(e) {\r\n        const me = this;\r\n        me.#save();\r\n        me.#lock(false);\r\n        GSEvents.send(globalThis, 'gs-split', { stop: true });\r\n    }\r\n\r\n    /**\r\n    * Check if splitter use vertical or hotizontal splitting\r\n    * @returns {Boolean}\r\n    */\r\n    get isVertical() {\r\n        return this.split === 'vertical';\r\n    }\r\n\r\n    get isHorizontal() {\r\n        return !this.isVertical;\r\n    }\r\n\r\n    /**\r\n     * Return preceding element\r\n     * @returns {HTMLElement}\r\n     */\r\n    get start() {\r\n        return this.previousElementSibling;\r\n    }\r\n\r\n    /**\r\n    * Return following element\r\n    * @returns {HTMLElement}\r\n    */\r\n    get end() {\r\n        return this.nextElementSibling;\r\n    }\r\n\r\n    /**\r\n     * Return closest element found\r\n     * @returns {HTMLElement}\r\n     */\r\n    get target() {\r\n        const me = this;\r\n        let el = me.#isPreceeding ? me.start : me.end;\r\n        el = el || me.parentElement;\r\n        el = GSDOM.isGSElement(el) ? el.self : el;\r\n        if (el instanceof ShadowRoot) {\r\n            // no firefox support\r\n            el = Array.from(el.children).filter(o => !GSDOM.isStyleValue(o, 'display', 'none')).pop();\r\n        }\r\n        el.classList?.add(me.#styleTGT);\r\n        return el;\r\n    }\r\n\r\n    get #isPreceeding() {\r\n        const me = this;\r\n        const resize = me.resize;\r\n        return resize === 'start' || resize === 'top';\r\n    }\r\n\r\n    get #splitter() {\r\n        return this.#elRef.value;\r\n    }\r\n\r\n    get #styleDynamic() {\r\n        return this.target.style;\r\n    }\r\n\r\n    /**\r\n     * Get elements which must be protected to allow mouse move over \r\n     */\r\n    get #lockable() {\r\n        const me = this;\r\n        const qry = 'iframe,embed,portal';\r\n        const p = GSDOM.queryAll(me.previousElementSibling, qry);\r\n        const n = GSDOM.queryAll(me.nextElementSibling, qry);\r\n        return [...p, ...n];\r\n    }\r\n\r\n    #load() {\r\n        const me = this;\r\n        if (!me.id) return;\r\n        const key = GSID.hashCode(location.origin + location.pathname);\r\n        let val = localStorage.getItem(`gs-splitter-${key}-${me.id}`);\r\n        val = GSUtil.asNum(val);\r\n        me.#update(val);\r\n    }\r\n\r\n    #save() {\r\n        const me = this;\r\n        if (!me.id) return;\r\n        const css = GSCSSMap.getComputedStyledMap(me.target);\r\n        const val = me.isVertical ? css.get('width') : css.get('height');\r\n        if (!val) return;\r\n        const key = GSID.hashCode(location.origin + location.pathname);\r\n        localStorage.setItem(`gs-splitter-${key}-${me.id}`, val);\r\n    }\r\n\r\n    #onDoubleClick(e) {\r\n\r\n        const me = this;\r\n        let csize = 0;\r\n        let key = '';\r\n\r\n        if (me.isVertical) {\r\n            key = 'width';\r\n            csize = me.target.clientWidth;\r\n        } else {\r\n            key = 'height';\r\n            csize = me.target.clientHeight;\r\n        }\r\n\r\n        let min = GSCSSMap.styleValue(me.target, `min-${key}`);\r\n        let max = GSCSSMap.styleValue(me.target, `max-${key}`);\r\n\r\n        min = GSUtil.asNum(min.value);\r\n        max = GSUtil.asNum(max.value);\r\n\r\n        if ((max - min) / 2 > csize) {\r\n            csize = max;\r\n        } else {\r\n            csize = min;\r\n        }\r\n        me.#update(csize);\r\n\r\n    }\r\n\r\n    /**\r\n     * Lock IFRAME,EMBED,PORTAL elements for mouse move events\r\n     * @param {*} lock \r\n     */\r\n    #lock(lock = true) {\r\n        const me = this;\r\n        const cls = 'pe-none';\r\n        if (lock) {\r\n            me.#lockable\r\n                .filter(el => !GSDOM.hasClass(el, 'pe-none'))\r\n                .forEach(el => {\r\n                    GSDOM.toggleClass(el, cls, true);\r\n                    el.dataset.gsSplitter = true;\r\n                });\r\n        } else {\r\n            me.#lockable\r\n                .filter(el => el.dataset.gsSplitter)\r\n                .forEach(el => {\r\n                    GSDOM.toggleClass(el, cls, false);\r\n                    delete el.dataset.gsSplitter;\r\n                });\r\n        }\r\n    }\r\n\r\n    #updateMouse(pos) {\r\n        const me = this;\r\n        requestAnimationFrame(() => {\r\n            if (me.isVertical) {\r\n                me.#updateX(pos);\r\n            } else {\r\n                me.#updateY(pos);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Calculate width based on mouse position\r\n     * @param {Number} pos \r\n     */\r\n    #updateX(pos) {\r\n        const me = this;\r\n        const target = me.target;\r\n        const dir = me.#isPreceeding ? 1 : -1;\r\n        let dx = (pos - me.#cursor) * dir;\r\n        dx = dx + target.clientWidth;\r\n        dx = dx < 0 ? 0 : dx;\r\n        me.#styleDynamic.width = dx + \"px\";\r\n        //me.dynamicStyle(me.#styleTGT, { width: dx + \"px\" }, true);\r\n        me.#cursor = pos;\r\n    }\r\n\r\n    /**\r\n     * Calculate height based on mouse position\r\n     * @param {Number} pos \r\n     */\r\n    #updateY(pos) {\r\n        const me = this;\r\n        const target = me.target;\r\n        const dir = me.#isPreceeding ? 1 : -1;\r\n        let dx = (pos - me.#cursor) * dir;\r\n        dx = dx + target.clientHeight;\r\n        dx = dx < 0 ? 0 : dx;\r\n        me.#styleDynamic.height = dx + \"px\";\r\n        //me.dynamicStyle(me.#styleTGT, { height: dx + \"px\" }, true);\r\n        me.#cursor = pos;\r\n    }\r\n\r\n    #update(val = 0) {\r\n        if (val <= 0) return\r\n        const me = this;\r\n        me.#cursor = val;\r\n        const key = me.isVertical ? 'width' : 'height';\r\n        me.#styleDynamic[key] = val + \"px\";\r\n        //me.dynamicStyle(me.#styleTGT, { [key]: val + \"px\" }, true);\r\n    }\r\n\r\n    #cssUpdate() {\r\n        const me = this;\r\n        const size = me.isVertical ? 'width' : 'height';\r\n        const full = me.isVertical ? 'height' : 'width';\r\n        const cursor = me.isVertical ? 'w-resize' : 'n-resize';\r\n        const opt = {\r\n            [size]: `${me.size}px`,\r\n            [full]: '100%',\r\n            'border-width': '1px',\r\n            cursor: cursor,\r\n            'border-color': 'darkgray',\r\n            'border-style': 'solid',\r\n            'background-color': 'lightgray',\r\n        };\r\n        me.dynamicStyle(me.#styleID, opt);\r\n    }\r\n\r\n    static {\r\n        this.define('gs-splitter');\r\n    }\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from '../../base/GSUtil.mjs';\r\nimport { GSNavItemElement } from '../NavItem.mjs';\r\n\r\n/**\r\n * Tab component (gs-tab), generate selectable/switchable tabs on a panel\r\n */\r\nexport class GSTabItemElement extends GSNavItemElement {\r\n\r\n  static properties = {\r\n    name: {}\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.css = this.#updateCSS + this.css;\r\n  }\r\n\r\n  get #updateCSS() {\r\n    const me = this;\r\n    return me.shouldUpdate() ? GSUtil.normalize(me.parentComponent?.tabCSS) : '';\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    return this.parentComponent?.tagName === 'GS-TAB-GROUP';\r\n  }\r\n\r\n  static {\r\n    this.define('gs-tab');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSDOM } from '../../base/GSDOM.mjs';\r\nimport { classMap, html, ifDefined } from '../../lib.mjs';\r\n\r\n/**\r\n * Container for individual tab; part of tabed panel\r\n */\r\nexport class GSTabPanelElement extends GSElement {\r\n\r\n  static properties = {\r\n    name: {},\r\n    template: {},\r\n    active: { type: Boolean, reflect : true }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.active = false;\r\n  }\r\n\r\n  shouldUpdate(changedProperties) {\r\n    return this.parentComponent?.tagName === 'GS-TAB-GROUP';\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\" \r\n      class=\"${classMap(this.renderClass())}\">\r\n      <slot>\r\n      ${this.template ? html`<gs-template flat src=\"${this.template}\"></gs-template>` : ''}\r\n      </slot></div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'tab-pane': true,\r\n      'd-none' : !me.active,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  get owner() {\r\n    return this.closest('gs-tab-group') || GSDOM.component(this);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-tab-panel');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSID } from '../../base/GSID.mjs';\r\nimport { html, ifDefined } from '../../lib.mjs';\r\nimport { PlacementTypes } from '../../properties/placement.mjs';\r\nimport { GSNavElement } from '../Nav.mjs';\r\n\r\n/**\r\n * Panel with tabs component (gs-tab-group), generate childrens gs-tab and gs-tab-panel \r\n */\r\nexport class GSTabGroupElement extends GSNavElement {\r\n\r\n  static properties = {\r\n    panelCSS: { attribute: 'css-panel' },\r\n    tabCSS: { attribute: 'css-tab' },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n   \r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    const me = this;\r\n    // link tabs and panels\r\n    me.items.forEach(el => me.#findPanel(el));\r\n    me.onSelected(me.active);\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    return this.data.length > 0 || this.items.length > 0;\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    const me = this;\r\n    if (changed.has('data')) {      \r\n      me.items.forEach(el => me.#findPanel(el));\r\n    }\r\n    super.willUpdate(changed);\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'd-flex': me.vertical\r\n    }\r\n    return css;\r\n  }\r\n\r\n  renderWrappedUI() {\r\n    const me = this;\r\n    const reverse = PlacementTypes.isAfter(me.placement);\r\n    const list = [super.renderWrappedUI('tabs'),\r\n    html`<div class=\"tab-content flex-fill ${me.panelCSS}\"  dir=\"${ifDefined(me.direction)}\">\r\n        <slot name=\"panels\"></slot>\r\n      </div>\r\n      <slot class=\"d-none\"></slot>`];\r\n    return reverse ? list.reverse() : list;\r\n  }\r\n\r\n  renderWrappedClass() {\r\n    const me = this;\r\n    const css = super.renderWrappedClass();\r\n    return me.mapCSS(me.tabCSS, css);\r\n  }\r\n\r\n  /**\r\n   * Render items based on data property (might be from gs-item)\r\n   * @returns \r\n   */\r\n  renderItems() {\r\n    const me = this;\r\n    const tabs =  me.#renderTabs();\r\n    const panels = me.#renderPanels();\r\n    return tabs.concat(...panels);\r\n  }\r\n\r\n  #renderTabs() {    \r\n    return this.data.map(o => {\r\n      if (!o.name) o.name = GSID.id;\r\n      return html`<gs-tab generated slot=\"tabs\"\r\n        .active=\"${ifDefined(o.active === true)}\"\r\n        .autofocus=\"${ifDefined(o.autofocus === true)}\"\r\n        .disabled=\"${ifDefined(o.disabled === true)}\" \r\n        icon=\"${ifDefined(o.icon)}\"    \r\n        title=\"${ifDefined(o.title)}\"\r\n        name=\"${o.name}\"></gs-tab>`;\r\n    });    \r\n  }\r\n\r\n  /**\r\n   * Render items based on data property (might be from gs-item)\r\n   * @returns \r\n   */\r\n  #renderPanels() {\r\n    return this.data.map(o => {\r\n      if (!o.name) o.name = GSID.id;\r\n      return html`<gs-tab-panel generated  \r\n        slot=\"panels\" name=\"${o.name}\" \r\n        .active=\"${ifDefined(o.active)}\"\r\n        template=\"${ifDefined(o.template)}\"></gs-tab-panel>`;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Callback when tab selected\r\n   * @param {GSTabElement} el \r\n   */\r\n  onSelected(el) {\r\n    el?.click();\r\n    const panel = this.#findPanel(el);\r\n    if (panel) panel.active = true;\r\n  }\r\n\r\n  /**\r\n   * Callback when tab deselected\r\n   * @param {GSTabElement} el \r\n   */\r\n  onDeselected(el) {\r\n    const panel = this.#findPanel(el);\r\n    if (panel) panel.active = false;\r\n  }\r\n\r\n  get childTagName() {\r\n    return 'GS-TAB';\r\n  }\r\n\r\n  /**\r\n   * Selected Tab node name is used to find the panel.\r\n   * If panel found, auto-link it with node element\r\n   * @param {GSTabElement} el \r\n   */\r\n  #findPanel(el) {\r\n    if (!el) return null;\r\n    const me = this;\r\n    const key = Symbol.for('gs-element');\r\n    const generated = me.data?.length > 0;\r\n    let panel = el[key] || me.query(`gs-tab-panel[name=\"${el.name}\"]`, generated);\r\n    if (!el[key]) el[key] = panel;\r\n    return panel;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-tab-group');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, css, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color } from '../properties/color.mjs';\r\nimport { GSData } from '../base/GSData.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { DataSelector } from '../data/DataSelector.mjs';\r\n\r\n/**\r\n * A HTML Table renderer for tabular data representation.\r\n * Either use \"storage\" property to point to data handler\r\n * or use simpler form by using \"data\" property.\r\n * \r\n * NOTE: Simpler form currently does not suport data filter.\r\n * Simpler form is only for read-ony static data representation.\r\n */\r\nexport class GSTableElement extends GSElement {\r\n\r\n  static #icons = ['sort-up', 'arrow-down-up', 'sort-down-alt'];\r\n\r\n  static styles = css`th:hover { opacity: 50% !important; }`;\r\n\r\n  static CELLS = {\r\n    align: {},\r\n    width: {},\r\n    width: {},\r\n    css: {},\r\n    title: {},\r\n    colspan: {},\r\n    storage: {},\r\n    ref: {}, // if set; use storage or gs-items to map ref value to virtual field\r\n    list : { type: Boolean }, // if set, use storage record column as a filter\r\n    filter: { type: Boolean },\r\n    hidden: { type: Boolean },\r\n    fixed: { type: Boolean },\r\n    filterType: { attribute: 'filter-type' },\r\n    cssFilter: { attribute: 'css-filter' },\r\n    cssHeader: { attribute: 'css-header' },\r\n    color: { ...color},\r\n    ...GSData.PROPERTIES\r\n  }\r\n\r\n  static properties = {\r\n    storage: {},\r\n    color: { ...color },\r\n    colorFilter: { ...color, attribute: 'filter-color' },\r\n    colorHead: { ...color, attribute: 'head-color' },\r\n    colorSelect: { ...color, attribute: 'select-color' },\r\n    colorSort: { ...color, attribute: 'sort-color' },\r\n    stripedColumn: { type: Boolean, attribute: 'striped-column' },\r\n    cssFilter: { attribute: 'css-filter' },\r\n    cssHeader: { attribute: 'css-header' },\r\n    divider: { type: Boolean },\r\n    striped: { type: Boolean },\r\n    hover: { type: Boolean },\r\n    small: { type: Boolean },\r\n    grid: { type: Boolean },\r\n    borderless: { type: Boolean },\r\n\r\n    sort: { type: Array, state: true },\r\n    columns: { type: Array, state: true },\r\n    key: { type: Number, state: true },\r\n    data: { type: Array },\r\n    \r\n    datacolumn: { type: Boolean },\r\n    multisort: { type: Boolean },\r\n    multiselect: { type: Boolean },\r\n    protected: { type: Boolean },\r\n    selectable: { type: Boolean },\r\n    toggle: { type: Boolean },\r\n    sortable: { type: Boolean },\r\n  }\r\n\r\n  #config = [];\r\n  #sortOrder = [];\r\n  #auto = false;\r\n\r\n  constructor() {\r\n    super();\r\n    this.headColor = 'secondary';\r\n    this.colorSelect = 'info';\r\n    this.columns = [];    \r\n    this.data = [];\r\n    this.sort = [];\r\n    this.key = 0;\r\n  }\r\n\r\n  get selected() {\r\n    return this.dataController?.selected;\r\n  }\r\n\r\n  set search(val) {\r\n    const me = this;\r\n    if (me.storage && me.dataController) {\r\n      return me.dataController.search = val;\r\n    }\r\n  }\r\n\r\n  connectedCallback() {\r\n    const me = this;\r\n    me.#config = GSItem.proxify(me, GSTableElement.CELLS);\r\n    if (me.columns.length === 0) me.columns = me.#config.map(v => v.name);\r\n    /* TODO - auto storage prevents using plain table with \r\n       columns, data properties programmatically\r\n    if (!me.storage) {      \r\n      me.storage = me.#auto = GSID.next('table-');\r\n    }\r\n    */\r\n    super.connectedCallback();\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    super.disconnectedCallback();\r\n    this.dataController?.clearSelected(this.data);\r\n    this.data = [];\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'user-select-none': me.protected,\r\n      'table': true,\r\n      'table-sm': me.small,\r\n      'table-hover': me.hover,\r\n      'table-striped': me.striped,\r\n      'table-bordered': me.grid,\r\n      'table-borderless': me.borderless,\r\n      'table-striped-columns': me.stripedColumns,\r\n      [`table-${me.color}`]: me.color,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  firstUpdated() {\r\n    this.dataController?.read();\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    const me = this;\r\n    if (me.columns.length != me.sort.length) me.sort = Array(me.columns.length).fill(0);\r\n    if (me.datacolumn && me.data.length > 0) {\r\n      me.columns = me.data[0];\r\n      me.data = me.data.slice(1);\r\n    }\r\n    if (changed.has('multiselect') && !me.multiselect) me.dataController?.clearSelected();\r\n    if (changed.has('selectable') && !me.selectable) me.dataController?.clearSelected();\r\n    if (changed.has('sortable') || changed.has('multisort')) {\r\n      me.sort = Array(me.columns.length).fill(0);\r\n      me.#sortOrder = [];\r\n    }\r\n\r\n    super.willUpdate(changed);\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const headColor = me.colorHead ? `table-${me.colorHead}` : '';\r\n    return html`\r\n      <table  \r\n       dir=\"${ifDefined(me.direction)}\"\r\n       @keyup=\"${me.#onKeyUp}\"\r\n       @keydown=\"${me.#onKeyDown}\"\r\n       class=\"${classMap(me.renderClass())}\">\r\n        <thead class=\"${ifDefined(headColor)}\">\r\n          ${me.#renderFilters()}\r\n          <tr @click=${me.#onSort}>\r\n            ${me.columns.map((entry, index) => me.#renderColumn(entry, index))}\r\n          </tr>\r\n        </thead>\r\n        <tbody @click=${me.#onSelect} @contextmenu=${me.#onSelect} class=\"${me.divider ? 'table-group-divider' : ''}\" role=\"button\">\r\n          ${me.data.map((entry, index) => me.#renderRecord(entry, index))}\r\n          ${me.#renderEmpty()}\r\n        </tbody>\r\n      </table>\r\n      <slot name=\"extra\">${me.#renderHandler()}</slot>\r\n    `;\r\n  }\r\n\r\n  #renderHandler() {\r\n    const me = this;\r\n    return me.#auto ? html`<gs-data-handler type=\"cached\" mode=\"\" id=${me.#auto} generated></gs-data-handler>` : '';\r\n  }\r\n\r\n  onDataRead(data) {\r\n    const me = this;\r\n    me.data = data;\r\n    //me.dataController?.clearSelected();\r\n\r\n    // update filtering\r\n    if (data.length > 0 && me.#hasFilters) {\r\n      me.#config.forEach((entry, index) => {\r\n        entry.columnType = me.#columType(index);\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear table filters\r\n   */\r\n  clear() {\r\n    this.#input.forEach(el => el.value = '');\r\n    this.dataController?.filter([]);\r\n  }\r\n\r\n  valueAt(row, cell) {\r\n    return this.data.length > row ? this.data[row][cell] : undefined;\r\n  }\r\n\r\n  get #input() {\r\n    return this.queryAll('th > input, th > select', true);\r\n  }\r\n\r\n  get #hasFilters() {\r\n    return this.#config.filter(o => o.filter).length > 0;\r\n  }\r\n\r\n  #columType(index) {\r\n    const me = this;\r\n    const cfg = me.#config[index];\r\n    const cell = me.valueAt(0, me.columns[index]);\r\n    cfg.type = cfg.type || 'text';\r\n    const cfgType = { 'string': 'text', 'currency': 'number', 'timestamp': 'datetime-local' }[cfg.type]\r\n    const dataType = cell instanceof Date ? 'date' : typeof cell;\r\n    return cell ? dataType : cfgType || cfg.type;\r\n  }\r\n\r\n  #renderFilters() {\r\n    const me = this;\r\n    return me.#hasFilters ? html`<tr>${me.columns.map((entry, index) => me.#renderFilter(entry, index))}</tr>` : '';\r\n  }\r\n\r\n  #renderFilter(cell, index) {\r\n    const me = this;\r\n    const cfg = me.#config[index];\r\n    if (!cfg?.filter) return html`<th></th>`;\r\n\r\n    let mask = undefined;\r\n    const hasSub = cfg.childElementCount > 0;\r\n    const isDate = cfg.columnType === 'date';\r\n    if (isDate) mask = cfg.format || GSUtil.getDateFormat(cfg.language || GSUtil.language);\r\n    const css = `${GSUtil.normalize(me.cssFilter)} ${GSUtil.normalize(cell.cssFilter)}`; \r\n    const color = `text-bg-${GSUtil.normalize(cell.color || me.colorFilter)}`; \r\n    \r\n\r\n    if ((hasSub || cfg.list) && cfg.fixed) {\r\n      return html`<th .index=${index} @change=\"${me.#onFilter}\">\r\n          <select is=\"gs-ext-select\" .index=${index}\r\n              class=\"form-select ${css} ${color}\" \r\n              name=\"${cell}\"\r\n              storage=\"${ifDefined(cfg.list ? me.storage : null)}\"\r\n              key=\"${ifDefined(cfg.list ? cfg.name : null)}\"> \r\n              ${me.#renderOption(cfg)}\r\n              </select>\r\n          </th>`;\r\n    }\r\n\r\n    let listid = '';\r\n    let list = undefined;\r\n    if (hasSub || cfg.list) {\r\n      listid = `${me.id}-list-${index}`;\r\n      list = html`<datalist id=\"${listid}\" is=\"gs-ext-datalist\"\r\n              storage=\"${ifDefined(cfg.list ? me.storage : null)}\"\r\n              key=\"${ifDefined(cfg.list ? cfg.name : null)}\"> \r\n              ${me.#renderOption(cfg)}</datalist>`;\r\n    } \r\n\r\n    return html`<th .index=${index} @change=\"${me.#onFilter}\">\r\n    <input is=\"gs-ext-input\" .index=${index}\r\n      class=\"form-control ${css} ${color}\" \r\n      mask=\"${ifDefined(mask)}\"\r\n      list=\"${ifDefined(listid)}\"\r\n      name=\"${cell}\" \r\n      placeholder=\"${ifDefined(cfg.title)}\" \r\n      type=\"${cfg.filterType || cfg.columnType}\"\r\n      data-slots=\"${ifDefined(isDate ? 'DMY' : undefined)}\"/>\r\n    ${list}\r\n    </th>`;\r\n  }\r\n\r\n  #renderOption(cfg) {\r\n    if (cfg.childElementCount == 0) return '';\r\n    const sub = GSItem.proxify(cfg);\r\n    return sub.map(el => html`<option value=\"${el.value}\">${cfg.fixed ? el.map : ''}</option>`);\r\n  }\r\n\r\n  #renderColumn(cell, index) {\r\n    const me = this;\r\n    const cfg = me.#config[index];\r\n    if (cfg?.hidden) return '';\r\n    const css = `${GSUtil.normalize(me.cssHeader)} ${GSUtil.normalize(cell.cssHeader)}`; \r\n    return html`\r\n      <th .index=${index} class=\"${css}\" \r\n        colspan=\"${ifDefined(cfg?.colspan)}\"\r\n        width=\"${ifDefined(cfg?.width)}\">\r\n        <div class=\"d-flex justify-content-between\"> \r\n          <span>${cfg?.title || cell}</span>\r\n          ${me.#renderIcon(index)}\r\n        </div>\r\n      </th>\r\n    `\r\n  }\r\n\r\n  #renderIcon(index) {\r\n    const me = this;\r\n    if (!me.sortable) return '';\r\n    const icons = GSTableElement.#icons;\r\n    const sortType = me.sort[index];\r\n    const order = me.multisort ? me.#sortOrder.indexOf(index) + 1 : '';\r\n    return html`<gs-icon name=\"${icons[sortType + 1]}\" super=\"${order > 0 ? order : ''}\" color=\"${ifDefined(me.colorSort)}\"></gs-icon>`;\r\n  }\r\n\r\n  #renderRecord(entry, index) {\r\n    const me = this;\r\n    const controller = me.dataController || DataSelector;\r\n    const selected = controller?.isSelected(entry);\r\n    const color = me.colorSelect && selected ? `table-${me.colorSelect}` : '';\r\n    const cells = me.#remapRecord(entry);\r\n    return html`\r\n        <tr .index=${index} class=\"${color}\" tabindex=\"0\" ?selected=${selected}>\r\n          ${cells.map((cell, i) => me.#renderCell(cell, i))}\r\n        </tr>\r\n      `;\r\n  }\r\n\r\n  #renderCell(cell, index) {\r\n    const cfg = this.#config[index];\r\n    if (cfg?.hidden) return '';\r\n    return html`<td class=\"text-${cfg?.align}\" colspan=\"${ifDefined(cfg?.colspan)}\" ><span>${cell}</span></td>`;\r\n  }\r\n\r\n  #remapRecord(record) {\r\n    const me = this;\r\n    if (!Array.isArray(record)) record = me.columns.map(v => record[v]);\r\n    return record.map((val, i) => me.#config[i] ? GSData.format(me.#config[i], val) : val);\r\n  }\r\n\r\n  #renderEmpty() {\r\n    const me = this;\r\n    return me.data.length > 0 ?  '' :\r\n    html`<tr data-ignore=\"true\"><td colspan=\"${me.columns.length}\" class=\"text-center fw-bold text-muted\">${me.translate('No Data')}</td></tr>`;\r\n  }\r\n\r\n  #elementTofilter(el) {\r\n    if (!el.value) return undefined;\r\n    const isDate = el.type === 'date';\r\n    const val = isDate ? el.valueAsDate : el.value;\r\n    const cfg = this.#config[el.index];\r\n    return { name: el.name, value: val, language : cfg?.language };\r\n  }\r\n\r\n  #onFilter(e) {\r\n    \r\n    const me = this;\r\n    \r\n    const filter = me.#input\r\n      .map(el => me.#elementTofilter(el))\r\n      .filter(el => el?.value);\r\n\r\n    if (me.storage) {\r\n      me.dataController?.filter(filter);\r\n    } else {\r\n      // TODO keep full data, use sorted\r\n      // GSData.filter(me.data, filter);\r\n    }\r\n  }  \r\n\r\n  #onSort(e) {\r\n    \r\n    const me = this;\r\n    \r\n    if (!me.sortable) return;\r\n    \r\n    const icon = e.target.tagName === 'GS-ICON' ? e.target : e.target.closest('gs-icon');\r\n    const column = e.target.closest('th');\r\n    if (!icon || !column) return;\r\n\r\n    const idx = column.index !== undefined ? column.index : GSDOM.getElementIndex(column);\r\n    const current = me.sort[idx];\r\n    const sortType = current === 1 ? -1 : current + 1;\r\n\r\n    if (me.multisort) {\r\n      if (sortType == 0) {\r\n        me.#sortOrder = me.#sortOrder.filter(v => v != idx);\r\n      } else if (!me.#sortOrder.includes(idx)) {\r\n        me.#sortOrder.push(idx);\r\n      }\r\n    } else {\r\n      me.sort = Array(me.columns.length).fill(0);\r\n      me.#sortOrder = [idx];\r\n    }\r\n\r\n    me.sort[idx] = sortType;\r\n\r\n    const sort = me.#prepareSorter(me.sort, me.#sortOrder);\r\n\r\n    if (me.storage) {\r\n      me.dataController?.sort(sort);\r\n    } else {\r\n      me.data = GSData.sortData(me.data, sort);\r\n    }\r\n\r\n    me.emit('sort');\r\n  }\r\n\r\n  #prepareSorter(sort, sortOrder) {\r\n    \r\n    const me = this;\r\n\r\n    if (sort.filter(v => v).length === 0) {\r\n      sort = Array(me.columns.length).fill(0);\r\n      sort[me.key] = 1;\r\n    }\r\n\r\n    // if data record is object (not simple array)\r\n    const isComplex = me.data[0] && !Array.isArray(me.data[0]);\r\n\r\n    // sort list \r\n    const list = sort.map((v, i) => v ? { name: isComplex ? me.columns[i] : undefined, col: i, ord: v, idx: sortOrder.indexOf(i) } : null).filter(v => v);\r\n\r\n    // order sort list by idx\r\n    sort = GSData.sortData(list, [{ name: 'idx', ord: 1 }]);\r\n\r\n    return sort;\r\n  }\r\n\r\n  #onSelect(e) {\r\n    \r\n    const me = this;\r\n    \r\n    if (!me.selectable) return;\r\n    \r\n    const tr = e.target.tagName === 'TR' ? e.target : e.target.closest('tr');\r\n    if (!tr) return;\r\n    \r\n    // if context menu is attached and right click made\r\n    if (e.button === 2 && !me.query('gs-context')) return;\r\n    \r\n    const controller = me.dataController || DataSelector;\r\n    if (!controller) return;\r\n\r\n    const record = me.data[tr.index];\r\n    const isSelected = controller.isSelected(record);\r\n    if (me.multiselect) {\r\n      if (isSelected) {\r\n        controller.removeSelected(record);\r\n      } else {\r\n        controller.addSelected(record);\r\n      }\r\n    } else if (me.toggle) {\r\n      controller.clearSelected(me.data);\r\n      if (!isSelected) {\r\n        controller.addSelected(record);\r\n      }\r\n    } else {\r\n      controller.clearSelected(me.data);\r\n      controller.addSelected(record);\r\n    }\r\n    me.requestUpdate();\r\n    me.emit('select');\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n\r\n    if (!e.target.matches('tbody tr')) return;\r\n    let el = null;\r\n\r\n    switch (e.code) {\r\n      case 'ArrowUp':\r\n        el = e.target.previousElementSibling;\r\n        break;\r\n      case 'ArrowDown':\r\n        el = e.target.nextElementSibling;\r\n        break;\r\n    }\r\n\r\n    if (el) {\r\n      el.focus();\r\n      this.emit('focus', el);\r\n    }\r\n  }\r\n\r\n  #onKeyUp(e) {\r\n    if (e.code === 'Space') this.#onSelect(e);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-table');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSTag class\r\n * @module components/GSTag\r\n */\r\n\r\nimport { createRef, ref, classMap, css, html, ifDefined } from '../lib.mjs';\r\nimport { stringArrayConverter, color } from '../properties/index.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\n\r\n/**\r\n * Tag list element\r\n * \r\n * @class\r\n * @extends {GSTagElement}\r\n */\r\nexport default class GSTagElement extends GSElement {\r\n\r\n    static #KEYS = ['Enter', 'NumpadEnter', 'Comma', 'Space'];\r\n\r\n    static styles = css`\r\n        .tag-input:focus-visible {\r\n            outline:none;\r\n        }\r\n        .tag .btn-close {\r\n            background: none;\r\n        }            \r\n        .tag .btn-close::after {\r\n            content: 'x';\r\n        }`;\r\n\r\n    static properties = {\r\n        placeholder: {},\r\n        max: { type: Number },\r\n        size: { type: Number },\r\n        name: {},\r\n        data: { type: Array },\r\n        values: { type: Array, reflect: true, converter: stringArrayConverter },\r\n        appendable: { type: Boolean },\r\n        color: { ...color },\r\n        closeColor: { ...color, attribute: 'close-color' },\r\n        cssClose: { attribute: 'css-close' },\r\n        cssTag: { attribute: 'css-tag' },\r\n    }\r\n\r\n    // GS-ITEM attributes mapping\r\n    static options = {\r\n        name: {}\r\n    }\r\n\r\n    #dataListRef = createRef();\r\n    #inputRef = createRef();\r\n\r\n    constructor() {\r\n        super();\r\n        this.name = '';\r\n        this.data = this.#items;\r\n        this.closeColor = 'light';\r\n        this.color = 'primary';\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        const tags = me.#renderTags();\r\n        return html`\r\n        <div  dir=\"${ifDefined(me.direction)}\" \r\n            class=\"${classMap(me.renderClass())}\"\r\n            @click=\"${me.#onClick.bind(me)}\">\r\n            ${tags}\r\n            <input type=\"text\" \r\n            @keydown=\"${me.#onKeyDown.bind(me)}\"\r\n            @input=\"${me.#onInput.bind(me)}\"\r\n            ${ref(me.#inputRef)}\r\n            name=\"${me.name}\" \r\n            list=\"${me.name}_list\"\r\n            class=\"form-control d-flex w-auto flex-grow-1\" \r\n            placeholder=\"${me.#info}\">\r\n            <datalist ${ref(me.#dataListRef)} id=\"${me.name}_list\">${me.#renderList()}</datalist>\r\n        </div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            \"d-flex\": true,\r\n            \"flex-wrap\": true,\r\n            \"align-items-center\": true,\r\n            \"gap-1 \": true,\r\n        }\r\n        return css;\r\n    }\r\n\r\n    get #info() {\r\n        const me = this;\r\n        const alt = me.max > 0 ? `Add max ${me.max} tags...` : '';\r\n        return me.placeholder ? me.placeholder : alt;\r\n    }\r\n\r\n    #onInput(e) {\r\n        if (!e.inputType) this.#updateTag(e);\r\n    }\r\n\r\n    #onKeyDown(e) {\r\n        if (GSTagElement.#KEYS.includes(e.code)) this.#updateTag(e);\r\n    }\r\n\r\n    #onClick(e) {\r\n        const isClose = e.srcElement === e.target && e.target instanceof HTMLButtonElement;\r\n        if (isClose) this.#removeTag(e.target.parentElement);\r\n    }\r\n\r\n    #updateTag(e) {\r\n        GSEvents.prevent(e);\r\n        const me = this;\r\n        me.#addTag(me.#selected);\r\n    }\r\n\r\n    get #isMax() {\r\n        const me = this;\r\n        return me.max > 0 && me.data.length >= me.max;\r\n    }\r\n\r\n    get #options() {\r\n        return Array.from(this.#datalist.children);\r\n    }\r\n\r\n    get #selected() {\r\n        const me = this;\r\n        return me.#options.filter(el => el.value.toLowerCase() === me.#input.value.toLowerCase()).pop();\r\n    }\r\n\r\n    #addTag(optEl) {\r\n        const me = this;\r\n        const fld = me.#input;\r\n        if (me.#isMax || (!optEl && me.appendable == false)) {\r\n            fld.value = '';\r\n            return;\r\n        }\r\n        if (!me.values.includes(fld.value)) {\r\n            me.values.push(fld.value);\r\n            fld.value = '';\r\n            me.requestUpdate();\r\n        }\r\n    }\r\n\r\n    #removeTag(tagEl) {\r\n        if (!tagEl) return;\r\n        const me = this;\r\n        const value = tagEl.dataset.value;\r\n        me.values = me.values.filter(v => v != value);\r\n    }\r\n\r\n    #renderTags() {\r\n        const me = this;\r\n        return me.values.map(v => me.#renderTag(v));\r\n    }\r\n\r\n    #renderTag(val = '') {\r\n        if (!val) return '';\r\n        const me = this;\r\n        const size = me.size > 0 ? `fs-${me.size}` : '';\r\n        return html`<div class=\"${classMap(me.#tagClass)}\" data-value=\"${val}\">${val}<button type=\"button\" class=\"${classMap(me.#btnClass)}\"></button></div>`;\r\n    }\r\n\r\n    get #tagClass() {\r\n        const me = this;\r\n        const opt = {\r\n            badge: true,\r\n            tag: true,\r\n            [`fs-${me.size}`]: me.size > 0,\r\n            [`text-bg-${me.color}`]: me.color ? true : false\r\n        }\r\n        return me.mapCSS(me.cssTag, opt);\r\n    }\r\n\r\n    get #btnClass() {\r\n        const me = this;\r\n        const opt = {\r\n            'btn-close': true,\r\n            'ms-1': true,\r\n            [`text-bg-${me.closeColor}`]: me.closeColor ? true : false\r\n        }\r\n        return me.mapCSS(me.cssClose, opt);\r\n    }\r\n\r\n    #renderList() {\r\n        const me = this;\r\n        return me.data.map(v => html`<option value=\"${v}\">`);\r\n    }\r\n\r\n    /**\r\n     * Proxify GS-ITEM elements to easily read attributes\r\n     */\r\n    #proxify(root) {\r\n        return GSItem.collect(root).map(el => GSAttr.proxify(el));\r\n    }\r\n\r\n    get #items() {\r\n        return this.#proxify(this).map(el => el.name).filter(v => v ? true : false);\r\n    }\r\n\r\n    get #input() {\r\n        return this.#inputRef.value;\r\n    }\r\n\r\n    get #datalist() {\r\n        return this.#dataListRef.value;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-tag');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSTextElement extends GSElement {\r\n\r\n  #text = \"\";\r\n\r\n  constructor() {\r\n    super();\r\n    this.flat = true;\r\n    this.#text = this.innerText;\r\n    this.innerText = \"\";\r\n  }\r\n\r\n  renderUI() {\r\n    return this.translate(this.#text);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-text');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, ref, classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { placement } from '../properties/index.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSPopper } from '../base/GSPopper.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\n\r\nexport class GSTooltipElement extends GSElement {\r\n\r\n  static properties = {\r\n    placement: { ...placement },\r\n    title: {},\r\n    target: {},\r\n    opened: { type: Boolean },\r\n    local: { type: Boolean },\r\n  }\r\n\r\n  #arrowRef = createRef();\r\n  #panelRef = createRef();\r\n  #styleID = GSID.id;\r\n  #arrowStyle = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    this.placement = 'top';\r\n    this.dynamicStyle(this.#styleID);\r\n    this.dynamicStyle(this.#arrowStyle);\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.connectedCallback();\r\n    const me = this;\r\n    me.#attachEvents();\r\n    me.#reposition();\r\n    super.firstUpdated(changed);\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    this.#reposition();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`\r\n    <div ${ref(me.#panelRef)} \r\n      dir=\"${ifDefined(me.direction)}\"\r\n      role=\"tooltip\"\r\n      data-popper-placement=\"${me.placement}\"\r\n      data-gs-class=\"${me.#styleID}\"\r\n      class=\"${classMap(me.renderClass())}\">\r\n      <div ${ref(me.#arrowRef)} \r\n          class=\"tooltip-arrow ${me.#arrowStyle}\" \r\n          data-gs-class=\"${me.#arrowStyle}\">\r\n      </div>\r\n      <div class=\"tooltip-inner\">${me.translate(me.title)}</div>\r\n    </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'tooltip': true,\r\n      'bs-tooltip-auto': true,\r\n      'fade': true,\r\n      'show': me.opened,\r\n      [me.#styleID]: true\r\n    }\r\n    return css;\r\n  }\r\n\r\n  open() {\r\n    this.opened = true;\r\n  }\r\n\r\n  close() {\r\n    this.opened = false;\r\n  }\r\n\r\n  toggle() {\r\n    this.opened = !this.opened;\r\n  }\r\n\r\n  #attachEvents() {\r\n    const me = this;\r\n    me.attachEvent(me.#ref, 'mouseenter', me.open.bind(me));\r\n    me.attachEvent(me.#ref, 'mouseleave', me.close.bind(me));\r\n  }\r\n\r\n  #reposition() {\r\n    const me = this;\r\n    const arrowEl = me.#arrow;\r\n    const panelEl = me.#panel;\r\n    if (!panelEl) return;\r\n    if (me.opened) {\r\n      GSPopper.popupFixed(me.placement, panelEl, me.#ref, arrowEl);\r\n    } else {\r\n      me.dynamicStyle(me.#styleID, { top: '-1000px', left: '-1000px' });\r\n    }\r\n  }\r\n\r\n  get #ref() {\r\n    const me = this;\r\n    switch (me.target) {\r\n      case '@parent':\r\n        return this.parentElement;\r\n      case '@previous':\r\n        return this.previousElementSibling;\r\n      case '@next':\r\n        return this.nextElementSibling;\r\n      default:\r\n        return me.local ? me.#refLocal : me.#refGlobal;\r\n    }\r\n  }\r\n\r\n  get #refLocal() {\r\n    const root = GSDOM.root(this);\r\n    return GSDOM.query(root, this.target);\r\n  }\r\n  \r\n  get #refGlobal() {\r\n    return GSDOM.query(document.body, this.target);\r\n  }\r\n\r\n  get #arrow() { return this.#arrowRef.value; }\r\n  get #panel() { return this.#panelRef.value; }\r\n\r\n  static {\r\n    this.define('gs-tooltip');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { notEmpty } from '../properties/index.mjs';\r\n\r\nexport class GSTemplateElement extends GSElement {\r\n\r\n  static properties = {\r\n    src: { reflect: true, hasChanged: notEmpty }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  createRenderRoot() {\r\n    const me = this;\r\n    if (me.flat) {\r\n      me.renderOptions.renderBefore = me;\r\n      return me.parentElement;\r\n    }\r\n    return super.createRenderRoot();\r\n  }\r\n\r\n  renderUI() {\r\n    return html`${this.renderTemplate()}`;\r\n  }\r\n\r\n\ttemplateInjected() {\r\n\t\tthis.emit('template-injected', null, true, true);\r\n\t}\r\n\r\n  static {\r\n    this.define('gs-template');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../../../base/GSUtil.mjs\";\r\n\r\n/**\r\n * Handle automatic field value copy and select\r\n */\r\nexport class CopySelectController {\r\n\r\n  #host;\r\n\r\n  #clickCallback;\r\n  #copyCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#clickCallback = me.#onClick.bind(me);\r\n    me.#copyCallback = me.#onCopy.bind(me);\r\n    host.addController?.(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.#host.on?.('click', me.#clickCallback);\r\n    me.#host.on?.('copy', me.#copyCallback);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController?.(me);\r\n    me.#host.off?.('click', me.#clickCallback);\r\n    me.#host.off?.('copy', me.#copyCallback);\r\n  }\r\n\r\n  #onCopy() {\r\n    GSUtil.writeToClipboard(this.#host.value);\r\n  }\r\n\r\n  #onClick(e) {\r\n      const me = this;\r\n      if (me.#host.autocopy) GSUtil.writeToClipboard(me.#host.value);\r\n      if (me.#host.autoselect) me.#host.select();\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../../../base/GSUtil.mjs\";\r\n\r\n\r\n/**\r\n * Handle field mask \r\n */\r\nexport class MaskController {\r\n\r\n  static #special = '.^$*+?()[]{}\\|';\r\n\r\n  static #maskType = {\r\n    x: /[0-9a-fA-F]/g,\r\n    n: /[0-9]/g,\r\n    y: /[0-9]/g,\r\n    m: /[0-9]/g,\r\n    d: /[0-9]/g,\r\n    h: /[0-9]/g,\r\n    s: /[0-9]/g,\r\n    '.': /[0-9]/g,\r\n    '#': /[a-zA-Z]/g,\r\n    '*': /[0-9a-zA-Z]/g,\r\n    '_': /./g\r\n  };\r\n\r\n  #back = false;\r\n  #slots;\r\n  #prev;\r\n  #first;\r\n  #accept;\r\n  #pattern;\r\n\r\n  #host;\r\n\r\n  #keyDownCallback;\r\n  #inputCallback;\r\n  #focusCallback;\r\n  #changeCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.initRules();\r\n    me.#keyDownCallback = me.#onKeyDown.bind(me);\r\n    me.#inputCallback = me.#format.bind(me);\r\n    me.#focusCallback = me.#onFocus.bind(me);\r\n    me.#changeCallback = me.#onChange.bind(me);\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.initRules();\r\n    me.#host.on('keydown', me.#keyDownCallback);\r\n    me.#host.on('input', me.#inputCallback);\r\n    me.#host.on('focus', me.#focusCallback);\r\n    me.#host.on('change', me.#changeCallback);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host.off('keydown', me.#keyDownCallback);\r\n    me.#host.off('input', me.#inputCallback);\r\n    me.#host.off('focus', me.#focusCallback);\r\n    me.#host.off('change', me.#changeCallback);\r\n  }\r\n\r\n  initRules() {\r\n    const me = this;\r\n    if (!me.pattern) return;\r\n    me.#slots = me.#buildSlots();\r\n    me.#prev = (j => Array.from(me.pattern, (c, i) => me.#slots.has(c) ? j = i + 1 : j))(0);\r\n    me.#first = [...me.pattern].findIndex(c => me.#slots.has(c));\r\n    me.#accept = me.#buildAccept();\r\n    me.#toPattern();\r\n  }\r\n\r\n  checkValidity() {  \r\n    const me = this;  \r\n    let isMatch = true;\r\n    if (me.isValid) {\r\n      isMatch = me.isEmpty || me.isMatch;\r\n      if (!isMatch) me.setCustomValidity('Mask not matched!');\r\n    }\r\n    return me.isValid && isMatch;\r\n  }\r\n\r\n  setCustomValidity(val) {\r\n    return this.#host.setCustomValidity(val);\r\n  }\r\n    \r\n  setSelectionRange(i, j) {\r\n    this.#host.setSelectionRange(i, j);\r\n  }\r\n\r\n  select() {\r\n    this.#host.select();\r\n  }\r\n\r\n  get isEmpty() {\r\n    return GSUtil.isStringEmpty(this.raw);\r\n  }\r\n\r\n  get isValid() {\r\n    return this.#host.validity.valid;\r\n  }\r\n\r\n  get value() {\r\n    const [i, j] = this.#range();\r\n    return this.raw.substring(0, j);\r\n  }\r\n\r\n  set value(val) {\r\n    this.#host.value = val;\r\n  }\r\n\r\n  get raw() {\r\n    return this.#host.raw;\r\n  }\r\n\r\n  get required() {\r\n    return this.#host.required;\r\n  }\r\n\r\n  get pattern() {\r\n    return this.#host.mask;\r\n  }\r\n\r\n  get dataset() {\r\n    return this.#host.dataset;\r\n  }\r\n\r\n  get selectionStart() {\r\n    return this.#host.selectionStart;\r\n  }\r\n\r\n  get selectionEnd() {\r\n    return this.#host.selectionEnd;\r\n  }\r\n\r\n  get autoselect() {\r\n    return this.#host.autoselect;\r\n  }\r\n\r\n  get isMatch() {\r\n    const me = this;\r\n\r\n    let isMatch = true;\r\n    if (me.#pattern) {\r\n      me.#pattern.lastIndex = 0;\r\n      isMatch = me.#pattern.test(me.raw);\r\n    }\r\n\r\n    return isMatch;\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n    this.#back = e.key === \"Backspace\";\r\n  }\r\n\r\n  #onFocus(e) {\r\n    const me = this;\r\n    me.#format();\r\n    if (me.autoselect) me.select();\r\n  }\r\n\r\n  #onChange(e) {\r\n    const me = this;\r\n    me.#format();\r\n  }\r\n\r\n  /**\r\n   * If data-slots not defined, try to detect automatically\r\n   * @returns \r\n   */\r\n  #buildSlots() {\r\n    const me = this;\r\n    let slots = me.dataset.slots;\r\n    if (!slots) {\r\n      const maskType = MaskController.#maskType;\r\n      slots = [...new Set(me.pattern)]\r\n        .filter(v => maskType[v.toLowerCase()])\r\n        .join('');\r\n    }\r\n    return new Set(slots || \"_\");\r\n  }\r\n\r\n  /**\r\n   * If data-accept not defined, try to detect automatically\r\n   * @returns \r\n   */\r\n  #buildAccept() {\r\n    const me = this;\r\n    let accept = me.dataset.accept;\r\n    if (!accept) {\r\n      const maskType = MaskController.#maskType;\r\n      accept = [...new Set(me.pattern)]\r\n        .map(v => maskType[v.toLowerCase()])\r\n        .filter(v => v);\r\n      if (accept.length > 0) {\r\n        const tmp = {};\r\n        accept.forEach(v => tmp[v.src] = v);\r\n        accept = Object.values(tmp);\r\n        return accept.length === 1 ? accept.pop() : accept;\r\n      }\r\n\r\n    }\r\n    return new RegExp(accept || \"\\\\d\", \"g\");\r\n  }\r\n\r\n  #range() {\r\n    const me = this;\r\n    const value = me.raw;\r\n    return [me.selectionStart, me.selectionEnd].map(i => {\r\n      i = me.#clean(value.slice(0, i)).findIndex(c => me.#slots.has(c));\r\n      return i < 0 ? me.#prev[me.#prev.length - 1] : me.#back ? me.#prev[i - 1] || me.#first : i;\r\n    });\r\n  }\r\n\r\n  #format() {\r\n    const me = this;\r\n    const [i, j] = me.#range();\r\n    const val = me.#clean(me.#host.raw);\r\n    me.value = val.join``;\r\n    me.setSelectionRange(i, j);\r\n    me.#back = false;\r\n  }\r\n\r\n  #clean(input) {\r\n    const me = this;\r\n    input = input.match(me.#accept) || [];\r\n    return Array.from(me.pattern, (c, i) => input[i] === c || me.#slots.has(c) ? input.shift() || c : c);\r\n  }\r\n\r\n  #toPattern() {\r\n\r\n    const me = this;\r\n\r\n    if (me.pattern.length === 0) return;\r\n\r\n    const chars = me.pattern.split('');\r\n    const masks = ['^'];\r\n\r\n    const maskType = MaskController.#maskType;\r\n    const special = MaskController.#special;\r\n\r\n    let cnt = 0;\r\n    chars.forEach((v, i) => {\r\n      const m = me.#slots.has(v) ? maskType[v.toLowerCase()] : null;\r\n      if (!m) {\r\n        if (cnt > 0) masks.push(`{${++cnt}}`);\r\n        cnt = 0;\r\n        if (special.includes(v)) masks.push('\\\\');\r\n        return masks.push(v);\r\n      }\r\n\r\n      chars[i] = new RegExp(m, 'g');\r\n\r\n      if (masks.length === 0) return masks.push(m.source);\r\n\r\n      if (masks[masks.length - 1] === m.source) return cnt++;\r\n\r\n      if (cnt > 0) masks.push(`{${++cnt}}`);\r\n      cnt = 0;\r\n      masks.push(m.source);\r\n    });\r\n\r\n    if (cnt > 0) masks.push(`{${++cnt}}`);\r\n    masks.push('$');\r\n\r\n    me.#pattern = new RegExp(masks.join(''), 'g');\r\n    // me.#max = me.pattern.length;\r\n    // me.#masks = chars;\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Handle multiple patterns\r\n */\r\nexport class MultipatternController {\r\n\r\n  #host;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n  }\r\n  \r\n  checkValidity() {    \r\n    const me = this;  \r\n    let isMatch = true;\r\n    if (me.isValid) {\r\n      isMatch = me.isEmpty || me.isMatch;\r\n      if (!isMatch) me.setCustomValidity('Pattern not matched!');\r\n    }\r\n    return me.isValid && isMatch;\r\n  }\r\n\r\n  setCustomValidity(val) {\r\n    return this.#host.setCustomValidity(val);\r\n  }\r\n\r\n  get isValid() {\r\n    return this.#host.validity.valid;\r\n  }\r\n\r\n  get value() {\r\n    return this.#host.value;\r\n  }\r\n\r\n  set value(val) {\r\n    this.#host.value = val;\r\n  }\r\n\r\n  get raw() {\r\n    return this.#host.raw;\r\n  }\r\n\r\n  get required() {\r\n    return this.#host.required;\r\n  }\r\n\r\n  get patterns() {\r\n    const obj = this.#host.multipattern;\r\n    if (obj instanceof RegExp) return [obj];\r\n    if (Array.isArray(obj)) return obj.filter(o => o instanceof RegExp);\r\n    throw new Error('Invalid multipattern value. Expected RegExp object or array.');\r\n  }\r\n\r\n  get dataset() {\r\n    return this.#host.dataset;\r\n  }\r\n\r\n  get isMatch() {\r\n    const me = this;\r\n    let isMatch = true;\r\n    for (const r of me.patterns) {\r\n      isMatch = r.test(me?.value);\r\n      if (isMatch) break;\r\n    }\r\n   \r\n    return isMatch;\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../../../base/GSUtil.mjs\";\r\n\r\n/**\r\n * Handle for input type number to support max length entry\r\n */\r\nexport class NumberController {\r\n\r\n  #host;\r\n\r\n  #inputCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#inputCallback = me.#onInput.bind(me);\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.#host.on('input', me.#inputCallback);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host.off('input', me.#inputCallback);\r\n  }\r\n\r\n  get maxLength() {\r\n    return GSUtil.asNum(this.#host.maxLength, 0);\r\n  }\r\n\r\n  get value() {\r\n    return this.#host.value;\r\n  }\r\n\r\n  set value(val) {\r\n    this.#host.value = val;\r\n  }\r\n\r\n  get type() {\r\n    return this.#host?.type;\r\n  }\r\n    \r\n  #onInput(e) {\r\n    const me = this;\r\n    if (me.type === 'number') return me.#onNumberInput(e);\r\n  }\r\n\r\n  #onNumberInput(e) {\r\n    const me = this;\r\n    if (me.maxLength > 0 && me.value.length > me.maxLength) {\r\n        me.value = me.value.substring(0, me.maxLength);\r\n    }\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Handle for input tpye password to support keyboard shortcut for password reveal.\r\n */\r\nexport class PasswordController {\r\n\r\n  #host;\r\n\r\n  #revealing = false;\r\n\r\n  #keyUpCallback;\r\n  #keyDownCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#keyUpCallback = me.#onKeyUp.bind(me);\r\n    me.#keyDownCallback = me.#onKeyDown.bind(me);\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.#host.on('keyup', me.#keyUpCallback);\r\n    me.#host.on('keydown', me.#keyDownCallback);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host.off('keyup', me.#keyUpCallback);\r\n    me.#host.off('keydown', me.#keyDownCallback);\r\n  }\r\n\r\n  get reveal() {\r\n    return this.#host.hasAttribute('reveal');\r\n  }\r\n\r\n  get type() {\r\n    return this.#host?.type;\r\n  }\r\n\r\n  set type(val) {\r\n    if (this.#host) this.#host.type = val;\r\n  }\r\n\r\n  #isReveal(e) {\r\n    return this.reveal && e.key === 'Shift' && e.altKey && e.shiftKey && this.type === 'password';\r\n  }\r\n\r\n  #onKeyUp(e) {\r\n    const me = this;\r\n    if (e.key === 'Shift' && me.#revealing) {\r\n      me.type = 'password';\r\n    }\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n    const me = this;\r\n    if (me.#isReveal(e)) {\r\n      me.#revealing = true;\r\n      me.type = 'text';\r\n    }\r\n  }\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSCSSMap } from \"../../../base/GSCSSMap.mjs\";\r\nimport { GSUtil } from \"../../../base/GSUtil.mjs\";\r\n\r\n/**\r\n * Handle for input type text to support text value changes based on CSS\r\n */\r\nexport class TextController {\r\n\r\n  #host;\r\n\r\n  #inputCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#inputCallback = me.#onInput.bind(me);\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.#host.on('input', me.#inputCallback);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host.off('input', me.#inputCallback);\r\n  }\r\n\r\n  get value() {\r\n    return this.#host.value;\r\n  }\r\n\r\n  set value(val) {\r\n    this.#host.value = val;\r\n  }\r\n\r\n  get type() {\r\n    return this.#host?.type;\r\n  }\r\n\r\n  #onInput(e) {\r\n    const me = this;\r\n    if (me.type === 'text') me.value = me.#updateText(me.value);\r\n  }\r\n\r\n  #updateText(value = '') {\r\n    const map = GSCSSMap.styleValue(this.#host, 'text-transform');\r\n    if (map) value = GSUtil.textTransform(map.value, value);\r\n    return value;\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSAttr } from \"../../../base/GSAttr.mjs\";\r\nimport { GSDOM } from \"../../../base/GSDOM.mjs\";\r\nimport { GSEvents } from \"../../../base/GSEvents.mjs\";\r\n\r\n/**\r\n * Handle data filtering for options atribute (combo and data lists)\r\n * Changes in one field list, update available selections in another field selections.\r\n */\r\nexport class InteractiveController {\r\n\r\n  #host;\r\n\r\n  #monitorCallback;\r\n  #changeCallback;\r\n  #blurCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#blurCallback = me.#onBlur.bind(me);\r\n    me.#monitorCallback = me.#onMonitor.bind(me);\r\n    me.#changeCallback = me.#onDataChange.bind(me);\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    const list = me.list;\r\n    if (list) {\r\n      me.#host.on('blur', me.#blurCallback);\r\n      me.#host.on('change', me.#changeCallback);\r\n      me.#host.attachEvent(me.filter, 'change', me.#monitorCallback);\r\n    }\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host.off('blur', me.#blurCallback);\r\n    me.#host.off('change', me.#changeCallback);\r\n    me.#host.removeEvent(me.filter, 'change', me.#monitorCallback);\r\n  }\r\n\r\n  hostUpdated() {\r\n    // trigger only first time\r\n    if (!this.#host.hasUpdated) {\r\n      this.#onDataChange();\r\n    }\r\n  }\r\n\r\n  get component() {\r\n    return this.#host\r\n  }\r\n\r\n  get value() {\r\n    return this.#host.value;\r\n  }\r\n\r\n  set value(val) {\r\n    this.#host.value = val;\r\n  }\r\n\r\n  get list() {\r\n    return this.#host;\r\n  }\r\n\r\n  get filter() {\r\n    const me = this;\r\n    const filter = GSAttr.get(me.#host, 'data-filter');\r\n    return GSDOM.getByID(me.owner, filter);\r\n  }\r\n\r\n  get owner() {\r\n    //return this.#host.owner;\r\n    return this.#host.form || GSDOM.closest(this.#host, 'form');\r\n  }\r\n\r\n  get formElements() {\r\n    return GSDOM.formElements(this.owner, true);\r\n  }\r\n\r\n  get strict() {\r\n    return GSAttr.get(this.#host, 'strict', '');\r\n  }\r\n\r\n  #onBlur(e) {\r\n    if (!this.#isInList()) GSEvents.send(this.#host, 'strict', { ok: false, source: e });\r\n  }\r\n\r\n  #onDataChange(e) {\r\n    const me = this;\r\n    const own = me.owner;\r\n    let opt = GSDOM.query(me.list, `option[value=\"${me.value}\"]`);\r\n    let clean = false;\r\n    if (!opt) {\r\n        opt = me.list?.querySelector('option');\r\n        clean = true;\r\n    }\r\n\r\n    const obj = opt?.dataset || {};\r\n    Object.entries(obj).forEach(p => {\r\n        const val = clean ? '' : p[1];\r\n        const key = p[0];\r\n        GSAttr.set(me.#host, `data-${key}`, p[1]);\r\n        if (key === 'id' || key === 'group') return;\r\n\r\n        const filter = `[data-${key}]:not([data-${key}=\"\"]`;\r\n        const els = Array.from(GSDOM.queryAll(own, filter));\r\n        els.filter(el => el.tagName !== 'OPTION')\r\n            .filter(el => el !== me.#host)\r\n            .filter(el => el !== me.filter)            \r\n            .filter(el => GSAttr.get(el, 'list').length === 0)\r\n            .forEach(el => me.#togleEl(el, key, val))\r\n    });\r\n  }\r\n\r\n  #onMonitor(e) {\r\n    const me = this;\r\n    const list = me.list;\r\n    me.value = '';\r\n    me.#host.disabled = false;\r\n    const dataGroup = GSAttr.get(me.filter, 'data-group');\r\n    const filter = dataGroup ? `option[data-group=\"${dataGroup}\"]` : `option[data-id=\"${e.target.value}\"]`;\r\n    GSDOM.queryAll(list, 'option').forEach(el => me.#togleOption(el, true));\r\n    GSDOM.queryAll(list, filter).forEach(el => me.#togleOption(el, false));\r\n\r\n  }\r\n\r\n  #togleOption(el, value) {\r\n      GSAttr.toggle(el, 'disabled', value);\r\n      GSDOM.toggleClass(el, 'd-none', value);\r\n  }\r\n\r\n  #togleEl(el, key = '', value = '') {\r\n\r\n    const data = GSAttr.get(el, `data-${key}`, '').split(/[,;;]/);\r\n    const isMatch = value.length > 0 && data.includes(value);\r\n    const frmel = GSDOM.isFormElement(el) || GSDOM.isButtonElement(el);\r\n\r\n    if (frmel) {\r\n      GSAttr.toggle(el, 'disabled', !isMatch);\r\n    } else {\r\n      isMatch ? GSDOM.show(el) : GSDOM.hide(el);\r\n    }\r\n\r\n    //this.formElements.forEach(el => GSAttr.set(el, 'data-ignore', isMatch ? null : true));\r\n    GSAttr.set(el, 'data-ignore', isMatch ? null : true);\r\n    GSDOM.queryAll(el, 'input,textarea,select').forEach(el => GSAttr.set(el, 'data-ignore', isMatch ? null : true));\r\n  }\r\n\r\n  #isInList() {\r\n    const me = this;\r\n    const list = me.list;\r\n    if (!list) return true;\r\n    if (!me.strict) return true;\r\n    if (!list.querySelector('option')) return true;\r\n    const opt = list.querySelector(`option[value=\"${me.value}\"]`);\r\n    return opt != null;\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { InteractiveController } from \"./InteractiveController.mjs\";\r\n\r\n\r\n/**\r\n * Handle data filtering for list atribute, and linked fields.\r\n * Changes in one field list, update available selections in another field selections.\r\n */\r\nexport class ComboController extends InteractiveController {\r\n\r\n  constructor(host) {\r\n    super(host);\r\n  }\r\n\r\n  get list() {\r\n    return this.component;\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSAttr } from \"../../../base/GSAttr.mjs\";\r\nimport { GSDOM } from \"../../../base/GSDOM.mjs\";\r\nimport { InteractiveController } from \"./InteractiveController.mjs\";\r\n\r\n/**\r\n * Handle data filtering for list atribute, and linked fields.\r\n * Changes in one field list, update available selections in another field selections.\r\n */\r\nexport class ListController extends InteractiveController {\r\n\r\n  constructor(host) {\r\n    super(host);\r\n  }\r\n\r\n  get list() {\r\n    const me = this;\r\n    if (me.component.list) return me.component.list;\r\n    const list = GSAttr.get(me.component, 'list');\r\n    return GSDOM.getByID(me.owner, list);\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSBeep } from \"../../../base/GSBeep.mjs\";\r\nimport { GSDOM } from \"../../../base/GSDOM.mjs\";\r\nimport { GSUtil } from \"../../../base/GSUtil.mjs\";\r\n\r\n\r\n/**\r\n * Handle for input/testarea to support validity checkups\r\n */\r\nexport class ValidityController {\r\n\r\n  #host;\r\n\r\n  #invalidCallback;\r\n  #blurCallback;\r\n  #changeCallback;\r\n  #focusCallback;\r\n  #inputCallback;\r\n\r\n  #processing;  \r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#processing = false;\r\n    me.#host = host;\r\n    me.#invalidCallback = me.#onInvalid.bind(me);\r\n    me.#blurCallback = me.#onBlur.bind(me);\r\n    me.#changeCallback = me.#onChange.bind(me);\r\n    me.#focusCallback = me.#onFocus.bind(me);\r\n    me.#inputCallback = me.#onInput.bind(me);\r\n    host.addController?.(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.#host.on('invalid', me.#invalidCallback);\r\n    me.#host.on('blur', me.#blurCallback);\r\n    me.#host.on('focus', me.#focusCallback);\r\n    me.#host.on('change', me.#changeCallback);\r\n    me.#host.on('input', me.#inputCallback);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    delete me.#host.dataset.typed;\r\n    me.#host.removeController?.(me);\r\n    me.#host.off('invalid', me.#invalidCallback);\r\n    me.#host.off('blur', me.#blurCallback);\r\n    me.#host.off('focus', me.#focusCallback);\r\n    me.#host.off('change', me.#changeCallback);\r\n    me.#host.off('input', me.#inputCallback);\r\n  }\r\n\r\n  reset() {\r\n    this.setCustomValidity('');\r\n    this.#togglUI(this.isValid);\r\n  }\r\n\r\n  async report() {    \r\n    const me = this;\r\n    if (me.#processing) return;\r\n    me.#processing = true;\r\n    me.reportValidity();\r\n    if (me.isVisible) {\r\n      if (me.block) me.focus();\r\n      if (me.beep && me.isTyped) await me.#beep();\r\n    }\r\n    await GSUtil.timeout(me.timeout);\r\n    me.setCustomValidity(me.isValid ? '' : ' ');\r\n    me.#togglUI(me.isValid);\r\n    me.#processing = false;\r\n  }\r\n\r\n  setCustomValidity(val) {\r\n    return this.#host.setCustomValidity(val);\r\n  }\r\n\r\n  checkValidity() {\r\n    return this.#host.checkValidity();\r\n  }\r\n\r\n  reportValidity() {\r\n    return this.#host.reportValidity();\r\n  }\r\n\r\n  focus() {\r\n    return this.#host.focus();\r\n  }\r\n  \r\n  get isTyped() {\r\n    return GSUtil.asBool(this.#host.dataset.typed);\r\n  }\r\n\r\n  get isValid() {\r\n    return this.#host.validity.valid;\r\n  }\r\n\r\n  get value() {\r\n    return this.#host.value;\r\n  }\r\n\r\n  get beep() {\r\n    return this.#host.beep;\r\n  }\r\n\r\n  get block() {\r\n    return this.#host.block;\r\n  }\r\n\r\n  get timeout() {\r\n    return this.#host.timeout;\r\n  }\r\n\r\n  get isVisible() {\r\n    return GSDOM.isVisible(this.#host);\r\n  }\r\n\r\n  #onInput(e) {\r\n    const me = this;\r\n    if (!me.#host.dataset.typed) {\r\n      me.#host.dataset.typed = true;\r\n    }\r\n    me.#processing = false;\r\n  }\r\n\r\n  #onFocus(e) {\r\n    this.#togglUI(this.isValid);\r\n  }\r\n\r\n  #onInvalid(e) {\r\n    this.report();\r\n  }\r\n\r\n  #onChange(e) {\r\n    const me = this;\r\n    if(me.checkValidity()) {\r\n      me.reset();\r\n    }\r\n  }\r\n\r\n  #onBlur(e) {\r\n    const me = this;\r\n    if (me.isValid) {\r\n      me.reset();\r\n    } else {\r\n      me.checkValidity();\r\n    }\r\n  }\r\n\r\n  #togglUI(isValid) {\r\n    GSDOM.toggleClass(this.#host, 'is-invalid', !isValid);\r\n  }\r\n\r\n  #beep() {\r\n    return GSBeep.beep(100, 1200, 150, 'triangle');\r\n  }\r\n\r\n}  ","\r\nimport { notEqual, defaultConverter } from '../../lib.mjs';\r\n\r\n\r\nconst defaultPropertyDeclaration = {\r\n    attribute: true,\r\n    reflect: false,\r\n    type: String,\r\n    converter: defaultConverter,\r\n    hasChanged: notEqual,\r\n}\r\n\r\nconst attributeToPropertyMap = Symbol();\r\nconst prepare = Symbol();\r\nconst elementProperties = Symbol();\r\nconst finalize = Symbol();\r\nconst finalized = Symbol();\r\n\r\nconst prepareFn = function () {\r\n    const me = this;\r\n    if (Object.getOwnPropertySymbols(me).includes(elementProperties)) return;\r\n    const superCtor = Object.getPrototypeOf(me);\r\n    if (typeof superCtor[finalize] === 'function') superCtor[finalize]();\r\n    me[elementProperties] = new Map(superCtor[elementProperties]);\r\n}\r\n\r\nconst attributeNameForProperty = (name, options) => {\r\n    const attribute = options.attribute;\r\n    return attribute === false\r\n        ? undefined\r\n        : typeof attribute === 'string'\r\n            ? attribute\r\n            : typeof name === 'string'\r\n                ? name.toLowerCase()\r\n                : undefined;\r\n}\r\n\r\n/**\r\n * Reactivity for HTMLInputElement based on Google ltd. Lit ReactiveElement\r\n */\r\nexport class ReactiveInput extends HTMLInputElement {\r\n\r\n    // user defiend \r\n    static properties = {};\r\n    \r\n    static [finalized] = false;\r\n\r\n    #reflectingProperties = undefined;\r\n    #instanceProperties = undefined;\r\n\r\n    #controllers = undefined;\r\n    #updatePromise = undefined;\r\n    #changedProperties = undefined;\r\n    #reflectingProperty = undefined;\r\n\r\n    #hasUpdated = false;\r\n    #isUpdatePending = false;\r\n\r\n    #isConnected = false;\r\n\r\n    /**\r\n     * Returns a list of attributes corresponding to the registered properties.\r\n    */\r\n    static get observedAttributes() {\r\n        Object.defineProperty(ReactiveInput.__proto__, prepare, { value: prepareFn });\r\n        const me = this;\r\n        me[finalize]();\r\n        return me[attributeToPropertyMap] && [...me[attributeToPropertyMap].keys()];\r\n    }\r\n\r\n    static addInitializer(initializer) {\r\n        const me = this;\r\n        me[prepare]();\r\n        me.initializers ??= [].push(initializer);\r\n    }\r\n\r\n    static [finalize]() {\r\n        const me = this;\r\n        //if (Object.hasOwn(me, 'finalized')) return;\r\n        if (me[finalized] === true) return;\r\n        me[finalized] = true;\r\n        me[prepare]();\r\n\r\n        if (Object.hasOwn(me, 'properties')) {\r\n            const props = me.properties;\r\n            const propKeys = [\r\n                ...Object.getOwnPropertyNames(props),\r\n                ...Object.getOwnPropertySymbols(props),\r\n            ];\r\n            for (const p of propKeys) {\r\n                me.createProperty(p, props[p]);\r\n            }\r\n        }\r\n\r\n        // Create the attribute-to-property map\r\n        me[attributeToPropertyMap] = new Map();\r\n        for (const [p, options] of me[elementProperties]) {\r\n            const attr = attributeNameForProperty(p, options);\r\n            if (attr !== undefined) {\r\n                me[attributeToPropertyMap].set(attr, p);\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    static createProperty(name, options) {\r\n        const me = this;\r\n        if (options.state) options.attribute = false;\r\n        me[prepare]();\r\n        me[elementProperties].set(name, options);\r\n        if (!options.noAccessor) {\r\n            const key = Symbol();\r\n            const descriptor = me.getPropertyDescriptor(name, key, options);\r\n            if (descriptor !== undefined) {\r\n                Object.defineProperty(me.prototype, name, descriptor);\r\n            }\r\n        }\r\n    }\r\n\r\n    static getPropertyDescriptor(name, key, options) {\r\n        const { get, set } = Object.getOwnPropertyDescriptor(this.prototype, name) ?? {\r\n            get() {\r\n                return this[key];\r\n            },\r\n            set(v) {\r\n                this[key] = v;\r\n            },\r\n        }\r\n        return {\r\n            get() {\r\n                return get?.call(this);\r\n            },\r\n            set(value) {\r\n                const me = this;\r\n                const oldValue = get?.call(me);\r\n                set?.call(me, value);\r\n                me.requestUpdate(name, oldValue, options);\r\n            },\r\n            configurable: true,\r\n            enumerable: true,\r\n        }\r\n    }\r\n\r\n    static getPropertyOptions(name) {\r\n        return this[elementProperties].get(name) ?? defaultPropertyDeclaration;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.#initialize();\r\n    }\r\n\r\n    connectedCallback() {\r\n        const me = this;\r\n        me.enableUpdating(true);\r\n        me.#controllers?.forEach((c) => c.hostConnected?.());\r\n        me.#isConnected = true;\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        this.#isConnected = false;\r\n        this.#controllers?.forEach((c) => c.hostDisconnected?.());\r\n    }\r\n\r\n    attributeChangedCallback(name, oldValue, newValue) {\r\n        this.#attributeToProperty(name, newValue);\r\n    }\r\n\r\n    // ******************************\r\n    // PUBLIC GETTERS\r\n    // ******************************\r\n\r\n    get hasUpdated() { return this.#hasUpdated; }\r\n    get isUpdatePending() { return this.#isUpdatePending; }\r\n    get renderRoot() { return this; }\r\n\r\n    // ******************************\r\n    // PROTECTED FUNCTIONS \r\n    // ******************************\r\n\r\n    addController(controller) {\r\n        // if (!(controller instanceof ReactiveController)) throw new Error('Argument not instance of ReactiveController');\r\n        const me = this;\r\n        (me.#controllers ??= new Set()).add(controller);\r\n        if (me.#isConnected) {\r\n            controller.hostConnected?.();\r\n        }\r\n    }\r\n\r\n    removeController(controller) {\r\n        this.#controllers?.delete(controller);\r\n    }\r\n\r\n    createRenderRoot() {\r\n        return this;\r\n    }\r\n\r\n    enableUpdating(requestedUpdate) { }\r\n\r\n    firstUpdated(changedProperties) { }\r\n\r\n    updated(changedProperties) { }\r\n\r\n    getUpdateComplete() { return this.#updatePromise; }\r\n\r\n    scheduleUpdate() { return this.performUpdate(); }\r\n\r\n    shouldUpdate(changedProperties) { return true; }\r\n\r\n    willUpdate(changedProperties) { }\r\n\r\n    update(changedProperties) {\r\n        const me = this;\r\n        // The forEach() expression will only run when when #reflectingProperties is\r\n        // defined, and it returns undefined, setting #reflectingProperties to undefined\r\n        me.#reflectingProperties &&= me.#reflectingProperties.forEach((p) => me.#propertyToAttribute(p, this[p]));\r\n        me.#markUpdated();\r\n    }\r\n\r\n    get updateComplete() {\r\n        return this.getUpdateComplete();\r\n    }\r\n\r\n    requestUpdate(name, oldValue, options) {\r\n        const me = this;\r\n        if (name !== undefined) {\r\n            options ??= (me.constructor).getPropertyOptions(name);\r\n            const hasChanged = options.hasChanged ?? notEqual;\r\n            const newValue = me[name];\r\n            if (hasChanged(newValue, oldValue)) {\r\n                me.#changeProperty(name, oldValue, options);\r\n            } else {\r\n                return;\r\n            }\r\n        }\r\n        if (me.#isUpdatePending === false) {\r\n            me.#updatePromise = me.#enqueueUpdate();\r\n        }\r\n    }\r\n\r\n    performUpdate() {\r\n\r\n        const me = this;\r\n        if (!me.#isUpdatePending) return;\r\n\r\n        if (!me.#hasUpdated) {\r\n\r\n            // Mixin instance properties once, if they exist.\r\n            if (me.#instanceProperties) {\r\n                for (const [p, value] of me.#instanceProperties) {\r\n                    this[p] = value;\r\n                }\r\n                me.#instanceProperties = undefined;\r\n            }\r\n\r\n            const elementProps = me.constructor[elementProperties];\r\n            if (elementProps.size > 0) {\r\n                for (const [p, options] of elementProps) {\r\n                    if (\r\n                        options.wrapped === true &&\r\n                        !me.#changedProperties.has(p) &&\r\n                        me[p] !== undefined\r\n                    ) {\r\n                        me.#changeProperty(p, this[p], options);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        let shouldUpdate = false;\r\n        const changedProperties = me.#changedProperties;\r\n        try {\r\n            shouldUpdate = me.shouldUpdate(changedProperties);\r\n            if (shouldUpdate) {\r\n                me.willUpdate(changedProperties);\r\n                me.#controllers?.forEach((c) => c.hostUpdate?.());\r\n                me.update(changedProperties);\r\n            } else {\r\n                me.#markUpdated();\r\n            }\r\n        } catch (e) {\r\n            shouldUpdate = false;\r\n            me.#markUpdated();\r\n            throw e;\r\n        }\r\n\r\n        if (shouldUpdate) {\r\n            me.#didUpdate(changedProperties);\r\n        }\r\n    }\r\n\r\n    // ******************************\r\n    // PRIVATE FUNCTIONS \r\n    // ******************************\r\n\r\n    #didUpdate(changedProperties) {\r\n        const me = this;\r\n        me.#controllers?.forEach((c) => c.hostUpdated?.());\r\n        if (!me.#hasUpdated) {\r\n            me.#hasUpdated = true;\r\n            me.firstUpdated(changedProperties);\r\n        }\r\n        me.updated(changedProperties);\r\n    }\r\n\r\n    #markUpdated() {\r\n        const me = this;\r\n        me.#changedProperties = new Map();\r\n        me.#isUpdatePending = false;\r\n    }\r\n\r\n    async #enqueueUpdate() {\r\n        const me = this;\r\n        me.#isUpdatePending = true;\r\n        try {\r\n            await me.#updatePromise;\r\n        } catch (e) {\r\n            Promise.reject(e);\r\n        }\r\n        const result = me.scheduleUpdate();\r\n\r\n        if (result != null) {\r\n            await result;\r\n        }\r\n        return !me.#isUpdatePending;\r\n    }\r\n\r\n    #changeProperty(name, oldValue, options) {\r\n        const me = this;\r\n        if (!me.#changedProperties.has(name)) {\r\n            me.#changedProperties.set(name, oldValue);\r\n        }\r\n\r\n        if (options.reflect === true && me.#reflectingProperty !== name) {\r\n            (me.#reflectingProperties ??= new Set()).add(name);\r\n        }\r\n    }\r\n\r\n    #attributeToProperty(name, value) {\r\n        const me = this;\r\n        const ctor = me.constructor;\r\n        const propName = (ctor[attributeToPropertyMap]).get(name);\r\n        if (propName !== undefined && me.#reflectingProperty !== propName) {\r\n            const options = ctor.getPropertyOptions(propName);\r\n            const converter =\r\n                typeof options.converter === 'function'\r\n                    ? { fromAttribute: options.converter }\r\n                    : options.converter?.fromAttribute !== undefined\r\n                        ? options.converter\r\n                        : defaultConverter;\r\n            // mark state reflecting\r\n            me.#reflectingProperty = propName;\r\n            me[propName] = converter?.fromAttribute(value, options.type);\r\n            // mark state not reflecting\r\n            me.#reflectingProperty = null;\r\n        }\r\n    }\r\n\r\n    #propertyToAttribute(name, value) {\r\n        const me = this;\r\n        const elementProps = me.constructor[elementProperties];\r\n        const options = elementProps?.get(name);\r\n        const attr = attributeNameForProperty(name, options);\r\n        if (attr !== undefined && options.reflect === true) {\r\n            const converter =\r\n                (options.converter)?.toAttribute !==\r\n                    undefined\r\n                    ? (options.converter)\r\n                    : defaultConverter;\r\n            const attrValue = converter?.toAttribute(value, options.type);\r\n\r\n            me.#reflectingProperty = name;\r\n            if (attrValue == null) {\r\n                me.removeAttribute(attr);\r\n            } else {\r\n                me.setAttribute(attr, attrValue);\r\n            }\r\n            // mark state not reflecting\r\n            me.#reflectingProperty = null;\r\n        }\r\n    }\r\n\r\n    #saveInstanceProperties() {\r\n        const me = this;\r\n        const instanceProperties = new Map();\r\n        const elementProps = me.constructor[elementProperties];\r\n        for (const p of elementProps.keys()) {\r\n            if (Object.hasOwn(me, p)) {\r\n                instanceProperties.set(p, me[p]);\r\n                delete me[p];\r\n            }\r\n        }\r\n        if (instanceProperties.size > 0) {\r\n            me.#instanceProperties = instanceProperties;\r\n        }\r\n    }\r\n\r\n    #initialize() {\r\n        const me = this;\r\n        me.#updatePromise = new Promise((res) => me.enableUpdating = res);\r\n        me.#changedProperties = new Map();\r\n        me.#saveInstanceProperties();\r\n        me.requestUpdate();\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDataListExt class\r\n * @module components/ext/GSDataListExt\r\n */\r\n\r\nimport { GSID } from \"../../base/GSID.mjs\";\r\nimport { GSDOM } from \"../../base/GSDOM.mjs\";\r\nimport { GSLoader } from \"../../base/GSLoader.mjs\";\r\nimport { GSEvents } from \"../../base/GSEvents.mjs\";\r\nimport { ComboController } from \"./controllers/ComboController.mjs\";\r\nimport { DataController } from \"../../controllers/DataController.mjs\";\r\nimport { GSAttr } from \"../../base/GSAttr.mjs\";\r\nimport { GSData } from \"../../base/GSData.mjs\";\r\n\r\n/**\r\n * Add JSON loader to select element\r\n * <select is=\"gs-ext-select\" data=\"data.json\">\r\n * \r\n * [{text:'', value:'' selected:true}]\r\n * \r\n * @class\r\n * @extends {HTMLSelectElement}\r\n */\r\nexport class GSComboExt extends HTMLSelectElement {\r\n\r\n    static {\r\n        customElements.define('gs-ext-select', GSComboExt, { extends: 'select' });\r\n        Object.seal(GSComboExt);\r\n    }\r\n\r\n    #data = [];\r\n    #isConnected = false;\r\n    #controllers = undefined;\r\n    #comboController = undefined;\r\n    #dataController = undefined;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#comboController ??= new ComboController(this);\r\n    }\r\n\r\n    static get observedAttributes() {\r\n        return ['data'];\r\n    }\r\n\r\n    attributeChangedCallback(name, oldValue, newValue) {\r\n        //GSLog.error(null, `name:${name}, oldValue:${oldValue}, newValue:${newValue}`);\r\n        if (name === 'data') this.load(newValue);\r\n        this.#controllers?.forEach((c) => c.hostUpdated?.());\r\n    }\r\n\r\n    connectedCallback() {\r\n        const me = this;\r\n        GSID.setIf(me);\r\n        const data = me.form?.data;\r\n        if (data) GSDOM.fromObject2Element(me, data);\r\n        if (me.storage) me.#dataController ??= new DataController(me);\r\n        me.#controllers?.forEach((c) => c.hostConnected?.());\r\n        me.#isConnected = true;\r\n        me.on('reset', me.#onReset);\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        const me = this;\r\n        me.#isConnected = false;\r\n        me.#controllers?.forEach((c) => c.hostDisconnected?.());\r\n        GSEvents.detachListeners(me);\r\n    }\r\n        \r\n    addController(controller) {\r\n        const me = this;\r\n        (me.#controllers ??= new Set()).add(controller);\r\n        if (me.#isConnected) {\r\n            controller.hostConnected?.();\r\n        }\r\n    }\r\n\r\n    removeController(controller) {\r\n        this.#controllers?.delete(controller);\r\n    }\r\n\r\n    validate() {\r\n        const me = this;\r\n        const isValid = me.checkValidity();\r\n        if (!isValid) me.reportValidity();\r\n        return isValid;\r\n    }\r\n\r\n    get form() {\r\n        return this.closest('gs-form');\r\n    }\r\n\r\n    get owner() {\r\n        const own = GSDOM.root(this);\r\n        return GSDOM.unwrap(own);\r\n    }\r\n\r\n    /**\r\n     * Get parent GS-* component\r\n     */\r\n    get parentComponent() {\r\n        return GSDOM.parentAll(this).filter(x => x instanceof GSElement).next()?.value;\r\n    }\r\n\r\n    reset() {\r\n        GSDOM.resetSelect(this);\r\n    }\r\n\r\n    /**\r\n     * Find closest top element by CSS selector\r\n     * @param {String} query \r\n     * @returns {HTMLElement}\r\n     */\r\n    closest(query = '') {\r\n        return GSDOM.closest(this, query);\r\n    }\r\n\r\n    async load(url = '') {\r\n        if (!url) return;\r\n        const data = await GSLoader.loadSafe(url, 'GET', null, true);\r\n        this.apply(data);\r\n    }\r\n\r\n    apply(data) {\r\n\r\n        if (!Array.isArray(data)) return false;\r\n\r\n        const me = this;\r\n\r\n        queueMicrotask(() => {\r\n\r\n            const list = [];\r\n            data.forEach(o => {\r\n                list.push(me.#objToHTML(o));\r\n            });\r\n\r\n            GSDOM.setHTML(me, list.join('\\n'));\r\n        });\r\n        return true;\r\n    }\r\n\r\n    #objToHTML(o) {\r\n        const seg = ['<option'];\r\n\r\n        Object.entries(o).forEach(it => {\r\n            const key = it[0];\r\n            const val = it[1];\r\n            if ('text' === key) return;\r\n            if ('selected' === key) return seg.push(key);\r\n            seg.push(`${key}=\"${val}\"`);\r\n        });\r\n\r\n        seg.push('>')\r\n        seg.push(o.text);\r\n        seg.push('</option>')\r\n\r\n        return seg.join(' ');\r\n    }\r\n\r\n\r\n    /**\r\n     * Generic component signal\r\n     * @param {Boolean} bubbles  Does buuble to upper nodes\r\n     * @param {Boolean} composed Does traverse from shadow DOM \r\n     */\r\n    notify(bubbles = true, composed = false, data) {\r\n        this.emit('notify', data, bubbles, composed, true);\r\n    }\r\n\r\n    /**\r\n     * Send event\r\n     * @param {String} name \r\n     * @param {Object} obj \r\n     * @param {Boolean} bubbles \r\n     * @param {Boolean} composed \r\n     * @param {Boolean} cancelable \r\n     */\r\n    emit(name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n        return GSEvents.send(this, name, obj, bubbles, composed, cancelable);\r\n    }\r\n\r\n    /**\r\n     * Wait for event to happen\r\n     * @async\r\n     * @param {String} name \r\n     * @returns {Promise}\r\n     */\r\n    waitEvent(name = '', timeout = 0) {\r\n        return GSEvents.wait(this, name, timeout);\r\n    }\r\n\r\n    /**\r\n     * Listen once for triggered event\r\n     * @param {String} name  A name of the event\r\n     * @param {Function} func A callback function on event trigger\r\n     * @returns {Boolean}\r\n     */\r\n    once(name, func) {\r\n        return this.listen(name, func, true);\r\n    }\r\n\r\n    /**\r\n     * Alternative function for event listen\r\n     * @param {String} name  A name of the event\r\n     * @param {Function} func A callback function on event trigger\r\n     * @returns {Boolean}\r\n     */\r\n    on(name, func, once = false) {\r\n        return this.listen(name, func, once);\r\n    }\r\n\r\n    /**\r\n     * Alternative function for event unlisten\r\n     * @param {String} name  A name of the event\r\n     * @param {Function} func A callback function on event trigger\r\n     * @returns {Boolean}\r\n     */\r\n    off(name, func) {\r\n        return this.unlisten(name, func);\r\n    }\r\n\r\n    /**\r\n     * Prevent event firing up the DOM tree\r\n     * @param {Event} e \r\n     */\r\n    prevent(e) {\r\n        GSEvents.prevent(e);\r\n    }\r\n\r\n    /**\r\n     * Attach event to this element\r\n     * @param {String} name  A name of the event\r\n     * @param {Function} func A callback function on event trigger\r\n     * @returns {Boolean}\r\n     */\r\n    listen(name, func, once = false) {\r\n        return this.attachEvent(this, name, func, once);\r\n    }\r\n\r\n    /**\r\n     * Remove event from this element\r\n     * @param {String} name  A name of the event\r\n     * @param {Function} func A callback function on event trigger\r\n     * @returns {Boolean}\r\n     */\r\n    unlisten(name, func) {\r\n        return this.removeEvent(this, name, func);\r\n    }\r\n\r\n    /**\r\n    * Generic event listener appender\r\n    * \r\n    * @param {HTMLElement} el Element on which to monitor for named events\r\n    * @param {String} name Event name to watch for\r\n    * @param {Function} fn Event trigger callback\r\n    * @param {Boolean} once Listen only once\r\n    * @returns {Boolean} State if attachment was successful\r\n    */\r\n    attachEvent(el, name = '', fn, once = false) {\r\n        return GSEvents.attach(this, el, name, fn, once);\r\n    }\r\n\r\n    /**\r\n    * Generic event listener remove\r\n    * @param {HTMLElement} el Element on which to monitor for named events\r\n    * @param {String} name Event name to watch for\r\n    * @param {Function} fn Event trigger callback\r\n    * @returns {Boolean} State if attachment was successful\t\r\n    */\r\n    removeEvent(el, name = '', fn) {\r\n        return GSEvents.remove(this, el, name, fn);\r\n    }\r\n\r\n    #onReset(e) {\r\n        this.reset();\r\n    }\r\n\r\n    /**\r\n     * For DataController read callback\r\n     * \r\n     * @param {Array} data \r\n     */\r\n    onDataRead(data = []) {\r\n        const me = this;\r\n        const key = me.key;\r\n        me.#data = GSData.mergeArrays(data.map(o => o[key]), me.#data.map(o => o.value))\r\n               .map(v => {return {text:v, value:v}});;    \r\n        me.apply(me.#data);\r\n    }\r\n\r\n    get storage() {\r\n        return GSAttr.get(this, 'storage');\r\n    }\r\n\r\n    /**\r\n     * Storage records key to use to generate unique list\r\n     */\r\n    get key() {\r\n        return GSAttr.get(this, 'key', 0);\r\n    }    \r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDataListExt class\r\n * @module components/ext/GSDataListExt\r\n */\r\n\r\n\r\nimport { GSID } from \"../../base/GSID.mjs\";\r\nimport { GSDOM } from \"../../base/GSDOM.mjs\";\r\nimport { GSUtil } from \"../../base/GSUtil.mjs\";\r\nimport { GSLoader } from \"../../base/GSLoader.mjs\";\r\nimport { GSEvents } from \"../../base/GSEvents.mjs\";\r\nimport { GSLog } from \"../../base/GSLog.mjs\";\r\nimport { GSAttr } from \"../../base/GSAttr.mjs\";\r\nimport { DataController } from \"../../controllers/DataController.mjs\";\r\nimport { GSData } from \"../../base/GSData.mjs\";\r\n\r\n/**\r\n * Add JSON loader to datalist element\r\n * \r\n * <datalist is=\"gs-ext-datalist\" data=\"data.json\">\r\n * \r\n * [{text:'', value:'' selected:true}]\r\n * \r\n * @class\r\n * @extends {HTMLDataListElement}\r\n */\r\nexport class GSDataListExt extends HTMLDataListElement {\r\n\r\n    static {\r\n        customElements.define('gs-ext-datalist', GSDataListExt, { extends: 'datalist' });\r\n        Object.seal(GSDataListExt);\r\n    }\r\n\r\n    #data = [];\r\n    #isConnected = false;\r\n    #controllers = undefined;\r\n    #dataController = undefined;\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    static get observedAttributes() {\r\n        return ['data'];\r\n    }\r\n\r\n    attributeChangedCallback(name, oldValue, newValue) {\r\n        //GSLog.error(null, e);`name:${name}, oldValue:${oldValue}, newValue:${newValue}`);\r\n        if (name === 'data') this.load(newValue);\r\n        this.#controllers?.forEach((c) => c.hostUpdated?.());\r\n    }\r\n\r\n    connectedCallback() {\r\n        const me = this;\r\n        GSID.setIf(me);\r\n        if (me.storage) me.#dataController ??= new DataController(me);\r\n        me.#controllers?.forEach((c) => c.hostConnected?.());\r\n        me.#isConnected = true;\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        const me = this;\r\n        me.#isConnected = false;\r\n        me.#controllers?.forEach((c) => c.hostDisconnected?.());        \r\n        GSEvents.detachListeners(me);\r\n    }\r\n   \r\n    addController(controller) {\r\n        const me = this;\r\n        (me.#controllers ??= new Set()).add(controller);\r\n        if (me.#isConnected) {\r\n            controller.hostConnected?.();\r\n        }\r\n    }\r\n\r\n    removeController(controller) {\r\n        this.#controllers?.delete(controller);\r\n    }    \r\n        \r\n    get owner() {\r\n        const own = GSDOM.root(this);\r\n        return GSDOM.unwrap(own);\r\n    }\r\n\r\n    /**\r\n     * Get parent GS-* component\r\n     */\r\n    get parentComponent() {\r\n        return GSDOM.parentAll(this).filter(x => x instanceof GSElement).next()?.value;\r\n    }\r\n\r\n\r\n    async load(url = '') {\r\n        if (!url) return;\r\n        try {\r\n            const data = await GSLoader.loadSafe(url, 'GET', null, true);\r\n            this.apply(data);\r\n        } catch (error) {\r\n            console.error('Failed to load data:', error);\r\n            GSLog.error(this, error);\r\n        }\r\n    }\r\n\r\n    apply(data) {\r\n\r\n        if (!Array.isArray(data)) return false;\r\n\r\n        const me = this;\r\n\r\n        queueMicrotask(() => {\r\n\r\n            const list = [];\r\n            data.forEach(o => {\r\n                list.push(me.#objToHTML(o));\r\n            });\r\n\r\n            GSDOM.setHTML(me, list.join('\\n'));\r\n        });\r\n        return true;\r\n    }\r\n\r\n    #objToHTML(o) {\r\n        const seg = ['<option'];\r\n\r\n        if (GSUtil.isString(o)) o = { value: o };\r\n\r\n        Object.entries(o).forEach(it => {\r\n            const key = it[0];\r\n            const val = it[1];\r\n            if ('text' === key) return;\r\n            if ('selected' === key) return seg.push(key);\r\n            seg.push(`${key}=\"${val}\"`);\r\n        });\r\n\r\n        if (o.text) {\r\n            seg.push('>')\r\n            seg.push(o.text);\r\n            seg.push('</option>')\r\n        } else {\r\n            seg.push('>')\r\n        }\r\n\r\n        return seg.join(' ');\r\n    }\r\n\r\n\r\n    /**\r\n     * Generic component signal\r\n     * @param {Boolean} bubbles  Does buuble to upper nodes\r\n     * @param {Boolean} composed Does traverse from shadow DOM \r\n     */\r\n    notify(bubbles = true, composed = false, data) {\r\n        this.emit('notify', data, bubbles, composed, true);\r\n    }\r\n\r\n    /**\r\n     * Send event\r\n     * @param {String} name \r\n     * @param {Object} obj \r\n     * @param {Boolean} bubbles \r\n     * @param {Boolean} composed \r\n     * @param {Boolean} cancelable \r\n     */\r\n    emit(name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n        return GSEvents.send(this, name, obj, bubbles, composed, cancelable);\r\n    }\r\n\r\n    /**\r\n     * Wait for event to happen\r\n     * @async\r\n     * @param {String} name \r\n     * @returns {Promise}\r\n     */\r\n    waitEvent(name = '', timeout = 0) {\r\n        return GSEvents.wait(this, name, timeout);\r\n    }\r\n\r\n    /**\r\n     * Listen once for triggered event\r\n     * @param {String} name  A name of the event\r\n     * @param {Function} func A callback function on event trigger\r\n     * @returns {Boolean}\r\n     */\r\n    once(name, func) {\r\n        return this.listen(name, func, true);\r\n    }\r\n\r\n    /**\r\n     * Alternative function for event listen\r\n     * @param {String} name  A name of the event\r\n     * @param {Function} func A callback function on event trigger\r\n     * @returns {Boolean}\r\n     */\r\n    on(name, func, once = false) {\r\n        return this.listen(name, func, once);\r\n    }\r\n\r\n    /**\r\n     * Alternative function for event unlisten\r\n     * @param {String} name  A name of the event\r\n     * @param {Function} func A callback function on event trigger\r\n     * @returns {Boolean}\r\n     */\r\n    off(name, func) {\r\n        return this.unlisten(name, func);\r\n    }\r\n\r\n    /**\r\n     * Prevent event firing up the DOM tree\r\n     * @param {Event} e \r\n     */\r\n    prevent(e) {\r\n        GSEvents.prevent(e);\r\n    }\r\n\r\n    /**\r\n     * Attach event to this element\r\n     * @param {String} name  A name of the event\r\n     * @param {Function} func A callback function on event trigger\r\n     * @returns {Boolean}\r\n     */\r\n    listen(name, func, once = false) {\r\n        return this.attachEvent(this, name, func, once);\r\n    }\r\n\r\n    /**\r\n     * Remove event from this element\r\n     * @param {String} name  A name of the event\r\n     * @param {Function} func A callback function on event trigger\r\n     * @returns {Boolean}\r\n     */\r\n    unlisten(name, func) {\r\n        return this.removeEvent(this, name, func);\r\n    }\r\n\r\n    /**\r\n    * Generic event listener appender\r\n    * \r\n    * @param {HTMLElement} el Element on which to monitor for named events\r\n    * @param {String} name Event name to watch for\r\n    * @param {Function} fn Event trigger callback\r\n    * @param {Boolean} once Listen only once\r\n    * @returns {Boolean} State if attachment was successful\r\n    */\r\n    attachEvent(el, name = '', fn, once = false) {\r\n        return GSEvents.attach(this, el, name, fn, once);\r\n    }\r\n\r\n    /**\r\n    * Generic event listener remove\r\n    * @param {HTMLElement} el Element on which to monitor for named events\r\n    * @param {String} name Event name to watch for\r\n    * @param {Function} fn Event trigger callback\r\n    * @returns {Boolean} State if attachment was successful\t\r\n    */\r\n    removeEvent(el, name = '', fn) {\r\n        return GSEvents.remove(this, el, name, fn);\r\n    }\r\n\r\n    /**\r\n     * For DataController read callback\r\n     * \r\n     * @param {Array} data \r\n     */\r\n    onDataRead(data = []) {\r\n        const me = this;\r\n        const key = me.key;\r\n        me.#data = GSData.mergeArrays(data.map(o => o[key]), me.#data.map(o => o.value))\r\n               .map(v => {return {value:v}});        \r\n        me.apply(me.#data);\r\n    }   \r\n\r\n    get storage() {\r\n        return GSAttr.get(this, 'storage');\r\n    }\r\n\r\n    /**\r\n     * Storage records key to use to generate unique list\r\n     */\r\n    get key() {\r\n        return GSAttr.get(this, 'key', 0);\r\n    }    \r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSDOM } from '../../base/GSDOM.mjs';\r\nimport { GSData } from '../../base/GSData.mjs';\r\nimport { GSEvents } from '../../base/GSEvents.mjs';\r\nimport { AdoptedController } from '../../controllers/AdoptedController.mjs';\r\nimport { AttributeController } from '../../controllers/AttributeController.mjs';\r\nimport { CopySelectController } from './controllers/CopySelectController.mjs';\r\nimport { MaskController } from './controllers/MaskController.mjs';\r\nimport { MultipatternController } from './controllers/MultipatternController.mjs';\r\nimport { PasswordController } from './controllers/PasswordController.mjs';\r\nimport { NumberController } from './controllers/NumberController.mjs';\r\nimport { TextController } from './controllers/TextController.mjs';\r\nimport { ListController } from './controllers/ListController.mjs';\r\n\r\nimport { ReactiveInput } from './ReactiveInput.mjs';\r\nimport { ValidityController } from './controllers/ValidityController.mjs';\r\n\r\n/**\r\n * Extended HTMLInputElement with controllers support\r\n * adding various features such as masked input support \r\n */\r\nexport class GSInputElement extends ReactiveInput {\r\n\r\n  static properties = {\r\n    autocopy: { type: Boolean },\r\n    autofocus: { type: Boolean },\r\n    autoselect: { type: Boolean },\r\n    reveal: { type: Boolean },\r\n    mask: { reflect: true },\r\n    multipattern: { type : Object},\r\n\r\n    block: { type: Boolean },\r\n    beep: { type: Boolean },\r\n    timeout: { type: Number }\r\n  }\r\n\r\n  #adopted;\r\n  #uiHandler;\r\n\r\n  #copyselect;\r\n  #maskController;\r\n  #multiPatternController;\r\n  #passwordController;\r\n  #numberController;\r\n  #textController;\r\n  #listController;\r\n  #validityController;\r\n\r\n  constructor() {\r\n    super();\r\n    this.block = false;\r\n    this.beep = false;\r\n    this.timeout = 0;\r\n    this.#copyselect = new CopySelectController(this);\r\n    this.#validityController = new ValidityController(this);\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    if (this.isBindable) this.binded();\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    GSEvents.detachListeners(this);\r\n    super.disconnectedCallback();\r\n  }\r\n\r\n  willUpdate(changed) {\r\n\r\n    super.willUpdate(changed);\r\n    const me = this;\r\n\r\n    if (changed.has('mask') && me.mask && me.type === 'text') {\r\n      me.placeholder = me.mask;\r\n      me.#maskController ??= new MaskController(me);\r\n    }\r\n\r\n    if (changed.has('multipattern')) {\r\n      const isMulti = Array.isArray(me.multipattern) && me.multipattern.length > 0;\r\n      const isType = ['text', 'password'].includes(me.type);\r\n      if (isMulti && isType) {\r\n        me.#multiPatternController ??= new MultipatternController(me);\r\n      }\r\n    }\r\n\r\n    if (me.list) {\r\n      me.#listController ??= new ListController(me);\r\n    }\r\n\r\n    switch (me.type) {\r\n      case 'text':\r\n        me.#textController ??= new TextController(me);\r\n        break;\r\n      case 'password':\r\n        me.#passwordController ??= new PasswordController(me);\r\n        break;\r\n      case 'number':\r\n        me.#numberController ??= new NumberController(me);\r\n        break;\r\n    }\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    const me = this;\r\n    if (me.autofocus) me.focus();    \r\n    const data = me.formComponent?.data;\r\n    if (data) GSDOM.fromObject2Element(me, data);\r\n    me.checkValidity();\r\n  }\r\n\r\n  /**\r\n   * Attach bindings\r\n   */\r\n  binded() {\r\n    this.#uiHandler ??= new AttributeController(this);\r\n  }\r\n\r\n  /**\r\n   * Handle bindings \r\n   * @param {*} e \r\n   */\r\n  handle(e) {\r\n    this.#uiHandler?.handle(e);\r\n  }\r\n\r\n  /**\r\n   * Initialize dynamic style for component.\r\n   * Call it from constructor for style to be applied to the component\r\n   * Creates a dynamic StyleSheet which holds dynamic StyleRules\r\n   * @param {String} id \r\n   * @param {String|Object} value \r\n   * @returns {CSSStyleRule}\r\n   */\r\n  dynamicStyle(id, value) {\r\n    this.#adopted ??= new AdoptedController(me);\r\n    return this.#adopted.style(id, value);\r\n  }\r\n\r\n  /**\r\n   * Find element by its ID\r\n   * @param {String} name \r\n   * @returns {HTMLElement}\r\n   */\r\n  getByID(query = '') {\r\n    return GSDOM.getByID(this, query);\r\n  }\r\n\r\n  /**\r\n   * Find closest top element by CSS selector\r\n   * @param {String} query \r\n   * @returns {HTMLElement}\r\n   */\r\n  closest(query = '') {\r\n    return GSDOM.closest(this, query);\r\n  }\r\n\r\n  /**\r\n   * Generic component signal\r\n   * @param {Boolean} bubbles  Does buuble to upper nodes\r\n   * @param {Boolean} composed Does traverse from shadow DOM \r\n   */\r\n  notify(bubbles = true, composed = false, data) {\r\n    this.emit('notify', data, bubbles, composed, true);\r\n  }\r\n\r\n  /**\r\n   * Send event\r\n   * @param {String} name \r\n   * @param {Object} obj \r\n   * @param {Boolean} bubbles \r\n   * @param {Boolean} composed \r\n   * @param {Boolean} cancelable \r\n   */\r\n  emit(name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n    return GSEvents.send(this, name, obj, bubbles, composed, cancelable);\r\n  }\r\n\r\n  /**\r\n   * Wait for event to happen\r\n   * @async\r\n   * @param {String} name \r\n   * @returns {Promise}\r\n   */\r\n  waitEvent(name = '', timeout = 0) {\r\n    return GSEvents.wait(this, name, timeout);\r\n  }\r\n\r\n  /**\r\n   * Listen once for triggered event\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  once(name, func) {\r\n    return this.listen(name, func, true);\r\n  }\r\n\r\n  /**\r\n   * Alternative function for event listen\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  on(name, func, once = false) {\r\n    return this.listen(name, func, once);\r\n  }\r\n\r\n  /**\r\n   * Alternative function for event unlisten\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  off(name, func) {\r\n    return this.unlisten(name, func);\r\n  }\r\n\r\n  /**\r\n   * Prevent event firing up the DOM tree\r\n   * @param {Event} e \r\n   */\r\n  prevent(e) {\r\n    GSEvents.prevent(e);\r\n  }\r\n\r\n  /**\r\n   * Attach event to this element\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  listen(name, func, once = false) {\r\n    return this.attachEvent(this, name, func, once);\r\n  }\r\n\r\n  /**\r\n   * Remove event from this element\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  unlisten(name, func) {\r\n    return this.removeEvent(this, name, func);\r\n  }\r\n\r\n  /**\r\n  * Generic event listener appender\r\n  * \r\n  * @param {HTMLElement} el Element on which to monitor for named events\r\n  * @param {String} name Event name to watch for\r\n  * @param {Function} fn Event trigger callback\r\n  * @param {Boolean} once Listen only once\r\n  * @returns {Boolean} State if attachment was successful\r\n  */\r\n  attachEvent(el, name = '', fn, once = false) {\r\n    return GSEvents.attach(this, el, name, fn, once);\r\n  }\r\n\r\n  /**\r\n  * Generic event listener remove\r\n  * @param {HTMLElement} el Element on which to monitor for named events\r\n  * @param {String} name Event name to watch for\r\n  * @param {Function} fn Event trigger callback\r\n  * @returns {Boolean} State if attachment was successful\t\r\n  */\r\n  removeEvent(el, name = '', fn) {\r\n    return GSEvents.remove(this, el, name, fn);\r\n  }\r\n\r\n  checkValidity() {\r\n    const me = this;\r\n    me.#validityController.reset();\r\n    super.checkValidity();\r\n    me.#multiPatternController?.checkValidity();\r\n    me.#maskController?.checkValidity();\r\n    super.checkValidity();\r\n    return me.validity.valid;\r\n  }\r\n\r\n  reportValidity() {\r\n    super.reportValidity();\r\n    this.#validityController.report();\r\n  }\r\n\r\n  reset() {\r\n    GSDOM.reset(this);\r\n  }\r\n\r\n  get formComponent() {\r\n    return this.closest('gs-form');\r\n  }\r\n\r\n  get owner() {\r\n    const own = GSDOM.root(this);\r\n    return GSDOM.unwrap(own);\r\n  }\r\n\r\n  /**\r\n   * Get parent GS-* component\r\n   */\r\n  get parentComponent() {\r\n    return GSDOM.parentAll(this).filter(x => x instanceof GSElement).next()?.value;\r\n  }\r\n\r\n  get raw() {\r\n    return super.value;\r\n  }\r\n\r\n  get value() {\r\n    return this.#maskController ? this.#maskController.value : super.value;\r\n  }\r\n\r\n  set value(val) {\r\n    super.value = this.mask === val ? '' : val;\r\n  }\r\n\r\n  /**\r\n   * Check if component is bindable to process data-gs-atributes\r\n   */\r\n  get isBindable() {\r\n    return this.dataset.gsTarget;\r\n  }\r\n\r\n  /**\r\n   * Return true if current element or chadow dom child is focused\r\n   */\r\n  get isFocused() {\r\n    return this === document.activeElement;\r\n  }\r\n\r\n  /**\r\n   * Element tag name\r\n   */\r\n  get tag() {\r\n    return this.tagName.toLowerCase();\r\n  }\r\n\r\n  /**\r\n   * Get this class name\r\n   */\r\n  get clazzName() {\r\n    return this.constructor.name;\r\n  }\r\n\r\n  get definitions() {\r\n    const list = [...GSDOM.inheritance(this)].map(o => o.constructor?.properties).filter(o => o);\r\n    list.push(this.constructor?.properties);\r\n    return GSData.mergeObjects(list);\r\n  }\r\n\r\n  /**\r\n   * Extract and merge all static properties definition from WebComponent instance\r\n   * @param {GSInputElement} obj \r\n   * @returns {Object}\r\n   */\r\n  static allProperties(obj) {\r\n    const list = [...GSDOM.inheritance(obj)].map(o => o.properties).filter(o => o);\r\n    list.push(obj.constructor?.properties || obj.properties);\r\n    return GSData.mergeObjects(list);\r\n  }\r\n\r\n  /**\r\n   * Register class as WebComponent to the browser\r\n   * @param {String} name \r\n   * @param {class} clazz Optional, if not set, use self\r\n   */\r\n  static define(name, clazz) {\r\n    if (!customElements.get(name)) {\r\n      customElements.define(name, clazz || this, { extends: 'input' });\r\n    }\r\n  }\r\n\r\n  static {\r\n    GSInputElement.define('gs-ext-input', GSInputElement);\r\n  }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDataListExt class\r\n * @module components/ext/GSDataListExt\r\n */\r\n\r\nimport { GSID } from \"../../base/GSID.mjs\";\r\nimport { GSDOM } from \"../../base/GSDOM.mjs\";\r\nimport { GSLoader } from \"../../base/GSLoader.mjs\";\r\nimport { GSEvents } from \"../../base/GSEvents.mjs\";\r\nimport { GSAttr } from \"../../base/GSAttr.mjs\";\r\nimport { CopySelectController } from \"./controllers/CopySelectController.mjs\";\r\nimport { ValidityController } from \"./controllers/ValidityController.mjs\";\r\n\r\n/**\r\n * Add JSON loader to select element\r\n * <textarea is=\"gs-ext-text\"></textarea>\r\n * \r\n * [{text:'', value:'' selected:true}]\r\n * \r\n * @class\r\n * @extends {HTMLTextAreaElement}\r\n */\r\nexport class GSTextArea extends HTMLTextAreaElement {\r\n\r\n    static {\r\n        customElements.define('gs-ext-text', GSTextArea, { extends: 'textarea' });\r\n        Object.seal(GSTextArea);\r\n    }\r\n\r\n    #isConnected = false;\r\n    #controllers = undefined;\r\n\r\n    #copyselect;\r\n    #validityController;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#copyselect = new CopySelectController(this);\r\n        this.#validityController = new ValidityController(this);\r\n    }\r\n\r\n    attributeChangedCallback(name, oldValue, newValue) {\r\n        this.#controllers?.forEach((c) => c.hostUpdated?.());\r\n    }\r\n\r\n    connectedCallback() {\r\n        const me = this;\r\n        GSID.setIf(me);\r\n        const data = me.form?.data;\r\n        if (data) GSDOM.fromObject2Element(me, data);\r\n        me.#controllers?.forEach((c) => c.hostConnected?.());\r\n        me.#isConnected = true;\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        const me = this;\r\n        me.#isConnected = false;\r\n        me.#controllers?.forEach((c) => c.hostDisconnected?.());\r\n        GSEvents.detachListeners(me);\r\n    }\r\n\r\n    addController(controller) {\r\n        const me = this;\r\n        (me.#controllers ??= new Set()).add(controller);\r\n        if (me.#isConnected) {\r\n            controller.hostConnected?.();\r\n        }\r\n    }\r\n\r\n    removeController(controller) {\r\n        this.#controllers?.delete(controller);\r\n    }\r\n\r\n    checkValidity() {\r\n        const me = this;\r\n        me.#validityController.reset();\r\n        return super.checkValidity();\r\n    }\r\n\r\n    reportValidity() {\r\n        super.reportValidity();\r\n        this.#validityController.report();\r\n    }\r\n\r\n    reset() {\r\n        GSDOM.reset(this);\r\n    }\r\n    \r\n    get block() {\r\n        return this.hasAttribute('block');\r\n    }\r\n\r\n    get beep() {\r\n        return this.hasAttribute('beep');\r\n    }\r\n\r\n    get timeout() {\r\n        return GSAttr.getAsNum(this, 'timeout', 0);\r\n    }\r\n\r\n    set block(val = false) {\r\n        GSAttr.toggle(this, 'block', val);\r\n    }\r\n\r\n    set beep(val = false) {\r\n        GSAttr.toggle(this, 'beep', val);\r\n    }\r\n\r\n    set timeout(val = 0) {\r\n        return GSAttr.setAsNum(this, 'timeout', val);\r\n    }\r\n\r\n    get form() {\r\n        return this.closest('gs-form');\r\n    }\r\n\r\n    get owner() {\r\n        const own = GSDOM.root(this);\r\n        return GSDOM.unwrap(own);\r\n    }\r\n\r\n    /**\r\n     * Get parent GS-* component\r\n     */\r\n    get parentComponent() {\r\n        return GSDOM.parentAll(this).filter(x => x instanceof GSElement).next()?.value;\r\n    }\r\n\r\n    /**\r\n     * Find closest top element by CSS selector\r\n     * @param {String} query \r\n     * @returns {HTMLElement}\r\n     */\r\n    closest(query = '') {\r\n        return GSDOM.closest(this, query);\r\n    }\r\n\r\n    async load(url = '') {\r\n        if (!url) return;\r\n        this.value = await GSLoader.loadSafe(url, 'GET', null, true);\r\n    }\r\n\r\n    /**\r\n     * Generic component signal\r\n     * @param {Boolean} bubbles  Does buuble to upper nodes\r\n     * @param {Boolean} composed Does traverse from shadow DOM \r\n     */\r\n    notify(bubbles = true, composed = false, data) {\r\n        this.emit('notify', data, bubbles, composed, true);\r\n    }\r\n\r\n    /**\r\n     * Send event\r\n     * @param {String} name \r\n     * @param {Object} obj \r\n     * @param {Boolean} bubbles \r\n     * @param {Boolean} composed \r\n     * @param {Boolean} cancelable \r\n     */\r\n    emit(name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n        return GSEvents.send(this, name, obj, bubbles, composed, cancelable);\r\n    }\r\n\r\n    /**\r\n     * Wait for event to happen\r\n     * @async\r\n     * @param {String} name \r\n     * @returns {Promise}\r\n     */\r\n    waitEvent(name = '', timeout = 0) {\r\n        return GSEvents.wait(this, name, timeout);\r\n    }\r\n\r\n    /**\r\n     * Listen once for triggered event\r\n     * @param {String} name  A name of the event\r\n     * @param {Function} func A callback function on event trigger\r\n     * @returns {Boolean}\r\n     */\r\n    once(name, func) {\r\n        return this.listen(name, func, true);\r\n    }\r\n\r\n    /**\r\n     * Alternative function for event listen\r\n     * @param {String} name  A name of the event\r\n     * @param {Function} func A callback function on event trigger\r\n     * @returns {Boolean}\r\n     */\r\n    on(name, func, once = false) {\r\n        return this.listen(name, func, once);\r\n    }\r\n\r\n    /**\r\n     * Alternative function for event unlisten\r\n     * @param {String} name  A name of the event\r\n     * @param {Function} func A callback function on event trigger\r\n     * @returns {Boolean}\r\n     */\r\n    off(name, func) {\r\n        return this.unlisten(name, func);\r\n    }\r\n\r\n    /**\r\n     * Prevent event firing up the DOM tree\r\n     * @param {Event} e \r\n     */\r\n    prevent(e) {\r\n        GSEvents.prevent(e);\r\n    }\r\n\r\n    /**\r\n     * Attach event to this element\r\n     * @param {String} name  A name of the event\r\n     * @param {Function} func A callback function on event trigger\r\n     * @returns {Boolean}\r\n     */\r\n    listen(name, func, once = false) {\r\n        return this.attachEvent(this, name, func, once);\r\n    }\r\n\r\n    /**\r\n     * Remove event from this element\r\n     * @param {String} name  A name of the event\r\n     * @param {Function} func A callback function on event trigger\r\n     * @returns {Boolean}\r\n     */\r\n    unlisten(name, func) {\r\n        return this.removeEvent(this, name, func);\r\n    }\r\n\r\n    /**\r\n    * Generic event listener appender\r\n    * \r\n    * @param {HTMLElement} el Element on which to monitor for named events\r\n    * @param {String} name Event name to watch for\r\n    * @param {Function} fn Event trigger callback\r\n    * @param {Boolean} once Listen only once\r\n    * @returns {Boolean} State if attachment was successful\r\n    */\r\n    attachEvent(el, name = '', fn, once = false) {\r\n        return GSEvents.attach(this, el, name, fn, once);\r\n    }\r\n\r\n    /**\r\n    * Generic event listener remove\r\n    * @param {HTMLElement} el Element on which to monitor for named events\r\n    * @param {String} name Event name to watch for\r\n    * @param {Function} fn Event trigger callback\r\n    * @returns {Boolean} State if attachment was successful\t\r\n    */\r\n    removeEvent(el, name = '', fn) {\r\n        return GSEvents.remove(this, el, name, fn);\r\n    }\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { html, ifDefined, repeat } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { color } from '../../properties/color.mjs';\r\n\r\nexport class GSBreadcrumbElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    data: { type: Array },\r\n    color: { ...color },\r\n    divider: { reflect: true },\r\n    spacing: { reflect: true, type: Number },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.spacing = 1;\r\n    me.divider = 'chevron-right';\r\n    me.#updateChildren();\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    this.#updateChildren();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<nav part=\"base\" class=\"breadcrumb\" @click=\"${me.#onClick}\" dir=\"${ifDefined(me.direction)}\"><slot>\r\n      ${repeat(me.data || [], (item) => item, (item) => html`\r\n        <gs-breadcrumb-item  \r\n        href=\"${item.href}\"\r\n        color=\"${item.color}\"\r\n        .data=${item}     \r\n        .active=${item.active}\r\n        .divider=\"${item.divider || me.divider}\"\r\n        .spacing=\"${item.spacing || me.spacing}\">\r\n          ${item.$text}\r\n        </gs-breadcrumb-item>\r\n      `)}\r\n    </slot></nav>`;\r\n  }\r\n\r\n  onDataRead(data) {\r\n    this.data = data;\r\n  }\r\n\r\n  #updateChildren() {\r\n    const me = this;\r\n    me.queryAll('gs-breadcrumb-item').forEach(el => {\r\n      el.divider = me.divider;\r\n      el.spacing = me.spacing;\r\n      el.color = me.color;\r\n    });\r\n  }\r\n\r\n  #onClick(e) {\r\n    const el = e.target.closest('gs-bradcrumb-item');\r\n    el?.handle(e);\r\n  } \r\n\r\n  static {\r\n    this.define('gs-breadcrumb');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { color } from '../../properties/color.mjs';\r\nimport { GSLinklement } from '../Link.mjs';\r\nimport { GSAttributeHandler } from '../../base/GSAttributeHandler.mjs';\r\n\r\nexport class GSBreadcrumbItemElement extends GSElement {\r\n\r\n  static properties = {\r\n    href: {},\r\n    color: { ...color },\r\n    data: { state: true, type: Object },\r\n    active: { reflect: true, type: Boolean },\r\n    divider: { state: true, type: Boolean },\r\n    spacing: { state: true, type: Number },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.data = {};\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div part=\"base\" class=\"breadcrumb-item ${classMap(me.renderClass())}\"  dir=\"${ifDefined(me.direction)}\">\r\n        <span part=\"prefix\"><slot name=\"prefix\"></slot></span>        \r\n        ${me.#label}\r\n        <span part=\"suffix\"><slot name=\"suffix\"></slot></span>\r\n        <span part=\"separator\"><slot name=\"separator\">${me.#separator}</slot></span>\r\n      </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'active': me.active,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  get #label() {\r\n    const me = this;\r\n    if (me.active) return html`<slot></slot>`;\r\n    me.data.url = me.data.url || me.href;\r\n    me.data.part = 'label';\r\n    return GSLinklement.generate(me.data, {})\r\n  }\r\n\r\n  get #separator() {\r\n    const me = this;\r\n    return me.nextElementSibling && me.divider ? html`<gs-icon size=\"7\" color=\"${me.color}\" css=\"mx-${me.spacing}\" name=\"${me.divider}\"></gs-icon>` : '';\r\n  }\r\n\r\n  handle(e) {\r\n    GSAttributeHandler.process(this.query('a', true), e);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-breadcrumb-item');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSAttachment class\r\n * @module components/filebox/GSAttachment\r\n */\r\n\r\n/**\r\n * Handles DataFileTransfer object\r\n * @class\r\n */\r\nexport class GSAttachment {\r\n\r\n    constructor(file, directory) {\r\n        this.file = file;\r\n        this.directory = directory;\r\n    }\r\n\r\n    static traverse(transfer, directory) {\r\n        return GSAttachment.#transferredFiles(transfer, directory);\r\n    }\r\n\r\n    static from(files) {\r\n        return Array.from(files).filter(f => f instanceof File).map(f => new GSAttachment(f));\r\n    }\r\n\r\n    get fullPath() {\r\n        const me = this;\r\n        return me.directory ? `${me.directory}/${me.file.name}` : me.file.name;\r\n    }\r\n\r\n    isImage() {\r\n        return ['image/gif', 'image/png', 'image/jpg', 'image/jpeg', 'image/svg+xml'].includes(this.file.type);\r\n    }\r\n\r\n    isVideo() {\r\n        return ['video/mp4', 'video/quicktime'].includes(this.file.type);\r\n    }\r\n\r\n    static #transferredFiles(transfer, directory) {\r\n        if (directory && GSAttachment.#isDirectory(transfer)) {\r\n            return GSAttachment.#traverse('', GSAttachment.#roots(transfer));\r\n        }\r\n        return Promise.resolve(GSAttachment.#visible(Array.from(transfer.files || [])).map(f => new GSAttachment(f)));\r\n    }\r\n\r\n    static #hidden(file) {\r\n        return file.name.startsWith('.');\r\n    }\r\n\r\n    static #visible(files) {\r\n        return Array.from(files).filter(file => !GSAttachment.#hidden(file));\r\n    }\r\n\r\n    static #getFile(entry) {\r\n        return new Promise(function (resolve, reject) {\r\n            entry.file(resolve, reject);\r\n        });\r\n    }\r\n\r\n    static #getEntries(entry) {\r\n        return new Promise(function (resolve, reject) {\r\n            const result = [];\r\n            const reader = entry.createReader();\r\n            const read = () => {\r\n                reader.readEntries(entries => {\r\n                    if (entries.length > 0) {\r\n                        result.push(...entries);\r\n                        read();\r\n                    } else {\r\n                        resolve(result);\r\n                    }\r\n                }, reject);\r\n            };\r\n            read();\r\n        });\r\n    }\r\n\r\n    static async #traverse(path, entries) {\r\n        const results = [];\r\n        for (const entry of GSAttachment.#visible(entries)) {\r\n            if (entry.isDirectory) {\r\n                const entries = await GSAttachment.#getEntries(entry);\r\n                const list = await GSAttachment.#traverse(entry.fullPath, entries);\r\n                results.push(...(list));\r\n            } else {\r\n                const file = await GSAttachment.#getFile(entry);\r\n                results.push(new GSAttachment(file, path));\r\n            }\r\n        }\r\n        return results;\r\n    }\r\n\r\n    static #isDirectory(transfer) {\r\n        return Array.from(transfer.items).some((item) => {\r\n            const entry = item.webkitGetAsEntry && item.webkitGetAsEntry();\r\n            return entry && entry.isDirectory;\r\n        });\r\n    }\r\n\r\n    static #roots(transfer) {\r\n        return Array.from(transfer.items)\r\n            .map((item) => item.webkitGetAsEntry())\r\n            .filter(entry => entry != null);\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSFileBox class\r\n * @module components/filebox/GSFileBox\r\n */\r\n\r\nimport { classMap, createRef, ref, css, html, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSAttachment } from './Attachment.mjs';\r\nimport { GSEvents } from '../../base/GSEvents.mjs';\r\n\r\n/**\r\n * File box allows drag-n-drop fiels for upload\r\n * <gs-filebox id=\"other\" multiple=\"true\" directory=\"true\" elid=\"test\"></gs-filebox>\r\n * Use event listener to return false for file access filtering\r\n * @class\r\n * @extends {GSElement}\r\n */\r\nexport class GSFileBoxElement extends GSElement {\r\n\r\n    static TITLE = 'Drop file/s here or click to select';\r\n    static CSS = 'border-2 p-4 d-block text-center dash';\r\n\r\n    static properties = {\r\n        cssList: { attribute: 'css-list' },\r\n        cssLabel: { attribute: 'css-label' },\r\n        cssInput: { attribute: 'css-input' },\r\n\r\n        multiple: { reflect: true, type: Boolean },\r\n        directory: { reflect: true, type: Boolean },\r\n        name: {},\r\n        title: {},\r\n        accept: {},\r\n        filter: {},\r\n        maxFileSize: { reflect: true, attribute: 'max-file-size', type: Number }, // New property\r\n    }\r\n\r\n    #listEl = createRef();\r\n    #fileEl = createRef();\r\n    #dragging = null;\r\n\r\n    constructor() {\r\n        super();\r\n        this.css = GSFileBoxElement.CSS;\r\n        this.cssInput = 'd-none';\r\n        this.multiple = true;\r\n        this.title = GSFileBoxElement.TITLE;\r\n        this.filter = '^image\\/(gif|png|jpeg)$'\r\n        this.directory = false;\r\n        this.maxFileSize = 0; // Default to 0, meaning no limit\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`\r\n        <div part=\"border\" class=\"${classMap(me.renderClass())}\"\r\n            dir=\"${ifDefined(me.direction)}\"\r\n            @click=\"${me.#onClick}\"\r\n            @dragenter=\"${me.#onDragenter}\"\r\n            @dragover=\"${me.#onDragenter}\"\r\n            @dragleave=\"${me.#onDragleave}\"\r\n            @drop=\"${me.#onDrop}\"\r\n            @paste=\"${me.#onPaste}\"\r\n            @change=\"${me.#onChange}\">\r\n            <label part=\"label\" class=\"${me.cssLabel}\" for=\"${me.name}\">${me.translate(me.title)}</label>\r\n            <input ${ref(me.#fileEl)}  part=\"input\" \r\n                type=\"file\" accept=\"${me.accept}\" \r\n                class=\"${me.cssInput}\" \r\n                name=\"${me.name}\" \r\n                id=\"${me.name}\" \r\n                ${me.multiple ? \"multiple\" : \"\"} \r\n                ${me.directory ? \"directory webkitdirectory\" : \"\"}>\r\n            <pre ${ref(me.#listEl)} part=\"list\" class=\"${me.cssList}\"></pre>\r\n        </div>\r\n        `\r\n    }\r\n\r\n    get listEl() {\r\n        return this.#listEl.value;\r\n    }\r\n\r\n    get fileEl() {\r\n        return this.#fileEl.value;\r\n    }\r\n\r\n    #onClick(e) {\r\n        this.fileEl.click();\r\n    }\r\n\r\n    #onDragenter(e) {\r\n        const me = this;\r\n        if (me.#dragging) clearTimeout(me.#dragging);\r\n        me.#dragging = setTimeout(() => me.removeAttribute('hover'), 200);\r\n        const transfer = e.dataTransfer;\r\n        if (!transfer || !me.#hasFile(transfer)) return;\r\n        transfer.dropEffect = 'copy';\r\n        me.setAttribute('hover', '');\r\n        e.preventDefault();\r\n    }\r\n\r\n    #onDragleave(e) {\r\n        const me = this;\r\n        if (e.dataTransfer) e.dataTransfer.dropEffect = 'none';\r\n        me.removeAttribute('hover');\r\n        GSEvents.prevent(e);\r\n    }\r\n\r\n    #onDrop(e) {\r\n        const me = this;\r\n        me.removeAttribute('hover');\r\n        const transfer = e.dataTransfer;\r\n        if (!transfer || !me.#hasFile(transfer)) return;\r\n        me.#attach(transfer);\r\n        GSEvents.prevent(e);\r\n    }\r\n\r\n    #onPaste(e) {\r\n        const me = this;\r\n        if (!e.clipboardData) return;\r\n        if (!e.clipboardData.items) return;\r\n        const file = me.#pastedFile(e.clipboardData.items);\r\n        if (!file) return;\r\n        const files = [file];\r\n        me.#attach(files);\r\n        GSEvents.prevent(e);\r\n    }\r\n\r\n    #onChange(e) {\r\n        const me = this;\r\n        const input = me.fileEl;\r\n        const files = input.files;\r\n        if (!files || files.length === 0) return;\r\n        me.#attach(files);\r\n        // input.value = '';\r\n    }\r\n\r\n    #hasFile(transfer) {\r\n        return Array.from(transfer.types).includes('Files');\r\n    }\r\n\r\n    #pastedFile(items) {\r\n        const me = this;\r\n        const rgx = me.filter ? new RegExp(me.filter) : null;\r\n        for (const item of items) {\r\n            if (item.kind === 'file') {\r\n                if (!rgx) return item.getAsFile();\r\n                if (rgx.test(item.type)) return item.getAsFile();\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    #accept(attachments) {\r\n        const me = this;\r\n        const dataTransfer = new DataTransfer();\r\n        attachments.forEach(a => dataTransfer.items.add(a.file))\r\n        me.fileEl.files = dataTransfer.files;\r\n        me.listEl.textContent = attachments.map(a => a.file.name).join('\\n');\r\n    }\r\n\r\n    async #attach(transferred) {\r\n        const me = this;\r\n        const isDataTfr = transferred instanceof DataTransfer;\r\n        const attachments = isDataTfr\r\n            ? await GSAttachment.traverse(transferred, me.directory)\r\n            : GSAttachment.from(transferred);\r\n\r\n        // Filter out files that exceed the maxFileSize\r\n        const validAttachments = me.maxFileSize > 0 \r\n            ? attachments.filter(a => a.file.size <= me.maxFileSize)\r\n            : attachments;\r\n\r\n        const accepted = me.emit('accept', { attachments: validAttachments }, true, false, true);\r\n        if (accepted && validAttachments.length) {\r\n            me.#accept(validAttachments);\r\n            me.emit('accepted', { attachments: validAttachments }, true);\r\n        }\r\n    }\r\n\r\n    static styles = css`\r\n        .dash {\r\n            border-style: var(--gs-fieldbox-border, dashed) !important;\r\n            border-color: var(--gs-fieldbox-border-color, lightgrey);\r\n        }\r\n        input[type=file] {\r\n            color : var(--gs-fieldbox-color, transparent);\r\n        } \r\n        input[type=file]::file-selector-button {}             \r\n        input[type=file]::file-selector-button:hover {}`;\r\n\r\n    static {\r\n        this.define('gs-filebox');\r\n    }\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSUtil } from '../../base/GSUtil.mjs';\r\n\r\n/**\r\n * A module rendering current time on a page\r\n * @module components/TimeFormat\r\n */\r\n\r\n/**\r\n * Render Time value\r\n * \r\n * @class\r\n * @extends {HTMLElement}\r\n */\r\nexport class GSTimeFormat extends GSElement {\r\n\r\n    static properties = {\r\n        interval: {reflect:true, type:Number},\r\n        language: {reflect:true},\r\n    }\r\n\r\n    #id = 0;\r\n\r\n    constructor() {\r\n        super();\r\n        this.interval = 1;\r\n        this.language = GSUtil.language;\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        this.start();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        this.stop();\r\n        super.disconnectedCallback();\r\n    }\r\n\r\n    renderUI() {\r\n        const date = new Date();\r\n        return date.toLocaleTimeString(this.language);\r\n    }    \r\n\r\n    start() {\r\n        const me = this;\r\n        if (me.interval >0 && me.#id === 0) {\r\n            me.#id = setInterval(me.#update.bind(me), me.interval * 1000);\r\n        } else {\r\n            me.requestUpdate();\r\n        }\r\n    }\r\n\r\n    stop() {\r\n        clearInterval(this.#id);\r\n        this.#id = 0;\r\n    }\r\n    \r\n    #update() {\r\n       requestAnimationFrame(() => this.requestUpdate());\r\n    }\r\n\r\n    static {\r\n        this.define('gs-time-format');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module rendering date with specific langauge support\r\n * @module components/DateFormat\r\n */\r\n\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSDate } from '../../base/GSDate.mjs';\r\n\r\n/**\r\n * Render Date value with international language support\r\n * \r\n * All options - set dasta-[name]; data-weekday etc...\r\n       {\r\n       weekday: 'narrow' | 'short' | 'long',\r\n       era: 'narrow' | 'short' | 'long',\r\n       year: 'numeric' | '2-digit',\r\n       month: 'numeric' | '2-digit' | 'narrow' | 'short' | 'long',\r\n       day: 'numeric' | '2-digit',\r\n       hour: 'numeric' | '2-digit',\r\n       minute: 'numeric' | '2-digit',\r\n       second: 'numeric' | '2-digit',\r\n       timeZoneName: 'short' | 'long',\r\n\r\n       // Time zone to express it in\r\n       timeZone: 'Asia/Shanghai',\r\n       // Force 12-hour or 24-hour\r\n       hour12: true | false,\r\n\r\n       dateStyle: full | long | medium | short\r\n       timeStyle: full | long | medium | short\r\n\r\n       // Rarely-used options\r\n       hourCycle: 'h11' | 'h12' | 'h23' | 'h24',\r\n       formatMatcher: 'basic' | 'best fit'\r\n       }\r\n * @class\r\n * @extends {HTMLElement}\r\n */\r\nexport class GSDateFormat extends GSElement {\r\n\r\n    static properties = {\r\n        value: {},\r\n        format: {},\r\n        language: {},\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.language = navigator.language;\r\n        this.value = new Date();\r\n    }\r\n\r\n    renderUI() {\r\n        return this.result;\r\n    }    \r\n\r\n    get result() {\r\n        const me = this;\r\n        const val = me.date;\r\n        if (me.format) return val.format(me.format);\r\n        return new Intl.DateTimeFormat(me.language, me.dataset).format(val);\r\n    }\r\n\r\n    get date() {\r\n        const me = this;\r\n        const o = Date.parse(me.value || new Date());\r\n        const date = new GSDate(o);\r\n        date.language = me.language;\r\n        return date;\r\n    }\r\n\r\n\r\n    static {\r\n        this.define('gs-date-format');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module rendering current year on a page\r\n * @module components/YearFormat\r\n */\r\nimport { GSElement } from '../../GSElement.mjs';\r\n\r\n/**\r\n * Render Year value\r\n * \r\n * @class\r\n * @extends {HTMLElement}\r\n */\r\nexport class GSYearFormat extends GSElement {\r\n\r\n    static properties = {\r\n        offset: {type :Number},\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.offset = 0;\r\n    }\r\n\r\n    renderUI() {\r\n        return this.value;\r\n    }\r\n\r\n    get value() {\r\n        return this.current + this.offset;\r\n    }\r\n\r\n    get current() {\r\n        return new Date().getFullYear();\r\n    }\r\n\r\n    static {\r\n        this.define('gs-year-format');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/NumberFormat/NumberFormat#options\r\n\r\n\r\n/**\r\n * A module rendering numeric value as curency format with specific langauge support\r\n * @module components/CurrencyFormat\r\n */\r\nimport { GSElement } from '../../GSElement.mjs';\r\n\r\n/**\r\n * Render Year value\r\n * \r\n * @class\r\n * @extends {HTMLElement}\r\n */\r\nexport class GSCurrencyFormat extends GSElement {\r\n\r\n    static properties = {\r\n        value: {},\r\n        currency: {},\r\n        language: {},\r\n    }\r\n\r\n    renderUI() {\r\n        return this.format;\r\n    }\r\n\r\n    get #options() {\r\n        const me = this;\r\n        return Object.apply(me.dataset, { style: 'currency', currency: me.currency });\r\n    }\r\n\r\n    get format() {\r\n        const me = this;\r\n        return new Intl.NumberFormat(me.language, me.#options).format(me.value);\r\n    }\r\n\r\n    static {\r\n        this.define('gs-currency-format');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSCacheStyles } from \"../../base/GSCacheStyles.mjs\";\r\n\r\n/**\r\n * A module loading GSStepStyle class\r\n * @module components/steps/GSStepStyle\r\n */\r\nexport class GSStepStyle {\r\n\r\n    static {\r\n        GSCacheStyles.adopt(GSStepStyle.style);\r\n    }\r\n\r\n    static get style() {\r\n        return `\r\n        .step .step-icon-wrap {\r\n            height: 80px;\r\n        }\r\n        \r\n        .step .step-icon-wrap::before,\r\n        .step .step-icon-wrap::after {\r\n            display: block;\r\n            position: absolute;\r\n            top: 50%;\r\n            width: 50%;\r\n            height: 3px;\r\n            margin-top: -1px;\r\n            background-color: var(--bs-gray-200);\r\n            content: '';\r\n            z-index: 1\r\n        }\r\n        \r\n        .step .step-icon-wrap::before {\r\n            left: 0\r\n        }\r\n        \r\n        .step .step-icon-wrap::after {\r\n            right: 0\r\n        }\r\n        \r\n        .step .step-icon {\r\n            width: 80px;\r\n            height: 80px;\r\n            line-height: 81px;\r\n            z-index: 5\r\n        }\r\n                \r\n        .step:first-child .step-icon-wrap::before {\r\n            display: none\r\n        }\r\n        \r\n        .step:last-child .step-icon-wrap::after {\r\n            display: none\r\n        }\r\n                \r\n        @media (max-width: 576px) {\r\n            .flex-sm-nowrap .step .step-icon-wrap::before,\r\n            .flex-sm-nowrap .step .step-icon-wrap::after {\r\n                display: none\r\n            }\r\n        }\r\n        \r\n        @media (max-width: 768px) {\r\n            .flex-md-nowrap .step .step-icon-wrap::before,\r\n            .flex-md-nowrap .step .step-icon-wrap::after {\r\n                display: none\r\n            }\r\n        }\r\n        \r\n        @media (max-width: 991px) {\r\n            .flex-lg-nowrap .step .step-icon-wrap::before,\r\n            .flex-lg-nowrap .step .step-icon-wrap::after {\r\n                display: none\r\n            }\r\n        }\r\n        \r\n        @media (max-width: 1200px) {\r\n            .flex-xl-nowrap .step .step-icon-wrap::before,\r\n            .flex-xl-nowrap .step .step-icon-wrap::after {\r\n                display: none\r\n            }\r\n        }        \r\n        `;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSStepElement class\r\n * @module components/steps/GSStepElement\r\n */\r\n\r\nimport { html, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\n\r\n/**\r\n * GSStep a signle element\r\n * @class\r\n * @extends {Component}\r\n */\r\nexport default class GSStepElement extends GSElement {\r\n\r\n    static INACTIVE = 'text-bg-light';\r\n    static SELECTED = 'text-bg-primary';\r\n    static COMPLETED = 'text-bg-secondary';\r\n\r\n    static ICON_CSS = 'border rounded-circle fs-1';\r\n    static TITLE_CSS = 'mb-0 fs-6 mt-3 fw-bold';\r\n\r\n    static properties = {\r\n        title: {},\r\n        icon: {},\r\n        color: {},\r\n        iconCSS: { attribute: 'icon-css' },\r\n        titleCSS: { attribute: 'title-css' },\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const clazz = GSStepElement;\r\n        this.icon = clazz.INACTIVE;\r\n        this.iconCSS = clazz.ICON_CSS;\r\n        this.titleCSS = clazz.TITLE_CSS;\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`\r\n        <div class=\"step d-block w-100 text-center mb-4\"  dir=\"${ifDefined(me.direction)}\">\r\n            <div class=\"step-icon-wrap d-block w-100 text-center position-relative\">\r\n                <div class=\"step-icon position-relative d-inline-block ${me.iconCSS} ${me.color || GSStepElement.INACTIVE}\">\r\n                    ${me.#renderIcon()}\r\n                </div>\r\n            </div>\r\n            <div class=\"step-title ${me.titleCSS}\">${me.translate(me.title)}</div>\r\n        </div>        \r\n        `;\r\n    }\r\n\r\n    #renderIcon() {\r\n        return this.icon ? html`<gs-icon name=\"${this.icon}\"></gs-icon>` : html`<slot name=\"icon\"></slot>`;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-step');\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSStepsElement class\r\n * @module components/steps/GSStepsElement\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSStepStyle } from \"./StepStyle.mjs\";\r\nimport GSStepElement from './Step.mjs';\r\n\r\n/**\r\n * Steps walker prev/next track current step and update step status\r\n * \r\n * @class\r\n * @extends {Component}\r\n */\r\nexport default class GSStepsElement extends GSElement {\r\n\r\n    static CSS = 'steps d-flex flex-wrap flex-sm-nowrap justify-content-between padding-top-2x padding-bottom-1x';\r\n\r\n    #index = -1;\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    shouldUpdate(changedProperties) { \r\n        return this.steps.length > 0;\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div class=\"${classMap(me.renderClass())}\"  dir=\"${ifDefined(me.direction)}\"><slot></slot></div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        return this.mapCSS(GSStepsElement.CSS, super.renderClass());\r\n    }\r\n\r\n    get steps() {\r\n        return this.queryAll('gs-step');\r\n    }\r\n\r\n    get length() {\r\n        return this.steps.length;\r\n    }\r\n\r\n    get index() {\r\n        return this.#index;\r\n    }\r\n\r\n    set index(val = 0) {\r\n        const me = this;\r\n        if (val < 0 || val >= me.length) return;\r\n        me.#index = val;\r\n    }\r\n\r\n    get current() {\r\n        const me = this;\r\n        return me.steps[me.#index];\r\n    }\r\n\r\n    get isFirst() {\r\n        return this.#index === 0;\r\n    }\r\n\r\n    get isLast() {\r\n        return this.#index === this.length - 1;\r\n    }\r\n\r\n    next() {\r\n        const me = this;\r\n        if (me.steps.length === 0) return;\r\n        if (me.isLast) return false;\r\n        if (me.#index > - 1) me.current.color = GSStepElement.COMPLETED;\r\n        me.index++;\r\n        me.current.color = GSStepElement.SELECTED;\r\n        return me.current;\r\n    }\r\n\r\n    previous() {\r\n        const me = this;\r\n        if (me.steps.length === 0) return;\r\n        if (me.isFirst) return false;\r\n        me.current.color = GSStepElement.INACTIVE;\r\n        me.index--;\r\n        me.current.color = GSStepElement.SELECTED;\r\n        return me.current;\r\n    }\r\n\r\n    reset() {\r\n        const me = this;\r\n        me.steps.forEach(it => it.color = GSStepElement.INACTIVE);\r\n        requestAnimationFrame(() => {\r\n            me.#index = 0;\r\n            me.current.color = GSStepElement.SELECTED;\r\n        });\r\n    }\r\n\r\n    static {\r\n        GSStepStyle.style;\r\n        this.define('gs-steps', GSStepsElement);\r\n    }\r\n\r\n}","\r\nimport { classMap, html, ifDefined } from '../../lib.mjs';\r\nimport { GSAttr } from '../../base/GSAttr.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSDOM } from '../../base/GSDOM.mjs';\r\n\r\nexport class GSNotificationElement extends GSElement {\r\n\r\n    static TOP_START = \"position-fixed top-0 start-0\";\r\n    static TOP_CENTER = \"position-fixed top-0 start-50 translate-middle-x\";\r\n    static TOP_END = \"position-fixed top-0 end-0\";\r\n\r\n    static MIDDLE_START = \"position-fixed top-50 start-0 translate-middle-y\";\r\n    static MIDDLE_CENTER = \"position-fixed top-50 start-50 translate-middle\";\r\n    static MIDDLE_END = \"position-fixed top-50 end-0 translate-middle-y\";\r\n    \r\n    static BOTTOM_START = \"position-fixed bottom-0 start-0\";\r\n    static BOTTOM_CENTER = \"position-fixed bottom-0 start-50 translate-middle-x\";\r\n    static BOTTOM_END = \"position-fixed bottom-0 end-0\";\r\n\r\n    static DEFAULT = GSNotificationElement.BOTTOM_END;\r\n\r\n    static properties = {\r\n        position: { reflect: true },\r\n        native: { reflect: true, type: Boolean }\r\n    };\r\n\r\n    #list = new Set();\r\n\r\n    constructor() {\r\n        super();\r\n        this.css = 'p-3';\r\n        this.position = GSNotificationElement.DEFAULT;\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div  dir=\"${ifDefined(me.direction)}\"\r\n            class=\"toast-container z-10k ${classMap(me.renderClass())}\">\r\n            <slot></slot>\r\n        </div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        return me.mapCSS(me.#positionCSS, super.renderClass());\r\n    }    \r\n\r\n    get #positionCSS() {\r\n        const clazz = GSNotificationElement;\r\n        const val = this.position || clazz.DEFAULT;\r\n        return val.indexOf('_') > 0 && clazz[val] ? clazz[val] : val;\r\n    }\r\n\r\n    clear() {\r\n        this.queryAll('gs-toast').forEach(el => el.dismiss());\r\n    }\r\n\r\n    info(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-info', closable, timeout, delay, options);\r\n    }\r\n\r\n    success(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-success', closable, timeout, delay, options);\r\n    }\r\n\r\n    warn(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-warning', closable, timeout, delay, options);\r\n    }\r\n\r\n    danger(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-danger', closable, timeout, delay, options);\r\n    }\r\n\r\n    primary(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-primary', closable, timeout, delay, options);\r\n    }\r\n\r\n    secondary(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-secondary', closable, timeout, delay, options);\r\n    }\r\n\r\n    dark(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-dark', closable, timeout, delay, options);\r\n    }\r\n\r\n    light(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-light', closable, timeout, delay, options);\r\n    }\r\n\r\n    /**\r\n     * Main function to show notification. \r\n     * It has support for Bootstrap based and web based notifications.\r\n     * \r\n     * @async\r\n     * @param {String} title Notification title\r\n     * @param {String} message Notification message\r\n     * @param {String} css CSS styling (web only)\r\n     * @param {Boolean} closable Can user close it (web only)\r\n     * @param {Number} timeout Timeout after which to close notification  (default 2 sec)\r\n     * @param {Number} delay Timeout after which to show notification (default 1 sec)\r\n     * @param {Object} options Options for native Notification\r\n     * @returns {Promise<Notification|GSToast>}\r\n     */\r\n    async display(title = '', message = '', css = '', closable = false, timeout = 2, delay = 0.5, options) {\r\n        if (!message) return;\r\n        const me = this;\r\n        if (me.native) {\r\n            let sts = await GSNotificationElement.requestPermission();\r\n            if (sts) sts = me.#showNative(title, message, timeout, delay, options);\r\n            if (sts) return sts;\r\n        }\r\n        return me.#showWeb(title, message, css, closable, timeout, delay);\r\n    }\r\n\r\n    #showWeb(title, message, css, closable, timeout, delay) {\r\n        const me = this;\r\n        const tpl = `<gs-toast css=\"${css}\"  opened ${closable ? 'closable' : ''} timeout=\"${timeout}\"  delay=\"${delay}\" message=\"${message}\" title=\"${title}\" language=\"${me.language}\" ></gs-toast>`;\r\n        const el = GSDOM.parse(tpl, true);\r\n        requestAnimationFrame(async () => {\r\n            await me.#delay(delay);\r\n            const toast = me.#dialogToast;\r\n            if (toast !== me) GSAttr.set(toast, 'class', `toast-container ${me.css} ${me.position}`);\r\n            toast.appendChild(el);\r\n        });\r\n        return el;\r\n    }\r\n\r\n    async #showNative(title, message, timeout, delay, options = {}) {\r\n        const me = this;\r\n        await me.#delay(delay);\r\n        options.body = options.body || message;\r\n        const notification = new Notification(title, options);\r\n        me.#list.add(notification);\r\n        const callback = me.#clearNative.bind({ notification: notification, owner: me });\r\n        notification.addEventListener('close', callback);\r\n        if (timeout > 0) notification.iid = setTimeout(callback, timeout * 1000);\r\n        return notification;\r\n    }\r\n\r\n    get #dialogToast() {\r\n        const dlg = customElements.get('gs-dialog')?.top;\r\n        return dlg && dlg.isConnected ? (GSDOM.query(dlg, '.toast-container') || this) : this;\r\n    }\r\n\r\n    async #delay(delay = 0) {\r\n        if (GSUtil.isNumber(delay) && delay > 0) await GSUtil.timeout(delay * 1000);\r\n    }\r\n\r\n    #clearNative() {\r\n        const me = this;\r\n        me.notification.close();\r\n        me.owner.#list.delete(me.notification);\r\n        if (me.notification.iid) clearTimeout(me.notification.iid);\r\n    }\r\n\r\n    /**\r\n     * Clear all triggered notifications\r\n     */\r\n    clear() {\r\n        const me = this;\r\n        Array.from(me.querySelectorAll('gs-toast')).forEach(el => el.remove());\r\n        me.#list.forEach(nn => nn.close());\r\n        me.#list.clear();\r\n    }\r\n\r\n    /**\r\n     * Check if native notification is supported\r\n     * @returns {Boolean} \r\n     */\r\n    static get isNativeSupported() {\r\n        return \"Notification\" in self;\r\n    }\r\n\r\n    /**\r\n     * Check if native notification is allowed\r\n     * @returns {Boolean} \r\n     */\r\n    static get isGranted() {\r\n        return Notification.permission === \"granted\";\r\n    }\r\n\r\n    /**\r\n     * Request useage for browser native notification\r\n     * \r\n     * @async\r\n     * @returns {Promise<boolean>} Return granted status\r\n     */\r\n    static async requestPermission() {\r\n        const clazz = GSNotificationElement;\r\n        if (!clazz.isNativeSupported) return false;\r\n        if (!clazz.isGranted) await Notification.requestPermission();\r\n        return clazz.isGranted;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-notification');\r\n    }\r\n}","\r\nimport { classMap, html, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSDOM } from '../../base/GSDOM.mjs';\r\nimport { GSUtil } from '../../base/GSUtil.mjs';\r\nimport { GSNotificationElement } from './Notification.mjs';\r\n\r\nexport class GSToastElement extends GSElement {\r\n\r\n    static properties = {\r\n        closable: { reflect: true, type: Boolean },\r\n        opened: { reflect: true, type: Boolean },\r\n        message: { reflect: true },\r\n        title: { reflect: true },\r\n        delay: { reflect: true, type: Number },\r\n        timeout: { reflect: true, type: Number }\r\n    }\r\n\r\n    #pending = false;\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;\r\n        me.timeout = 2;\r\n        me.delay = 2;\r\n        me.auto = true; \r\n    }\r\n\r\n    shouldUpdate(changedProperties) {\r\n        const me = this;\r\n        const visibilityChange = me.#isVisibilityChanged(changedProperties);\r\n        if (me.delay > 0 && me.opened && visibilityChange) {\r\n            me.#pending = true;\r\n            me.#pendingUpdate();\r\n        }\r\n        return me.#validParent && (!me.#pending);\r\n    }\r\n\r\n    #isVisibilityChanged(changedProperties) {\r\n        return changedProperties.has('opened');\r\n    }\r\n\r\n    async #pendingUpdate() {\r\n        const me = this;\r\n        await GSUtil.timeout(me.delay * 1000);\r\n        me.#pending = false;\r\n        me.requestUpdate();\r\n    }\r\n\r\n    async updated(changedProperties) {\r\n        const me = this;\r\n        const visibilityChange = me.#isVisibilityChanged(changedProperties);\r\n        if (me.timeout > 0 && me.opened) {\r\n            await GSUtil.timeout(me.timeout * 1000);\r\n            me.opened = false;\r\n        } else if (visibilityChange && !me.opened) { \r\n            me.remove();\r\n        };\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return me.title ? me.#renderWithHeader() : me.#renderSimple();\r\n    }\r\n\r\n    #renderWithHeader() {\r\n        const me = this;\r\n        return html`\r\n        <div dir=\"${ifDefined(me.direction)}\"\r\n            class=\"mt-1 mb-1 toast fade ${classMap(me.renderClass())}\">\r\n            <div class=\"toast-header\">\r\n                ${me.translate(me.title)}\r\n                <slot name=\"header\"></slot>\r\n                ${me.closable ? me.#button : ''}\r\n            </div>\r\n            <div class=\"toast-body\">\r\n                ${me.translate(me.message)}\r\n                <slot name=\"body\"></slot>\r\n            </div>\r\n        </div>            \r\n        `;\r\n    }\r\n\r\n    #renderSimple() {\r\n        const me = this;\r\n        return html`\r\n        <div class=\"mt-1 mb-1 toast fade ${classMap(me.renderClass())}\">\r\n          <div class=\"d-flex\">\r\n              <div class=\"toast-body\">\r\n              ${me.translate(me.message)}\r\n              <slot name=\"body\"></slot>\r\n              </div>\r\n              ${me.closable ? me.#button : ''}\r\n          </div>\r\n        </div>            \r\n        `;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            'show': me.opened,\r\n        }\r\n        return css;\r\n    }\r\n\r\n    dismiss() {\r\n        this.opened = false;\r\n    }\r\n\r\n    get #button() {\r\n        const me = this;\r\n        return html`<button type=\"button\" class=\"btn-close me-2 m-auto\" @click=\"${me.dismiss}\"></button>`;\r\n    }\r\n\r\n    get #validParent() {\r\n        const isToast = GSDOM.hasClass(this.parentElement, 'toast-container');\r\n        const isNotify = this.parentElement instanceof GSNotificationElement;\r\n        return isToast || isNotify;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-toast');\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Controller managing data tree navigation.\r\n * Controller is added to every gs-tree-node and \r\n * reacts on Tree node changes to update UI\r\n */\r\nexport class AbstractTreeController {\r\n\r\n    #host;\r\n    #node;\r\n\r\n    constructor(host) {\r\n        const me = this;\r\n        me.#host = host;\r\n        host.addController(me);\r\n    }\r\n    \r\n    hostConnected() {\r\n        const me = this;\r\n        me.#node = me.#host.node;\r\n        me.#addNodeController(me);\r\n    }\r\n\r\n    hostDisconnected() {\r\n        const me = this;\r\n        me.#removeNodeController(me);\r\n        me.#host.removeController(me);\r\n    }\r\n\r\n    // before rendering\r\n    hostUpdate() {\r\n        const me = this;\r\n        const oldNode = me.#node;\r\n        me.#node = me.#host.node;\r\n        if (oldNode != me.#node) {\r\n            me.#removeNodeController(me);\r\n            me.#addNodeController(me);\r\n        }\r\n    }\r\n\r\n    // link Tree node callbacks with controller and component\r\n    #addNodeController(controller) {\r\n        this.#host.node?.addController?.(controller);\r\n    }\r\n\r\n    // unlink Tree node callbacks with controller and component\r\n    #removeNodeController(controller) {\r\n        this.#node?.removeController?.(controller);\r\n    }\r\n\r\n    host(node) {\r\n        return node[Symbol.for('gs-element')] || this.#host;\r\n    }\r\n\r\n    match(node) {\r\n        const host = this.host(node);\r\n        return host?.node === node;\r\n    }\r\n\r\n    get store() {\r\n        return this.#host.dataController?.store;\r\n    }\r\n\r\n    requestUpdate(node) {\r\n        if (this.match(node)) this.host(node).requestUpdate();\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { AbstractTreeController } from './AbstractTreeController.mjs';\r\n\r\n/**\r\n * Controller managing data TreeNode callbacks to reflect UI.\r\n */\r\nexport class TreeController extends AbstractTreeController {\r\n\r\n    constructor(host) {\r\n        super(host);\r\n    }\r\n\r\n    #toggleState(node, state = false) {\r\n        const el = this.host(node);\r\n        if (el) el.loading = state;\r\n    }\r\n\r\n    // Tree controller callbacks\r\n    onLoad(node) {\r\n        this.#toggleState(node, true);\r\n    }\r\n\r\n    onRefresh(node) {\r\n        this.requestUpdate(node);\r\n    }\r\n\r\n    onAppend(node, addedNode) {\r\n        this.#toggleState(node);\r\n        this.requestUpdate(node.root);\r\n    }\r\n\r\n    onInsert(node, insertedNode) {\r\n        this.#toggleState(node);\r\n        this.requestUpdate(node.root);\r\n    }\r\n\r\n    onExpand(node) {\r\n        const store = this.store;\r\n        if (store) {\r\n            store.onExpand(node);\r\n        } else {\r\n            this.requestUpdate(node);\r\n        }\r\n    }\r\n\r\n    onCollapse(node) {\r\n        this.requestUpdate(node);\r\n    }\r\n\r\n    onFocusChanged(node) {\r\n        this.requestUpdate(node);\r\n    }\r\n\r\n    onSelectionChanged(node, selectedNode) {\r\n        this.requestUpdate(node);\r\n    }\r\n\r\n    onRemove(node) {\r\n        if (this.match(node)) this.host(node).remove();\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { html } from '../../lib.mjs';\r\nimport { TreeNode } from '../../data/TreeNode.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSLinklement } from '../Link.mjs';\r\nimport { GSAttributeHandler } from '../../base/GSAttributeHandler.mjs';\r\n\r\nexport class GSTreeItemElement extends GSElement {\r\n\r\n  /*\r\n  static styles = css`            \r\n    :focus-visible {\r\n      outline: none !important;\r\n    }  \r\n    .list-group-item {\r\n      cursor: pointer;\r\n    }`;\r\n    */\r\n\r\n  static properties = {\r\n    loading: { state: true },\r\n    node: { type: Object, hasChanged: (newVal) => newVal instanceof TreeNode }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.flat = true;\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    return this.node ? true : false;\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    if (changed.has('node')) this.node[Symbol.for('gs-element')] = this;\r\n  }\r\n\r\n  updated() {\r\n    if (this.focused) this.query('a')?.focus();\r\n    this.dataset.visible = this.visible;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const node = me.node;\r\n    const opt = me.value || {};\r\n    opt.tooltip = me.translate(opt.tooltip)\r\n    opt.title = me.translate(opt.title)\r\n    const before = me.loading ? me.#renderSpinner(node.level) : me.#renderIcon(node.level);\r\n    return GSLinklement.generate(opt, me.renderClass(), before);\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const opt = {\r\n      'list-group-item': true,\r\n      'list-group-item-action': true,\r\n      'user-select-none  ': true,\r\n      'border-0': me.#border ? false : true,\r\n      'gs-hide': !me.visible\r\n    };\r\n    return me.mapCSS(me.#cssFocus, me.mapCSS(me.#cssSelected, opt, me.selected && !me.multiselect), me.focused);\r\n  }\r\n\r\n  /**\r\n   * Toggle folder\r\n   */\r\n  toggle() {\r\n    this.opened ? this.close() : this.open();\r\n  }\r\n\r\n  /**\r\n   * Open folder\r\n   */\r\n  open() {\r\n    this.#status(true);\r\n    this.focus();\r\n  }\r\n\r\n  /**\r\n   * Close folder\r\n   */\r\n  close() {\r\n    this.#status(false);\r\n  }\r\n\r\n  /**\r\n   * Toggle selection state\r\n   */\r\n  toggleSelection() {\r\n    this.select(!this.selected);\r\n  }\r\n\r\n  focus(val = true) {\r\n    if (val) super.focus();\r\n    this.focused = val == true;\r\n  }\r\n\r\n  select(val = true) {\r\n    this.selected = val == true;\r\n  }\r\n\r\n  handle(e) {\r\n    GSAttributeHandler.process(this.#link, e);\r\n    /*\r\n    const me = this;\r\n    const isIcon = e.target.tagName === 'GS-ICON';\r\n    if (me.multiselect && isIcon) {\r\n      me.toggleSelection();\r\n    } else {\r\n      GSAttributeHandler.process(me.#link, e);\r\n    }\r\n    */\r\n  }\r\n\r\n  get #link() {\r\n    return this.query('a');\r\n  }\r\n\r\n  get isLeaf() {\r\n    return this.node?.isLeaf;\r\n  }\r\n\r\n  get isFolder() {\r\n    return !this.isLeaf;\r\n  }\r\n\r\n  get key() {\r\n    return this.node?.key;\r\n  }\r\n\r\n  get value() {\r\n    return this.node?.value || {};\r\n  }\r\n\r\n  get level() {\r\n    return this.node?.level || -1;\r\n  }\r\n\r\n  get focused() {\r\n    return this.node?.focused;\r\n  }\r\n\r\n  get visible() {\r\n    const parent = this.parent;\r\n    return parent?.opened || parent?.level === -1;\r\n  }\r\n\r\n  get parent() {\r\n    return this.node?.parent;\r\n  }\r\n\r\n  get parentItem() {\r\n    const item = this.parent?.[Symbol.for('gs-element')];\r\n    return item instanceof GSTreeItemElement ? item : undefined;\r\n  }\r\n\r\n  set focused(val) {\r\n    val = val === true;\r\n    this.node.focused = val;\r\n  }\r\n\r\n  get selected() {\r\n    return this.node?.selected;\r\n  }\r\n\r\n  set selected(val) {\r\n    val = val === true;\r\n    const me = this;\r\n    if (me.isFolder && me.owner.leaf) val = false;\r\n\r\n    if (me.multiselect) {\r\n      if (val) {\r\n        me.node.selectAll();\r\n      } else {\r\n        me.node.deselectAll();\r\n      }\r\n    } else {\r\n      me.node.selected = val;\r\n    }\r\n  }\r\n\r\n  get opened() {\r\n    return this.node?.opened;\r\n  }\r\n\r\n  set opened(val) {\r\n    this.#status(val === true);\r\n  }\r\n\r\n  get owner() {\r\n    return this.closest('gs-tree');\r\n  }\r\n\r\n  get multiselect() {\r\n    return this.owner.multiselect;\r\n  }\r\n\r\n  get #cssFocus() { return this.owner.cssFocus || 'focus-ring'; }\r\n  get #cssSelected() { return this.owner.cssSelected || 'active'; }\r\n  get #cssCheck() { return this.owner.cssCheck || ''; }\r\n  get #checkColor() { return this.owner.checkColor || 'secondary'; }\r\n  get #checkColorSelected() { return this.owner.checkColorSelected || 'primary'; }\r\n\r\n  get #border() {\r\n    return this.value?.border === true || this.owner.border === true;\r\n  }\r\n\r\n  get #icon() {\r\n    const me = this;\r\n    const node = me.node;\r\n    const data = me.value;\r\n    const ui = me.owner;\r\n    let itemIco = data.icon || ui.itemIcon;\r\n    if (node.isFolder) itemIco = node.opened ? (data.openIcon || ui.openIcon) : (data.closeIcon || ui.closeIcon);\r\n    return itemIco;\r\n  }\r\n\r\n  #renderIndent(level) {\r\n    return html`<gs-indent size=\"${level}\"></gs-indent>`;\r\n  }\r\n\r\n  #renderSpinner(level) {\r\n    return html`${this.#renderIndent(level)}<gs-spinner small></gs-spinner>`;\r\n  }\r\n\r\n  #renderIcon(level) {\r\n    return html`${this.#renderIndent(level)}${this.#renderMulti()}<gs-icon size=\"5\" name=\"${this.#icon}\"></gs-icon>`;\r\n  }\r\n\r\n  #renderMulti() {\r\n    const me = this;\r\n    if (!me.multiselect) return '';\r\n    const color = me.selected ? me.#checkColorSelected : me.#checkColor;\r\n    const icon = me.node.isPartialySelected ? 'dash-square-fill' : me.selected ? 'check-square-fill' : 'square';\r\n    return html`<gs-icon size=\"6\" data-type=\"state\" \r\n                css=\"me-1 text-${color} ${me.#cssCheck}\"\r\n                name=\"${icon}\"></gs-icon>`;\r\n  }\r\n\r\n  #status(val = false) {\r\n    const me = this;\r\n    if (me.node?.isFolder) {\r\n      me.node.opened = val;\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-tree-item');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, css, createRef, ref, repeat, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSDOM } from '../../base/GSDOM.mjs';\r\nimport { TreeNode } from '../../data/TreeNode.mjs';\r\nimport { TreeController } from './controllers/TreeController.mjs';\r\nimport { color } from '../../properties/color.mjs';\r\n\r\nexport class GSTreeElement extends GSElement {\r\n\r\n  static styles = css`            \r\n    :focus-visible {\r\n      outline: none !important;\r\n    }  \r\n    .list-group-item {\r\n      cursor: pointer;\r\n    }`;\r\n\r\n  static shared = {\r\n    itemIcon: { attribute: 'icon-item' },\r\n    closeIcon: { attribute: 'icon-close' },\r\n    openIcon: { attribute: 'icon-open' },\r\n    cssCheck: { attribute: 'css-check' },\r\n    cssFocus: { attribute: 'css-focus' },\r\n    cssSelected: { attribute: 'css-selected' },\r\n    checkColor: { attribute: 'check-color', ...color },\r\n    checkColorSelected: { attribute: 'check-color-selected', ...color },\r\n  }\r\n\r\n  static properties = {\r\n    storage: {},\r\n    data: { type: Object },\r\n    node: { type: Object, hasChanged: (newVal) => newVal instanceof TreeNode },\r\n    border: { type: Boolean, reflect: true },\r\n    guide: { type: Boolean, reflect: true },\r\n    leaf: { type: Boolean, reflect: true },\r\n    multiselect: { type: Boolean, reflect: true },\r\n    circular: { type: Boolean, reflect: true },\r\n    ...GSTreeElement.shared\r\n  }\r\n\r\n  // GS-ITEM attributes mapping\r\n  static options = {\r\n    ...GSTreeElement.shared,\r\n    css: {},\r\n    icon: {},\r\n    color: {},\r\n    title: {},\r\n    tooltip: {},\r\n    opened: { type: Boolean },\r\n    selected: { type: Boolean }\r\n  }\r\n\r\n  #queued = false;\r\n  #listRef = createRef();\r\n\r\n  #controller = null;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.leaf = false;\r\n    me.multiselect = false;\r\n    me.data = GSDOM.toJson(me, true, true).items;\r\n    me.node = new TreeNode(null, { '#tagName': this.tagName }, null, -1);\r\n    me.itemIcon = 'file-earmark';\r\n    me.closeIcon = 'folder'; // caret-right; chevron-right\r\n    me.openIcon = 'folder2-open'; // caret-down; chevron-down\r\n    me.cssSelected = 'active'; // fw-bold\r\n    me.cssFocus = 'focus-ring';\r\n    me.node[Symbol.for('gs-element')] = me;\r\n    me.#controller = new TreeController(me);\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\"\r\n          class=\"treeview ${classMap(me.renderClass())}\"          \r\n          @click=\"${me.#onClick}\"\r\n          @keydown=\"${me.#onKeyDown}\"\r\n          @keyup=\"${me.#onKeyUp}\">\r\n          <div class=\"list-group\" ${ref(me.#listRef)}>\r\n          ${repeat(me.node.walk(me.node, false, false), (node) => node.key, (node) => html`\r\n            <gs-tree-item .node=\"${node}\"></gs-tree-item>\r\n          `)}\r\n          </div>    \r\n        </div>`;\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    const me = this;\r\n    if (changed.has('data') && me.data && !me.#queued) {\r\n      me.#queued = true;\r\n      queueMicrotask(() => {\r\n        me.node.clear();\r\n        me.node.fromJSON(me.data);\r\n        me.#queued = false;\r\n        me.requestUpdate();\r\n      });\r\n    }\r\n    return this.node ? true : false;\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    if (changed.has('multiselect') && !this.multiselect) this.node?.deselectAll();\r\n    this.node.multi = this.multiselect;\r\n  }\r\n\r\n  onDataRead(data) {\r\n    if (data instanceof TreeNode) {\r\n      if (data.root !== this.node) this.node = data;\r\n    } else {\r\n      this.data = data;\r\n    }\r\n  }\r\n\r\n  next(expand = false) {\r\n    const me = this;\r\n    let item = me.nextItem;\r\n    if (!item & me.circular) item = me.#first;\r\n    if (item?.visible) {\r\n      item.focus();\r\n      if (expand && me.focused?.isFolder) me.focused.open();\r\n    }\r\n    return me.focused;\r\n  }\r\n\r\n  previous(collapse = false) {\r\n    const me = this;\r\n    let item = me.previousItem;\r\n    if (!item & me.circular) item = me.#last;\r\n    if (item?.visible) {\r\n      item.focus();\r\n      if (item.isFolder && collapse) item.close();\r\n    }\r\n    return me.focused;\r\n\r\n  }\r\n\r\n  expandAll() {\r\n    this.node?.expandAll();\r\n  }\r\n\r\n  collapseAll() {\r\n    this.node?.collapseAll();\r\n  }\r\n\r\n  /**\r\n   * Open folder\r\n   */\r\n  open(path) {\r\n    const me = this;\r\n    me.focused?.open();\r\n  }\r\n\r\n  /**\r\n   * Close folder\r\n   * TODO - path navigation\r\n   */\r\n  close(path) {\r\n    const me = this;\r\n    me.focused?.close();\r\n  }\r\n\r\n  clear() {\r\n    this.node?.clear();\r\n    this.requestUpdate();\r\n  }\r\n\r\n  reload() {\r\n    this.clear();\r\n    this.dataController?.read();\r\n  }\r\n\r\n  get selected() {\r\n    return this.#host(this.node.selectedNodes());\r\n  }\r\n\r\n  get focused() {\r\n    return this.#host(this.node.focusedNode());\r\n  }\r\n\r\n  /**\r\n   * Previous visible ge-node-item\r\n   */\r\n  get previousItem() {\r\n    return this.focused?.node.find(n => n?.visible, true, true)?.[Symbol.for('gs-element')];\r\n  }\r\n\r\n  /**\r\n   * Next visible ge-node-item\r\n   */\r\n  get nextItem() {\r\n    return this.focused?.node.find(n => n?.visible, true)?.[Symbol.for('gs-element')];\r\n  }\r\n\r\n  get #list() {\r\n    return this.#listRef.value;\r\n  }\r\n\r\n  get #first() {\r\n    return this.#list.firstElementChild;\r\n  }\r\n\r\n  get #last() {\r\n    return this.#list.lastElementChild;\r\n  }\r\n\r\n  #host(node) {\r\n    if (Array.isArray(node)) {\r\n      return node.map(n =>n[Symbol.for('gs-element')]).filter( n=> n);\r\n    }\r\n    return node?.[Symbol.for('gs-element')];\r\n  }\r\n\r\n  #onClick(e) {\r\n    const icon = e.target.tagName === 'GS-ICON' ? e.target : e.target.closest('gs-icon');\r\n    const isIcon = icon?.dataset.type === 'state';\r\n    const el = e.target.closest('gs-tree-item');\r\n    if (!el.node) return;\r\n\r\n    const me = this;\r\n\r\n    if (me.multiselect) {\r\n      if (isIcon) el.toggleSelection();\r\n    } else {\r\n      el.select(true);\r\n    }\r\n\r\n    const expandable = (me.multiselect && !isIcon) || (!me.multiselect);\r\n    if (el.isFolder && expandable) el.toggle();\r\n\r\n    el.focus();\r\n    el.handle(e);\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n\r\n    const me = this;\r\n    const el = me.focused;\r\n    if (!el) return;\r\n\r\n    switch (e.code) {\r\n      case 'ArrowUp':\r\n        me.previous();\r\n        break;\r\n      case 'ArrowDown':\r\n        me.next();\r\n        break;\r\n      case 'ArrowLeft':\r\n        if (el.isFolder) {\r\n          if (el.opened) {\r\n            me.close();\r\n          } else {\r\n            (el.parentItem || el)?.focus();\r\n          }\r\n        } else {\r\n          me.previous();\r\n        }\r\n        break;\r\n      case 'ArrowRight':\r\n        if (el.isFolder && !el.opened) {\r\n          me.open();\r\n        } else {\r\n          me.next();\r\n        }\r\n        break;\r\n      case 'Enter':\r\n          if (el.isFolder) {\r\n            el.toggle();\r\n          }        \r\n    }\r\n  }\r\n\r\n  #onKeyUp(e) {\r\n\r\n    const el = e.target.closest('gs-tree-item');\r\n    if (!(el?.node)) return;\r\n\r\n    switch (e.code) {\r\n      case 'Enter':\r\n        el.handle(e);\r\n        break;\r\n      case 'Tab':\r\n        el.focus();\r\n        break;\r\n      case 'Space':\r\n        el.select(this.multiselect ? !el.selected : true);\r\n        el.focus();\r\n        break;\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-tree');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading ServiceWorkkerElement class\r\n * @module components/ServiceWorkkerElement\r\n */\r\n\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\n/**\r\n * An easy way to register a service worker in the browser.\r\n * @class\r\n * @extends { GSlement }\r\n */\r\nexport class ServiceWorkkerElement extends GSElement {\r\n\r\n    static properties = {\r\n        src: {},\r\n        scope: {},\r\n        module: { type: Boolean, default: false },\r\n        trace: { type: Boolean, reflect: true, default: false },\r\n        disabled: { type: Boolean, reflect: true, default: false }\r\n    }\r\n\r\n    #registration = false\r\n    #workerMessage = null;\r\n    #messageChannel = null;\r\n\r\n    #nocache = false;\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        const me = this;\r\n        me.#workerMessage = me.#onWorkerMessage.bind(me);\r\n        me.#load();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        super.disconnectedCallback();\r\n        this.#unload();\r\n    }\r\n\r\n    willUpdate(changed) {\r\n        const me = this;\r\n        if (changed.has('trace')) {\r\n            me.#ServiceWorkerTraceUpdate();\r\n        }\r\n        if (changed.has('disabled')) {\r\n            me.disabled ? me.#unload() : me.#load();\r\n        }\r\n        super.willUpdate(changed);\r\n    }\r\n\r\n    /**\r\n     * Returns true if the service worker is available in the browser and the src is a valid URL.\r\n     */\r\n    get available() {\r\n        const me = this;\r\n        return 'serviceWorker' in navigator && me.src && GSUtil.isURL(me.src);\r\n    }\r\n\r\n    /**\r\n     * Returns the service worker registration object.\r\n     */\r\n    get registration() {\r\n        return this.#registration;\r\n    }\r\n\r\n    /**\r\n     * Request the service worker to clear its cache.\r\n     * @returns \r\n     */\r\n    clearCache() {\r\n        return this.postMessage(\"CLEAR_CACHE\");\r\n    }\r\n\r\n    /**\r\n     * Send a message to the service worker.\r\n     * @param {*} message The message to send to the service worker.\r\n     * @returns {boolean} Returns true if the message was sent, false if the service worker is not active or not registered.\r\n     */\r\n    postMessage(message) {\r\n        const me = this;\r\n        const sts = GSUtil.nonNull(message) && me.isLoaded;\r\n        if (sts) {\r\n            if (me.#messageChannel) {\r\n                me.#messageChannel.port1.postMessage(message);\r\n            } else {\r\n                me.#registration?.active?.postMessage(message);\r\n            }\r\n        }\r\n        return sts;\r\n    }\r\n\r\n    /**\r\n     * Method to handle messages from the service worker.\r\n     * Override this method to handle messages from the service worker.\r\n     * The default implementation does nothing.\r\n     * @param {Event} event \r\n     * @returns {boolean} Return false to stop the event propagation, true to continue.\r\n     */\r\n    onMessage(event) {\r\n        me.#trace('ServiceWorker message received:', event);\r\n        return true;\r\n    }\r\n\r\n    #onWorkerMessage = (event) => {\r\n        const me = this;\r\n        if (event.data) {\r\n            if (me.onMessage(event)) {\r\n                me.emit('message', event.data, true, true, true);\r\n            }\r\n        } else {\r\n            me.#trace('ServiceWorker message is empty:', event);\r\n        }\r\n    }\r\n\r\n    #initChannel() {\r\n        const me = this;\r\n        if (me.#registration?.active) {\r\n            me.#messageChannel = new MessageChannel();\r\n            me.#messageChannel.port1.onmessage = me.#workerMessage;\r\n            me.#ServiceWorkerTraceUpdate();\r\n            me.#registration.active.postMessage('INIT_PORT', [me.#messageChannel.port2]);\r\n            //me.emit('activated', isActive, true, true, true);\r\n        }\r\n    }\r\n\r\n    #ServiceWorkerTraceUpdate() {\r\n        const me = this;\r\n        me.#registration?.active?.postMessage(me.trace ? 'TRACE_ON' : 'TRACE_OFF');\r\n    }\r\n\r\n    // Show a notification to the user that a new version of the app is available\r\n    async #invokeServiceWorkerUpdateFlow(registration) {\r\n        return registration?.waiting?.postMessage('NOTIFICATION_WAITING');\r\n    }\r\n\r\n    // detect Service Worker update available and wait for it to become installed\r\n    #monitorServiceWorkerUpdate(registration) {\r\n        const me = this;\r\n        registration.addEventListener('updatefound', () => {\r\n            // wait until the new Service worker is actually installed (ready to take over)\r\n            registration.installing?.addEventListener('statechange', () => {\r\n                if (registration.waiting) {\r\n                    // if there's an existing controller (previous Service Worker), show the prompt\r\n                    if (navigator.serviceWorker.controller) {\r\n                        me.#invokeServiceWorkerUpdateFlow(registration);\r\n                    } else {\r\n                        // otherwise it's the first install, nothing to do\r\n                        me.#trace('Service Worker initialized for the first time');\r\n                    }\r\n                }\r\n            });\r\n        })\r\n    }\r\n\r\n    // detect controller change and refresh the page\r\n    #monitorController() {\r\n        let refreshing = false;\r\n        navigator.serviceWorker.addEventListener('controllerchange', () => {\r\n            if (!refreshing) {\r\n                window.location.reload();\r\n                refreshing = true;\r\n            }\r\n        });\r\n    }\r\n\r\n    async #unload() {\r\n        const me = this;\r\n        GSLoader.NO_CACHE = me.#nocache;\r\n        if (me.disabled) {\r\n            await me.#registration?.unregister();\r\n        }\r\n        me.#messageChannel?.port1.close();\r\n        me.#messageChannel?.port2.close();\r\n        me.#messageChannel = null;\r\n        me.#registration = null;\r\n    }\r\n\r\n    // Load the service worker\r\n    async #load() {\r\n        const me = this;\r\n        if (me.disabled) return;\r\n        me.#nocache = GSLoader.NO_CACHE;\r\n        GSLoader.NO_CACHE = false;\r\n\r\n        if (!me.available) {\r\n            console.warn('Service Worker is not available in this browser or src is not valid.');\r\n            return;\r\n        }        \r\n        try {\r\n            const opt = me.scope ? { scope: me.scope } : {};\r\n            if (me.module) opt.type = 'module';\r\n            me.#registration = await navigator.serviceWorker.register(me.src, opt);\r\n            me.#trace('ServiceWorker registration started:', me.#registration);\r\n\r\n            me.#monitorController();\r\n            me.#invokeServiceWorkerUpdateFlow(me.#registration);\r\n            me.#monitorServiceWorkerUpdate(me.#registration);\r\n            me.#initChannel(me.#registration);\r\n\r\n            me.#trace('ServiceWorker registration successful with scope: ', me.#registration.scope);\r\n\r\n        } catch (error) {\r\n            me.#registration = false;\r\n            console.error('Service Worker registration failed:', error);\r\n        }\r\n        me.emit('loaded', me.isLoaded, true, true, true);\r\n    }\r\n\r\n    #trace(message, data = '') {\r\n        if (this.trace) {\r\n            console.log(message, data);\r\n        }\r\n    }\r\n\r\n    static {\r\n        this.define('gs-service-worker');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, html, ifDefined, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSLog } from '../base/GSLog.mjs';\r\n\r\nexport class GSChartElement extends GSElement {\r\n\r\n    static get URL_LIB() {\r\n        return globalThis.GS_URL_CHART || globalThis.location?.origin || '/bootstrap-lit';\r\n    }\r\n\r\n    static properties = {\r\n        url: {},\r\n        config: {},\r\n        storage: {},\r\n        height: { type: Number },\r\n        width: { type: Number },\r\n        data: { type: Array },\r\n        options: { type: Object },\r\n    }\r\n\r\n    #canvasRef = createRef();\r\n    #chart = null;\r\n\r\n    constructor() {\r\n        super();\r\n        this.height = 0;\r\n        this.width = 0;\r\n        GSChartElement.#init();\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        this.#waitInit();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        super.disconnectedCallback();\r\n        const me = this;\r\n        if (me.#chart) me.#chart.destroy();\r\n        me.#chart = null;\r\n    }\r\n\r\n    shouldUpdate(changed) {\r\n        return GSChartElement.#isChart;\r\n    }\r\n\r\n    firstUpdated(changed) {\r\n        this.#render();\r\n        super.firstUpdated(changed);\r\n    }\r\n\r\n    updated(changed) {\r\n        const me = this;\r\n        if (changed.has('url') || changed.has('config')) me.#render();\r\n        if (changed.has('data') || changed.has('options')) me.#renderData(me.data, me.options);\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<canvas ${ref(me.#canvasRef)} \r\n                class=\"${classMap(me.renderClass())}\"\r\n                width=\"${ifDefined(me.width > 0 ? me.width : false)}\" \r\n                height=\"${ifDefined(me.height > 0 ? me.height : false)}\" >\r\n            </canvas>`;\r\n    }\r\n\r\n    onDataRead(data) {\r\n        this.data = data;\r\n    }\r\n\r\n    get canvas() {\r\n        return this.#canvasRef.value;\r\n    }\r\n\r\n    // https://www.chartjs.org/docs/latest/developers/api.html\r\n\r\n    reset() {\r\n        this.#chart?.reset();\r\n    }\r\n\r\n    refresh() {\r\n        this.#chart?.render();\r\n    }\r\n\r\n    updateChart(val) {\r\n        this.#chart?.update(val);\r\n    }\r\n\r\n    stop() {\r\n        this.#chart?.stop();\r\n    }\r\n\r\n    clear() {\r\n        this.#chart?.clear();\r\n    }\r\n\r\n    resize(x, y) {\r\n        const me = this;\r\n        if (!me.#chart) return;\r\n        requestAnimationFrame(() => {\r\n            const div = me.query('div');\r\n            if (div) {\r\n                div.style.width = `${x}px`;\r\n                div.style.height = `${y}px`;\r\n            }\r\n            me.#chart.resize(x, y);\r\n        });\r\n    }\r\n\r\n    toBase64Image(type = \"image/png\", quality = 1) {\r\n        return this.#chart?.toBase64Image(type, quality);\r\n    }\r\n\r\n    // internal functions to render JSON from gs-items elements\r\n\r\n    async #render() {\r\n        const me = this;\r\n        try {\r\n            const options = await GSLoader.loadSafe(me.config, 'GET', null, true, {});\r\n            const data = await GSLoader.loadSafe(me.url, 'GET', null, true, []);\r\n            me.data = data;\r\n            me.options = options;\r\n        } catch (error) {\r\n            GSLog.error(null, error);\r\n        }\r\n    }\r\n\r\n    #renderData(data, options) {\r\n        const me = this;\r\n        const el = me.querySelector('gs-item[group=\"options\"]');\r\n        const opt = Object.assign(options, GSChartElement.toJson(el));\r\n\r\n        const sets = opt.data.datasets;\r\n        sets.forEach((o, i) => o.data = sets.length === 1 ? data : data[i] || []);\r\n\r\n        if (me.#chart) return me.updateChart(opt);\r\n\r\n        const ctx = me.canvas?.getContext('2d');\r\n        if (ctx) {\r\n            me.#chart = new GSChartElement.#Chart(ctx, opt);\r\n        } else {\r\n            GSLog.error(null, 'Failed to get canvas context');\r\n        }\r\n    }\r\n\r\n    async #waitInit() {\r\n        if (!GSChartElement.#isChart) await GSEvents.wait(document, 'gs-chart', 0, false);\r\n        this.requestUpdate();\r\n    }\r\n\r\n    static #isChart = false;\r\n    static #initializing = false;\r\n    static #Chart = null;\r\n\r\n    static async #init() {\r\n        const me = GSChartElement;\r\n        if (me.URL_LIB === false) return;\r\n        if (me.#isChart || me.#initializing) return;\r\n        me.#initializing = true;\r\n        try {\r\n            const origin = GSChartElement.URL_LIB;\r\n            const url = `${origin}/assets/chart/chart.mjs`;\r\n            const { Chart, registerables } = await import(url);\r\n            Chart.register(...registerables);\r\n            me.#Chart = Chart;\r\n            me.#isChart = true;\r\n            GSEvents.send(document, 'gs-chart');\r\n        } catch (e) {\r\n            GSLog.error(null, e);\r\n        } finally {\r\n            me.#initializing = false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Convert DOM tree into a JSON structure\r\n     * \r\n     * @param {HTMLElement} obj HTML element instance to convert\r\n     * @param {string} name DOM attribute name for object key\r\n     * @param {string} value DOM attribute name for object value\r\n     * @param {string} type DOM attribute name for object type\r\n     * @returns {object}\r\n     */\r\n    static toJson(el, name = 'name', value = 'value', type = 'type') {\r\n\r\n\r\n        if (!(el instanceof HTMLElement)) return {};\r\n\r\n        const nameV = el.getAttribute(name);\r\n        const valV = el.getAttribute(value);\r\n        const typeV = el.getAttribute(type);\r\n\r\n        let obj = null;\r\n\r\n        switch (typeV) {\r\n            case 'array':\r\n                obj = [];\r\n                break;\r\n            case 'object':\r\n                obj = {};\r\n                break;\r\n            default:\r\n                return GSChartElement.#toType(valV, typeV);\r\n        }\r\n\r\n        const childs = Array.from(el.children);\r\n        const isArray = typeV === 'array';\r\n        const isObject = typeV === 'object';\r\n\r\n        childs.forEach(el => {\r\n            const _nam = el.getAttribute(name);\r\n            if (isArray) {\r\n                obj.push(GSChart.toJson(el, name, value, type));\r\n            } else if (isObject) {\r\n                const tmp = GSChartElement.toJson(el, name, value, type);\r\n                obj[_nam] = tmp;\r\n            } else {\r\n                const _val = el.getAttribute(value);\r\n                const _typ = el.getAttribute(type);\r\n                obj[nameV][_nam] = GSChart.#toType(_val, _typ);\r\n            }\r\n        });\r\n\r\n        return obj;\r\n    }\r\n\r\n    static #toType(val, type) {\r\n        switch (type) {\r\n            case 'boolean': return val === 'true';\r\n            case 'number': return parseFloat(val);\r\n            default: return val\r\n        }\r\n    }\r\n\r\n    static {\r\n        this.define('gs-chart');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, ref, classMap, html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\nexport class GSHighlightElement extends GSElement {\r\n\r\n    static get URL_LIB() {\r\n        return globalThis.GS_URL_HLJS || 'https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0';\r\n    }\r\n\r\n    static properties = {\r\n        url: {},\r\n        theme: {},\r\n        target: {},\r\n        language: {},\r\n    }\r\n\r\n    #codeRef = createRef();\r\n    #data;\r\n\r\n    constructor() {\r\n        super();\r\n        this.theme = 'default';\r\n    }\r\n\r\n    willUpdate(changed) {\r\n        const me = this;\r\n        if (changed.has('theme')) me.#onTheme();\r\n        if (changed.has('target')) me.#onTarget();\r\n        if (changed.has('url')) me.#onURL();\r\n        if (changed.has('language')) me.#onHighlight(me.#data);\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<pre><code ${ref(me.#codeRef)} class=\"${classMap(me.renderClass())}\"><code/><pre/>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const hasLangauge = GSUtil.isStringNonEmpty(me.language);\r\n        const css = {\r\n            [`language-${me.language}`]: hasLangauge\r\n        }\r\n        return css;\r\n    }\r\n\r\n    /**\r\n     * Highligh some code in programmatic way\r\n     * \r\n     * @param {string} data \r\n     */\r\n    highlight(data = '', append = false) {\r\n        this.#data = data;\r\n        this.#onHighlight(data, append);\r\n    }\r\n\r\n    set content(val ='') {\r\n        this.#data = val;\r\n        this.#onHighlight(val);\r\n    }\r\n\r\n    get content() {\r\n        return this.#data;\r\n    }\r\n\r\n    async #onTheme() {\r\n        const url = `${GSHighlightElement.URL_LIB}/styles/${this.theme}.min.css`;\r\n        GSDOM.injectCSS(this, url);\r\n    }\r\n\r\n    /**\r\n     * Search with CSS query for element, if found, \r\n     * get innerHTML, and send to highlighting\r\n     */\r\n    #onTarget() {\r\n        const me = this;\r\n        const el = me.target ? GSDOM.query(me.target) : null;\r\n        if (!el) return GSDOM.setHTML(me.#code, `Element with id ${me.target} not found!`);\r\n        me.#data = el.innerHTML;\r\n        me.#onHighlight(el.innerHTML);\r\n    }\r\n\r\n    /**\r\n     * Download source from URL, then send to highlighting\r\n     */\r\n    async #onURL() {\r\n        const me = this;\r\n        try {\r\n            const data = await GSLoader.load(me.url);\r\n            if (!data) throw new Error(`Code URL ${me.url} unreachable!`);\r\n            me.#data = data;\r\n            me.#onHighlight(data);\r\n        } catch (error) {\r\n            GSDOM.setHTML(me.#code, error.message);\r\n        }\r\n    }\r\n\r\n    get #code() {\r\n        return this.#codeRef.value;\r\n    }\r\n\r\n    #onMessage(e) {\r\n        const me = this;\r\n        const content = e.data.data;\r\n        URL.revokeObjectURL(e.data.url);\r\n        GSDOM.setHTML(me.#code, e.data.append ? me.#code.innerHTML + content : content);\r\n        e.target.terminate();\r\n    }\r\n\r\n    #onHighlight(data = '', append = false) {\r\n        const me = this;\r\n        if (!data) return GSDOM.setHTML(me.#code, 'No data!');\r\n        try {\r\n            const response = me.#worker;\r\n            const blob = new Blob([response], { type: 'application/javascript' });\r\n            const blobURL = URL.createObjectURL(blob);\r\n            const worker = new Worker(blobURL);\r\n            worker.onmessage = me.#onMessage.bind(me);\r\n            worker.postMessage({ data: data, url: blobURL, append: append });\r\n        } catch (error) {\r\n            GSDOM.setHTML(me.#code, error.message);\r\n        }\r\n    }\r\n\r\n    get #worker() {\r\n        const me = this;\r\n        const langs = me.language ? me.language.split(',').map(v => `importScripts('${GSHighlightElement.URL_LIB}/languages/${v.trim()}.min.js');`).join('') : '';\r\n        return `globalThis.onmessage = (event) => {\r\n                importScripts('${GSHighlightElement.URL_LIB}/highlight.min.js');\r\n                ${langs}\r\n                const result = globalThis.hljs.highlightAuto(event.data.data);\r\n                postMessage({data:result.value, url:event.data.url, append: event.data.append});};`\r\n    }\r\n\r\n    static {\r\n        this.define('gs-highlight');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, html, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\nexport class GSMarkdownElement extends GSElement {\r\n\r\n    static get URL_LIB() {\r\n        return globalThis.GS_URL_MARKDOWN || 'https://unpkg.com/showdown/dist/showdown.min.js';\r\n    }\r\n\r\n    static properties = {\r\n        url: {},\r\n        history: { type: Number },\r\n        maxHeight: { type: Number, attribute: 'max-height' },\r\n    }\r\n\r\n    #containerRef = createRef();\r\n    #converter = null;\r\n    #last = null;\r\n    #first = null;\r\n    #root = null;\r\n    #path = null;\r\n    #cache = [];\r\n\r\n    #styleID = GSID.id;\r\n\r\n    constructor() {\r\n        super();\r\n        this.history = 10;\r\n        this.dynamicStyle(this.#styleID);\r\n    }\r\n\r\n    async connectedCallback() {\r\n        const me = this;\r\n        await me.#initLib();\r\n        if (globalThis.showdown) {\r\n            const opt = { tasklists: true, tables: true };\r\n            me.#converter = new globalThis.showdown.Converter(opt);\r\n            super.connectedCallback();\r\n        }\r\n    }\r\n\r\n    willUpdate(changed) {\r\n        const me = this;\r\n        if (changed.has('url')) {\r\n            me.#toCache(me.url);\r\n            me.#onURL(me.url);\r\n        }\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        const height = me.maxHeight > 0 ? `${me.maxHeight}px;` : false;\r\n        const opt = { 'max-height': height }\r\n        me.dynamicStyle(me.#styleID, opt);\r\n        return html`<div ${ref(me.#containerRef)} class=\"overflow-auto ${classMap(me.renderClass())}\"><div/>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const hasLangauge = GSUtil.isStringNonEmpty(me.language);\r\n        const css = {\r\n            [me.#styleID] : true,\r\n            [`language-${me.language}`]: hasLangauge\r\n        }\r\n        return css;\r\n    }\r\n\r\n    back() {\r\n        const me = this;\r\n        const url = me.#fromCache();\r\n        me.#onURL(url);\r\n    }\r\n\r\n    get root() {\r\n        return this.#root || '';\r\n    }\r\n\r\n    /**\r\n     * Return injection point for rendered markdown\r\n     */\r\n    get #container() {\r\n        return this.#containerRef.value;\r\n    }\r\n\r\n    /**\r\n     * Download source from URL, then send to rendering\r\n     */\r\n    async #onURL(url = '') {\r\n        const me = this;\r\n\r\n        url = me.#normalize(url);\r\n        if (!url) return;\r\n\r\n        let data = await GSLoader.load(url);\r\n        if (!data) return;\r\n\r\n        me.#path = me.#parent(url);\r\n        if (!me.#root) me.#root = me.#path;\r\n\r\n        // MD library error fix\r\n        data = data.replace(/^[-_\\*]{3}$/gm, '<hr>');\r\n\r\n        me.#container.innerHTML = me.#makeHtml(data);\r\n\r\n        GSEvents.send(me, 'data', url);\r\n        requestAnimationFrame(() => {\r\n            me.#handleLinks();\r\n            me.#handleTables();\r\n            me.#handleCode();\r\n        });\r\n    }\r\n\r\n    #normalize(url = '') {\r\n        const me = this;\r\n        if (!url || url.startsWith('http')) return url;\r\n        return me.#path ? new URL(url, me.#path).toString() :\r\n            GSLoader.normalizeURL(url, true);\r\n    }\r\n\r\n    #parent(url = '') {\r\n        return url.endsWith('/') ? url : GSLoader.parentPath(url);\r\n    }\r\n\r\n    #handleCode() {\r\n        this.#handleStyles('pre:has(code)', 'text-white bg-dark p-1');\r\n    }\r\n\r\n    #handleTables() {\r\n        const me = this;\r\n        const clss = \"table table-light table-hover table-striped table-bordered w-auto shadow-sm\";\r\n        me.#handleStyles('table', clss);\r\n    }\r\n\r\n    #handleStyles(qry, css) {\r\n        const me = this;\r\n        const list = GSDOM.queryAll(me.#container, qry);\r\n        requestAnimationFrame(() => list.forEach(el => GSDOM.toggleClass(el, css)) );\r\n    }\r\n\r\n    #handleLinks() {\r\n        const me = this;\r\n        const links = GSDOM.queryAll(me.#container, 'a').filter(el => !GSAttr.get(el, 'href').startsWith('#'));\r\n\r\n        links\r\n            .filter(el => !(GSAttr.get(el, 'href').endsWith('.md') || GSAttr.get(el, 'href').endsWith('/')))\r\n            .forEach(el => el.target = \"_blank\");\r\n\r\n        links\r\n            .filter(el => GSAttr.get(el, 'href').endsWith('.md') || GSAttr.get(el, 'href').endsWith('/'))\r\n            .forEach(el => GSEvents.attach(el, el, 'click', me.#onLinkClick.bind(me)));\r\n\r\n    }\r\n\r\n    #onLinkClick(e) {\r\n        const me = this;\r\n        const el = e.target;\r\n        const href = GSAttr.get(el, 'href');\r\n        if (href.startsWith('#')) return;\r\n        GSEvents.prevent(e);\r\n        el.href = me.#normalize(href);\r\n\r\n        const success = GSEvents.send(me, 'link', el.href, false, false, true);\r\n        if (!success) return;\r\n\r\n        me.#toCache(el.href);\r\n        me.#onURL(el.href);\r\n        return false;\r\n    }\r\n\r\n    #fromCache() {\r\n        const me = this;\r\n        if (me.#cache.length === 0 ) return me.#first;\r\n        const url = me.#cache.pop();\r\n        return url && url === me.#last ? me.#fromCache() : url;\r\n    }\r\n\r\n    #toCache(url) {\r\n        const me = this;\r\n        if (me.#cache.length >= me.history) me.#cache = me.#cache.slice(1);\r\n        if (me.#last == url) return;\r\n        me.#cache.push(url);\r\n        me.#last = url;\r\n        if (!me.#first) me.#first = url;\r\n    }\r\n\r\n    #makeHtml(data) {\r\n        return this.#converter.makeHtml(data);\r\n    }\r\n\r\n    async #initLib() {\r\n        const me = this;\r\n        if (globalThis.showdown) return;\r\n        const script = document.createElement('script');\r\n        const promise = GSEvents.wait(script, 'load', 0, false);\r\n        script.type = \"text/javascript\";\r\n        script.src = GSMarkdownElement.URL_LIB;\r\n        GSDOM.appendChild(document.head, script);\r\n        await promise;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-markdown');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, html, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\n\r\nexport class GSMonacoElement extends GSElement {\r\n\r\n    static get URL_LIB() {\r\n        return globalThis.GS_URL_MONACO || 'https://unpkg.com/monaco-editor@latest/min/';\r\n    }\r\n\r\n    static properties = {\r\n        url: {},\r\n        theme: {},\r\n        target: {},\r\n        language: {},\r\n    }\r\n\r\n    #containerRef = createRef();\r\n    #editor = null;\r\n\r\n    constructor() {\r\n        super();\r\n        this.language = '';\r\n        this.theme = 'vs-dark';\r\n    }\r\n\r\n    async connectedCallback() {\r\n        await GSMonacoElement.#init();\r\n        super.connectedCallback();\r\n    }\r\n\r\n    createRenderRoot() {\r\n        return this;\r\n    }\r\n\r\n    firstUpdated() {\r\n        this.#onMonacoReady();\r\n        super.firstUpdated();\r\n    }\r\n\r\n    willUpdate(changed) {\r\n        const me = this;\r\n        if (!me.#editor) return;\r\n        if (changed.has('theme')) me.#onTheme(me.theme);\r\n        if (changed.has('target')) me.#onTarget(me.target);\r\n        if (changed.has('url')) me.#onURL(me.url);\r\n        if (changed.has('language')) me.#onLanguage(me.language);\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div ${ref(me.#containerRef)} class=\"${classMap(me.renderClass())}\"><div/>`;\r\n    }\r\n\r\n    get monaco() {\r\n        return window.monaco;\r\n    }\r\n\r\n    get editor() {\r\n        return this.#editor;\r\n    }\r\n\r\n    get model() {\r\n        return this.#editor.getModel();\r\n    }\r\n\r\n    /**\r\n     * Get editor code \r\n     * \r\n     * @param {string} data \r\n     */\r\n    get code() {\r\n        return this.#editor?.getValue() || '';\r\n    }\r\n\r\n    set code(data = '') {\r\n        const me = this;\r\n        if (me.#editor) me.#editor.setValue(data);\r\n    }\r\n\r\n    /**\r\n     * Get text selected in Monaco\r\n     */\r\n    get selection() {\r\n        const me = this;\r\n        return me.model.getValueInRange(me.editor.getSelection());\r\n    }\r\n\r\n    get owner() {\r\n        return this.parentElement;\r\n    }\r\n\r\n    #onLanguage(language) {\r\n        const me = this;\r\n        if (me.monaco && language) {\r\n            me.monaco.editor.setModelLanguage(me.model, language);\r\n        }\r\n    }\r\n\r\n    #onTheme(theme) {\r\n        const me = this;\r\n        if (me.monaco && theme) me.monaco.editor.setTheme(theme);\r\n    }\r\n\r\n    /**\r\n     * Search with CSS query for element, if found, \r\n     * get innerHTML, and send to highlighting\r\n     */\r\n    #onTarget(target) {\r\n        const me = this;\r\n        const el = target ? GSDOM.query(target) : null;\r\n        if (!el) return me.code = `Element with id ${target} not found!`;\r\n        me.code = el.innerHTML;\r\n    }\r\n\r\n    /**\r\n     * Download source from URL, then send to highlighting\r\n     */\r\n    async #onURL(url) {\r\n        const me = this;\r\n        try {\r\n            const data = url ? await GSLoader.load(url) : null;\r\n            if (!data) throw new Error(`Code URL ${url} unreachable!`);\r\n            me.code = '';\r\n            me.#onLanguage(me.language);\r\n            me.code = data;\r\n        } catch (error) {\r\n            me.code = error.message;\r\n        }\r\n    }\r\n\r\n    #onMonacoReady() {\r\n\r\n        const me = this;\r\n\r\n        const opt = {\r\n            value: ``,\r\n            language: me.language,\r\n            theme: me.theme,\r\n            automaticLayout: true,\r\n            minimap: { enabled: false }\r\n        };\r\n\r\n        me.#editor = me.monaco?.editor?.create(me.#container, opt);\r\n\r\n        me.attachEvent(window, 'resize', me.#onResize.bind(me));\r\n\r\n        try {\r\n            if (me.url) {\r\n                me.#onURL(me.url);\r\n            } else if (me.target) {\r\n                me.#onTarget(me.target);\r\n            }\r\n        } finally {\r\n            requestAnimationFrame(() => me.emit('initialized'));\r\n            me.#onResize();\r\n        }\r\n    }\r\n\r\n    #onResize(e) {\r\n        const me = this;\r\n        if (!me.#editor) return;\r\n        me.#editor.layout({ width: 0, height: 0 });\r\n\r\n        requestAnimationFrame(() => {\r\n            const rect = me.owner?.getBoundingClientRect();\r\n            if (rect) {\r\n                me.#editor.layout({ width: rect.width, height: rect.height });\r\n            }\r\n        });\r\n    }\r\n\r\n    get #container() {\r\n        return this.#containerRef.value;\r\n    }\r\n\r\n    static #initialized;\r\n\r\n    static async #initLib() {\r\n        if (globalThis.monaco) return;\r\n        const script = document.createElement('script');\r\n        const promise = GSEvents.wait(script, 'load', 0, false);\r\n        script.type = \"text/javascript\";\r\n        script.src = `${GSMonacoElement.URL_LIB}vs/loader.js`;\r\n        GSDOM.appendChild(document.head, script);\r\n        await promise;\r\n    }\r\n\r\n    // Before loading vs/editor/editor.main, define a global MonacoEnvironment that overwrites\r\n    // the default worker url location (used when creating WebWorkers). The problem here is that\r\n    // HTML5 does not allow cross-domain web workers, so we need to proxy the instantiation of\r\n    // a web worker through a same-domain script\r\n    static #initEnv() {\r\n        const url = GSMonacoElement.URL_LIB;\r\n        window.MonacoEnvironment = {\r\n            baseUrl: `${url}`,\r\n            getWorkerUrl: (workerId, label) => {\r\n                return `data:text/javascript;charset=utf-8,${encodeURIComponent(`\r\n                globalThis.MonacoEnvironment = {baseUrl: '${url}'};\r\n                importScripts('${url}vs/base/worker/workerMain.js');`\r\n                )}`;\r\n            }\r\n        };\r\n    }\r\n\r\n    static #initMonaco() {\r\n        return new Promise((resolve, reject) => {\r\n            // TODO  set disabled to true and manually load themes into shadow dom\r\n            require.config({\r\n                paths: { 'vs': `${GSMonacoElement.URL_LIB}/vs` },\r\n                'vs/css': { disabled: false }\r\n            });\r\n            require(['vs/editor/editor.main'], resolve);\r\n        });\r\n    }\r\n\r\n    static async #init() {\r\n        const me = GSMonacoElement;\r\n        if (me.#initialized) return;\r\n        me.#initEnv();\r\n        await me.#initLib();\r\n        await me.#initMonaco();\r\n        me.#initialized = true;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-monaco');\r\n    }\r\n\r\n}"],"names":["GSVersion","version","build","gsstyles","GSLog","static","el","msg","this","print","tracing","forced","type","logging","tmp","nodeName","id","fn","console","log","Error","Object","seal","GSUtil$1","GSUtil","globalThis","GS_FLAT","n","isNaN","parseFloat","isFinite","v","Date","Boolean","value","toString","val","trim","toLowerCase","str","obj","replace","x","g","split","reverse","join","word","toUpperCase","slice","map","i","capitalize","constructor","o","Array","isArray","isBool","isDate","isNumber","isString","min","max","Math","match","isNull","dft","language","sep","numberSeparator","extractNumber","replaceAll","url","test","startsWith","endsWith","pattern","charset","floor","random","length","navigator","languages","flags","RegExp","isStringEmpty","undefined","Intl","NumberFormat","format","DateTimeFormat","string","reg","keys","isJsonString","isJsonType","normalize","JSON","parse","normalizeJson","warn","JSON_NORMALIZE","def","separator","filter","capitalizeAll","tpl","params","names","vals","values","Function","text","textArea","document","createElement","innerHTML","isStringNonEmpty","window","forEach","a","left","right","lmatch","rmatch","time","signal","AbortSignal","timeout","Promise","resolve","reject","iid","setTimeout","bind","addEventListener","clearTimeout","data","name","blob","Blob","URL","createObjectURL","href","download","click","revokeObjectURL","clazz","ext","freeze","expose","HTMLElement","isPrototypeOf","customElements","get","define","extends","isSealed","isFrozen","self","src","import","result","permissions","query","state","clipboard","writeText","readText","GSFunction$1","GSFunction","isFunction","includes","own","isFunctionDefined","desc","Reflect","getOwnPropertyDescriptor","__proto__","isValid","callFunctionAsync","Symbol","toStringTag","owner","args","arguments","from","apply","native","parseFunction","isFunctionNative","isFunctionAsync","callFunctionSync","parseValue","context","cnt","async","contextualize","accept","queueMicrotask","e","GSID","prefx","next","s","l","h","charCodeAt","isProxy","GSAttr","isHTMLElement","setAttribute","removeAttribute","isInstance","getAttribute","attr","asBool","asNum","toJson","set","NaN","stringify","entries","kv","attributes","host","opt","recursive","Proxy","target","prop","dataset","attribute","toggle","Number","setAsNum","children","proxify","safe","unsafe","dflt","default","multi","hasAttribute","toStringArray","GSCSSMap","body","computedStyleMap","element","getMap","me","modern","capitalizeAttr","asText","to","unit","num","shift","matches","getComputedStyle","getComputedStyledMap","String","on","selText","ors","some","selector","logicalORs","styleSheets","cssRules","reduce","all","concat","containsAny","selectorText","GSDate","DEFAULT_FORMAT","asJSON","REGEX_FORMAT","last","getDate","first","getDay","mondayFirst","isMondayFirst","days","repeat","push","year","getFullYear","setFullYear","month","getMonth","setMonth","day","setDate","YY","YYYY","M","MM","padStart","MMM","toLocale","MMMM","D","DD","d","dd","ddd","weekday","dddd","H","getHours","HH","formatHour","hh","meridiem","A","m","getMinutes","mm","getSeconds","ss","SSS","getMilliseconds","Z","zoneStr","ZZ","Q","ceil","k","kk","W","date","getTime","setHours","week1","round","WW","X","short","offset","Locale","weekInfo","firstDay","charAt","toLocaleString","size","isLowercase","hour","hour12","pop","negMinutes","getTimezoneOffset","minutes","abs","minuteOffset","getDateFormat","regex","getFormattedDateRegex","parseFormattedDate","groups","y","Y","valueOf","GSData","currency","extract","key","Set","b","every","index","toSorted","compareArrays","second","advanced","arr","indexOf","list","it","cfg","toType","rule","toRegex","childElementCount","querySelector","fmt","style","fields","limit","sts","rec","filterRecord","isPrimitive","filterSimple","filterComplex","filterValue","primitive","found","flt","toCheck","matchDate","matchNumber","op","toLocaleLowerCase","local","toLocaleDateString","iso","toISOString","operator","sort","sortPair","ord","idx","col","v1","v2","compare","order","compareNum","compareString","compareBool","s1","s2","localeCompare","ignoreNull","seg","writeSingleToObject","tree","hasOwnProperty","partial","r","readFromProperty","readFromObject","GSDOM","activeElement","active","shadowRoot","css","visibility","display","opacity","rect","getBoundingClientRect","width","height","html","single","mime","doc","DOMParser","parseFromString","head","firstElementChild","error","forceWrap","nodes","fromNode","wrap","appendChild","link","slot","isText","tagName","FORMEL","shadow","queryAll","HTMLButtonElement","hasClass","ownClazz","inheritance","pel","HTMLSelectElement","HTMLSlotElement","HTMLTemplateElement","SVGElement","Text","Comment","clazzName","childNodes","isGSElement","orientation","classList","add","remove","newEl","injectable","isSVGElement","isOK","invalid","parentNode","nextElementSibling","insertBefore","placement","isok","insertAdjacentElement","parent","removeChild","node","closest","parentAll","childAll","child","parentElement","offsetParent","c","ShadowRoot","HTMLBodyElement","root","getByID","documentElement","walk","qry","levels","proxy","res","receiver","sanitize","sanitizer","setHTML","Document","textContent","requestAnimationFrame","toggleClass","contains","unwrap","querySelectorAll","defaults","valueAsNumber","selectedOptions","checked","defaultValue","getValue","styleValue","textTransform","ignore","checkValidity","fromElement2Object","fromObject2Element","objectPathExist","fromValue","writeToObject","toValue","plain","definitions","innerText","props","allProperties","getAsNum","items","tag","asString","fromJsonAsString","fromJsonAsDOM","title","for","sub","location","hash","setValue","group","disabled","createTreeWalker","NodeFilter","SHOW_TEXT","nextNode","ts","textNodesUnder","t","wholeText","nextSibling","nodeValue","CLEANUP1","whiteList","asState","isAllowed","toValidationError","allowElement","allowTag","fetch","ok","sheet","CSSStyleSheet","replaceSync","adoptedStyleSheets","isFormElement","resetSelect","typed","dispatch","isSelect","options","selected","dispatchEvent","Event","bubbles","composed","properties","mergeObjects","template","CustomEvent","detail","message","GSEvents","Map","altContext","protect","listen","onContext","onKeyDown","event","shiftKey","prevent","code","ctrlKey","callback","loaded","wait","callFunction","sendSuspended","once","chained","suspended","removeEventListener","unlisten","toSignal","internal","evt","full","hasFunction","preventDefault","stopPropagation","stopImmediatePropagation","sender","cancelable","ClipboardEvent","FocusEvent","InputEvent","KeyboardEvent","MouseEvent","SubmitEvent","TouchEvent","WheelEvent","PointerEvent","send","capture","Window","isConnected","eventKey","elmap","getElementMap","eventMap","fnkey","defineProperty","gsid","writable","delete","removeListener","cache","removeElementMap","clear","elid","getElementID","fnid","getCallbackID","hashCode","action","onAction","prefix","findAction","onError","GS_LOG_ACTION","rid","waitAnimationFrame","onResize","attach","waitPageLoad","GSAbortController","AbortController","super","abort","clearInterval","GSDOMObserver","MutationObserver","observe","childList","subtree","observer","onObserve","forRemove","filtersDel","filtersAdd","hasFilters","hasFiltersAdd","hasFiltersDel","mutations","mutation","addedNodes","removedNodes","rootEL","filters","isFunctions","getFilter","exec","create","GSDynamicStyle","deleteRule","getRule","setRule","sync","insertRule","updateRule","isImportant","setProperty","source","dynamicStyleSheetByID","dynamicStyleSheet","gsClass","dynamicRule","dynamicRuleByID","dynamicStyle","assign","dynamicStyleByID","GSCacheStyles","store","dynamic","styles","adopt","adoptedId","GSAdoptedEngine","now","preload","timerID","setInterval","sheets","adoptable","adoptSheet","update","scheduled","sorted","ID","cssText","monitorAttributes","ownerNode","adoptStyle","disconnect","mutationList","onAttributeChange","attributeFilter","attributeOldValue","HTMLLinkElement","rel","as","HTMLStyleElement","then","adoptLink","registerFilter","onMonitorFilter","onMonitorConnect","onMonitorDisconnect","init","GSLoader","GS_TEMPLATE_URL","origin","GS_ROUTER_URL","rootURL","defaultURL","TEMPLATE_URL","ROUTER_URL","hasKey","NO_CACHE","GS_NO_CACHE","localStorage","setItem","getItem","base","path","isFile","pathname","isExt","uri","UNIQUE","searchParams","append","level","isHTML","getRouterURL","loadSafe","routerURL","normalizeURL","routerPath","getTemplateURL","templateURL","templatePath","method","load","headers","asjson","ct","Accept","json","isJson","func","isFunc","GSTemplateCache","isTemplateElement","content","cloneNode","cached","getOrCreate","isHTMLTemplate","initTemplate","loadTemplate","isFunctionTemplate","loadHTMLTemplate","loadFunctionTemplate","loadURLTemplate","GSAttributeHandler","anchor","call","inject","property","swap","trigger","hashed","calls","toggles","triggers","handle","targets","handleTarget","handleBinding","handleAction","handleSwap","handleInject","handleAttribute","handleProperty","handleToggle","handleTrigger","handleEvent","handleCall","handleExec","handleTemplate","field","form","isForm","HTMLFormElement","isField","toObject","isAttributeJSON","jsonToAttr","toggleAttribute","isPropertyJSON","toggleProperty","tout","symbol","handleContent","clean","useDef","definition","toHTML","gsHashed","applyContent","applyTemplate","clone","insertAdjacent","detach","off","parentComponent","DEFINITION","override","GSBeep","AudioContext","webkitAudioContext","audioContext","duration","frequency","volume","isAvailable","audioCtx","oscillatorNode","createOscillator","gainNode","createGain","connect","destination","gain","start","currentTime","stop","onended","isActive","hasBeenActive","userActivation","GSEnvironment","isMobile","userAgentData","mobile","userAgent","isDesktop","isWebkit","protocol","strVal","brands","brand","strAgt","isEdge","isDevice","platform","screen","otype","GSPromise","callbacks","promise","onAbort","await","aborted","onResolve","onReject","ps","p","GSEvent","EventTarget","listeners","listener","abortable","controller","emit","delayed","unbind","GSEventBus","register","registry","has","exist","bus","GSGesture","xDiff","yDiff","xDown","yDown","bindings","swipe","tap","longPress","delay","move","handleTouchMove","handleTouchStart","end","handleTouchEnd","touches","clientX","clientY","onLongPress","xUp","yUp","GSItem","autofocus","validate","GSElement","tags","collect","GS_LOCALIZATION_LANGUAGE","lang","GSLocalization","GSLocalizationImpl","queue","queued","GS_LOCALIZATION_URL","translate","deft","getLanguage","texthash","reset","promises","loadWait","sequential","Pragma","isDefault","hk","details","GSPopper","asRect","sx","scrollX","sy","scrollY","top","bottom","centerX","centerY","calcPadding","padding","elementPadding","paddingX","paddingY","elementWidth","clientWidth","elementHeight","clientHeight","elementX","elementY","arrow","pos","fromPlacement","isPlacementValid","position","margin","transform","offh","offw","boundingRect","arect","updateArrow","offH","offW","srcH","srcW","calcFixed","astyle","inset","srect","getOffset","calcAbsolute","aopt","isTop","isBottom","isStart","isEnd","trect","erect","arrowPosW","arrowPosH","applyDynamicStyle","GSQueryCSS","object","GSQuery","instance","GSRouter","enabled","hashCallback","onHashChange","getRouter","loadDefinition","enable","disable","route","unregister","deepClone","fromJson","px","process","GS_DEFINITION_URL","initialize","GS_ROUTER_WAIT","GSTheme","switch","theme","STORAGE","htmlEl","bsTheme","matchMedia","q","URLSearchParams","onTheme","settings","getSystemDefaultTheme","darkMode","lightMode","setup","BinaryTreeNode","isLeaf","hasChildren","isRoot","BinaryTree","inOrderTraversal","postOrderTraversal","preOrderTraversal","insert","parentNodeKey","canInsertLeft","canInsertRight","find","Node","previous","release","toJSON","DoublyLinkedList","tail","previousNode","insertAt","splice","insertFirst","insertLast","getAt","removeAt","acc","toArray","iterator","isInvalid","isInvalidIndex","isInteger","LinkedList","Stack","item","unshift","peek","isEmpty","Queue","enqueue","dequeue","Tree","folder","leaf","up","levelID","nodeID","isFolder","hasMore","firstChild","lastChild","down","previousSibling","inclusive","flat","iterate","filtered","dr","newOne","findByKey","flatten","fromJSON","raw","hasParent","DataSelector","SELECT","asArray","removeSelected","isSelected","GSReadWriteRegistryImpl","handlers","INTERNAL","addHandler","removeHandler","getHandler","newHandler","verify","rw","resetRegistry","GSReadWriteRegistry","GSAbstractReadWrite","processors","addProcessor","processor","removeProcessor","isRegistered","notify","onRead","postRead","onWrite","postWrite","addSelected","clearSelected","getSelected","GSReadWrite","reader","writer","mode","skip","TYPE","MODES","isQuark","METHOD","toURL","encodeURIComponent","fromLiteral","isOffline","isRemote","GSCachedReadWrite","reformat","records","postFilter","sortData","filterData","search","read","TreeNode","opened","focused","focusedNode","selectedNode","controllers","select","focus","open","addController","removeController","visible","expand","collapse","changed","onFocusChanged","onSelectionChanged","isPartialySelected","selectAll","deselectAll","selectionFlag","onSelectAll","onDeselectAll","selectedNodes","refresh","onRefresh","loading","onLoad","expandAll","collapseAll","expanded","collapsed","onExpand","onCollapse","onAppend","onInsert","GSTreeReader","resetData","litUrl","GS_LIT_URL","litModule","ReactiveController","ReactiveElement","AsyncDirective","AsyncReplaceDirective","CSSResult","Directive","LitElement","PartType","TemplateResultType","UnsafeHTMLDirective","UntilDirective","_$LE","_$LH","adoptStyles","asyncAppend","asyncReplace","choose","classMap","clearPart","createRef","defaultConverter","directive","getCommittedValue","getCompatibleStyle","getDirectiveClass","guard","ifDefined","insertPart","isCompiledTemplateResult","isDirectiveResult","isServer","isSingleExpression","isTemplateResult","keyed","literal","live","noChange","notEqual","nothing","range","ref","removePart","render","setChildPartValue","setCommittedValue","staticHtml","staticSvg","styleMap","supportsAdoptingStyleSheets","svg","templateContent","unsafeCSS","unsafeHTML","unsafeSVG","unsafeStatic","until","when","withStatic","gsAction","gsAnchor","gsAttribute","gsCall","gsExec","gsInject","gsProperty","gsSwap","gsTarget","gsTemplate","gsToggle","gsTrigger","gsValue","gsTimeout","DatasetDirective","part","srcset","DOMStringMap","remap","hasOwn","descriptors","getOwnPropertyDescriptors","listProperties","listGetters","getPrototypeOf","literalTemplate","listGettable","cssMap","CssMapDirective","partInfo","ATTRIBUTE","strings","classInfo","_previousClasses","_staticClasses","notEmpty","newVal","oldVal","numGT0","numGE0","numLT0","numLE0","AutocapitalizeTypes","autocapitalize","hasChanged","AutocompleteTypes","autocomplete","AutocorrectTypes","autocorrect","ButtonTypes","buttonType","is","ColorTypes","color","EnvironmentTypes","environment","InputTypes","inputType","NavTypes","nav","OrientationTypes","PlacementTypes","PositionTypes","ProtocolTypes","SizeTypes","normal","medium","small","large","big","extra","stringArrayConverter","fromAttribute","toAttribute","AdoptedController","hostConnected","hostDisconnected","isGlobal","rules","removeRule","renderRoot","onAdopted","AttributeController","eventName","onNotify","isFormEl","ContentController","refs","removeContent","hostUpdated","isSelf","contentRef","renderOptions","renderBefore","previousElementSibling","keep","DataController","readCallback","writeCallback","errorCallback","selectCallback","onSelect","write","storeID","firstPage","page","lastPage","nextPage","prevPage","storage","requestUpdate","onDataRead","onDataWrite","onDataError","ElementMoveController","attached","cursorX","cursorY","mouseUpCallback","mouseDownCallback","mouseMoveCallback","onMouseUp","onMouseDown","onMouseMove","attachEvent","removeEvent","onStartMove","onEndMove","onCursorRight","onCursorLeft","onCursorUp","onCursorDown","LocalizationController","hostUpdate","updateLanguage","updateLanguageExt","langauge","onLanguage","OrientationController","hosts","onOrientation","TemplateController","lastRef","isPrefetch","GS_TEMPLATE_PREFETCH","templateRef","schedule","templateInjected","isTplEl","cacheable","err","xTemplate","tasks","task","finally","ThemeController","updateTheme","updateThemeExt","SlotController","onSlotChanged","assignedElements","onSlotInjected","rtl","reflect","hide","rounded","bordered","onready","os","browser","adopted","uiHandler","localization","dataController","slotController","themes","attributeChangedCallback","oldValue","newValue","connectedCallback","isBindable","binded","disconnectedCallback","detachListeners","createRenderRoot","firstUpdated","willUpdate","isAllowRender","renderUI","renderTemplate","renderClass","border","mapCSS","flag","waitEvent","direction","isFocused","isValidEnvironment","isValidBrowser","isValidOS","isValidProtocol","isValidOrientation","isGenerated","elementStyles","cssRule","setCSSProperty","ElementNavigationController","circular","multiple","onKeyUp","onClick","onFocusIn","onFocusOut","lastElementChild","blur","onSelected","onDeselected","onFocused","isNavigable","isNav","relatedTarget","composedPath","GroupController","busEvent","busCallback","onBusEvent","GSRouterElement","router","updated","GSAccordionElement","autoclose","cssItem","cssHeader","cssBody","renderItems","close","isItemCloser","GSAccordionItemElement","shouldUpdate","changedProperties","component","GSAlertElement","closed","closable","pause","interval","handleBillboard","show","isBillboard","button","billboard","GSButtonElement","clickCss","hoverCss","toggleColor","outline","toggling","icon","tooltip","refEl","refIco","onMouseOver","onMouseOut","iconEl","animate","onHref","isReset","isSubmit","submit","hover","iconHtml","renderIcon","GSCalendarElement","editable","minYear","maxYear","arrovPrev","arrowNext","cssDays","cssToday","cssWeeks","cssMonth","cssYear","cssNav","cssSelected","arrowPrev","previousMonth","nextMonth","previousYear","nextYear","formatted","updateTarget","week","dayList","months","monthsHTML","yearHTML","onKey","onDay","daysHTML","tgt","HTMLInputElement","valueAsDate","isToday","today","c1","c2","current","monthList","onMonth","optionsHTML","onYear","isList","listID","selectedIndex","yearEl","validity","valid","GSCardElement","imageStyle","overlay","align","image","subtitle","footer","header","colorText","colorBack","colorBorder","cssTitle","cssSubtitle","cssFooter","cssImage","styleID","isVertical","renderVertical","renderHorizontal","imageTop","imageBottom","isBefore","startClass","endClass","startHtml","images","endHtml","isHorizontal","imageSlot","GSCenterElement","GSMenuElement","auto","dark","menuRef","closeSubmenus","updatePosition","onMouseLeave","submenu","dropend","dropstart","popup","caller","isMouseOrPointerEvent","renderSubmenu","renderHeader","renderMenu","renderDivider","menu","toSubmenu","menuItem","isSubmenu","innerWidth","GSContextElement","isInTable","attachTarget","assignedSlot","onPopup","GSCompareElement","background","before","after","elRef","clipRef","slideRef","mouseController","elPosition","splitter","onDoubleClick","isAuto","pct","isFixed","slider","clip","GSControllerElement","module","changes","GSCopyrightElement","company","isCompany","isYear","GSDataHandler","autoload","autorefresh","config","handler","lifoReadRef","lifoWriteRef","itemHolder","PROPERTIES","initLIFO","updateHandler","formatSort","formatFilter","isDebug","gsDebug","isCached","formated","save","verifyHandler","callOnceLifo","lifoReadRefCallback","lifoWriteRefCallback","lifoCall","GSDialogElement","standard","escapable","cancelText","confirmText","minWidth","buttonAlign","iconCancel","iconConfirm","colorCancel","colorConfirm","cssCancel","cssConfirm","cssContent","pass","dialogRef","btnConfirmRef","btnCancelRef","CSS","TITLE_CSS","HEADER_CSS","ALIGN","CANCEL","CONFIRM","updateStack","_shouldUpdate","allowed","onOpenChanged","STACK","dialog","showModal","focusable","isHashed","renderConfirm","onConfirm","renderCancel","onCancel","renderFooter","onForm","onSubmit","info","confirm","prompt","forms","f","tab","btnConfirm","btnCancel","QUERY_INPUT","isVisible","GSDrawerElement","backdrop","scroll","fingers","transition","cssHead","onLeave","onEnter","hasHeader","headSlot","GSDropdownElement","simple","renderButton","buttonClass","btn","GSEmailElement","user","domain","dev","updateUser","updateDomain","GSFormElement","acceptCharset","enctype","novalidate","block","beep","formRef","lastState","onChange","onBlur","onInvalid","doFilter","filterField","elements","submitButton","resetButton","childrens","inputs","reportValidity","onValidate","disableInput","enableInput","onFieldChange","onFieldInvalid","findField","fieldValue","fldName","gsfDisable","fldVal","gsfValue","matched","selectable","GSFormGroupElement","layout","label","description","placeholder","mask","spellcheck","rows","cols","step","minLength","maxLength","autoid","autocopy","autoselect","reveal","readonly","required","invalidMessage","cellField","cellLabel","cssLabel","cssField","inputRef","ouptutRef","patterns","validateAllowed","ICON","CSS_LABEL","CSS_LABEL_CELL","formComponent","SELECTOPT","onRange","renderFloating","cssCheck","renderInput","renderOutput","renderLabel","renderInfo","renderLabelWrap","renderField","isIcon","CSS_ICON","renderTooltip","isRange","idattr","isFieldset","radioLayout","fieldSet","inputHTML","selectHTML","isTextArea","fld","vertical","initStyle","listHTML","outerHTML","isBlock","isBeep","isSwitch","isCheckable","isFloating","slots","tagList","isCheck","isRadio","isChecked","isPassword","isEmail","isURL","GSFormPanelElement","renderFormGroup","formaction","formenctype","formmethod","formnovalidate","formtarget","maxlength","minlength","GSGroupElement","controllerGroup","initData","prerender","of","renderWrappedUI","renderWrappedClass","childTagName","generated","getName","GSIconElement","superColor","_clicked","_hovered","postAnimate","fs","GSIndentElement","multiplier","numdef","GSImageElement","invert","grayscale","brightness","contrast","saturate","hue","sepia","alt","imageRef","complete","renderStyle","buildFilter","GSLayoutElement","resizable","autofit","vPos","hPos","els","dyncss","horizontal","lev","tplEl","elementTemplate","tc","dir","did","panelCSS","panelStyle","resize","grow","vpos","hpos","GSLinklement","ping","GSListElement","GSListItemElement","initial","renderFirst","renderSecond","itemCSS","isSelectable","itemStatusCSS","renderText","activeCSS","cssActive","inactiveCSS","cssInactive","GSMouseElement","pageX","pageY","screenX","screenY","offsetX","offsetY","onMouse","GSMovableElement","onMove","cursor","updateCursor","GSNavElement","isTab","GSNavItemElement","itemsCSS","buttonCSS","buildCSS","cssButton","navType","GSOverlayElement","autoremove","radius","styleID2","innerHeight","fillRule","clipRule","strokeLinejoin","strokeMiterlimit","zIndex","pathStr","createSVGPathString","fill","pointerEvents","windowX","windowY","limitedRadius","normalizedRadius","highlightBoxWidth","highlightBoxHeight","GSPagerElement","pages","labelFirst","labelLast","labelNext","labelPrevious","half","renderPrevious","renderItem","renderNext","renderLast","pagination","decodeHTMLEntities","toTarget","ctrl","GSPopupElement","wMin","wMax","hMin","hMax","panelRef","onAuto","reposition","postPopup","popupFixed","panel","overflowH","overflowV","GSPopoverElement","arrowRef","arrowID","attachEvents","popover","fade","isFocusTrigger","isHoverTrigger","popupAbsolute","onFocus","GSProgressElement","updateStyle","percentage","onKeySelect","increase","decrease","trunc","old","GSSpinnerElement","pulsar","GSSplitterElement","styleTGT","cssUpdate","lock","updateMouse","isPreceeding","isStyleValue","styleDynamic","lockable","csize","cls","gsSplitter","updateX","updateY","dx","GSTabItemElement","updateCSS","tabCSS","GSTabPanelElement","GSTabGroupElement","findPanel","isAfter","tabs","renderTabs","panels","renderPanels","GSTableElement","colspan","hidden","fixed","filterType","cssFilter","colorFilter","colorHead","colorSelect","colorSort","stripedColumn","divider","striped","grid","borderless","columns","datacolumn","multisort","multiselect","protected","sortable","sortOrder","headColor","CELLS","table","stripedColumns","renderFilters","onSort","entry","renderColumn","renderRecord","renderEmpty","renderHandler","columnType","columType","input","valueAt","row","cell","cfgType","timestamp","dataType","renderFilter","hasSub","onFilter","renderOption","listid","icons","sortType","cells","remapRecord","renderCell","record","elementTofilter","column","getElementIndex","prepareSorter","isComplex","tr","GSTagElement","converter","appendable","closeColor","cssClose","cssTag","dataListRef","renderTags","onInput","renderList","updateTag","KEYS","srcElement","removeTag","addTag","isMax","datalist","optEl","tagEl","renderTag","tagClass","btnClass","badge","GSTextElement","GSTooltipElement","arrowStyle","arrowEl","panelEl","refLocal","refGlobal","GSTemplateElement","CopySelectController","clickCallback","copyCallback","onCopy","writeToClipboard","MaskController","_","back","prev","keyDownCallback","inputCallback","focusCallback","changeCallback","initRules","j","buildSlots","findIndex","buildAccept","toPattern","isMatch","setCustomValidity","setSelectionRange","substring","selectionStart","selectionEnd","lastIndex","maskType","chars","masks","special","MultipatternController","multipattern","NumberController","onNumberInput","PasswordController","revealing","keyUpCallback","isReveal","altKey","TextController","updateText","InteractiveController","monitorCallback","blurCallback","onMonitor","onDataChange","hasUpdated","formElements","strict","isInList","togleEl","dataGroup","togleOption","isButtonElement","ComboController","ListController","ValidityController","invalidCallback","processing","togglUI","isTyped","report","defaultPropertyDeclaration","attributeToPropertyMap","prepare","elementProperties","finalize","finalized","prepareFn","getOwnPropertySymbols","superCtor","attributeNameForProperty","ReactiveInput","reflectingProperties","instanceProperties","updatePromise","reflectingProperty","isUpdatePending","observedAttributes","initializer","initializers","propKeys","getOwnPropertyNames","createProperty","noAccessor","descriptor","getPropertyDescriptor","prototype","configurable","enumerable","enableUpdating","attributeToProperty","requestedUpdate","getUpdateComplete","scheduleUpdate","performUpdate","propertyToAttribute","markUpdated","updateComplete","getPropertyOptions","changeProperty","enqueueUpdate","elementProps","wrapped","didUpdate","ctor","propName","attrValue","saveInstanceProperties","GSComboExt","comboController","setIf","onReset","objToHTML","mergeArrays","GSDataListExt","HTMLDataListElement","GSInputElement","copyselect","maskController","multiPatternController","passwordController","numberController","textController","listController","validityController","isMulti","isType","GSTextArea","HTMLTextAreaElement","GSBreadcrumbElement","spacing","updateChildren","$text","GSBreadcrumbItemElement","generate","GSAttachment","file","directory","transfer","transferredFiles","files","File","fullPath","isImage","isVideo","isDirectory","traverse","roots","createReader","readEntries","results","getEntries","getFile","webkitGetAsEntry","GSFileBoxElement","cssList","cssInput","maxFileSize","listEl","fileEl","dragging","TITLE","onDragenter","onDragleave","onDrop","onPaste","dataTransfer","hasFile","dropEffect","clipboardData","pastedFile","types","rgx","kind","getAsFile","attachments","DataTransfer","transferred","validAttachments","GSTimeFormat","toLocaleTimeString","GSDateFormat","GSYearFormat","GSCurrencyFormat","GSStepStyle","GSStepElement","iconCSS","titleCSS","INACTIVE","ICON_CSS","GSStepsElement","steps","isFirst","isLast","COMPLETED","SELECTED","GSNotificationElement","BOTTOM_END","DEFAULT","positionCSS","dismiss","success","danger","primary","secondary","light","requestPermission","showNative","showWeb","toast","dialogToast","notification","Notification","clearNative","dlg","nn","isNativeSupported","isGranted","permission","GSToastElement","pending","visibilityChange","isVisibilityChanged","pendingUpdate","validParent","renderWithHeader","renderSimple","isToast","isNotify","AbstractTreeController","addNodeController","removeNodeController","oldNode","TreeController","toggleState","addedNode","insertedNode","onRemove","GSTreeItemElement","renderSpinner","cssFocus","status","toggleSelection","parentItem","checkColor","checkColorSelected","ui","itemIco","itemIcon","openIcon","closeIcon","renderIndent","renderMulti","GSTreeElement","guide","shared","listRef","nextItem","previousItem","reload","expandable","ServiceWorkkerElement","scope","trace","registration","workerMessage","messageChannel","nocache","onWorkerMessage","unload","ServiceWorkerTraceUpdate","available","clearCache","postMessage","nonNull","isLoaded","port1","onMessage","initChannel","MessageChannel","onmessage","port2","waiting","monitorServiceWorkerUpdate","installing","serviceWorker","invokeServiceWorkerUpdateFlow","monitorController","refreshing","GSChartElement","URL_LIB","GS_URL_CHART","canvasRef","chart","waitInit","destroy","isChart","renderData","canvas","updateChart","div","toBase64Image","quality","sets","datasets","ctx","getContext","Chart","initializing","registerables","nameV","valV","typeV","childs","isObject","_nam","GSChart","_val","_typ","GSHighlightElement","GS_URL_HLJS","codeRef","onTarget","onURL","onHighlight","hasLangauge","highlight","injectCSS","terminate","response","worker","blobURL","Worker","langs","GSMarkdownElement","GS_URL_MARKDOWN","history","maxHeight","containerRef","initLib","showdown","tasklists","tables","Converter","toCache","fromCache","container","makeHtml","handleLinks","handleTables","handleCode","parentPath","handleStyles","links","onLinkClick","script","GSMonacoElement","GS_URL_MONACO","editor","onMonacoReady","monaco","model","getModel","selection","getValueInRange","getSelection","setModelLanguage","setTheme","automaticLayout","minimap","MonacoEnvironment","baseUrl","getWorkerUrl","workerId","require","paths","vs","initialized","initEnv","initMonaco"],"mappings":"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"}