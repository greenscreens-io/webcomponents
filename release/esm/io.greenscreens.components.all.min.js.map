{"version":3,"file":"io.greenscreens.components.all.min.js","sources":["../../modules/base/GSVersion.mjs","../../modules/base/style.mjs","../../modules/base/GSLog.mjs","../../modules/base/GSUtil.mjs","../../modules/base/GSFunction.mjs","../../modules/base/GSID.mjs","../../modules/base/GSAttr.mjs","../../modules/base/GSCSSMap.mjs","../../modules/base/GSDate.mjs","../../modules/base/GSData.mjs","../../modules/base/GSDOM.mjs","../../modules/base/GSEvents.mjs","../../modules/base/GSAbortController.mjs","../../modules/base/GSDOMObserver.mjs","../../modules/base/GSDynamicStyle.mjs","../../modules/base/GSCacheStyles.mjs","../../modules/base/GSAdoptedEngine.mjs","../../modules/base/GSEnvironment.mjs","../../modules/base/GSPromise.mjs","../../modules/base/GSEvent.mjs","../../modules/base/GSEventBus.mjs","../../modules/base/GSGesture.mjs","../../modules/base/GSItem.mjs","../../modules/base/GSLoader.mjs","../../modules/base/GSLocalization.mjs","../../modules/base/GSPopper.mjs","../../modules/base/GSQueryCSS.mjs","../../modules/base/GSQuery.mjs","../../modules/base/GSTemplateCache.mjs","../../modules/base/GSTheme.mjs","../../modules/base/GSAttributeHandler.mjs","../../modules/helpers/Stack.mjs","../../modules/helpers/Queue.mjs","../../modules/helpers/BinaryTree.mjs","../../modules/helpers/DoublyLinkedList.mjs","../../modules/helpers/Tree.mjs","../../modules/data/ReadWriteRegistry.mjs","../../modules/data/AbstractReadWrite.mjs","../../modules/data/ReadWrite.mjs","../../modules/data/CachedReader.mjs","../../modules/data/TreeNode.mjs","../../modules/data/TreeReader.mjs","../../modules/lib.mjs","../../modules/directives/dataset.mjs","../../modules/directives/literal.mjs","../../modules/directives/css-map.mjs","../../modules/properties/verificator.mjs","../../modules/properties/buttonType.mjs","../../modules/properties/color.mjs","../../modules/properties/environment.mjs","../../modules/properties/inputType.mjs","../../modules/properties/nav.mjs","../../modules/properties/orientation.mjs","../../modules/properties/placement.mjs","../../modules/properties/position.mjs","../../modules/properties/protocol.mjs","../../modules/properties/size.mjs","../../modules/properties/arrayConverter.mjs","../../modules/controllers/AdoptedController.mjs","../../modules/controllers/AttributeController.mjs","../../modules/controllers/ContentController.mjs","../../modules/controllers/DataController.mjs","../../modules/controllers/ElementMoveController.mjs","../../modules/controllers/ElementNavigationController.mjs","../../modules/controllers/OrientationController.mjs","../../modules/controllers/ThemeController.mjs","../../modules/controllers/TemplateController.mjs","../../modules/controllers/SlotController.mjs","../../modules/controllers/LocalizationController.mjs","../../modules/GSElement.mjs","../../modules/components/Accordion.mjs","../../modules/components/AccordionItem.mjs","../../modules/components/Alert.mjs","../../modules/components/Button.mjs","../../modules/components/Calendar.mjs","../../modules/components/Card.mjs","../../modules/components/Center.mjs","../../modules/components/Menu.mjs","../../modules/components/Context.mjs","../../modules/components/Compare.mjs","../../modules/components/Controller.mjs","../../modules/components/Copyright.mjs","../../modules/components/DataHandler.mjs","../../modules/components/Dialog.mjs","../../modules/components/Drawer.mjs","../../modules/components/Dropdown.mjs","../../modules/components/Email.mjs","../../modules/components/Form.mjs","../../modules/components/FormGroup.mjs","../../modules/components/FormPanel.mjs","../../modules/components/Group.mjs","../../modules/components/Icon.mjs","../../modules/components/Indent.mjs","../../modules/components/Image.mjs","../../modules/components/Layout.mjs","../../modules/components/Link.mjs","../../modules/components/ListItem.mjs","../../modules/components/List.mjs","../../modules/components/NavItem.mjs","../../modules/components/Nav.mjs","../../modules/components/Overlay.mjs","../../modules/components/Pager.mjs","../../modules/components/Popup.mjs","../../modules/components/Progress.mjs","../../modules/components/Spinner.mjs","../../modules/components/Splitter.mjs","../../modules/components/tab/Tab.mjs","../../modules/components/tab/TabPanel.mjs","../../modules/components/tab/TabGroup.mjs","../../modules/components/Table.mjs","../../modules/components/Tag.mjs","../../modules/components/Text.mjs","../../modules/components/Tooltip.mjs","../../modules/components/Template.mjs","../../modules/components/ext/controllers/CopySelectController.mjs","../../modules/components/ext/controllers/MaskController.mjs","../../modules/components/ext/controllers/NumberController.mjs","../../modules/components/ext/controllers/PasswordController.mjs","../../modules/components/ext/controllers/TextController.mjs","../../modules/components/ext/controllers/ListController.mjs","../../modules/components/ext/ReactiveInput.mjs","../../modules/components/ext/GSComboExt.mjs","../../modules/components/ext/GSDataListExt.mjs","../../modules/components/ext/GSInputElement.mjs","../../modules/components/breadcrumb/Breadcrumb.mjs","../../modules/components/breadcrumb/BreadcrumbItem.mjs","../../modules/components/intl/TimeFormat.mjs","../../modules/components/intl/DateFormat.mjs","../../modules/components/intl/YearFormat.mjs","../../modules/components/intl/CurrencyFormat.mjs","../../modules/components/steps/StepStyle.mjs","../../modules/components/steps/Step.mjs","../../modules/components/steps/Steps.mjs","../../modules/components/toast/Notification.mjs","../../modules/components/toast/Toast.mjs","../../modules/components/tree/controllers/AbstractTreeController.mjs","../../modules/components/tree/controllers/TreeController.mjs","../../modules/components/tree/TreeItem.mjs","../../modules/components/tree/Tree.mjs","../../modules/extra/Chart.mjs","../../modules/extra/Highlight.mjs","../../modules/extra/Markdown.mjs","../../modules/extra/Monaco.mjs"],"sourcesContent":["/*\r\n * Copyright (C) 2015, 202$ Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSVersion class\r\n * @module base/GSVersion\r\n */\r\n\r\n/**\r\n * A class with library version / build\r\n * @class\r\n */\r\nexport class GSVersion {\r\n\r\n    get version() {\r\n        return '2.0.0';\r\n    }\r\n\r\n    get build() {\r\n        return 20241227;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Required CSS Styles for WebCompoents, regardless Bootstrap CSS.\r\n */\r\nexport const gsstyles = `.z-10k{z-index:10000 !important;}\r\n.gs-hide,gs-item{display:none !important;}\r\ngs-popover,gs-tooltip{position:fixed;top:0px;left:0px;},\r\n.d-contents{display:contents;}';\r\ngs-button-group::part(.btn-group){box-shadow:rgba(72, 72, 72, 0.4) 0px 0.125rem 0.25rem;}\r\ngs-group>gs-button::part(button) {box-shadow: none;}\r\ngs-group>gs-button:not(:last-child)::part(button) {border-top-right-radius: 0;border-bottom-right-radius: 0;}\r\ngs-group>gs-button:not(:first-child)::part(button) {margin-left: calc(var(--bs-border-width) * -5);border-top-left-radius: 0;border-bottom-left-radius: 0;}\r\ngs-layout {width: 100%;height: 100%;}\r\ngs-split-panel{flex: 1 1 auto !important;}\r\ninput[is=\"gs-ext-input\"][type=\"date\"]:before {content: attr(data-value);}\r\ninput[is=\"gs-ext-input\"][type=\"date\"]::-webkit-datetime-edit, input::-webkit-inner-spin-button, input::-webkit-clear-button {visibility: hidden;display: inline-block;}\r\ninput[is=\"gs-ext-input\"][type=\"date\"]::-webkit-calendar-picker-indicator {position: relative;top: 0px;right: 0;color: black;opacity: 0.5;}\r\n`;","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSLog class\r\n * @module base/GSLog\r\n */\r\n\r\n/** \r\n * Internal logging mechanism\r\n * @Class\r\n */\r\nexport class GSLog {\r\n\r\n\t/**\r\n\t * static flag is loging enabled or disabled\r\n\t */\r\n\tstatic logging = true;\r\n\tstatic tracing = false;\r\n\r\n\t/**\r\n\t * Log info message\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} msg \r\n\t */\r\n\tstatic info(el, msg) {\r\n\t\tthis.#print(el, msg, true, 'info');\r\n\t}\r\n\r\n\t/**\r\n\t * Log warn message\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} msg \r\n\t */\r\n\tstatic warn(el, msg) {\r\n\t\tthis.#print(el, msg, true, 'warn');\r\n\t}\r\n\r\n\t/**\r\n\t * Log error message\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} msg \r\n\t */\r\n\tstatic error(el, msg) {\r\n\t\tthis.#print(el, msg, true, 'error');\r\n\t}\r\n\r\n\t/**\r\n\t * Debug messages only if tracing flag enabled\r\n\t * @param {*} el \r\n\t * @param {*} msg \r\n\t */\r\n\tstatic trace(el, msg) {\r\n\t\tif (GSLog.tracing) this.#print(el, msg, false, 'error');\r\n\t}\r\n\r\n\t/**\r\n\t * Generic logging function\r\n\t * @param {HTMLElement} el Element to log (optional)\r\n\t * @param {String} msg Message to log\r\n\t * @param {Boolean} forced - when logging disabled globaly, use this to force logging\r\n\t */\r\n\tstatic log(el, msg, forced) {\r\n\t\tthis.#print(el, msg, forced);\r\n\t}\r\n\r\n\tstatic #print(el, msg, forced, type) {\r\n\t\tif (!(forced || this.logging)) return;\r\n\t\tconst tmp = el ? `${el.nodeName} -> ${el.id}: ${msg}` : msg;\r\n\t\tlet fn = console[type || 'log'];\r\n\t\tfn = typeof fn === 'function' ? fn : console.log;\r\n\t\tfn(tmp);\r\n\t\tif (msg instanceof Error) fn(msg);\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.seal(GSLog);\r\n\t}\r\n}\r\n\r\n\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSUtil class\r\n * @module base/GSUtil\r\n */\r\n\r\nimport { GSLog } from \"./GSLog.mjs\";\r\n\r\n/**\r\n * A generic set of static functions used across GS WebComponents framework\r\n * @class\r\n */\r\nexport class GSUtil {\r\n\r\n\tstatic FLAT = globalThis.GS_FLAT == true;\r\n\tstatic ALPHANUM = /^[a-zA-Z0-9-_]+$/;\r\n\tstatic #JSON_NORMALIZE = /(['\"])?([a-z0-9A-Z_]+)(['\"])?\\s*:/g;\r\n\r\n\tstatic isNumber = (n) => { return !isNaN(parseFloat(n)) && isFinite(n); };\r\n\r\n\tstatic isDate = (v) => { return v instanceof Date };\r\n\r\n\tstatic isBool = (v) => { return typeof v === 'boolean' || v instanceof Boolean };\r\n\r\n\tstatic isString = value => typeof value === 'string';\r\n\r\n\tstatic isNull = value => value === null || value === undefined;\r\n\r\n\tstatic toBinary = (value = 0) => value.toString(2);\r\n\r\n\tstatic asBool = (val = false) => val?.toString().trim().toLowerCase() === 'true';\r\n\r\n\tstatic fromLiteral = (str = '', obj) => str.replace(/\\${(.*?)}/g, (x, g) => obj[g]);\r\n\r\n\tstatic reverse = (str) => (str || \"\").split(\"\").reverse().join(\"\");\r\n\r\n\tstatic capitalize = (word = '') => word ? word[0].toUpperCase() + word.slice(1).toLowerCase() : '';\r\n\r\n\tstatic capitalizeAll = (word = '', split = ' ') => word.split(split).map((v, i) => GSUtil.capitalize(v)).join(split);\r\n\r\n\tstatic capitalizeAttr = (word = '') => word.split('-').map((v, i) => i ? GSUtil.capitalize(v) : v).join('');\r\n\r\n\tstatic initerror = () => { throw new Error('This class cannot be instantiated') };\r\n\r\n\tstatic isInstance = (el) => el instanceof el.constructor;\r\n\r\n\tstatic range = (val = 0, min = 10, max = 100) => (Math.max(Math.min(max, val), min));\r\n\r\n\tstatic extractNumber = (val = '') => val.match(/[\\d,\\.]*\\d/)?.[0];\r\n\r\n\tstatic asNum(val, dft = 0, locale) {\r\n\t\tlocale = locale || GSUtil.locale;\r\n\t\tif (GSUtil.isString(val)) {\r\n\t\t\tconst sep = GSUtil.numberSeparator(locale);\r\n\t\t\tval = GSUtil.extractNumber(val)?.replaceAll(sep, '') || val;\r\n\t\t}\r\n\t\treturn GSUtil.isNumber(val) ? parseFloat(val) : dft;\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Validate string for url format\r\n\t * @param {String} url \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isURL = (url = '') => /^(https?:\\/\\/|\\/{1,2}|\\.\\/{1})(\\S*\\/*){1,}/i.test(url.trim());\r\n\r\n\tstatic isHTML = (val = '') => val.trim().startsWith('<') && val.trim().endsWith('>');\r\n\r\n\t/**\r\n\t * Generate random set of characters\r\n\t * @param {String} pattern \r\n\t * @param {String} charset \r\n\t * @returns {String}\r\n\t */\r\n\tstatic generateUUID = (pattern = \"xxxx-xxxx-xxxx-xxxx-xxxx\", charset = \"abcdef0123456789\") => pattern.replace(/[x]/g, () => charset[Math.floor(Math.random() * charset.length)]);\r\n\r\n\t/**\r\n\t * Get browser default locale\r\n\t * @returns {String}\r\n\t */\r\n\tstatic get locale() {\r\n\t\treturn navigator.language ? navigator.language : navigator.languages[0];\r\n\t}\r\n\r\n\t/**\r\n\t * Convert string to regex isntance\r\n\t * @param {*} val \r\n\t * @param {*} flags \r\n\t * @returns \r\n\t */\r\n\tstatic toRegex(val, flags) {\r\n\t\tif (val instanceof RegExp) return val;\r\n\t\treturn GSUtil.isStringEmpty(val) ? undefined : new RegExp(val, flags);\r\n\t}\r\n\r\n\t/**\r\n\t * Find number separator for given locale\r\n\t * @param {string} locale \r\n\t * @returns \r\n\t */\r\n\tstatic decimalSeparator(locale) {\r\n\t\treturn Intl.NumberFormat(locale).format(1.1)[1];\r\n\t}\r\n\r\n\t/**\r\n\t * Find decimal separator for given locale\r\n\t * @param {string} locale \r\n\t * @returns \r\n\t */\r\n\tstatic numberSeparator(locale) {\r\n\t\treturn Intl.NumberFormat(locale).format(1000)[1];\r\n\t}\r\n\r\n\t/**\r\n\t * Try to find data format based on locale\r\n\t * @param {string} locale \r\n\t * @returns \r\n\t */\r\n\tstatic getDateFormat(locale = undefined) {\r\n\t\tconst formatted = new Intl.DateTimeFormat(locale).format(new Date(2000, 0, 2));\r\n\t\treturn formatted\r\n\t\t\t.replace('2000', 'YYYY')\r\n\t\t\t.replace('01', 'MM')\r\n\t\t\t.replace('1', 'M')\r\n\t\t\t.replace('02', 'DD')\r\n\t\t\t.replace('2', 'D');\r\n\t}\r\n\r\n\t/**\r\n\t * Sanitize text for HTML generation\r\n\t * @param {string} string \r\n\t * @returns \r\n\t */\r\n\tstatic sanitize(string = '') {\r\n\t\tconst map = {\r\n\t\t\t'&': '&amp;',\r\n\t\t\t'<': '&lt;',\r\n\t\t\t'>': '&gt;',\r\n\t\t\t'\"': '&quot;',\r\n\t\t\t\"'\": '&#x27;',\r\n\t\t\t\"/\": '&#x2F;',\r\n\t\t};\r\n\t\tconst reg = /[&<>\"'/]/ig;\r\n\t\treturn string.replace(reg, (match) => (map[match]));\r\n\t}\r\n\t\t\r\n\tstatic isJsonString(val = '') {\r\n\t\treturn typeof val == 'string' && (val.startsWith('{') || val.startsWith('['));\r\n\t}\r\n\r\n\t/**\r\n\t * Check if provided parameter is of JSON type\r\n\t * @param {String|object} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isJsonType(val = '') {\r\n\t\treturn !GSUtil.isNull(val) && (Array.isArray(val) || typeof val == \"object\");\r\n\t}\r\n\r\n\t/**\r\n\t * Check if provided paramter is JSON\r\n\t * @param {String|object} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isJson(val = '') {\r\n\t\treturn GSUtil.isJsonString(val) || GSUtil.isJsonType(val);\r\n\t}\r\n\r\n\t/**\r\n\t * Convert provided paramter to JSON\r\n\t * @param {String|object} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic toJson(val = '', dft = {}, normalize = true) {\r\n\t\tif (GSUtil.isJsonString(val)) return JSON.parse(normalize ? GSUtil.normalizeJson(val) : val);\r\n\t\tif (GSUtil.isJsonType(val)) return val;\r\n\t\tif (val) GSLog.warn(null, `Invalid data to convert into JSON: ${val}`);\r\n\t\treturn dft;\r\n\t}\r\n\r\n\t/**\r\n\t * Normalize unquoted JSON\r\n\t * @param {String} val \r\n\t * @returns {String}\r\n\t */\r\n\tstatic normalizeJson(val = '') {\r\n\t\treturn val?.replace(GSUtil.#JSON_NORMALIZE, '\"$2\": ');\r\n\t}\r\n\r\n\t/**\r\n\t * Makes string value safe, always return value\r\n\t * @param {String|object} val \r\n\t * @returns {String}\r\n\t */\r\n\tstatic normalize(val, def = '') {\r\n\t\treturn (val ?? def).toString().trim();\r\n\t}\r\n\r\n\t/**\r\n\t * Convert string separated values into an array\r\n\t * @param {String} val \r\n\t * @param {String} separator \r\n\t * @returns {Array<String>}\r\n\t */\r\n\tstatic toStringArray(val = '', separator = ' ') {\r\n\t\treturn val.split(separator).map(v => v.trim()).filter(v => v.length > 0);\r\n\t}\r\n\r\n\t/**\r\n\t * Transform text based on CSS text attribute format\r\n\t * @param {String} format \r\n\t * @param {String} value \r\n\t * @returns {String}\r\n\t */\r\n\tstatic textTransform(format = '', value = '') {\r\n\t\tswitch (format) {\r\n\t\t\tcase 'lowercase':\r\n\t\t\t\tvalue = value.toLowerCase();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'uppercase':\r\n\t\t\t\tvalue = value.toUpperCase();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'capitalize':\r\n\t\t\t\tvalue = GSUtil.capitalizeAll(value);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert parameterized string literal as template to string \r\n\t * \r\n\t * \t const template = 'Example text: ${text}';\r\n\t *   const result = interpolate(template, {text: 'Foo Boo'});\r\n\t * \r\n\t * @param {String} tpl \r\n\t * @param {Object} params \r\n\t * @returns {function}\r\n\t */\r\n\tstatic fromTemplateLiteral(tpl, params) {\r\n\t\tconst names = Object.keys(params);\r\n\t\tconst vals = Object.values(params);\r\n\t\treturn new Function(...names, `return \\`${tpl}\\`;`)(...vals);\r\n\t}\r\n\r\n\t/**\r\n\t * Decode HTML entities (&nbsp; &laquot; etc...)\r\n\t * @param {string} text \r\n\t * @returns {string}\r\n\t */\r\n\tstatic decodeHTMLEntities(text) {\r\n\t\tconst textArea = document.createElement('textarea');\r\n\t\ttextArea.innerHTML = text;\r\n\t\treturn textArea.value;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert string pointer to object\r\n\t * @param {String} value \r\n\t * @returns {*}\r\n\t */\r\n\tstatic parseValue(value) {\r\n\t\tif (!GSUtil.isString(value)) return;\r\n\t\tif (!GSUtil.isStringNonEmpty(value)) return;\r\n\t\tlet o = window;\r\n\t\tlet fn = null;\r\n\t\tvalue.trim().split('.').forEach((v, i, a) => {\r\n\t\t\tif (!o) return;\r\n\t\t\tif (i < a.length - 1) {\r\n\t\t\t\treturn o = o[v];\r\n\t\t\t}\r\n\t\t\tfn = o[v];\r\n\t\t});\r\n\t\treturn fn;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if strings has data\r\n\t * \r\n\t * @param {String} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isStringNonEmpty(val = '') {\r\n\t\treturn !GSUtil.isStringEmpty(val);\r\n\t}\r\n\r\n\t/**\r\n\t * Check if strings is empty\r\n\t * \r\n\t * @param {String} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isStringEmpty(val = '') {\r\n\t\treturn GSUtil.normalize(val).trim().length === 0;\r\n\t}\r\n\r\n\t/**\r\n\t * match two strings, or first is not set\r\n\t * \r\n\t * @param {String} left \r\n\t * @param {String} right \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isStringMatch(left, right) {\r\n\t\tconst lmatch = GSUtil.isStringNonEmpty(left);\r\n\t\tconst rmatch = GSUtil.isStringNonEmpty(right);\r\n\t\tif (lmatch && rmatch) {\r\n\t\t\treturn left.trim().toLowerCase() == right.trim().toLowerCase();\r\n\t\t}\r\n\t\treturn lmatch === rmatch;\r\n\t}\r\n\r\n\t/**\r\n\t * Async version of timeout\r\n\t * \r\n\t * @async\r\n\t * @param {Number} time \r\n\t * @param {number|AbortSignal} signal Abort object\r\n\t * @returns {Promise<void>}\r\n\t */\r\n\tstatic async timeout(time = 0, signal) {\r\n\t\tsignal = GSUtil.isNumber(signal) ? AbortSignal.timeout(signal) : signal;\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tconst iid = setTimeout(resolve.bind(null, true), time);\r\n\t\t\tif (signal instanceof AbortSignal) {\r\n\t\t\t\tsignal.addEventListener('abort', () => {\r\n\t\t\t\t\tclearTimeout(iid);\r\n\t\t\t\t\treject(new Error('aborted timeout'));\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Download provided data\r\n\t * \r\n\t * @async\r\n\t * @param {Array} data \r\n\t * @param {String} name File name\r\n\t * @param {String} type Mime type, default octet/stream\r\n\t */\r\n\tstatic async export(data, name, type = 'octet/stream') {\r\n\r\n\t\tconst blob = new Blob(data, { type: type });\r\n\t\tconst url = URL.createObjectURL(blob);\r\n\t\ttry {\r\n\t\t\tconst a = document.createElement(\"a\");\r\n\t\t\ta.href = url;\r\n\t\t\ta.download = name;\r\n\t\t\ta.click();\r\n\r\n\t\t\tawait GSUtil.timeout(2000);\r\n\r\n\t\t} finally {\r\n\t\t\tURL.revokeObjectURL(url);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Registration helper function, replacement for class static initializers\r\n\t * Mostly to support Safari browser.\r\n\t * \r\n\t * GSUtil.register(null, GSUtil, null, true, false, true);\r\n\t * \r\n\t * @param {String} name Custom element name\r\n\t * @param {HTMLElement} clazz Class extensing at least HTMLElement\r\n\t * @param {String} ext If existing tag extended, this is tagName\r\n\t * @param {Boolean} seal Should class be sealed\r\n\t * @param {Boolean} freeze Should class be freezed\r\n\t * @param {Boolean} expose Should class be exposed to \"self\"\r\n\t * \r\n\t * @returns {void}\r\n\t */\r\n\tstatic register(name, clazz, ext, seal = true, freeze = false, expose = false) {\r\n\t\tif (!HTMLElement.isPrototypeOf(clazz)) return;\r\n\t\tif (customElements.get(name)) return;\r\n\t\tcustomElements.define(name, clazz, { extends: ext?.toLowerCase() });\r\n\t\tif (seal && !Object.isSealed(clazz)) Object.seal(clazz);\r\n\t\tif (freeze && !Object.isFrozen(clazz)) Object.freeze(clazz);\r\n\t\tif (expose) self[clazz.name] = clazz;\r\n\t}\r\n\r\n\t/**\r\n\t * Import and initialize source in JavaScript modules\r\n\t * Standard eval or new Function can not be used\r\n\t * @param {String} src \r\n\t * @returns {*}\r\n\t */\r\n\tstatic async importSource(src) {\r\n\t\tconst blob = new Blob([src], { type: \"text/javascript\" });\r\n\t\tconst url = URL.createObjectURL(blob);\r\n\t\ttry {\r\n\t\t\treturn await import(url);\r\n\t\t} finally {\r\n\t\t\tURL.revokeObjectURL(url);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Use Clipboard API to write to the clipboard\r\n\t * @returns \r\n\t */\r\n\tstatic async writeToClipboard(value = '') {\r\n\t\tconst result = await navigator.permissions.query({ name: \"clipboard-write\" })\r\n\t\tif (result.state === \"granted\" || result.state === \"prompt\") {\r\n\t\t   return navigator.clipboard.writeText(value);\r\n\t\t}\r\n\t\treturn '';\r\n\t}\r\n\r\n\t/**\r\n\t * Use Clipboard API to read from the clipboard\r\n\t * @returns \r\n\t */\r\n\tstatic async readFromClipboard() {\r\n\t\tconst result = await navigator.permissions.query({ name: \"clipboard-read\" })\r\n\t\tif (result.state === \"granted\" || result.state === \"prompt\") {\r\n\t\t   return navigator.clipboard.readText();\r\n\t\t}\r\n\t\treturn '';\r\n\t}\t\r\n\r\n\tstatic {\r\n\t\tObject.seal(GSUtil);\r\n\t\tglobalThis.GSUtil = GSUtil;\r\n\t}\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSFunction class\r\n * @module base/GSFunction\r\n */\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A set of static functions used for processing functions\r\n * @class\r\n */\r\nexport class GSFunction {\r\n\r\n    /**\r\n     * Check if object is of type function\r\n     * \r\n     * @param {function} fn \r\n     * @returns {Boolean}\r\n     */\r\n    static isFunction = (fn) => typeof fn === 'function';\r\n\r\n    static isFunctionNative(fn) {\r\n        return GSFunction.isFunction(fn) && fn.toString().includes('native code');\r\n    }\r\n\r\n    /**\r\n     * Check if object has function\r\n     * \r\n     * @param {Object} o \r\n     * @param {function} fn \r\n     * @returns {Boolean}\r\n     */\r\n    static hasFunction(o, fn) {\r\n        return o && GSFunction.isFunction(o[fn]);\r\n    }\r\n\r\n    /**\r\n     * Check if class has defined getter\r\n     * @param {*} own \r\n     * @param {*} name \r\n     * @returns \r\n     */\r\n    static hasGetter(own, name) {\r\n        return GSFunction.isFunctionDefined(own, name, 'get');\r\n    }\r\n\r\n    /**\r\n     * * Check if class has defined setter\r\n     * @param {*} own \r\n     * @param {*} name \r\n     * @returns \r\n     */\r\n    static hasSetter(own, name) {\r\n        return GSFunction.isFunctionDefined(own, name, 'set');\r\n    }\r\n\r\n    /**\r\n     * Check if class instance has defined function\r\n     * @param {object} own Class instance\r\n     * @param {string} name Function name to check\r\n     * @param {string} fn Function name to check\r\n     * @returns {boolean} Returns true if getter exist\r\n     */\r\n    static isFunctionDefined(own, name, fn) {\r\n        const desc = own ? Reflect.getOwnPropertyDescriptor(own.__proto__, name) : false;\r\n        return desc && typeof desc[fn] === 'function';\r\n    }\r\n\r\n    /**\r\n     * Check if object is of type async function\r\n     * \r\n     * @param {function} fn \r\n     * @returns  {Boolean}\r\n     */\r\n    static isFunctionAsync(fn) {\r\n        if (!GSFunction.isFunction(fn)) return false;\r\n        const AsyncFunction = GSFunction.callFunctionAsync.constructor\r\n        let isValid = fn instanceof AsyncFunction;\r\n        if (!isValid) isValid = fn[Symbol.toStringTag] == \"AsyncFunction\";\r\n        return isValid;\r\n    }\r\n\r\n    /**\r\n     * Generic asynchronous function caller\r\n     * \r\n     * @async\r\n     * @param {function} fn \r\n     * @param {Object} owner \r\n     * @returns  {Promise}\r\n     * @throws {Error} \r\n     */\r\n    static async callFunctionAsync(fn, owner) {\r\n        const args = arguments ? Array.from(arguments).slice(2) : [];\r\n        return await fn.apply(owner || null, args);\r\n    }\r\n\r\n    /**\r\n     * Generic synchronous function caller\r\n     * \r\n     * @param {function} fn \r\n     * @param {Object} owner \r\n     * @returns {Object}\r\n     * @throws {Error}\r\n     */\r\n    static callFunctionSync(fn, owner) {\r\n        const args = arguments ? Array.from(arguments).slice(2) : [];\r\n        return fn.apply(owner || null, args);\r\n    }\r\n\r\n    /**\r\n     * Generic function caller\r\n     * \r\n     * @param {function} fn \r\n     * @param {Object} owner \r\n     * @returns {Object}\r\n     */\r\n    static async callFunction(fn, owner, native = true) {\r\n        fn = GSUtil.isString(fn) ? GSFunction.parseFunction(fn) : fn;\r\n        if (!GSFunction.isFunction(fn)) return;\r\n        if (!native && GSFunction.isFunctionNative(fn)) return;\r\n        const args = arguments ? Array.from(arguments).slice(3) : [];\r\n        if (GSFunction.isFunctionAsync(fn)) {\r\n            return await GSFunction.callFunctionAsync(fn, owner, ...args);\r\n        }\r\n        return GSFunction.callFunctionSync(fn, owner, ...args);\r\n    }\r\n\r\n    /**\r\n     * Convert string pointer to function call\r\n     * \r\n     * @param {String} value \r\n     * @returns  {function}\r\n     */\r\n    static parseFunction(value) {\r\n        const fn = GSUtil.parseValue(value);\r\n        return GSFunction.isFunction(fn) ? fn : null;\r\n    }\r\n\r\n    static async #contextualize(fn, context, args) {\r\n        if (!GSFunction.isFunction(fn)) return;\r\n        const isAsync = GSFunction.isFunctionAsync(fn);\r\n        if (isAsync) {\r\n            return await fn.apply(context, args);\r\n        } else {\r\n            return fn.apply(context, args);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Wrap function into a single call - loop first call executed\r\n     * @param {function} fn Function to be called\r\n     * @param {*} context Instance at which to call the function\r\n     * @returns {*} Function result\r\n     */\r\n    static callOnceFifo(fn, context) {\r\n        let cnt = false;\r\n        return async (...args) => {\r\n            if (cnt) return;\r\n            cnt = true;\r\n            const own = context || this;\r\n            return await GSFunction.#contextualize(fn, own, args);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Wrap function into a single call - loop last call executed\r\n     * @param {function} fn Function to be called\r\n     * @param {*} context Instance at which to call the function\r\n     * @returns {*} Function result\r\n     */\r\n    static callOnceLifo(fn, context) {\r\n        let cnt = 0;\r\n        return (...args) => {\r\n            if (cnt < 0) return;\r\n            cnt++;\r\n            const own = context || this;\r\n            return new Promise((accept, reject) => {\r\n                queueMicrotask(async () => {\r\n                    if (cnt <= 0) return;\r\n                    cnt--;\r\n                    if (cnt !== 0) return;\r\n                    try {\r\n                        const o = await GSFunction.#contextualize(fn, own, args);\r\n                        accept(o);\r\n                    } catch (e) {\r\n                        reject(e);\r\n                    } finally {\r\n                        cnt = -1;\r\n                    }\r\n                });\r\n            });\r\n        }\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSFunction);\r\n        globalThis.GSFunction = GSFunction;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSID class\r\n * @module base/GSID\r\n */\r\n\r\n/**\r\n * Generic unique ID generator for element\r\n * @class\r\n */\r\nexport class GSID {\r\n\r\n\tstatic #id = 0;\r\n\r\n\t/**\r\n\t * Reset ID counter to 0\r\n\t */\r\n\tstatic reset() {\r\n\t\tthis.#id = 0;\r\n\t}\r\n\r\n\t/**\r\n\t * Get next unique generated ID\r\n\t * @param {*} prefx Value to prepend to ID counter\r\n\t * @returns {String} A generated ID\r\n\t */\r\n\tstatic next(prefx = 'GSId-') {\r\n\t\treturn `${prefx}${this.#id++}`;\r\n\t}\r\n\r\n\t/**\r\n\t * Auto generate next ID\r\n\t * @returns {String} A generated ID\r\n\t */\r\n\tstatic get id() {\r\n\t\treturn this.next();\r\n\t}\r\n\r\n\t/**\r\n\t * Calculate hashcode from string (Java compatible)\r\n\t * @param {*} s A text fro mwhich hashcode is calculated \r\n\t * @returns {Number} Generated numeric hashcode\r\n\t */\r\n\tstatic hashCode(s) {\r\n\t\tconst l = (s || '').length;\r\n\t\tlet h = 0, i = 0;\r\n\t\tif (l === 0) return h;\r\n\t\twhile (i < l) {\r\n\t\t\th = (h << 5) - h + s.charCodeAt(i++) | 0;\r\n\t\t}\r\n\t\treturn h;\r\n\t}\r\n\r\n\t/**\r\n\t * Set element id if not set already\r\n\t * @param {HTMLElement} el \r\n\t */\r\n\tstatic setIf(el) {\r\n\t\tif (el) {\r\n\t\t\tel.id = typeof el.id !== 'string' ? GSID.id : el.id || GSID.id;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.freeze(GSID);\r\n\t}\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A module loading GSAttr class\r\n * @module base/GSAttr\r\n */\r\n\r\n/**\r\n * A generic set of static functions to handle DOM Attributes\r\n * @class\r\n */\r\nexport class GSAttr {\r\n\r\n\t/**\r\n\t * Check if given element is of type HTMLElement\r\n\t * NOTE: GSDOM.isHTMLElement duplicate - prevent circular import\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isHTMLElement(el) {\r\n\t\treturn el instanceof HTMLElement;\r\n\t}\r\n\r\n\t/**\r\n\t  * Generic function to change element node attribute\r\n\t  * \r\n\t  * @param {HTMLElement} el Target to receive attribute value\r\n\t  * @param {String} name Attribite name\r\n\t  * @param {Boolean} val Attribute value\r\n\t  */\r\n\tstatic toggle(el, name, val = false) {\r\n\t\tif (!GSAttr.isHTMLElement(el)) return;\r\n\t\tif (val) {\r\n\t\t\tel.setAttribute(name, '');\r\n\t\t} else {\r\n\t\t\tel.removeAttribute(name);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Generic function to change elment node attribute\r\n\t * \r\n\t * @param {HTMLElement} el Target to receive attribute value\r\n\t * @param {String} name Attribite name\r\n\t * @param {String} val Attribute value\r\n\t */\r\n\tstatic set(el, name, val) {\r\n\t\tif (!GSAttr.isHTMLElement(el)) return;\r\n\t\tif (GSUtil.normalize(val)) {\r\n\t\t\tel.setAttribute(name, val);\r\n\t\t} else {\r\n\t\t\tel.removeAttribute(name);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Generic function to get element node attribute\r\n\t * \r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {String} val Default value\r\n\t * @returns {String}\r\n\t */\r\n\tstatic get(el, name = '', val = '') {\r\n\t\tif (!GSAttr.isHTMLElement(el)) return val;\r\n\t\tif (!GSUtil.isInstance(el)) return undefined;\r\n\t\tconst v = el.getAttribute(name) || val;\r\n\t\treturn GSUtil.normalize(v);\r\n\t}\r\n\r\n\t/**\r\n\t * Get attribute as boolean type\r\n\t * \r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {String} val Default value\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic getAsBool(el, name = '', val = 'false') {\r\n\t\tconst attr = GSAttr.get(el, name, val);\r\n\t\treturn GSUtil.asBool(attr, val);\r\n\t}\r\n\r\n\t/**\r\n\t * Get attribute as numberic type\r\n\t * \r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {String} val Default value\r\n\t * @returns {Number}\r\n\t */\r\n\tstatic getAsNum(el, name = '', val = '0') {\r\n\t\tconst attr = GSAttr.get(el, name, val);\r\n\t\treturn GSUtil.asNum(attr, val);\r\n\t}\r\n\r\n\t/**\r\n\t * Get attribute as JSON object type\r\n\t * \r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {String} val Default value\r\n\t * @returns {JSON}\r\n\t */\r\n\tstatic getAsJson(el, name = '', val = '0') {\r\n\t\tconst attr = GSAttr.get(el, name, val, {});\r\n\t\treturn GSUtil.toJson(attr);\r\n\t}\r\n\r\n\t/**\r\n\t * Store data into attribute as boolean\r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {Boolean} val Default value\r\n\t */\r\n\tstatic setAsBool(el, name = '', val = 'false') {\r\n\t\tGSAttr.set(el, name, GSUtil.asBool(val), false);\r\n\t\t/*\r\n\t\tif (!GSAttr.isHTMLElement(el)) return;\r\n\t\tel.toggleAttribute(name, GSUtil.asBool(val));\r\n\t\t*/\r\n\t}\r\n\r\n\t/**\r\n\t * Store data into attribute as numeric\r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {Number} val Default value\r\n\t */\r\n\tstatic setAsNum(el, name = '', val = '0') {\r\n\t\tGSAttr.set(el, name, GSUtil.asNum(val), NaN);\r\n\t}\r\n\r\n\t/**\r\n\t * Store data into attribute as JSON string\r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {string val Default value\r\n\t */\r\n\tstatic setAsJson(el, name = '', val = '0') {\r\n\t\tGSAttr.set(el, name, JSON.stringify(val), '{}');\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON object to attribute string \r\n\t * @param {*} obj \r\n\t * @returns {String}\r\n\t */\r\n\tstatic flattenJson(obj) {\r\n\t\treturn Object.entries(obj || {}).map(kv => `${kv[0]}=${kv[1]}`).join(' ');\r\n\t}\r\n\r\n\t/**\r\n\t * Apply JSON object to element attributes\r\n\t * @param {*} obj \r\n\t */\r\n\tstatic jsonToAttr(obj, el) {\r\n\t\tif (!GSAttr.isHTMLElement(el)) return;\r\n\t\tObject.entries(obj || {}).map(kv => GSAttr.set(el, kv[0], kv[1]));\r\n\t}\r\n\r\n\t/**\r\n\t * Convert list of data attributes into a string list\r\n\t * @param {HTMLElement} el \r\n\t * @returns {String}\r\n\t */\r\n\tstatic dataToString(el) {\r\n\t\treturn Array.from(el.attributes)\r\n\t\t\t.filter(v => v.name.startsWith('data-'))\r\n\t\t\t.map(v => `${v.name}=\"${v.value}\"`)\r\n\t\t\t.join(' ');\r\n\t}\r\n\r\n\t/**\r\n\t * Convert list of element attributes into a flat list separated by given separator (default ' ')\r\n\t * @param {HTMLMediaElement} el \r\n\t * @param {String} sep \r\n\t * @returns {String}\r\n\t */\r\n\tstatic flatten(el, sep = ' ') {\r\n\t\treturn Array.from(el?.attributes || []).map(a => `${a.name}=\"${a.value}\"`).join(sep);\r\n\t}\r\n\r\n\t/**\r\n\t * Generic attribute retriever \r\n\t * opt format { prop: {type:Number, attribute: 'alt-prop-name'}}\r\n\t * @returns {Proxy}\r\n\t */\r\n\tstatic proxify(host, opt = {}, recursive = 'items') {\r\n\r\n\t\tconst instance = new Proxy(host, {\r\n\t\t\t\r\n\t\t\tset(target, prop, value) {\r\n\t\t\t\t\r\n\t\t\t\tif (prop === 'self') return;\r\n\t\t\t\tif (prop === 'dataset') return target.dataset = value;\r\n\r\n\t\t\t\tconst type = opt[prop]?.type;\r\n\t\t\t\tprop = opt[prop]?.attribute || prop;\r\n\t\t\t\t\r\n\t\t\t\tswitch(type) {\r\n\t\t\t\t\tcase Boolean :\r\n\t\t\t\t\t\tGSAttr.toggle(target, prop,  GSUtil.asBool(value));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase Number :\r\n\t\t\t\t\t\tGSAttr.setAsNum(target, prop, value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase Object :\r\n\t\t\t\t\tcase Array :\r\n\t\t\t\t\t\tGSAttr.set(target, prop, JSON.stringify(value));\r\n\t\t\t\t\tdefault:\t\t\t\t\t\r\n\t\t\t\t\t\tGSAttr.set(target, prop, value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\r\n\t\t\tget(target, prop) {\r\n\t\t\t\t\r\n\t\t\t\tif (prop === 'self') return target;\r\n\t\t\t\tif (prop === 'dataset') return target.dataset;\r\n\t\t\t\tif (typeof prop === 'symbol') return target[prop];\r\n\t\t\t\tif (prop === recursive) return Array.from(target.children).map(el => GSAttr.proxify(el, opt, recursive)); \r\n\r\n\r\n\t\t\t\tconst type = opt[prop]?.type;\r\n\t\t\t\tconst safe = opt[prop]?.unsafe ? true : false;\r\n\t\t\t\tconst dflt = opt[prop]?.default;\r\n\t\t\t\tconst multi = opt[prop]?.multi === true;\r\n\t\t\t\t\r\n\t\t\t\tprop = opt[prop]?.attribute || prop;\r\n\t\t\t\tlet val = GSAttr.get(target, prop);\r\n\t\t\t\t\r\n\t\t\t\tswitch(type) {\r\n\t\t\t\t\tcase Boolean :\r\n\t\t\t\t\t\treturn target.hasAttribute(prop);\r\n\t\t\t\t\tcase Number :\r\n\t\t\t\t\t\treturn GSUtil.asNum(val, 0);\r\n\t\t\t\t\tcase Object :\r\n\t\t\t\t\t\treturn GSUtil.toJson(val, {});\r\n\t\t\t\t\tcase Array :\r\n\t\t\t\t\t\treturn GSUtil.toJson(val, []);\r\n\t\t\t\t\tdefault:\t\t\t\t\t\r\n\t\t\t\t\t\tval = safe ? (val || dflt || '') : (val || dflt || undefined);\r\n\t\t\t\t\t\treturn multi ? GSUtil.toStringArray(val) : val;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\treturn instance;\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.seal(GSAttr);\r\n\t\tglobalThis.GSAttr = GSAttr;\r\n\t}\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\n\r\n/**\r\n * A module loading GSCSSMap class\r\n * @module base/GSCSSMap\r\n */\r\n\r\n/**\r\n * Wrapper around computesdStyledMap to support Firefox and WebKit Mode\r\n * @class\r\n */\r\nexport class GSCSSMap {\r\n\r\n    static #modern = globalThis.document?.body?.computedStyleMap ? true : false;\r\n\r\n    #map;\r\n\r\n    constructor(element) {\r\n        const me = this;\r\n        me.#map = GSCSSMap.#getMap(element);\r\n    }\r\n\r\n    get(name) {\r\n        const me = this;\r\n        if (!me.#map) return undefined;\r\n        return GSCSSMap.#modern ? me.#map.get(name) : me.#map[GSUtil.capitalizeAttr(name)];\r\n    }\r\n\r\n    asText(name) {\r\n        return (this.get(name) || '')?.toString();\r\n    }\r\n\r\n    asBool(name) {\r\n        const val = this.get(name);\r\n        return GSUtil.asBool(GSCSSMap.#modern ? val?.value : val);\r\n    }\r\n\r\n    asNum(name) {\r\n        let val = this.get(name);\r\n        if (GSCSSMap.#modern && GSFunction.isFunction(val?.to)) {\r\n            if (val.unit !== 'number') val = val.to('px');\r\n        }\r\n        return GSUtil.asNum(GSCSSMap.#modern ? val?.value : val.match(/\\d*(\\.\\d*)?/g).filter(v => GSUtil.isNumber(v)).shift());\r\n    }\r\n\r\n    matches(name, value) {\r\n        return this.asText(name) == value;\r\n    }\r\n\r\n    /**\r\n     * Support for Firefox/Gecko to get element computedStyledMap\r\n     * @param {HTMLElement} el \r\n     * @returns {CSSStyleDeclaration}\r\n     */\r\n    static #getMap(el) {\r\n        if (GSCSSMap.#modern) return el.computedStyleMap();\r\n        if (globalThis.window?.getComputedStyle) return globalThis.window.getComputedStyle(el);\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Support for Firefox/Gecko to get element computedStyledMap item\r\n     * @param {HTMLElement} el \r\n     * @returns {}\r\n     */\r\n    static styleValue(el, name) {\r\n        return GSCSSMap.getComputedStyledMap(el).get(name);\r\n    }\r\n\r\n    /**\r\n     * Support for Firefox/Gecko to get element computedStyledMap\r\n     * @param {HTMLElement} element \r\n     * @returns {GSCSSMap}\r\n     */\r\n    static getComputedStyledMap(element) {\r\n        return new GSCSSMap(element);\r\n    }\r\n\r\n    static #normalize(str) {\r\n        if (!str) return '';\r\n        str = String(str).replace(/\\s*([>~+])\\s*/g, ' $1 ');\r\n        return str.replace(/(\\s+)/g, ' ').trim();\r\n    }\r\n\r\n    static #split(str, on) {\r\n        return str.split(on).map(x => x.trim()).filter(x => x);\r\n    }\r\n\r\n    static #containsAny(selText, ors) {\r\n        return selText ? ors.some(x => selText.includes(x)) : false;\r\n    }\r\n\r\n    /**\r\n     * Find css defined rules by css selector\r\n     * @param {String} selector \r\n     * @returns {CSSStyleRule}\r\n     */\r\n    static findRule(selector) {\r\n        const me = GSCSSMap;\r\n        const logicalORs = me.#split(me.#normalize(selector), ',');\r\n        const sheets = Array.from(globalThis.document.styleSheets);\r\n        const ruleArrays = sheets.map(x => Array.from(x.cssRules || []));\r\n        const allRules = ruleArrays.reduce((all, x) => all.concat(x), []);\r\n        return allRules.filter((x) => me.#containsAny(me.#normalize(x.selectorText), logicalORs));\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSCSSMap);\r\n        globalThis.GSCSSMap = GSCSSMap;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A module loading GSDate class\r\n * @module base/GSDate\r\n */\r\n\r\n/**\r\n * Custom Date class to help handling calendar and date formatting\r\n * \r\n * @class\r\n */\r\nexport class GSDate extends Date {\r\n\r\n    static DEFAULT_FORMAT = 'YYYY-MM-DDTHH:mm:ssZ';\r\n    static REGEX_FORMAT = /\\[([^\\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g\r\n\r\n    #locale = navigator.locale;\r\n\r\n    format(val = GSDate.DEFAULT_FORMAT, locale) {\r\n        const me = this;\r\n        me.locale = locale;\r\n        const obj = me.asJSON();\r\n        return val.replace(GSDate.REGEX_FORMAT, (match, val) => val || obj[match]);\r\n    }\r\n\r\n    /**\r\n     * Build array days/weeks for a month\r\n     * @returns {Array<string>}\r\n     */\r\n    build() {\r\n        const me = this;\r\n        const last = me.last.getDate();\r\n        const first = me.first.getDay();\r\n\r\n        const mondayFirst = me.#isMondayFirst();\r\n\r\n        const shifter = mondayFirst ? -2 : -1;\r\n        const days = first === 0 ? [] : ' '.repeat(first + shifter).split(' ');\r\n        let i = 1;\r\n        while (i <= last) {\r\n            days.push(i.toString());\r\n            i++;\r\n        }\r\n\r\n        while (days.length % 7 != 0) days.push('');\r\n\r\n        return days;\r\n    }\r\n\r\n    get locale() {\r\n        return this.#locale;\r\n    }\r\n\r\n    set locale(val) {\r\n        this.#locale = val || navigator.language;\r\n    }\r\n\r\n    get year() {\r\n        return this.getFullYear();\r\n    }\r\n\r\n    set year(val = 0) {\r\n        this.setFullYear(val);\r\n    }\r\n\r\n    get month() {\r\n        return this.getMonth();\r\n    }\r\n\r\n    set month(val = 0) {\r\n        this.setMonth(val);\r\n    }\r\n\r\n    get day() {\r\n        return this.getDate();\r\n    }\r\n\r\n    set day(val = 0) {\r\n        this.setDate(val);\r\n    }\r\n\r\n    /**\r\n     * First date of the month\r\n     * @returns {Date}\r\n     */\r\n    get first() {\r\n        return new GSDate(this.getFullYear(), this.getMonth(), 1);\r\n    }\r\n\r\n    /**\r\n     * Last date of the month\r\n     * @returns {Date}\r\n     */\r\n    get last() {\r\n        return new GSDate(this.getFullYear(), this.getMonth() + 1, 0);\r\n    }\r\n\r\n    get YY() {\r\n        return String(this.YYYY).slice(-2);\r\n    }\r\n\r\n    get YYYY() {\r\n        return this.getFullYear();\r\n    }\r\n\r\n    get M() {\r\n        return this.getMonth() + 1;\r\n    }\r\n\r\n    get MM() {\r\n        return this.M.toString().padStart(2, '0');\r\n    }\r\n\r\n    get MMM() {\r\n        return this.#toLocale({ month: 'short' });\r\n    }\r\n\r\n    get MMMM() {\r\n        return this.#toLocale({ month: 'long' });\r\n    }\r\n\r\n    get D() {\r\n        return this.getDate().toString();\r\n    }\r\n\r\n    get DD() {\r\n        return this.D.padStart(2, '0');\r\n    }\r\n\r\n    get d() {\r\n        return this.getDay().toString();\r\n    }\r\n\r\n    get dd() {\r\n        return this.ddd.slice(0, 2);\r\n    }\r\n\r\n    get ddd() {\r\n        return this.#toLocale({ weekday: 'short' });\r\n    }\r\n\r\n    get dddd() {\r\n        return this.#toLocale({ weekday: 'long' });\r\n    }\r\n\r\n    get H() {\r\n        return this.getHours().toString();\r\n    }\r\n\r\n    get HH() {\r\n        return this.H.padStart(2, '0');\r\n    }\r\n\r\n    get h() {\r\n        return this.#formatHour(1);\r\n    }\r\n\r\n    get hh() {\r\n        return this.#formatHour(2);\r\n    }\r\n\r\n    get a() {\r\n        return this.#meridiem(true);\r\n    }\r\n\r\n    get A() {\r\n        return this.#meridiem(false);\r\n    }\r\n\r\n    get m() {\r\n        return this.getMinutes().toString();\r\n    }\r\n\r\n    get mm() {\r\n        return this.m.padStart(2, '0');\r\n    }\r\n\r\n    get s() {\r\n        return this.getSeconds().toString();\r\n    }\r\n\r\n    get ss() {\r\n        return this.s.padStart(2, '0');\r\n    }\r\n\r\n    get SSS() {\r\n        return this.getMilliseconds().toString().padStart(3, '0');\r\n    }\r\n\r\n    get Z() {\r\n        return this.#zoneStr();\r\n    }\r\n\r\n    get ZZ() {\r\n        return this.Z.replace(':', '');\r\n    }\r\n\r\n    get Q() {\r\n        return Math.ceil(this.M / 3);\r\n    }\r\n\r\n    get k() {\r\n        return (this.getHours() + 1).toString();\r\n    }\r\n\r\n    get kk() {\r\n        return this.k.padStart(2, '0');\r\n    }\r\n\r\n    get W() {\r\n        const date = new Date(this.getTime());\r\n        date.setHours(0, 0, 0, 0);\r\n        date.setDate(date.getDate() + 3 - (date.getDay() + 6) % 7);\r\n        const week1 = new Date(date.getFullYear(), 0, 4);\r\n        return 1 + Math.round(((date.getTime() - week1.getTime()) / 86400000 - 3 + (week1.getDay() + 6) % 7) / 7);\r\n    }\r\n\r\n    get WW() {\r\n        return this.W.toString().padStart(2, '0');\r\n    }\r\n\r\n    get x() {\r\n        return this.getTime();\r\n    }\r\n\r\n    get X() {\r\n        return Math.floor(this.x / 1000);\r\n    }\r\n\r\n    asJSON() {\r\n        const me = this;\r\n        return {\r\n            YY: me.YY,\r\n            YYYY: me.YYYY,\r\n            M: me.M,\r\n            MM: me.MM,\r\n            MMM: me.MMM,\r\n            MMMM: me.MMMM,\r\n            D: me.D,\r\n            DD: me.DD,\r\n            d: me.d,\r\n            dd: me.dd,\r\n            ddd: me.ddd,\r\n            dddd: me.dddd,\r\n            H: me.H,\r\n            HH: me.HH,\r\n            h: me.h,\r\n            hh: me.hh,\r\n            a: me.a,\r\n            A: me.A,\r\n            m: me.m,\r\n            mm: me.mm,\r\n            s: me.s,\r\n            ss: me.ss,\r\n            SSS: me.SSS,\r\n            Z: me.Z,\r\n            ZZ: me.ZZ,\r\n            Q: me.Q,\r\n            k: me.k,\r\n            kk: me.kk,\r\n            W: me.W,\r\n            WW: me.WW,\r\n            x: me.x,\r\n            X: me.X\r\n        }\r\n    }\r\n\r\n    static monthList(short = false, locale = navigator.locale, capitalize = true) {\r\n        const tmp = new GSDate();\r\n        tmp.locale = locale;\r\n        tmp.setMonth(0);\r\n        const days = [];\r\n        let val = null;\r\n        let d = 12;\r\n        while (d--) {\r\n            val = short ? tmp.MMM : tmp.MMMM;\r\n            val = capitalize ? tmp.#capitalize(val) : val;\r\n            days.push(val);\r\n            tmp.setMonth(tmp.getMonth() + 1);\r\n        }\r\n        return days;\r\n    }\r\n\r\n    static dayList(short = false, locale = navigator.locale, capitalize = true) {\r\n        const tmp = new GSDate();\r\n        tmp.locale = locale;\r\n        const mondayFirst = tmp.#isMondayFirst();\r\n        const offset = mondayFirst ? 1 : 0;\r\n        tmp.setDate(tmp.getDate() - tmp.getDay() + offset);\r\n        const days = [];\r\n        let val = null;\r\n        let d = 7;\r\n        while (d--) {\r\n            val = short ? tmp.ddd : tmp.dddd;\r\n            val = capitalize ? tmp.#capitalize(val) : val;\r\n            days.push(val);\r\n            tmp.setDate(tmp.getDate() + 1);\r\n        }\r\n        return days;\r\n    }\r\n\r\n    #isMondayFirst() {\r\n        // TODO Firefox does not support it\r\n        return new Intl.Locale(this.#locale)?.weekInfo?.firstDay === 1;\r\n    }\r\n\r\n    #capitalize(val = '') {\r\n        return val.charAt(0).toUpperCase() + val.slice(1);\r\n    }\r\n\r\n    #toLocale(opt) {\r\n        return this.toLocaleString(this.#locale, opt);\r\n    }\r\n\r\n    #formatHour(size) {\r\n        return (this.getHours() % 12 || 12).toString().padStart(size, '0');\r\n    }\r\n\r\n    #meridiem(isLowercase) {\r\n        const opt = { hour: '2-digit', hour12: true };\r\n        const val = this.#toLocale(opt).split(' ').pop(-1);\r\n        return isLowercase ? val.toLowerCase() : val;\r\n    }\r\n\r\n    #zoneStr() {\r\n        const me = this;\r\n        const negMinutes = -1 * me.getTimezoneOffset();\r\n        const minutes = Math.abs(negMinutes)\r\n        const hourOffset = Math.floor(minutes / 60)\r\n        const minuteOffset = minutes % 60;\r\n\r\n        const seg1 = negMinutes <= 0 ? '+' : '-';\r\n        const seg2 = hourOffset.toString().padStart(2, '0');\r\n        const seg3 = minuteOffset.toString().padStart(2, '0');\r\n\r\n        return `${seg1}${seg2}:${seg3}`;\r\n    }\r\n\r\n    static parse(value, format, locale) {\r\n        format = format || GSUtil.getDateFormat(locale);\r\n        const regex = GSDate.#getFormattedDateRegex(format);\r\n        return GSDate.#parseFormattedDate(value, regex);\r\n    }\r\n    \r\n    static #getFormattedDateRegex(format) {\r\n        return new RegExp(\r\n            '^\\\\s*' + format.toUpperCase().replaceAll(/([MDY])\\1*/g, '(?<$1>\\\\d+)') + '\\\\s*$'\r\n        );\r\n    }\r\n\r\n    static #parseFormattedDate(value, regex) {\r\n\r\n        const { groups } = value.match(regex) ?? {};\r\n\r\n        if (!groups) return null;\r\n\r\n        const y = Number(groups.Y);\r\n        const m = Number(groups.M);\r\n        const d = Number(groups.D);\r\n\r\n        // Validate range of year and month\r\n        if (y < 1000 || y > 2999) return null;\r\n        if (m < 1 || m > 12) return null;\r\n\r\n        const date = new Date(y, m - 1, d);\r\n\r\n        // Validate day of month exists\r\n        if (d !== date.getDate()) return null;\r\n\r\n        return isNaN(date.valueOf()) ? null : date;\r\n    }\r\n\r\n    static {\r\n        globalThis.GSDate = GSDate;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSData class\r\n * @module base/GSData\r\n */\r\n\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSDate } from \"./GSDate.mjs\";\r\n\r\n/**\r\n * A set of static functions used for loading resources\r\n * @class\r\n */\r\nexport class GSData {\r\n\r\n    static PROPERTIES = { name: {}, type: {}, format: {}, currency: {}, locale: {}, extract: {} };\r\n\r\n    /**\r\n     * Removes duplicates from list\r\n     * @param {Array} data \r\n     * @returns {Array}\r\n     */\r\n    static uniqe(data) {\r\n        return Array.from(new Set(data));\r\n    }\r\n\r\n    static compareArrays = (a, b) => a.length === b.length && a.every((element, index) => element === b[index]);\r\n\r\n    /**\r\n     * Check if two arrays are equal\r\n     * \r\n     * @param {Array} a \r\n     * @param {Array} b \r\n     * @returns {Boolean}\r\n     */\r\n    static arraysEqual(a, b) {\r\n\r\n        if (!Array.isArray(a)) return false;\r\n        if (!Array.isArray(b)) return false;\r\n        if (a === b) return true;\r\n\r\n        a = a.toSorted();\r\n        b = b.toSorted();\r\n\r\n        return GSData.compareArrays(a, b);\r\n    }\r\n\r\n    /**\r\n     * Simple array merge, without duplicates. Used by observableAttributes\r\n     * @param {Array} first \r\n     * @param {Array} second \r\n     * @returns {Array}\r\n     */\r\n    static mergeArrays(first = [], second = []) {\r\n        return [...first, ...second].filter((value, index, arr) => arr.indexOf(value) === index);\r\n    }\r\n\r\n    /**\r\n     * Simple Object merge\r\n     * @param {*} list \r\n     * @returns \r\n     */\r\n    static mergeObjects(list = []) {\r\n        let o = {};\r\n        list.filter(o => o).forEach(it => o = { ...o, ...it });\r\n        return o;\r\n    }\r\n\r\n    /**\r\n     * Convert data to format by given definition.\r\n     * @param {object} cfg {name:'field_name' , type:'date', format:'d/m/y', currency:'eur', locale:'hr', extract:'REGEX'}\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    static format(cfg, val) {\r\n\r\n        const type = GSData.#toType(cfg, val);\r\n        const locale = cfg.locale || GSUtil.locale;\r\n        const rule = GSUtil.toRegex(cfg.extract, 'g');\r\n        val = rule ? val.match(rule)[0] : val;\r\n\r\n        switch (type) {\r\n            case 'timestamp':\r\n                if (val instanceof Date) return val;\r\n                return Date.parse(val);\r\n            case 'date':\r\n                if (val instanceof Date) return val;\r\n                const fmt = GSUtil.asBool(cfg.format) ? undefined : cfg.format;\r\n                if (GSUtil.isString(val)) return GSDate.parse(val, fmt, locale);\r\n                return val && val != 0 ? new GSDate(val).format(fmt, locale) : val;\r\n            case 'string':\r\n            case 'text':\r\n                if (val instanceof Date) {\r\n                    const fmt = cfg.format || GSUtil.getDateFormat(locale);\r\n                    return new GSDate(val).format(fmt, locale);\r\n                };\r\n                break;\r\n            case 'boolean':\r\n                return GSUtil.asBool(val, false);\r\n            case 'number':\r\n                return GSUtil.asNum(val, val, locale);\r\n            case 'currency':\r\n                if (GSUtil.isString(val)) val = GSUtil.asNum(val);\r\n                const opt = { style: 'currency', currency: cfg.currency };\r\n                return new Intl.NumberFormat(locale, opt).format(val);\r\n        }\r\n\r\n        return val;\r\n    }\r\n\r\n    static #toType(cfg, val) {\r\n        if (cfg.type) return cfg.type;\r\n        if (val instanceof Date) return 'date';\r\n        if (val instanceof Number) return 'number';\r\n        if (val instanceof Boolean) return 'boolean';\r\n        return typeof val;\r\n    }\r\n\r\n    /**\r\n     * Filter array of records \r\n     * @param {Array} data Array of JSON objects or array of array of primitive types\r\n     * @param {Array<object>|String} filter Check filterComplex function for details\r\n     * @param {Array<String>} fields List of Object properties to check, if not set, all are checked\r\n     * @returns {Array}\r\n     */\r\n    static *filter(data = [], filter = [], fields, limit = 0) {\r\n        let cnt = 0;\r\n        let sts = false;\r\n        for (let rec of data) {\r\n            sts = GSData.filterRecord(rec, filter, fields);\r\n            if (sts) {\r\n                cnt++\r\n                yield rec;\r\n            }\r\n            if (limit > 0 && cnt >= limit) break;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Filter array of records \r\n     * @param {Array} data Array of JSON objects or array of array of primitive types\r\n     * @param {Array<object>|String} filter Check filterComplex function for details\r\n     * @param {Array<String>} fields List of Object properties to check, if not set, all are checked\r\n     * @returns {Array}\r\n     */\r\n    static filterData(data = [], filter = [], fields, limit = 0) {\r\n        data = Array.isArray(data) ? data : [];\r\n        filter = Array.isArray(filter) ? filter : [];\r\n        if (filter.length === 0) return data;\r\n        return [...GSData.filter(data, filter, fields, limit)];\r\n    }\r\n\r\n    /**\r\n     * Filter single record to a matchign critheria\r\n     * @param {Array<object>|String} filter Check filterComplex function for details\r\n     * @param {Array} data Array of JSON objects or array of array of primitive types\r\n     * @param {Array<String>} fields List of Object properties to check, if not set, all are checked\r\n     * @returns {Array}\r\n     */\r\n    static filterRecord(rec, filter, fields) {\r\n        const isSimple = typeof filter === 'string';\r\n        return isSimple ? GSData.filterSimple(rec, filter, fields) : GSData.filterComplex(rec, filter);\r\n    }\r\n\r\n    /**\r\n     * Check if JSON object contains a value in any of defined properties\r\n     * @param {Object} rec Json object to check\r\n     * @param {String} filter Value to search for\r\n     * @param {Array<string>} fields List of properties to serach\r\n     * @returns {Boolean} Return true if any of given properties (or all) contains provided value\r\n     */\r\n    static filterSimple(rec, filter = '', fields) {\r\n        filter = filter.toLowerCase();\r\n        fields = fields || Object.keys(rec);\r\n        let value = null;\r\n        for (let key of fields) {\r\n            value = rec[key];\r\n            if (GSData.filterValue(value, filter)) return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Check if object contains data in selected properties\r\n     * @todo Add support for eq,gt,lt,like,or operators\r\n     * @param {Object|Array} rec Json object or array of primitive values to check\r\n     * @param {Array<Object>} filter List of filter objects in format\r\n     *        [{name: idx[num] || name[string], value: ''  , op:'eq'}]\r\n     *        Where:\r\n     *           - name is numeric index only if rec is array of primitive values ([1,'a','b',4]...etc)\r\n     *           - name is string if rec is JSON object\r\n     * @returns {Boolean} Flag indicating if record is matched to a given filter critheria\r\n     */\r\n    static filterComplex(rec, filter) {\r\n\r\n        let found = true;\r\n        let value = null;\r\n\r\n        for (let flt of filter) {\r\n            value = rec[flt.name];\r\n            if (flt.name) {\r\n                found = found && GSData.filterValue(value, flt)\r\n            } else {\r\n                found = found && GSData.filterSimple(rec, flt.value);\r\n            }\r\n            if (!found) break;\r\n        }\r\n\r\n        return found;\r\n    }\r\n\r\n    static filterValue(value, filter) {\r\n        if (value instanceof Date) {\r\n            return GSData.matchDate(value, filter);\r\n        } else if (value instanceof Date) {\r\n            return GSData.matchNumber(value, GSUtil.asNum(filter.value), filter.op);\r\n        } else {\r\n            return ('' + value).toLocaleLowerCase().includes(('' + filter.value).toLocaleLowerCase());\r\n        }\r\n    }\r\n\r\n    static matchDate(val, filter, locale) {\r\n\r\n        if (typeof filter === 'string') {\r\n            const value = '' + filter;\r\n            const local = val.toLocaleDateString(locale);\r\n            const iso = val.toISOString();\r\n            return local.includes(value) || iso.includes(value);\r\n        }\r\n\r\n        if (!filter.value) return false;\r\n\r\n        const qry = filter.value instanceof Date ? 'date' : typeof filter.value;\r\n\r\n        switch (qry) {\r\n            case 'number':\r\n                return GSData.matchNumber(val.getTime(), filter.value, filter.op);\r\n            case 'date':\r\n                return GSData.matchNumber(val.getTime(), filter.value.getTime(), filter.op);\r\n        }\r\n\r\n        return GSData.matchDate(val, '' + filter.value, filter.locale);\r\n    }\r\n\r\n    /**\r\n     * Match number by operator\r\n     * @param {*} value \r\n     * @param {*} query \r\n     * @param {*} operator \r\n     */\r\n    static matchNumber(value = 0, query = 0, operator = 'eq') {\r\n        switch (operator) {\r\n            case 'gt': return query > value;\r\n            case 'lt': return query < value;\r\n            case 'ge': return query >= value;\r\n            case 'le': return query <= value;\r\n        }\r\n        return value === query;\r\n    }\r\n\r\n    /**\r\n     * Sort data\r\n     * @param {*} data \r\n     * @param {*} sort \r\n     * @returns {Array}\r\n     */\r\n    static sortData(data, sort) {\r\n        if (sort.length === 0) return data;\r\n        return data.toSorted((a, b) => GSData.sortPair(a, b, sort));\r\n    }\r\n\r\n    /**\r\n     * Sort two values, recursion supported\r\n     * @param {*} v1 Array of primitive types or JSON object\r\n     * @param {*} v2 Array of primitive types or JSON object\r\n     * @param {Number} sort -1 | 0 | 1 (descending, as id, ascending )\r\n     * @returns {Number} -1 | 0 | 1\r\n     */\r\n    static sortPair(a, b, sort) {\r\n\r\n        const isArray = Array.isArray(a);\r\n        let sts = 0;\r\n\r\n        sort.forEach((o, i) => {\r\n            if (!o) return;\r\n            const ord = GSUtil.isNumber(o) ? o : o.ord;\r\n            const idx = GSUtil.isNumber(o.col) ? o.col : i;\r\n            const key = isArray ? idx : o.name;\r\n            const v1 = a[key];\r\n            const v2 = b[key];\r\n\r\n            sts = GSData.compare(v1, v2, ord, sts);\r\n        });\r\n\r\n        return sts;\r\n    }\r\n\r\n    /**\r\n     * Compare two values, recursion supported\r\n     * @param {*} v1 \r\n     * @param {*} v2 \r\n     * @param {Number} order -1 | 0 | 1 (descending, as id, ascending )\r\n     * @param {Number} sts previous value\r\n     * @returns {Number} -1 | 0 | 1\r\n     */\r\n    static compare(v1, v2, order, sts) {\r\n        if (GSUtil.isNumber(v1) && GSUtil.isNumber(v2)) {\r\n            return sts || GSData.compareNum(v1, v2, order);\r\n        } else if (GSUtil.isString(v1) || GSUtil.isString(v2)) {\r\n            return sts || GSData.compareString(v1, v2, order);\r\n        } else if (GSUtil.isBool(v1) || GSUtil.isBool(v2)) {\r\n            return sts || GSData.compareBool(v1, v2, order);\r\n        } else if (GSUtil.isDate(v1) || GSUtil.isDate(v2)) {\r\n            return sts || GSData.compareNum(Number(v1), Number(v2), order);\r\n        }\r\n        return sts;\r\n    }\r\n\r\n    /**\r\n     * Safely compare two boolean values\r\n     * @param {Boolean} v1 \r\n     * @param {Boolean} v2 \r\n     * @param {Number} ord \r\n     * @returns {Number} -1 | 0 | 1\r\n     */\r\n    static compareBool(v1, v2, ord) {\r\n        v1 = v1 ? 1 : 0;\r\n        v2 = v2 ? 1 : 0;\r\n        return GSData.compareNum(v1, v2, ord);\r\n    }\r\n\r\n    /**\r\n     * Compare two string values \r\n     * @param {String} v1 \r\n     * @param {String} v2 \r\n     * @param {Number} ord \r\n     * @returns {Number} -1, 1, 0\r\n     */\r\n    static compareString(v1, v2, ord) {\r\n        const s1 = (v1 || '').toString();\r\n        const s2 = (v2 || '').toString();\r\n        return ord < 0 ? s2.localeCompare(s1) : s1.localeCompare(s2);\r\n    }\r\n\r\n    /**\r\n     * Compare two numeric values\r\n     * @param {Number} v1 \r\n     * @param {Number} v2 \r\n     * @param {Number} ord positive = ascending, negative - descending \r\n     * @returns {Number} < 0 or 1 or > 0\r\n     */\r\n    static compareNum(v1, v2, ord) {\r\n        return ord < 0 ? v2 - v1 : v1 - v2;\r\n    }\r\n\r\n    /**\r\n     * Write value to JSON object into structured name.\r\n     * Name subelements are separated by dot (users.name etc.).\r\n     * @param {Object} obj \r\n     * @param {String} name  \r\n     * @param {Boolean} ignoreNull  \r\n     * @param {Object} value \r\n     */\r\n    static writeToOject(obj, name, value, ignoreNull = true) {\r\n        if (ignoreNull && GSUtil.isNull(value)) return;\r\n\r\n        const seg = name.split('.');\r\n        if (seg.length === 1) {\r\n            return GSData.#writeSingleToOject(obj, name, value);\r\n        }\r\n\r\n        const tree = seg.slice(0, -1);\r\n        const key = seg.slice(-1)[0];\r\n\r\n        tree.forEach(v => {\r\n            if (!obj.hasOwnProperty(v)) obj[v] = {};\r\n            obj = obj[v];\r\n        });\r\n\r\n        return GSData.#writeSingleToOject(obj, key, value);\r\n    }\r\n\r\n    static #writeSingleToOject(obj, name, value) {\r\n        if (obj.hasOwnProperty(name)) {\r\n            if (!Array.isArray(obj[name])) {\r\n                obj[name] = [obj[name]];\r\n            }\r\n            if (Array.isArray(value)) {\r\n                obj[name] = obj[name].concat(value);\r\n            } else {\r\n                obj[name].push(value);\r\n            }\r\n        } else {\r\n            obj[name] = value;\r\n        }\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Read object property by supporting arrays\r\n     * name can be plain name or name[idx]\r\n     * @param {*} obj \r\n     * @param {String} name \r\n     * @returns {*}\r\n     */\r\n    static readFromProperty(obj, name, partial = false) {\r\n        if (GSUtil.isNull(obj)) return;\r\n        const r = /\\[\\d+\\]$/g;\r\n        const isArray = r.test(name);\r\n        let n = name;\r\n        let i = '';\r\n\r\n        if (isArray) {\r\n            n = name.replace(r, '')\r\n            i = name.match(r).shift().match(/\\d+/).shift();\r\n            i = GSUtil.asNum(i);\r\n            obj = obj.hasOwnProperty(n) ? obj[n][i] : null;\r\n        } else if (obj.hasOwnProperty(n)) {\r\n            obj = partial ? obj[n] || obj : obj[n];\r\n        } else {\r\n            obj = null;\r\n        }\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Read value from JSON object by structured name.\r\n     * Name subelements are separated by dot (users.name etc.).\r\n     * @param {Object} obj \r\n     * @param {String} name \r\n     * @returns {*}\r\n     */\r\n\tstatic readFromObject(obj, name) {\r\n\t\treturn name ? name.split('.').reduce((a, v) => GSData.readFromProperty(a, v), obj) : undefined;\r\n\t}\r\n\t\r\n    /**\r\n     * Check if named path exist within the object\r\n     * @param {Object} obj \r\n     * @param {String} name \r\n     * @returns {Boolean}\r\n     */\r\n\tstatic objectPathExist(obj, name) {\r\n        return GSData.readFromObject(obj, name) !== undefined;\r\n\t}\r\n\r\n    static {\r\n        Object.seal(GSData);\r\n        globalThis.GSData = GSData;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDOM class\r\n * @module base/GSDOM\r\n */\r\n\r\nimport { GSCSSMap } from \"./GSCSSMap.mjs\";\r\nimport { GSData } from \"./GSData.mjs\";\r\nimport { GSLog } from \"./GSLog.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A generic set of static functions to handle DOM tree and DOM elements\r\n * @class\r\n */\r\nexport class GSDOM {\r\n\r\n\tstatic QUERY_FOCUSABLE = \"a[href]:not([tabindex='-1']),area[href]:not([tabindex='-1']),input:not([disabled]):not([tabindex='-1']),select:not([disabled]):not([tabindex='-1']),textarea:not([disabled]):not([tabindex='-1']),button:not([disabled]):not([tabindex='-1']),iframe:not([tabindex='-1']),[tabindex]:not([tabindex='-1']),[contentEditable=true]:not([tabindex='-1'])\";\r\n\tstatic QUERY_INPUT = \"input:not([type='hidden']):not(disabled):not(readonly),select:not([type='hidden']):not(disabled):not(readonly),textarea:not([type='hidden']):not(disabled):not(readonly)\";\r\n\tstatic #FORMEL = ['INPUT', 'SELECT', 'TEXTAREA', 'OUTPUT'];\r\n\t//static #CLEANUP1 = /(\\n*\\t*)*(?=\\n\\t*)/g\r\n\tstatic #CLEANUP1 = /(?:\\n+\\t*)+/g\r\n\r\n\t// Timeout for removing element\r\n\tstatic SPEED = 300;\r\n\r\n\t/**\r\n\t * Find active (focused) element\t\r\n\t * @returns {HTMLElement} Focused element\r\n\t */\r\n\tstatic get activeElement() {\r\n\t\treturn GSDOM.active(document.activeElement);\r\n\t}\r\n\r\n\t/**\r\n\t * Find active (focused) element\r\n\t * @param {HTMLElement} el Starting node\r\n\t * @returns {HTMLElement} Focused element\r\n\t */\r\n\tstatic active(el) {\r\n\t\treturn el.shadowRoot?.activeElement ? GSDOM.active(el.shadowRoot?.activeElement) : el;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if element is visible\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isVisible(el) {\r\n\t\tif (!GSDOM.isHTMLElement(el)) return false;\r\n\t\tconst css = GSCSSMap.getComputedStyledMap(el);\r\n\t\tconst visibility = !css.matches('visibility', 'hidden');\r\n\t\tconst display = !css.matches('display', 'none');\r\n\t\tconst opacity = css.asNum('opacity') > 0;\r\n\t\tconst rect = el.getBoundingClientRect();\r\n\t\tconst size = (rect.width > 0 && rect.height > 0);\r\n\t\treturn size && opacity && visibility && display;\r\n\t}\r\n\r\n\t/**\r\n\t* Parse string into html DOM\r\n\t*\r\n\t* @param {String} html Source to parse\r\n\t* @param {Boolean} single Return first element or all\r\n\t* @param {String} mime Src mime type\r\n\t* @return {HTMLElement}\r\n\t*/\r\n\tstatic parse(html = '', single = false, mime = 'text/html') {\r\n\t\ttry {\r\n\t\t\tconst parser = new DOMParser();\r\n\t\t\tconst doc = parser.parseFromString(html, mime);\r\n\t\t\treturn single ? (doc?.head?.firstElementChild || doc?.body?.firstElementChild) : doc;\r\n\t\t} catch (e) {\r\n\t\t\tGSLog.error(null, e);\r\n\t\t\tthrow e;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Parse source and auto wrap if required\r\n\t * @param {GSElement} own \r\n\t * @param {String} src \r\n\t * @returns {HTMLElement}\r\n\t */\r\n\tstatic parseWrapped(own, src = '', forceWrap = false) {\r\n\r\n\t\tconst doc = GSDOM.parse(src);\r\n\t\tconst head = GSDOM.#fromNode(doc.head.children);\r\n\t\tconst body = GSDOM.#fromNode(doc.body.children);\r\n\r\n\t\tconst nodes = [...head, ...body];\r\n\r\n\t\tconst wrap = forceWrap || nodes.length !== 1;\r\n\r\n\t\tconst tpl = GSDOM.wrap(own, wrap ? null : nodes.shift());\r\n\r\n\t\twhile (nodes.length > 0) tpl.appendChild(nodes.shift());\r\n\r\n\t\treturn tpl;\r\n\t}\r\n\r\n\t/**\r\n\t * The same as link function, with default wrapper element\r\n\t * \r\n\t * @param {HTMLElement} own Owner element to which target is linked\r\n\t * @param {HTMLElement} target Target elemetn to link to owner\r\n\t * @returns {HTMLElement} Return target\r\n\t */\r\n\tstatic wrap(own, target) {\r\n\t\treturn GSDOM.link(own, target || document.createElement('gs-block'));\r\n\t}\r\n\r\n\t/**\r\n\t * Create reference between two HTMLElements\r\n\t * \r\n\t * @param {HTMLElement} own Owner element to which target is linked\r\n\t * @param {HTMLElement} target Target elemetn to link to owner\r\n\t * @returns {HTMLElement} Return target\r\n\t */\r\n\tstatic link(own, target) {\r\n\t\ttarget.setAttribute('proxy', `#${own.id}`);\r\n\t\tif (own.slot) target.setAttribute('slot', own.slot);\r\n\t\treturn target;\r\n\t}\r\n\r\n\tstatic #fromNode(nodes) {\r\n\t\treturn Array.from(nodes || []).filter(el => !GSDOM.isText(el));\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given value is part of HTMLFormElement\r\n\t * @param {string | HTMLElement} el \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isFormElement(el) {\r\n\t\tconst name = GSUtil.isString(el) ? el : el?.tagName;\r\n\t\treturn GSDOM.#FORMEL.includes(name);\r\n\t}\r\n\r\n\t/**\r\n\t * Return all form elements for a given root element\r\n\t * @param {HTMLElement} el \r\n\t * @returns \r\n\t */\r\n\tstatic formElements(el) {\r\n\t\treturn GSDOM.queryAll(el, GSDOM.#FORMEL.map(v => v.toLowerCase()));\r\n\t}\r\n\r\n\t/**\r\n\t * Check if element is button\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isButtonElement(el) {\r\n\t\treturn (el instanceof HTMLButtonElement)\r\n\t\t\t|| el?.tagName === 'GS-BUTTON'\r\n\t\t\t|| GSDOM.hasClass(el, 'btn');\r\n\t}\r\n\r\n\t/**\r\n\t  * Check if given element is of given type \r\n\t  * \r\n\t  * @param {HTMLElement} el\r\n\t  * @param {String|class} type Tag Name, class name or Class\r\n\t  * @returns {Boolean}\r\n\t  */\r\n\tstatic isElement(el, type) {\r\n\r\n\t\tconst isArgs = type && el;\r\n\t\tif (!isArgs) return false;\r\n\r\n\t\tconst isStr = GSUtil.isString(type);\r\n\r\n\t\tif (!isStr) return el instanceof type;\r\n\r\n\t\tconst ownClazz = customElements.get(type.toLowerCase());\r\n\t\tif (ownClazz && el instanceof ownClazz) return el;\r\n\r\n\t\tconst it = GSDOM.inheritance(el);\r\n\t\tfor (let pel of it) {\r\n\t\t\tif (pel?.constructor?.name === type) return el;\r\n\t\t}\r\n\r\n\t\tif (type.toUpperCase() === el.tagName) return el;\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type HTMLSlotElement\r\n\t * @returns {Boolean}\r\n\t */\t\r\n\tstatic isSlotElement(el) {\r\n\t\treturn el instanceof HTMLSlotElement;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type HTMLElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isTemplateElement(el) {\r\n\t\treturn el instanceof HTMLTemplateElement;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type HTMLElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isHTMLElement(el) {\r\n\t\treturn el instanceof HTMLElement;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type SVGElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isSVGElement(el) {\r\n\t\treturn el instanceof SVGElement;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type Text\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isText(el) {\r\n\t\treturn el instanceof Text;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type Comment\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isComment(el) {\r\n\t\treturn el instanceof Comment;\r\n\t}\r\n\r\n\t/*\r\n\t * Check if given element is of type GSElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isGSElement(el) {\r\n\t\tif (!el?.clazzName) return false;\r\n\t\tconst it = GSDOM.inheritance(el);\r\n\t\tfor (let v of it) {\r\n\t\t\tif (!v) break;\r\n\t\t\tif (v?.clazzName === 'GSElement') return true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if standard element extended with GS\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isGSExtra(el) {\r\n\t\treturn el?.getAttribute('is')?.indexOf('GS-') === 0;\r\n\t}\r\n\r\n\t/**\r\n\t * Get all child GSElement\t\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Array<HTMLElement>}\r\n\t */\r\n\tstatic getChilds(el) {\r\n\t\treturn Array.from(el?.childNodes || []).filter(e => GSDOM.isGSElement(e));\r\n\t}\r\n\r\n\t/**\r\n\t * Hide html element\r\n\t * @param {HTMLElement} el \r\n\t * @param {Boolean} orientation \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic hide(el, orientation = false) {\r\n\t\treturn el?.classList?.add(orientation ? 'gs-hide-orientation' : 'gs-hide');\r\n\t}\r\n\r\n\t/**\r\n\t * Show html element\r\n\t * @param {HTMLElement} el \r\n\t * @param {Boolean} orientation \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic show(el, orientation = false) {\r\n\t\treturn el?.classList?.remove(orientation ? 'gs-hide-orientation' : 'gs-hide');\r\n\t}\r\n\r\n\t/**\r\n\t * Add node as next in list of nodes\r\n\t * @param {HTMLElement} target \r\n\t * @param {HTMLElement} newEl \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic addSibling(target, newEl) {\r\n\t\tconst injectable = GSDOM.isHTMLElement(newEl) || GSDOM.isSVGElement(newEl);\r\n\t\tconst isOK = GSDOM.isHTMLElement(target) && injectable;\r\n\t\tconst invalid = target === newEl && target.parentNode === newEl || target.nextElementSibling === newEl;\r\n\t\treturn isOK && !invalid ? target.parentNode.insertBefore(newEl, target.nextElementSibling) : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Add child node to a target\r\n\t * @param {HTMLElement} target \r\n\t * @param {HTMLElement} newEl \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic appendChild(target, newEl) {\r\n\t\tconst isok = GSDOM.isHTMLElement(target) && GSDOM.isHTMLElement(newEl);\r\n\t\treturn isok && target !== newEl ? target.appendChild(newEl) : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Add node to a target at specified place\r\n\t * @param {HTMLElement} target \r\n\t * @param {HTMLElement} newEl \r\n\t * @param {String} placement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic insertAdjacent(target, newEl, placement) {\r\n\t\tconst isok = GSDOM.isHTMLElement(target) && GSDOM.isHTMLElement(newEl);\r\n\t\tconst invalid = target === newEl && target.parentNode === newEl\r\n\t\treturn isok && !invalid ? target.insertAdjacentElement(placement, newEl) : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Remove genarated componnt from parent\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic removeElement(el) {\r\n\t\treturn GSDOM.parent(el)?.removeChild(el);\r\n\t}\r\n\r\n\t/**\r\n\t * Walk node tree\r\n\t * \r\n\t * @param {HTMLLegendElement} node Start node to walk from \r\n\t * @param {Boolean} closest Direction down (false) or up (true)\r\n\t * @param {Boolean} all  Filter HTMLElements (false) only or text also (true) (only down)\r\n\t * @param {Boolean} shadow Traverse shadow DOM also (only down)\r\n\t * @returns {Iterable}\r\n\t */\r\n\tstatic walk(node, closest = false, all = false, shadow = true) {\r\n\t\treturn closest ? GSDOM.parentAll(node) : GSDOM.childAll(node, all, shadow);\r\n\t}\r\n\r\n\t/**\r\n\t * Traverse DOM tree top-to-bottom\r\n\t * \r\n\t * @param {*} node Start node\r\n\t * @param {*} all  Include all elements (Text,Comment, HTMLElements)\r\n\t * @param {*} shadow Include traversing across shadow tree\r\n\t * @param {*} child Inernal, do not use\r\n\t * @returns {Iterable}\r\n\t */\r\n\tstatic *childAll(node, all = false, shadow = true, child = false) {\r\n\t\tif (!node) return;\r\n\t\tif (child) yield node;\r\n\t\tif (shadow) yield* GSDOM.childAll(node.shadowRoot, all, shadow, true);\r\n\t\tconst list = all ? node.childNodes : node.children;\r\n\t\tif (!list) return;\r\n\t\tfor (let child of list) {\r\n\t\t\tyield* GSDOM.childAll(child, all, shadow, true);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Get parent element\r\n\t * \r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement}\r\n\t */\r\n\tstatic parent(el) {\r\n\t\treturn el ? (el.parentElement || el.parentNode || el.host) : null;\r\n\t}\r\n\r\n\t/**\r\n\t * Parent element iterator\r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement}\r\n\t * @iterator\r\n\t */\r\n\tstatic *parentAll(el) {\r\n\t\tlet e = GSDOM.parent(el);\r\n\t\twhile (e) {\r\n\t\t\tyield e;\r\n\t\t\te = GSDOM.parent(e);\r\n\t\t}\r\n\t\tif (e) return yield e;\r\n\t}\r\n\r\n\t/**\r\n\t * Element prototype iterator\r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement}\r\n\t * @iterator\r\n\t */\r\n\tstatic *inheritance(el) {\r\n\t\tlet e = el.__proto__;\r\n\t\twhile (e) {\r\n\t\t\tyield e;\r\n\t\t\te = e.__proto__;\r\n\t\t}\r\n\t\tif (e) return yield e;\r\n\t}\r\n\r\n\t/**\r\n\t * Recursively find offsetparent; used in positional offset calculation\r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement}\r\n\t */\r\n\tstatic offsetParent(el) {\r\n\t\tlet offset = el?.offsetParent;\r\n\t\tif (offset) return offset;\r\n\t\tconst it = GSDOM.parentAll(el);\r\n\t\tfor (const c of it) {\r\n\t\t\toffset = c.offsetParent;\r\n\t\t\tif (offset) break;\r\n\t\t}\r\n\t\treturn offset;\r\n\t}\r\n\r\n\t/**\r\n\t * Get root element whch might be shadow root, GSElement, any parent element\r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement|ShadowRoot}\r\n\t */\r\n\tstatic root(el) {\r\n\r\n\t\tif (!el) return null;\r\n\r\n\t\tconst it = GSDOM.parentAll(el);\r\n\t\tfor (let v of it) {\r\n\t\t\tif (v instanceof ShadowRoot) return v;\r\n\t\t\tif (v instanceof HTMLBodyElement) return v;\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * Get WebComponent owning element inside rendered shadow root\r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement}\r\n\t */\r\n\tstatic component(el) {\r\n\t\treturn GSDOM.parent(GSDOM.root(el));\r\n\t}\r\n\r\n\t/**\r\n\t * Get node index between siblings\r\n\t * @param {HTMLElement} node \r\n\t * @returns {Number}\r\n\t */\r\n\tstatic getElementIndex(node) {\r\n\t\tif (!GSDOM.isHTMLElement(node)) return 0;\r\n\t\treturn [...node.parentElement.children].indexOf(node);\r\n\t}\r\n\r\n\t/**\r\n\t * Find element by ID within DOM Tree across Shadow DOM\r\n\t * @param {HTMLElement} el Root node to start from\r\n\t * @param {String} id Element id\r\n\t * @returns {HTMLElement} \r\n\t */\r\n\tstatic getByID(el, id) {\r\n\t\tif (typeof el === 'string') return GSDOM.getByID(document.documentElement, el);\r\n\t\tif (!(el && id)) return null;\r\n\t\tconst it = GSDOM.walk(el, false);\r\n\t\tfor (let o of it) {\r\n\t\t\tif (o.id === id) return o;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * Query DOM Tree up to find closest element across Shadow DOM\r\n\t * @param {HTMLElement} el Root node to start from\r\n\t * @param {String} qry CSS query\r\n\t * @param {Number} level How many levels to wal, 0 = all\r\n\t * @returns {HTMLElement} \r\n\t */\r\n\tstatic closest(el, qry, levels = 0) {\r\n\t\tif (typeof el === 'string') return GSDOM.closest(document.documentElement, qry);\r\n\t\tif (!(el && qry)) return null;\r\n\t\tlevels = GSUtil.asNum(levels, 0);\r\n\t\tconst limit = levels > 0;\r\n\t\tconst it = GSDOM.walk(el, true);\r\n\t\tfor (let o of it) {\r\n\t\t\tif (GSDOM.matches(o, qry)) return o;\r\n\t\t\tif (limit && --levels == 0) return null;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * Query DOM tree with support for Shadow DOM\r\n\t * \r\n\t * @param {HTMLElement} el Root node to start from\r\n\t * @param {String} qry CSS query\r\n\t * @returns {HTMLElement} \r\n\t */\r\n\tstatic query(el, qry, all = false, shadow = true) {\r\n\t\tif (typeof el === 'string') return GSDOM.query(document.documentElement, el, all, shadow);\r\n\t\tif (!(el && qry)) return null;\r\n\t\tif (GSDOM.matches(el, qry)) return GSDOM.#proxy(el);\r\n\t\tconst it = GSDOM.walk(el, false, all, shadow);\r\n\t\tfor (let o of it) {\r\n\t\t\tif (GSDOM.matches(o, qry)) return GSDOM.#proxy(o);\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * Query DOM tree with support for Shadow DOM\r\n\t * \r\n\t * @param {HTMLElement} el Root node to start from\r\n\t * @param {String} qry CSS query\r\n\t * @returns {Array<HTMLElement>}\r\n\t*/\r\n\tstatic queryAll(el, qry, all = false, shadow = true) {\r\n\t\tif (typeof el === 'string') return GSDOM.queryAll(document.documentElement, el, all, shadow);\r\n\t\tconst res = [];\r\n\t\tif (!(el && qry)) return res;\r\n\t\tconst it = GSDOM.walk(el, false, all, shadow);\r\n\t\tfor (let o of it) {\r\n\t\t\tif (GSDOM.matches(o, qry)) res.push(GSDOM.#proxy(o));\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n\r\n\t/**\r\n\t * Overide native to prevent DOM issue when input field name=id\r\n\t * @returns{Proxy}\r\n\t */\r\n\tstatic #proxy(el) {\r\n\t\tif (el.tagName !== 'FORM') return el;\r\n\t\tif (!GSDOM.isHTMLElement(el.id)) return el;\r\n\t\treturn new Proxy(el, {\r\n\t\t\tget: function (target, prop, receiver) {\r\n\t\t\t\tif (prop === '_owner_') return target;\r\n\t\t\t\tif (prop === 'id') return target.getAttribute('id');\r\n\t\t\t\tconst res = Reflect.get(target, prop);\r\n\t\t\t\treturn GSFunction.isFunction(res) ? res.bind(target) : res;\r\n\t\t\t},\r\n\t\t\tset: function (target, prop, value) {\r\n\t\t\t\treturn target[prop] = value;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Match element against CSS query\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} qry \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic matches(el, qry) {\r\n\t\t// return el && qry && typeof el.matches === 'function' && el.matches(qry);\r\n\t\treturn el && typeof el.matches === 'function' && el.matches(qry);\r\n\t}\r\n\r\n\t/**\r\n\t * Set html text to provided element.\r\n\t * NOTE: Done intentionaly like this to prevent source validation warning.\r\n\t *       Use sanitizer when not any more experimental feature;\r\n\t *       Watch for default Sanitizer.getDefaultConfiguration()\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} val \r\n\t * @param {Boolean} sanitize \r\n\t * @param {Sanitizer} sanitizer \r\n\t * @returns {void}\r\n\t */\r\n\tstatic setHTML(el, val = '', sanitize = false, sanitizer) {\r\n\t\tconst isValid = el instanceof ShadowRoot || el instanceof HTMLElement || el instanceof HTMLTemplateElement;\r\n\t\tif (!isValid) return;\r\n\t\tif (sanitize && el?.setHTML) {\r\n\t\t\tsanitizer ? el.setHTML(val, { sanitizer }) : el.setHTML(val);\r\n\t\t} else {\r\n\t\t\tel.innerHTML = val instanceof Document ? val.body.innerHTML : val;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Set text to provided element\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} val \r\n\t * @returns {void}\r\n\t */\r\n\tstatic setText(el, val = '') {\r\n\t\tif (el) el.textContent = val;\r\n\t}\r\n\r\n\t/**\r\n\t * Set style to an element\r\n\t * @param {HTMLElement|string} el \r\n\t * @param {Object} obj \r\n\t */\r\n\tstatic css(el, obj) {\r\n\t\tif (GSUtil.isString(el)) el = GSDOM.queryAll(el);\r\n\t\tif (GSDOM.isHTMLElement(el)) el = [el];\r\n\t\tif (!(Array.isArray(el) && el.length > 0)) return false;\r\n\t\trequestAnimationFrame(() => {\r\n\t\t\tel.forEach(it => {\r\n\t\t\t\tObject.entries(obj).forEach(kv => {\r\n\t\t\t\t\tit.style[kv[0]] = kv[1];\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Safe way to toggle CSS class on element, multipel classes are supported in space separated string list\r\n\t * @param {HTMLElement|string} el \r\n\t * @param {*} val list of css classes in space separated string\r\n\t * @param {Boolean} sts True to add, false to remove\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic toggleClass(el, val, sts) {\r\n\t\tif (GSUtil.isString(el)) el = GSDOM.queryAll(el);\r\n\t\tif (GSDOM.isHTMLElement(el)) el = [el];\r\n\t\tif (!(Array.isArray(el) && el.length > 0)) return false;\r\n\t\tif (!val || val.trim().length == 0) return false;\r\n\t\tval = val.split(' ').filter(v => v && v.trim().length > 0);\r\n\t\tif (GSUtil.isNull(sts)) return val.forEach(v => {\r\n\t\t\tel.forEach(it => it.classList.toggle(v));\r\n\t\t});\r\n\t\tel.forEach(it => {\r\n\t\t\tsts ? it.classList.add.apply(it.classList, val) : it.classList.remove.apply(it.classList, val);\r\n\t\t});\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t * Toggle element visibility\r\n\t * @param {HTMLElement|string} el \r\n\t * @param {Boolean} sts \r\n\t */\r\n\tstatic toggle(el, sts) {\r\n\t\treturn GSDOM.toggleClass(el, 'd-none', GSUtil.isNull(sts) ? sts : !sts);\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if element contains a css class\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic hasClass(el, val = '') {\r\n\t\treturn el?.classList?.contains(val);\r\n\t}\r\n\r\n\t/**\r\n\t * Alternative way to clear fields instead of form.reset()\r\n\t * @param {HTMLElement} owner \r\n\t * @param {String} qry \r\n\t */\r\n\tstatic clearInputs(owner, qry = 'input, textarea, output') {\r\n\t\tconst root = GSDOM.unwrap(owner);\r\n\t\trequestAnimationFrame(() => {\r\n\t\t\troot.querySelectorAll(qry).forEach((el) => el.value = '');\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Get proper value from element\r\n\t * @param {HTMLElement} el \r\n\t * @returns {String|Number}\r\n\t */\r\n\tstatic getValue(el) {\r\n\t\tswitch (el.type) {\r\n\t\t\tcase 'datetime-local':\r\n\t\t\tcase 'number':\r\n\t\t\t\treturn el.value ? el.valueAsNumber : el.value;\r\n\t\t\tcase 'select-multiple':\r\n\t\t\t\treturn Array.from(el.selectedOptions).map(o => o.value);\r\n\t\t\tcase 'checkbox':\r\n\t\t\t\tif (el.hasAttribute('value') && el.value) {\r\n\t\t\t\t\treturn el.checked ? el.value : null;\r\n\t\t\t\t}\r\n\t\t\t\treturn el.checked;\r\n\t\t\tdefault:\r\n\t\t\t\treturn el.value;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Get value from form element\r\n\t * @param {HTMLElement} el \r\n\t * @returns {String}\r\n\t */\r\n\tstatic toValue(el) {\r\n\t\tif (!GSDOM.isHTMLElement(el)) return undefined;\r\n\t\tlet value = GSDOM.getValue(el);\r\n\t\tif ('text' === el.type) {\r\n\t\t\tconst map = GSCSSMap.styleValue(el, 'text-transform');\r\n\t\t\tif (map) value = GSUtil.textTransform(map.value, value);\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\t/**\r\n\t * Set element value, taking chekbox into consideration\r\n\t * @param {HTMLElement} el \r\n\t * @param {String|Boolean|Number} val \r\n\t */\r\n\tstatic fromValue(el, val) {\r\n\t\tif (!GSDOM.isHTMLElement(el)) return;\r\n\t\tconst data = Array.isArray(val) ? val[0] || '' : val;\r\n\r\n\t\tswitch (el.type) {\r\n\t\t\tcase 'checkbox':\r\n\t\t\t\tif (el.hasAttribute('value')) {\r\n\t\t\t\t\tel.checked = data === el.value;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tel.checked = data == true;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tel.value = GSUtil.normalize(data);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Convert form elements into JSON object\r\n\t * @param {HTMLElement} owner \r\n\t * @param {String} qry \r\n\t * @param {Boolean} invalid Should include invalid fields\r\n\t * @returns {Object}\r\n\t */\r\n\tstatic toObject(owner, qry = 'input, textarea, select, output', invalid = true) {\r\n\t\tconst root = GSDOM.unwrap(owner);\r\n\t\tconst params = {};\r\n\t\tGSDOM.queryAll(root, qry)\r\n\t\t\t.filter(el => el.name)\r\n\t\t\t.filter(el => el.dataset.ignore !== 'true')\r\n\t\t\t.filter(el => invalid ? true : el.checkValidity())\r\n\t\t\t.forEach(el => {\r\n\t\t\t\tif (el.type !== 'radio') {\r\n\t\t\t\t\t//params[el.name] = GSDOM.toValue(el);\r\n\t\t\t\t\tGSData.writeToOject(params, el.name, GSDOM.toValue(el));\r\n\t\t\t\t} else if (el.checked) {\r\n\t\t\t\t\t//params[el.name] = GSDOM.toValue(el);\r\n\t\t\t\t\tGSData.writeToOject(params, el.name, GSDOM.toValue(el));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\treturn params;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON Object into HTMLElements (input)\r\n\t * @param {HTMLElement} owner Root selector (form)\r\n\t * @param {Object} obj Data source key/value pairs\r\n\t * @param {String} qry Element type selector,defaults to form elements \r\n\t * @returns {Object}\r\n\t */\r\n\tstatic fromObject(owner, obj, qry = 'input, textarea, select, output') {\r\n\t\tobj = GSUtil.toJson(obj);\r\n\t\t// if (Object.entries(obj).length === 0) return;\r\n\t\tconst root = GSDOM.unwrap(owner);\r\n\t\tconst list = GSDOM.queryAll(root, qry); // root.querySelectorAll(qry);\r\n\t\tArray.from(list).forEach(el => GSDOM.fromObject2Element(el, obj));\r\n\t\treturn obj;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON Object into HTMLElement (input)\r\n\t * @param {HTMLElement} owner Element to populate\r\n\t * @param {Object} obj Data source key/value pairs\r\n\t */\r\n\tstatic fromObject2Element(el, obj) {\r\n\t\tif (!GSData.objectPathExist(obj, el?.name)) return;\r\n\t\tconst val = GSData.readFromObject(obj, el.name);\r\n\t\tif (el.type !== 'radio') {\r\n\t\t\t//GSDOM.fromValue(el, obj[el.name]);\r\n\t\t\tGSDOM.fromValue(el, val);\r\n\t\t} else if (el.value === val) el.checked = true;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert HTMLElement into a JSON object\r\n\t * @param {HTMLElement|Array} own \r\n\t * @param {Boolean} recursive \r\n\t * @param {Boolean} plain  \r\n\t * @returns {Object}\r\n\t */\r\n\tstatic toJson(own, recursive = true, plain = false) {\r\n\t\tif (Array.isArray(own)) return own.map(o => GSDOM.toJson(o, recursive));\r\n\t\tconst obj = {};\r\n\t\tif (!GSDOM.isHTMLElement(own)) return obj;\r\n\r\n\t\tif (!plain) obj['#tagName'] = own.tagName.toLowerCase();\r\n\t\tobj['$text'] = own.innerText;\r\n\r\n\t\tArray.from(own.attributes).forEach(v => obj[v.name] = v.value);\r\n\r\n\t\tif (recursive) {\r\n\t\t\tconst children = Array.from(own.children).map(el => GSDOM.toJson(el, recursive, plain));\r\n\t\t\tif (children.length > 0) obj.items = children;\r\n\t\t}\r\n\r\n\t\treturn obj;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON object to DOM/html\r\n\t * @param {Object} obj \r\n\t * @param {Boolean} asString As string or HTMLElement Tree \r\n\t * @param {String} tag \r\n\t */\r\n\tstatic fromJson(obj, tag = 'gs-item', asString = false) {\r\n\t\treturn asString ? GSDOM.fromJsonAsString(obj, tag) : GSDOM.fromJsonAsDOM(obj, tag);\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON object to DOM tree\r\n\t * @param {Object} obj \r\n\t * @param {String} tag \r\n\t * @returns {HTMLElement|Array}\r\n\t */\r\n\tstatic fromJsonAsDOM(obj, tag = 'gs-item') {\r\n\t\tif (!obj) return null;\r\n\r\n\t\tconst isPrimitive = GSUtil.isNumber(obj) || GSUtil.isString(obj);\r\n\t\tif (isPrimitive) return GSDOM.fromJsonAsDOM({ title: obj }, tag);\r\n\r\n\t\tconst isArray = Array.isArray(obj);\r\n\t\tif (isArray) return obj.map(o => GSDOM.fromJsonAsDOM(o, tag));\r\n\r\n\t\tconst name = obj['#tagName'] || tag;\r\n\t\tconst el = document.createElement(name);\r\n\r\n\t\tObject.keys(obj).filter(v => v != 'items' && v[0] != '#')\r\n\t\t\t.forEach(v => el.setAttribute(v, obj[v]));\r\n\r\n\t\tif (Array.isArray(obj.items)) {\r\n\t\t\tobj.items.forEach(o => {\r\n\t\t\t\tconst sub = GSDOM.fromJsonAsDOM(o, tag);\r\n\t\t\t\tel.appendChild(sub);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn el;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON object to HTML source\r\n\t * @param {Object} obj \r\n\t * @param {String} tag \r\n\t * @returns {String}\r\n\t */\r\n\tstatic fromJsonAsString(obj, tag = 'gs-item') {\r\n\t\tif (!obj) return null;\r\n\r\n\t\tif (Array.isArray(obj)) return obj.map(o => GSDOM.fromJsonAsString(o)).join('');\r\n\r\n\t\tconst name = obj['#tagName'] || tag;\r\n\t\tconst src = [];\r\n\t\tsrc.push(`<${name} `);\r\n\r\n\t\tObject.keys(obj).filter(v => v != 'items' && v[0] != '#')\r\n\t\t\t.forEach(v => src.push(` ${v}=\"${obj[v]}\" `));\r\n\r\n\t\tsrc.push(`>`);\r\n\r\n\t\tif (Array.isArray(obj.items)) {\r\n\t\t\tobj.items.forEach(o => {\r\n\t\t\t\tconst sub = GSDOM.fromJsonAsString(o, tag);\r\n\t\t\t\tsrc.push(sub);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tsrc.push(`</${name}>`);\r\n\r\n\t\treturn src.join('');\r\n\t}\r\n\r\n\t/**\r\n\t * Convert URL hash key/value to form elements\r\n\t * @param {HTMLElement} owner \r\n\t */\r\n\tstatic fromURLHashToForm(owner) {\r\n\t\tlocation.hash.slice(1).split('&')\r\n\t\t\t.filter(v => v.length > 1)\r\n\t\t\t.forEach(v => {\r\n\t\t\t\tconst d = v.split('=');\r\n\t\t\t\tGSDOM.setValue(`input[name=${d[0]}]`, d[1], owner);\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Return element shadowRoot or self\r\n\t * @param {HTMLElement} owner \r\n\t * @returns {HTMLElement|shadowRoot}\r\n\t */\r\n\tstatic unwrap(owner) {\r\n\t\treturn owner ? owner.self || owner : document;\r\n\t}\r\n\r\n\t/**\r\n\t * Enable input on all input elements under provided owner\r\n\t * @param {HTMLElement} own \r\n\t * @param {String} qry Default to form\r\n\t */\r\n\tstatic enableInput(own, qry = 'input, select, textarea, .btn', all = true, group = '') {\r\n\t\tlet list = GSDOM.queryAll(own, qry);\r\n\t\tif (!all && group) list = list.filter(el => GSUtil.asBool(el.dataset[group]))\r\n\t\tlist.forEach(el => el.removeAttribute('disabled'));\r\n\t}\r\n\r\n\t/**\r\n\t * Disable input on all input elements under provided owner\r\n\t * @param {HTMLElement} own \r\n\t * @param {String} qry Default to form\r\n\t */\r\n\tstatic disableInput(own, qry = 'input, select, textarea, .btn', all = true, group = '') {\r\n\t\tGSDOM.queryAll(own, qry)\r\n\t\t\t.filter(el => all ? true : !el.disabled)\r\n\t\t\t.forEach(el => {\r\n\t\t\t\tel.setAttribute('disabled', true);\r\n\t\t\t\tif (group) el.dataset[group] = true;\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Set value to a element by css selector\r\n\t * @param {String} qry \r\n\t * @param {String} val \r\n\t * @param {HTMLElement} own \r\n\t */\r\n\tstatic setValue(qry, val, own) {\r\n\t\tconst el = GSDOM.queryAll(own, qry);\r\n\t\tel.forEach(it => GSDOM.fromValue(it, val));\r\n\t}\r\n\r\n\t/**\r\n\t * Find text nodes\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Array<string>}\r\n\t */\r\n\tstatic textNodesUnder(el) {\r\n\t\tconst walk = document.createTreeWalker(el || document, NodeFilter.SHOW_TEXT, null, false);\r\n\t\tconst a = [];\r\n\t\tlet n;\r\n\t\twhile (n = walk.nextNode()) a.push(n);\r\n\t\treturn a;\r\n\t}\r\n\r\n\t/**\r\n\t * Remove invalid text characters from html element nodes\r\n\t * @param {HTMLElement} root \r\n\t */\r\n\tstatic cleanHTML(root) {\r\n\t\tconst ts = GSDOM.textNodesUnder(root || document).filter(t => t.wholeText.trim().length === 0);\r\n\t\tts.filter(el => el.nextSibling instanceof Text).forEach(el => el.remove());\r\n\t\tts.forEach(t => t.nodeValue = t.wholeText.replaceAll(/\\u0020{4}/g, '\\t').replaceAll(GSDOM.#CLEANUP1, ''));\r\n\t}\r\n\r\n\t/**\r\n\t * Validate against provided list, if child elements allowed inside provided element\r\n\t * @param {HTMLElement} el Element which child list to validate\r\n\t * @param {String} tagName Expected owner element tag name\r\n\t * @param {String} whiteList Uppercase list of tag names allowed as child\r\n\t * @param {String} slotList List of named slots allowed\r\n\t * @param {Boolean} asState return state as bool or throw an error (default)\r\n\t * @returns {Boolean} return true if validation is ok.\r\n\t * @throws {Error}\r\n\t */\r\n\tstatic validate(own, tagName, whiteList, asState = false) {\r\n\t\tif (own.tagName !== tagName) {\r\n\t\t\tif (asState) return false;\r\n\t\t\tthrow new Error(`Owner element : ${own.tagName}, id:${own.id} is not of excpected type: ${tagName}`);\r\n\t\t}\r\n\t\tconst ok = GSDOM.isAllowed(Array.from(own.childNodes), whiteList);\r\n\t\tif (ok) return true;\r\n\t\tif (asState) return false;\r\n\t\tconst msg = GSDOM.toValidationError(own, whiteList);\r\n\t\tthrow new Error(msg);\r\n\t}\r\n\r\n\t/**\r\n\t * Check against provided list, if child elements allowed inside provided element\r\n\t * @param {HTMLElement|Array<HTMLElement>} el Element which childs to validate against provided list\r\n\t * @param {String} whiteList Uppercase list of tag names allowed as child nodes\r\n\t * @param {String} slotList List of elements with named  slots allowed\r\n\t * @returns {Boolean} return tr ue if validation is ok.\r\n\t */\r\n\tstatic isAllowed(el, whiteList) {\r\n\t\tif (Array.isArray(el)) return el.filter(el => GSDOM.isAllowed(el, whiteList)).length === 0;\r\n\t\tconst allowElement = !(el instanceof Text || el instanceof Comment);\r\n\t\tconst allowTag = !whiteList.includes(el.tagName);\r\n\t\treturn allowElement && allowTag;\r\n\t}\r\n\r\n\tstatic toValidationError(own, whiteList) {\r\n\t\tconst list = `<${whiteList.join('>, <')}>`;\r\n\t\treturn `${own.tagName} ID: ${own.id} allows as a child nodes only : ${list}!`;\r\n\t}\r\n\r\n\t/**\r\n\t * Inject css directly into a shadowRoot of an element\r\n\t * \r\n\t * @async\r\n\t * @param {HTMLElement} own \r\n\t * @param {String} url \r\n\t * @returns {Promise<boolean>}\r\n\t */\r\n\tstatic async injectCSS(own, url) {\r\n\t\tif (!own?.shadowRoot instanceof ShadowRoot) return false;\r\n\t\tlet sts = true;\r\n\t\ttry {\r\n\t\t\tconst res = await fetch(url);\r\n\t\t\tif (!res.ok) return;\r\n\t\t\tconst css = await res.text();\r\n\t\t\tconst sheet = new CSSStyleSheet();\r\n\t\t\tsheet.replaceSync(css);\r\n\t\t\town.shadowRoot.adoptedStyleSheets = [sheet];\r\n\t\t} catch (e) {\r\n\t\t\tGSLog.error(null, e);\r\n\t\t\tsts = false;\r\n\t\t}\r\n\t\treturn sts;\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.seal(GSDOM);\r\n\t\tglobalThis.GSDOM = GSDOM;\r\n\t}\r\n}\r\n\r\n\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSEvents class\r\n * @module base/GSEvents\r\n */\r\n\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSID } from \"./GSID.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSAttr } from \"./GSAttr.mjs\";\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSLog } from \"./GSLog.mjs\";\r\n\r\n/**\r\n * Class for handling events, also a registry of all GS-* element listeners\r\n * @Class\r\n */\r\nexport class GSEvents {\r\n\r\n\tstatic #rid = 0;\r\n\tstatic #protect = false;\r\n\tstatic #cache = new Map();\r\n\r\n\tstatic #loaded = false;\r\n\tstatic #susspended = 0;\r\n\r\n\tget altContext() {\r\n\t\treturn GSEvents.#protect;\r\n\t}\r\n\r\n\tset altContext(val) {\r\n\t\tGSEvents.#protect = GSUtil.asBool(val, true);\r\n\t}\r\n\r\n\t/**\r\n\t * Disable browser console and default context menu\r\n\t */\r\n\tstatic protect() {\r\n\t\tGSEvents.listen(globalThis, null, 'contextmenu', GSEvents.#onContext);\r\n\t\tGSEvents.listen(globalThis.document, null, 'keydown', GSEvents.#onKeyDown);\r\n\t}\r\n\r\n\tstatic #onContext(event) {\r\n\t\tif (GSEvents.#protect || !event.shiftKey) GSEvents.prevent(event);\r\n\t}\r\n\r\n\tstatic #onKeyDown(event) {\r\n\t\tconst code = event.code;\r\n\t\tif (code == 'F12') { // Prevent F12\r\n\t\t\treturn false;\r\n\t\t} else if (event.ctrlKey && event.shiftKey && code == 'KeyI') { // Prevent Ctrl+Shift+I\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Wait for web page to completely load, then send event to target element\r\n\t * DOMContentLoaded vs load ?!\r\n\t * @async\r\n\t * @param {HTMLElement} target \r\n\t * @param {String} name \r\n\t * @param {function} callback \r\n\t * @param {Promise<number>} timeout \r\n\t */\r\n\tstatic async waitPageLoad(target, name = 'loaded', callback, timeout = 100, prevent = true) {\r\n\t\tif (!GSEvents.#loaded) {\r\n\t\t\ttry {\r\n\t\t\t\tawait GSEvents.wait(globalThis.window, 'load', timeout, prevent);\r\n\t\t\t\tGSEvents.#loaded = true;\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log(e);\r\n\t\t\t}\r\n\t\t}\r\n\t\t// await GSUtil.timeout(timeout);\r\n\t\tawait GSFunction.callFunction(callback);\r\n\t\tGSEvents.sendSuspended(target, name);\r\n\t}\r\n\r\n\t/**\r\n\t * Async version of event listener\r\n\t * \r\n\t * @async\r\n\t * @param {HTMLElement} own \r\n\t * @param {String} name \r\n\t * @param {Number} timeout  \r\n\t * @param {Boolean} prevent \r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic wait(own, name = '', timeout = 0, prevent = true) {\r\n\t\tif (GSUtil.isStringEmpty(name)) throw new Error('Event undefined!');\r\n\t\tif (!GSUtil.isNumber(timeout)) throw new Error('Invalid timeout value!');\r\n\t\tif (timeout > 0) return GSEvents.once(own, null, name, null, timeout);\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tGSEvents.once(own, null, name, e => {\r\n\t\t\t\tif (prevent) GSEvents.prevent(e);\r\n\t\t\t\tresolve(e);\r\n\t\t\t}, timeout);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Async version of animation frame\r\n\t * \r\n\t * @async\r\n\t * @param {function} callback \r\n\t * @param {Boolean} chaind Prevent consequtive chained calls.\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic async waitAnimationFrame(callback, chained = false) {\r\n\r\n\t\tif (chained) {\r\n\t\t\tif (typeof callback !== 'function') return;\r\n\t\t\tif (GSEvents.#susspended > 0) return GSFunction.callFunction(callback);\r\n\t\t\tGSEvents.#susspended++;\r\n\t\t}\r\n\r\n\t\treturn new Promise((accept, reject) => {\r\n\t\t\trequestAnimationFrame(async () => {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst o = await GSFunction.callFunction(callback);\r\n\t\t\t\t\taccept(o);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\treject(e);\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tif (chained && GSEvents.#susspended > 0) GSEvents.#susspended--;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Listen for an event on a given element or query\r\n\t * @param {*} own \r\n\t * @param {*} qry \r\n\t * @param {*} event \r\n\t * @param {*} callback \r\n\t * @param {*} opt \r\n\t * @returns {boolean|Array<boolean>} \r\n\t */\r\n\tstatic listen(own, qry, event, callback, opt = false) {\r\n\t\tif (!qry && own) return own.addEventListener(event, callback, opt);\r\n\t\treturn GSDOM.queryAll(own, qry).map(el => el.addEventListener(event, callback, opt));\r\n\t}\r\n\r\n\t/**\r\n\t * Unlisten for an event on a given element or query\r\n\t * @param {*} own \r\n\t * @param {*} qry \r\n\t * @param {*} event \r\n\t * @param {*} callback \r\n\t * @returns {boolean|Array<boolean>} \r\n\t */\r\n\tstatic unlisten(own, qry, event, callback) {\r\n\t\tif (!qry && own) return own.removeEventListener(event, callback);\r\n\t\treturn GSDOM.queryAll(own, qry).map(el => el.removeEventListener(event, callback));\r\n\t}\r\n\r\n\tstatic on = GSEvents.listen;\r\n\tstatic off = GSEvents.unlisten;\r\n\r\n\t/**\r\n\t * Wait for an event. Also, trigger on timeout if event not triggered.\r\n\t * @param {HTMLElement} own \r\n\t * @param {String} qry Optional selector within owner\r\n\t * @param {String} event Event name to wait for\r\n\t * @param {*} callback Function to call \r\n\t * @param {Number | AbortSignal} timeout If GT 0, retrun Promise\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic once(own, qry, event, callback, timeout = 0) {\r\n\t\tconst signal = GSEvents.#toSignal(timeout);\r\n\t\tif (signal && signal.internal) {\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tGSEvents.listen(own, qry, event, callback || resolve, { once: true, signal: signal });\r\n\t\t\t\tsignal.addEventListener('abort', reject);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn GSEvents.listen(own, qry, event, callback, { once: true, signal: signal });\r\n\t}\r\n\r\n\t/**\r\n\t * Generic prevent event bubling\r\n\t * \r\n\t * @param {Event} e \r\n\t */\r\n\tstatic prevent(e, full = true) {\r\n\t\tif (GSFunction.hasFunction(e, 'preventDefault')) e.preventDefault();\r\n\t\tif (GSFunction.hasFunction(e, 'stopPropagation')) e.stopPropagation();\r\n\t\tif (full && GSFunction.hasFunction(e, 'stopImmediatePropagation')) e.stopImmediatePropagation();\r\n\t}\r\n\r\n\t/**\r\n\t * Generic event disaptcher.\r\n\t * NOTE: If expecting to catch return value, do not use async in listeners\r\n\t * \r\n\t * @param {HTMLElement} sender element that send event\r\n\t * @param {String} name  Event name to trigger \r\n\t * @param {Object} obj Data object to send \r\n\t * @param {Boolean} bubbles Send event to parent\r\n\t * @param {Boolean} composed Send event across shadowDom\r\n\t * @param {Boolean} cancelable Event is cancelable\r\n\t * @returns {Boolean} false if event is cancelable, and at least one of the event handlers which received event called Event.preventDefault(). Otherwise true.\r\n\t */\r\n\tstatic send(sender = document, name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n\t\tconst opt = { detail: obj, bubbles: bubbles, composed: composed, cancelable: cancelable };\r\n\t\tconst event = new CustomEvent(name, opt);\r\n\t\treturn sender?.dispatchEvent(event);\r\n\t}\r\n\r\n\t/**\r\n\t * Convert event type to native event\r\n\t * @param {String} type \r\n\t * @param {Object} opt \r\n\t * @returns {Event}\r\n\t */\r\n\tstatic toEvent(type, opt) {\r\n\t\tlet evt = null;\r\n\t\tswitch (type) {\r\n\t\t\tcase 'copy':\r\n\t\t\tcase 'cut':\r\n\t\t\tcase 'paste':\r\n\t\t\t\tevt = new ClipboardEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'blur':\r\n\t\t\tcase 'focus':\r\n\t\t\tcase 'focusin':\r\n\t\t\tcase 'focusout':\r\n\t\t\t\tevt = new FocusEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'input':\r\n\t\t\tcase 'beforeinput':\r\n\t\t\t\tevt = new InputEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'keydown':\r\n\t\t\tcase 'keyup':\r\n\t\t\tcase 'keypress':\r\n\t\t\t\tevt = new KeyboardEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'dblclick':\r\n\t\t\tcase 'mousedown':\r\n\t\t\tcase 'mouseenter':\r\n\t\t\tcase 'mouseleave':\r\n\t\t\tcase 'mousemove':\r\n\t\t\tcase 'mouseout':\r\n\t\t\tcase 'mouseover':\r\n\t\t\tcase 'mouseup':\r\n\t\t\t\tevt = new MouseEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'submit':\r\n\t\t\t\tevt = new SubmitEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'touchstart':\r\n\t\t\tcase 'touchend':\r\n\t\t\tcase 'touchmove':\r\n\t\t\tcase 'touchcancel':\r\n\t\t\t\tevt = new TouchEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'whell':\r\n\t\t\t\tevt = new WheelEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'pointerover':\r\n\t\t\tcase 'pointerenter':\r\n\t\t\tcase 'pointerdown':\r\n\t\t\tcase 'pointermove':\r\n\t\t\tcase 'pointerup':\r\n\t\t\tcase 'pointercancel':\r\n\t\t\tcase 'pointerout':\r\n\t\t\tcase 'pointerleave':\r\n\t\t\tcase 'pointerrawupdate':\r\n\t\t\tcase 'gotpointercapture':\r\n\t\t\tcase 'lostpointercapture':\r\n\t\t\t\tevt = new PointerEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tevt = new CustomEvent(type, opt);\r\n\t\t}\r\n\t\treturn evt;\r\n\t}\r\n\r\n\t/**\r\n\t * Helper to fix some Firefox issues, detect event\r\n\t * @param {Event} e \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isMouseOrPointerEvent(e) {\r\n\t\treturn e instanceof MouseEvent || e instanceof PointerEvent;\r\n\t}\r\n\r\n\t/** \r\n\t * Generic event disaptcher in suspended rendering\r\n\t * \r\n\t * @param {HTMLElement} sender element that send event\r\n\t * @param {String} name  Event name to trigger\r\n\t * @param {Object} obj Data object to send \r\n\t * @param {Boolean} bubbles Send event to parent\r\n\t * @param {Boolean} composed Send event across shadowDom\r\n\t * @param {Boolean} cancelable Event is cancelable\r\n\t * @returns {void} \r\n\t */\r\n\tstatic sendSuspended(sender = document, name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n\t\treturn requestAnimationFrame(() => {\r\n\t\t\tGSEvents.send(sender, name, obj, bubbles, composed, cancelable);\r\n\t\t});\r\n\t}\r\n\r\n\t/** \r\n\t * Generic event disaptcher delayed in miliseconds\r\n\t * \r\n\t * @param {Number} timeout Time to delay event\r\n\t * @param {HTMLElement} sender element that send event\r\n\t * @param {String} name  Event name to trigger\r\n\t * @param {Object} obj Data object to send \r\n\t * @param {Boolean} bubbles Send event to parent\r\n\t * @param {Boolean} composed Send event across shadowDom\r\n\t * @param {Boolean} cancelable Event is cancelable\r\n\t * @returns {Number} setTimeout id for cancelation\r\n\t */\r\n\tstatic sendDelayed(timeout = 1, sender = document, name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n\t\treturn setTimeout(() => GSEvents.send(sender, name, obj, bubbles, composed, cancelable), timeout);\r\n\t}\r\n\r\n\t/**\r\n\t* Generic event listener appender\r\n\t * @param {HTMLElement} own Event owner\r\n\t * @param {HTMLElement} el Owner element to monitor\r\n\t * @param {String} name Event name to monitor\r\n\t * @param {Function} fn Callback to trigger on event\r\n\t * @param {Boolean} once Monitor event only once\r\n\t * @param {Boolean} capture Allow event capture\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic attach(own, el, name = '', fn, once = false, capture = false) {\r\n\t\tif (!el) return false;\r\n\t\tif (!(window instanceof Window || el.isConnected)) return false;\r\n\t\tif (!GSFunction.isFunction(fn)) return false;\r\n\t\tif (!GSFunction.hasFunction(el, 'addEventListener')) return false;\r\n\t\tconst me = this;\r\n\t\tconst obj = me.#eventKey(own, el, name, fn);\r\n\t\tconst elmap = me.#getElementMap(own);\r\n\t\tconst map = me.#eventMap(elmap, obj.key);\r\n\t\tmap.set(obj.fnkey, obj);\r\n\t\tobj.capture = capture;\r\n\t\tif (once) {\r\n\t\t\tobj.once = (e) => {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tobj.fn(e);\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tme.remove(obj.own, obj.el, obj.name, obj.once);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tObject.defineProperty(obj.once, 'gsid', { value: fn.gsid, writable: false });\r\n\t\t}\r\n\t\tel.addEventListener(name, once ? obj.once : obj.fn, { once: once, capture: capture });\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t* Generic event listener remover\r\n\t * @param {HTMLElement} own Event owner\r\n\t * @param {HTMLElement} el Owner element to monitor\r\n\t * @param {String} name Event name to moinitor\r\n\t * @param {Function} fn Callback to trigger on event\r\n\t */\r\n\tstatic remove(own, el, name = '', fn) {\r\n\t\tconst me = this;\r\n\t\tconst obj = me.#eventKey(own, el, name, fn);\r\n\t\tconst elmap = me.#getElementMap(own);\r\n\t\tconst map = me.#eventMap(elmap, obj.key);\r\n\t\tconst cfg = map.get(obj.fnkey);\r\n\t\tif (cfg) {\r\n\t\t\tmap.delete(cfg.fnkey);\r\n\t\t\tme.#removeListener(cfg);\r\n\t\t} else if (obj.fnkey === obj.key) {\r\n\t\t\tfor (let m of map.values()) {\r\n\t\t\t\tmap.delete(m.fnkey);\r\n\t\t\t\tme.#removeListener(m);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (map.size === 0) elmap.delete(obj.key);\r\n\t\tif (elmap.size === 0) me.#cache.delete(own);\r\n\t}\r\n\r\n\t/**\r\n\t * Release internal engine event listeners\r\n\t * @param {HTMLElement} own Event owner\r\n\t */\r\n\tstatic deattachListeners(own) {\r\n\t\tconst me = this;\r\n\t\tconst map = me.#removeElementMap(own);\r\n\t\tif (!map) return;\r\n\r\n\t\tconst it = map.values();\r\n\t\tfor (let m of it) {\r\n\t\t\tfor (let o of m.values()) {\r\n\t\t\t\tme.#removeListener(o);\r\n\t\t\t}\r\n\t\t\tm.clear();\r\n\t\t}\r\n\t\tmap.clear();\r\n\t}\r\n\r\n\t/**\r\n\t * Generate an event key object\r\n\t * @param {*} el \r\n\t * @param {*} name \r\n\t * @param {*} fn \r\n\t * @returns {Object}\r\n\t */\r\n\tstatic #eventKey(own, el, name = '', fn = '') {\r\n\t\tif (!el) return false;\r\n\t\tconst me = this;\r\n\t\tconst elid = me.#getElementID(el);\r\n\t\tconst fnid = me.#getCallbackID(fn);\r\n\t\tconst key = GSID.hashCode(`${elid}${name}`);\r\n\t\tconst fnkey = GSID.hashCode(`${elid}${name}${fnid || ''}`);\r\n\t\treturn { own: own, fn: fn, el: el, name: name, key: key, fnkey: fnkey };\r\n\t}\r\n\r\n\t/**\r\n\t * Get or create a map holding an event map\r\n\t * @param {Map<HTMLElement, Object>} elmap\r\n\t * @param {HTMLElement} key\r\n\t * @returns {Map<HTMLElement, Object>}\r\n\t */\r\n\tstatic #eventMap(elmap, key) {\r\n\t\tconst me = this;\r\n\t\tlet map = elmap.get(key);\r\n\t\tif (!map) {\r\n\t\t\tmap = new Map();\r\n\t\t\telmap.set(key, map);\r\n\t\t}\r\n\t\treturn map;\r\n\t}\r\n\r\n\tstatic #getCallbackID(fn) {\r\n\t\tif (!GSFunction.isFunction(fn)) return null;\r\n\t\tif (!fn.gsid) Object.defineProperty(fn, 'gsid', { value: GSID.next(), writable: false });\r\n\t\treturn fn.gsid;\r\n\t}\r\n\r\n\tstatic #getElementID(el) {\r\n\t\tlet elid = el[Symbol.for('gs-event-id')];\r\n\t\tif (!elid) {\r\n\t\t\telid = GSID.id;\r\n\t\t\tel[Symbol.for('gs-event-id')] = elid;\r\n\t\t}\r\n\t\treturn elid;\r\n\t}\r\n\r\n\t/**\r\n\t * Get or create a map holding an event map\r\n\t * @param {HTMLElement} own\r\n\t * @returns {Map<HTMLElement, Object>}\r\n\t */\r\n\tstatic #getElementMap(own) {\r\n\t\tconst me = this;\r\n\t\treturn me.#eventMap(me.#cache, own);\r\n\t}\r\n\r\n\tstatic #removeElementMap(own) {\r\n\t\tconst me = this;\r\n\t\tconst map = me.#cache.get(own);\r\n\t\tif (!map) return;\r\n\t\tme.#cache.delete(own);\r\n\t\treturn map;\r\n\t}\r\n\r\n\tstatic #removeListener(o) {\r\n\t\to.el.removeEventListener(o.name, o.once ? o.once : o.fn, { capture: o.capture });\r\n\t\to.el = null;\r\n\t\to.fn = null;\r\n\t\to.once = null;\r\n\t}\r\n\r\n\t/**\r\n\t * Internal helper, converter to Abortignal\r\n\t * @param {*} timeout \r\n\t */\r\n\tstatic #toSignal(timeout = 0) {\r\n\t\tif (GSUtil.isNumber(timeout) && timeout > 0) {\r\n\t\t\ttimeout = AbortSignal.timeout(timeout);\r\n\t\t\ttimeout.internal = true;\r\n\t\t\treturn timeout;\r\n\t\t}\r\n\t\tif (timeout instanceof AbortSignal) return timeout;\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\t/**\r\n\t * Monitor GSElement 'action' events and trigger class functions if avaialble.\r\n\t * @param {HTMLElement} owner \r\n\t * @param {String} type \r\n\t */\r\n\tstatic monitorAction(owner, type) {\r\n\t\towner.on('action', async (e) => {\r\n\t\t\tconst me = owner;\r\n\t\t\tconst data = e.detail;\r\n\t\t\tconst action = GSUtil.isString(data) ? data : data.action || data.data?.action;\r\n\t\t\tawait GSEvents.onAction(me, action, type, e);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Trigger class function defined in 'action' attribute\r\n\t * @param {HTMLElement} owner \r\n\t * @param {String} action \r\n\t * @param {String} prefix \r\n\t * @param {Event} evt \r\n\t * @returns {*} Action result or false\r\n\t */\r\n\tstatic async onAction(owner, action, prefix, evt) {\r\n\r\n\t\tconst callback = GSEvents.findAction(owner, action, prefix);\r\n\t\tif (!callback) return;\r\n\r\n\t\tGSEvents.prevent(evt);\r\n\t\tlet sts = false;\r\n\t\ttry {\r\n\t\t\tif (GSFunction.isFunctionAsync(callback)) {\r\n\t\t\t\tsts = await callback(evt);\r\n\t\t\t} else {\r\n\t\t\t\tsts = callback(evt);\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tsts = e;\r\n\t\t\tif (!GSFunction.isFunction(owner.onError)) throw e;\r\n\t\t\towner.onError(e);\r\n\t\t}\r\n\t\treturn sts;\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Find object instance action by name\r\n\t * @param {Object} owner \r\n\t * @param {String} action \r\n\t * @returns {Function}\r\n\t */\r\n\tstatic findAction(owner, action = '', prefix = '') {\r\n\t\tlet sts = false;\r\n\t\tif (!action) return sts;\r\n\t\tconst me = owner;\r\n\t\taction = GSUtil.capitalizeAttr(GSUtil.capitalize(action));\r\n\t\tprefix = GSUtil.capitalizeAttr(GSUtil.capitalize(prefix));\r\n\t\tconst name = `on${prefix}${action}`;\r\n\t\tif (globalThis.GS_LOG_ACTION) GSLog.warn(owner, `Action : ${name}`);\r\n\t\tconst fn = me[name];\r\n\t\tsts = GSFunction.isFunction(fn);\r\n\t\tsts = sts && !GSFunction.isFunctionNative(fn);\r\n\t\treturn sts ? me[name].bind(me) : null\r\n\t}\r\n\r\n\tstatic #onResize() {\r\n\t\tclearTimeout(GSEvents.#rid);\t\t\t\r\n\t\tGSEvents.#rid = setTimeout(async () => {\r\n\t\t\tawait GSEvents.waitAnimationFrame();\r\n\t\t\tGSEvents.send(window, 'resized');\r\n\t\t}, 100);\r\n\t}\r\n\r\n\t/**\r\n\t * Helper tool to notify when window resized. \r\n\t * Can be activated only once.\r\n\t * Trigger 'resized' event on window on resize timeout.\r\n\t */\r\n\tstatic resizeMonitor() {\r\n\t\tconst me = GSEvents;\r\n\t\tconst own = document.documentElement;\r\n\t\tconst obj = me.#eventKey(own, window, 'resize', me.#onResize);\r\n\t\tconst elmap = me.#getElementMap(own);\r\n\t\tconst def = elmap.get(obj.key)?.get(obj.fnkey);\r\n\t\tif (!def) me.attach(own, window, 'resize', me.#onResize);\r\n\t}\r\n\r\n\tstatic {\r\n\t\t//GSEvents.resizeMonitor();\r\n\t\tObject.freeze(GSEvents);\r\n\t\tglobalThis.GSEvents = GSEvents;\r\n\t}\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\nimport { GSEvents } from \"./GSEvents.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n\r\n/**\r\n * A module loading GSAbortController class\r\n * @module base/GSAbortController\r\n */\r\n\r\n/**\r\n * Extend native AbortController with timeout \r\n * @class\r\n */\r\nexport class GSAbortController extends AbortController {\r\n\r\n    #iid = 0;\r\n\r\n    constructor(timeout = 0) {\r\n        super();\r\n        if (!GSUtil.isNumber(timeout)) throw new Error('Timeout parameter must be number');\r\n        const me = this;\r\n        if (timeout) me.#iid = setTimeout(me.abort.bind(me), timeout);\r\n        me.signal.addEventListener('abort', () => clearInterval(me.#iid));\r\n    }\r\n\r\n    wait(timeout = 0) {\r\n        return GSEvents.wait(me.signal, 'abort', timeout);\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSLog } from \"./GSLog.mjs\";\r\n\r\n/**\r\n * A module loading GSDOMObserver class\r\n * @module base/GSDOMObserver\r\n */\r\n\r\n/**\r\n * Generic HTMLElement node add/remove from DOM tree.\r\n * This Class accepts filter/callback function registration\r\n * as creation of independent observers for each Shadow DOM.\r\n * NOTE: Shadow dom must have independent observers!!!\r\n * Mostly used for dynamic attaching events to the elements not extended with is=\"gs-*\"\r\n * @class\r\n * @extends MutationObserver\r\n */\r\nexport class GSDOMObserver extends MutationObserver {\r\n\r\n    static #filtersAdd = new Map();\r\n    static #filtersDel = new Map();\r\n\r\n    /**\r\n     * Observe element for insertion / deletion\r\n     * @param {HTMLElement} el A HTMLElement instance to observe for child changes\r\n     * @param {Object} opt A JSON configuration object\r\n     * @returns {Boolean} A satus of successfull observer registration\r\n     */\r\n    observe(el, opt) {\r\n        const cfg = opt || { childList: true, subtree: true };\r\n        return super.observe(el, cfg);\r\n    }\r\n\r\n    /**\r\n     * Create a new observer instance for given root element\r\n     * @param {HTMLElement} el An element to monitor for changes \r\n     * @param {Object} opt A JSON configuration object\r\n     * @returns {GSDOMObserver}\r\n     */\r\n    static create(el, opt) {\r\n        const observer = new GSDOMObserver(GSDOMObserver.#onObserve);\r\n        observer.observe(el, opt);\r\n        return observer;\r\n    }\r\n\r\n    /**\r\n     * Get add or remove filter\r\n     * @param {Boolean} forRemove If \"true\", return injection filter functions, elseremoval functions\r\n     * @returns {Map<Function, Function>} Returns map of filter functions\r\n     */\r\n    static #getFilter(forRemove = false) {\r\n        return forRemove ? GSDOMObserver.#filtersDel : GSDOMObserver.#filtersAdd;\r\n    }\r\n\r\n    /**\r\n     * Is there any filter registered\r\n     */\r\n    static get #hasFilters() {\r\n        return GSDOMObserver.#hasFiltersAdd || GSDOMObserver.#hasFiltersDel;\r\n    }\r\n\r\n    static get #hasFiltersAdd() {\r\n        return GSDOMObserver.#filtersAdd.size > 0;\r\n    }\r\n\r\n    static get #hasFiltersDel() {\r\n        return GSDOMObserver.#filtersDel.size > 0;\r\n    }\r\n\r\n    /**\r\n     * Observer callback to filter elements\r\n     * @param {*} mutations \r\n     */\r\n    static #onObserve(mutations) {\r\n        if (!GSDOMObserver.#hasFilters) return;\r\n        mutations.forEach((mutation) => {\r\n            if (GSDOMObserver.#hasFiltersAdd) mutation.addedNodes.forEach(el => GSDOMObserver.#walk(el, GSDOMObserver.#filtersAdd));\r\n            if (GSDOMObserver.#hasFiltersDel) mutation.removedNodes.forEach(el => GSDOMObserver.#walk(el, GSDOMObserver.#filtersDel));\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Walk node tree\r\n     * @param {HTMLElement} rootEL node root\r\n     * @param {Map} filters\r\n     * @returns {Boolean} \r\n     */\r\n    static #walk(rootEL, filters) {\r\n        if (filters.size === 0) return false;\r\n        GSDOMObserver.#parse(rootEL, filters);\r\n        rootEL.childNodes.forEach(el => GSDOMObserver.#walk(el, filters));\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Call filter and callback function if node accepted\r\n     * @param {HTMLElement} el node root\r\n     * @param {Map} filters\r\n     * @returns {void}\r\n     */\r\n    static #parse(el, filters) {\r\n        filters.forEach((v, k) => {\r\n            try {\r\n                if (k(el)) v(el);\r\n            } catch (e) {\r\n                GSLog.error(null, e);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Execute observer logic \r\n     * \r\n     * @param {HTMLElement} el node root\r\n     * @param {Function} filter function to filter nodes\r\n     * @param {Function} callback function to be called on selected node\r\n     * \r\n     * @returns {Boolean}\r\n     */\r\n    static #exec(el, filter, callback) {\r\n        if (el instanceof HTMLElement == false) return false;\r\n        const tmp = new Map();\r\n        tmp.set(filter, callback);\r\n        return GSDOMObserver.#walk(el, tmp);\r\n    }\r\n\r\n    /**\r\n     * Check if parameter is function\r\n     * @param {function} fn \r\n     * @returns {Boolean} true if parameter is function type\r\n     */\r\n    static #isFunction(fn) {\r\n        return typeof fn === 'function';\r\n    }\r\n\r\n    /**\r\n     * Check if registration functions are valid\r\n     * @param {Function} filter function to filter nodes\r\n     * @param {Function} callback function to be called on selected node\r\n     * @returns {Boolean}\r\n     */\r\n    static #isFunctions(filter, callback) {\r\n        return GSDOMObserver.#isFunction(filter) && GSDOMObserver.#isFunction(callback);\r\n    }\r\n\r\n    /**\r\n     * Register element filter\r\n     * \r\n     * @param {Function} filter - filter function returns true\r\n     * @param {Function} callback - result function\r\n     * @param {Boolean} forRemove - call on node remove or add\r\n     * @param {HTMLElement} target - element to monitor\r\n     * @returns {Boolean} Returns true if filter registered\r\n     */\r\n    static registerFilter(filter, callback, forRemove = false, target) {\r\n\r\n        if (!GSDOMObserver.#isFunctions(filter, callback)) return false;\r\n\r\n        GSDOMObserver.#getFilter(forRemove).set(filter, callback);\r\n\r\n        // initially loaded does not trigger \r\n        if (!forRemove) GSDOMObserver.#exec(target || document.body, filter, callback);\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Unregister element filter\r\n     * \r\n     * @param {Function} fn Filter function\r\n     * @param {Boolean} forRemove Call on node remove or add\r\n     * \r\n     * @returns {Boolean} Returns true if unregistered\r\n     */\r\n    static unregisterFilter(fn, forRemove = false) {\r\n        return GSDOMObserver.#isFunction(fn) ? GSDOMObserver.#getFilter(forRemove).delete(fn) : false;\r\n    }\r\n\r\n    /**\r\n     * Static constructor with default body monitoring\r\n     */\r\n    static {\r\n        Object.freeze(GSDOMObserver);\r\n        globalThis.GSDOMObserver = GSDOMObserver;\r\n        GSDOMObserver.create(document.documentElement);\r\n    }\r\n\r\n}\r\n\r\n\r\n/*\r\nGSDOMObserver.registerFilter((el)=>{ return el.tagName ==='DIV'}, (el) => {\r\n    console.log(el);\r\n});\r\n*/\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSID } from \"./GSID.mjs\";\r\n\r\n/**\r\n * A dynamic CSSStyleSheet used for dynamic programmable changed\r\n * css classes attached to a WebComponent html template elements.\r\n * Programmatically changing dynamic class elements will not reflect \r\n * element style properties.\r\n */\r\nexport class GSDynamicStyle extends CSSStyleSheet {\r\n\r\n    /**\r\n     * Constructor for DynamicStlye\r\n     * @param {String} id Unique name for easier filtering  \r\n     */\r\n    constructor(id = 'dynamic') {\r\n        super();\r\n        this.id = id || GSID.id;\r\n    }\r\n\r\n\t/**\r\n\t * Remove dynamic element rule\r\n\t * @param {String} id  \r\n\t */\r\n\tdeleteRule(id = '') {\r\n        const me = this;\r\n\t\tArray.from(me.cssRules)\r\n\t\t\t.map((v, i) => v.selectorText === `.${id}` ? i : -1)\r\n\t\t\t.filter(v => v > -1)\r\n\t\t\t.forEach(v => me.deleteRule(v));\r\n\t}    \r\n\r\n    /**\r\n     * Get individual rule from dynamic styles cache\r\n     * @param {String} id CSS class name\r\n     * @returns {CSSRule} \r\n     */\r\n    getRule(id = '') {\r\n        return Array.from(this.cssRules).filter(v => v.selectorText === `.${id}`).pop();\r\n    }\r\n\r\n    /**\r\n     * Set dynamic element rule. Accepts string or json object representation\r\n     * @param {String} id Unique css class name used\r\n     * @param {string|object} style CSS style properties to apply\r\n     */\r\n    setRule(id, style = '', sync = false) {\r\n\r\n        const me = this;\r\n\r\n        if (!id) return;\r\n\r\n\t\tlet rule = me.getRule(id);\r\n\t\tif (!rule) {\r\n\t\t\tme.insertRule(`.${id} {}`);\r\n\t\t\treturn me.setRule(id, style, sync);\r\n\t\t}        \r\n\r\n        if (!style) return rule;\r\n\r\n        let data = [];\r\n        if (typeof style === 'string') {\r\n            data = style.replaceAll('\\n', '').split(';').map(v => v.trim().split(':')).filter(v => v.length === 2);\r\n        } else {\r\n            data = Object.entries(style);\r\n        }\r\n\r\n        if (sync) {\r\n            data.forEach(kv => me.#updateRule(rule, kv[0], kv[1]));\r\n        } else {\r\n            requestAnimationFrame(() => {\r\n                data.forEach(kv => me.#updateRule(rule, kv[0], kv[1]));\r\n            });\r\n        }\r\n\r\n        return rule;\r\n    }\r\n\r\n    #updateRule(rule, prop = '', style = '') {\r\n        style = (style || '').toString();\r\n        const isImportant = style.includes('!important');\r\n        style = style.replace('!important', '');\r\n        prop = prop.trim();\r\n        rule.style.setProperty(prop, style, isImportant ? 'important' : '');\r\n    }\r\n\r\n    /**\r\n     * Find element dynamic style attached. \r\n     * Will search for a StyleSheet within element shadow addoptedStyleSheet by element data-sheet property.\r\n     * @param {HTMLElement} source A html element continaing dynamically injected html style\r\n     * @returns {CSSStyleSheet} An instance of dynamic stylesheet containing dynamic rules\r\n     */\r\n\tstatic dynamicStyleSheet(source) {\r\n\t\t// find shadow root (or document)\r\n\t\tconst root = GSDOM.root(source);\r\n        const id = source.dataset.sheet || 'dynamic';\r\n\t\t// find custom; dynamic style\r\n\t\treturn GSDynamicStyle.dynamicStyleSheetByID(root, id);\r\n\t}\r\n\r\n    /**\r\n     * Fnd custom dynamic style\r\n     * @param {Document} root Document or shadowDom\r\n     * @param {String} id Dynamic CSS name\r\n     * @returns {CSSStyleSheet} An instance of dynamic stylesheet containing dynamic rules\r\n     */\r\n    static dynamicStyleSheetByID(root, id) {\r\n\t\treturn Array.from(root?.adoptedStyleSheets).filter(el => el.id === id).pop();\r\n    }\r\n\r\n\t/**\r\n\t * Find dynamic style & rule for element\r\n\t * @param {HTMLElement} source A html element with dynamic style attached  (with data-gs-class attribute set)\r\n\t * @returns {CSSStyleRule} Instance of dynamic css class \r\n\t */\r\n\tstatic dynamicRule(source) {\r\n\t\tconst style = GSDynamicStyle.dynamicStyleSheet(source);\r\n\t\treturn style?.getRule(source.dataset.gsClass);\t\t\r\n\t}\r\n\r\n    /**\r\n     * Fnd custom dynamic rule\r\n     * @param {Document} root Document or shadowDom\r\n     * @param {String} id Dynamic CSS name\r\n    * @returns {CSSStyleRule} Instance of dynamic css class \r\n     */    \r\n    static dynamicRuleByID(root, id) {\r\n        const style = GSDynamicStyle.dynamicStyleSheetByID(root, 'dynamic');\r\n        return style?.getRule(id);\r\n    }\r\n\r\n    /**\r\n     * Find element dynamic style\r\n     * @param {HTMLElement} source \r\n     * @returns {CSSStyle} Element dynamic style or default style if dynamic not defined\r\n     */\r\n\tstatic dynamicStyle(source) {\r\n\t\tconst rule = GSDynamicStyle.dynamicRule(source);\r\n\t\treturn rule?.style; // || source.style;\r\n\t}\r\n\r\n    /**\r\n     * Find element dynamic style\r\n     * @param {Document} source Document or shadowDOM\r\n     * @returns {CSSStyle} Element dynamic style or default style if dynamic not defined\r\n     */\r\n\tstatic dynamicStyleByID(root, id) {\r\n\t\tconst rule = GSDynamicStyle.dynamicRuleByID(root, id);\r\n\t\treturn rule?.style; // || source.style;\r\n\t}\r\n\r\n    /**\r\n     * Apply CSS properties to the element style.\r\n     * Will search for a StyleSheet within element shadow addoptedStyleSheet by element data-gs-class property.\r\n     * @param {HTMLElement} source Element with dynamic style attached (with data-gs-class attribute set)\r\n     * @param {Object} opt A JSON object of css arguments to apply \r\n     * @returns {CSSStyle} A copy of modifid CSSStyle object \r\n     */\r\n\tstatic applyDynamicStyle(source, opt) {\r\n        requestAnimationFrame(() => {\r\n            const style = GSDynamicStyle.dynamicStyle(source);\r\n            return Object.assign(style, opt);\r\n        });\r\n\t}\r\n    \r\n    /**\r\n     * \r\n     * @param {Document || ShadowRoot} root Element with dynamic style attached\r\n     * @param {String} id Dynamic CSS style name\r\n     * @param {Object} opt A JSON object of css arguments to apply \r\n     * @returns {CSSStyle} A copy of modifid CSSStyle object \r\n     */\r\n\tstatic applyDynamicStyleByID(root, id, opt) {\r\n        requestAnimationFrame(() => {\r\n            const style = GSDynamicStyle.dynamicStyleByID(root, id);\r\n            return Object.assign(style, opt);\r\n        });\r\n\t}     \r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSCacheStyles class\r\n * @module head/GSCacheStyles\r\n */\r\n\r\nimport { GSDynamicStyle } from \"./GSDynamicStyle.mjs\";\r\nimport { GSID } from \"./GSID.mjs\";\r\nimport { GSLog } from \"./GSLog.mjs\";\r\n\r\nimport { gsstyles } from \"./style.mjs\";\r\n\r\n/**\r\n * Cache for dynaamically loaded styles.\r\n * Used to sharestyles among GS-* WebComponents\r\n * @class\r\n */\r\nexport class GSCacheStyles {\r\n\r\n\tstatic #store = new Map();\r\n\r\n\t/**\r\n\t * Create a new CSSStyleSheet\r\n\t * @param {String} id Unique ID\r\n\t * @returns {CSSStyleSheet} Created instance\r\n\t */\r\n\tstatic create(id) {\r\n\t\tconst sheet = new GSDynamicStyle(id);\r\n\t\tthis.#store.set(id, sheet);\r\n\t\treturn sheet;\r\n\t}\r\n\r\n\t/**\r\n\t * Store initialized stylesheet under the unique ID\r\n\t * @param {String} id \r\n\t * @param {CSSStyleSheet} style \r\n\t * @returns {CSSStyleSheet} Stored stylesheet\r\n\t */\r\n\tstatic set(id, style) {\r\n\r\n\t\tconst me = this;\r\n\r\n\t\tif (style instanceof CSSStyleSheet) {\r\n\t\t\tme.#store.set(id, style);\r\n\t\t}\r\n\r\n\t\tif (style && typeof style === 'string') {\r\n\t\t\tconst sheet = GSCacheStyles.create(id);\r\n\t\t\tsheet.replaceSync(style);\r\n\t\t}\r\n\r\n\t\treturn me.get(id);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Remove stylesheet by unique ID\r\n\t * @param {String} id \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic remove(id) {\r\n\t\treturn this.#store.delete(id);\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve stylesheet by unique ID\r\n\t * @param {String} id \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic get(id) {\r\n\t\treturn this.#store.get(id);\r\n\t}\r\n\r\n\t/**\r\n\t * Get list of dynamic styles\r\n\t * @returns {CSSStyleSheet}\r\n\t */\r\n\tstatic get dynamic() {\r\n\r\n\t\tconst me = GSCacheStyles;\r\n\t\tconst id = 'gs-dynamic';\r\n\t\t\r\n\t\tlet sheet = me.get(id);\r\n\t\tif (!sheet) {\r\n\t\t\tsheet = GSCacheStyles.create(id);\r\n\t\t\tdocument.adoptedStyleSheets = GSCacheStyles.styles;\r\n\t\t}\r\n\t\t\r\n\t\treturn sheet;\r\n\t}\r\n\r\n\t/**\r\n\t * Get individual rule from dynamic styles cache\r\n\t * @param {String} id \r\n\t * @returns {CSSRule}\r\n\t */\r\n\tstatic getRule(id = '') {\r\n\t\treturn GSCacheStyles.dynamic.getRule(id);\r\n\t}\r\n\r\n\t/**\r\n\t * Set dynamic element rule. Accepts string or json object representation\r\n\t * @param {String} id \r\n\t * @param {string|object} style \r\n\t */\r\n\tstatic setRule(id = '', style = '', sync = false) {\r\n\t\treturn GSCacheStyles.dynamic.setRule(id, style, sync);\r\n\t}\r\n\r\n\t/**\r\n\t * Remove dynamic element rule\r\n\t * @param {String} id  \r\n\t */\r\n\tstatic deleteRule(id = '') {\r\n\t\tGSCacheStyles.dynamic.deleteRule(id);\r\n\t}\r\n\r\n\t/**\r\n\t * Return list of registered style sheets\r\n\t * @returns {Array<CSSStyleSheet>}\r\n\t */\r\n\tstatic get styles() {\r\n\t\treturn Array.from(new Map([...GSCacheStyles.#store].sort((a, b) => String(a[0]).localeCompare(b[0]))).values());\r\n\t}\r\n\r\n\t/*\r\n\t* Inject CSS used by framework across all shadows\r\n\t*/\r\n\tstatic adopt(css = '', hash = 0) {\r\n\t\tif (!css) return;\r\n\t\ttry {\r\n\t\t\thash = hash || GSID.hashCode(css);\r\n\t\t\tGSCacheStyles.set(hash, css);\r\n\t\t\tdocument.adoptedStyleSheets = GSCacheStyles.styles;\r\n\t\t} catch (e) {\r\n\t\t\tGSLog.error(null, e);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.freeze(GSCacheStyles);\r\n\t\tglobalThis.GSCacheStyles = GSCacheStyles;\r\n\t\tGSCacheStyles.adopt(gsstyles);\r\n\t}\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\nimport { GSDOM } from './GSDOM.mjs';\r\nimport { GSEvents } from './GSEvents.mjs';\r\nimport { GSDOMObserver } from './GSDOMObserver.mjs';\r\nimport { GSCacheStyles } from './GSCacheStyles.mjs';\r\n\r\nconst adoptedId = Symbol();\r\nconst observer = Symbol();\r\n\r\n/**\r\n * Monitor HTMLStyleElement & HTMLLinkElement (of type stylesheet) for changes.\r\n * Every such element marked with data-adoptable=\"true\" will be cached and\r\n * will trigger gs-adopted event to notify component controller to update adoptableStyleSheet list\r\n */\r\nexport class GSAdoptedEngine {\r\n\r\n  static #timerID = 0;\r\n  static #ID = Date.now();\r\n  static #scheduled = false;\r\n\r\n  static #init() {\r\n    const me = GSAdoptedEngine;\r\n    me.observe(document.head);\r\n    me.#preload();\r\n    me.#timerID = setInterval(() => me.#adopt(), me.timeout);\r\n  }\r\n\r\n  static #clear() {\r\n    const me = GSAdoptedEngine;\r\n    clearInterval(me.#timerID);\r\n    me.#timerID = undefined;\r\n  }\r\n\r\n  static #adopt() {\r\n    const me = GSAdoptedEngine;\r\n    const sheets = me.#adoptable;\r\n    if (sheets.length == 0) return me.#clear();\r\n    sheets.map(s => me.#adoptSheet(s));\r\n    me.update();\r\n  }\r\n\r\n  static update() {\r\n    const me = GSAdoptedEngine;\r\n    if (me.#scheduled) return;\r\n    me.#scheduled = true;\r\n    queueMicrotask(() => {\r\n      requestAnimationFrame(() => {\r\n        try {\r\n          document.adoptedStyleSheets = me.#sorted;\r\n          document.adoptedStyleSheets.id = ++me.#ID;\r\n        } finally {\r\n          me.#scheduled = false;\r\n          globalThis.dispatchEvent(new CustomEvent('gs-adopted'));\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  static #asText(sheet) {\r\n    return Object.values(sheet.cssRules).map(o => o.cssText).join('');\r\n  }\r\n\r\n  static #adoptLink(el) {\r\n    const me = GSAdoptedEngine;\r\n    GSAdoptedEngine.#monitorAttributes(el);\r\n    Array.from(document.styleSheets).filter(s => s.ownerNode === el).map(s => me.#adoptSheet(s));\r\n  }\r\n\r\n  static #adoptSheet(sheet) {\r\n    const me = GSAdoptedEngine;\r\n    const style = me.#asText(sheet);\r\n    return me.#adoptStyle(sheet.ownerNode, style);\r\n  }\r\n\r\n  static #adoptStyle(ownerNode, style) {\r\n    const me = GSAdoptedEngine;\r\n    const sheet = new CSSStyleSheet();\r\n    sheet.replaceSync(style);\r\n    sheet.id = ++me.#ID;\r\n    ownerNode[adoptedId] = sheet.id;\r\n    me.#store(ownerNode, sheet);\r\n    return sheet;\r\n  }\r\n\r\n  static #store(ownerNode, sheet) {\r\n    GSCacheStyles.set(sheet.id, sheet);\r\n  }\r\n\r\n  static #remove(ownerNode, sheet) {\r\n    GSCacheStyles.remove(sheet.id);\r\n    ownerNode[observer]?.disconnect?.();\r\n    ownerNode[observer] = undefined;\r\n  }\r\n\r\n  static get #sorted() {\r\n    return GSCacheStyles.styles;\r\n  }\r\n\r\n  /**\r\n   * List of adoptable styles or links. Filter only those with dataset.adoptable=true\r\n   * @returns {HTMLStyleElement|HTMLLinkElement}\r\n   */\r\n  static get #adoptable() {\r\n    return Object.values(document.styleSheets)\r\n      .filter(o => o.ownerNode)\r\n      .filter(o => o.ownerNode.dataset.adoptable)\r\n      .filter(o => !o.ownerNode[adoptedId]);\r\n  }\r\n\r\n  static #preload() {\r\n    GSDOM.queryAll(document.head, 'link[rel=\"preload\"][as=\"style\"]')\r\n    .forEach(el => {\r\n      el.remove();\r\n      document.head.appendChild(el);\r\n    });\r\n  }\r\n\r\n  static #onAttributeChange(mutationList) {\r\n    mutationList.forEach((mutation) => {\r\n       const id = mutation.target[adoptedId];\r\n       const style = GSCacheStyles.get(id);\r\n       if(style) style.disabled = mutation.target.hasAttribute('disabled');\r\n    });\r\n    GSAdoptedEngine.update();\r\n  }\r\n  \r\n  static #monitorAttributes(element) {\r\n    const me = GSAdoptedEngine;\r\n    const callback = me.#onAttributeChange.bind(me);\r\n    const observer = new MutationObserver(callback);\r\n    observer.observe(element, {\r\n      attributeFilter: [\"disabled\"],\r\n      attributeOldValue: true,\r\n      subtree: false,\r\n    });\r\n    return observer;\r\n  }\r\n  \r\n  /**\r\n   * Filter style and link(css) elements which will be shared\r\n   * with all web componentes. Filter only those marked with data-adoptable\r\n   * @param {HTMLElement} el \r\n   * @returns {Boolean} Return true if monotired element is selected for further processing\r\n   */\r\n  static #onMonitorFilter(el) {\r\n    return (Boolean(el.dataset?.adoptable))\r\n      && (\r\n        (el instanceof HTMLLinkElement && (el.rel === 'stylesheet' || el.as === \"style\"))\r\n        || el instanceof HTMLStyleElement\r\n      );\r\n  }\r\n\r\n  /**\r\n   * When style added to the HTML page, attach it to the WebComponents\r\n   * @param {HTMLStyleElement|HTMLLinkElement} el \r\n   */\r\n  static #onMonitorConnect(el) {\r\n    const me = GSAdoptedEngine;\r\n    if (el instanceof HTMLStyleElement) {\r\n      me.#adoptStyle(el, el.innerText);\r\n      me.update();\r\n    } else if (el instanceof HTMLLinkElement) {\r\n      GSEvents.wait(el, 'load', 0, false).then(e => {\r\n        if (el.rel === 'preload') return el.rel = \"stylesheet\";\r\n        me.#adoptLink(e.target);\r\n        me.update();\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * When style removed, remove from adoptable and update\r\n   * @param {HTMLElement} el \r\n   */\r\n  static #onMonitorDisconnect(el) {\r\n    const me = GSAdoptedEngine;\r\n    me.#sorted.filter(o => o.id === el[adoptedId])\r\n          .forEach(o => me.#remove(el, o));\r\n    me.update();\r\n  }\r\n\r\n  /**\r\n   * Observe DOM tree from mutations\r\n   * @param {HTMLElement} owner Root element to watch DOM tree from \r\n   */\r\n  static observe(owner) {\r\n    const me = GSAdoptedEngine;\r\n    GSDOMObserver.registerFilter(me.#onMonitorFilter, me.#onMonitorConnect, false, owner);\r\n    GSDOMObserver.registerFilter(me.#onMonitorFilter, me.#onMonitorDisconnect, true, owner);\r\n  }\r\n\r\n  static {\r\n    this.#init();\r\n  }\r\n\r\n}  \r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSEnvironment class\r\n * @module base/GSEnvironment\r\n */\r\n\r\n/**\r\n * A set of static functions used for detecting browser environment\r\n * such as OS, orientation, browser type etc.\r\n * @class\r\n */\r\nexport class GSEnvironment {\r\n\r\n    /**\r\n     * Check if page is inside mobile device\r\n     * @returns {Boolean}\r\n     */\r\n    static get isMobile() {\r\n        if (navigator.userAgentData) return navigator.userAgentData.mobile;\r\n        return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\r\n    }\r\n\r\n    /** \r\n     * Check if page is inside desktop\r\n     * @returns {Boolean}\r\n     */\r\n    static get isDesktop() {\r\n        return !GSEnvironment.isMobile;\r\n    }\r\n\r\n    static get isWebkit() {\r\n        return /webkit/.test(navigator.userAgent.toLowerCase());\r\n    }\r\n\r\n    /**\r\n     * Check if value match current URL scheme\r\n     * @param {*} val \r\n     */  \r\n    static isValidProtocol(val = '') {\r\n        if (!val) return true;\r\n        return location.protocol.slice(0, -1) === val;\r\n\t}\r\n\r\n    /**\r\n     * Check if value match current browser type\r\n     * @param {String} val \r\n     * @returns {Boolean}\r\n     */\r\n    static isValidBrowser(val = '') {\r\n        if (!val) return true;\r\n        const strVal = val.toLowerCase();\r\n        if (navigator.userAgentData) {\r\n            let sts = false;\r\n            navigator.userAgentData.brands.forEach((v) => {\r\n                if (v.brand.toLowerCase().includes(strVal)) {\r\n                    sts = true;\r\n                }\r\n            });\r\n            return sts;\r\n        }\r\n        const strAgt = navigator.userAgent.toLocaleLowerCase() || '';\r\n        const isEdge = strAgt.includes('edg');\r\n        if (isEdge && strVal.startsWith('edg')) return true;\r\n        return !isEdge && strAgt.includes(strVal);\r\n    }\r\n\r\n    /**\r\n     * Returns if environment matched\r\n     * dektop, mobile, tablet, android, linux, windows, macos, ios\r\n     * @returns {Boolean}\r\n     */\r\n    static isValidEnvironment(val = '') {\r\n\r\n        if (!val) return true\r\n\r\n        if (val === 'desktop') {\r\n            return GSEnvironment.isDesktop;\r\n        }\r\n\r\n        if (val === 'mobile') {\r\n            return GSEnvironment.isMobile;\r\n        }\r\n\r\n        return GSEnvironment.isDevice(val);\r\n    }\r\n\r\n    /**\r\n     * Returns true if device /os is valid\r\n     * @param {String} val \r\n     * @returns {Boolean}\r\n     */\r\n    static isDevice(val = '') {\r\n        if (!val) return true;\r\n        const strVal = val.toLowerCase();\r\n\r\n        if (navigator.userAgentData && navigator.userAgentData.platform) {\r\n            const platform = navigator.userAgentData.platform.toLowerCase();\r\n            return platform === strVal;\r\n        }\r\n\r\n        const strAgt = navigator.userAgent.toLocaleLowerCase();\r\n        return strAgt.indexOf(strVal) > 1;\r\n    }\r\n\r\n    /**\r\n     * Returns if orientation matched\r\n     * horizontal, vertical, portrait, landscape\r\n     * retuns true if value not set\r\n     * \r\n     * @param {String} val\r\n     * @returns {Boolean}\r\n     */\r\n    static isValidOrientation(val = '') {\r\n\r\n        if (!val) return true;\r\n\r\n        if (!screen.orientation) return true;\r\n\r\n        const otype = screen.orientation.type;\r\n\r\n        if (otype.includes('portrait')) {\r\n            return val === 'portrait' || val === 'vertical';\r\n        }\r\n\r\n        if (otype.includes('landscape')) {\r\n            return val === 'landscape' || val === 'horizontal';\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSEnvironment);\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A module loading GSPromise class\r\n * @module base/GSPromise\r\n */\r\n\r\n/**\r\n * A Promise wrapper for timeouted and cancelable events\r\n * @class\r\n */\r\nexport class GSPromise {\r\n\r\n    #signal;\r\n    #callback;\r\n    #callbacks;\r\n    #resolve;\r\n    #reject;\r\n    #promise;\r\n\r\n    /**\r\n     * \r\n     * @param {*} callback \r\n     * @param {Number|AbortSignal} signal Timeout or custom signal\r\n     */\r\n    constructor(callback, signal) {\r\n        const me = this;\r\n        me.#callback = callback;\r\n        me.#signal = signal instanceof AbortSignal ? signal : null;\r\n        me.#signal = GSUtil.isNumber(signal) ? AbortSignal.timeout(signal) : me.#signal;\r\n        me.#callbacks = {\r\n            abort: me.#onAbort.bind(me)\r\n        };\r\n    }\r\n\r\n    await() {\r\n        const me = this;\r\n        if (me.#promise) return me.#promise;\r\n        me.#signal?.addEventListener('abort', me.#callbacks.abort);\r\n        me.#promise = new Promise(me.#wrap.bind(me));\r\n        return me.#promise;\r\n    }\r\n\r\n    get aborted() {\r\n        return this.#signal?.aborted === true;\r\n    }\r\n\r\n    #wrap(resolve, reject) {\r\n        const me = this;\r\n        me.#resolve = resolve;\r\n        me.#reject = reject;\r\n        try {\r\n            me.#callback(me.#onResolve.bind(me), me.#onReject.bind(me));\r\n        } catch (e) {\r\n            me.#clear();\r\n            reject(e);\r\n        }\r\n    }\r\n\r\n    #onAbort() {\r\n        const me = this;\r\n        me.#clear();\r\n        me.#reject(new Error('Promise aborted!'));\r\n    }\r\n\r\n    #onResolve(o) {\r\n        const me = this;\r\n        me.#clear();\r\n        return me.aborted ? null : me.#resolve(o);\r\n    }\r\n\r\n    #onReject(e) {\r\n        const me = this;\r\n        me.#clear();\r\n        return me.aborted ? null : me.#reject(e);\r\n    }\r\n\r\n    #clear() {\r\n        const me = this;\r\n        me.#signal?.removeEventListener('abort', me.#callbacks.abort);\r\n    }\r\n\r\n\t/**\r\n\t * Execute array of promisses sequentially\r\n\t * @param {Arrayy<Promise>} ps \r\n\t * @returns \r\n\t */\r\n\tstatic sequential(ps) {\r\n\t\tif (!Array.isArray(ps)) ps = [];\r\n\t\treturn ps.reduce((p, next) => p.then(next), Promise.resolve());\r\n\t}\r\n\r\n    static {\r\n        globalThis.GSPromise = GSPromise;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSPromise } from \"./GSPromise.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A module loading GSEvent class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Class extending native event with additional features\r\n * @Class\r\n */\r\nexport class GSEvent extends EventTarget {\r\n\r\n    #listeners = new Set();\r\n\r\n    #list(type = '', listener) {\r\n        const me = this;\r\n        const list = Array.from(me.#listeners);\r\n        return me.#isFunction(listener) ?\r\n            list.filter(o => o.type === type && o.listener === listener)\r\n            :\r\n            list.filter(o => o.type === type);\r\n    }\r\n\r\n    #isFunction(fn) {\r\n        return typeof fn === 'function';\r\n    }\r\n\r\n    /**\r\n     * Listen for events\r\n     * \r\n     * @param {String} type Event name to be listened\r\n     * @param {Function} listener  Callback to be called on event trigger\r\n     * @param {Number} timeout It event timeout set, return AbortSignal\r\n     * @param {boolean|AbortController} abortable If abortable set, return AbortController\r\n     */\r\n    on(type = '', listener, timeout = 0, abortable = false) {\r\n        if (!type) return reject('Event undefined!');\r\n        let controller = null;\r\n        if (abortable instanceof AbortController) {\r\n            controller = abortable;\r\n        } else {\r\n            controller = abortable ? new GSAbortController(timeout) : null;\r\n        }\r\n        const signal = controller || timeout == 0 ? controller?.signal : AbortSignal.timeout(timeout);\r\n        this.addEventListener(type, listener, { signal: signal });\r\n        return controller || signal;\r\n    }\r\n\r\n    /**\r\n     * Listen for events only once\r\n     * \r\n     * @param {String} type Event name to be listened\r\n     * @param {Function} listener  Callback to be called on event trigger\r\n     * @param {Number} timeout It event timeout set, return AbortSignal\r\n     * @param {boolean|AbortController} abortable If abortable set, return AbortController\r\n     */\r\n    once(type, listener, timeout = 0, abortable = false) {\r\n        if (!type) return reject('Event undefined!');\r\n        const me = this;\r\n        const wrap = (e) => {\r\n            listener(e);\r\n            me.#listeners.delete(wrap);\r\n        }\r\n        wrap.type = type;\r\n        wrap.listener = listener;\r\n        wrap.timeout = timeout;\r\n        if (abortable instanceof AbortController) {\r\n            wrap.controller = abortable;\r\n        } else {\r\n            wrap.controller = abortable ? new GSAbortController(timeout) : null;\r\n        }\r\n        wrap.signal = wrap.controller || timeout == 0 ? wrap.controller?.signal : AbortSignal.timeout(timeout);\r\n        me.addEventListener(type, wrap, { once: true, signal: wrap.signal });\r\n        return wrap.controller || wrap.signal;\r\n    }\r\n\r\n    /**\r\n     * Stop listening for events\r\n     * \r\n     * @param {String} type Event name to be listened\r\n     * @param {Function} listener  Callback to be called on event trigger\r\n     */\r\n    off(type = '', listener) {\r\n        this.removeEventListener(type, listener);\r\n    }\r\n\r\n    /**\r\n     * Send event to listeners\r\n     * \r\n     * @param {String} type Event name to be listened\r\n     * @param {Object} data  Data to send \r\n     * @param {Number} delayed Emit event delay in miliseconds\r\n     */\r\n    emit(type = '', data, delayed = 0) {\r\n        const me = this;\r\n        if (delayed === true) {\r\n            return queueMicrotask(() => me.#send(type, data));\r\n        }\r\n        delayed = GSUtil.asNum(delayed, 0);\r\n        if (delayed <= 0) return me.#send(type, data);\r\n        return setTimeout(() => me.#send(type, data), delayed);\r\n    }\r\n\r\n    #send(type = '', data) {\r\n        const evt = new CustomEvent(type, { detail: data });\r\n        return this.dispatchEvent(evt);\r\n    }\r\n\r\n    /**\r\n     * Wait for an event using GSPromise wrapper\r\n     * @param {String} type Event name to be listened\r\n     * @param {AbortSignal} signal Used to abort listener\r\n     * @returns {Event}\r\n    */\r\n    wait(type = '', signal) {\r\n        const me = this;\r\n        const callback = (resolve, reject) => {\r\n            me.once(type, resolve);\r\n        }\r\n        return new GSPromise(callback, signal).await();\r\n    }\r\n\r\n    listen(type, listener) { this.on(type, listener); }\r\n    unlisten(type, listener) { this.off(type, listener); }\r\n\r\n    /**\r\n     * Remove all listeners\r\n     */\r\n    unbind() {\r\n        const me = this;\r\n        Array.from(me.#listeners).forEach(o => {\r\n            super.removeEventListener(o.type, o.listener);\r\n        });\r\n        me.#listeners.clear();\r\n    }\r\n\r\n    addEventListener(type, listener, opt) {\r\n        const me = this;\r\n        if (!me.#isFunction(listener)) return false;\r\n        me.#listeners.add({ type: type, listener: listener });\r\n        return super.addEventListener(type, listener, opt);\r\n    }\r\n\r\n    removeEventListener(type, listener) {\r\n        const me = this;\r\n        const list = me.#list(type, listener);\r\n        list.forEach(o => super.removeEventListener(o.type, o.listener))\r\n        list.forEach(o => me.#listeners.delete(o));\r\n    }\r\n\r\n    static {\r\n        Object.freeze(GSEvent);\r\n        globalThis.GSEvent = GSEvent;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSEventBus class\r\n * @module base/GSEventBus\r\n */\r\n\r\nimport { GSEvent } from './GSEvent.mjs';\r\n\r\n/**\r\n * Class for handling shared events among components\r\n * Difference from native BroadcastChannel is :\r\n *  - support for multiple named events\r\n *  - does not work across different pages\r\n * @Class\r\n */\r\nexport class GSEventBus {\r\n\r\n    static #registry = new Map();\r\n\r\n    /**\r\n     * Static event emiter. If named event does not exist, create a new one\r\n     * \r\n     * @param {String} name EventBus name\r\n     * @param {String} type Event name\r\n     * @param {Object} data Dat to send\r\n     * \r\n     * @returns {boolean|object}\r\n     */\r\n    static send(name = '', type = '', data) {\r\n        return GSEventBus.register(name).emit(type, data);\r\n    }\r\n\r\n    /**\r\n     * Check if named event bus already exists\r\n     * \r\n     * @param {String} name \r\n     * @returns {Boolean}\r\n     */\r\n    static exist(name = '') {\r\n        return name && GSEventBus.#registry.has(name);\r\n    }\r\n\r\n    /**\r\n     * Register a named event bus. If already exists, will return existsing instance.\r\n     * @param {String} name unique bus name\r\n     * @returns {GSEventBus}\r\n     */\r\n    static register(name = '') {\r\n        if (!GSEventBus.exist(name)) {\r\n            GSEventBus.#registry.set(name, new GSEvent());\r\n        }\r\n        return GSEventBus.#registry.get(name);\r\n    }\r\n\r\n    /**\r\n     * Unregister named event bus from registry.\r\n     * @param {String} name unique buss name\r\n     * @returns {Boolean} State of removal.\r\n     */\r\n    static unregister(name = '') {\r\n        const bus = GSEventBus.#registry.get(name);\r\n        if (bus?.unbind) bus.unbind();\r\n        return GSEventBus.#registry.delete(name);\r\n    }\r\n\r\n    static {\r\n        Object.freeze(GSEventBus);\r\n        globalThis.GSEventBus = GSEventBus;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSGesture class\r\n * @module base/GSGesture\r\n */\r\nimport { GSEvents } from \"./GSEvents.mjs\";\r\n\r\n/**\r\n * A class for handling touch swipe and long press events.\r\n * @class\r\n */\r\nexport class GSGesture {\r\n\r\n    #xDiff = 0;\r\n    #yDiff = 0;\r\n    #xDown = null;\r\n    #yDown = null;\r\n    #element = null;\r\n    #bindings = null;\r\n\r\n    #swipe = false;\r\n    #tap = false;\r\n    #longPress = false;\r\n\r\n    // setTimeout id for longpress\r\n    #delay = 0;\r\n\r\n    // longpress delay\r\n    static timeout = 1500;\r\n\r\n    /**\r\n     * Constructor to attach Gesture featuer to an HTML element\r\n     * @param {HTMLElement} element \r\n     * @param {Boolean} swipe Monitor swipe gesture\r\n     * @param {Boolean} tap Monitor tap gesture\r\n     * @param {Boolean} longPress Monitor long press gesture\r\n     */\r\n    constructor(element, swipe, tap, longPress) {\r\n        const me = this;\r\n        me.#swipe = swipe;\r\n        me.#tap = tap;\r\n        me.#longPress = longPress;\r\n        me.#xDown = null;\r\n        me.#yDown = null;\r\n        me.#element = typeof (element) === 'string' ? document.querySelector(element) : element;\r\n\r\n        me.#bindings = {\r\n            move: me.#handleTouchMove.bind(me),\r\n            start: me.#handleTouchStart.bind(me),\r\n            end: me.#handleTouchEnd.bind(me)\r\n        };\r\n        GSEvents.attach(me.#element, me.#element, 'touchmove', me.#bindings.move, false);\r\n        GSEvents.attach(me.#element, me.#element, 'touchstart', me.#bindings.start, false);\r\n        GSEvents.attach(me.#element, me.#element, 'touchend', me.#bindings.end, false);\r\n    }\r\n\r\n    /**\r\n     * Remove gesture events from element\r\n     */\r\n    unbind() {\r\n        const me = this;\r\n        GSEvents.remove(me.#element, me.#element, 'touchmove', me.#bindings.move);\r\n        GSEvents.remove(me.#element, me.#element, 'touchstart', me.#bindings.start);\r\n        GSEvents.remove(me.#element, me.#element, 'touchend', me.#bindings.end);\r\n    }\r\n\r\n    #handleTouchStart(evt) {\r\n        const me = this;\r\n        me.#xDown = evt.touches[0].clientX;\r\n        me.#yDown = evt.touches[0].clientY;\r\n        if (me.#longPress) setTimeout(me.#onLongPress.bind(me), GSGesture.timeout);\r\n    }\r\n\r\n    #handleTouchEnd(evt) {\r\n        clearTimeout(this.#delay);\r\n    }\r\n\r\n    #handleTouchMove(evt) {\r\n\r\n        const me = this;\r\n\r\n        if (!me.#xDown || !me.#yDown) {\r\n            return;\r\n        }\r\n\r\n        if (!me.#swipe) return;\r\n\r\n        const xUp = evt.touches[0].clientX;\r\n        const yUp = evt.touches[0].clientY;\r\n\r\n        if (me.#longPress) {\r\n            const isMoving = Math.abs(me.#xDiff) > 10 && Math.abs(me.#yDiff) > 10;\r\n            if (isMoving) clearTimeout(me.#delay);\r\n        }\r\n\r\n        me.#xDiff = me.#xDown - xUp;\r\n        me.#yDiff = me.#yDown - yUp;\r\n\r\n        // Most significant.\r\n        const isHorisontal = Math.abs(me.#xDiff) > Math.abs(me.#yDiff);\r\n\r\n        let name = '';\r\n        if (isHorisontal) {\r\n            name = me.#xDiff > 0 ? 'swipe-left' : 'swipe-right';\r\n        } else {\r\n            name = me.#yDiff > 0 ? 'swipe-up' : 'swipe-down';\r\n        }\r\n\r\n        GSEvents.send(me.#element, name, evt);\r\n\r\n        // Reset values.\r\n        me.#xDown = null;\r\n        me.#yDown = null;\r\n    }\r\n\r\n    #onLongPress() {\r\n        GSEvents.send(me.#element, 'long-press');\r\n    }\r\n\r\n    /**\r\n     * Return number of fingers used in touch event\r\n     * @param {Event} e \r\n     * @returns {Number}\r\n     */\r\n    static fingers(e) {\r\n        return e.detail.touches?.length;\r\n    }\r\n\r\n    /**\r\n     * Attach swipe event to a element\r\n     * @param {HTMLElement} element \r\n     * @returns {GSGesture}\r\n     */\r\n    static attach(element, swipe = true, tap = false, longPress = false) {\r\n        return new GSGesture(element, swipe, tap, longPress);\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSAttr } from \"./GSAttr.mjs\";\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\n\r\n/**\r\n * A module loading GSItem class\r\n * @module base/GSItem\r\n */\r\n\r\n/**\r\n * Static class for handling generic configurable tag GS-ITEM\r\n */\r\nexport class GSItem extends HTMLElement {\r\n\r\n\tstatic #tags = ['GS-ITEM', 'TEMPLATE']\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tGSItem.validate(this);\r\n\t}\r\n\r\n\t/**\r\n\t * Return template content of GS-ITEM element (if exists)\r\n\t * \r\n\t * @param {HTMLElement} el \r\n\t * @returns {String}\r\n\t */\r\n\tget body() {\r\n\t\tlet tpl = GSAttr.get(this, 'template');\r\n\t\tif (tpl) return `<gs-template flat src=\"${tpl}\"></gs-template>`;\r\n\t\ttpl = this.querySelector('template');\r\n\t\treturn tpl?.innerHTML || '';\r\n\t}\r\n\r\n\t/**\r\n\t * Get first level of generic gs-item elements\r\n\t * @param {HTMLElement} root \r\n\t * @returns {Array<HTMLElement>} \r\n\t */\r\n\tget items() {\r\n\t\treturn Array.from(this.children).filter(el => el.tagName == 'GS-ITEM')\r\n\t}\r\n\r\n\tget name() {\r\n\t\treturn GSAttr.get(this, 'name', '');\r\n\t}\r\n\r\n\tasJSON(recursive = true) {\r\n\t\treturn GSDOM.toJson(this, recursive);\r\n\t}\r\n\r\n\t/**\r\n\t * Validate that parent element contains only specific childrens\r\n\t * @param {*} own \r\n\t * @param {*} tagName \r\n\t * @returns \r\n\t */\r\n\tstatic validate(own, tagName = 'GS-ITEM') {\r\n\t\treturn GSDOM.validate(own, tagName, GSItem.#tags);\r\n\t}\r\n\r\n\t/**\r\n\t * Get first level of generic gs-item element, used for configuring gs-* components\r\n\t * @param {HTMLElement} root \r\n\t * @returns {Array<HTMLElement>} \r\n\t */\r\n\tstatic collect(root) {\r\n\t\tif (!GSDOM.isHTMLElement(root)) return [];\r\n\t\treturn Array.from(root.children).filter(el => el.tagName == 'GS-ITEM')\r\n\t}\r\n\t\t\r\n\t/**\r\n\t * Convert GS-ITEM list to JSON\r\n\t * @param {HTMLElement} root Element containing GS-ITEM childs \r\n\t * @returns {Array} Arary of JSON objects\r\n\t */\r\n\tstatic toJSON(root) {\r\n\t\treturn GSItem.collect(root).map(el => el.asJSON(true));\r\n\t}\r\n\r\n\t/**\r\n\t * Make GS-ITEM attributes JSON compatible \r\n\t * @param {*} root \r\n\t * @param {*} definition \r\n\t * @returns \r\n\t */\r\n    static proxify(root, definition) {        \r\n        return GSItem.collect(root).map(el => GSAttr.proxify(el, definition));\r\n    }\r\n\r\n\tstatic {\r\n\t\tcustomElements.define('gs-item', GSItem);\r\n\t\tObject.seal(GSItem);\r\n\t}\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSLoader class\r\n * @module base/GSLoader\r\n */\r\n\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSLog } from \"./GSLog.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSVersion } from \"./GSVersion.mjs\";\r\n\r\n/**\r\n * A set of static functions used for loading resources\r\n * @class\r\n */\r\nexport class GSLoader {\r\n\r\n    static TEMPLATE_URL = globalThis.GS_TEMPLATE_URL || location.origin;\r\n    static NO_CACHE = false;\r\n    static UNIQUE = GSVersion.build;\r\n\r\n    static {\r\n        if (!globalThis.GS_TEMPLATE_URL) {\r\n            const url = location.href.split('?').pop();\r\n            let seg = url.split('/');\r\n            GSLoader.TEMPLATE_URL = url.endsWith('/') ? url : seg.slice(0, -1).join('/');\r\n            globalThis.GS_TEMPLATE_URL = GSLoader.TEMPLATE_URL;\r\n        }\r\n\r\n        //const hasKey = Object.hasOwn(self, 'GS_NO_CACHE');\r\n        const hasKey = 'GS_NO_CACHE' in self;\r\n        if (hasKey) {\r\n            GSLoader.NO_CACHE = globalThis.GS_NO_CACHE === true;\r\n            if (localStorage) localStorage.setItem('GS_NO_CACHE', GSLoader.NO_CACHE);\r\n        }\r\n        GSLoader.NO_CACHE = localStorage ? localStorage.getItem('GS_NO_CACHE') == 'true' : false;\r\n\r\n    }\r\n    /**\r\n     * Convert partial URL to a real URL\r\n     * @param {String} url \r\n     * @return {String}\r\n     */\r\n    static normalizeURL(url = '', base = false) {\r\n\r\n        url = url || '';\r\n        let path = null;\r\n        const isFile = location.pathname.split('/').pop(-1).includes('\\.');\r\n        const isExt = url.includes('extension:/');\r\n        const isUrl = url.startsWith('http');\r\n\r\n        if (isUrl || isExt) {\r\n            path = url;\r\n        } else if (url.startsWith('/')) {\r\n            path = `${location.origin}/${url}`;\r\n        } else if (isFile) {\r\n            path = `${location.origin}${location.pathname}/../${url}`;\r\n        } else {\r\n            path = `${location.origin}${location.pathname}/${url}`;\r\n        }\r\n\r\n        path = path.split('://').map(v => v.replaceAll(/\\/{2,}/g, '/')).join('://');\r\n        const uri = new URL(path);\r\n\r\n        // to handle caching\r\n        //if (!base && GSLoader.NO_CACHE) uri.searchParams.append('_dc', Date.now());\r\n        if (!base) {\r\n            const val = GSLoader.NO_CACHE ? Date.now() : GSLoader.UNIQUE;\r\n            uri.searchParams.append('_dc', val);\r\n        }\r\n\r\n        return uri.href;\r\n    }\r\n\r\n    /**\r\n     * Extrach parent path from provided URL string\r\n     * @param {String} url \r\n     * @param {Number} level How many levels to go up the chain\r\n     * @returns {String}\r\n     */\r\n    static parentPath(url = '', level = 1) {\r\n        return (url || '').split('/').slice(0, -1 * level).join('/') + '/';\r\n    }\r\n\r\n    /**\r\n     * Used for override to get predefined template\r\n     * Can be html source or url, checks if load or not\r\n     * \r\n     * @async\r\n     * @param {String} def\r\n     * @return {Promise<string>}\r\n     */\r\n    static async getTemplate(def = '') {\r\n\r\n        if (!def) return def;\r\n\r\n        const isRef = def.startsWith('#');\r\n        if (isRef) {\r\n            const el = GSDOM.query(document.documentElement, def);\r\n            return el ? el.innerHTML : def;\r\n        }\r\n\r\n        const isHTML = GSUtil.isHTML(def);\r\n        if (isHTML) return def;\r\n\r\n        def = GSLoader.#getTemplateURL(def);\r\n        return GSLoader.loadSafe(def);\r\n    }\r\n\r\n    /**\r\n     * Decode template URL into a real URL\r\n     * @param {String} url \r\n     * @return {String}\r\n     */\r\n    static #getTemplateURL(url = '') {\r\n        /*\r\n        const isDirect =  /^(https?:\\/\\/)/i.test(url);\r\n        url = isDirect ? url : GSLoader.#templateURL + '/' + url;\r\n        */\r\n        url = url.startsWith('//') ? GSLoader.#templateURL + '/' + url : url;\r\n        return GSLoader.normalizeURL(url);\r\n    }\r\n\r\n    /**\r\n     * Retrieve default template url\r\n     * @return {String}\r\n     */\r\n    static get #templateURL() {\r\n        return GSLoader.normalizeURL(GSLoader.#templatePath, true);\r\n    }\r\n\r\n    /**\r\n     * Retrieve defult template path\r\n     * @return {String}\r\n     */\r\n    static get #templatePath() {\r\n        return GSLoader.TEMPLATE_URL ? GSLoader.TEMPLATE_URL.replace('//', '/') : '';\r\n    }\r\n\r\n    /**\r\n     * Load html template (used for template cache)\r\n     * \r\n     * @async\r\n     * @param {String} val Full or partial url path\r\n     * @param {String} method HTTP methog get|put|post\r\n     * @returns {Promise<string>}\r\n     * @throws {Error}\r\n     */\r\n    static async loadTemplate(val = '', method = 'GET') {\r\n        const url = GSLoader.#getTemplateURL(val);\r\n        return await GSLoader.load(url, method);\r\n    }\r\n\r\n    /**\r\n     * Load remote data as text (for loading templates)\r\n     * \r\n     * @async\r\n     * @param {String} val Full or partial url path\r\n     * @param {String} method HTTP methog get|put|post\r\n     * @param {Boolean} asjson Parse returned data as JSON\r\n     * @returns {Promise<object|string>}\r\n     */\r\n    static async load(val = '', method = 'GET', headers, asjson = false, body) {\r\n        let data = null;\r\n        const ct = 'Content-Type';\r\n        headers = { ...headers };\r\n        headers[ct] = asjson ? 'application/json; utf-8' : headers[ct] || 'text/plain';\r\n        headers.Accept = 'application/json';\r\n        const url = GSLoader.normalizeURL(val, true);\r\n        const opt = { method: method, headers: headers };\r\n        if (method === 'POST' || method === 'PUT' && body) {\r\n            opt.body = JSON.stringify(body);\r\n        }\r\n        const res = await fetch(url, opt);\r\n        if (res.ok) data = asjson ? await res.json() : await res.text();\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * Load remote data without throwing an exception\r\n     * \r\n     * @async\r\n     * @param {String} url Full or partial url path\r\n     * @param {String} method http method GET|POST|PUT\r\n     * @param {Object} headers return json or string\r\n     * @param {Boolean} asjson return json or string\r\n     * @param {Object} dft default value\r\n     * @returns {Promise<object|string>}\r\n     */\r\n    static async loadSafe(url = '', method = 'GET', headers, asjson = false, dft, body) {\r\n        try {\r\n            if (url) return GSLoader.load(url, method, headers, asjson, body);\r\n        } catch (e) {\r\n            GSLog.error(null, e);\r\n        }\r\n        if (dft) return dft;\r\n        return asjson ? {} : '';\r\n    }\r\n\r\n\r\n    /**\r\n     * Load data from various sources\r\n     * \r\n     * @async\r\n     * @param {JSON|func|url} val \r\n     * @returns {Promise}\r\n     */\r\n    static async loadData(val = '') {\r\n\r\n        const isJson = GSUtil.isJson(val);\r\n        const func = !isJson && GSFunction.parseFunction(val);\r\n        const isFunc = func && GSFunction.isFunction(func);\r\n        const isData = !isFunc && GSUtil.parseValue(val);\r\n\r\n        if (isData || isJson) val = GSUtil.toJson(val);\r\n\r\n        if (isFunc) val = await GSFunction.callFunction(func);\r\n\r\n        if (!GSUtil.isJsonType(val)) return;\r\n\r\n        return val;\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSLoader);\r\n        globalThis.GSLoader = GSLoader;\r\n    }\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\nimport { GSID } from './GSID.mjs';\r\nimport { GSLoader } from './GSLoader.mjs';\r\nimport { GSPromise } from './GSPromise.mjs';\r\nimport { GSEvents } from './GSEvents.mjs';\r\nimport { GSUtil } from './GSUtil.mjs';\r\n\r\n/**\r\n * A module loading GSLocalization class\r\n * @module base/GSLocalization\r\n */\r\n\r\nconst GS_LOCALIZATION_LANGUAGE = globalThis.GS_LOCALIZATION_LANGUAGE || document.documentElement.lang || navigator.language;\r\n\r\n/**\r\n * Generic text translation engine.\r\n * Each JSON langauge file is of 2 files format \r\n * default.json  {'UI text', 'KEY_NAME'}\r\n * language.json {$language$: 'langauge_name', KEY_NAME : 'translation text'}\r\n * @class\r\n */\r\nclass GSLocalizationImpl {\r\n\r\n    #languages = new Map();\r\n    #queue = new Set();\r\n    #queued = false;\r\n\r\n    #url = globalThis.GS_LOCALIZATION_URL;\r\n    #default = GS_LOCALIZATION_LANGUAGE;\r\n    #language;\r\n\r\n    constructor() {\r\n        this.load();\r\n    }\r\n\r\n    /**\r\n     * Default page langugae, use page language, or browser languge if value not set\r\n     */\r\n    get default() {\r\n        return this.#default;\r\n    }\r\n\r\n    set default(val = '') {\r\n        this.#default = val || GS_LOCALIZATION_LANGUAGE;\r\n    }\r\n\r\n    /**\r\n     * Language to which to translate\r\n     */\r\n    get lang() {\r\n        return this.#language || this.default;\r\n    }\r\n\r\n    set lang(val = '') {\r\n        this.#language = val;\r\n    }\r\n\r\n    /**\r\n     * URL from where to load JSON translation documents\r\n     */\r\n    get url() {\r\n        return this.#url;\r\n    }\r\n\r\n    set url(val = '') {\r\n        this.#url = val || globalThis.GS_LOCALIZATION_URL;\r\n    }\r\n\r\n    translate(language = '', value = '') {\r\n        const me = this;\r\n        if (GSUtil.isStringEmpty(language)) return value;\r\n        if (!me.#languages.has(language)) {\r\n            me.load(language);\r\n            return value;\r\n        }\r\n        const deft = me.#getLanguage('default');\r\n        const lang = me.#getLanguage(language);\r\n        const texthash = deft.get(GSID.hashCode(value));\r\n        return texthash ? lang.get(texthash) || value : value;\r\n    }\r\n\r\n    reset() {\r\n        const me = this;\r\n        me.#default = GS_LOCALIZATION_LANGUAGE;\r\n        me.#language = undefined;\r\n        me.load();\r\n    }\r\n\r\n    load(language = 'default') {\r\n        const me = this;\r\n        if (GSUtil.isStringEmpty(language)) return;\r\n        if (GSUtil.isStringEmpty(me.url)) return;\r\n        if (me.#languages.has(language)) return;\r\n        me.#queue.add(language);\r\n        if (me.#queued) return;\r\n        me.#queued = true;\r\n        queueMicrotask(async () => {\r\n            const promises = Array.from(me.#queue.values()).map(l => me.loadWait(l));\r\n            await GSPromise.sequential(promises);\r\n            me.#queued = false;\r\n        });\r\n\r\n    }\r\n\r\n    async loadWait(language) {\r\n        const me = this;\r\n        if (GSUtil.isStringEmpty(language)) return;\r\n        if (GSUtil.isStringEmpty(me.url)) return;\r\n        const headers = {\r\n            'Cache-Control': 'no-cache',\r\n            'Pragma': 'no-cache'\r\n        };\r\n        const url = GSLoader.normalizeURL(`${me.url}/${language}.json`);\r\n        let res = await GSLoader.loadSafe(url, 'GET', headers, true);\r\n        if (!res && language.indexOf('-') > 0) res = await me.loadWait(language.split('-')[0]);\r\n        if (!res) return false;\r\n        me.#queue.delete(language);\r\n        me.#store(language, res);\r\n    }\r\n\r\n    /**\r\n     * Store object properties as set of key-value pairs,\r\n     * keys are not stores as name, but as hash calc\r\n     * values double stored as a hash-key/value and hash-value/hash-key\r\n     * \r\n     * @param {string} lang \r\n     * @param {object} obj \r\n     * @returns \r\n     */\r\n    #store(lang, obj) {\r\n        if (!(obj && lang)) return false;\r\n        const isDefault = lang === 'default';\r\n        const map = this.#getLanguage(lang);\r\n        Object.entries(obj).forEach((kv) => {\r\n            const hk = GSID.hashCode(kv[0].trim());\r\n            map.set(hk, isDefault ? GSID.hashCode(kv[1]) : kv[1]);\r\n        });\r\n        GSEvents.send(window, 'gs-language', { details: lang });\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Get language map. Create a new one if not found.\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    #getLanguage(val = '') {\r\n        const me = this;\r\n        if (!me.#languages.has(val)) {\r\n            me.#languages.set(val, new Map());\r\n        }\r\n        return me.#languages.get(val);\r\n    }\r\n\r\n}\r\n\r\nexport const GSLocalization = new GSLocalizationImpl();","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSPopper class\r\n * @module base/GSPopper\r\n */\r\n\r\nimport { GSLog } from \"./GSLog.mjs\";\r\nimport { GSCSSMap } from \"./GSCSSMap.mjs\";\r\nimport { GSDynamicStyle } from \"./GSDynamicStyle.mjs\";\r\n\r\n/**\r\n * A generic set of static functions used across GS WebComponents framework\r\n * used for placing elements at fixed positions.\r\n * Also used to replace Bootstrap popper.\r\n * @class\r\n */\r\nexport class GSPopper {\r\n\r\n\t/**\r\n\t * A simple wrapper to get element DOMRect\r\n\t * @param {HTMLElement} el \r\n\t * @returns {DOMRect}\r\n\t */\r\n\tstatic asRect(el) {\r\n\t\treturn el.getBoundingClientRect();\r\n\t}\r\n\r\n\t/**\r\n\t * Get element offset position\r\n\t * Returns absolute position {left:0, top:0, width:0, height:0,centeY:0 centerX:0}\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Object} \r\n\t */\r\n\tstatic getOffset(el) {\r\n\t\tconst rect = GSPopper.asRect(el);\r\n\t\tconst sx = window.scrollX;\r\n\t\tconst sy = window.scrollY;\r\n\t\tconst obj = {\r\n\t\t\tleft: rect.left + sx,\r\n\t\t\tright: rect.right + sx,\r\n\t\t\ttop: rect.top + sy,\r\n\t\t\tbottom: rect.bottom + sy,\r\n\t\t\theight: rect.height,\r\n\t\t\twidth: rect.width,\r\n\t\t\tx: rect.x + sx,\r\n\t\t\ty: rect.y + sy\r\n\t\t};\r\n\t\tobj.centerX = obj.left + (obj.width / 2);\r\n\t\tobj.centerY = obj.top + (obj.height / 2);\r\n\t\treturn obj;\r\n\t}\r\n\r\n\t/**\r\n\t * Return element position and size without padding\r\n\t * Returned objext is the same format as native getBoundingRect\r\n\t * @param {HTMLElement} element \r\n\t * @returns {Object} \r\n\t */\r\n\tstatic boundingRect(element, calcPadding) {\r\n\r\n\t\tconst rect = GSPopper.asRect(element);\r\n\t\tconst padding = GSPopper.elementPadding(calcPadding ? element : null);\r\n\r\n\t\tconst paddingX = padding.x;\r\n\t\tconst paddingY = padding.y;\r\n\r\n\t\tconst elementWidth = element.clientWidth - paddingX;\r\n\t\tconst elementHeight = element.clientHeight - paddingY;\r\n\r\n\t\tconst elementX = rect.left + padding.left;\r\n\t\tconst elementY = rect.top + padding.top;\r\n\r\n\t\tconst centerX = (elementWidth / 2) + elementX;\r\n\t\tconst centerY = elementY + (elementHeight / 2);\r\n\r\n\t\treturn {\r\n\t\t\twidth: elementWidth,\r\n\t\t\theight: elementHeight,\r\n\t\t\ttop: elementY,\r\n\t\t\tleft: elementX,\r\n\t\t\tx: elementX,\r\n\t\t\ty: elementY,\r\n\t\t\tcenterX: centerX,\r\n\t\t\tcenterY: centerY\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * Calculate element padding\r\n\t * @param {HTMLElement} element \r\n\t * @returns {Object}\r\n\t */\r\n\tstatic elementPadding(element) {\r\n\r\n\t\tconst obj = {\r\n\t\t\tleft: 0,\r\n\t\t\tright: 0,\r\n\t\t\ttop: 0,\r\n\t\t\tbottom: 0,\r\n\t\t\tx: 0,\r\n\t\t\ty: 0\r\n\t\t};\r\n\r\n\t\tconst isEl = element instanceof HTMLElement;\r\n\t\tif (!isEl) return obj;\r\n\t\tconst css = GSCSSMap.getComputedStyledMap(element);\r\n\r\n\t\tobj.left = css.asNum('padding-left');\r\n\t\tobj.right = css.asNum('padding-right');\r\n\t\tobj.top = css.asNum('padding-top');\r\n\t\tobj.bottom = css.asNum('padding-bottom');\r\n\t\tobj.x = obj.left + obj.right;\r\n\t\tobj.y = obj.top + obj.bottom;\r\n\r\n\t\treturn obj;\r\n\t}\r\n\r\n\t/**\r\n\t * Fixed positioning on a viewport.\r\n\t * @param {String} placement Location on target element top|bottom|left|right\r\n\t * @param {HTMLElement} source Element to show\r\n\t * @param {HTMLElement} target Element location at which to show\r\n\t * @param {Boolean} arrow if true, will calculate arrow position\r\n\t * @returns {void}\r\n\t */\r\n\tstatic popupFixed(placement = 'top', source, target, arrow) {\r\n\r\n\t\tif (!(source && target)) return false;\r\n\r\n\t\tconst pos = GSPopper.#fromPlacement(placement);\r\n\r\n\t\tif (!GSPopper.#isPlacementValid(pos)) {\r\n\t\t\tGSLog.warn(source, `Invalid popover position: ${placement}!`);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst style = GSDynamicStyle.dynamicStyle(source);\r\n\r\n\t\tconst css = {\r\n\t\t\tposition: 'fixed',\r\n\t\t\ttop: '0px',\r\n\t\t\tleft: '0px',\r\n\t\t\tmargin: '0px',\r\n\t\t\tpadding: '0px',\r\n\t\t\ttransform: '',\r\n\t\t\ttranslate: ''\r\n\t\t};\r\n\r\n\t\tObject.assign(style, css);\r\n\r\n\t\tconst offh = source.clientHeight / 2;\r\n\t\tconst offw = source.clientWidth / 2;\r\n\r\n\t\tconst rect = GSPopper.boundingRect(target, arrow instanceof HTMLElement);\r\n\t\tconst arect = GSPopper.#updateArrow(source, arrow, pos);\r\n\r\n\t\tconst obj = {\r\n\t\t\tx: rect.centerX,\r\n\t\t\ty: rect.centerY,\r\n\t\t\toffH: offh,\r\n\t\t\toffW: offw,\r\n\t\t\tsrcH: source.clientHeight,\r\n\t\t\tsrcW: source.clientWidth\r\n\t\t}\r\n\r\n\t\tGSPopper.#calcFixed(pos, obj, rect, arect);\r\n\t\tstyle.translate = `${obj.x}px ${obj.y}px`;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Place element around target element. Bootstrap support for popup etc.\r\n\t * @param {String} placement Location on target element top|bottom|left|right\r\n\t * @param {HTMLElement} source Element to show\r\n\t * @param {HTMLElement} target Element location at which to show\r\n\t * @param {Boolean} arrow if true, will calculate arrow position\r\n\t * @returns {void}\r\n\t */\r\n\tstatic popupAbsolute(placement = 'top', source, target, arrow) {\r\n\r\n\t\tif (!(source && target)) return false;\r\n\r\n\t\tconst pos = GSPopper.#fromPlacement(placement);\r\n\r\n\t\tif (!GSPopper.#isPlacementValid(pos)) {\r\n\t\t\tGSLog.warn(source, `Invalid popover position: ${placement}!`);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst style = GSDynamicStyle.dynamicStyle(source);\r\n\t\tconst astyle = GSDynamicStyle.dynamicStyle(arrow);\r\n\r\n\t\tconst css = {\r\n\t\t\tinset: GSPopper.#inset(pos),\r\n\t\t\tposition: 'absolute',\r\n\t\t\tmargin: '0px',\r\n\t\t\ttop: '0px',\r\n\t\t\tleft: '0px',\r\n\t\t\twidth: 'max-content',\r\n\t\t\theight: 'max-content',\t\t\t\r\n\t\t\ttransform: '',\r\n\t\t\ttranslate: ''\r\n\t\t};\r\n\r\n\t\tObject.assign(style, css);\r\n\t\tastyle.position = 'absolute';\r\n\r\n\t\tconst srect = GSPopper.asRect(source);\r\n\t\tconst arect = GSPopper.asRect(arrow);\r\n\t\tconst offset = GSPopper.getOffset(target);\r\n\r\n\t\tconst obj = {\r\n\t\t\tx: offset.centerX,\r\n\t\t\ty: offset.centerY\r\n\t\t}\r\n\r\n\t\tconst arr = {\r\n\t\t\tx: (srect.width / 2) - (arect.width / 2),\r\n\t\t\ty: (srect.height / 2) - (arect.height / 2)\r\n\t\t}\r\n\r\n\t\tGSPopper.#calcAbsolute(pos, obj, arr, srect, arect, offset);\r\n\r\n\t\tconst aopt = {\r\n\t\t\ttranslate: `${arr.x}px ${arr.y}px`,\r\n\t\t\ttop: arr.top ? arr.top : '',\r\n\t\t\tleft: arr.left ? arr.left : ''\r\n\t\t}\r\n\r\n\t\tconst opt = {\r\n\t\t\ttranslate : `${obj.x}px ${obj.y}px`\r\n\t\t};\r\n\r\n\t\tObject.assign(style, opt);\r\n\t\tObject.assign(astyle, aopt);\r\n\t}\r\n\r\n\tstatic #calcAbsolute(pos, obj, arr, srect, arect, offset) {\r\n\t\tif (pos.isTop) {\r\n\t\t\tarr.y = 0;\r\n\t\t\tarr.left = '0px';\r\n\t\t\tobj.x = obj.x - (srect.width / 2);\r\n\t\t\tobj.y = -1 * (srect.bottom - offset.top + arect.height);\r\n\t\t} else if (pos.isBottom) {\r\n\t\t\tarr.y = 0;\r\n\t\t\tarr.left = '0px';\r\n\t\t\tobj.x = obj.x - (srect.width / 2);\r\n\t\t\tobj.y = offset.bottom + arect.height;\r\n\t\t} else if (pos.isStart) {\r\n\t\t\tarr.x = 0;\r\n\t\t\tarr.top = '0px';\r\n\t\t\tobj.x = -1 * (srect.right - offset.left + arect.width);\r\n\t\t\tobj.y = obj.y - (srect.height / 2);\r\n\t\t} else if (pos.isEnd) {\r\n\t\t\tarr.x = 0;\r\n\t\t\tarr.top = '0px';\r\n\t\t\tobj.x = offset.right + arect.width;\r\n\t\t\tobj.y = obj.y - (srect.height / 2);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic #calcFixed(pos, obj, trect, arect) {\r\n\t\tif (pos.isTop) {\r\n\t\t\tobj.y = trect.top - obj.srcH - arect.size;\r\n\t\t\tobj.x = obj.x - obj.offW;\r\n\t\t} else if (pos.isBottom) {\r\n\t\t\tobj.y = trect.top + trect.height + arect.size;\r\n\t\t\tobj.x = obj.x - obj.offW;\r\n\t\t} else if (pos.isStart) {\r\n\t\t\tobj.x = trect.left - obj.srcW - arect.size;\r\n\t\t\tobj.y = obj.y - obj.offH + arect.size;\r\n\t\t} else if (pos.isEnd) {\r\n\t\t\tobj.x = trect.left + trect.width + arect.size;\r\n\t\t\tobj.y = obj.y - obj.offH + arect.size;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic #inset(obj) {\r\n\t\tif (obj.isTop) {\r\n\t\t\treturn 'auto auto 0px 0px';\r\n\t\t} else if (obj.isBottom) {\r\n\t\t\treturn '0px auto auto 0px';\r\n\t\t} else if (obj.isStart) {\r\n\t\t\treturn '0px 0px auto auto';\r\n\t\t} else if (obj.isEnd) {\r\n\t\t\treturn '0px auto auto 0px';\r\n\t\t}\r\n\t}\r\n\r\n\tstatic #isPlacementValid(obj) {\r\n\t\treturn obj.isStart || obj.isEnd || obj.isTop || obj.isBottom;\r\n\t}\r\n\r\n\tstatic #fromPlacement(placement) {\r\n\t\treturn {\r\n\t\t\tisStart: placement == 'start' || placement == 'left',\r\n\t\t\tisEnd: placement == 'end' || placement == 'right',\r\n\t\t\tisTop: placement == 'top',\r\n\t\t\tisBottom: placement == 'bottom'\r\n\t\t}\r\n\t}\r\n\r\n\tstatic #updateArrow(element, arrow, pos) {\r\n\r\n\t\tif (!arrow) return { x: 0, y: 0, size: 0, width: 0, height: 0 };\r\n\r\n\t\tlet shift = 0;\r\n\t\tconst erect = GSPopper.boundingRect(element);\r\n\t\tconst arect = GSPopper.boundingRect(arrow);\r\n\r\n\t\tconst size = pos.isStart || pos.isEnd ? arect.width : arect.height;\r\n\r\n\t\tconst arrowPosW = (erect.width / 2) - (size / 2);\r\n\t\tconst arrowPosH = (erect.height / 2) - (size / 2);\r\n\r\n\t\tarect.size = size;\r\n\r\n\t\tconst opt = {};\r\n\r\n\t\topt.position = 'absolute';\r\n\r\n\t\tif (pos.isStart || pos.isEnd) {\r\n\t\t\topt.left = '';\r\n\t\t\topt.top = '0px';\r\n\t\t\tshift = 0; //pos.isStart ? size : -1 * size;\r\n\t\t\topt.translate = `${shift}px ${arrowPosH / 2}px`;\r\n\t\t} else {\r\n\t\t\topt.top = '';\r\n\t\t\topt.left = '0px';\r\n\t\t\tshift = 0; //pos.isTop ? size : -1 * size;\r\n\t\t\topt.translate = `${arrowPosW}px ${shift}px`;\r\n\t\t}\r\n\r\n\t\tGSDynamicStyle.applyDynamicStyle(arrow, opt);\r\n\r\n\t\treturn arect;\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.seal(GSPopper);\r\n\t\tglobalThis.GSPopper = GSPopper;\r\n\t}\r\n}\r\n\r\n\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * Proxy class to handle chained css.\r\n * Used internally, see GSQuery class.\r\n */\r\nexport class GSQueryCSS {\r\n\r\n    #map = null;\r\n\r\n    constructor(element) {\r\n        if (!GSDOM.isHTMLElement(element)) throw new Error('Only HTMLElement type allowed!');\r\n        this.#map = new GSCSSMap(element);\r\n    }\r\n\r\n    #isFunc(property) {\r\n        return GSFunction.hasFunction(this.#map, property);\r\n    }\r\n\r\n    get(object, property, receiver) {\r\n        return (value, dft) => {\r\n            const me = this;\r\n            if (GSUtil.isNull(value)) return me.#map.get(property);\r\n            if (me.#isFunc(property)) return me.#map[property](value, dft);\r\n            object[property] = value;\r\n            return receiver;\r\n        }\r\n    }\r\n\r\n    static wrap(element) {\r\n        return new Proxy(element.style, new GSQueryCSS(element));\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSQueryCSS } from \"./GSQueryCSS.mjs\";\r\n\r\n/**\r\n * Proxy class for wrapping HTMLElement, allowing to use GS query across shadow dom\r\n * and css operations for easier property get /set\r\n * \r\n * const el = GSQuery.wrap(document.body);\r\n * el.query('div') // query across shadow dom\r\n * el.css = {width:'100px'} // easier way to set css\r\n * \r\n * // chained css property setup\r\n * el.css.width('100px').background('red')\r\n * \r\n * // retrieve calculated value\r\n * console.log(el.css.background)\r\n * console.log(el.css.asNum('width'))\r\n */\r\nexport class GSQuery {\r\n\r\n    #css = null;\r\n\r\n    constructor(element) {\r\n        if (!Array.isArray(element)) this.#css = GSQueryCSS.wrap(element);\r\n    }\r\n\r\n    get(object, property) {\r\n        if (property === 'css') return this.#css;\r\n        if (property === 'query') {\r\n            return (value, all, shadow) => {\r\n                const el = GSDOM.query(object, value, all, shadow);\r\n                return GSQuery.wrap(el);\r\n            }\r\n        }\r\n        if (property === 'queryAll') {\r\n            return (value, all, shadow) => {\r\n                const el = GSDOM.queryAll(object, value, all, shadow);\r\n                return GSQuery.wrap(el);\r\n            }\r\n        }\r\n        return object[property];\r\n    }\r\n\r\n    set(object, property, value) {\r\n        switch (property) {\r\n            case 'css':\r\n                if (Array.isArray(object)) {\r\n                    object.forEach(element => element[property] = value);\r\n                } else {\r\n                    GSDOM.css(object, value);\r\n                }\r\n                break;\r\n            default:\r\n                object[property] = value;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    static instance(node) {\r\n        return new Proxy(node, new GSQuery(node));\r\n    }\r\n\r\n    static wrap(node) {\r\n        if (GSDOM.isHTMLElement(node)) return GSQuery.instance(node);\r\n        if (!Array.isArray(node)) return node;\r\n        node = node.map(element => GSQuery.wrap(element));\r\n        return GSQuery.instance(node);\r\n    }\r\n\r\n    static all(own, qry, all, shadow) {\r\n        return GSQuery.wrap(GSDOM.queryAll(own, qry, all, shadow));\r\n    }\r\n\r\n    static first(own, qry, all, shadow) {\r\n        return GSQuery.wrap(GSDOM.query(own, qry, all, shadow));\r\n    }\r\n\r\n    static {\r\n        Object.freeze(GSQuery);\r\n        globalThis.GSQuery = GSQuery;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2022  Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSTemplateCache class\r\n * @module templating/GSTemplateCache\r\n */\r\n\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSLoader } from \"./GSLoader.mjs\";\r\nimport { GSLog } from \"./GSLog.mjs\";\r\n\r\n/**\r\n * Template cache to store loaded and preprocessed templates for reuse\r\n * @class\r\n */\r\nexport class GSTemplateCache {\r\n\r\n\tstatic #store = new Map();\r\n\r\n\t/**\r\n\t * Store pre-processed template into a cache under given name. \r\n\t * Name is usually a path to a template.\r\n\t * @param {String} name Name of a template\r\n\t * @param {HTMLTemplateElement} template Preprocessed template\r\n\t */\r\n\tstatic store(name, template) {\r\n\t\tthis.#store.set(name, template);\r\n\t}\r\n\r\n\t/**\r\n\t * Remove template from cache\r\n\t * @param {String} name Name of a template\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic remove(name) {\r\n\t\treturn this.#store.delete(name);\r\n\t}\r\n\r\n\t/**\r\n\t * Get template from cache by it's name.\r\n\t * @param {*} name Name of a template\r\n\t * @returns {HTMLTemplateElement}\r\n\t */\r\n\tstatic load(name) {\r\n\t\treturn this.#store.get(name);\r\n\t}\r\n\r\n\t/**\r\n\t * Helper function to retrieve alreaady existing template by name,\r\n\t *  or inject a new one if does not exists already and return template instance.\r\n\t * @param {String} name \r\n\t * @param {String} template \r\n\t * @returns {HTMLTemplateElement}\r\n\t */\r\n\tstatic getOrCreate(name, template) {\r\n\t\tconst me = GSTemplateCache;\r\n\t\tlet el = me.load(name);\r\n\t\tif (el) return el;\r\n\t\tel = me.create(template);\r\n\t\tme.store(name, el);\r\n\t\treturn el;\r\n\t}\r\n\r\n\t/**\r\n\t * Create template element from loaded template source\r\n\t * \r\n\t * @param {String} template \r\n\t * @returns {HTMLTemplateElement}\r\n\t */\r\n\tstatic create(template) {\r\n\t\tconst el = document.createElement('template');\r\n\t\tGSDOM.setHTML(el, template);\r\n\t\treturn el;\r\n\t}\r\n\r\n\t/**\r\n\t * Clone data from template element\r\n\t * \r\n\t * @param {HTMLTemplateElement} template \r\n\t * @returns {HTMLTemplateElement}\r\n\t */\r\n\tstatic clone(template) {\r\n\t\treturn GSDOM.isTemplateElement(template) ? template.content.cloneNode(true) : null;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if template is retrieved from function\r\n\t * \r\n\t * @param {String} tpl \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isFunctionTemplate(tpl) {\r\n\t\tconst fn = GSFunction.parseFunction(tpl);\r\n\t\treturn GSFunction.isFunction(fn) ? fn : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if template is retrieved from html code\r\n\t * \r\n\t * @param {String} tpl \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isHTMLTemplate(tpl) {\r\n\t\tconst val = tpl ? tpl.trim() : '';\r\n\t\t//return (val.startsWith('<') && val.endsWith('>')) ? tpl : false;\r\n\t\treturn /^<(.*)>$/s.test(val) ? tpl : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if template is retrieved from URL\r\n\t * \r\n\t * @param {String} tpl \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isURLTemplate(tpl) {\r\n\t\tconst val = tpl ? tpl.trim() : '';\r\n\t\treturn /^(https?:\\/\\/|.{0,2}\\/{1,2})/i.test(val) ? tpl : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Initialize loaded template\r\n\t * \r\n\t * @param {Boolean} cached Set to true to auto cache if template does not exist\r\n\t * @param {String} name Template name\r\n\t * @param {String} template Template source\r\n\t * @returns {HTMLTemplateElement} Template instance\r\n\t */\r\n\tstatic initTemplate(cached = false, name = '', template) {\r\n\t\tconst me = GSTemplateCache;\r\n\t\tif (cached) return me.getOrCreate(name, template);\r\n\t\treturn me.create(template);\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve template from given HTML text\r\n\t * \r\n\t * @param {Boolean} cached Set to true to auto cache if template does not exist\r\n\t * @param {String} name Template name\r\n\t * @param {String} template Template source\r\n\t * @returns {HTMLTemplateElement} Template instance\r\n\t */\r\n\tstatic loadHTMLTemplate(cached = false, name = '', tpl) {\r\n\t\tconst me = GSTemplateCache;\r\n\t\tconst o = me.isHTMLTemplate(tpl);\r\n\t\tif (!o) return o;\r\n\t\treturn me.initTemplate(cached, name, o);\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve template from given URL\r\n\t * \r\n\t * @async\r\n\t * @param {Boolean} cached Set to true to auto cache if template does not exist\r\n\t * @param {String} name Template name\r\n\t * @param {String} template Template source\r\n\t * @returns {Promise<HTMLTemplateElement>} Template instance\r\n\t */\r\n\tstatic async loadURLTemplate(cached = false, name = '', tpl) {\r\n\t\tconst me = GSTemplateCache;\r\n\t\ttry {\r\n\t\t\tlet template = null;\r\n\t\t\tif (cached) template = me.load(tpl);\r\n\t\t\tif (template) return template;\r\n\t\t\ttemplate = await GSLoader.loadTemplate(tpl);\r\n\t\t\treturn me.initTemplate(cached, name, template);\r\n\t\t} catch (e) {\r\n\t\t\tGSLog.error(me, e);\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve template from given function\r\n\t * \r\n\t * @async\r\n\t * @param {Boolean} cached Set to true to auto cache if template does not exist\r\n\t * @param {String} name Template name\r\n\t * @param {String} template Template source\r\n\t * @returns {Promise<HTMLTemplateElement>} Template instance\r\n\t */\r\n\tstatic async loadFunctionTemplate(cached = false, name = '', tpl) {\r\n\t\tconst me = GSTemplateCache;\r\n\t\tconst fn = me.isFunctionTemplate(tpl);\r\n\t\tif (!fn) return fn;\r\n\t\ttry {\r\n\t\t\tlet template = null;\r\n\t\t\tif (me.cached) template = me.load(o);\r\n\t\t\tif (template) return template;\r\n\t\t\ttemplate = GSFunction.isFunctionAsync(fn) ? await fn() : fn();\r\n\t\t\treturn me.initTemplate(cached, name, template);\r\n\t\t} catch (e) {\r\n\t\t\tGSLog.error(null, e);\r\n\t\t}\r\n\t\treturn fn;\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve and cache html template for element\r\n\t * \r\n\t * @async\r\n\t * @param {Boolean} cached Set to true to auto cache if template does not exist\r\n\t * @param {String} name Template name\r\n\t * @param {String} template Template source\r\n\t * @returns {Promise<HTMLTemplateElement>} Template instance\r\n\t */\r\n\tstatic async loadTemplate(cached = false, name = '', tpl) {\r\n\r\n\t\tif (!name) return false;\r\n\t\tif (!tpl) return false;\r\n\r\n\t\tconst me = GSTemplateCache;\r\n\r\n\t\t// try to load override template (by GSElement tag name)\r\n\t\tlet template = false;\r\n\r\n\t\tif (tpl.indexOf('#') == 0) {\r\n\t\t\treturn document.getElementById(tpl.slice(1));\r\n\t\t}\r\n\r\n\t\tif (!template) {\r\n\t\t\ttemplate = me.loadHTMLTemplate(cached, name, tpl);\r\n\t\t}\r\n\r\n\t\tif (!template) {\r\n\t\t\ttemplate = await me.loadFunctionTemplate(cached, name, tpl);\r\n\t\t}\r\n\r\n\t\tif (!template) {\r\n\t\t\ttemplate = await me.loadURLTemplate(cached, name, tpl);\r\n\t\t}\r\n\r\n\t\treturn template;\r\n\t}\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSTheme class\r\n * @module base/GSTheme\r\n */\r\n\r\n/**\r\n * Switch between dark and light mode\r\n * @Class\r\n */\r\nexport class GSTheme {\r\n\r\n    static #STORAGE = 'gs-theme-mode';\r\n\r\n    /**\r\n     * Changes the theme to 'dark mode' and save settings to local stroage.\r\n     * Basically, replaces/toggles every CSS class that has '-light' class with '-dark'\r\n     * @param {HTMLElement} el \r\n     */\r\n    static darkMode(el) {\r\n        GSTheme.#switch(el, 'light', 'dark');\r\n    }\r\n\r\n    /**\r\n     * Changes the theme to 'light mode' and save settings to local stroage.\r\n     * @param {HTMLElement} el \r\n     */\r\n    static lightMode(el) {\r\n        GSTheme.#switch(el, 'dark', 'light');\r\n    }\r\n\r\n    static #switch(el, from = 'light', to = 'dark') {\r\n\r\n        const root = el || document.body;\r\n\r\n        // TODO  switch dark/light mode ?!??!? \r\n\r\n        // save last state\r\n        GSTheme.theme = to;\r\n    }\r\n\r\n    static get theme() {\r\n        return localStorage.getItem(GSTheme.#STORAGE);\r\n    }\r\n\r\n    static set theme(val) {\r\n        localStorage.setItem(GSTheme.#STORAGE, val);\r\n        window.dispatchEvent(new CustomEvent('gs-theme', { detail: val }));\r\n        const htmlEl = document.head.parentElement;\r\n        if (val) {\r\n            htmlEl.dataset.bsTheme = val;\r\n        } else {\r\n            delete htmlEl.dataset.bsTheme;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get system default theme by media query\r\n     * @returns {String} dark|light \r\n     */\r\n    static getSystemDefaultTheme() {\r\n        const darkThemeMq = window.matchMedia('(prefers-color-scheme: dark)');\r\n        return darkThemeMq.matches ? 'dark' : 'light';\r\n    }\r\n\r\n    static #onTheme(e) {\r\n        const q = new URLSearchParams(location.hash.slice(1));\r\n        GSTheme.theme = q.get('theme');\r\n    }\r\n\r\n    static #setup() {\r\n        window.addEventListener('hashchange', GSTheme.#onTheme)\r\n        let settings = localStorage.getItem(GSTheme.#STORAGE);\r\n        if (settings == null) {\r\n            settings = GSTheme.getSystemDefaultTheme();\r\n        }\r\n\r\n\r\n        if (settings == 'dark') return GSTheme.darkMode();\r\n        if (settings == 'light') return GSTheme.lightMode();\r\n        // TODO switch\r\n\r\n    }\r\n\r\n    static {\r\n        GSTheme.#setup();\r\n        globalThis.GSTheme = GSTheme;\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSLog } from \"./GSLog.mjs\";\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSAttr } from \"./GSAttr.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSEvents } from \"./GSEvents.mjs\";\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSTemplateCache } from \"./GSTemplateCache.mjs\";\r\n\r\n/**\r\n * A module GSAttributeHandler GSAttr class\r\n * @module base/GSDOM\r\n */\r\n\r\n/**\r\n * Attributes to control click actions for buttons and links.\r\n * Used for meta linking between UI elements\r\n * \r\n * Attributes handled:\r\n * - data-gs-attribute - toggle element attribute (receive k=v;k1=v1 or JSON format)\r\n * - data-gs-action - trigger action event\r\n * - data-gs-anchor - where to anchor injected html (self, beforebegin, afterbegin, etc.)\r\n * - data-gs-call - calls a function on a given target (multipel functions supported)\r\n * - data-gs-exec - execute a function (alternative to the call)\r\n * - data-gs-inject - inject HTML content; used for WebComponent append\r\n * - data-gs-property - togle element property (receive k=v;k1=v1 or JSON format)\r\n * - data-gs-swap - swap HTML content; used for WebComponent replacement\r\n * - data-gs-target - CSS query for a target or targets\r\n * - data-gs-template - template to load and inject template\r\n * - data-gs-timeout - a timeout between class toggle\r\n * - data-gs-toggle - toggle CSS classes on a given target\r\n * - data-gs-trigger - triggers an event on a given target\r\n * - data-gs-value - value to pass to a gs-call or gs-trigger\r\n *\r\n * NOTE: \r\n * data-gs-swap and gs-inject uses data-gs-anchor to determine \r\n * where to inject html. If not, set, innerHTML is used\r\n * \r\n * data-gs-target determine element on which to execute,\r\n * if not specified, it means current element\r\n * \r\n * @class\r\n */\r\nexport class GSAttributeHandler {\r\n\r\n    static #reverse = Symbol();\r\n    static #link = Symbol();\r\n\r\n    static DEFINITION = {\r\n        action: { attribute: 'data-gs-action' },\r\n        anchor: { attribute: 'data-gs-anchor' },\r\n        attribute: { attribute: 'data-gs-attribute' },\r\n        call: { attribute: 'data-gs-call' },\r\n        exec: { attribute: 'data-gs-exec' },\r\n        inject: { attribute: 'data-gs-inject' },\r\n        property: { attribute: 'data-gs-property' },\r\n        swap: { attribute: 'data-gs-swap' },\r\n        target: { attribute: 'data-gs-target' },\r\n        template: { attribute: 'data-gs-template' },\r\n        toggle: { attribute: 'data-gs-toggle' },\r\n        trigger: { attribute: 'data-gs-trigger' },\r\n        value: { attribute: 'data-gs-value' },\r\n\r\n        calls: { attribute: 'data-gs-call', multi: true },\r\n        toggles: { attribute: 'data-gs-toggle', multi: true },\r\n        timeout: { attribute: 'data-gs-timeout', type: Number },\r\n        triggers: { attribute: 'data-gs-trigger', multi: true },\r\n    }\r\n\r\n    #host;\r\n    #proxy;\r\n    #active = false;\r\n    #callback;\r\n\r\n    constructor(el) {\r\n        const me = this;\r\n        me.#host = el;\r\n        me.#callback = me.handle.bind(me);\r\n        me.#proxy = GSAttributeHandler.proxify(me.#host);\r\n    }\r\n\r\n    handle(e) {\r\n        const me = this;\r\n        me.targets.forEach(el => me.#handleTarget(me.#host, el, e));\r\n    }\r\n\r\n    #handleTarget(host, target, evt) {\r\n        const me = this;\r\n        me.#handleBinding(target, evt);\r\n        me.#handleAction(target);\r\n        me.#handleAttribute(target);\r\n        me.#handleProperty(target);\r\n        me.#handleToggle(target);\r\n        me.#handleTrigger(target, evt);\r\n        me.#handleCall(host, target, evt);\r\n        me.#handleExec(host, target, evt);\r\n        me.#handleSwap(target);\r\n        me.#handleInject(host, target);\r\n        me.#handleTemplate(host, target);\r\n    }\r\n\r\n    #handleBinding(target, evt) {\r\n        const source = evt.target.field || evt.target.form || evt.target;\r\n        const isForm = source instanceof HTMLFormElement;\r\n        const isField = GSDOM.isFormElement(source);\r\n        if (!(isField || isForm)) return;\r\n        if (isField) {\r\n            target[source.name] = GSDOM.getValue(source);\r\n        } else {\r\n            Object.assign(target, GSDOM.toObject(source));\r\n        }\r\n    }\r\n\r\n    #handleAction(target) {\r\n        if (this.action) GSEvents.send(target, 'action', this.action, true, true);\r\n    }\r\n\r\n    #handleAttribute(target) {\r\n        const me = this;\r\n        if (me.isAttributeJSON) {\r\n            const obj = GSUtil.toJson(me.attribute);\r\n            return GSAttr.jsonToAttr(target, obj);\r\n        }\r\n        const attrs = me.attributes;\r\n        attrs.forEach(v => me.#toggleAttribute(target, v[0], me.value || v[1]));\r\n    }\r\n\r\n    #handleProperty(target) {\r\n        const me = this;\r\n        if (me.isPropertyJSON) {\r\n            const obj = GSUtil.toJson(me.property);\r\n            return Object.assign(target, obj);\r\n        }\r\n        const props = me.properties;\r\n        props.forEach(v => me.#toggleProperty(target, v[0], me.value || v[1]));\r\n    }\r\n\r\n    #toggleAttribute(target, name, value) {\r\n        if (GSUtil.isBool(target[name])) {\r\n            return GSAttr.toggle(target, name, !target[name]);\r\n        } else if (GSUtil.isNumber(target[name])) {\r\n            value = GSUtil.asNum(value);\r\n        }\r\n        GSAttr.set(target, name, value);\r\n    }\r\n\r\n    #toggleProperty(target, name, value) {\r\n        if (GSUtil.isBool(target[name])) {\r\n            if (GSUtil.isStringEmpty(value)) {\r\n                target[name] = !target[name];\r\n            } else {\r\n                target[name] = GSUtil.asBool(value);\r\n            }\r\n        } else if (GSUtil.isNumber(target[name])) {\r\n            target[name] = GSUtil.asNum(value);\r\n        } else {\r\n            target[name] = value;\r\n        }\r\n    }\r\n\r\n    async #handleToggle(target) {\r\n        const me = this;\r\n        const tout = me.timeout * 1000;\r\n        let toggles = me.toggles;\r\n        if (tout === 0) {\r\n            toggles.forEach(v => GSDOM.toggleClass(target, v));\r\n        } else {\r\n            if (target[me.#symbol]) toggles = toggles.reverse();\r\n            for (const v of toggles) {\r\n                await GSUtil.timeout(tout);\r\n                GSDOM.toggleClass(target, v);\r\n            }\r\n            target[me.#symbol] = !target[me.#symbol];\r\n        }\r\n    }\r\n\r\n    #handleCall(host, target, evt) {\r\n        const val = GSUtil.isJsonString(host.value) ? GSUtil.toJson(host.value) : host.value;\r\n        this.calls.forEach(v => GSFunction.callFunction(target[v], target, true, val || evt));\r\n    }\r\n\r\n    #handleExec(host, target, evt) {\r\n        if (!this.exec) return;\r\n        try {\r\n            new Function(this.exec).bind(target)();\r\n        } catch (e) {\r\n            GSLog.error(target, e);\r\n        }\r\n    }\r\n\r\n    #handleTrigger(target, evt) {\r\n        this.triggers.forEach(v => GSEvents.send(target, v, evt));\r\n    }\r\n\r\n    #handleInject(host, target) {\r\n        if (this.inject) {\r\n            const src = this.#toHTML(this.inject);\r\n            const content = GSDOM.parse(src, true);\r\n            this.#applyContent(host, target, content);\r\n        }\r\n    }\r\n\r\n    #handleSwap(target) {\r\n        if (this.swap) target.innerHTML =  this.#toHTML(this.swap);\r\n    }\r\n\r\n    #toHTML(value = '') {\r\n        return value.indexOf('/') < 0 ? `<${value}></${value}>` : `<gs-template flat src=\"${value}\"></gs-template>`;\r\n    }\r\n\r\n    async #handleTemplate(host, target) {\r\n        const tpl = await GSTemplateCache.loadTemplate(true, this.template, this.template);\r\n        this.#applyTemplate(host, target, tpl);\r\n    }\r\n\r\n    #applyTemplate(host, target, template) {\r\n        const content = GSTemplateCache.clone(template);\r\n        this.#applyContent(host, target, content);\r\n    }\r\n\r\n    #applyContent(host, target, content) {\r\n        if (host.anchor) {\r\n            GSDOM.insertAdjacent(target, content, host.anchor);\r\n        } else {\r\n            GSDOM.appendChild(target, content);\r\n        }\r\n    }\r\n\r\n    attach(name = 'click') {\r\n        const me = this;\r\n        if (!me.#active) {\r\n            GSEvents.on(me.#host, null, name, me.#callback);\r\n            me.#active = true;\r\n        }\r\n    }\r\n\r\n    deattach(name = 'click') {\r\n        //GSEvents.deattachListeners(this.#host);\r\n        const me = this;\r\n        GSEvents.off(me.#host, null, name, me.#callback);\r\n        me.#active = false;\r\n    }\r\n\r\n    get #symbol() {\r\n        return GSAttributeHandler.#reverse;\r\n    }\r\n\r\n    get targets() {\r\n        const me = this;\r\n        switch (me.target) {\r\n            case 'this':\r\n            case 'self':\r\n                return [me.#host];\r\n            case 'owner':\r\n                return [GSDOM.root(me.#host)];\r\n            case 'parent':\r\n                return [me.#host.parentElement];\r\n        }\r\n        const list = GSDOM.queryAll(document.body, me.target, false, true).filter(el => el.tagName !== 'GS-ITEM'); \r\n        if (list.length === 0) list.push(me.#host);\r\n        return list;\r\n    }\r\n\r\n    get host() { return this.#host; }\r\n\r\n    get action() { return this.#proxy.action; }\r\n    get anchor() { return this.#proxy.anchor; }\r\n    get attribute() { return this.#proxy.attribute; }\r\n    get exec() { return this.#proxy.exec; }\r\n    get call() { return this.#proxy.call; }\r\n    get inject() { return this.#proxy.inject; }\r\n    get property() { return this.#proxy.property; }\r\n    get swap() { return this.#proxy.swap; }\r\n    get target() { return this.#proxy.target; }\r\n    get toggle() { return this.#proxy.toggle; }\r\n    get trigger() { return this.#proxy.trigger; }\r\n    get timeout() { return this.#proxy.timeout; }\r\n    get template() { return this.#proxy.template; }\r\n    get value() { return this.#proxy.value; }\r\n\r\n    get calls() { return this.#proxy.calls; }\r\n    get toggles() { return this.#proxy.toggles; }\r\n    get triggers() { return this.#proxy.triggers; }\r\n\r\n    get attributes() {\r\n        const val = this.#proxy.attribute || '';\r\n        return val.split(/[,;]/g).map(v => v.split('=')).filter(v => GSUtil.isStringNonEmpty(v));\r\n    }\r\n\r\n    get properties() {\r\n        const val = this.#proxy.property || '';\r\n        return val.split(/[,;]/g).map(v => v.split('=')).filter(v => GSUtil.isStringNonEmpty(v));\r\n    }\r\n\r\n    get isPropertyJSON() {\r\n        return GSUtil.isJson(this.property);\r\n    }\r\n\r\n    get isAttributeJSON() {\r\n        return GSUtil.isJson(this.attribute);\r\n    }\r\n\r\n    static proxify(el) {\r\n        return GSAttr.proxify(el, GSAttributeHandler.DEFINITION);\r\n    }\r\n\r\n    static process(el, e) {\r\n        if (!el?.hasAttribute('gs-target')) return;\r\n        let me = el[GSAttributeHandler.#link];\r\n        if (!(me instanceof GSAttributeHandler)) {\r\n            me = new GSAttributeHandler(el);\r\n            el[GSAttributeHandler.#link] = me;\r\n        }\r\n        me.handle(e);\r\n    }\r\n\r\n    static create(el) {\r\n        const me = new GSAttributeHandler(el);\r\n        me.attach();\r\n        return me;\r\n    }\r\n\r\n    /**\r\n     * Clone element attributes (GS-ITEM to real WebComponent)\r\n     * @param {HTMLElement} from \r\n     * @param {HTMLElement} to \r\n     */\r\n    static clone(from, to) {\r\n        const def = GSAttributeHandler.DEFINITION;\r\n        Object.values(def)\r\n            .filter(o => from.hasAttribute(o.attribute))\r\n            .forEach(o => to.setAttribute(o.attribute, from.getAttribute(o.attribute)));\r\n    }\r\n\r\n    static {\r\n        const def = GSAttributeHandler.DEFINITION;\r\n        Object.values(def).forEach(o => Object.freeze(o));\r\n        Object.freeze(def);\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n *  Linear data structure follownig  last in, first out (LIFO) order of operations.\r\n */\r\nexport class Stack extends Array {\r\n    \r\n    push(item) {\r\n        this.unshift(item);\r\n    }\r\n\r\n    pop() {\r\n        return this.shift();\r\n    }\r\n\r\n    peek() {\r\n        return this[0];\r\n    }\r\n\r\n    isEmpty() {\r\n        return this.length === 0;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n *  Linear data structure follownig first in, first out (FIFO) order of operations.\r\n */\r\nexport class Queue extends Array {\r\n    \r\n    enqueue(item) {\r\n        this.push(item);\r\n    }\r\n\r\n    dequeue() {\r\n        return this.shift();\r\n    }\r\n\r\n    peek() {\r\n        return this[0];\r\n    }\r\n\r\n    isEmpty() {\r\n        return this.length === 0;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/*\r\nconst tree = new BinaryTree(1, 'AB');\r\n\r\ntree.insert(1, 11, 'AC');\r\ntree.insert(1, 12, 'BC');\r\ntree.insert(12, 121, 'BG', { right: true });\r\n\r\n[...tree.preOrderTraversal()].map(x => x.value);\r\n// ['AB', 'AC', 'BC', 'BCG']\r\n\r\n[...tree.inOrderTraversal()].map(x => x.value);\r\n// ['AC', 'AB', 'BC', 'BG']\r\n\r\ntree.value;                // 'AB'\r\ntree.hasChildren;          // true\r\n\r\ntree.find(12).isLeaf;           // false\r\ntree.find(121).isLeaf;          // true\r\ntree.find(121).parent.value;    // 'BC'\r\ntree.find(12).left;             // null\r\ntree.find(12).right.value;      // 'BG'\r\n\r\ntree.remove(12);\r\n\r\n[...tree.postOrderTraversal()].map(x => x.value);\r\n// ['AC', 'AB']\r\n*/\r\n\r\n/**\r\n * Binary Tree Node data holder\r\n */\r\nexport class BinaryTreeNode {\r\n\r\n    constructor(key, value = key, parent = null) {\r\n        this.key = key;\r\n        this.value = value;\r\n        this.parent = parent;\r\n        this.left = null;\r\n        this.right = null;\r\n    }\r\n\r\n    /**\r\n     * Check if both left and right are empty.\r\n     */\r\n    get isLeaf() {\r\n        return this.left === null && this.right === null;\r\n    }\r\n\r\n    /**\r\n     * Check if node has children\r\n     */\r\n    get hasChildren() {\r\n        return !this.isLeaf;\r\n    }\r\n\r\n    /**\r\n     * Check if node is main root node \r\n     */\r\n    get isRoot() {\r\n        return this.parent ? false : true;\r\n    }\r\n\r\n    /**\r\n     * Get main root node\r\n     */\r\n    get root() {\r\n        return this.parent?.root || this;\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * Binary tree implementation\r\n */\r\nexport class BinaryTree extends BinaryTreeNode {\r\n\r\n    constructor(key, value = key) {\r\n        super(key, value);\r\n    }\r\n\r\n    /**\r\n     * Generator method that traverses the binary tree in in-order, \r\n     * using the yield* syntax to recursively delegate traversal to itself.\r\n     * @param {BinaryTreeNode} node \r\n     */\r\n    *inOrderTraversal(node = this) {\r\n        if (node.left) yield* this.inOrderTraversal(node.left);\r\n        yield node;\r\n        if (node.right) yield* this.inOrderTraversal(node.right);\r\n    }\r\n\r\n    /**\r\n     * Generator method that traverses the binary tree in post-order, \r\n     * using the yield* syntax to recursively delegate traversal to itself.\r\n     * @param {BinaryTreeNode} node \r\n     */\r\n    *postOrderTraversal(node = this) {\r\n        if (node.left) yield* this.postOrderTraversal(node.left);\r\n        if (node.right) yield* this.postOrderTraversal(node.right);\r\n        yield node;\r\n    }\r\n\r\n    /**\r\n     * Generator method that traverses the binary tree in pre-order, \r\n     * using the yield* syntax to recursively delegate traversal to itself.\r\n     * @param {BinaryTreeNode} node \r\n     */\r\n    *preOrderTraversal(node = this) {\r\n        yield node;\r\n        if (node.left) yield* this.preOrderTraversal(node.left);\r\n        if (node.right) yield* this.preOrderTraversal(node.right);\r\n    }\r\n\r\n    /**\r\n     * Uses the preOrderTraversal() method to find the given parent node and \r\n     * insert a new child BinaryTreeNode either as the left or right child, \r\n     * depending on the passed options object.\r\n     * @param {*} parentNodeKey \r\n     * @param {*} key \r\n     * @param {*} value \r\n     * @param {*} options \r\n     * @returns {boolean} Return true if data inserted\r\n     */\r\n    insert(\r\n        parentNodeKey,\r\n        key,\r\n        value = key,\r\n        { left, right } = { left: true, right: true }\r\n    ) {\r\n        for (let node of this.preOrderTraversal()) {\r\n            if (node.key === parentNodeKey) {\r\n                const canInsertLeft = left && node.left === null;\r\n                const canInsertRight = right && node.right === null;\r\n                if (!canInsertLeft && !canInsertRight) return false;\r\n                if (canInsertLeft) {\r\n                    node.left = new BinaryTreeNode(key, value, node);\r\n                    return true;\r\n                }\r\n                if (canInsertRight) {\r\n                    node.right = new BinaryTreeNode(key, value, node);\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Uses the preOrderTraversal() method to remove a BinaryTreeNode from the binary tree.\r\n     * @param {*} key \r\n     * @returns \r\n     */\r\n    remove(key) {\r\n        for (let node of this.preOrderTraversal()) {\r\n            if (node.left.key === key) {\r\n                node.left = null;\r\n                return true;\r\n            }\r\n            if (node.right.key === key) {\r\n                node.right = null;\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Uses the preOrderTraversal() method to retrieve the given node in the binary tree.\r\n     * @param {*} key \r\n     * @returns \r\n     */\r\n    find(key) {\r\n        for (let node of this.preOrderTraversal()) {\r\n            if (node.key === key) return node;\r\n        }\r\n        return undefined;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/*\r\nconst list = new DoublyLinkedList();\r\n\r\nlist.insertFirst(1);\r\nlist.insertFirst(2);\r\nlist.insertFirst(3);\r\nlist.insertLast(4);\r\nlist.insertAt(3, 5);\r\n\r\nlist.size;                      // 5\r\nlist.head.value;                // 3\r\nlist.head.next.value;           // 2\r\nlist.tail.value;                // 4\r\nlist.tail.previous.value;       // 5\r\n[...list].map(e => e.value);    // [3, 2, 1, 5, 4]\r\n\r\nlist.removeAt(1);               // 2\r\nlist.getAt(1).value;            // 1\r\nlist.head.next.value;           // 1\r\n[...list].map(e => e.value);    // [3, 1, 5, 4]\r\n\r\nlist.reverse();\r\n[...list].map(e => e.value);    // [4, 5, 1, 3]\r\n\r\nlist.clear();\r\nlist.size;                      // 0\r\n*/\r\n\r\n/**\r\n * Node data holder\r\n */\r\nexport class Node {\r\n\r\n    value = null;\r\n    next = null;\r\n    previous = null;\r\n\r\n    constructor(value, next = null, previous = null) {\r\n        this.value = value;\r\n        this.next = next;\r\n        this.previous = previous;\r\n    }\r\n\r\n    /**\r\n     * Use internally only or make sure node is deatached\r\n     */\r\n    release() {\r\n        this.value = undefined;\r\n        this.next = undefined;\r\n        this.previous = undefined;\r\n    }\r\n\r\n    toJSON() {\r\n        return this.value;\r\n    }\r\n}\r\n\r\nexport class DoublyLinkedList {\r\n\r\n    #nodes = [];\r\n\r\n    /**\r\n     * Number of elements in the list\r\n     */\r\n    get size() {\r\n        return this.#nodes.length;\r\n    }\r\n\r\n    /**\r\n     * First element in the list\r\n     */\r\n    get head() {\r\n        return this.size ? this.#nodes[0] : null;\r\n    }\r\n\r\n    /**\r\n     * Last elemet in the list\r\n     */\r\n    get tail() {\r\n        return this.size ? this.#nodes[this.size - 1] : null;\r\n    }\r\n\r\n    /**\r\n     * Create new linked node\r\n     * @param {*} value \r\n     * @param {*} nextNode \r\n     * @param {*} previousNode \r\n     * @returns \r\n     */\r\n    create(value, nextNode, previousNode) {\r\n        return new Node(value, nextNode, previousNode);\r\n    }\r\n\r\n    /**\r\n     * Insert data to the given position in the list\r\n     * @param {*} index \r\n     * @param {*} value \r\n     * @param {*} safe \r\n     * @returns \r\n     */\r\n    insertAt(index, value, safe) {\r\n\r\n        if (!this.#validate(index, safe)) return false;\r\n\r\n        const previousNode = this.#nodes[index - 1] || null;\r\n        const nextNode = this.#nodes[index] || null;\r\n        const node = create(value, nextNode, previousNode);\r\n\r\n        if (previousNode) previousNode.next = node;\r\n        if (nextNode) nextNode.previous = node;\r\n        this.#nodes.splice(index, 0, node);\r\n    }\r\n\r\n    /**\r\n     * Insert data to the beginning of the list\r\n     * @param {*} value \r\n     */\r\n    insertFirst(value) {\r\n        this.insertAt(0, value);\r\n    }\r\n\r\n    /**\r\n     * Insert data to the end of the list\r\n     * @param {*} value \r\n     */\r\n    insertLast(value) {\r\n        this.insertAt(this.size, value);\r\n    }\r\n\r\n    /**\r\n     * Retrieves the data in the given index\r\n     * @param {Number} index \r\n     * @returns \r\n     */\r\n    getAt(index) {\r\n        return this.#nodes[index];\r\n    }\r\n\r\n    indexOf(val) {\r\n        return this.#nodes.indexOf(val);\r\n    }\r\n\r\n    /**\r\n     * Remove the data at the given index\r\n     * @param {*} index \r\n     * @param {*} safe \r\n     * @returns \r\n     */\r\n    removeAt(index, safe) {\r\n\r\n        if (!this.#validate(index, safe)) return false;\r\n\r\n        const previousNode = this.#nodes[index - 1] || null;\r\n        const nextNode = this.#nodes[index + 1] || null;\r\n\r\n        if (previousNode) previousNode.next = nextNode;\r\n        if (nextNode) nextNode.previous = previousNode;\r\n\r\n        return this.#nodes.splice(index, 1);\r\n    }\r\n\r\n    /**\r\n     * Clear list\r\n     */\r\n    clear(full = true) {\r\n        if (full) this.#nodes.forEach(o => o.release());\r\n        this.#nodes = [];\r\n    }\r\n\r\n    /**\r\n     * Reverse data order\r\n     */\r\n    reverse() {\r\n        this.#nodes = this.#nodes.reduce((acc, { value }) => {\r\n            const nextNode = acc[0] || null;\r\n            const node = new Node(value, nextNode, null);\r\n            if (nextNode) nextNode.previous = node;\r\n            return [node, ...acc];\r\n        }, []);\r\n    }\r\n\r\n    toArray() {\r\n        return this.#nodes.map(e => e.value);\r\n    }\r\n\r\n    toJSON() {\r\n        return this.#nodes;\r\n    }\r\n\r\n    *[Symbol.iterator]() {\r\n        yield* this.#nodes;\r\n    }\r\n\r\n    #validate(index, safe = false) {\r\n        const isInvalid = this.#isInvalidIndex(index);\r\n        if (isInvalid) {\r\n            if (safe) {\r\n                console.log(this.#error());\r\n            } else {\r\n                throw new Error(this.#error());\r\n            }\r\n        }\r\n        return !isInvalid;\r\n    }\r\n\r\n    #isInvalidIndex(index) {\r\n        return !Number.isInteger(index) || index < 0 || index > this.size;\r\n    }\r\n\r\n    #error() {\r\n        return `Invalid index. Current length is ${this.size}.`;\r\n    }\r\n\r\n    /**\r\n     * Convert array to linked list\r\n     * @param {*} data \r\n     * @returns \r\n     */\r\n    static from(data) {\r\n        const list = new DoublyLinkedList();\r\n        if (Array.isArray(data)) data.forEach(v => list.insertLast(v));\r\n        return list;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Tree Node data holder\r\n */\r\nexport class Tree {\r\n\r\n    value;\r\n\r\n    #key = null;\r\n    #parent = null;\r\n    #children;\r\n\r\n    #folder = false;\r\n    #level = 0;\r\n\r\n    constructor(key, value = key, parent = null, level = 0) {\r\n        this.#key = key;\r\n        this.#parent = parent;\r\n        this.#folder = value?.leaf === false;\r\n        this.#level = parent ? parent.level + 1 : level;\r\n        this.#children = this.#folder ? [] : undefined;\r\n        this.value = value;\r\n    }\r\n\r\n    /**\r\n     * Return tree list from root to this node.\r\n     * TODO: Refactor when iterator \"map\" become available\r\n     */\r\n    get subtree() {\r\n        return Array.from(this.up(undefined, false, true, true));\r\n    }\r\n\r\n    get levelID() {\r\n        return this.subtree.map(o => o.level).join('.');\r\n    }\r\n\r\n    /**\r\n     * Unique node canonical form\r\n     */\r\n    get nodeID() {\r\n        //if (this.parent?.level < 0) return this.index;\r\n        return this.subtree.map(o => o.index).join('.');\r\n    }\r\n\r\n    get path() {\r\n        return this.subtree.map(o => o.key).join('/');\r\n    }\r\n\r\n    get index() {\r\n        return this.parent?.nodes.indexOf(this) || 0;\r\n    }\r\n\r\n    get size() {\r\n        return this.#children?.length || -1;\r\n    }\r\n\r\n    get level() {\r\n        return this.#level;\r\n    }\r\n\r\n    /**\r\n     * Check if node is main root node \r\n     */\r\n    get isRoot() {\r\n        return this.parent ? false : true;\r\n    }\r\n\r\n    /**\r\n     * Check if #children is empty\r\n     */\r\n    get isLeaf() {\r\n        return !this.#folder;\r\n    }\r\n\r\n    get isFolder() {\r\n        return this.#folder;\r\n    }\r\n\r\n    /**\r\n     * Check if has #childrens\r\n     */\r\n    get hasChildren() {\r\n        return this.#folder && this.size > 0;\r\n    }\r\n\r\n    /**\r\n     * Get parent node, readonly\r\n     */\r\n    get key() {\r\n        this.#key ??= this.nodeID;\r\n        return this.#key;\r\n    }\r\n\r\n    get nodes() {\r\n        return this.#children;\r\n    }\r\n\r\n    /**\r\n     * Get parent node, readonly\r\n     */\r\n    get parent() {\r\n        return this.#parent;\r\n    }\r\n\r\n    /**\r\n     * Get main root node\r\n     */\r\n    get root() {\r\n        return this.parent?.root || this;\r\n    }\r\n\r\n    /**\r\n     * Check if there are more siblings \r\n     */\r\n    get hasMore() {\r\n        return this.#parent?.size > this.index + 1;\r\n    }\r\n\r\n    get firstChild() {\r\n        return this.hasMore ? this.#children[0] : undefined;\r\n    }\r\n\r\n    get lastChild() {\r\n        return this.hasMore ? this.#children[this.#children.length - 1] : undefined;\r\n    }\r\n\r\n    get next() {\r\n        return this.down(this, false, false).next().value || this.nextSibling || this.parent?.nextSibling;\r\n    }\r\n\r\n    get previous() {\r\n        const node = this.previousSibling;\r\n        return (node?.hasChildren) ? node.lastChild : node || this.up(this, false, false).next().value;\r\n    }\r\n\r\n    get nextSibling() {\r\n        return this.hasMore ? this.#parent.#children[this.index + 1] : undefined;\r\n    }\r\n\r\n    get previousSibling() {\r\n        return this.index > 0 ? this.#parent.#children[this.index - 1] : undefined;\r\n    }\r\n\r\n    /**\r\n     * Clear all #children\r\n     */\r\n    clear() {\r\n        if (this.#children) {\r\n            this.#children.forEach(o => o.release?.());\r\n            this.#children = [];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Used internally, if called externally, \r\n     * make sure node is removed from parent \r\n     */\r\n    release() {\r\n        this.clear();\r\n        this.#key = null;\r\n        this.value = null;\r\n        this.#parent = null;\r\n    }\r\n\r\n    /**\r\n     * Walk down the tree\r\n     * @param {Tree} node starting node\r\n     * @param {Boolean} values yield values instead nodes\r\n     * @param {Boolean} inclusive include self\r\n     * @param {Boolean} reverse Order direction\r\n     * @param {Boolean} flat Navigate all nodes out of subtree\r\n     */\r\n    *down(node = this, values = false, inclusive = true, reverse = false, flat = false) {\r\n        const o = values ? node.value : node;\r\n        if (inclusive && !reverse && node.level > -1) yield o;\r\n        if (node.#children?.length) {\r\n            for (let child of node.#children) {\r\n                yield* this.down(child, values, true, reverse, flat);\r\n            }\r\n        }\r\n        if (flat) {\r\n            const item = node.nextSibling || node.parent.nextSibling;\r\n            if (item) yield* this.down(item, values, true, reverse, flat);\r\n        }\r\n        /*\r\n        */\r\n        if (inclusive && reverse && node.level > -1) yield o;\r\n    }\r\n\r\n    /**\r\n     * Walk up the tree\r\n     * @param {Tree} node starting node\r\n     * @param {Boolean} values yield values instead nodes\r\n     * @param {Boolean} inclusive include self\r\n     * @param {Boolean} reverse Order direction\r\n     */\r\n    *up(node = this, values = false, inclusive = true, reverse = false, flat = false) {\r\n        const o = values ? node.value : node;\r\n        if (inclusive && !reverse && node.level > -1) yield o;\r\n        if (flat) {\r\n            let item = node.previousSibling;\r\n            item = item?.isFolder ? item.lastChild : item\r\n            if (item) yield* this.up(item, values, true, reverse, flat);\r\n        }        \r\n        if (node.parent) {\r\n            yield* this.up(node.parent, values, true, reverse, flat);\r\n        }\r\n        if (inclusive && reverse && node.level > -1) yield o;\r\n    }\r\n\r\n    /**\r\n     * Walk through all nodes\r\n     * @param {*} node \r\n     */\r\n    walk = this.down;\r\n\r\n    /**\r\n     * Simulate array function \"forEach\"\r\n     * @param {*} callback \r\n     * @param {*} flat If set, will iterate all nodes, otherwise only cildrens and subtrees\r\n     * @param {*} reverse If set, will iterate up the tree\r\n     * @returns \r\n     */\r\n    forEach(callback, flat = false, reverse = false) {\r\n        this.every((node, index) => {\r\n            callback(node, index);\r\n            return true;\r\n        }, flat, reverse);\r\n    }\r\n\r\n    /**\r\n     * Simulate array function \"every\"\r\n     * @param {*} callback \r\n     * @param {*} flat If set, will iterate all nodes, otherwise only cildrens and subtrees\r\n     * @param {*} reverse If set, will iterate up the tree\r\n     * @returns \r\n     */    \r\n    every(callback, flat = false, reverse = false) {\r\n        const it = this.iterate(flat, reverse);\r\n        let sts = true;\r\n        let i = 0;\r\n        for (let node of it) {\r\n            sts = callback(node, i++);\r\n            if (!sts) break;\r\n        }\r\n        return sts;\r\n    }\r\n\r\n    /**\r\n     * Simulate array function \"find\"\r\n     * @param {*} callback \r\n     * @param {*} flat If set, will iterate all nodes, otherwise only cildrens and subtrees\r\n     * @param {*} reverse If set, will iterate up the tree\r\n     * @returns \r\n     */    \r\n    find(callback, flat = false, reverse = false) {\r\n        const it = this.iterate(flat, reverse);\r\n        let i = 0;\r\n        for (let node of it) {\r\n            if (callback(node, i++)) return node;\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    /**\r\n     * Simulate array function \"filter\"\r\n     * @param {*} callback \r\n     * @param {*} flat If set, will iterate all nodes, otherwise only childrens and subtrees\r\n     * @param {*} reverse If set, will iterate up the tree\r\n     * @returns \r\n     */    \r\n    filter(callback, flat, reverse) {\r\n        return [...this.#filtered(callback, flat, reverse)];\r\n    }\r\n\r\n    *#filtered(callback, flat, reverse) {\r\n        const it = this.iterate(flat, reverse);\r\n        for (let node of it) {\r\n            let res = callback(node);\r\n            if (res) yield node;\r\n        }        \r\n    }\r\n\r\n    /**\r\n     * Iterate all nodes\r\n     * @param {boolean} flat If set, will iterate all nodes, otherwise only cildrens and subtrees\r\n     * @param {boolean} reverse If set, will iterate up the tree\r\n     */\r\n    *iterate(flat, reverse) {\r\n        reverse ? yield* this.up(this, false, false, false, flat) : yield* this.down(this, false, false,  false, flat);\r\n    }\r\n\r\n    /**\r\n     * Add a new Tree to the tree.\r\n     * @param {*} key \r\n     * @param {*} value \r\n     * @returns \r\n     */\r\n    append(key, value = key) {\r\n        let newOne = undefined;\r\n        if (key instanceof Tree) {\r\n            key.#parent = this;\r\n            key.#level = this.#level + 1;\r\n            newOne = key;\r\n        } else {\r\n            newOne = new Tree(key, value, this);\r\n        }\r\n        this.#folder = true;\r\n        this.#children ??= [];\r\n        this.#children.push(newOne);\r\n        return newOne;\r\n    }\r\n\r\n    /**\r\n     * Uses the walk() method and Array.prototype.push() \r\n     * to add a new Tree to the tree.\r\n     * @param {*} parentNodeKey \r\n     * @param {*} key \r\n     * @param {*} value \r\n     * @returns \r\n     */\r\n    insert(parentNodeKey, key, value = key) {\r\n        for (let node of this.walk()) {\r\n            if (node.key === parentNodeKey) {\r\n                const newOne = new Tree(key, value, node);\r\n                this.#folder = true;\r\n                this.#children ??= [];\r\n                node.#children.push(newOne);\r\n                return newOne;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Remove node from tree. If key is set, will search for first node with matching key.\r\n     * @param {*} key \r\n     * @returns \r\n     */\r\n    remove(key) {\r\n\r\n        const me = this;\r\n\r\n        if (key) {\r\n            const node = me.findByKey(key);\r\n            node?.remove();\r\n            return node;\r\n        }\r\n\r\n        if (me.isRoot) throw new Error('Root node can\\'t be removed!');\r\n        const node = me.parent;\r\n        const filtered = node.#children.filter(c => c !== me);\r\n        if (filtered.length !== node.#children.length) {\r\n            node.#children = filtered;\r\n            return me;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Uses the walk() method to retrieve the given node in the tree.\r\n     * @param {*} key \r\n     * @returns \r\n     */\r\n    findByKey(key) {\r\n        for (let node of this.walk()) {\r\n            if (node.key === key) return node;\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    /**\r\n     * Convert tree into array list\r\n     * @returns \r\n     */\r\n    flatten(values, inclusive, reverse) {\r\n        return [...this.down(this, values, inclusive, reverse)];\r\n    }\r\n\r\n    /**\r\n     * Load JSON data into tree\r\n     * @param {*} data \r\n     */\r\n    fromJSON(data) {\r\n        if (data) Tree.from(this, data);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Used by JSON.stringify to properly export as JSON\r\n     * @returns \r\n     */\r\n    toJSON() {\r\n        if (this.level < 0) return this.#children?.map(o => o.toJSON()) || {};\r\n        return this.isLeaf ? { key: this.key, value: this.value } :\r\n            {\r\n                key: this.key,\r\n                value: this.value,\r\n                items: this.#children.map(o => o.toJSON())\r\n            }\r\n    }\r\n\r\n    /**\r\n     * Make node iterable\r\n     */\r\n    *[Symbol.iterator]() {\r\n        yield* this.down();\r\n    }\r\n\r\n    /**\r\n     * Convert JSON tree into Linked Tree \r\n     * @param {*} data \r\n     * @returns \r\n     */\r\n    static from(parent, data) {\r\n        const raw = data || parent;\r\n        const hasParent = parent instanceof Tree;\r\n        if (Array.isArray(raw)) {\r\n            if (!hasParent) throw new Error('Parent required when data is array');\r\n            raw.forEach(o => Tree.from(parent, o));\r\n            return parent;\r\n        }\r\n        const { items, ...obj } = raw;\r\n        const tree = new Tree(obj.key, obj, data ? parent : undefined);\r\n        if (hasParent) parent.append(tree);\r\n        if (items) Tree.from(tree, items);\r\n        return tree;\r\n    }\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSEvent } from \"../base/GSEvent.mjs\";\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\n\r\n/**\r\n * A module loading GSReadWriteRegistry class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Global registry for GSAbstractReadWrite instances - data read/write \r\n * @Class\r\n */\r\nclass GSReadWriteRegistryImpl extends GSEvent {\r\n\r\n    static #instance = null;\r\n    static #INTERNAL = Symbol();\r\n\r\n    #handlers = new Map();\r\n\r\n    #map = new Map();\r\n\r\n    constructor(key) {\r\n        if (key != GSReadWriteRegistryImpl.#INTERNAL) throw new Error('Creating new instance not allowed.');\r\n        super();\r\n    }\r\n\r\n    /**\r\n     * Register data handler\r\n     * @param {string} type unique handler name\r\n     * @param {GSReadWriteRegistry} clazz \r\n     */\r\n    addHandler(type, clazz) {        \r\n        this.#handlers.set(type, clazz);\r\n    }\r\n\r\n    /**\r\n     * Unregister data handler\r\n     * @param {string} type unique handler name\r\n     */\r\n    removeHandler(type) {        \r\n        this.#handlers.delete(type);\r\n    }\r\n\r\n    /**\r\n     * Get registered handler by name\r\n     * @param {string} type unique handler name\r\n     */    \r\n    getHandler(type) {\r\n        return this.#handlers.get(type);\r\n    }\r\n\r\n    /**\r\n     * Initialize data handler instance\r\n     * @param {string} type unique handler name\r\n     * @param {string} name unique instance name\r\n     * @param {GSReadWriteRegistry} clazz \r\n     */    \r\n    newHandler(type, name, enabled) {\r\n        const clazz = this.getHandler(type);\r\n        return clazz ? new clazz(name, enabled) : undefined;\r\n    }\r\n\r\n    /**\r\n     * Register GSAbstractReadWrite instance or inherited classes\r\n     * @param {GSAbstractReadWrite} obj \r\n     */\r\n    register(obj) {\r\n        const me = this;\r\n        me.#verify(obj);\r\n        const cache = me.find(obj.id);\r\n        if (cache == obj) return;\r\n        if (cache) throw new Error(`Key (${obj.id}) already exist in read/write registry!`);\r\n        me.#map.set(obj.id, obj);\r\n        me.emit(`register-${obj.id}`, obj);\r\n        me.emit(`register`, obj);\r\n    }\r\n\r\n    /**\r\n     * Unregister GSAbstractReadWrite instance or inherited classes\r\n     * @param {GSAbstractReadWrite} obj \r\n     * @returns {boolean} Deletion status\r\n     */\r\n    unregister(obj) {\r\n        const me = this;\r\n        if (GSUtil.isString(obj)) obj = me.find(obj);\r\n        me.#verify(obj);\r\n        const sts = me.#map.delete(obj.id);\r\n        if (sts) {\r\n            me.emit(`unregister-${obj.id}`, obj);\r\n            me.emit(`unregister`, obj);\r\n        }\r\n        return sts;\r\n    }\r\n\r\n    /**\r\n     * Find registered handler\r\n     * @param {string} val \r\n     * @returns \r\n     */\r\n    find(val) {\r\n        return this.#map.get(val);\r\n    }\r\n\r\n    /**\r\n     * Wait for specific habdler to be either registered or unregistered\r\n     * @param {string} id \r\n     * @param {number|AbortSignal} signal Cancelation in timeout or provided signal\r\n     * @param {boolean} register Listen for register or unregister\r\n     * @returns \r\n     */\r\n    async wait(id = '', signal, register = true) {\r\n        if (!id) throw new Error('GSReadWrite ID not valid.');\r\n        const me = this;\r\n        if (register) {\r\n            const rw = me.find(id);\r\n            if (rw) return rw;\r\n        }\r\n        const type = register ? 'register' : 'unregister';\r\n        await super.wait(`${type}-${id}`, signal);\r\n        return me.find(id);\r\n    }\r\n\r\n    #verify(obj) {\r\n        //if (!(obj instanceof GSAbstractReadWrite)) throw new Error('Invalid parameter type.');\r\n    }\r\n\r\n    static get #self() {\r\n        if (!GSReadWriteRegistryImpl.#instance) GSReadWriteRegistryImpl.#instance = new GSReadWriteRegistryImpl(GSReadWriteRegistryImpl.#INTERNAL);\r\n        return GSReadWriteRegistryImpl.#instance;\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSReadWriteRegistryImpl);\r\n        globalThis.GSReadWriteRegistry = GSReadWriteRegistryImpl.#self;\r\n    }\r\n\r\n}\r\n\r\nexport const GSReadWriteRegistry = globalThis.GSReadWriteRegistry;\r\n\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSID } from \"../base/GSID.mjs\";\r\nimport { GSEvent } from \"../base/GSEvent.mjs\";\r\nimport { GSReadWriteRegistry } from \"./ReadWriteRegistry.mjs\";\r\n\r\n/**\r\n * A module loading GSAbstractReadWrite class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Generic Class for data read/write for various components such as grid/form/dynaimc menu etc.\r\n * @Class\r\n */\r\nexport class GSAbstractReadWrite extends GSEvent {\r\n\r\n    #id = null;\r\n    #processors = null;\r\n\r\n    constructor(name, enabled = true) {\r\n        super();\r\n        const me = this;\r\n        me.#id = name || GSID.next();\r\n        if (enabled) me.enable();\r\n    }\r\n\r\n    /**\r\n     * Data preprocessor to register\r\n     * @param {object} processor\r\n     */\r\n    addProcessor(processor) {\r\n        if (!processor) return;\r\n        this.#processors ??= new Set();\r\n        this.#processors.add(processor);\r\n    }\r\n\r\n    /**\r\n     * Data preprocessor to remove\r\n     * @param {object} processor \r\n     */    \r\n    removeProcessor(processor) {\r\n        if (processor) this.#processors?.delete(processor);\r\n    }\r\n\r\n    /**\r\n     * Unique data handler name\r\n     * @returns {string} \r\n     */\r\n    get id() {\r\n        return this.#id;\r\n    }\r\n\r\n    /**\r\n     * Register into global data handler registry\r\n     */\r\n    enable() {\r\n        const me = this;\r\n        GSReadWriteRegistry.register(me);\r\n        me.emit('enabled');\r\n    }\r\n\r\n    /**\r\n     * Unregister from global data handler registry\r\n     */\r\n    disable() {\r\n        const me = this;\r\n        GSReadWriteRegistry.unregister(me);\r\n        me.emit('disabled');\r\n    }\r\n\r\n    /**\r\n     * Check if data handler is registered in global registry\r\n     * @returns {boolean}\r\n     */\r\n    get isRegistered() {\r\n        return GSReadWriteRegistry.find(this.id) ? true : false;\r\n    }\r\n\r\n    /**\r\n     * Generic event dispatcher, can be overriden to controll when to fire event\r\n     * @param {*} owner \r\n     * @param {*} type \r\n     * @param {*} data \r\n     * @param {*} error \r\n     */\r\n    notify(owner, type, data, error) {\r\n        this.emit(error ? 'error' : type, { type: type, error: error, owner: owner, data: data }, true);\r\n    }\r\n\r\n    /**\r\n     * Initiate data read from remote\r\n     * @param {HTMLElement} owner \r\n     * @returns {Array|Object} JSON data response\r\n     */\r\n    async read(owner) {\r\n        const me = this;\r\n        let data = null;\r\n        try {\r\n            data = await me.onRead(owner);\r\n            me.#processors?.forEach(c => c.postRead?.(data));\r\n            if (data) me.notify(owner, 'read', data);\r\n        } catch (e) {\r\n            me.notify(owner, 'read', data, e);\r\n            throw e;\r\n        }\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * Initiate data write to remote\r\n     * @param {HTMLElement} owner \r\n     * @returns {Array|Object} JSON data response\r\n     */\r\n    async write(owner, data) {\r\n        const me = this;\r\n        let result = null;\r\n        try {\r\n            result = await me.onWrite(owner, data);\r\n            me.#processors?.forEach(c => c.postWrite?.(data));\r\n            if (result) me.notify(owner, 'write', data);\r\n        } catch (e) {\r\n            me.notify(owner, 'write', data, e);\r\n            throw e;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Override in inherited class to implement read logic\r\n     * @param {} owner \r\n     * @returns \r\n     */\r\n    async onRead(owner) {\r\n        throw new Error('Extend base GSAbstractReadWrite to implement read operation');\r\n    }\r\n\r\n    /**\r\n     * Override in inherited class to implement write logic\r\n     * @param {} owner \r\n     * @param {} data\r\n     * @returns \r\n     */\r\n    async onWrite(owner, data) {\r\n        throw new Error('Extend base GSAbstractReadWrite to implement write operation');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSFunction } from \"../base/GSFunction.mjs\";\r\nimport { GSLoader } from \"../base/GSLoader.mjs\";\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\nimport { GSAbstractReadWrite } from \"./AbstractReadWrite.mjs\";\r\nimport { GSReadWriteRegistry } from \"./ReadWriteRegistry.mjs\";\r\n\r\n/**\r\n * A module loading GSReadWrite class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Generic Class for QUERY/REST data read/write for various components such as grid/form/dynamic menu etc.\r\n * Also, Green Screens Quark Engine or external functions are supported.\r\n * If mode=\"\", instance is used as local reader. \r\n * Use events to detect read/write requests or manually populate using this.setData([...]) \r\n * @Class\r\n */\r\nexport class GSReadWrite extends GSAbstractReadWrite {\r\n\r\n    static #MODES = ['', 'rest', 'query', 'quark'];\r\n    static #METHOD = ['GET', 'PUT', 'POST', 'DELETE'];\r\n\r\n    #src = '';\r\n    #headers = {};\r\n    #reader = 'GET';\r\n    #writer = 'POST';\r\n    #action = '';\r\n    #mode = '';\r\n\r\n    #skip = 0;\r\n    #limit = 0;\r\n\r\n    #sort = [];\r\n    #filter = [];\r\n\r\n    /**\r\n     * Instance constructor\r\n     * @param {string} name Unique handler name\r\n     * @param {boolean} enabled Automatically register in global registry. \r\n     */\r\n    constructor(name, enabled) {\r\n        super(name, enabled);\r\n    }\r\n\r\n    /**\r\n     * Handler operational mode\r\n     * rest, query, quark \r\n     * @returns {string} Operational mode\r\n     */\r\n    get mode() {\r\n        return GSUtil.normalize(this.#mode);\r\n    }\r\n\r\n    /**\r\n     * Handler operational mode\r\n     * Values: '', query, rest, quark\r\n     * @var {String} \r\n     */\r\n    set mode(val) {\r\n        const me = this;\r\n        val = GSUtil.normalize(val);\r\n        const isok = GSReadWrite.#MODES.includes(val);\r\n        if (!isok) throw new Error(null, `Invalid mode, allowed: ${GSReadWrite.#MODES}`);\r\n        if (me.#mode === 'quark' && me.#mode != val) {\r\n            me.#reader = 'GET';\r\n            me.#writer = 'POST';\r\n        }\r\n        return this.#mode = val;\r\n    }\r\n\r\n    /**\r\n     * HTTP method for reader (query/rest)\r\n     * @returns {string} Values GET,POST,PUT\r\n     */\r\n    get reader() {\r\n        return this.#reader;\r\n    }\r\n\r\n    /**\r\n     * HTTP method for reader (query/rest)\r\n     * Values GET,POST,PUT\r\n     * @var {String} \r\n     */\r\n    set reader(val) {\r\n        const me = this;\r\n        const isok = me.isQuark ? true : GSReadWrite.#METHOD.includes(val);\r\n        if (!isok) throw new Error(null, `Invalid method, allowed: ${GSReadWrite.#METHOD}`);\r\n        return me.#reader = val;\r\n    }\r\n\r\n    /**\r\n     * HTTP method for writer (query/rest)\r\n     * @returns {string} Values POST,PUT\r\n     */\r\n    get writer() {\r\n        return this.#writer;\r\n    }\r\n\r\n    /**\r\n     * HTTP method for writer (query/rest)\r\n     * Values POST,PUT\r\n     * @var {String} \r\n     */\r\n    set writer(val) {\r\n        const me = this;\r\n        const isok = me.isQuark ? true : GSReadWrite.#METHOD.includes(val);\r\n        if (!isok) throw new Error(null, `Invalid method, allowed: ${GSReadWrite.#METHOD}`);\r\n        return this.#writer = val;\r\n    }\r\n\r\n    /**\r\n     * Custom HTTP headers\r\n     * @returns {Object} Json structure\r\n     */\r\n    get headers() {\r\n        return { ...this.#headers };\r\n    }\r\n\r\n    /**\r\n     * Custom HTTP headersas String or Json structure\r\n     * @var {Object} \r\n     */\r\n    set headers(val = {}) {\r\n        val = GSUtil.toJson(val);\r\n        const me = this;\r\n        me.#headers = { ...val };\r\n    }\r\n\r\n    /**\r\n     * Base URL part\r\n     * @returns {string} \r\n     */\r\n    get src() {\r\n        return this.#src;\r\n    }\r\n\r\n    /**\r\n     * Base URL part\r\n     * @var {String} \r\n     */\r\n    set src(val = '') {\r\n        const me = this;\r\n        me.#src = val;\r\n    }\r\n\r\n    /**\r\n     * Number of records to return\r\n     * @returns {Number} \r\n     */\r\n    get limit() {\r\n        return this.#limit;\r\n    }\r\n\r\n    /**\r\n     * Number of records to return\r\n     * @var {Number} \r\n     */\r\n    set limit(val = 10) {\r\n        this.#limit = GSUtil.asNum(val, 10);\r\n    }\r\n\r\n    /**\r\n     * Number of records to skip\r\n     * @returns {Number} \r\n     */\r\n    get skip() {\r\n        return this.#skip;\r\n    }\r\n\r\n    /**\r\n     * Number of records to skip\r\n     * @var {Number} \r\n     */\r\n    set skip(val = 0) {\r\n        this.#skip = GSUtil.asNum(val, 0);\r\n    }\r\n\r\n    /**\r\n     * Filter data in format \r\n     * [{name: idx[num] || name[string], value: ''  , op:'eq'}]\r\n     * @returns {Array<Object>} \r\n     */\r\n    get filter() {\r\n        return this.#filter;\r\n    }\r\n\r\n    set filter(val) {\r\n        const me = this;\r\n        val = val || [];\r\n        val = GSUtil.isJson(val) ? GSUtil.toJson(val) : val;\r\n        me.#filter = Array.isArray(val) ? val : [val];\r\n    }\r\n\r\n    /**\r\n     * Sort data in format\r\n     * [{col: idx[num] || name[string]  , op: -1 | 1 }]\r\n     * @returns {Array<Object>} \r\n     */\r\n    get sort() {\r\n        return this.#sort;\r\n    }\r\n\r\n    set sort(val) {\r\n        const me = this;\r\n        val = val || [];\r\n        val = GSUtil.isJson(val) ? GSUtil.toJson(val) : val;\r\n        me.#sort = Array.isArray(val) ? val : [val];\r\n    }\r\n\r\n    /**\r\n     * Generated URL segment based on selected mode (query/rest)\r\n     * - quark - JSON path to CRUD object; ie. io.greenscreens.CRUD\r\n     * - rest - url rest format, ie. /${limit}/${skip}?sort=${sort}&filter=${filter}\r\n     * - query - url format, ie. ?limit=${limit}&skip=${skip}&sort=${sort}&filter=${filter}\r\n     * @returns {string} \r\n     */\r\n    get action() {\r\n        const me = this;\r\n        let def = '';\r\n        switch (me.mode) {\r\n            case 'query':\r\n                def = '?limit=${limit}&skip=${skip}&sort=${sort}&filter=${filter}';\r\n                break;\r\n            case 'rest':\r\n                def = '/${limit}/${skip}?sort=${sort}&filter=${filter}';\r\n                break;\r\n        }\r\n        return me.#action || def;\r\n    }\r\n\r\n    /**\r\n     * Set custom URL segment to be attached to based 'src'.\r\n     * Format depends on mode[query|rest]\r\n     * @var {String}\r\n     */\r\n    set action(val = '') {\r\n        const me = this;\r\n        me.#action = val;\r\n    }\r\n\r\n    /**\r\n    * Generate URL from src and mode type\r\n    */\r\n    get url() {\r\n        const me = this;\r\n        return me.#toURL(me.#src, me.#skip, me.#limit, me.#filter, me.#sort);\r\n    }\r\n\r\n    #toURL(src, skip, limit, filter, sort) {\r\n        const me = this;\r\n        if (GSUtil.isStringEmpty(src)) throw new Error('Attribute \"src\" not set!');\r\n        sort = sort ? JSON.stringify(sort) : '';\r\n        filter = filter ? JSON.stringify(filter) : '';\r\n        const opt = { limit: limit, skip: skip, sort: encodeURIComponent(sort), filter: encodeURIComponent(filter) };\r\n        return src + GSUtil.fromLiteral(me.action, opt);\r\n    }\r\n\r\n    /**\r\n     * If handler is local for manual data entry\r\n     * @returns {boolean}\r\n     */\r\n    get isOffline() {\r\n        return this.mode === '';\r\n    }\r\n\r\n    /**\r\n     * If handler is for Green Screens Quark Engine or custom global function.\r\n     * @returns {boolean}\r\n     */\r\n    get isQuark() {\r\n        return this.mode === 'quark';\r\n    }\r\n\r\n    /**\r\n     * If handler is for HTTP requests (query|rest)\r\n     * @returns {boolean}\r\n     */\r\n    get isRemote() {\r\n        return ['rest', 'query'].includes(this.mode);\r\n    }\r\n\r\n    /**\r\n     * Override in inherited class\r\n     * @param {} owner Calling HTMLElement\r\n     * @returns {Array<Object>} Json Array data loaded \r\n     */\r\n    async onRead(owner) {\r\n        const me = this;\r\n        if (me.isOffline) return;\r\n        if (!me.#reader) return super.onRead(owner);\r\n        if (me.isRemote) return await GSLoader.load(me.url, me.#reader, me.#headers, true);\r\n        if (!me.isQuark) return;\r\n        const fn = GSFunction.parseFunction(me.#reader);\r\n        if (!fn) throw new Error('Reader quark function not found!')\r\n        return fn(me.skip, me.limit, me.filter, me.sort);\r\n    }\r\n\r\n    /**\r\n     * Override in inherited class\r\n     * @param {} owner Calling HTMLElement\r\n     * @param {Object} data JSON object to send to the remote\r\n     * @returns {Object} Json Object with write response\r\n     */\r\n    async onWrite(owner, data) {\r\n        const me = this;\r\n        if (me.isOffline) return;\r\n        if (!me.#writer) return super.onWrite(owner);\r\n        if (!me.isRemote) return await GSLoader.load(me.url, me.#writer, me.#headers, true, data);\r\n        if (!me.isQuark) return;\r\n        const fn = GSFunction.parseFunction(me.#writer);\r\n        if (!fn) throw new Error('Writer quark function not found!')\r\n        return fn(data);\r\n    }\r\n\r\n    /**\r\n     * Register generic handler under unique name.\r\n     * @param {string} name Unique handler name\r\n     * @returns {GSReadWrite} Data handler instance\r\n     */\r\n    static register(name) {\r\n        return new GSReadWrite(name, true);\r\n    }\r\n\r\n    static {\r\n        GSReadWriteRegistry.addHandler('remote', GSReadWrite);\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSData } from \"../base/GSData.mjs\";\r\nimport { GSReadWrite } from \"./ReadWrite.mjs\";\r\nimport { GSReadWriteRegistry } from \"./ReadWriteRegistry.mjs\";\r\n\r\n/**\r\n * A module loading GSReadWrite class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * ReadWrite with cached memory data. \r\n * @Class\r\n */\r\nexport class GSCachedReader extends GSReadWrite {\r\n\r\n    #data = [];\r\n\r\n    #reformat(data = []) {\r\n\r\n        let records = [];\r\n        if (Array.isArray(data)) {\r\n            records = data;\r\n        } else if (Array.isArray(data.data)) {\r\n            records = data.data;\r\n        } else {\r\n            records = [data];\r\n        }\r\n\r\n        return records;\r\n    }\r\n\r\n    #postFilter(data) {\r\n        const me = this;\r\n        data = GSData.sortData(data, me.sort);        \r\n        let limit = me.limit === 0 ? data.length : me.limit;\r\n        data = data.slice(me.skip, me.skip + limit);\r\n        return data;\r\n    }\r\n\r\n    clear() {\r\n        this.#data = [];\r\n    }\r\n\r\n    append(data) {\r\n        if(!data) return false;\r\n        const me = this;\r\n        data = me.#reformat(data);\r\n        me.#data = me.#data.concat(data);\r\n        return me.#data;\r\n    }\r\n\r\n    remove(data) {\r\n        const me = this;\r\n        me.#data = me.#data.filter(o => o =! data);\r\n        return me.#data;\r\n    }\r\n\r\n    /**\r\n     * Override in inherited class\r\n     * @param {} owner Calling HTMLElement\r\n     * @returns {Array<Object>} Json Array data loaded \r\n     */\r\n    async onRead(owner) {\r\n        const me = this;\r\n\r\n        if (me.#data.length === 0) {\r\n            const data = await super.onRead();\r\n            me.#data = me.#reformat(data);\r\n        }\r\n\r\n        let data = GSData.filterData(me.#data, me.filter, me.fields, me.limit);\r\n        data = me.#postFilter(data);\r\n        return data;\r\n    }\r\n\r\n    disable() {\r\n        this.#data = [];\r\n        super.disable();\r\n    }\r\n\r\n    set search(val) {\r\n        const me = this;\r\n        me.filter = val ? [{value : val}] : [];\r\n        me.read();\r\n        /*\r\n        let data = GSData.filterData(me.#data, [{value : val}]);\r\n        data = me.#postFilter(data);\r\n        me.notify(me, 'read', data);\r\n        */\r\n    }\r\n\r\n    /**\r\n     * Register generic handler under unique name.\r\n     * @param {string} name Unique handler name\r\n     * @returns {GSReadWrite} Data handler instance\r\n     */\r\n    static register(name) {\r\n        return new GSCachedReader(name, true);\r\n    }\r\n\r\n    static {\r\n        GSReadWriteRegistry.addHandler('cached', GSCachedReader);\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { Tree } from \"../helpers/Tree.mjs\";\r\n\r\n/**\r\n * A module loading TreeNode class\r\n * @module data/TreeNode\r\n */\r\n\r\n/**\r\n * UI mediator between Tree linked nodes and WebComponents\r\n * @Class\r\n */\r\nexport class TreeNode extends Tree {\r\n\r\n    #multi = false;\r\n    #opened = false;\r\n    #focused = false;\r\n    #selected = false;\r\n    \r\n    #focusedNode = undefined;\r\n    #selectedNode = undefined;\r\n    #controllers = undefined;\r\n\r\n    constructor(key, value = key, parent = null, level = 0) {\r\n        super(key, value, parent, level);\r\n\r\n        if (value?.select === true || (this.multi && parent?.selected)) this.selected = true;\r\n        if (value?.focus === true) this.focused = true;\r\n        if (value?.open === true) this.opened = true;\r\n    }\r\n\r\n    addController(controller) {\r\n        const root = this.root;\r\n        (root.#controllers ??= new Set()).add(controller);\r\n    }\r\n\r\n    removeController(controller) {\r\n        this.root.#controllers?.delete(controller);\r\n    }\r\n\r\n    /**\r\n     * Is multi selection available\r\n     */\r\n    get multi() {\r\n        return this.root.#multi === true;\r\n    }\r\n\r\n    set multi(val) {\r\n        this.root.#multi = val === true;\r\n    }\r\n\r\n    get visible() {\r\n        if (this.level < 0) return true;\r\n        return this.parent?.opened;\r\n    }\r\n\r\n    /**\r\n     * select single node, removing seelction flag from all other nodes\r\n     */\r\n    get opened() {\r\n        if (this.level < 0) return true;\r\n        return this.isLeaf ? this.parent?.opened : this.#opened;\r\n    }\r\n\r\n    set opened(val) {\r\n        val = val === true;\r\n        if (val) {\r\n            this.expand();\r\n        } else {\r\n            this.collapse();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Focus single node, removing focus flag from all other nodes\r\n     */\r\n    get focused() {\r\n        return this.#focused;\r\n    }\r\n\r\n    set focused(val) {\r\n        val = val === true;\r\n        const root = this.root;\r\n        const changed = this.#focused != val;\r\n        const focusedNode = root.focusedNode();\r\n        \r\n        root.#focusedNode = undefined;        \r\n        this.#focused = val;\r\n        if (focusedNode && focusedNode !== this) {\r\n            focusedNode.focused = false;\r\n        }\r\n\r\n        if (val) root.#focusedNode = this;\r\n        if (changed) root.#controllers?.forEach((c) => c.onFocusChanged?.(this));\r\n    }\r\n\r\n    /**\r\n     * Select single or multi node, depending on multi selection flag\r\n     * If single, remove selection flag from all other nodes\r\n     */\r\n    get selected() {\r\n        return this.#selected;\r\n    }\r\n\r\n    set selected(val) {\r\n        val = val === true;\r\n        const root = this.root;\r\n        const selectedNode = root.selectedNode();\r\n        const changed = this.#selected != val;\r\n        this.#selected = val;\r\n        if (val) {\r\n            if (selectedNode && selectedNode !== this && !root.multi) {\r\n                selectedNode.selected = false;\r\n            }\r\n            root.#selectedNode = this;\r\n        }\r\n        if (changed) {\r\n            root.#controllers?.forEach((c) => c.onSelectionChanged?.(this, selectedNode));\r\n            if (root.multi) root.#controllers?.forEach((c) => c.onSelectionChanged?.(this.parent, selectedNode));\r\n        } \r\n    }\r\n\r\n    get isPartialySelected() {\r\n        return this.selected && this.hasChildren && this.nodes.length > this.nodes.filter(n => n.selected).length;\r\n    }\r\n\r\n    /* hide from public\r\n    get host() {\r\n        return this[Symbol.for('gs-element')];\r\n    }\r\n\r\n    set host(el) {\r\n        this[Symbol.for('gs-element')] = el;\r\n    }\r\n    */\r\n\r\n    selectAll() {\r\n        const root = this.root;\r\n        if (!root.multi) {\r\n            this.deselectAll();\r\n            this.selected = true;\r\n            return\r\n        }\r\n        this.#selectionFlag(true);\r\n        root.#selectedNode = this;\r\n        root.#controllers?.forEach((c) => c.onSelectAll?.(root));\r\n    }\r\n\r\n    deselectAll() {\r\n        const root = this.root;\r\n        this.#selectionFlag(false);\r\n        root.#selectedNode = undefined;\r\n        root.#controllers?.forEach((c) => c.onDeselectAll?.(root));\r\n    }\r\n\r\n    /**\r\n     * Return last focused node\r\n     * @returns \r\n     */\r\n    focusedNode() {\r\n        const node = this.root.#focusedNode;\r\n        return node?.focused ? node : undefined;\r\n    }\r\n\r\n    /**\r\n     * Return last selected node\r\n     * @returns \r\n     */\r\n    selectedNode() {\r\n        const node = this.root.#selectedNode;\r\n        return node?.selected ? node : undefined;\r\n    }\r\n\r\n    /**\r\n     * List all selected nodes.\r\n     * TODO; refactor when Iterator.filter become available \r\n     * @returns \r\n     */\r\n    selectedNodes() {\r\n        const root = this.root;\r\n        if (!root.multi) {\r\n            const node = root.selectedNode()\r\n            return node?.selected ? [node] : [];\r\n        }\r\n        const result = [];\r\n        for (let node of root.walk()) {\r\n            if (node.selected) result.push(node);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Call from external controller data must be refresshed (to notify UI optionally)\r\n     * @param {*} root \r\n     */\r\n    refresh(root) {\r\n        root = root || this.root;\r\n        root.#controllers?.forEach((c) => c.onRefresh?.(this));\r\n    }\r\n\r\n    /**\r\n     * Notify controllers about data loading (from async controller)\r\n     * @param {*} root \r\n     */\r\n    loading(root) {\r\n        root = root || this.root;\r\n        root.#controllers?.forEach((c) => c.onLoad?.(this));\r\n    }\r\n\r\n    expandAll(root) {\r\n        const me = this;\r\n        root = root || me.root;\r\n        for (let node of this.walk()) {\r\n            if (!node.isLeaf) node.expand(root);\r\n        }\r\n    }\r\n\r\n    collapseAll(root) {\r\n        const me = this;\r\n        root = root || me.root;\r\n        for (let node of this.walk()) {\r\n            if (!node.isLeaf) node.collapse(root);\r\n        }\r\n    }\r\n\r\n    expand(root) {\r\n        const me = this;\r\n        root = root || me.root;\r\n        if (!me.parent?.opened) {\r\n            me.parent?.expand(root);\r\n        }\r\n        const update = !me.opened;\r\n        me.#opened = true;\r\n        if (update) me.#expanded(root);\r\n        //me.nodes?.filter( n => !n.opened).forEach(c => c.refresh(root));\r\n        me.nodes?.forEach(c => c.refresh(root));\r\n    }\r\n\r\n    collapse(root) {\r\n        const me = this;\r\n        root = root || me.root;\r\n        const update = me.#opened || me.parent.#opened;\r\n        me.nodes?.filter(n => n.opened || n.parent.opened).forEach(o => o.collapse(root));\r\n        //me.nodes?.forEach(o => o.collapse(root));\r\n        me.#opened = false;\r\n        if (update) me.#collapsed(root);\r\n    }\r\n\r\n    select(val = true) {\r\n        this.selected = val === true;\r\n    }\r\n\r\n    #expanded(root) {\r\n        root.#controllers?.forEach((c) => c.onExpand?.(this));\r\n    }\r\n\r\n    #collapsed(root) {\r\n        root.#controllers?.forEach((c) => c.onCollapse?.(this));\r\n    }\r\n\r\n    release() {\r\n        if (this.#selected) this.selected = false;\r\n        super.release();\r\n    }\r\n\r\n    append(key, value = key) {\r\n        const me = this;\r\n        const node = super.append(key, value);\r\n        if (node) me.root.#controllers?.forEach((c) => c.onAppend?.(me, node));\r\n        return node;\r\n    }\r\n\r\n    insert(parentNodeKey, key, value = key) {\r\n        const me = this;\r\n        const node = super.insert(parentNodeKey, key, value);\r\n        if (node) me.root.#controllers?.forEach((c) => c.onInsert?.(me, node));\r\n        return node;\r\n    }\r\n\r\n    remove() {\r\n        const node = super.remove();\r\n        if (node) this.root.#controllers?.forEach((c) => c.onInsert?.(node));\r\n        return node;\r\n    }\r\n\r\n    #selectionFlag(val = false) {\r\n        val = val === true\r\n        for (let node of this.walk()) {\r\n            node.selected = val;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Load JSON data into tree\r\n     * @param {*} data \r\n     */\r\n    fromJSON(data) {\r\n        if (data) TreeNode.from(this, data);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Used by JSON.stringify to properly export as JSON\r\n     * @returns \r\n     */\r\n    toJSON() {\r\n        if (this.level < 0) return this.nodes?.map(o => o.toJSON()) || {};\r\n        const obj = Object.assign({\r\n            key: this.key,\r\n            opened: this.#opened,\r\n            focused: this.#focused,\r\n            selected: this.#selected,\r\n            items: undefined\r\n        }, this.value);\r\n        obj.items = this.nodes?.map(o => o.toJSON());\r\n        return obj;\r\n    }\r\n\r\n    static get root() {\r\n        return new TreeNode(null, null, null, -1);\r\n    }\r\n\r\n    /**\r\n     * Convert JSON tree into Linked Tree \r\n     * @param {*} data \r\n     * @returns \r\n     */\r\n    static from(parent, data) {\r\n        const raw = data || parent;\r\n        const hasParent = parent instanceof TreeNode;\r\n        if (Array.isArray(raw)) {\r\n            if (!hasParent) return TreeNode.from(TreeNode.root, raw);\r\n            raw.forEach(o => TreeNode.from(parent, o));\r\n            return parent;\r\n        }\r\n        const { items, ...obj } = raw;\r\n        obj.leaf = !Array.isArray(items);\r\n        const tree = new TreeNode(obj.key, obj, data ? parent : undefined);\r\n        if (items) TreeNode.from(tree, items);\r\n        if (hasParent) parent.append(tree);\r\n        return tree;\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSReadWrite } from \"./ReadWrite.mjs\";\r\nimport { GSReadWriteRegistry } from \"./ReadWriteRegistry.mjs\";\r\nimport { TreeNode } from \"./TreeNode.mjs\";\r\n\r\n/**\r\n * A module loading GSTreeReader class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Generic Class for reading Tree nodes\r\n * @Class\r\n */\r\nexport class GSTreeReader extends GSReadWrite {\r\n\r\n    #data = TreeNode.root;\r\n\r\n    /**\r\n     * Instance constructor\r\n     * @param {string} name Unique handler name\r\n     * @param {boolean} enabled Automatically registe in global registry. \r\n     */\r\n    constructor(name, enabled) {\r\n        super(name, enabled);\r\n    }\r\n\r\n    async write(val) {\r\n        throw new Error('Writer not available for TreeReader')\r\n    }\r\n\r\n    async read(owner) {\r\n        const me = this;\r\n        let node = undefined;\r\n        const data = await super.read(owner);\r\n        if (!this.#data) {\r\n            node = TreeNode.from(data);\r\n            this.#data = node;\r\n        } else {\r\n            const parent = me.filter?.length > 0 ? me.#data.findByKey(me.filter[0]) : me.#data;\r\n            parent.clear();\r\n            node = parent.fromJSON(data);\r\n        }\r\n        me.filter = undefined;\r\n        me.notify(owner, 'read', node);\r\n        return node;\r\n    }\r\n\r\n    disable() {\r\n        super.disable();\r\n        this.#data?.release();\r\n    }\r\n\r\n    notify(owner, type, data, error) {\r\n        const isNode = data instanceof TreeNode;\r\n        if (!error && !isNode && type === 'read') return;\r\n        super.notify(owner, type, data, error);\r\n    }\r\n\r\n    /**\r\n     * Called from Tree when node is expanded \r\n     * @param {*} node \r\n     */\r\n    async onExpand(node) {\r\n        if (node.hasChildren) return;\r\n        node.loading();\r\n        this.filter = node.key;\r\n        return await this.read();\r\n    }\r\n\r\n    get data() {\r\n        return this.#data;\r\n    }\r\n\r\n    /**\r\n     * Register generic handler under unique name.\r\n     * @param {string} name Unique handler name\r\n     * @returns {GSTreeReader} Data handler instance\r\n     */\r\n    static register(name) {\r\n        return new GSTreeReader(name, true);\r\n    }\r\n\r\n    static {\r\n        GSReadWriteRegistry.addHandler('tree', GSTreeReader);\r\n    }\r\n\r\n}","// Lit 3.0 Google\r\nconst litUrl = globalThis.GS_LIT_URL || '/bootstrap-lit/assets/lib/lit-all.min.js';\r\nconst litModule = await import(litUrl);\r\n\r\n// small helper to print this exports (or any other module); use it when upgrading to a new Lit version to regenerte export list below\r\nexport const printModuleExports = (module) => console.log(Object.keys(module || litModule).map(v => `export const ${v} = litModule.${v};`).join('\\n'));\r\n\r\nexport const ReactiveController = litModule.ReactiveController;\r\nexport const ReactiveElement = litModule.ReactiveElement;\r\nexport const AsyncDirective = litModule.AsyncDirective;\r\nexport const AsyncReplaceDirective = litModule.AsyncReplaceDirective;\r\nexport const CSSResult = litModule.CSSResult;\r\nexport const Directive = litModule.Directive;\r\nexport const LitElement = litModule.LitElement;\r\nexport const PartType = litModule.PartType;\r\nexport const TemplateResultType = litModule.TemplateResultType;\r\nexport const UnsafeHTMLDirective = litModule.UnsafeHTMLDirective;\r\nexport const UntilDirective = litModule.UntilDirective;\r\nexport const _$LE = litModule._$LE;\r\nexport const _$LH = litModule._$LH;\r\nexport const adoptStyles = litModule.adoptStyles;\r\nexport const asyncAppend = litModule.asyncAppend;\r\nexport const asyncReplace = litModule.asyncReplace;\r\nexport const cache = litModule.cache;\r\nexport const choose = litModule.choose;\r\nexport const classMap = litModule.classMap;\r\nexport const clearPart = litModule.clearPart;\r\nexport const createRef = litModule.createRef;\r\nexport const css = litModule.css;\r\nexport const defaultConverter = litModule.defaultConverter;\r\nexport const directive = litModule.directive;\r\nexport const getCommittedValue = litModule.getCommittedValue;\r\nexport const getCompatibleStyle = litModule.getCompatibleStyle;\r\nexport const getDirectiveClass = litModule.getDirectiveClass;\r\nexport const guard = litModule.guard;\r\nexport const html = litModule.html;\r\nexport const ifDefined = litModule.ifDefined;\r\nexport const insertPart = litModule.insertPart;\r\nexport const isCompiledTemplateResult = litModule.isCompiledTemplateResult;\r\nexport const isDirectiveResult = litModule.isDirectiveResult;\r\nexport const isPrimitive = litModule.isPrimitive;\r\nexport const isServer = litModule.isServer;\r\nexport const isSingleExpression = litModule.isSingleExpression;\r\nexport const isTemplateResult = litModule.isTemplateResult;\r\nexport const join = litModule.join;\r\nexport const keyed = litModule.keyed;\r\nexport const literal = litModule.literal;\r\nexport const live = litModule.live;\r\nexport const map = litModule.map;\r\nexport const noChange = litModule.noChange;\r\nexport const notEqual = litModule.notEqual;\r\nexport const nothing = litModule.nothing;\r\nexport const range = litModule.range;\r\nexport const ref = litModule.ref;\r\nexport const removePart = litModule.removePart;\r\nexport const render = litModule.render;\r\nexport const repeat = litModule.repeat;\r\nexport const setChildPartValue = litModule.setChildPartValue;\r\nexport const setCommittedValue = litModule.setCommittedValue;\r\nexport const staticHtml = litModule.staticHtml;\r\nexport const staticSvg = litModule.staticSvg;\r\nexport const styleMap = litModule.styleMap;\r\nexport const supportsAdoptingStyleSheets = litModule.supportsAdoptingStyleSheets;\r\nexport const svg = litModule.svg;\r\nexport const templateContent = litModule.templateContent;\r\nexport const unsafeCSS = litModule.unsafeCSS;\r\nexport const unsafeHTML = litModule.unsafeHTML;\r\nexport const unsafeSVG = litModule.unsafeSVG;\r\nexport const unsafeStatic = litModule.unsafeStatic;\r\nexport const until = litModule.until;\r\nexport const when = litModule.when;\r\nexport const withStatic = litModule.withStatic;","import { Directive, directive, nothing } from \"../lib.mjs\";\r\n\r\nconst definition = {\r\n    'action': 'gsAction',\r\n    'anchor': 'gsAnchor',\r\n    'attribute': 'gsAttribute',\r\n    'call': 'gsCall',\r\n    'exec': 'gsExec',\r\n    'inject': 'gsInject',\r\n    'property': 'gsProperty',\r\n    'swap': 'gsSwap',\r\n    'target': 'gsTarget',\r\n    'template': 'gsTemplate',\r\n    'toggle': 'gsToggle',\r\n    'trigger': 'gsTrigger',\r\n    'value': 'gsValue'\r\n}\r\n\r\nconst template = {\r\n    'gsAction': undefined,\r\n    'gsAnchor': undefined,\r\n    'gsAttribute': undefined,\r\n    'gsCall': undefined,\r\n    'gsExec': undefined,\r\n    'gsInject': undefined,\r\n    'gsProperty': undefined,\r\n    'gsSwap': undefined,\r\n    'gsTarget': undefined,\r\n    'gsTemplate': undefined,\r\n    'gsToggle': undefined,\r\n    'gsTrigger': undefined,\r\n    'gsValue': undefined\r\n}\r\n\r\nclass DatasetDirective extends Directive {\r\n\r\n    render(obj) {\r\n        console.log(obj);\r\n        return nothing;\r\n    }\r\n\r\n    update(part, [obj, flat = true]) {\r\n\r\n        if (!obj) return nothing;\r\n\r\n        const dataset = part.element.dataset;\r\n        const srcset = obj.dataset || obj;\r\n        const isDataset = srcset instanceof DOMStringMap;\r\n\r\n        if (isDataset) {\r\n            Object.assign(dataset, srcset);\r\n        } \r\n        \r\n        if (flat) this.#remap(dataset, obj);\r\n\r\n        return nothing;\r\n    }\r\n\r\n    #remap(dataset, obj) {\r\n        const opt = Object.assign({}, template);\r\n        const list = Object.entries(obj).filter(v => Object.hasOwn(definition, v[0]));\r\n        if (list.length > 0) {\r\n            list.forEach(kv => opt[definition[kv[0]]] = kv[1]);\r\n            Object.assign(dataset, opt);\r\n        }\r\n    }\r\n}\r\n\r\nexport const dataset = directive(DatasetDirective);\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { html } from '../lib.mjs';\r\n\r\n/**\r\n * Generic object property descritptor getter\r\n * @param {Object} instance \r\n * @returns {PropertyDescriptor}\r\n */\r\nfunction descriptors(instance) {\r\n  return Object.entries(Object.getOwnPropertyDescriptors(instance));\r\n}\r\n\r\n/**\r\n * List of all object property descriptors \r\n * @param {Object} instance Object instance \r\n * @returns {Array<PropertyDescriptor>}\r\n */\r\nfunction listProperties(instance) {\r\n  return descriptors(instance)\r\n    .filter(e => typeof e[1].value !== 'function')\r\n    .map(e => e[0]);\r\n}\r\n\r\n/**\r\n * List all object property getters\r\n * @param {Object} instance \r\n * @returns {Array}\r\n */\r\nfunction listGetters(instance) {\r\n  return descriptors(Reflect.getPrototypeOf(instance))\r\n    .filter(e => typeof e[1].get === 'function' && e[0] !== '__proto__')\r\n    .map(e => e[0]);\r\n}\r\n\r\n/**\r\n * List of all getteble properties from an object\r\n * @param {Object} instance \r\n * @returns {Array}\r\n */\r\nfunction listGettable(instance) {\r\n  return new Set([...listGetters(instance), ...listProperties(instance)]);\r\n}\r\n\r\n/**\r\n * Parse string literal template into Lit html instance\r\n * @param {*} tpl \r\n * @param {*} params \r\n * @returns {function}\r\n */\r\nexport function literalTemplate(tpl, params) {\r\n  const names = Array.from(listGettable(params));\r\n  const vals = names.map(v => params[v]);\r\n  names.push('html');\r\n  vals.push(html);\r\n  return new Function(...names, `return html\\`${tpl}\\`;`)(...vals);\r\n}","/**\r\n * A clone of classMap directive to support CSS directive.\r\n * Lit classs is not expoed, so we have to clone it and create our own.\r\n */\r\n\r\nimport { Directive, PartType, directive, noChange } from \"../lib.mjs\";\r\n\r\nclass CssMapDirective extends Directive {\r\n\r\n    constructor(partInfo) {\r\n        super(partInfo);\r\n        if (partInfo.type !== PartType.ATTRIBUTE ||\r\n            partInfo.name !== 'css' ||\r\n            partInfo.strings?.length > 2) {\r\n            throw new Error('`classMap()` can only be used in the `css` attribute ' +\r\n                'and must be the only part in the attribute.');\r\n        }\r\n    }\r\n\r\n    render(classInfo) {\r\n        // Add spaces to ensure separation from static classes\r\n        return (' ' +\r\n            Object.keys(classInfo)\r\n                .filter((key) => classInfo[key])\r\n                .join(' ') +\r\n            ' ');\r\n    }\r\n\r\n    update(part, [classInfo]) {\r\n\r\n        // Remember dynamic classes on the first render\r\n        if (this._previousClasses === undefined) {\r\n            this._previousClasses = new Set();\r\n            if (part.strings !== undefined) {\r\n                this._staticClasses = new Set(part.strings\r\n                    .join(' ')\r\n                    .split(/\\s/)\r\n                    .filter((s) => s !== ''));\r\n            }\r\n\r\n            for (const name in classInfo) {\r\n                if (classInfo[name] && !this._staticClasses?.has(name)) {\r\n                    this._previousClasses.add(name);\r\n                }\r\n            }\r\n            return this.render(classInfo);\r\n        }\r\n\r\n        const classList = part.element.classList;\r\n\r\n        // Remove old classes that no longer apply\r\n        for (const name of this._previousClasses) {\r\n            if (!(name in classInfo)) {\r\n                classList.remove(name);\r\n                this._previousClasses.delete(name);\r\n            }\r\n        }\r\n\r\n        // Add or remove classes based on their classMap value\r\n        for (const name in classInfo) {\r\n            // We explicitly want a loose truthy check of `value` because it seems\r\n            // more convenient that '' and 0 are skipped.\r\n            const value = !!classInfo[name];\r\n            if (value !== this._previousClasses.has(name) &&\r\n                !this._staticClasses?.has(name)) {\r\n                if (value) {\r\n                    classList.add(name);\r\n                    this._previousClasses.add(name);\r\n                } else {\r\n                    classList.remove(name);\r\n                    this._previousClasses.delete(name);\r\n                }\r\n            }\r\n        }\r\n        return noChange;\r\n    }\r\n}\r\n\r\n/**\r\n * A directive that applies dynamic CSS classes.\r\n *\r\n * This must be used in the `css` attribute and must be the only part used in\r\n * the attribute. It takes each property in the `classInfo` argument and adds\r\n * the property name to the element's `classList` if the property value is\r\n * truthy; if the property value is falsey, the property name is removed from\r\n * the element's `css`.\r\n *\r\n * For example `{foo: bar}` applies the class `foo` if the value of `bar` is\r\n * truthy.\r\n *\r\n * @param classInfo\r\n */\r\nexport const cssMap = directive(CssMapDirective);\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nexport const notEmpty = (newVal, oldVal) => newVal !== oldVal && newVal;\r\nexport const numGT0 = (newVal, oldVal) => newVal !== oldVal && Number(newVal) > 0;\r\nexport const numGE0 = (newVal, oldVal) => newVal !== oldVal && Number(newVal) >= 0;\r\nexport const numLT0 = (newVal, oldVal) => newVal !== oldVal && Number(newVal) < 0;\r\nexport const numLE0 = (newVal, oldVal) => newVal !== oldVal && Number(newVal) <= 0;\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nexport class ButtonTypes {\r\n\r\n    static values = ['button', 'reset', 'submit'];\r\n\r\n    static is(val) {\r\n        return ButtonTypes.values.includes(val);\r\n    }\r\n\r\n    static isReest(val) {\r\n        return ButtonTypes.values.indexOf(val) === 1;\r\n    }\r\n\r\n    static isSubmit(val) {\r\n        return ButtonTypes.values.indexOf(val) === 2;\r\n    }\r\n} \r\n\r\nexport const buttonType = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && ButtonTypes.is(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nexport const ColorTypes = ['', 'primary', 'secondary', 'dark', 'light', 'info', 'warning', 'danger', 'alert', 'link', 'success'];\r\n\r\nexport const color = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && ColorTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nexport const EnvironmentTypes = ['', 'dektop', 'mobile', 'tablet', 'android', 'linux', 'windows', 'macos', 'ios'];\r\n\r\nexport const environment = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && EnvironmentTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n\r\nexport const InputTypes = ['checkbox', 'radio', 'switch', 'number', 'range', 'text', 'passsword', 'email', 'url', 'file'];\r\n\r\nexport const inputType = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && InputTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nexport const NavTypes = ['', 'pills', 'tabs', 'underline'];\r\n\r\nexport const nav = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && NavTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nexport class OrientationTypes {\r\n\r\n    static values =  ['', 'horizontal', 'vertical', 'portrait', 'landscape'];\r\n\r\n    static includes(val) {\r\n        return OrientationTypes.values.includes(val);\r\n    }\r\n\r\n    static isVertical(val) {\r\n        const idx = OrientationTypes.values.indexOf(val)\r\n        return idx === 2 || idx === 3;\r\n    }\r\n\r\n    static isHorizontal(val) {\r\n        const idx = OrientationTypes.values.indexOf(val)\r\n        return idx === 1 || idx === 4;\r\n    }\r\n\r\n}\r\n\r\nexport const orientation = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && OrientationTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nexport class PlacementTypes {\r\n\r\n    static values = ['center', 'left', 'right', 'start', 'end', 'top', 'bottom'];\r\n\r\n    static includes(val) {\r\n        return PlacementTypes.values.includes(val);\r\n    }\r\n\r\n    static isVertical(val) {\r\n        return PlacementTypes.values.indexOf(val) > 4;\r\n    }\r\n\r\n    static isHorizontal(val) {\r\n        const idx = PlacementTypes.values.indexOf(val)\r\n        return idx > 0 && idx < 5;\r\n    }\r\n\r\n    static isCenter(val) {\r\n        return PlacementTypes.values.indexOf(val) === 0;\r\n    }\r\n\r\n    static isBefore(val) {\r\n        return ['left', 'start', 'top'].includes(val);\r\n    }\r\n\r\n    static isAfter(val) {\r\n        return ['right', 'end', 'bottom'].includes(val);\r\n    }\r\n}\r\n\r\n\r\nexport const placement = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && PlacementTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nexport class PositionTypes {\r\n\r\n    static values = ['absolute', 'fixed', 'relative', 'sticky', 'static'];\r\n\r\n    static includes(val) {\r\n        return PositionTypes.values.includes(val);\r\n    }\r\n}\r\n\r\n\r\nexport const position = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && PositionTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nexport const ProtocolTypes = ['', 'http', 'https'];\r\n\r\nexport const protocol = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && ProtocolTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nexport const SizeTypes = { 'default' : '', 'normal': '',  'medium': '', 'small': 'sm', 'large': 'lg', 'big' : 'lg' };\r\n\r\nexport const size = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && Object.hasOwn(SizeTypes, newVal);\r\n    }\r\n\r\n};","export const stringArrayConverter = {\r\n    fromAttribute: (value, type) => {\r\n        return (value || '').split(',');\r\n    },\r\n    toAttribute: (value, type) => {\r\n        return (value || []).join(',');\r\n    }\r\n  }","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDynamicStyle } from '../base/GSDynamicStyle.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSCacheStyles } from '../base/GSCacheStyles.mjs';\r\n\r\n/**\r\n * Controller register self to gs-adopted event listener list.\r\n * Every time even gs-adopted is triggered by the GSAdoptedEngien class,\r\n * all registerd controller will be processed for reapplaying stylesheet \r\n * Also, this controlelr takes care of adding custom dynamic styles \r\n * to the end fo the list.\r\n * \r\n * Custom dynamic styles are used internally by the components for dynamic \r\n * style changes to preven dom node polution; \r\n * Style  changes  are not visible directly on DOM node.\r\n */\r\nexport class AdoptedController {\r\n\r\n  #host;\r\n  #dynamic;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    AdoptedController.#controllers.add(me);\r\n    me.#adopt();\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    AdoptedController.#controllers.delete(me.#host);\r\n    me.#host.removeController(me);\r\n  }\r\n\r\n  /**\r\n   * Initialize dynamic style for component instance\r\n   * Call it from constructor for style to be applied to the current component\r\n   * @param {String} name CSS class name\r\n   * @param {Object|String} values CSS class styles to be applied\r\n   * @returns {CSSStyleRule} An instance of a CSS class\r\n   */\r\n  style(name, values, isGlobal = false) {\r\n    const me = this;\r\n    let style = null;\r\n    if (isGlobal) {\r\n      style = GSCacheStyles.dynamic;\r\n    } else {\r\n      me.#dynamic = me.#dynamic ?? new GSDynamicStyle('dynamic');      \r\n      style = me.#dynamic;\r\n    }    \r\n    if (values === null && style.rules.length > 0 ) return style.removeRule(name);\r\n    return style.setRule(name, values, true);\r\n  }\r\n\r\n  #adopt(forced = false) {\r\n    const me = this;\r\n    if (!me.#sheets) return;\r\n    if (forced || me.#changed) {\r\n      const sheets = [...document.adoptedStyleSheets];\r\n      // support for lit \"static styles = css``\"\r\n      const internal = Array.from(me.#sheets);\r\n      if (me.#dynamic) internal.push(me.#dynamic);\r\n      me.#root.adoptedStyleSheets = [...sheets, ...internal];\r\n    }\r\n  }\r\n\r\n  get #changed() {\r\n    return document.adoptedStyleSheets.id !== this.#sheets?.id;\r\n  }\r\n\r\n  get #root() {\r\n    return this.#host.renderRoot;\r\n  }\r\n\r\n  get #sheets() {\r\n    return this.#root?.adoptedStyleSheets;\r\n  }\r\n\r\n  /**\r\n   * Global listener for gs-adopted event triggered from GSAdoptedEngine\r\n   */\r\n  static #controllers = new Set();\r\n\r\n  static #onAdopted(e) {\r\n    requestAnimationFrame(() => {\r\n      AdoptedController.#controllers.forEach(c => c.#adopt());\r\n    });\r\n  }\r\n\r\n  static #init() {\r\n    const me = AdoptedController;\r\n    GSEvents.on(window, null, 'gs-adopted', me.#onAdopted);\r\n  }\r\n\r\n  static {\r\n    this.#init();\r\n  }\r\n\r\n}  \r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSAttributeHandler } from \"../base/GSAttributeHandler.mjs\";\r\nimport { GSDOM } from \"../base/GSDOM.mjs\";\r\n\r\n/**\r\n * Attributes to control click actions for buttons and links.\r\n * Used to brings meta linking between UI elements\r\n */\r\nexport class AttributeController extends GSAttributeHandler {\r\n\r\n  constructor(host) {\r\n    super(host);\r\n    const me = this;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.attach(me.#eventName);\r\n    // me.host.on('notify', e => me.onNotify(e));\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.host.removeController(me);\r\n    me.deattach(me.#eventName);\r\n  }\r\n\r\n  onNotify(evt) {\r\n    const me = this;\r\n    me.handle(evt);\r\n  }\r\n\r\n  get #eventName() {\r\n    const tag = this.host?.tagName.toLowerCase();\r\n    const clazz = this.host?.clazzName;\r\n    const isFormEl = GSDOM.isFormElement(this.host);\r\n    const v1 = ['gs-form', 'gs form-group'].includes(tag);\r\n    const v2 = ['GSFormGroupElement'].includes(clazz);\r\n    return v1 || v2 || isFormEl ? 'change' : 'click';\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Handle rendered content cleanup (remove by default)\r\n * Set \"keep\" to the component to prevent rendered content removal.\r\n */\r\nexport class ContentController {\r\n\r\n  #host;\r\n  #ref;\r\n  #refs = new Set();\r\n\r\n  constructor(host) {\r\n    this.#host = host;\r\n    host.addController(this);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#removeContent();\r\n    me.#host = null;\r\n    me.#refs = null;\r\n    me.#ref = null;\r\n  }\r\n\r\n  hostUpdated() {\r\n    const me = this;\r\n    if (!me.#isSelf()) me.#refs.add(me.#target);\r\n  }\r\n\r\n  get contentRef() {\r\n    return this.#ref;\r\n  }\r\n\r\n  get #options() {\r\n    return this.#host?.renderOptions;\r\n  }\r\n\r\n  get #target() {\r\n    return this.#options?.renderBefore?.previousElementSibling;\r\n  }\r\n\r\n  #isSelf() {\r\n    const me = this;\r\n    const target = me.#target;\r\n    const root = me.#host?.renderRoot;\r\n    const shadow = me.#host?.shadowRoot;\r\n    return (target === shadow || target == root);\r\n  }\r\n\r\n  #removeContent() {\r\n    const me = this;\r\n    if (!me.#host?.keep) {\r\n      Array.from(me.#refs).forEach(el => el?.remove());\r\n      me.#refs.clear();\r\n    }\r\n  }\r\n}  ","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSDOM } from \"../base/GSDOM.mjs\";\r\nimport { GSLog } from \"../base/GSLog.mjs\";\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\nimport { GSReadWriteRegistry } from \"../data/ReadWriteRegistry.mjs\";\r\n\r\n/**\r\n * Controller between component and DataReadWrite.\r\n */\r\nexport class DataController {\r\n\r\n  #host;\r\n\r\n  #readCallback;\r\n  #writeCallback;\r\n  #errorCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#readCallback = me.#onRead.bind(me);\r\n    me.#writeCallback = me.#onWrite.bind(me);\r\n    me.#errorCallback = me.#onError.bind(me);\r\n    me.#host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.#listen(false);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#unlisten();\r\n    me.#host.removeController(me);\r\n  }\r\n\r\n  async relink(read = true) {\r\n    const me = this;\r\n    me.#unlisten();\r\n    me.#listen(read);\r\n  }\r\n\r\n  async read(obj) {\r\n    return this.store?.read(this.#host);\r\n  }\r\n\r\n  async write(obj) {\r\n    return this.store?.write(this.#host, obj);\r\n  }\r\n\r\n  async storage() {\r\n    return GSReadWriteRegistry.wait(this.storeID);\r\n  }\r\n\r\n  sort(val) {\r\n    if (!this.store) return;\r\n    this.store.sort = val;\r\n    return this.store.read();\r\n  } \r\n\r\n  filter(val) {\r\n    if (!this.store) return;\r\n    this.store.filter = val;\r\n    return this.store.read();\r\n  }\r\n\r\n  search(val) {\r\n    if (!this.store) return;\r\n    this.store.search = val;\r\n  }\r\n\r\n  get store() {\r\n    return GSReadWriteRegistry.find(this.storeID);\r\n  }\r\n\r\n  get storeID() {\r\n    return this.#host?.storage;\r\n  }\r\n\r\n  firstPage() {\r\n    this.page = 1;\r\n  }\r\n\r\n  lastPage() {\r\n    this.nextPage();\r\n  }\r\n\r\n  nextPage() {\r\n    this.page = this.page + 1;\r\n  }\r\n\r\n  prevPage() {\r\n    this.page = this.page - 1;\r\n  }\r\n\r\n  get page() {\r\n    const store = this.store;\r\n    return store ? Math.floor(store.skip / Math.max(store.limit, 1)) + 1 : 1;\r\n  }\r\n\r\n  set page(val) {\r\n    val = Math.max(1, GSUtil.asNum(val, 1));    \r\n    const store = this.store;\r\n    if (store) {\r\n      store.skip = val > 0 ? (store.limit * val) - store.limit : 0;\r\n      store.read(this.#host);\r\n    }\r\n  }\r\n\r\n  async #listen(read = true) {\r\n    const me = this;\r\n    const storage = await me.storage();\r\n    storage?.on('read', me.#readCallback);\r\n    storage?.on('write', me.#writeCallback);\r\n    storage?.on('error', me.#errorCallback);\r\n    if (read) storage.read(me.#host);\r\n  }\r\n\r\n  #unlisten() {\r\n    const me = this;\r\n    const storage = me.store;\r\n    storage?.off('read', me.#readCallback);\r\n    storage?.off('write', me.#writeCallback);\r\n    storage?.off('error', me.#errorCallback);\r\n  }\r\n\r\n  #onRead(e) {\r\n    const me = this;\r\n    me.#host.onDataRead?.(e.detail.data);\r\n    me.#notify('data-read', e.detail.data);\r\n  }\r\n\r\n  #onWrite(e) {\r\n    const me = this;\r\n    me.#host.onDataWrite?.(e.detail.data);\r\n    me.#notify('data-write', e.detail.data);\r\n  }\r\n\r\n  #onError(e) {\r\n    const me = this;\r\n    GSLog.error(me.#host, e);\r\n    me.#host.onDataError?.(e);\r\n    me.#notify('data-error', e.detail.data);\r\n  }\r\n\r\n  #notify(name, data) {\r\n    this.#host.emit(name, data, true, false, true);\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Controller for elment move events, properly handling mouse events.\r\n */\r\nexport class ElementMoveController {\r\n\r\n  #host;\r\n  #element;\r\n  #attached = false;\r\n\r\n  #cursorX = 0;\r\n  #cursorY = 0;\r\n\r\n  #mouseUpCallback;\r\n  #mouseDownCallback;\r\n  #mouseMoveCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n    me.#mouseUpCallback = me.#onMouseUp.bind(me);\r\n    me.#mouseDownCallback = me.#onMouseDown.bind(me);\r\n    me.#mouseMoveCallback = me.#onMouseMove.bind(me);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host = null;\r\n  }\r\n\r\n  attach(element) {\r\n    const me = this;\r\n    if (!me.#attached) {\r\n      me.#element = element;\r\n      me.#attached = true;\r\n      me.#host.attachEvent(me.#element, 'mousedown', me.#mouseDownCallback);\r\n    }\r\n  }\r\n\r\n  reset() {\r\n    const me = this;\r\n    me.#cursorX = 0;\r\n    me.#cursorY = 0;\r\n    me.#host.removeEvent(document, 'mouseup', me.#mouseUpCallback);\r\n    me.#host.removeEvent(document, 'mousemove', me.#mouseMoveCallback);\r\n  }\r\n\r\n  /**\r\n  * Call host onStartMove function\r\n  * @param {MouseEvent} e \r\n  */\r\n  #onMouseDown(e) {\r\n    const me = this;\r\n    me.#host.prevent(e);\r\n    me.#cursorX = e.clientX;\r\n    me.#cursorY = e.clientY;\r\n    me.#host.onStartMove?.(e, me.#cursorX, me.#cursorY);\r\n    me.#host.attachEvent(document, 'mouseup', me.#mouseUpCallback, true);\r\n    me.#host.attachEvent(document, 'mousemove', me.#mouseMoveCallback);\r\n  }\r\n\r\n  /**\r\n   * Remove mousemove listener and call host onEndMove function\r\n   * @param {MouseEvent} e \r\n   */\r\n  #onMouseUp(e) {\r\n    const me = this;\r\n    me.#host.prevent(e);\r\n    me.#host.removeEvent(document, 'mousemove', me.#mouseMoveCallback);\r\n    return me.#host.onEndMove?.(e, me.#cursorX, me.#cursorY);\r\n  }\r\n\r\n  /**\r\n   * Call host onMouseMove function\r\n   * @param {MouseEvent} e \r\n   */\r\n  #onMouseMove(e) {\r\n    const me = this;\r\n    me.#host.prevent(e);\r\n\r\n    me.#host.onMouseMove?.(e, me.#cursorX, me.#cursorY);\r\n\r\n    if (me.#cursorX < e.clientX) {\r\n      me.#host.onCursorRight?.(e, me.#cursorX, me.#cursorY);\r\n    } else if (me.#cursorX > e.clientX) {\r\n      me.#host.onCursorLeft?.(e, me.#cursorX, me.#cursorY);\r\n    }\r\n\r\n    if (me.#cursorY < e.clientY) {\r\n      me.#host.onCursorUp?.(e, me.#cursorX, me.#cursorY);\r\n    } else if (me.#cursorY > e.clientY) {\r\n      me.#host.onCursorDown?.(e, me.#cursorX, me.#cursorY);\r\n    }\r\n\r\n    me.#cursorX = e.clientX;\r\n    me.#cursorY = e.clientY;\r\n\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Controller for child element navigation / selection / focusing\r\n */\r\nexport class ElementNavigationController {\r\n\r\n  #host;\r\n  #attached;\r\n  #selected;\r\n  #focused;\r\n  #multiselect = new Set();\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.init();\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host = null;\r\n    me.#attached = false;\r\n  }\r\n\r\n  get circular() {\r\n    return this.#host?.circular === true;\r\n  }\r\n\r\n  get multiple() {\r\n    return this.#host?.multiple === true;\r\n  }\r\n\r\n  get focused() {\r\n    return this.#focused;\r\n  }\r\n\r\n  get selected() {\r\n    return this.multiple ? [...this.#multiselect.values()] : this.#selected;\r\n  }\r\n\r\n  init() {\r\n    const me = this;\r\n    me.#selected = me.#host.data?.filter(o => o.active).pop();\r\n  }\r\n\r\n  attach(el) {\r\n    const me = this;\r\n    if (me.#attached) return;\r\n    me.#attached = true;\r\n    me.#host.attachEvent(el, 'keydown', e => me.onKeyDown(e));\r\n    me.#host.attachEvent(el, 'keyup', e => me.onKeyUp(e));\r\n    me.#host.attachEvent(el, 'click', e => me.onClick(e));\r\n    me.#host.attachEvent(el, 'focusin', e => me.onFocusIn(e));\r\n    me.#host.attachEvent(el, 'focusout', e => me.onFocusOut(e));\r\n  }\r\n\r\n  previous() {\r\n    const me = this;\r\n    let el = me.#focused?.previousElementSibling;\r\n    while (el && el.disabled) el = el.previousElementSibling;\r\n    if (me.circular && !el) el = me.lastElementChild;\r\n    el?.focus();\r\n  }\r\n\r\n  next() {\r\n    const me = this;\r\n    let el = me.#focused?.nextElementSibling;\r\n    while (el && el.disabled) el = el.nextElementSibling;\r\n    if (me.circular && !el) el = me.firstElementChild;\r\n    el?.focus();\r\n  }\r\n\r\n  /**\r\n   * Reset focus / selection\r\n   */\r\n  reset() {\r\n    const me = this;\r\n    if (me.multiple) {\r\n      me.#multiselect.forEach(el => {\r\n        el.active = false;\r\n        el.blur();\r\n      });\r\n    } else if (me.#selected) {\r\n      me.#selected.active = false;\r\n      me.#selected.blur();\r\n    }\r\n    me.#multiselect.clear();\r\n    me.#focused = undefined;\r\n    me.#selected = undefined;\r\n    this.#host?.emit('group-reset', undefined, true);\r\n  }\r\n\r\n  /**\r\n   * Callback when child element selected\r\n   * @param {*} el \r\n   */\r\n  #onSelected(el) {\r\n    this.#host?.onSelected?.(el);\r\n    this.#host?.emit('group-selected', el, true);\r\n  }\r\n\r\n  /**\r\n   * Callback when child element deselected\r\n   * @param {*} el \r\n   */\r\n  #onDeselected(el) {\r\n    this.#host?.onDeselected?.(el);\r\n    this.#host?.emit('group-deselected', el, true);\r\n  }\r\n\r\n  /**\r\n   * Callback when child element focused\r\n   * @param {*} el \r\n   */\r\n  #onFocused(el) {\r\n    this.#host?.onFocused?.(el);\r\n    this.#host?.emit('group-focused', el, true);\r\n  }\r\n\r\n  /**\r\n   * Element navigation filter where we can select if focused element is navigable\r\n   * @param {*} el \r\n   * @returns \r\n   */\r\n  #isNavigable(el) {\r\n    return this.#host?.isNavigable ? this.#host?.isNavigable(el) : true;\r\n  }\r\n\r\n  #focus(el) {\r\n    const me = this;\r\n    if (!me.#isNavigable(el)) return;\r\n    me.#focused = el;\r\n    if (el) {\r\n      me.#onFocused(me.#focused);\r\n    }\r\n  }\r\n\r\n  #toggle(el) {\r\n    if (!el) return;\r\n    const me = this;\r\n    if (!me.#isNavigable(el)) return;\r\n    if (el.active) {\r\n      me.#multiselect.add(el);\r\n      me.#onSelected(el);\r\n    } else {\r\n      me.#multiselect.delete(el);\r\n      me.#onDeselected(el);\r\n    }\r\n  }\r\n\r\n  #select(el) {\r\n    const me = this;\r\n    if (!me.#isNavigable(el)) return;\r\n\r\n    if (me.#selected && !me.multiple) {\r\n      me.#selected.active = false;\r\n      me.#toggle(me.#selected);\r\n    }\r\n\r\n    me.#selected = el;\r\n    if (el) {\r\n      if (me.multiple) {\r\n        el.active = !el.active;\r\n      } else {\r\n        el.active = true;\r\n      }\r\n      me.#toggle(el);\r\n    }\r\n  }\r\n\r\n  onFocusOut(e) {\r\n    const me = this;\r\n    //if (me.#focused === e.target) me.#focused = undefined;\r\n  }\r\n\r\n  onFocusIn(e) {\r\n    const me = this;\r\n    me.#focus(e.target)\r\n  }\r\n\r\n  onClick(e) {\r\n    const me = this;\r\n    const el = e.composedPath().filter(el => el.parentElement === me.#host).pop();\r\n    if (!el) return;\r\n    if (e.ctrlKey) me.reset();\r\n    me.#onDeselected(me.#selected);\r\n    me.#select(el);\r\n  }\r\n\r\n  onKeyDown(e) {\r\n    const me = this;\r\n    switch (e.code) {\r\n      case 'ArrowUp':\r\n      case 'ArrowLeft':\r\n        me.previous();\r\n        break;\r\n      case 'ArrowDown':\r\n      case 'ArrowRight':\r\n        me.next();\r\n        break;\r\n    }\r\n\r\n  }\r\n\r\n  onKeyUp(e) {\r\n    const me = this;\r\n    switch (e.code) {\r\n      case 'Space':\r\n      case 'Enter':\r\n        me.#focused?.click();\r\n        break;\r\n    }\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Handle screen orientation events.\r\n * Trigger rerender to optionally hide element if \r\n * screen orientation is not supported\r\n */\r\nexport class OrientationController {\r\n\r\n    static #hosts = new Set();\r\n    #host;\r\n    \r\n    constructor(host) {\r\n      this.#host = host;\r\n      host.addController(this);\r\n    }\r\n    \r\n    hostConnected() {\r\n      OrientationController.#hosts.add(this);\r\n      this.update();\r\n    }\r\n    \r\n    hostDisconnected() {\r\n      const me = this;\r\n      OrientationController.#hosts.delete(me.#host);\r\n      me.#host.removeController(me);      \r\n      me.#host = null;\r\n    }\r\n\r\n    update() {\r\n      this.#host.requestUpdate();\r\n    }\r\n\r\n    static #onOrientation(e) {\r\n      Array.from(OrientationController.#hosts).forEach(h => h.update());\r\n    }\r\n    \r\n    static {\r\n      screen.orientation.addEventListener('change', OrientationController.#onOrientation);\r\n    }\r\n}  ","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\n\r\n/**\r\n * Listens for theme change and update component to apply new theme.\r\n * External theme changes only if component theme is not set.\r\n * Bootstrap uses CSS selector for theme in form of attribute value [data-bs-theme=\"***\"]\r\n * Compoennt and all first level childern in shadow dom are updated\r\n */\r\nexport class ThemeController {\r\n\r\n  #host;\r\n  #theme;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#theme = host.theme;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    ThemeController.#controllers.add(this);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    ThemeController.#controllers.delete(me);\r\n    me.#host.removeController(me);\r\n  }\r\n\r\n  hostUpdate() {\r\n    const me = this;\r\n    if (me.#theme !== me.#host?.theme) {\r\n      me.#theme === me.#host?.theme;\r\n      me.updateTheme(me.#theme);\r\n    }\r\n  }\r\n\r\n  updateThemeExt(theme) {\r\n    if (!this.#theme) this.updateTheme(theme);\r\n  }\r\n\r\n  updateTheme(theme) {\r\n    if (!theme) return;\r\n    const me = this;\r\n    GSAttr.set(me.#host, 'data-bs-theme', theme);\r\n    const children = me.#host?.renderRoot?.children || [];\r\n    Array.from(children).forEach(el => GSAttr.set(el, 'data-bs-theme', theme));\r\n  }\r\n\r\n  static #controllers = new Set();\r\n\r\n  static #onTheme(e) {\r\n    const me = ThemeController;\r\n    me.#controllers.forEach(c => c.updateThemeExt(e.detail));\r\n  }\r\n\r\n  static #init() {\r\n    GSEvents.on(window, null, 'gs-theme', ThemeController.#onTheme);\r\n  }\r\n\r\n  static {\r\n    ThemeController.#init();\r\n  }\r\n\r\n}  \r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\nimport { GSTemplateCache } from \"../base/GSTemplateCache.mjs\";\r\n\r\n/**\r\n * Handle element template and signal rerender when ready\r\n * Sequencial template load is used to prevent multiple request for the same URL\r\n */\r\nexport class TemplateController {\r\n\r\n  #host;\r\n  #template;\r\n  #lastRef;\r\n  #injected;\r\n\r\n  static #scheduled = false;\r\n  static #tasks = new Set();\r\n\r\n  constructor(host) {\r\n    this.#host = host;\r\n    host.addController(this);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.#injected = false;\r\n    me.#request();    \r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host = null;\r\n    me.#lastRef = null;\r\n    me.#template = null;\r\n  }\r\n\r\n  hostUpdate() {\r\n    this.#request();\r\n  }\r\n\r\n  requestUpdate() {\r\n    this.#host.requestUpdate();\r\n  }\r\n\r\n  hostUpdated() {\r\n    if (this.#injected) this.#host.templateInjected?.();\r\n  }\r\n\r\n  #request() {\r\n    const me = this;\r\n    const ref = me.templateRef;\r\n    if (me.#lastRef !== ref) {\r\n      me.#lastRef = ref;\r\n      if (ref) TemplateController.#schedule(this);\r\n    }\r\n  }\r\n\r\n  async #load() {\r\n    const me = this;\r\n    const ref = me.templateRef;\r\n    if (!ref) return;\r\n    const isTplEl = ref instanceof HTMLTemplateElement;\r\n    const template = isTplEl ? ref : await GSTemplateCache.loadTemplate(true, ref, ref);\r\n    if (template) {\r\n      me.#template = template;\r\n      me.#injected = true;\r\n      me.#host.requestUpdate();\r\n    }\r\n  }\r\n\r\n  get isTemplateElement() {\r\n    return this.#host?.tagName === 'GS-TEMPLATE';\r\n  }\r\n\r\n  get template() {\r\n    return this.#template;\r\n  }\r\n\r\n  get templateRef() {\r\n    const host = this.#host;\r\n    if (!host) return;\r\n    if(this.isTemplateElement) return host.src;\r\n    return host.template || host.query('template', false);\r\n  }\r\n\r\n  static async #process(tasks) {\r\n    await GSUtil.timeout(100);\r\n    const list = Array.from(tasks);\r\n    for (let item of list) {\r\n      await item.#load();\r\n      tasks.delete(item);\r\n    }\r\n  }\r\n\r\n  static #schedule(task) {\r\n    const me = TemplateController;\r\n    me.#tasks.add(task);\r\n    if (!me.#scheduled) {\r\n      me.#scheduled = true;\r\n      queueMicrotask(() => me.#process(me.#tasks).finally(me.#scheduled = false));\r\n    }\r\n  }\r\n\r\n}  \r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Handle event when template slot changes\r\n */\r\nexport class SlotController {\r\n\r\n    #host;\r\n    \r\n    constructor(host) {\r\n      this.#host = host;\r\n      host.addController(this);\r\n    }\r\n    \r\n    hostConnected() {\r\n      const me = this;\r\n      const target = me.#host.renderRoot || me.#host;\r\n      me.#host.attachEvent(target, 'slotchange', me.#onSlotChanged.bind(me));\r\n    }\r\n    \r\n    hostDisconnected() {\r\n      const me = this;\r\n      me.#host.removeController(me);      \r\n      me.#host = null;\r\n    }\r\n\r\n    #onSlotChanged(e) {\r\n      e.target.assignedElements().forEach(el => {\r\n        el.onSlotInjected?.(e.target);\r\n      });\r\n    }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\n\r\n/**\r\n * Listens for theme change and update component to apply new theme.\r\n * External theme changes only if component theme is not set.\r\n * Bootstrap uses CSS selector for theme in form of attribute value [data-bs-theme=\"***\"]\r\n * Compoennt and all first level childern in shadow dom are updated\r\n */\r\nexport class LocalizationController {\r\n\r\n  #host;\r\n  #locale;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#locale = host.locale;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    LocalizationController.#controllers.add(this);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    LocalizationController.#controllers.delete(me);\r\n    me.#host.removeController(me);\r\n  }\r\n\r\n  hostUpdate() {\r\n    const me = this;\r\n    if (me.#locale !== me.#host?.locale) {\r\n      me.#locale === me.#host?.locale;\r\n      me.updateLanguage(me.#locale);\r\n    }\r\n  }\r\n\r\n  updateLanguageExt(langauge) {\r\n    if (!this.#locale) this.updateLanguage(langauge);\r\n  }\r\n\r\n  updateLanguage(lang) {\r\n    if (!lang) return;\r\n    this.#host.requestUpdate();\r\n  }\r\n\r\n  static #controllers = new Set();\r\n\r\n  static #onLanguage(e) {\r\n    const me = LocalizationController;\r\n    me.#controllers.forEach(c => c.updateLanguageExt(e.detail));\r\n  }\r\n\r\n  static #init() {\r\n    GSEvents.on(window, null, 'gs-language', LocalizationController.#onLanguage);\r\n  }\r\n\r\n  static {\r\n    LocalizationController.#init();\r\n  }\r\n\r\n}  \r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { templateContent, noChange, LitElement } from './lib.mjs';\r\n\r\nimport { GSEvents } from './base/GSEvents.mjs';\r\nimport { GSEnvironment } from './base/GSEnvironment.mjs';\r\nimport { GSFunction } from './base/GSFunction.mjs';\r\nimport { GSLocalization } from './base/GSLocalization.mjs';\r\nimport { AdoptedController } from './controllers/AdoptedController.mjs';\r\nimport { ContentController } from './controllers/ContentController.mjs';\r\nimport { AttributeController } from './controllers/AttributeController.mjs';\r\nimport { LocalizationController } from './controllers/LocalizationController.mjs';\r\nimport { OrientationController } from './controllers/OrientationController.mjs';\r\nimport { TemplateController } from './controllers/TemplateController.mjs';\r\nimport { orientation } from './properties/orientation.mjs';\r\nimport { protocol } from './properties/protocol.mjs';\r\nimport { environment } from './properties/environment.mjs';\r\nimport { ThemeController } from './controllers/ThemeController.mjs';\r\nimport { notEmpty } from './properties/verificator.mjs';\r\nimport { DataController } from './controllers/DataController.mjs';\r\nimport { GSDOM } from './base/GSDOM.mjs';\r\nimport { GSData } from './base/GSData.mjs';\r\nimport { GSUtil } from './base/GSUtil.mjs';\r\nimport { SlotController } from './controllers/SlotController.mjs';\r\n\r\n/**\r\n * Main WebComponent used by all other GS-* components\r\n */\r\nexport class GSElement extends LitElement {\r\n\r\n  static properties = {\r\n    flat: { type: Boolean },\r\n    rtl: { type: Boolean, reflect: true },\r\n    hide: { type: Boolean, reflect: true },\r\n    padding: { type: Number },\r\n    margin: { type: Number },\r\n    rounded: { type: Boolean },\r\n    bordered: { type: Boolean },\r\n    shadow: { type: Boolean },\r\n    keep: { type: Boolean },\r\n\r\n    onready: {},\r\n    css: {},\r\n    theme: {},\r\n\r\n    os: {},\r\n    browser: {},\r\n    locale: { reflect: true, hasChanged: notEmpty },\r\n    environment: environment,\r\n    orientation: orientation,\r\n    protocol: protocol,\r\n\r\n    template: {}\r\n  }\r\n\r\n  #adopted;\r\n  #uiHandler;\r\n  #orientation;\r\n  #localization;\r\n  #dataController;\r\n  #slotController;\r\n  #themes\r\n  #template;\r\n  #content;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.css = '';\r\n    me.locale = \"\";\r\n    me.#adopted = new AdoptedController(me);\r\n    me.#content = new ContentController(me);\r\n    me.#localization = new LocalizationController(me);\r\n    me.#orientation = new OrientationController(me);\r\n    me.#template = new TemplateController(me);\r\n    me.#themes = new ThemeController(me);\r\n    me.#slotController = new SlotController(me);\r\n  }\r\n\r\n  attributeChangedCallback(name, oldValue, newValue) {\r\n    super.attributeChangedCallback(name, oldValue, newValue);\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    if (this.isBindable) this.binded();\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    GSEvents.deattachListeners(this);\r\n    super.disconnectedCallback();\r\n  }\r\n\r\n  /**\r\n   * Override Lit element createRenderRoot function.\r\n   * If flat, do not create shadowDom, render within self\r\n   * @returns \r\n   */\r\n  createRenderRoot() {\r\n    return this.flat ? this : super.createRenderRoot();\r\n  }\r\n\r\n  /**\r\n   * Override Lit element firstUpdated function.\r\n   * Here we call attribute script onready if available\r\n   * Make sure that inherited classes calls super.firstUpdated\r\n   */\r\n  firstUpdated() {\r\n    super.firstUpdated();\r\n    const me = this;\r\n    if (me.onready) {\r\n      const owner = me.onready.startsWith('this') ? this : window;\r\n      GSFunction.callFunction(me.onready, owner);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Override Lit element willUpdate function.\r\n   * Make sure that inherited classes calls super.willUpdate\r\n   * @param {*} changed \r\n   */\r\n  willUpdate(changed) {\r\n    const me = this;\r\n    if (changed.has('storage')) {\r\n      if (me.storage) {\r\n        if (!me.#dataController) {\r\n          me.#dataController = new DataController(me);\r\n        } else {\r\n          me.#dataController.relink();\r\n        }\r\n      } else {\r\n        me.#dataController?.hostDisconnected();\r\n        me.#dataController = undefined;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Called when this element injected in some slot\r\n   * @param {*} slot \r\n   */\r\n  onSlotInjected(slot) {\r\n\r\n  }\r\n\r\n  /**\r\n   * Override Lit element render function and control rendering\r\n   * @returns {*} Parsed lit html structure\r\n   */\r\n  render() {\r\n    return this.isAllowRender && !this.hide ? this.renderUI() : '';\r\n  }\r\n\r\n  /**\r\n   * Actual render function to override in inherited components\r\n   * @returns {*} Parsed lit html structure\r\n   */\r\n  renderUI() {\r\n    return this.renderTemplate();\r\n  }\r\n\r\n  /**\r\n   * Render html from provided template element or template url\r\n   * @returns {*}\r\n   */\r\n  renderTemplate() {\r\n    return this.templateRef ? templateContent(this.templateRef) : noChange;\r\n  }\r\n\r\n  /**\r\n   * Render this class css attributes.\r\n   * @returns {Object} JSON object with CSS properties\r\n   */\r\n  renderClass() {\r\n    const me = this;\r\n    const obj = {\r\n      'border': me.bordered,\r\n      'shadow-sm': me.shadow,\r\n      'rounded': me.rounded,\r\n      [`p-${me.padding}`]: me.padding >= 0,\r\n      [`m-${me.margin}`]: me.margin >= 0\r\n    };\r\n    return me.mapCSS(me.css, obj);\r\n  }\r\n\r\n  /**\r\n   * Called when asynchronnous template is injected into component\r\n   */\r\n  templateInjected() {\r\n    \r\n\t}\r\n\r\n  /**\r\n   * Attach bindings\r\n   */\r\n  binded() {\r\n    this.#uiHandler ??= new AttributeController(this);\r\n  }\r\n\r\n  /**\r\n   * Handle bindings \r\n   * @param {*} e \r\n   */\r\n  handle(e) {\r\n    this.#uiHandler?.handle(e);\r\n  }\r\n\r\n  /**\r\n   * Parse CSS string into JSON object\r\n   * @param {String} css CSS string to parse into JSON object\r\n   * @param {Object} obj JSON object to witch to add parsed CSS\r\n   * @returns {Object} css parsed JSON object \r\n   */\r\n  mapCSS(css, obj, flag = true) {\r\n    obj = obj || {};\r\n    (css || '').split(' ')\r\n      .map(v => v.trim())\r\n      .filter(v => v.length > 0)\r\n      .map(v => obj[v.trim()] = flag);\r\n    return obj;\r\n  }\r\n\r\n  /**\r\n   * Initialize dynamic style for component.\r\n   * Call it from constructor for style to be applied to the component\r\n   * Creates a dynamic StyleSheet which holds dynamic StyleRules for template elements\r\n   * @param {String} id \r\n   * @param {String|Object} value \r\n   * @param {boolean} isGlobal \r\n   * @returns {CSSStyleRule}\r\n   */\r\n  dynamicStyle(id, value, isGlobal = false) {\r\n    return this.#adopted.style(id, value, isGlobal);\r\n  }\r\n\r\n  /**\r\n   * Find element by its ID\r\n   * @param {String} name \r\n   * @returns {HTMLElement}\r\n   */\r\n  getByID(query = '') {\r\n    return GSDOM.getByID(this, query);\r\n  }\r\n\r\n  /**\r\n   * Find closest top element by CSS selector\r\n   * @param {String} query \r\n   * @param {Number} levels - walk limit\r\n   * @returns {HTMLElement}\r\n   */\r\n  closest(query = '', levels = -1) {\r\n    return GSDOM.closest(this, query, levels);\r\n  }\r\n\r\n  /**\r\n   * Find element by CSS selector (top level is this element)\r\n   * @param {String} name \r\n   * @returns {HTMLElement}\r\n   */\r\n  query(query = '', shadow = false) {\r\n    return GSDOM.query(this, query, false, shadow);\r\n  }\r\n\r\n  /**\r\n   * Find multiple elements by CSS selector (top level is this element)\r\n   * @param {String} query \r\n   * @returns {Array<HTMLElement>}\r\n   */\r\n  queryAll(query = '', shadow = false) {\r\n    return GSDOM.queryAll(this, query, false, shadow);\r\n  }\r\n\r\n  /**\r\n   * Generic component signal\r\n   * @param {Boolean} bubbles  Does buuble to upper nodes\r\n   * @param {Boolean} composed Does traverse from shadow DOM \r\n   */\r\n  notify(bubbles = true, composed = false, data) {\r\n    this.emit('notify', data, bubbles, composed, true);\r\n  }\r\n\r\n  /**\r\n   * Send event\r\n   * @param {String} name \r\n   * @param {Object} obj \r\n   * @param {Boolean} bubbles \r\n   * @param {Boolean} composed \r\n   * @param {Boolean} cancelable \r\n   */\r\n  emit(name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n    return GSEvents.send(this, name, obj, bubbles, composed, cancelable);\r\n  }\r\n\r\n  /**\r\n   * Wait for event to happen\r\n   * @async\r\n   * @param {String} name \r\n   * @returns {Promise}\r\n   */\r\n  waitEvent(name = '', timeout = 0) {\r\n    return GSEvents.wait(this, name, timeout);\r\n  }\r\n\r\n  /**\r\n   * Listen once for triggered event\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  once(name, func) {\r\n    return this.listen(name, func, true);\r\n  }\r\n\r\n  /**\r\n   * Alternative function for event listen\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  on(name, func, once = false) {\r\n    return this.listen(name, func, once);\r\n  }\r\n\r\n  /**\r\n   * Alternative function for event unlisten\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  off(name, func) {\r\n    return this.unlisten(name, func);\r\n  }\r\n\r\n  /**\r\n   * Prevent event firing up the DOM tree\r\n   * @param {Event} e \r\n   */\r\n  prevent(e) {\r\n    GSEvents.prevent(e);\r\n  }\r\n\r\n  /**\r\n   * Attach event to this element\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  listen(name, func, once = false) {\r\n    return this.attachEvent(this, name, func, once);\r\n  }\r\n\r\n  /**\r\n   * Remove event from this element\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  unlisten(name, func) {\r\n    return this.removeEvent(this, name, func);\r\n  }\r\n\r\n  /**\r\n  * Generic event listener appender\r\n  * \r\n  * @param {HTMLElement} el Element on which to monitor for named events\r\n  * @param {String} name Event name to watch for\r\n  * @param {Function} fn Event trigger callback\r\n  * @param {Boolean} once Listen only once\r\n  * @returns {Boolean} State if attachment was successful\r\n  */\r\n  attachEvent(el, name = '', fn, once = false) {\r\n    return GSEvents.attach(this, el, name, fn, once);\r\n  }\r\n\r\n  /**\r\n  * Generic event listener remove\r\n  * @param {HTMLElement} el Element on which to monitor for named events\r\n  * @param {String} name Event name to watch for\r\n  * @param {Function} fn Event trigger callback\r\n  * @returns {Boolean} State if attachment was successful\t\r\n  */\r\n  removeEvent(el, name = '', fn) {\r\n    return GSEvents.remove(this, el, name, fn);\r\n  }\r\n\r\n  /**\r\n   * Generic element hide function\r\n   */\r\n  toggle() {\r\n    this.hide = !this.hide;\r\n  }\r\n\r\n  translate(value) {\r\n    return GSLocalization.translate(this.locale, value);\r\n  }\r\n\r\n  get direction() {\r\n    if (GSUtil.isNull(this.rtl)) return undefined;\r\n    return this.rtl ? 'rtl' : 'ltr';\r\n  }\r\n\r\n  /**\r\n   * Check if component is bindable to process data-gs-atributes\r\n   */\r\n  get isBindable() {\r\n    return this.dataset.gsTarget;\r\n  }\r\n\r\n  /**\r\n   * Return true if current element or chadow dom child is focused\r\n   */\r\n  get isFocused() {\r\n    return this === document.activeElement;\r\n  }\r\n\r\n  /**\r\n   * Element tag name\r\n   */\r\n  get tag() {\r\n    return this.tagName.toLowerCase();\r\n  }\r\n\r\n  /**\r\n   * Reference to cached template if set\r\n   */\r\n  get templateRef() {\r\n    return this.#template.template;\r\n  }\r\n\r\n  /**\r\n   * Reference to rendered content\r\n   */\r\n  get contentRef() {\r\n    return this.#content.contentRef;\r\n  }\r\n\r\n  /**\r\n   * Reference to data controller if initialized\r\n   */\r\n  get dataController() {\r\n    return this.#dataController;\r\n  }\r\n\r\n  /**\r\n  * Check if element is allowed to be rendered\r\n  * @returns {Boolean} \r\n  */\r\n  get isAllowRender() {\r\n    return this.isValidEnvironment\r\n      && this.isValidBrowser\r\n      && this.isValidOS\r\n      && this.isValidProtocol\r\n      && this.isValidOrientation;\r\n  }\r\n\r\n  /**\r\n   * Returns if environment matched\r\n   * dektop, mobile, tablet, android, linux, winwdows, macos\r\n   * @returns {Boolean} \r\n   */\r\n  get isValidEnvironment() {\r\n    return GSEnvironment.isValidEnvironment(this.environment);\r\n  }\r\n\r\n  /**\r\n   * Return true if element can be rendered bysed on OS matching\r\n   * linux, windows...etc\r\n   * @returns {Boolean} \r\n   */\r\n  get isValidOS() {\r\n    return GSEnvironment.isDevice(this.os);\r\n  }\r\n\r\n  /**\r\n   * Returns if orientation matched for element rendering\r\n   * horizontal | landscape), vertical | portrait), ; return true if not set\r\n   * @returns {Boolean} \r\n   */\r\n  get isValidOrientation() {\r\n    return GSEnvironment.isValidOrientation(this.orientation);\r\n  }\r\n\r\n  /**\r\n   * Returns if browser matched, used to determine rendering/removal\r\n   * @returns {Boolean} \r\n   */\r\n  get isValidBrowser() {\r\n    return GSEnvironment.isValidBrowser(this.browser);\r\n  }\r\n\r\n  /**\r\n   * Returns if browser matched, used to determine rendering/removal\r\n   * @returns {Boolean} \r\n   */\r\n  get isValidProtocol() {\r\n    return GSEnvironment.isValidProtocol(this.protocol);\r\n  }\r\n\r\n  /**\r\n   * Get parent GS-* component\r\n   */\r\n  get parentComponent() {\r\n    return GSDOM.parentAll(this).filter(x => x instanceof GSElement).next()?.value;\r\n  }\r\n\r\n  /**\r\n   * Get this class name\r\n   */\r\n  get clazzName() {\r\n    return this.constructor.name;\r\n  }\r\n\r\n  get definitions() {\r\n    const list = [...GSDOM.inheritance(this)].map(o => o.constructor?.properties).filter(o => o);\r\n    list.push(this.constructor?.properties);\r\n    return GSData.mergeObjects(list);\r\n  }\r\n\r\n  /**\r\n   * Get instance of internal styles\r\n   */\r\n  get elementStyles() {\r\n    return this.constructor.elementStyles.map(s => Object.values(s).filter(o => o instanceof CSSStyleSheet).pop()).pop();\r\n  }\r\n\r\n  /**\r\n   * Internal shadow styles rule\r\n   * @param {*} name \r\n   * @returns \r\n   */\r\n  cssRule(name) {\r\n    return Array.from(this.elementStyles.rules).filter(r => r.selectorText === name).pop();\r\n  }\r\n\r\n  /**\r\n   * Set dynamic CSS rule \r\n   * See GSIcon hot it is done\r\n   * @param {*} rule \r\n   * @param {*} name \r\n   * @param {*} value \r\n   */\r\n  setCSSProperty(rule, name, value) {\r\n    this.cssRule(rule).style.setProperty(name, value);\r\n  }\r\n\r\n  /**\r\n   * Extract and merge all static properties definition from WebComponent instance\r\n   * @param {GSElement} obj \r\n   * @returns {Object}\r\n   */\r\n  static allProperties(obj) {\r\n    const list = [...GSDOM.inheritance(obj)].map(o => o.properties).filter(o => o);\r\n    list.push(obj.constructor?.properties || obj.properties);\r\n    return GSData.mergeObjects(list);\r\n  }\r\n\r\n  /**\r\n   * Register class as WebComponent to the browser\r\n   * @param {String} name \r\n   * @param {class} clazz Optional, if not set, use self\r\n   * @param {Object} opt Options, used only when extending non HTMLElement class  \r\n   */\r\n  static define(name, clazz, opt) {\r\n    if (!customElements.get(name)) {\r\n      customElements.define(name, clazz || this, opt);\r\n    }\r\n  }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\n\r\nexport class GSAccordionElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    autoclose: { type: Boolean },\r\n    cssItem: { reflect: true, attribute: 'css-item' },\r\n    cssHeader: { reflect: true, attribute: 'css-header' },\r\n    cssBody: { reflect: true, attribute: 'css-body' },\r\n    data: { type: Array }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.data = this.settings;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\"\r\n       @notify=\"${me.#onNotify.bind(me)}\"\r\n       @click=\"${me.#onClick}\" \r\n       @keyup=\"${me.#onKeyUp}\" \r\n       class=\"accordion ${classMap(me.renderClass())}\">\r\n       ${this.#renderItems()}\r\n       <slot></slot></div>`\r\n  }\r\n\r\n  get items() {\r\n    return this.queryAll('gs-accordion-item');\r\n  }\r\n\r\n  get settings() {\r\n    const cfg = this.constructor.properties;\r\n    return GSItem.collect(this).map(el => GSAttr.proxify(el, cfg));\r\n  }\r\n\r\n  close() {\r\n    this.#state(false);\r\n  }\r\n\r\n  open() {\r\n    this.#state(true);\r\n  }\r\n\r\n  onDataRead(data) {\r\n    this.data = data;\r\n  }\r\n\r\n  #renderItems() {\r\n    return this.data.map(o => {\r\n      return html`<gs-accordion-item generated\r\n        .opened=\"${ifDefined(o.disabled === true)}\" \r\n        message=\"${ifDefined(o.message)}\" \r\n        template=\"${ifDefined(o.template)}\" \r\n        title=\"${ifDefined(o.title)}\"></gs-accordion-item>`;\r\n    });\r\n  }\r\n\r\n  #state(val = false) {\r\n    this.items.forEach(el => el.opened = val);\r\n    this.notify();\r\n  }\r\n\r\n  #onNotify(e) {\r\n    const me = this;\r\n    if (me.autoclose && e.target.opened) {\r\n      me.items.filter(el => el != e.target).forEach(el => el.opened = false);\r\n    }\r\n  }\r\n\r\n  #onClick(e) {\r\n    const isItemCloser = e?.composedPath()[0]?.matches('.accordion-button');\r\n    if(isItemCloser) e.target.toggle?.();\r\n  }\r\n\r\n  #onKeyUp(e) {\r\n    switch (e.code) {\r\n      case 'ArrowLeft':\r\n        e.target.close?.();\r\n        break;\r\n      case 'ArrowRight':\r\n        e.target.open?.();\r\n        break;\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-accordion');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { html } from '../lib.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSAccordionItemElement extends GSElement {\r\n\r\n  static properties = {\r\n    cssHeader: { reflect: true, attribute: 'css-header' },\r\n    cssBody: { reflect: true, attribute: 'css-body' },\r\n    message: { reflect: true, },\r\n    title: { reflect: true, },\r\n    opened: { type: Boolean, reflect: true },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  shouldUpdate(changedProperties) {\r\n    return this.owner?.tagName === 'GS-ACCORDION';\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const owner = me.owner;\r\n    const cssHeader = me.cssHeader || owner?.cssHeader;\r\n    const cssBody = me.cssBody || owner?.cssBody;\r\n    return html`<div class=\"accordion-item ${me.css}\">\r\n             <h2 class=\"accordion-header\">\r\n               <button type=\"button\" \r\n                class=\"accordion-button  ${cssHeader} ${me.opened ? '' : 'collapsed'}\"> \r\n                 ${me.translate(me.title)}\r\n               </button>\r\n             </h2>\r\n             <div class=\"accordion-collapse collapse  ${cssBody} ${me.opened ? 'show' : ''}\">\r\n               <div class=\"accordion-body\">\r\n                   ${me.translate(me.message)}\r\n                   ${me.renderTemplate()}\r\n                   <slot></slot>\r\n               </div>\r\n             </div>      \r\n     </div>`\r\n  }\r\n\r\n  open() {\r\n    this.notify(true);\r\n  }\r\n  \r\n  close() {\r\n    this.notify(false);\r\n  }\r\n\r\n  toggle() {\r\n    this.notify(!this.opened);\r\n  }\r\n\r\n  notify(val = false) {\r\n    const me = this;\r\n    me.opened = val;\r\n    super.notify();\r\n  }\r\n\r\n  get owner() {\r\n    return this.closest('gs-accordion') || GSDOM.component(this);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-accordion-item');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, ref, html, ifDefined } from '../lib.mjs';\r\nimport { color } from '../properties/index.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\n\r\nexport class GSAlertElement extends GSElement {\r\n\r\n    static properties = {\r\n        message: { reflect: true },\r\n        color: { ...color },\r\n        closed: { reflect: true, type: Boolean },\r\n        closable: { reflect: true, type: Boolean },\r\n        delay: { reflect: true, type: Number },\r\n    }\r\n\r\n    #ref;\r\n    #pause = false;\r\n    #interval = 0;\r\n    #last = 0;\r\n    #data;\r\n\r\n    constructor() {\r\n        super();\r\n        this.delay = 1;\r\n        this.#ref = createRef();\r\n        this.#data = this.#proxify(this);\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        clearInterval(this.#interval);\r\n        super.disconnectedCallback();\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div role=\"alert\" dir=\"${ifDefined(me.direction)}\" ${ref(me.#ref)} \r\n            @mouseover=\"${() => me.#pause = true}\"\r\n            @mouseout=\"${() => me.#pause = false}\"\r\n            class=\"alert fade ${classMap(me.renderClass())}\" >\r\n            ${me.#first}\r\n            ${me.renderTemplate()}\r\n            <slot></slot>\r\n            ${me.#second}\r\n        </div>`;\r\n    }\r\n\r\n    firstUpdated(changed) {\r\n        this.#handleBillboard();\r\n        super.firstUpdated(changed);\r\n    }\r\n\r\n    updated(changed) {\r\n        if (!changed.has('opened')) return;\r\n        this.#handleBillboard();\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            'show': !me.closed,\r\n            'alert-dismissible': me.closable,\r\n            [`alert-${this.color}`]: me.color,\r\n\r\n        }\r\n        return css;\r\n    }\r\n\r\n    open() {\r\n        this.notify(false);\r\n    }\r\n\r\n    close() {\r\n        this.notify(true);\r\n    }\r\n\r\n    toggle() {\r\n        this.notify(!this.closed);\r\n    }\r\n\r\n    notify(val = false) {\r\n        const me = this;\r\n        me.closed = val;\r\n        if (me.closed) setTimeout(() => { me.#ref.value.classList.toggle('d-none', true) }, 250);\r\n        super.notify();\r\n    }\r\n\r\n    get isBillboard() {\r\n        return this.#data?.length > 0;\r\n    }\r\n\r\n    get #message() {\r\n        return this.translate(this.message);\r\n    }\r\n\r\n    get #first() { return this.rtl ? this.#button : this.#message; };\r\n\r\n    get #second() { return this.rtl ? this.#message : this.#button; };\r\n\r\n    get #button() {\r\n        return this.closable ? html`<button type=\"button\" class=\"btn-close\" aria-label=\"Close\" @click=\"${this.close}\"></button>` : '';\r\n    }\r\n\r\n    /**\r\n     * Proxify GS-ITEM elements to easily read attributes\r\n     */\r\n    #proxify(root) {\r\n        return GSItem.collect(root).map(el => GSAttr.proxify(el, {message:{}}));\r\n    }\r\n\r\n    #handleBillboard() {\r\n        const me = this;\r\n        if (me.closed) {\r\n            clearInterval(me.#interval);\r\n            me.#interval = 0;\r\n        } else {\r\n            me.#billboard();\r\n        }        \r\n    }\r\n\r\n    #billboard() {\r\n        const me = this;\r\n        if (!me.isBillboard) return;\r\n        const items = me.#data;\r\n        if (me.message) {\r\n            me.#last = -1;\r\n        } else {\r\n            me.message = items[0].message;\r\n        }\r\n        me.#interval = setInterval(() => {\r\n            if (me.#pause) return;\r\n            me.#last++;\r\n            if (me.#last >= items.length ) me.#last = 0;\r\n            me.message = items[me.#last].message;\r\n        }, me.delay * 1000);\r\n    }\r\n\r\n    static {\r\n        this.define('gs-alert');\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, ifDefined, html, ref, createRef } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color, size, buttonType, ButtonTypes, SizeTypes } from '../properties/index.mjs';\r\n\r\nexport class GSButtonElement extends GSElement {\r\n\r\n  static properties = {\r\n    type: { ...buttonType }, // reset, submit\r\n    size: { ...size }, // small, large, normal\r\n    color: { ...color },\r\n    clickCss: { attribute : 'click-css'},\r\n    hoverCss: { attribute : 'hover-css'},\r\n    toggleColor: { ...color, attribute : 'toggle-color' },\r\n    autofocus: { type: Boolean },\r\n    disabled: { type: Boolean, reflect: true },\r\n    outline: { type: Boolean, reflect: true },\r\n    active: { type: Boolean, reflect: true },\r\n    toggling: { type: Boolean },\r\n    icon: {},\r\n    title: {},\r\n    tooltip: {},\r\n    text: {}\r\n  };\r\n\r\n  #refEl = createRef();\r\n  #refIco = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    this.type = 'button';\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    if (this.autofocus && !this.disabled) this.focus();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<button part=\"button\" role=\"button\" ${ref(me.#refEl)}\r\n        dir=\"${ifDefined(me.direction)}\"\r\n        type=\"${ifDefined(me.type)}\" \r\n        class=\"btn ${classMap(me.renderClass())}\" \r\n        title=\"${ifDefined(me.#tooltip)}\"\r\n        ?disabled=${me.disabled}\r\n        @mouseover=\"${me.#onMouseOver}\"\r\n        @mouseout=\"${me.#onMouseOut}\"\r\n        @click=\"${me.#onClick}\">\r\n          ${me.#first} ${me.#second}</button>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const size = SizeTypes[me.size];\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'active': me.active,\r\n      'focus-ring': document.activeElement === me,\r\n      [`text-${me.text}`]: me.text,\r\n      [`btn-${size}`]: size,\r\n      [`btn-outline-${me.color}`]: me.outline,\r\n      [`btn-${me.color}`]: !me.outline && me.color,\r\n      [`btn-${me.toggleColor}`]: me.active && me.toggleColor,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  click() {\r\n    this.#refEl.value?.click();\r\n  }\r\n\r\n  focus() {\r\n    requestAnimationFrame(() => this.#refEl.value?.focus());\r\n  }\r\n\r\n  toggle() {\r\n    this.active = !this.active;\r\n  }\r\n\r\n  #onClick(e) {\r\n    const me = this;\r\n    if(me.toggling) me.toggle();\r\n    me.iconEl?.animate();\r\n    if (me.isReset) return me.form?.reset();\r\n    if (me.isSubmit) return me.form?.submit();\r\n    me.notify();\r\n  }\r\n\r\n  #onMouseOver() {\r\n    this.iconEl?.hover(true);\r\n  }\r\n\r\n  #onMouseOut() {\r\n    this.iconEl?.hover(false);\r\n  }\r\n\r\n  get isReset() {\r\n    return ButtonTypes.isReest(this.type);\r\n  }\r\n\r\n  get isSubmit() {\r\n    return ButtonTypes.isSubmit(this.type);\r\n  }\r\n\r\n  get iconEl() {\r\n    return this.#refIco.value;\r\n  }\r\n\r\n  get form() {\r\n    return this.closest('gs-form, form');\r\n  }\r\n\r\n  get #title() {\r\n    return this.translate(this.title);\r\n  }\r\n\r\n  get #tooltip() {\r\n    return this.translate(this.tooltip);\r\n  }\r\n\r\n  get #first() { return this.rtl ? this.#title : this.#iconHtml; };\r\n\r\n  get #second() { return this.rtl ? this.#iconHtml : this.#title; };\r\n\r\n  get #iconHtml() { return this.icon ? this.#renderIcon : html`<slot name=\"icon\"></slot>`; }\r\n\r\n  get #renderIcon() {\r\n    return  html`\r\n    <gs-icon ${ref(this.#refIco)} \r\n    name=\"${this.icon}\" \r\n    click-css=\"${ifDefined(this.clickCss)}\" \r\n    hover-css=\"${ifDefined(this.hoverCss)}\" \r\n    data-delay=\"1\"></gs-icon>`;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-button');\r\n  }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { unsafeHTML, classMap, html, ifDefined, css } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSDate } from '../base/GSDate.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { notEmpty, numGE0 } from '../properties/index.mjs';\r\n\r\nexport class GSCalendarElement extends GSElement {\r\n\r\n  static style = css`.year::-webkit-outer-spin-button,.year::-webkit-inner-spin-button {-webkit-appearance: none;margin: 0;} .year {-moz-appearance: textfield;} .day:focus{font-weight: bold;}`\r\n\r\n  static properties = {\r\n    date: {},\r\n    target: {},\r\n    format: { hasChanged: notEmpty },\r\n    year: { type: Number },\r\n    month: { type: Number, hasChanged: numGE0 },\r\n    day: { type: Number, hasChanged: numGE0 },\r\n    arrovPrev: { attribute: 'arrow-prev' },\r\n    arrowNext: { attribute: 'arrow-next' },\r\n    cssDays: { attribute: 'css-days' },\r\n    cssToday: { attribute: 'css-today' },\r\n    cssWeeks: { attribute: 'css-weeks' },\r\n    cssMonth: { attribute: 'css-month' },\r\n    cssYear: { attribute: 'css-year' },\r\n    cssNav: { attribute: 'css-nav' },\r\n    cssHeader: { attribute: 'css-header' },\r\n    cssSelected: { attribute: 'css-selected' },\r\n    minYear: { attribute: 'year-min', type: Number },\r\n    maxYear: { attribute: 'year-max', type: Number },\r\n  }\r\n\r\n  #date;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.#date = new GSDate();\r\n    me.#date.locale = GSUtil.locale;\r\n    me.locale = GSUtil.locale;\r\n    me.day = me.#date.day;\r\n    me.month = me.#date.month;\r\n    me.year = me.#date.year;\r\n    me.minYear = 1900;\r\n    me.maxYear = 2100;\r\n    me.arrowPrev = '&#10094;';\r\n    me.arrowNext = '&#10095;';\r\n    me.cssNav = 'btn-light';\r\n    me.cssToday = 'btn-secondary';\r\n    me.cssSelected = 'btn-primary';\r\n    me.cssWeeks = 'fw-bold text-bg-dark';\r\n    me.cssYear = 'form-control fs-5 fw-bold border-0 text-center m-1 p-0';\r\n    me.cssMonth = 'form-control fs-3 fw-bold border-0 text-center m-1 p-0';\r\n  }\r\n\r\n  get date() {\r\n    const me = this;\r\n    //return this.#date.toISOString();\r\n    return new Proxy(this.#date, {\r\n      set(target, prop, value) {\r\n        if (typeof target[prop] != 'function') {\r\n          target[prop] = value;\r\n          me.#update();\r\n        }\r\n        return true;\r\n      },\r\n      get(target, prop, receiver) {\r\n        const value = target[prop];\r\n        if (value instanceof Function) {\r\n          return function (...args) {\r\n            try {\r\n              return value.apply(this === receiver ? target : this, args);\r\n            } finally {\r\n              me.#update();\r\n            }\r\n          };\r\n        }\r\n        return value;\r\n      }\r\n    });\r\n  }\r\n\r\n  previousMonth() {\r\n    const me  =this;\r\n    if (me.month == 0) {\r\n      me.month = 11;\r\n      me.year--;\r\n    } else {\r\n      me.month--;\r\n    }\r\n  }\r\n\r\n  nextMonth() {\r\n    const me  =this;\r\n    if (me.month == 11) {\r\n      me.month = 0;\r\n      me.year++;\r\n    } else {\r\n      me.month++;\r\n    } \r\n  }\r\n\r\n  previousYear() {\r\n    this.year--;\r\n  }\r\n\r\n  nextYear() {\r\n    this.year++;\r\n  }\r\n\r\n  formatted(date) {\r\n    const me = this;\r\n    return (date || me.#date).format(me.format, me.locale);\r\n  }\r\n\r\n  updated() {\r\n    const me = this;\r\n    const date = new GSDate(me.#date);\r\n    me.#updateTarget(date);\r\n    me.emit('date', { type: 'calendar', date: date, val: me.formatted(date) }, true, true);\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    me.#date.year = me.year;\r\n    me.#date.month = me.month;\r\n    me.#date.day = me.day;\r\n    me.#date.locale = me.locale;\r\n\r\n    const week = GSDate.dayList(true, me.locale).map(v => html`<div class=\"col\">${v}</div>`);\r\n    const months = me.#monthsHTML();\r\n    const year = me.#yearHTML();\r\n\r\n    return html`\r\n          <div class=\"container-fluid text-center ${classMap(me.renderClass())}\"\r\n          dir=\"${ifDefined(me.direction)}\"\r\n          @keydown=\"${me.#onKey}\"\r\n          @click=\"${me.#onDay}\">\r\n          <div class=\"row align-items-center ${me.cssHeader} header\">\r\n              <div class=\"col-auto\">\r\n                  <a href=\"#\" @click=\"${me.previousMonth}\" class=\"btn ${me.cssNav} arrow prev\">${unsafeHTML(me.arrowPrev)}</a>\r\n              </div>\r\n              <div class=\"col\"></div>\r\n              <div class=\"col-auto\">\r\n                  ${months}\r\n                  ${year}\r\n              </div>\r\n              <div class=\"col\"></div>\r\n              <div class=\"col-auto\">\r\n                  <a href=\"#\" @click=\"${me.nextMonth}\" class=\"btn ${me.cssNav} arrow next\">${unsafeHTML(me.arrowNext)}</a>\r\n              </div>\r\n          </div>\r\n          <div class=\"row weeks ${me.cssWeeks}\">${week}</div>\r\n          ${unsafeHTML(me.#daysHTML())}\r\n      </div>`;\r\n  }\r\n\r\n  #updateTarget(date) {\r\n    const me = this;\r\n    if (!me.target) return;\r\n    const tgt = GSDOM.query(document.documentElement, me.target);\r\n    if (!tgt) return;\r\n\r\n    if (tgt instanceof HTMLInputElement) {\r\n      if (tgt.type === 'date') return tgt.valueAsDate = date;\r\n      return tgt.value = me.formatted(date);\r\n    }\r\n    GSDOM.setHTML(tgt, me.formatted(date));\r\n  }\r\n\r\n  #update() {\r\n    const me = this;\r\n    me.day = me.#date.day;\r\n    me.month = me.#date.month;\r\n    me.year = me.#date.year;\r\n    me.locale = me.#date.locale;\r\n  }\r\n\r\n  #isToday(v, date) {\r\n    const me = this;\r\n    return v && GSUtil.asNum(v) === date.day && date.month === me.#date.month && me.#date.year === date.year;\r\n  }\r\n\r\n  #daysHTML() {\r\n    const me = this;\r\n    const today = new GSDate();\r\n    today.locale = me.locale;\r\n    const list = me.#date.build(me.locale);\r\n    const result = list\r\n      .map(v => {\r\n        const c1 = me.#isToday(v, today) ? me.cssToday : '';\r\n        const c2 = me.#isToday(v, me.#date) ? me.cssSelected : '';\r\n\r\n        const d = v ? `<a tabindex=\"0\" href=\"#\" class=\"btn shadow-none ${c1} ${c2} day\" data-day=\"${v}\">${v}</a>` : ''\r\n        return `<div class=\"col p-0\">${d}</div>`;\r\n      })\r\n      .map((v, i) => {\r\n        if (i === 0) return `<div class=\"row days\">${v}`;\r\n        const isBreak = i % 7 == 0;\r\n        return isBreak ? `</div><div class=\"row days\">${v}` : v;\r\n      });\r\n    result.push('</div>');\r\n    return result.join('');\r\n  }\r\n\r\n\r\n  #monthsHTML() {\r\n    const me = this;\r\n    const current = me.#date.MMMM;\r\n    const months = GSDate.monthList(false, me.locale);\r\n    const list = months.map((v, i) => html`<option value=\"${i}\" selected=${ifDefined(current == v ? true : undefined)}>${v}</option>`);\r\n    //const list = GSDate.monthList(false, me.locale).map((v, i) => html`<option value=\"${i}\" ${current == v ? 'selected' : ''}>${v}</option>`);\r\n    return html`<select @change=\"${me.#onMonth}\" name=\"month\" class=\"month ${me.cssMonth}\" value=\"${months.indexOf(current)}\">${list}</select>`;\r\n  }\r\n\r\n  #yearHTML() {\r\n    const me = this;\r\n    return html`<input @change=\"${me.#onYear}\" name=\"year\" class=\"year ${me.cssYear}\" value=\"${me.#date.getFullYear()}\" type=\"number\" min=\"${me.minYear}\" max=\"${me.maxYear}\">`;\r\n  }\r\n\r\n  #onDay(e) {\r\n    GSEvents.prevent(e);\r\n    if (!e.target.classList.contains('day')) return;\r\n    this.day = GSUtil.asNum(e.target.dataset.day, this.day);\r\n  }\r\n\r\n  #onMonth(e) {\r\n    this.month = e.target.selectedIndex;\r\n  }\r\n\r\n  #onYear(e) {\r\n    this.year = e.target.value;\r\n  }\r\n\r\n  #onKey(e) {\r\n    console.log(e);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-calendar');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, css, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { placement, PlacementTypes } from '../properties/placement.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\nexport class GSCardElement extends GSElement {\r\n\r\n  static styles = css`.card-header, .card-footer{ background-color: inherit; color: inherit;}`;\r\n\r\n  static properties = {\r\n\r\n    imageStyle: { type: Object, attribute: 'image-style', reflect : true },\r\n\r\n    overlay: { type: Boolean },\r\n    placement: { ...placement },\r\n    align: { ...placement },\r\n\r\n    image: {},\r\n    title: {},\r\n    subtitle: {},\r\n    text: {},\r\n    footer: {},\r\n    header: {},\r\n\r\n    colorText: { attribute: 'color-text' },\r\n    colorBack: { attribute: 'color-back' },\r\n    colorBorder: { attribute: 'color-border' },\r\n\r\n    cssTitle: { attribute: 'css-title' },\r\n    cssSubtitle: { attribute: 'css-subtitle' },\r\n    cssText: { attribute: 'css-text' },\r\n    cssFooter: { attribute: 'css-footer' },\r\n    cssHeader: { attribute: 'css-header' },\r\n    cssBody: { attribute: 'css-body' },\r\n    cssImage: { attribute: 'css-image' },\r\n\r\n  }\r\n\r\n  #styleID = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    this.border = false;\r\n    this.shadow = false;\r\n    this.align = 'start';\r\n    this.placement = 'top';\r\n    this.imageStyle = this.imageStyle || {};\r\n    this.dynamicStyle(this.#styleID);\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const content =  me.isVertical ? me.#renderVertical() : me.#renderHorizontal();\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\" class=\"card ${classMap(me.renderClass())}\">${content}</div>`;\r\n  }\r\n\r\n  #renderVertical() {\r\n    const me = this;\r\n    return [me.#imageTop, me.#header, me.#body, me.#footer, me.#imageBottom];\r\n  }\r\n\r\n  #renderHorizontal() {\r\n    const me = this;\r\n    const start = PlacementTypes.isBefore(me.placement);\r\n    const startClass = start ? 'col-4' : 'col-8';\r\n    const endClass = start ? 'col-8' : 'col-4';\r\n    const startHtml = start ? me.#images : me.#body;\r\n    const endHtml =  start ? me.#body : me.#images;\r\n    return html`<div class=\"row g-0\">\r\n        <div class=\"${startClass}\">\r\n            ${startHtml}\r\n        </div>\r\n        <div class=\"${endClass}\">\r\n          ${endHtml}\r\n        </div>\r\n      </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      border: me.border || me.colorBorder,\r\n      [`text-${me.align}`]: me.align,\r\n      [`text-${me.colorText}`]: me.colorText,\r\n      [`bg-${me.colorBack}`]: me.colorBack,\r\n      [`border-${me.colorBorder}`]: me.colorBorder,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  get isVertical() {\r\n    return PlacementTypes.isVertical(this.placement);\r\n  }\r\n\r\n  get isHorizontal() {\r\n    return PlacementTypes.isHorizontal(this.placement);\r\n  }\r\n\r\n  get #body() {\r\n    const me = this;\r\n    return html`<div class=\"${me.overlay ? 'card-img-overlay' : 'card-body'} ${me.cssBody}\">\r\n      <h5 class=\"card-title  ${me.cssTitle}\"><slot name=\"title\">${me.translate(me.title)}</slot></h5>\r\n      <h6 class=\"card-subtitle  ${me.cssSubtitle}\"><slot name=\"subtitle\">${me.translate(me.subtitle)}</slot></h6>\r\n      <p class=\"card-text ${me.cssText}\"><slot name=\"text\">${me.translate(me.text)}</slot></p>\r\n      <slot name=\"body\"></slot>\r\n    </div>    \r\n    `;\r\n  }\r\n\r\n  get #header() {\r\n    return this.overlay ? '' : html`<div class=\"card-header  ${this.cssHeader}\"><slot name=\"header\">${this.header}</slot></div>`;\r\n  }\r\n\r\n  get #footer() {\r\n    return this.overlay ? '' : html`<div class=\"card-footer ${this.cssFooter}\"><slot name=\"footer\">${this.footer}</slot></div>`;\r\n  }\r\n\r\n  get #imageSlot() {\r\n    return html`<slot name=\"image\"></slot>`;\r\n  }\r\n\r\n  get #image() {\r\n    const me = this;\r\n    const css = me.isHorizontal ? 'img-fluid' : 'card-img';\r\n    me.dynamicStyle(me.#styleID, me.imageStyle);\r\n    return html`<img src=\"${me.image}\" class=\"rounded-${me.placement} ${css} ${me.cssImage} ${me.#styleID}\" alt=\"...\">`;\r\n  }\r\n\r\n  get #images() {\r\n    return this.image ? this.#image : this.#imageSlot;\r\n  }\r\n\r\n  get #imageTop() {\r\n    return this.placement === 'top' ? this.#images : '';\r\n  }\r\n\r\n  get #imageBottom() {\r\n    return this.placement === 'bottom' ? this.#images : '';\r\n  }\r\n\r\n  static {\r\n    this.define('gs-card');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSCenterElement extends GSElement {\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\"\r\n      class=\"position-absolute top-50 start-50 translate-middle ${classMap(me.renderClass())}\">\r\n    ${me.renderTemplate()}<slot></slot></div>`;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-center');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSMenuElement class\r\n * @module components/GSMenuElement\r\n */\r\n\r\nimport { classMap, ifDefined, html, ref, createRef } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { dataset } from '../directives/dataset.mjs';\r\n\r\n/**\r\n * Renderer for panel layout \r\n * @class\r\n * @extends {Component}\r\n */\r\nexport class GSMenuElement extends GSElement {\r\n\r\n    static properties = {\r\n        storage: {},\r\n        auto: { type: Boolean, reflect: true },\r\n        opened: { type: Boolean, reflect: true },\r\n        dark: { type: Boolean },\r\n        reverse: { type: Boolean },\r\n        data: { type: Array },\r\n    }\r\n\r\n    // GS-ITEM attributes mapping\r\n    static options = {\r\n        name: {},\r\n        title: {},\r\n        header: {},\r\n        color: {},\r\n        icon: {},\r\n        url: { default: '#' }\r\n    }\r\n\r\n    #menuRef = createRef();\r\n    #styleID = GSID.id;\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;\r\n        me.dynamicStyle(me.#styleID);\r\n        me.data = me.#proxify(me);\r\n    }\r\n\r\n    willUpdate(changed) {\r\n        super.willUpdate(changed);\r\n        if (changed.has('opened') && !this.opened) {\r\n            this.#closeSubmenus();\r\n        }\r\n    }\r\n\r\n    updated() {\r\n        this.#updatePosition();\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<ul \r\n            ${ref(me.#menuRef)}\r\n            dir=\"${ifDefined(me.direction)}\"\r\n            class=\"dropdown-menu ${classMap(me.renderClass())}\"\r\n            data-gs-class=\"${me.#styleID}\"\r\n            data-menu=\"true\"\r\n            @mouseover=\"${me.#onMouseOver}\"\r\n            @mouseleave=\"${me.#onMouseLeave}\"\r\n            @keydown=\"${me.#onKeyDown}\"\r\n            @click=\"${me.#onClick}\">\r\n            ${me.#items(me.data)}\r\n        </ul>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            'submenu': me.dataset.submenu,\r\n            'dropdown-menu-dark': me.dark,\r\n            [me.#styleID]: true,\r\n            'show': me.opened,\r\n            'dropend': !me.reverse,\r\n            'dropstart': me.reverse,\r\n        }\r\n        return css;\r\n    }\r\n\r\n    close() {\r\n        this.opened = false;\r\n    }\r\n\r\n    open() {\r\n        this.opened = true;\r\n    }\r\n\r\n    toggle() {\r\n        this.opened = !this.opened;\r\n    }\r\n\r\n    /**\r\n     * Show at x/y position on the screen\r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @param {HTMLElement} caller\r\n     * @returns {void}\r\n     */\r\n    popup(x = 0, y = 0, caller) {\r\n\r\n        const me = this;\r\n        let target = caller;\r\n\r\n        if (GSEvents.isMouseOrPointerEvent(x)) {\r\n            const e = x;\r\n            target = e.target;\r\n            y = e.clientY;\r\n            x = e.clientX;\r\n            let offset = GSDOM.offsetParent(me);\r\n            offset = offset ? offset.getBoundingClientRect() : null;\r\n            x = x - (offset?.left || 0);\r\n            y = y - (offset?.top || 0);\r\n        }\r\n\r\n        const cfg = { clientX: x, clientY: y, target: target };\r\n\r\n        requestAnimationFrame(() => {\r\n            const style = {\r\n                position: 'fixed',\r\n                top: '0px',\r\n                left: '0px',\r\n                translate: `${cfg.clientX}px ${cfg.clientY}px`\r\n            };\r\n            const rule = me.dynamicStyle(me.#styleID);\r\n            Object.assign(rule.style, style);\r\n        });\r\n        me.open();\r\n\r\n    }\r\n\r\n    onDataRead(data) {\r\n        this.data = data;\r\n    }\r\n\r\n    #items(root) {\r\n        const me = this;\r\n        return root.map(el => me.#item(el));\r\n    }\r\n\r\n    #item(el) {\r\n        const me = this;\r\n        const isSub = el.items?.length > 0;\r\n        if (isSub) return me.#renderSubmenu(el);\r\n        if (!(el.header || el.name)) return me.#renderDivider();\r\n        return el.header ? me.#renderHeader(el) : me.#renderMenu(el);\r\n    }\r\n\r\n    #renderHeader(el) {\r\n        return html`<li data-inert=\"true\"><h6 class=\"dropdown-header\">${this.#renderIcon(el)}${el.header}</h6></li>`;\r\n    }\r\n\r\n    #renderDivider() {\r\n        return html`<li data-inert=\"true\"><hr class=\"dropdown-divider\"></li>`;\r\n    }\r\n\r\n    #renderSubmenu(el) {\r\n        const me = this;\r\n        return html`<li>\r\n            <a class=\"dropdown-item dropdown-toggle\" data-toggle=\"true\" href=\"#\">\r\n                <div class=\"d-inline-block w-100\">${me.#renderIcon(el)}${el.name}</div>\r\n            </a>\r\n            <gs-menu auto \r\n                .data=${el.items} \r\n                ?dark=${me.dark} \r\n                ?reverse=\"${me.reverse}\" \r\n                locale=\"${ifDefined(me.locale)}\" \r\n                data-submenu=\"true\">\r\n            </gs-menu>\r\n        </li>`;\r\n    }\r\n\r\n    #renderIcon(el) {\r\n        return el.icon ? html`<gs-icon css=\"mx-1\" name=\"${el.icon}\"></gs-icon>` : '';\r\n    }\r\n\r\n    #renderMenu(el) {\r\n        return html`<li>\r\n                <gs-button css=\"dropdown-item shadow-none\" \r\n                    ${dataset(el, false)}\r\n                    url=\"${el.url}\"\r\n                    title=\"${el.name}\" \r\n                    locale=\"${ifDefined(this.locale)}\" \r\n                    icon=\"${ifDefined(el.icon)}\" \r\n                    text=\"${ifDefined(el.color)}\"\r\n                    data-gs-target=\"${ifDefined(el.target || 'self')}\"\r\n                    data-gs-action=\"${ifDefined(el.action)}\">\r\n                </gs-button></li>`;\r\n    }\r\n\r\n    /**\r\n     * Proxify GS-ITEM elements to easily read attributes\r\n     */\r\n    #proxify(root) {\r\n        return GSItem.collect(root).map(el => GSAttr.proxify(el, GSMenuElement.options));\r\n    }\r\n\r\n    #closeSubmenus(menu) {\r\n        GSDOM.queryAll(this.renderRoot, 'gs-menu', false, false)\r\n            .filter(el => el != menu)\r\n            .forEach(el => el.close());\r\n    }\r\n\r\n    #onKeyDown(e) {\r\n        const me = this;\r\n        switch (e.key) {\r\n            case 'Escape':\r\n                me.close();\r\n                break;\r\n        }\r\n    }\r\n\r\n    #onClick(e) {\r\n        GSEvents.prevent(e);\r\n        const me = this;\r\n        const submenu = me.#toSubmenu(e);\r\n        submenu?.close();\r\n        if (me.auto) me.close();\r\n    }\r\n\r\n    #onMouseLeave(e) {\r\n        GSEvents.prevent(e);\r\n        if (this.auto) this.close();\r\n    }\r\n\r\n    #onMouseOver(e) {\r\n        GSEvents.prevent(e);\r\n        const me = this;\r\n        const submenu = me.#toSubmenu(e);\r\n        me.#closeSubmenus(submenu);\r\n        submenu?.open();\r\n    }\r\n\r\n    #toSubmenu(e) {\r\n        const menuItem = e.target.closest('li');\r\n        return menuItem?.querySelector('gs-menu');\r\n    }\r\n\r\n    #updatePosition() {\r\n        const me = this;\r\n        if (!me.opened) return;\r\n        const rule = me.dynamicStyle(me.#styleID);\r\n        if (me.isSubmenu) {\r\n            const opt = { translate: `0px -25px` };\r\n            if (me.reverse) {\r\n                opt.left = 'inherited';\r\n                opt.right = '100%';\r\n            } else {\r\n                opt.right = 'inherited';\r\n                opt.left = '100%';\r\n            }\r\n            Object.assign(rule.style, opt);\r\n        } else {\r\n            rule.style.translate = null;\r\n            const rect = me.#menu.getBoundingClientRect();\r\n            const offset = window.innerWidth - rect.right;\r\n            me.reverse = offset - 5 < 0;\r\n            if (me.reverse) rule.style.translate = `${offset - 2}px`;\r\n        }\r\n    }\r\n\r\n    get isSubmenu() {\r\n        return this.dataset.submenu;\r\n    }\r\n\r\n    get #menu() {\r\n        return this.#menuRef.value;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-menu');\r\n    }\r\n}\r\n","/*GSContextElement\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSContextElement class\r\n * @module components/GSContextElement\r\n */\r\n\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSMenuElement } from './Menu.mjs';\r\n\r\n/**\r\n * Renderer for panel layout \r\n * @class\r\n * @extends {GSMenuElement}\r\n */\r\nexport class GSContextElement extends GSMenuElement {\r\n\r\n    static properties = {\r\n        target: {},\r\n        filter: {},\r\n        altContext: { type: Boolean },\r\n        disabled: { type: Boolean },\r\n    }\r\n\r\n    constructor() {\r\n        super();        \r\n        this.auto = true;\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        const me = this;\r\n        me.attachEvent(window, 'resize', me.close.bind(me));        \r\n        if (!me.slot) me.#attachTarget();\r\n    }\r\n    \r\n    onSlotInjected(slot) {\r\n        this.#attachTarget();\r\n    }\r\n\r\n    #attachTarget() {\r\n        const me = this;        \r\n        const owner = GSDOM.parent(me.assignedSlot || me);\r\n        let targets = me.target ? GSDOM.queryAll(owner, me.target) : [owner];\r\n        if (!targets.length) targets = GSDOM.queryAll(document.documentElement, me.target);\r\n        targets.forEach(target => me.attachEvent(target, 'contextmenu', me.#onPopup.bind(me)));\r\n    }\r\n\r\n    #match(e) {\r\n        const me = this;\r\n        return e.composedPath().filter(el => el.matches)\r\n            .filter(el => el.matches(me.target || me.filter));\r\n    }\r\n\r\n    #onPopup(e) {\r\n        const me = this;\r\n        if (e.shiftKey && me.altContext) return;\r\n        const list = me.#match(e);\r\n        if (list.length === 0) return;\r\n        GSEvents.prevent(e);\r\n        me.popup(e);\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Show submenu at x/y position on the screen\r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @returns {void}\r\n     */\r\n    popup(x = 0, y = 0, caller) {\r\n        return this.disabled ? false : super.popup(x, y, caller);\r\n    }\r\n\r\n    static {\r\n        this.define('gs-context');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, css, html, ifDefined, ref } from '../lib.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color, notEmpty } from '../properties/index.mjs';\r\nimport { ElementMoveController } from '../controllers/ElementMoveController.mjs';\r\n\r\nexport class GSCompareElement extends GSElement {\r\n\r\n  static styles = css`.slider {\r\n         --gs-position : 50%;\r\n          left : var(--gs-position);\r\n          width: 8px;\r\n          height: 100%;\r\n          border-width: 1px;\r\n          cursor: w-resize;\r\n          border-color: darkgray;\r\n          border-style: solid;\r\n          background-color: lightgray;\r\n      }\r\n      .clipper {\r\n        --gs-position : 50%;\r\n        clip-path: inset(0px var(--gs-position) 0px 0px);\r\n      }\r\n    `;\r\n\r\n  static properties = {\r\n    background: { ...color },\r\n    width: { type: Number },\r\n    height: { type: Number },\r\n    before: { hasChanged: notEmpty },\r\n    after: { hasChanged: notEmpty },\r\n  }\r\n\r\n  #styleID = GSID.id;\r\n\r\n  #elRef = createRef();\r\n  #clipRef = createRef();\r\n  #slideRef = createRef();\r\n\r\n  #mouseController;\r\n  #elPosition;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.width = 0;\r\n    me.height = 0;\r\n    me.dynamicStyle(me.#styleID);\r\n    me.#mouseController = new ElementMoveController(me);\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    this.#mouseController.attach(this.#splitter);\r\n    super.firstUpdated(changed);\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    const me = this;\r\n    const dynamic = me.#dynamic;\r\n    dynamic.width = me.width > 0 ? `${me.width}px` : '';\r\n    dynamic.height = me.height > 0 ? `${me.height}px` : '';\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div ${ref(me.#elRef)} \r\n         dir=\"${ifDefined(me.direction)}\"\r\n         @loaded=\"${me.#onLoad}\" \r\n         @dblclick=\"${me.#onDoubleClick}\"\r\n         data-gs-class=\"${me.#styleID}\"\r\n         class=\"${classMap(me.renderClass())}\">\r\n      <div class=\"overflow-hidden position-absolute top-0 start-0 overflow-hidden\"><slot name=\"before\">${me.#before}</slot></div>\r\n      <div ${ref(me.#clipRef)} class=\"overflow-hidden position-absolute top-0 start-0 overflow-hidden clipper\"><slot name=\"after\">${me.#after}</slot></div>\r\n      <div ${ref(me.#slideRef)} class=\"slider position-absolute top-0><slot name=\"control\"></slot></div>\r\n    </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      \"position-relative\": true,\r\n      \"user-select-none\": true,\r\n      \"d-contents\": me.isAuto,\r\n      \"h-100\": me.isAuto,\r\n      \"w-100\": me.isAuto,\r\n      \"overflow-hidden\": true,\r\n      [`bg-${me.background}`]: me.background,\r\n      [`${me.#styleID}`]: true\r\n    }\r\n    return css;\r\n  }\r\n\r\n  /**\r\n   * Handles resizing based on mouse move event\r\n   * @param {MouseEvent} e \r\n   */\r\n  onStartMove(e) {\r\n    this.#elPosition = this.#splitter.getBoundingClientRect();\r\n  }\r\n\r\n  onMouseMove(e) {\r\n    const me = this;\r\n    const offset = me.#elPosition.left;\r\n    const width = me.#elPosition.width;\r\n    const pos = GSUtil.range(e.clientX - offset, 0, width);\r\n    const pct = (pos / width) * 100;\r\n    me.#update(pct);\r\n  }\r\n\r\n  get isAuto() {\r\n    return this.width == 0 || this.height == 0;\r\n  }\r\n\r\n  get isFixed() {\r\n    return !this.isAuto;\r\n  }\r\n\r\n  get #dynamic() {\r\n    return this.dynamicStyle(this.#styleID).style;\r\n  }\r\n\r\n  get #before() {\r\n    return this.before ? html`<img @load=\"${this.#onLoad}\" src=\"${me.before}\"></img>` : '';\r\n  }\r\n\r\n  get #after() {\r\n    return this.after ? html`<img @load=\"${this.#onLoad}\" src=\"${me.after}\"></img>` : '';\r\n  }\r\n\r\n  get #isAuto() {\r\n    return this.width === 0 || this.height === 0;\r\n  }\r\n\r\n  get #splitter() {\r\n    return this.#elRef.value;\r\n  }\r\n\r\n  get #slider() {\r\n    return this.#slideRef.value;\r\n  }\r\n\r\n  get #clip() {\r\n    return this.#clipRef.value;\r\n  }\r\n\r\n  #onLoad(e) {\r\n    const me = this;\r\n    if (me.#isAuto) {\r\n      const el = e.target;\r\n      me.height = me.height || el.height;\r\n      me.width = me.width || el.width;\r\n    }\r\n  }\r\n\r\n  #onDoubleClick(e) {\r\n    const me = this;\r\n    me.prevent(e);\r\n    me.#update();\r\n    me.#mouseController.reset();\r\n  }\r\n\r\n  #update(pct = 50) {\r\n    const me = this;\r\n    me.#clip.style.setProperty('--gs-position', `${100 - pct}%`);\r\n    me.#slider.style.setProperty('--gs-position', `${pct}%`);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-compare');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\n\r\n/**\r\n * Helper component to enable controller attachment to the GS WebComponent.\r\n * It is used to simplify and separate templates from logic.\r\n */\r\nexport class GSControllerElement extends GSElement {\r\n\r\n  static properties = {\r\n    module: {},\r\n    controller: {},\r\n  }\r\n\r\n  #clazz = false;\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  updated(changes) {\r\n    super.updated(changes);\r\n    const me = this;\r\n    if (me.isConnected && me.isValid) {\r\n      me.#initialize();\r\n    }\r\n  }\r\n\r\n  get isValid() {\r\n    return this.parentElement instanceof GSElement;\r\n  }\r\n\r\n  async #initialize() {\r\n\r\n    const me = this;\r\n    const host = me.parentElement;\r\n\r\n    if (me.#clazz) return;\r\n\r\n    let clazz = globalThis[me.controller];\r\n    if (!clazz && me.module) {\r\n      const url = GSLoader.normalizeURL(me.module);\r\n      const module = await import(url);\r\n      clazz = module[me.controller];\r\n    }\r\n\r\n    if (clazz) {\r\n      new clazz(host);\r\n      me.#clazz = clazz;\r\n      globalThis[me.controller] = clazz;\r\n    }\r\n\r\n  }\r\n\r\n  static {\r\n    this.define('gs-controller');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\nexport class GSCopyrightElement extends GSElement {\r\n\r\n  static properties = {\r\n    year: { reflect: true, type: Number },\r\n    company: { reflect: true },\r\n    url: { reflect: true },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.flat = true;\r\n    this.css = 'fixed-bottom d-flex justify-content-center align-items-center mt-1 p-2 text-muted';\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    if (!(me.isCompany && me.isYear)) return '';\r\n    const year = new Date().getFullYear();\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\" class=\"${classMap(me.renderClass())}\"><a target=\"_blank\" href=\"${me.url ? me.url : '#'}\"><small>&copy; ${me.company} ${me.year}. - ${year}.</small></a></div>`;\r\n  }\r\n\r\n  get isCompany() {\r\n    return GSUtil.isStringNonEmpty(this.company);\r\n  }\r\n\r\n  get isYear() {\r\n    return GSUtil.isStringNonEmpty(this.year);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-copyright');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSLog } from '../base/GSLog.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSFunction } from '../base/GSFunction.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { numGT0 } from '../properties/verificator.mjs';\r\nimport { GSReadWriteRegistry } from '../data/ReadWriteRegistry.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSData } from '../base/GSData.mjs';\r\n\r\n/**\r\n * A module loading GSDataHandler class\r\n * @module components/GSDataHandler\r\n */\r\n\r\n/**\r\n * GUI element for easier access to the GSReadWrite/GSTreeReader\r\n * @class\r\n * @extends {GSElement}\r\n */\r\nexport class GSDataHandler extends GSElement {\r\n\r\n    static properties = {\r\n        storage: { state: true },\r\n        src: { reflect: true },\r\n        action: { reflect: true },\r\n        mode: { reflect: true },\r\n        reader: { reflect: true },\r\n        writer: { reflect: true },\r\n        limit: { type: Number, reflect: true },\r\n        skip: { type: Number, reflect: true },\r\n        filter: { type: Array, reflect: true },\r\n        sort: { type: Array, reflect: true },\r\n        type: {},\r\n        autoload: { type: Boolean },\r\n        autorefresh: { type: Number, reflect: true, hasChanged: numGT0 },\r\n    }\r\n\r\n    #iid = 0;\r\n    #config = null;\r\n    #handler = null;\r\n    #lifoReadRef = null;\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;\r\n        if (!me.id) throw new Error('Element ID is required attribute!');\r\n        GSItem.validate(me, me.tagName);\r\n        me.autorefresh = 0;\r\n        me.autoload = false;\r\n        me.flat = true;\r\n        me.filter = [];\r\n        me.sort = [];\r\n        me.limit = 0;\r\n        me.skip = 0;\r\n        me.type = 'remote';\r\n        me.mode = 'query';\r\n        me.reader = 'GET';\r\n        me.writer = 'POST';\r\n        me.storage = me.id;\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        const me = this;\r\n        me.#initLIFO();\r\n        me.#config = GSItem.proxify(me, GSData.PROPERTIES);\r\n        me.#handler = GSReadWriteRegistry.newHandler(me.type, me.id, false);\r\n        if (me.#config?.length > 0) me.#handler?.addProcessor(me);\r\n        me.#handler?.enable();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        super.disconnectedCallback();\r\n        this.#handler?.disable();\r\n        this.#handler?.removeProcessor(this);\r\n        this.#lifoReadRef = null;\r\n        clearTimeout(this.#iid);\r\n    }\r\n\r\n    firstUpdated() {\r\n        this.dataController?.read();\r\n    }\r\n\r\n    willUpdate(changed) {\r\n        super.willUpdate(changed);\r\n        const me = this;\r\n        me.#updateHandler();\r\n        if (changed.has('autorefresh')) me.schedule(me.autorefresh);\r\n    }\r\n\r\n    #updateHandler() {\r\n        const me = this;\r\n        if (!me.#handler) return;\r\n\r\n        me.#handler.src = me.src;\r\n        me.#handler.mode = me.mode;\r\n        me.#handler.action = me.action;\r\n        me.#handler.reader = me.reader;\r\n        me.#handler.writer = me.writer;\r\n\r\n        me.#handler.limit = me.limit;\r\n        me.#handler.skip = me.skip;\r\n        me.#handler.sort = me.formatSort(me.sort);\r\n        me.#handler.filter = me.formatFilter(me.filter);\r\n        if (me.autoload) me.read();\r\n    }\r\n\r\n    get isDebug() {\r\n        return this.dataset.gsDebug;\r\n    }\r\n\r\n    get handler() {\r\n        return this.#handler;\r\n    }\r\n\r\n    get isRegistered() {\r\n        return this.#handler?.isRegistered === true;\r\n    }\r\n\r\n    get isOffline() {\r\n        return this.#handler?.isOffline;\r\n    }\r\n\r\n    set search(val) {\r\n        if (this.#handler) this.#handler.search = val;\r\n    }\r\n\r\n    /**\r\n     * Filter data in format \r\n     * [{name: idx[num] || name[string], value: ''  , op:'eq'}]\r\n     */\r\n    formatFilter(val) {\r\n        val = this.#formated(val);\r\n        return Array.isArray(val) ? val : [];\r\n    }\r\n\r\n    /**\r\n     * Sort data in format\r\n     * [{col: idx[num] || name[string]  , op: -1 | 1 }]\r\n     */\r\n    formatSort(val) {\r\n        val = this.#formated(val);\r\n        let sort = undefined;\r\n        if (typeof val === 'string') {\r\n            sort = [{ col: val }];\r\n        } else if (Array.isArray(val)) {\r\n            sort = val;\r\n        } else if (GSUtil.isNumber(val)) {\r\n            const idx = Math.abs(val);\r\n            sort = new Array(idx);\r\n            sort[idx - 1] = { ord: val };\r\n        }\r\n        return sort || [];\r\n    }\r\n\r\n    schedule(time = 0) {\r\n        const me = this;\r\n        time = GSUtil.asNum(time) * 1000;\r\n        clearInterval(me.#iid);\r\n        if (time > 0) me.#iid = setInterval(() => {\r\n            me.read(me);\r\n        }, time);\r\n    }\r\n\r\n    read() {\r\n        return this.#lifoReadRef();\r\n    }\r\n\r\n    write(data) {\r\n        const me = this;\r\n        me.#verifyHandler();\r\n        me.#handler?.write(me, data);\r\n    }\r\n\r\n    load() {\r\n        return this.read();\r\n    }\r\n\r\n    save(data) {\r\n        return this.write(data);\r\n    }\r\n\r\n    /**\r\n     * Callback for data read result\r\n     */\r\n    onDataRead(obj) {\r\n        if (this.isDebug) GSLog.log(this, 'Data Read: ' + JSON.stringify(obj));\r\n    }\r\n\r\n    /**\r\n     * Callback for data write result\r\n     * @param {*} obj \r\n     */\r\n    onDataWrite(obj) {\r\n        if (this.isDebug) GSLog.log(this, 'Data write: ' + JSON.stringify(obj));\r\n    }\r\n\r\n    /**\r\n     * Process data after receive, before notifying \r\n     * @param {*} data \r\n     */\r\n    postRead(data) {\r\n        const me = this;\r\n        if (!Array.isArray(data)) data = [data];\r\n        data.forEach(r => {\r\n            me.#config.forEach(c => {\r\n                let val = r[c.name];\r\n                if (!GSUtil.isNull(val)) {\r\n                    val = GSData.format(c, val);\r\n                    r[c.name] = val;\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Callback on data red/write error\r\n     * @param {*} obj \r\n     */\r\n    onDataError(obj) {\r\n        if (this.isDebug) GSLog.log(this, 'Data error: ' + JSON.stringify(obj));\r\n    }\r\n\r\n    #verifyHandler() {\r\n        const me = this;\r\n        if (me.isOffline || me.isRegistered) return;\r\n        throw new Error('Data handler not initialized!');\r\n    }\r\n\r\n    #initLIFO() {\r\n        const me = this;\r\n        me.#lifoReadRef = GSFunction.callOnceLifo(me.#lifoReadRefCallback, me);\r\n    }\r\n\r\n    #lifoReadRefCallback() {\r\n        const me = this;\r\n        me.#initLIFO();\r\n        return me.#lifoRead();\r\n    }\r\n\r\n    #lifoRead() {\r\n        const me = this;\r\n        me.#verifyHandler();\r\n        return me.#handler?.read(me);\r\n    }\r\n\r\n    #formated(val) {\r\n        return GSUtil.isJsonString(val) ? JSON.parse(val) : val;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-data-handler');\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, css, html, ifDefined, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\nexport class GSDialogElement extends GSElement {\r\n\r\n  static CSS = 'rounded shadow-sm';\r\n  static HEADER_CSS = 'p-3';\r\n  static TITLE_CSS = 'fs-5 fw-bold text-muted';\r\n  static ALIGN = 'end';\r\n  static CANCEL = 'Cancel';\r\n  static CONFIRM = 'Ok';\r\n\r\n  static #STACK = [];\r\n\r\n  static styles = css`dialog{outline:none;}dialog::backdrop{backdrop-filter: blur(4px);}`;\r\n\r\n  static properties = {\r\n\r\n    standard: { reflect: true, type: Boolean },\r\n    opened: { reflect: true, type: Boolean },\r\n    cancelable: { reflect: true, type: Boolean },\r\n    closable: { reflect: true, type: Boolean },\r\n    escapable: { reflect: true, type: Boolean },\r\n    disabled: { reflect: true, type: Boolean },\r\n\r\n\r\n    title: { reflect: true },\r\n    message: { reflect: true },\r\n    cancelText: { reflect: true, },\r\n    confirmText: { reflect: true, },\r\n\r\n    minWidth: { reflect: true, type: Number, attribute: 'min-width' },\r\n    buttonAlign: { reflect: true, attribute: 'button-align' },\r\n\r\n    iconCancel: { reflect: true, attribute: 'icon-cancel' },\r\n    iconConfirm: { reflect: true, attribute: 'icon-confirm' },\r\n\r\n    colorCancel: { attribute: 'color-cancel' },\r\n    colorConfirm: { attribute: 'color-confirm' },\r\n\r\n    cssCancel: { attribute: 'css-cancel' },\r\n    cssConfirm: { attribute: 'css-confirm' },\r\n\r\n    cssTitle: { attribute: 'css-title' },\r\n    cssHeader: { attribute: 'css-header' },\r\n    cssFooter: { attribute: 'css-footer' },\r\n    cssBody: { attribute: 'css-body' },\r\n    cssContent: { attribute: 'css-content' },\r\n\r\n  }\r\n\r\n  #styleID = GSID.id;\r\n  #dialogRef = createRef();\r\n  #btnConfirmRef = createRef();\r\n  #btnCancelRef = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    const clazz = GSDialogElement;\r\n    me.opened = false;\r\n    me.standard = false;\r\n    me.cancelable = false;\r\n    me.closable = false;\r\n    me.escapable = false;\r\n    me.disabled = false;\r\n    me.shadow = false;\r\n    me.rounded = false;\r\n\r\n    me.minWidth = 0;\r\n    me.css = clazz.CSS;\r\n    me.cssTitle = clazz.TITLE_CSS;\r\n    me.cssHeader = clazz.HEADER_CSS;\r\n    me.buttonAlign = clazz.ALIGN;\r\n    me.cancelText = clazz.CANCEL;\r\n    me.confirmText = clazz.CONFIRM;\r\n    me.colorCancel = 'secondary';\r\n    me.colorConfirm = 'primary';\r\n    me.dynamicStyle(me.#styleID);\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    super.disconnectedCallback();\r\n    GSDialogElement.#updateStack();\r\n  }\r\n\r\n  updated(changed) {\r\n    super.updated(changed);\r\n    const me = this;\r\n    if (me.opened) {\r\n      GSDialogElement.#STACK.push(me);\r\n      if (me.standard) {\r\n        me.#dialog?.open();\r\n      } else {\r\n        me.#dialog?.showModal();\r\n      }\r\n      me.#focusable()?.focus();\r\n    } else {\r\n      GSDialogElement.#STACK.pop();\r\n      me.#dialog?.close();\r\n    }\r\n    me.notify();\r\n  }\r\n\r\n  #renderConfirm() {\r\n    const me = this;\r\n    if (!me.closable) return '';\r\n    return html`<gs-button  ${ref(me.#btnConfirmRef)} \r\n      @click=\"${me.#onConfirm.bind(me)}\" \r\n      icon=\"${ifDefined(me.iconConfirm)}\"\r\n      locale=\"${ifDefined(me.locale)}\"\r\n      .disabled=\"${me.disabled}\"  \r\n      css=\"${ifDefined(me.cssConfirm)}\" \r\n      color=\"${ifDefined(me.colorConfirm)}\" \r\n      title=\"${me.confirmText}\">\r\n      </gs-button>`;\r\n  }\r\n\r\n  #renderCancel() {\r\n    const me = this;\r\n    if (!me.cancelable) return '';\r\n    return html`<gs-button ${ref(me.#btnCancelRef)}\r\n      @click=\"${me.#onCancel.bind(me)}\" \r\n      icon=\"${ifDefined(me.iconCancel)}\"\r\n      locale=\"${ifDefined(me.locale)}\"\r\n      css=\"${ifDefined(me.cssCancel)}\" \r\n      color=\"${ifDefined(me.colorCancel)}\" \r\n      title=\"${me.cancelText}\">\r\n      </gs-button>`;\r\n  }\r\n\r\n  #renderFooter() {\r\n    const me = this;\r\n    const isFooter = me.cancelable || me.closable;\r\n    if (!isFooter) return '';\r\n    return html`<div class=\"card-footer d-flex user-select-none justify-content-${me.buttonAlign} ${me.cssFooter}\">\r\n      ${me.#renderCancel()} &nbsp;${me.#renderConfirm()}\r\n      </div>`;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const styles = { 'min-width': me.minWidth > 0 ? `${me.minWidth}px` : undefined };\r\n    me.dynamicStyle(me.#styleID, styles);\r\n    return html`\r\n        <dialog tabindex=\"-1\" ${ref(me.#dialogRef)} \r\n            dir=\"${ifDefined(me.direction)}\"\r\n            @close=\"${me.#onCancel.bind(me)}\"\r\n            @cancel=\"${me.#onCancel.bind(me)}\"\r\n            @keydown=\"${me.#onKeyDown.bind(me)}\"\r\n            @form=\"${me.#onForm.bind(me)}\"\r\n            @submit=\"${me.#onSubmit.bind(me)}\"\r\n            class=\"${classMap(me.renderClass())}\">\r\n            <div class=\"card ${me.cssContent}\">\r\n                <div class=\"card-header user-select-none ${me.cssHeader}\">\r\n                  <div class=\"card-title ${me.cssTitle}\">\r\n                    <slot name=\"title\">${me.translate(me.title)}</slot>\r\n                  </div>\r\n                </div>\r\n                <div class=\"card-body ${me.cssBody}\">\r\n                  <slot name=\"body\">\r\n                  ${me.translate(me.message)}\r\n                  ${me.renderTemplate()}\r\n                  </slot>\r\n                </div>\r\n                ${me.#renderFooter()}\r\n            </div>\r\n            <slot name=\"extra\"></slot>\r\n            <div class=\"toast-container position-fixed\"></slot></div>\r\n        </dialog>`\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'dialog': true,\r\n      'p-0': true,\r\n      'border-0': true,\r\n      [me.#styleID]: true\r\n    }\r\n    return css;\r\n  }\r\n\r\n  /**\r\n   * Generic modal popup function\r\n   * @param {string} title Modal title\r\n   * @param {string} message Modal message \r\n   * @param {boolean} closable Can user close it (close button)\r\n   * @param {boolean} cancelable Is cancel button available\r\n   * @returns {Promise}\r\n   */\r\n  info(title = '', message = '', closable = false, cancelable = false) {\r\n    const me = this;\r\n    me.title = title;\r\n    me.body = message;\r\n    me.closable = closable;\r\n    me.cancelable = cancelable;\r\n    me.escapable = cancelable;\r\n    me.open();\r\n    if (closable || cancelable) return me.waitEvent('click-action');\r\n  }\r\n\r\n  confirm(title = '', message = '') {\r\n    return this.info(title, message, true, false);\r\n  }\r\n\r\n  prompt(title = '', message = '') {\r\n    return this.info(title, message, true, true);\r\n  }\r\n\r\n  reset(data, index = 0) {\r\n    index = GSUtil.asNum(index, 0);\r\n    const me = this;\r\n    me.forms?.forEach?.(f => { f.reset(); f.values = data; });\r\n    const tab = me.tab;\r\n    if (tab && index > -1) tab.index = index;\r\n  }\r\n\r\n  open() {\r\n    this.opened = true;\r\n  }\r\n\r\n  close() {\r\n    this.opened = false;\r\n  }\r\n\r\n  toggle() {\r\n    this.opened = !this.opened;\r\n  }\r\n\r\n  get form() {\r\n    return this.query('gs-form', true);\r\n  }\r\n\r\n  get forms() {\r\n    return this.queryAll('gs-form', true);\r\n  }\r\n\r\n  get tab() {\r\n    return this.query('gs-tab', true);\r\n  }\r\n\r\n  get #dialog() {\r\n    return this.#dialogRef.value;\r\n  }\r\n\r\n  get #btnConfirm() {\r\n    return this.#btnConfirmRef.value;\r\n  }\r\n\r\n  get #btnCancel() {\r\n    return this.#btnCancelRef.value;\r\n  }\r\n\r\n  /**\r\n   * Return active button\r\n   * @returns {HTMLButtonElement|GSButton}\r\n   */\r\n  #focusable() {\r\n    const me = this;\r\n    const form = me.queryAll(GSDOM.QUERY_INPUT, true).filter(el => GSDOM.isVisible(el)).shift();\r\n    if (form) return form;\r\n    if (me.cancelable) return me.#btnCancel;\r\n    if (me.closable) return me.#btnConfirm;\r\n    return me;\r\n  }\r\n\r\n  #onConfirm(e) {\r\n    const me = this;\r\n    if (me.disabled) return;\r\n    //me.forms.forEach(form => form.submit());\r\n    const ret = me.forms?.map?.(form => form.submit());\r\n    if (ret.indexOf(false) < 0) me.close();\r\n  }\r\n\r\n  #onCancel(e) {\r\n    const me = this;\r\n    me.close();\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n    const me = this;\r\n    if (e.key === 'Escape') {\r\n      GSEvents.prevent(e);\r\n      if (me.cancelable || me.escapable) {\r\n        me.close();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle injected form events\r\n   * @param {*} e \r\n   */\r\n  #onForm(e) {\r\n    const me = this;\r\n    const data = e.detail;\r\n    switch (data.type) {\r\n      case 'submit':\r\n        const sts = me.emit('data', data.data, false, false, true);\r\n        if (!sts) GSEvents.prevent(e);\r\n        //me.opened = false;\r\n        break;\r\n      case 'valid':\r\n        me.disabled = data.data === false;\r\n        break;\r\n    }\r\n  }\r\n\r\n  #onSubmit(e) {\r\n    debugger;\r\n  }\r\n\r\n  static #updateStack() {\r\n    GSDialogElement.#STACK = GSDialogElement.#STACK.filter(v => v.isConnected);\r\n  }\r\n\r\n  /**\r\n   * Return number of dialogs in a stack\r\n   */\r\n  static get size() {\r\n    return GSDialogElement.#STACK.length;\r\n  }\r\n\r\n  static get top() {\r\n    GSDialogElement.#updateStack();\r\n    const size = GSDialogElement.size;\r\n    return size === 0 ? null :  GSDialogElement.#STACK[size - 1];\r\n  }\r\n\r\n  static get opened() {\r\n    GSDialogElement.#updateStack();\r\n    return Array.from(GSDialogElement.#STACK);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-dialog');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, unsafeHTML, html, ifDefined } from '../lib.mjs';\r\nimport { placement, PlacementTypes } from '../properties/placement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSDrawerElement extends GSElement {\r\n\r\n  static properties = {\r\n    autoclose: { reflect: true, type: Boolean },\r\n    closable: { reflect: true, type: Boolean },\r\n    backdrop: { reflect: true, type: Boolean },\r\n    expanded: { reflect: true, type: Boolean },\r\n    scroll: { reflect: true, type: Boolean },\r\n\r\n    min: { reflect: true, type: Number},\r\n    max: { reflect: true},\r\n    fingers: { reflect: true, type: Number},\r\n    placement: {...placement},\r\n    \r\n    transition: { reflect: true },\r\n    duration: { reflect: true, type: Number },\r\n\r\n    title: { reflect: true},\r\n\r\n    cssTitle: { reflect: true, attribute: \"css-title\"},\r\n    cssHead: { reflect: true, attribute: \"css-head\" },\r\n    cssBody: { reflect: true, attribute: \"css-body\" },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.placement = 'start';\r\n    me.cssTitle = 'fs-5';\r\n    me.transition = 'linear';\r\n    me.duration = 0.2;\r\n    me.min = 0;\r\n    me.max = 'auto';\r\n    me.fingers = 2;\r\n    me.on('mouseleave', me.#onLeave.bind(me));\r\n    me.on('mouseenter', me.#onEnter.bind(me));\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`${unsafeHTML(me.#style)}\r\n    <div tabindex=\"-1\" dir=\"${ifDefined(me.direction)}\"\r\n     class=\"offcanvas overflow-hidden anime ${classMap(me.renderClass())}\">\r\n      ${me.#header}\r\n      <div class=\"offcanvas-body  ${me.cssBody}\">\r\n        ${me.renderTemplate()}\r\n        <slot name=\"body\"></slot>\r\n      </div>\r\n    </div>${me.#backdrop}`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'show': true,\r\n      'anime-open' : me.expanded,\r\n      'anime-close' : !me.expanded,\r\n      [`offcanvas-${me.placement}`]: me.placement,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  get #style() {\r\n    const me = this;\r\n    const pos = me.isHorizontal ? 'width' : 'height';\r\n    return `<style>\r\n    .anime {\r\n      transition-property: ${pos} !important;\r\n      transition-duration: ${me.duration}s  !important;\r\n      transition-timing-function: ${me.transition} !important;\r\n    }\r\n    .anime-open {\r\n        ${pos} : ${me.max}${GSUtil.isNumber(me.max) ? 'px':''} !important;\r\n    }\r\n    .anime-close {\r\n      ${pos} : ${me.min}${GSUtil.isNumber(me.min) ? 'px':''} !important;\r\n    }    \r\n    </style>`;\r\n  }\r\n\r\n  get #backdrop() {\r\n    const me = this;\r\n    if (!me.backdrop) return '';\r\n    return html`<div class=\"offcanvas-backdrop fade ${me.expanded ? 'show' : 'invisible'}\" @click=\"${me.close}\"></div>`;\r\n  }\r\n\r\n  get #button() {\r\n    const me = this;\r\n    return me.closable ? html`<button type=\"button\" class=\"btn-close text-reset\" @click=\"${me.close}\"></button>` : '';\r\n  }\r\n\r\n  get #title() {\r\n    const me = this;\r\n    return me.title ? html`<div class=\"offcanvas-title ${me.cssTitle}\">${me.translate(me.title)}</div>` : '';\r\n  }\r\n\r\n  get #header() {\r\n    const me = this;\r\n    return me.#hasHeader ? html`<div class=\"offcanvas-header ${me.cssHead}\"><slot name=\"header\">${me.#title}${me.#button}</slot></div>` : '';\r\n  }\r\n\r\n  get #headSlot() {\r\n    return this.querySelector('[slot=\"header\"]');\r\n  }\r\n\r\n  get #hasHeader() {\r\n    return this.title || this.closable || this.#headSlot;\r\n  }\r\n\r\n  #notify(val) {\r\n    const me = this;\r\n    me.expanded = val == true;\r\n    me.notify();\r\n  }\r\n\r\n  #onLeave() {\r\n    const me = this;\r\n    if (me.autoclose) me.close();\r\n  }\r\n\r\n  #onEnter() {\r\n    const me = this;\r\n    if (me.min > 0) me.open();\r\n  }\r\n\r\n  open() {\r\n    this.#notify(true);\r\n  }\r\n\r\n  close() {\r\n    this.#notify(false);\r\n  }\r\n\r\n  toggle() {\r\n    this.#notify(!this.expanded);\r\n  }\r\n\r\n  get isHorizontal() {\r\n    return !this.isVertical;\r\n  }\r\n\r\n  get isVertical() {\r\n    return PlacementTypes.isVertical(this.placement);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-drawer');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDropdownElement class\r\n * @module components/GSDropdownElement\r\n */\r\n\r\nimport { html, ifDefined } from '../lib.mjs';\r\nimport { cssMap } from '../directives/css-map.mjs';\r\nimport { color } from '../properties/color.mjs';\r\nimport { GSMenuElement } from './Menu.mjs';\r\n\r\n/**\r\n * Renderer for panel layout \r\n * @class\r\n * @extends {GSMenuElement}\r\n */\r\nexport class GSDropdownElement extends GSMenuElement {\r\n\r\n    static properties = {\r\n        icon: {},\r\n        text: {...color},\r\n        color: {...color},\r\n        size: {},\r\n        title: {}\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.auto = true;\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div class=\"dropdown\"  dir=\"${ifDefined(me.direction)}\">\r\n                ${me.#renderButton()}\r\n                ${super.renderUI()}\r\n            </div>`;\r\n    }\r\n\r\n    #buttonClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            'btn': true,\r\n            [`btn-${me.color}`] : me.color ? true : false,\r\n            'dropdown-toggle': true,\r\n            'shadow-none' : true,\r\n        }\r\n        return css;\r\n    }\r\n\r\n    #renderButton() {\r\n        const me = this;\r\n        return html`<gs-link css=\"${cssMap(me.#buttonClass())}\"\r\n            url=\"#\"         \r\n            icon=\"${ifDefined(me.icon)}\"\r\n            text=\"${ifDefined(me.text)}\"\r\n            size=\"${ifDefined(me.size)}\"\r\n            title=\"${ifDefined(me.title)}\"\r\n            @notify=\"${me.open}\">\r\n            </gs-link>`;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-dropdown');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { css, html, unsafeHTML } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\n/**\r\n * Safe email rendering to protect from spam bots.\r\n */\r\nexport class GSEmailElement extends GSElement {\r\n\r\n  static shadowRootOptions = { mode: 'closed' }\r\n\r\n  static style = css`.e-mail:before {\r\n    content: attr(data-website) \"\\0040\" attr(data-user);\r\n    unicode-bidi: bidi-override;\r\n    direction: rtl;\r\n    }`;\r\n\r\n  static properties = {\r\n    user: { reflect: true },\r\n    domain: { reflect: true },\r\n    dev: { type: Boolean }\r\n  }\r\n\r\n  #user;\r\n  #domain;\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  willUpdate(changes) {\r\n    super.willUpdate(changes);\r\n    this.#updateUser();\r\n    this.#updateDomain()\r\n  }\r\n\r\n  renderUI() {\r\n    return html`${unsafeHTML(this.#style)}<a @click=\"${this.#onClick}\" class=\"e-mail\" data-user=\"${this.#user}\" data-website=\"${this.#domain}\"  href=\"mailto://\"></a>`;\r\n  }\r\n\r\n  get #style() {\r\n    return '<style>.e-mail:before { content: attr(data-website) \"\\u0040\" attr(data-user); unicode-bidi: bidi-override; direction: rtl; }</style>';\r\n  }\r\n\r\n  get #url() {\r\n    return `mailto://${GSUtil.reverse(this.dataset.user)}@${GSUtil.reverse(this.dataset.domain)}`;\r\n  }\r\n\r\n  #updateUser() {\r\n    const me = this;\r\n    const dataset = me.dataset;\r\n    if (me.user) {\r\n      me.#user = dataset.user || GSUtil.reverse(me.user);\r\n      if (me.dev) dataset.user = me.#user;\r\n      me.user = '';\r\n    }\r\n  }\r\n\r\n  #updateDomain() {\r\n    const me = this;\r\n    const dataset = me.dataset;\r\n    if (me.domain) {\r\n      me.#domain = dataset.domain || GSUtil.reverse(me.domain);\r\n      if (me.dev) dataset.domain = me.#domain;\r\n      me.domain = '';\r\n    }\r\n  }\r\n\r\n  #onClick(e) {\r\n    const me = this;\r\n    me.prevent(e);\r\n    window.location.href = me.#url;\r\n    //window.open(me.#url, '_blank');  \r\n  }\r\n\r\n  static {\r\n    this.define('gs-email');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, html, ifDefined, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSLog } from '../base/GSLog.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\n\r\nexport class GSFormElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    disabled: { type: Boolean },\r\n    data: { type: Object },\r\n  }\r\n\r\n  #formRef = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    this.data = {};\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<form ${ref(me.#formRef)}\r\n      dir=\"${ifDefined(me.direction)}\"\r\n      @change=\"${me.#onChange}\"\r\n      @submit=\"${me.submit}\"\r\n      @reset=\"${me.reset}\"\r\n      method=\"dialog\">\r\n      <slot></slot>\r\n    </form>`;\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    this.dataController?.read();\r\n  }\r\n\r\n  updated(changed) {\r\n    const me = this;\r\n    if (changed.has('disabled')) {\r\n      if (me.disabled) {\r\n        me.disable();\r\n      } else {\r\n        me.enable();\r\n      }\r\n    }\r\n    if (changed.has('data')) {\r\n      me.asJSON = me.data;\r\n    }\r\n  }\r\n\r\n  get form() {\r\n    return this.#formRef.value;\r\n  }\r\n\r\n  get isValid() {\r\n    return this.elements\r\n      .filter(el => GSDOM.isVisible(el))\r\n      .map(el => el.checkValidity())\r\n      .filter(v => v === false).length === 0;\r\n  }\r\n\r\n  /**\r\n  * Overide native to pickup all form elements, including ones in shadow dom\r\n  */\r\n  get elements() {\r\n    return this.queryAll('input,select,output,textarea', true);\r\n  }\r\n\r\n  get fields() {\r\n    return this.elements;\r\n  }\r\n\r\n  get inputs() {\r\n    return this.elements;\r\n  }\r\n\r\n  get asJSON() {\r\n    return GSDOM.toObject(this);\r\n  }\r\n\r\n  set asJSON(data) {\r\n    const me = this;\r\n    GSDOM.fromObject(me, data);\r\n    return me.validate();\r\n  }\r\n\r\n  disable() {\r\n    GSDOM.disableInput(this, 'gs-form-group, input, textarea, select, .btn', false, 'gsForm');\r\n  }\r\n\r\n  enable() {\r\n    GSDOM.enableInput(this, 'gs-form-group, input, textarea, select, .btn', false, 'gsForm');\r\n  }\r\n\r\n  checkValidity() {\r\n    return this.form.checkValidity();\r\n  }\r\n\r\n  reportValidity() {\r\n    this.elements\r\n      .filter(el => GSDOM.isVisible(el))\r\n      .filter(el => !el.checkValidity())\r\n      .forEach(el => el.reportValidity() );\r\n    return this.form.reportValidity();\r\n  }\r\n\r\n  reset(e) {\r\n    const me = this;\r\n    const internal = e?.target === me.form;\r\n\r\n    if (internal) {\r\n      me.elements.forEach(el => el.value = el.defaultValue);\r\n      me.dataController?.read(me.asJSON);\r\n    } else {\r\n      me.data = {};\r\n      me.form.reset();\r\n    }\r\n  }\r\n\r\n  submit(e) {\r\n    GSEvents.prevent(e);\r\n    const me = this;\r\n    if (!me.validate()) return;\r\n    const json = me.asJSON;\r\n    me.dataController?.write(json);\r\n    const data = { type: 'submit', data: json, source: e, owner : me};\r\n    return me.emit('form', data, true, true, true);\r\n  }\r\n\r\n  onDataRead(data) {\r\n    this.data = data;\r\n  }\r\n\r\n  onDataWrite(data) {\r\n\r\n  }\r\n\r\n  onDataError(e) {\r\n    GSLog.error(this, e);\r\n  }\r\n\r\n  onFieldChange(el) {\r\n\r\n  }\r\n\r\n  validate() {\r\n    const me = this;\r\n    const isValid = me.checkValidity() && me.isValid;\r\n    if (!isValid) me.reportValidity();\r\n    const data = { type: 'valid', data: isValid, owner : me};\r\n    me.emit('form', data, true, true);\r\n    return isValid;\r\n  }\r\n\r\n  #onChange(e) {\r\n    const me = this;\r\n    if (me.isBindable) me.handle(e);\r\n    if (me.validate()) me.onFieldChange(e.detail);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-form');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, ref, html, ifDefined } from '../lib.mjs';\r\nimport { inputType, numGT0, numGE0 } from '../properties/index.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\n\r\nexport class GSFormGroupElement extends GSElement {\r\n\r\n  static CSS_LABEL_CELL = 'col-md-4 col-sm-4 col-xs-2';\r\n  static CSS_LABEL = 'user-select-none fw-small fw-light text-secondary';\r\n  static CSS_ICON = 'text-primary me-2 fs-5';\r\n  static ICON = 'info-circle-fill';\r\n\r\n  static properties = {\r\n    icon: {},\r\n    layout: {},\r\n    placement: {},\r\n\r\n    description: {},\r\n    label: {},\r\n    placeholder: {},\r\n    pattern: {},\r\n    mask: {},\r\n\r\n    name: {},\r\n    type: { ...inputType },\r\n    list: {},\r\n    accept: {},\r\n\r\n    lang: {},\r\n    default: { reflect: true },\r\n    step: { type: Number, reflect: true, hasChanged: numGT0 },\r\n    min: { type: Number, reflect: true, hasChanged: numGE0 },\r\n    max: { type: Number, reflect: true, hasChanged: numGT0 },\r\n    minLength: { type: Number, reflect: true, hasChanged: numGE0 },\r\n    maxLength: { type: Number, reflect: true, hasChanged: numGT0 },\r\n\r\n    reverse: { type: Boolean },\r\n\r\n    autoid: { type: Boolean },\r\n    autocopy: { type: Boolean, reflect: true },\r\n    autoselect: { type: Boolean, reflect: true },\r\n\r\n    autocapitalize: { type: Boolean, reflect: true },\r\n    autocomplete: { type: Boolean, reflect: true },\r\n    autofocus: { type: Boolean, reflect: true },\r\n    autoselect: { type: Boolean, reflect: true },\r\n    disabled: { type: Boolean, reflect: true },\r\n    checked: { type: Boolean, reflect: true },\r\n    multiple: { type: Boolean, reflect: true },\r\n    reveal: { type: Boolean, reflect: true },\r\n    readonly: { type: Boolean, reflect: true },\r\n    required: { type: Boolean, reflect: true },\r\n\r\n    cellField: { attribute: 'cell-field' },\r\n    cellLabel: { attribute: 'cell-label' },\r\n    cssLabel: { attribute: 'css-label' },\r\n    cssField: { attribute: 'css-field' },\r\n\r\n  }\r\n\r\n  #styleID = GSID.id;\r\n  #inputRef = createRef();\r\n  #ouptutRef = createRef();\r\n  #patterns = [];\r\n\r\n  constructor() {\r\n    super();\r\n    this.#validateAllowed();\r\n    this.dynamicStyle(this.#styleID);\r\n    this.type = 'text';\r\n    this.placement = 'top';\r\n    this.layout = 'horizontal';\r\n    this.icon = GSFormGroupElement.ICON;\r\n    this.cssLabel = GSFormGroupElement.CSS_LABEL;\r\n    this.cellLabel = GSFormGroupElement.CSS_LABEL_CELL;\r\n\r\n  }\r\n  \r\n  connectedCallback() {\r\n    const me = this;\r\n    const form = GSDOM.closest(me, 'gs-form');\r\n    me.layout = GSAttr.get(form, 'layout', me.layout);\r\n    me.#patterns = GSItem.collect(me)\r\n    .filter(el => el.dataset.pattern)\r\n    .map(el => new RegExp(el.dataset.pattern));\r\n    super.connectedCallback();\r\n  }\r\n\r\n  firstUpdated() {\r\n    super.firstUpdated();\r\n    const me = this;\r\n    me.value = me.default;\r\n  }\r\n\r\n  updated() {\r\n    const me = this;\r\n    me.#onRange();\r\n    if (me.templateRef && !me.field) {\r\n      const field = GSDOM.formElements(me.renderRoot).pop();\r\n      me.#inputRef.value = field;\r\n      if (field) {\r\n        field.name = this.name;\r\n        me.attachEvent(field, 'change', me.#onChange.bind(me));\r\n      }\r\n    }\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    switch (me.layout) {\r\n      case 'floating': return me.#renderFloating();\r\n      case 'vertical': return me.#renderVertical();\r\n      default: return me.#renderHorizontal();\r\n    }\r\n  }\r\n\r\n  #renderFloating() {\r\n    const me = this;\r\n    return html`\r\n    <div  dir=\"${ifDefined(me.direction)}\" class=\"row ${classMap(me.renderClass())}\">\r\n       <div class=\"form-floating ${me.#cssCheck} ${me.#cellField}\">\r\n          ${me.#renderInput()}\r\n          ${me.#renderOutput()}\r\n          ${me.#renderLabel()}\r\n       </div>\r\n       ${me.#renderInfo()}\r\n    </div>`;\r\n  }\r\n\r\n  #renderVertical() {\r\n    const me = this;\r\n    return html`\r\n    <div  dir=\"${ifDefined(me.direction)}\" class=\"row ${classMap(me.renderClass())}\">\r\n      <div class=\"col-12 text-md-start ${me.cellLabel}\">\r\n          ${me.#renderLabel()}\r\n      </div>\r\n       <div class=\"${me.#cssCheck} ${me.#cellField}\">\r\n          ${me.#renderInput()}\r\n          ${me.#renderOutput()}\r\n       </div>\r\n       ${me.#renderInfo()}   \r\n    </div>      \r\n    `;\r\n  }\r\n\r\n  #renderHorizontal() {\r\n    const me = this;\r\n    return html`\r\n    <div  dir=\"${ifDefined(me.direction)}\" class=\"row form-group ${classMap(me.renderClass())}\">    \r\n       <slot name=\"header\"></slot>\r\n       ${me.#renderLabelWrap()}\r\n       ${me.#renderField()}\r\n       ${me.#renderInfo()}\r\n       <slot name=\"footer\"></slot>\r\n    </div>`;\r\n  }\r\n\r\n  #renderLabel() {\r\n    const me = this;\r\n    return html`<label class=\"${me.#cssLabel} ${me.cssLabel} user-select-none\" for=\"${me.name}\">${me.translate(me.label)}</label>`;\r\n  }\r\n\r\n  #renderLabelWrap() {\r\n    const me = this;\r\n    return html`<div class=\" text-md-end ${me.cellLabel}\">${me.#renderLabel()}</div>`;\r\n  }\r\n\r\n  #renderIcon() {\r\n    const me = this;\r\n    return me.#isIcon ? html`<gs-icon size=\"5\" css=\"${GSFormGroupElement.CSS_ICON}}\" name=\"${me.icon}\"></gs-icon>` : html`<slot name=\"icon\"></slot>`;\r\n  }\r\n\r\n  #renderTooltip() {\r\n    const me = this;\r\n    const tgt = me.#isIcon ? '@parent' : `[name='${me.name}']`;\r\n    return me.description ? html`<gs-tooltip local locale=\"${ifDefined(me.locale)}\" placement=\"${me.placement}\" title=\"${me.description}\" target=${ifDefined(tgt)}></gs-tooltip>` : '';\r\n  }\r\n\r\n  #renderInfo() {\r\n    const me = this;\r\n    const tooltip = me.#renderTooltip();\r\n    if (tooltip && me.#isIcon) return html`\r\n    <div class=\"col-auto\">\r\n       ${tooltip}\r\n       ${me.#renderIcon()}\r\n    </div>`;\r\n    return tooltip;\r\n  }\r\n\r\n  #renderField() {\r\n    const me = this;\r\n    return html`\r\n    <div class=\"${me.#cssCheck} ${me.#cellField}\">\r\n       <slot name=\"body\">${me.#renderInput()}${me.#renderOutput()}</slot>\r\n    </div>`;\r\n  }\r\n\r\n  #renderOutput() {\r\n    const me = this;\r\n    if (!me.isRange) return \"\";\r\n    return html`<span ${ref(me.#ouptutRef)} class=\"position-absolute px-1\">${me.value}</span>`;\r\n  }\r\n\r\n  #renderInput() {\r\n\r\n    const me = this;\r\n\r\n    const tpl = me.query('template') || me.template;\r\n    if (tpl) return me.renderTemplate();\r\n\r\n    const idattr = me.autoid ? me.name : undefined;\r\n    const val = me.isFieldset ? me.value.split(',') : me.value;\r\n\r\n    if (Array.isArray(val)) {\r\n      const wrap = me.dataset.radioLayout === 'vertical';\r\n      return val.map((it, i) => { return { v: it, id: `${me.name}_${i}` } })\r\n        .map((o, i) => me.#fieldSet(me.name + i, o.v, me.#inputHTML(o.id, me.name, o.v), wrap));\r\n    }\r\n\r\n    return me.#inputHTML(idattr, me.name, me.value);\r\n  }\r\n\r\n  #fieldSet(id, val, fld, vertical = false) {\r\n    const me = this;\r\n    return vertical ?\r\n      html`<div class=\"me-3\">${fld}<label for=\"${id}\" class=\"ms-1\">${me.translate(val)}</label></div>`\r\n      :\r\n      html`<span class=\"me-3\">${fld}<label for=\"${id}\" class=\"ms-1\">${me.translate(val)}</label></span>`;\r\n  }\r\n\r\n  #inputHTML(id, name, value) {\r\n    const me = this;\r\n    const type = me.isSwitch ? 'checkbox' : me.type;\r\n\r\n    const style = {\r\n      transform: me.reverse && me.isRange ? 'rotateY(180deg)' : ''\r\n    }\r\n    me.dynamicStyle(me.#styleID, style);\r\n\r\n    return html`<input is=\"gs-ext-input\" \r\n            ${ref(me.#inputRef)}\r\n            id=${ifDefined(id)} \r\n            @blur=\"${me.#onBlur.bind(me)}\"\r\n            @input=\"${me.#onRange.bind(me)}\"\r\n            @change=\"${me.#onChange.bind(me)}\"\r\n        \r\n            name=\"${name}\" \r\n            type=\"${type}\" \r\n            value=\"${ifDefined(value)}\"\r\n    \r\n            class=\"${me.#cssField} ${me.cssField} ${me.#styleID}\" \r\n\r\n            placeholder=\"${ifDefined(me.translate(me.placeholder))}\"\r\n            description=\"${ifDefined(me.translate(me.description))}\"\r\n\r\n            mask=\"${ifDefined(me.mask)}\"\r\n            pattern=\"${ifDefined(me.pattern)}\"\r\n            list=\"${ifDefined(me.list)}\"\r\n            accept=\"${ifDefined(me.accept)}\"\r\n             \r\n            step=\"${ifDefined(me.step)}\"\r\n            min=\"${ifDefined(me.min)}\"\r\n            max=\"${ifDefined(me.max)}\"\r\n            lang=\"${ifDefined(me.lang)}\"\r\n\r\n            minlength=\"${ifDefined(me.minLength)}\"\r\n            maxlength=\"${ifDefined(me.maxLength)}\"\r\n            \r\n            ?autofocus=\"${me.autofocus}\"\r\n            ?autocopy=\"${me.autocopy}\"\r\n            ?autoselect=\"${me.autoselect}\"\r\n            ?autocomplete=\"${me.autocomplete}\"\r\n            ?multiple=\"${me.multiple}\"\r\n            ?checked=\"${me.checked}\"\r\n            ?readonly=\"${me.readonly}\"\r\n            ?required=\"${me.required}\"\r\n            ?disabled=\"${me.disabled}\"\r\n            ?reveal=\"${me.reveal}\"\r\n            >`;\r\n  }\r\n\r\n  get #cssField() {\r\n    const me = this;\r\n    if (me.isCheckable) return 'form-check-input ms-0';\r\n    if (me.isRange) return 'form-range';\r\n    return 'form-control';\r\n  }\r\n\r\n  get #cssLabel() {\r\n    const me = this;\r\n    if (me.isCheckable) return 'form-check-label';\r\n    if (me.isFloating) return 'ms-2';\r\n    return me.isVertical ? 'form-label' : '';\r\n  }\r\n\r\n  get #cssCheck() {\r\n    const me = this;\r\n    if (me.isCheckable) {\r\n      //return me.#isSwitch ? 'form-check form-switch ps-3 fs-5' : 'form-check';\r\n      if (me.isSwitch) return 'form-check form-switch ps-3 fs-5';\r\n      return me.isFieldset ? '' : 'form-check';\r\n    }\r\n    return '';\r\n  }\r\n\r\n  get #cellField() {\r\n    const me = this;\r\n    const val = (me.isHorizontal) ? '6' : '11';\r\n    return me.cellField || `col-md-${val} col-sm-${val} col-xs-11`;\r\n  }\r\n\r\n  get #isIcon() {\r\n    return GSUtil.isStringNonEmpty(this.icon);\r\n  }\r\n\r\n  #onRange(e) {\r\n    const me = this;\r\n    if (me.isRange) {\r\n      const el = me.#ouptutRef.value;\r\n      if (el) el.innerHTML = me.value || '';\r\n      me.field.title = me.value;\r\n    }\r\n    me.emit('input', e);\r\n  }\r\n\r\n  #onChange(e) {\r\n    this.emit('change', e, true);\r\n  }\r\n\r\n  async #onBlur(e) {\r\n\r\n    const me = this;\r\n    const el = me.field;\r\n\r\n    if (el.value.length === 0 || me.#patterns.length === 0) return;\r\n\r\n    const isValid = me.checkValidity();\r\n    if (!isValid) {\r\n      me.reportValidity();\r\n      el.focus();\r\n      await GSUtil.timeout(2000);\r\n      el.setCustomValidity('');\r\n    }\r\n\r\n    me.emit('change', e);\r\n  }\r\n\r\n  #validateAllowed() {\r\n    const me = this;\r\n    const slots = ['header', 'body', 'footer'];\r\n    let list = Array.from(me.children).filter(el => el.slot && !slots.includes(el.slot));\r\n    if (list.length > 0) throw new Error(`Custom element injection must contain slot=\"header|body|footer\" attribute! Element: ${me.tagName}, ID: ${me.id}`);\r\n    list = Array.from(me.children).filter(el => !el.slot);\r\n    const tagList = ['TEMPLATE', 'GS-ITEM'];\r\n    const allowed = GSDOM.isAllowed(list, tagList);\r\n    if (!allowed) throw new Error(GSDOM.toValidationError(me, tagList));\r\n  }\r\n\r\n  validate() {\r\n    const me = this;\r\n    const isValid = me.checkValidity();\r\n    if (!isValid) me.reportValidity();\r\n    return isValid;\r\n  }\r\n\r\n  checkValidity() {\r\n\r\n    const me = this;\r\n    const el = me.field;\r\n\r\n    let isValid = el?.checkValidity();\r\n    for (const r of me.#patterns) {\r\n      isValid = r.test(el?.value);\r\n      if (!isValid) break;\r\n    }\r\n\r\n    return isValid;\r\n  }\r\n\r\n  reportValidity() {\r\n    const me = this;\r\n    const el = me.field;\r\n    const msg = me.#patterns.length > 0 ? 'Invalid input' : '';\r\n    el?.setCustomValidity(msg);\r\n    return el?.reportValidity();\r\n  }\r\n\r\n  get value() {\r\n    return this.field?.value;\r\n  }\r\n\r\n  set value(val) {\r\n    GSDOM.fromObject2Element(this.field, { [this.name]: val });\r\n    this.validate();\r\n    this.#onRange();\r\n  }\r\n\r\n  get isFloating() {\r\n    return this.layout === 'floating';\r\n  }\r\n\r\n  get isHorizontal() {\r\n    return this.layout === 'horizontal';\r\n  }\r\n\r\n  get isVertical() {\r\n    return this.layout === 'vertical';\r\n  }\r\n\r\n  get isFieldset() {\r\n    const me = this;\r\n    return me.type === 'radio' && me.value?.includes(',');\r\n  }\r\n\r\n  get isCheckable() {\r\n    const me = this;\r\n    return me.isCheck || me.isRadio || me.isSwitch;\r\n  }\r\n\r\n  get isChecked() {\r\n    return this.field.checked;\r\n  }\r\n\r\n  get isCheck() {\r\n    return this.type === 'checkbox';\r\n  }\r\n\r\n  get isRadio() {\r\n    return this.type === 'radio';\r\n  }\r\n\r\n  get isSwitch() {\r\n    return this.type === 'switch';\r\n  }\r\n\r\n  get isNumber() {\r\n    return this.type === 'number';\r\n  }\r\n\r\n  get isRange() {\r\n    return this.type === 'range';\r\n  }\r\n\r\n  get isText() {\r\n    return this.type === 'text';\r\n  }\r\n\r\n  get isPassword() {\r\n    return this.type === 'passsword';\r\n  }\r\n\r\n  get isEmail() {\r\n    return this.type === 'email';\r\n  }\r\n\r\n  get isURL() {\r\n    return this.type === 'url';\r\n  }\r\n\r\n  get isFile() {\r\n    return this.type === 'file';\r\n  }\r\n\r\n  get field() {\r\n    return this.#inputRef.value;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-form-group');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, html, ifDefined, ref, repeat } from '../lib.mjs';\r\nimport { GSLog } from '../base/GSLog.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSFormGroupElement } from './FormGroup.mjs';\r\n\r\n/**\r\n * Component is responsible for auto-building gs-form and gs-form-group elements\r\n * from either JSON data or GS-ITEM elements.\r\n */\r\nexport class GSFormPanelElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    formStorage: { attribute: 'form-storage' },\r\n    disabled: { type: Boolean },\r\n    data: { type: Array },\r\n  }\r\n\r\n  #formRef = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    this.data = this.#proxify;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<gs-form ${ref(me.#formRef)}\r\n      ?disabled=${me.disabled} \r\n      storage=\"${ifDefined(me.formStorage)}\" \r\n      .locale=\"${me.locale}\"\r\n      .rtl=\"${me.rtl}\"\r\n      .css=\"${me.css}\"\r\n      .theme=\"${me.theme}\"\r\n      .margin=\"${me.margin}\"\r\n      .padding=\"${me.padding}\"\r\n      .border=\"${me.border}\"\r\n      .shadow=\"${me.shadow}\"\r\n      .os=\"${me.os}\"\r\n      .browser=\"${me.browser}\"\r\n      .environment=\"${me.environment}\"\r\n      .orientation=\"${me.orientation}\"\r\n      .protocol=\"${me.protocol}\">\r\n      <slot>\r\n        ${repeat(me.data, (r) => html`<gs-form-group .data=${r} locale=\"${ifDefined(me.locale)}\" ></gs-form-group>`)}\r\n      </slot>\r\n    </form>`;\r\n  }\r\n\r\n  get form() {\r\n    return this.#formRef.value;\r\n  }\r\n\r\n  onDataRead(data) {\r\n    this.data = data;\r\n  }\r\n\r\n  onDataError(e) {\r\n    GSLog.error(this, e);\r\n  }\r\n\r\n  get #proxify() {\r\n    return GSItem.collect(this).map(el => GSAttr.proxify(el, GSFormGroupElement.properties));\r\n  }\r\n\r\n  static {\r\n    this.define('gs-form-panel');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSGroupElement class\r\n * @module components/GSGroupElement\r\n */\r\n\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { ElementNavigationController } from '../controllers/ElementNavigationController.mjs';\r\nimport { classMap, createRef, html, ifDefined, ref } from '../lib.mjs';\r\n\r\n/**\r\n * Renderer for grouped elements such as Buttons, Navs, Tabs and lists.\r\n * Components handles grouped elements navigation, selection and focus.\r\n * \r\n * @class\r\n * @extends { GSElement }\r\n */\r\nexport class GSGroupElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    circular: { type: Boolean },\r\n    multiple: { type: Boolean },\r\n    data: { type: Array },\r\n  }\r\n\r\n  #elRef = createRef();\r\n  #controller;\r\n\r\n  constructor() {\r\n    super();\r\n    this.data = this.initData();\r\n    this.#controller = new ElementNavigationController(this);\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    this.#controller.init();\r\n    this.#controller.attach(this.#elRef.value);\r\n    super.firstUpdated(changed);\r\n  }  \r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div ${ref(me.#elRef)} \r\n      dir=\"${ifDefined(me.direction)}\"\r\n      class=\"${classMap(me.renderClass())}\">\r\n      ${me.renderWrappedUI()}\r\n      </div>`;\r\n  }\r\n\r\n  renderWrappedUI(name) {\r\n    const me = this;\r\n    return html`<div \r\n      class=\"${classMap(me.renderWrappedClass())}\">\r\n      <slot name=\"${ifDefined(name)}\">${me.renderItems()}</slot>\r\n      </div>`;\r\n  }\r\n\r\n  renderWrappedClass() {\r\n    return {};\r\n  }\r\n\r\n  renderItems() {\r\n    return '';\r\n  }\r\n\r\n  initData() {\r\n    return undefined;\r\n  }\r\n\r\n  previous() {\r\n    this.#controller.previous();\r\n  }\r\n\r\n  next() {\r\n    this.#controller.next();\r\n  }\r\n\r\n  /**\r\n   * Reset focus / selection\r\n   */\r\n  reset() {\r\n    this.#controller.reset();\r\n  }\r\n\r\n  /**\r\n   * Element navigation filter where we can select if focused element is navigable\r\n   * @param {*} el \r\n   * @returns \r\n   */\r\n  isNavigable(el) {\r\n    return true;\r\n  }\r\n\r\n  onDataRead(data) {\r\n    this.data = data;\r\n  }\r\n\r\n  get focused() {\r\n    return this.#controller.focused;\r\n  }\r\n\r\n  get selected() {\r\n    return this.#controller.selected;\r\n  }\r\n\r\n  settings(el) {\r\n    const tagName = customElements.getName(el).toUpperCase() || 'GS-ITEM';\r\n    const cfg = GSElement.allProperties(el);\r\n    const items = Array.from(this.children).filter(e => e.tagName === tagName ).map(el => GSAttr.proxify(el, cfg));\r\n    const active = items.filter(el => el.active);\r\n    active.forEach((el, idx) => el.active = idx === 0);\r\n    return items;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-group');\r\n  }\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, css, html, ifDefined, createRef, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { notEmpty, numGT0 } from '../properties/index.mjs';\r\nimport { color } from '../properties/color.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\nexport class GSIconElement extends GSElement {\r\n\r\n  static styles = css`\r\n    :host {\r\n      --gs-icon-super-color : cornflowerblue;\r\n      --gs-icon-content : '';\r\n    }\r\n    i::after {\r\n      top: -8px;\r\n      font-size: 0.7em;\r\n      position: relative;\r\n      content: var(--gs-icon-content);\r\n      content: attr(data-super);\r\n      color: var(--gs-icon-super-color);\r\n    }`;\r\n\r\n  static properties = {\r\n    name: { reflect: true, hasChanged: notEmpty },\r\n    size: { reflect: true, type: Number, hasChanged: numGT0 },\r\n    color: { reflect: true, ...color },\r\n    superColor: { attribute : 'super-color'},\r\n    super: { reflect: true },\r\n    clickCss: { attribute : 'click-css'},\r\n    hoverCss: { attribute : 'hover-css'},\r\n    _clicked: { attribute:false},\r\n    _hovered: { attribute:false},\r\n  }\r\n\r\n  #ref = createRef();\r\n  \r\n  constructor() {\r\n    super();\r\n    //this.flat = true;\r\n  }\r\n\r\n  /*\r\n  firstUpdated() {\r\n    super.firstUpdated();\r\n    this.#embdeded = GSDOM.matches(this.parentComponent, '[icon]');\r\n  }\r\n  */\r\n\r\n  updated(changed) {\r\n    if (changed.has('_clicked')) {\r\n      if (this._clicked) this.#postAnimate();\r\n    } \r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    me.setCSSProperty(':host', '--gs-icon-super-color', me.superColor);\r\n    return html`<i  ${ref(me.#ref)}\r\n       class=\"bi ${classMap(me.renderClass())}\"\r\n       data-super=\"${ifDefined(me.super)}\"\r\n       @click=\"${me.animate}\"\r\n       @mouseover=\"${me.#onMouseOver}\"\r\n       @mouseout=\"${me.#onMouseOut}\"></i>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      [`text-${me.color}`]: me.color,\r\n      [`bi-${me.name}`]: me.name,\r\n      'fs': me.size > 0,\r\n      [`fs-${me.size}`]: me.size > 0,\r\n      [me.clickCss]: me._clicked,\r\n      [me.hoverCss]: me._hovered,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  async #postAnimate() {\r\n    const me = this;\r\n    const delay = GSUtil.asNum(me.dataset.delay, 1);\r\n    if (delay > 0) {\r\n      await GSUtil.timeout(delay * 1000);\r\n      me._clicked = false;\r\n    }    \r\n  }\r\n\r\n  #onMouseOver(e) {\r\n    this.hover(true);\r\n  }\r\n\r\n  #onMouseOut(e) {\r\n    this.hover(false);\r\n  }\r\n\r\n  animate() {\r\n    const me = this;\r\n    me._hovered = false;\r\n    me._clicked = true;\r\n  }\r\n\r\n  hover(sts = false) {\r\n    const me = this;\r\n    if (sts) {\r\n      me._clicked = false;\r\n    }\r\n    me._hovered = sts;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-icon');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { css, html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { numGT0 } from '../properties/index.mjs';\r\n\r\nexport class GSIndentElement extends GSElement {\r\n\r\n  static styles = css`.indent {\r\n      --gs-indent : 10px;\r\n      margin-left: var(--gs-indent);\r\n      margin-right: var(--gs-indent);\r\n    }`;\r\n\r\n  static properties = {\r\n    flat: { type: Boolean },\r\n    size: { type: Number, hasChanged: numGT0 },\r\n    multiplier: { type: Number, hasChanged: numGT0 }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.size = 1;\r\n    me.multiplier = 10;\r\n  }\r\n\r\n  renderUI() {\r\n    const size = this.size * this.multiplier;\r\n    return html`<span class=\"indent\" style=\"--gs-indent: ${size}px;\"></span>`;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-indent');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, html, ifDefined, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { notEmpty, numGE0 } from '../properties/index.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\nconst numdef = { reflect: true, type: Number, hasChanged: numGE0 };\r\n\r\nexport class GSImageElement extends GSElement {\r\n\r\n  static properties = {\r\n    src: { hasChanged: notEmpty },\r\n    width: numdef,\r\n    height: numdef,\r\n    opacity: numdef,\r\n    invert: numdef,\r\n    grayscale: numdef,\r\n    brightness: numdef,\r\n    blur: numdef,\r\n    contrast: numdef,\r\n    saturate: numdef,\r\n    hue: numdef,\r\n    sepia: numdef,\r\n\r\n    alt: {},\r\n    loading: {}\r\n\r\n  }\r\n\r\n  #imageRef = createRef();\r\n  #styleID = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    this.dynamicStyle(this.#styleID);\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    this.#update();\r\n    return this.src;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<img ${ref(me.#imageRef)} \r\n            @load=\"${me.#onLoad}\"\r\n            src=\"${me.src}\" \r\n            alt=\"${me.alt}\" \r\n            loading=\"${ifDefined(me.loading)}\" \r\n            class=\"${me.#styleID}\" \r\n            data-gs-class=\"${me.#styleID}\">\r\n          </img>`;\r\n  }\r\n\r\n  get complete() {\r\n    return this.#imageRef.value?.complete || false;\r\n  }\r\n\r\n  get #dynamic() {\r\n    return this.dynamicStyle(this.#styleID).style;\r\n  }\r\n\r\n  #renderStyle() {\r\n    const me = this;\r\n    const filter = me.#buildFilter();\r\n    const css = {\r\n      width: me.width > 0 ? me.width : undefined,\r\n      height: me.height > 0 ? me.height : undefined,\r\n      filter: filter.length > 0 ? filter.join(' ') : ''\r\n    }\r\n    return css;\r\n  }\r\n\r\n  #buildFilter() {\r\n    const me = this;\r\n    const o = [];\r\n\r\n    if (me.blur > 0) o.push(`blur(${me.blur}px)`);\r\n    if (me.invert > 0) o.push(`invert(${me.invert})`);\r\n    if (me.opacity > 0) o.push(`opacity(${me.opacity})`);\r\n    if (me.contrast > 0) o.push(`contrast(${me.contrast})`);\r\n    if (me.grayscale > 0) o.push(`grayscale(${me.grayscale})`);\r\n    if (me.brightness > 0) o.push(`brightness(${me.brightness})`);\r\n\r\n    if (me.hue > 0) o.push(`hue-rotate(${me.hue}deg)`);\r\n    if (me.sepia > 0) o.push(`sepia(${me.sepia}%)`);\r\n    if (me.saturate > 0) o.push(`saturate(${me.saturate}%)`);\r\n\r\n    return o;\r\n  }\r\n\r\n  #update() {\r\n    const me = this;\r\n    const dynamic = me.#dynamic;\r\n    dynamic.filter = me.#buildFilter().join(' ').trim();\r\n    dynamic.width = me.width > 0 ? `${me.width}px` : '';\r\n    dynamic.height = me.height > 0 ? `${me.height}px` : '';\r\n  }\r\n\r\n  #onLoad(e) {\r\n    const el = e.target;\r\n    const me = this;\r\n    if (el) {\r\n      me.height = me.height || el.height;\r\n      me.width = me.width || el.width;\r\n      me.emit('loaded', { width: el.width, height: el.height, element: el }, true);\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-image');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSLayout class\r\n * @module components/GSLayoutElement\r\n */\r\n\r\nimport { classMap, html, ifDefined, templateContent } from '../lib.mjs';\r\nimport { orientation, OrientationTypes } from '../properties/orientation.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\n\r\n/**\r\n * Renderer for panel layout \r\n * @class\r\n * @extends {Component}\r\n */\r\nexport class GSLayoutElement extends GSElement {\r\n\r\n    static properties = {\r\n        type: { ...orientation }\r\n    }\r\n\r\n    // GS-ITEM attributes mapping\r\n    static options = {\r\n        id : {},\r\n        type: {},\r\n        min: { type: Number },\r\n        max: { type: Number },\r\n        size: { type: Number },\r\n        resizable: { type: Boolean },\r\n        autofit: { type: Boolean },\r\n        vPos: { attribute: 'h-pos' },\r\n        hPos: { attribute: 'v-pos' },\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;\r\n        me.autofit = true;  \r\n        me.#items(me).map((el, idx, els) => me.#dyncss(el, idx, els, 0));\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        if ( this.autofit && GSDOM.root(this) === document.body) document.body.classList.add('vh-100');\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        const list = me.#items(me).map((el, idx, els) => me.#build(el, idx, els));\r\n        return html`<div  dir=\"${ifDefined(me.direction)}\" class=\"d-flex flex-fill w-100 h-100 ${classMap(me.renderClass())}\">${list}</div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const horizontal = OrientationTypes.isHorizontal(me.type);\r\n        return {\r\n            ...super.renderClass(),\r\n            'flex-column': horizontal\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Proxify GS-ITEM elements to easily read attributes\r\n     */\r\n    #items(root) {\r\n        return GSItem.collect(root).map(el => GSAttr.proxify(el, GSLayoutElement.options));\r\n    }\r\n\r\n    #resizable(el) {\r\n        return el.size > 0 || el.min > 0 || el.max > 0 || el.resizable;\r\n    }\r\n\r\n    #dyncss(el, idx, els, lev = 0) {\r\n        const me = this;\r\n        me.#items(el.self).map((it, idx, items) => me.#dyncss(it, idx, items, lev+1));\r\n        if(me.#resizable(el)) me.dynamicStyle(`gsd-${lev}-${idx}`);\r\n    }\r\n\r\n    #build(el, idx, els, lev = 0) {\r\n\r\n        const me = this;\r\n        const type = el.self.parentElement.type || 'vertical';\r\n\r\n        const list = me.#items(el.self).map((it, idx, items) => me.#build(it, idx, items, lev+1));\r\n        \r\n        const min = el.min;\r\n        const max = el.max;\r\n        const template = el.template;\r\n        const tplEl = me.#elementTemplate(el);\r\n\r\n        const tc = `#${tplEl?.id}` !== template;\r\n\r\n        const dir = el.type || type || 'vertical';\r\n        const horizontal = OrientationTypes.isHorizontal(dir);\r\n        \r\n        const col = list.length > 0 && horizontal ? 'flex-column' : '';\r\n\r\n        const did = `gsd-${lev}-${idx}`;\r\n        const css = me.#panelCSS(el, col, did);\r\n        const style = me.#panelStyle(el, horizontal);\r\n        me.dynamicStyle(did, style);\r\n\r\n        const slot = el.name ? html`<slot name=\"${el.name}\"></slot>` : '';\r\n        const src = html`<div id=\"${ifDefined(el.id)}\" class=\"d-flex ${classMap(css)}\">\r\n            ${list}\r\n            ${templateContent(tplEl)}\r\n            ${template && tc ? html`<gs-template flat src=\"${template}\"></gs-template>` : ''}\r\n            ${slot}\r\n            </div>`;\r\n\r\n        if (!el.resizable) return src;\r\n\r\n        const resize = (idx === els.length - 1) ? 'end' : 'start';\r\n        const splitter = me.#splitter(min, max, type, resize);\r\n\r\n        if (idx === els.length - 1) return [splitter , src];\r\n        return [src, splitter];\r\n    }\r\n    \r\n    #elementTemplate(el) {\r\n        const tplEl = el.self.firstElementChild;\r\n        return tplEl instanceof HTMLTemplateElement ? tplEl : undefined;\r\n    }\r\n\r\n    #panelCSS(el, col, did) {\r\n\r\n        const resizable = this.#resizable(el);\r\n        const grow = resizable ? '' : 'flex-grow-1';\r\n\r\n        let vpos = el.vPos;\r\n        let hpos = el.hPos;\r\n\r\n        hpos = hpos ? `align-items-${hpos}` : '';\r\n        vpos = vpos ? `justify-content-${vpos}` : '';\r\n\r\n        const css = this.mapCSS(el.css, {\r\n            [did] : resizable,\r\n            [col] : col,\r\n            [grow] : grow,\r\n            [hpos] : hpos,\r\n            [vpos] : vpos\r\n        });\r\n    \r\n        return css;        \r\n    }\r\n\r\n    #panelStyle(el, horizontal) {\r\n        const min = el.size || el.min;\r\n        const max = el.max || el.size;\r\n        const style = {};\r\n        if (horizontal) {\r\n            style['min-height'] = min > 0 ? `${min}px` : undefined;\r\n            style['max-height'] = max > 0 ? `${max}px` : undefined;\r\n        } else {\r\n            style['min-width'] = min > 0 ? `${min}px` : undefined;\r\n            style['max-width'] = max > 0 ? `${max}px` : undefined;\r\n        }\r\n        return style;        \r\n    }\r\n\r\n    #splitter(min, max, dir, resize) {\r\n        return html`<gs-splitter split=\"${dir}\" resize=\"${resize}\" min=\"${min}\" max=\"${max}\"></gs-splitter>`;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-layout');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, ifDefined, html, createRef, ref } from '../lib.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color } from '../properties/index.mjs';\r\nimport { dataset } from '../directives/dataset.mjs';\r\n\r\nexport class GSLinklement extends GSElement {\r\n\r\n  static properties = {\r\n    clickCss: { attribute : 'click-css'},\r\n    hoverCss: { attribute : 'hover-css'},\r\n    autofocus: { type: Boolean },\r\n    disabled: { type: Boolean, reflect: true },\r\n    size: { type: Number },\r\n    text: { ...color },\r\n    color: { ...color },\r\n    url: {},\r\n    ping: {},\r\n    icon: {},\r\n    title: {},\r\n    tooltip: {},\r\n    target: {}\r\n  };\r\n\r\n  #refEl = createRef();\r\n  #refIco = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    this.url = '#';\r\n    // this.text = 'primary'; // do not set as default -> gs-dropdown\r\n    // this.target = '_blank'; // not used \r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    if (this.autofocus && !this.disabled) this.focus();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`\r\n      <a ${ref(me.#refEl)}  \r\n        dir=\"${ifDefined(me.direction)}\"\r\n        title=\"${ifDefined(me.translate(me.tooltip))}\" \r\n        href=\"${ifDefined(me.url)}\" \r\n        ping=\"${ifDefined(me.ping)}\" \r\n        target=\"${ifDefined(me.target)}\"\r\n        class=\"${classMap(me.renderClass())}\" \r\n        ?disabled=${me.disabled} \r\n        @mouseover=\"${me.#onMouseOver}\"\r\n        @mouseout=\"${me.#onMouseOut}\"        \r\n        @click=\"${me.#onClick}\">\r\n        ${me.#first}${me.#second}\r\n        </a>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'active': me.active,      \r\n      [`fs-${me.size}`]: me.size > 0,\r\n      [`text-${me.text}`]: me.text,\r\n      [`bg-${me.color}`]: me.color\r\n    }\r\n    return css;\r\n  }\r\n\r\n  click() {\r\n    this.#refEl.value?.click();\r\n  }\r\n\r\n  focus() {\r\n    requestAnimationFrame(() => this.#refEl.value?.focus());\r\n  }\r\n\r\n  get iconEl() {\r\n    return this.#refIco.value;\r\n  }\r\n\r\n  #onClick(e) {\r\n    const me = this;\r\n    me.iconEl?.animate();\r\n    me.notify();\r\n    if (me.url === '#' || GSUtil.isStringEmpty(me.url)) {\r\n      GSEvents.prevent(e);\r\n      me.handle(e);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  #onMouseOver() {\r\n    this.iconEl?.hover(true);\r\n  }\r\n\r\n  #onMouseOut() {\r\n    this.iconEl?.hover(false);\r\n  }\r\n\r\n  get #title() {\r\n    return this.translate(this.title);\r\n  }\r\n\r\n  get #first() { return this.rtl ? this.#title : this.#iconHtml; };\r\n\r\n  get #second() { return this.rtl ? this.#iconHtml : this.#title; };\r\n\r\n  get #iconHtml() { return this.icon ? this.#renderIcon : html`<slot name=\"icon\"></slot>`; }\r\n\r\n  get #renderIcon() {\r\n    return  html`\r\n    <gs-icon css=\"mx-1\" ${ref(this.#refIco)} \r\n    name=\"${this.icon}\" \r\n    size=\"${this.size}\" \r\n    click-css=\"${ifDefined(this.clickCss)}\" \r\n    hover-css=\"${ifDefined(this.hoverCss)}\" \r\n    data-delay=\"1\"></gs-icon>`;\r\n  }\r\n\r\n  /**\r\n   * Generate clickable link\r\n   * @param {*} options \r\n   * @param {*} css \r\n   * @param {*} before \r\n   * @param {*} after \r\n   * @returns \r\n   */\r\n  static generate(options, css, before, after) {\r\n    const opt = options;\r\n    return html`<a class=\"${classMap(css)}\"\r\n        tabindex=\"0\"    \r\n        ${dataset(opt, true)}\r\n        part=\"${ifDefined(opt.part)}\"\r\n        tooltip=\"${ifDefined(opt.tooltip)}\"\r\n        href=\"${ifDefined(opt.url)}\">        \r\n        ${before || ''}\r\n        <slot>${opt.title}</slot> \r\n        ${after || ''}\r\n    </a>`;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-link');\r\n  }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, ifDefined, html, createRef, ref } from '../lib.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSListItemElement extends GSElement {\r\n\r\n  static properties = {\r\n    href: {},\r\n    target: {},\r\n    title: {},\r\n    icon: {},\r\n    size: { type: Number },\r\n    autofocus: { type: Boolean, reflect: true },\r\n    disabled: { type: Boolean, reflect: true },\r\n    active: { type: Boolean, reflect: true },\r\n    selectable: { type: Boolean, reflect: true },\r\n    generated: { state: true, type: Boolean }\r\n  }\r\n\r\n  #initial;\r\n  #refEl = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    this.binded();\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    this.#initial = this.active;\r\n  }\r\n\r\n  shouldUpdate(changedProperties) {\r\n    return this.owner?.tagName === 'GS-LIST';\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<a  tabindex=\"0\" ${ref(me.#refEl)}\r\n       href=\"${ifDefined(me.url)}\" \r\n       target=\"${ifDefined(me.target)}\" \r\n       class=\"${classMap(me.renderClass())}\">\r\n        ${me.#renderFirst()} \r\n        ${me.#renderSecond()}\r\n        <slot>${me.renderTemplate()}</slot>\r\n      </a>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'list-group-item': true,\r\n      'list-group-item-action': true,\r\n      [`fs-${me.size}`]: me.size > 0,\r\n      [me.#itemCSS] : true,\r\n      'active': me.active\r\n    }\r\n    return me.mapCSS(me.#itemStatusCSS, css);\r\n  }\r\n\r\n  #renderIcon() {\r\n    const me = this;\r\n    return me.icon ? html`<gs-icon name=\"${me.icon}\" size=\"${me.size}\"></gs-icon>` : html`<slot name=\"icon\"></slot>`;\r\n  }\r\n\r\n  #renderText() {\r\n    return this.title ? html`<span>${this.translate(this.title)}</span>` : html`<slot name=\"title\"></slot>`;\r\n  }\r\n\r\n  #renderFirst() {\r\n    return this.rtl ? this.#renderText() : this.#renderIcon();\r\n  }\r\n\r\n  #renderSecond() {\r\n    return this.rtl ? this.#renderIcon() : this.#renderText();\r\n  }\r\n\r\n  toggle() {\r\n    this.active = !this.active;\r\n  }\r\n\r\n  reset() {\r\n    this.active = this.autofocus || this.#initial || false;\r\n  }\r\n\r\n  click() {\r\n    this.#refEl.value?.click();\r\n  }\r\n\r\n  focus() {\r\n    requestAnimationFrame(() => this.#refEl.value?.focus());\r\n  }\r\n\r\n  get url() {\r\n    return this.href && this.target ? this.href : '#';\r\n  }\r\n\r\n  get owner() {\r\n    return (this.hasAttribute('generated') ? GSDOM.component(this) : this.parentElement);\r\n  }\r\n  \r\n  get #activeCSS() {\r\n    return this.owner.dataset?.cssActive || '';\r\n  }\r\n\r\n  get #inactiveCSS() {\r\n    return this.owner.dataset?.cssInactive || '';\r\n  }\r\n\r\n  get #itemCSS() {\r\n    return this.owner.dataset?.cssItem || '';\r\n  }\r\n\r\n  get #itemStatusCSS() {\r\n    return this.active ? this.#activeCSS : this.#inactiveCSS;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-list-item');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { html, ifDefined } from '../lib.mjs';\r\nimport { GSGroupElement } from './Group.mjs';\r\nimport { GSListItemElement } from './ListItem.mjs';\r\n\r\nexport class GSListElement extends GSGroupElement {\r\n\r\n  static properties = {\r\n    selectable: { reflect: true, type: Boolean },\r\n    data: { type: Array },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.circular = false;\r\n    this.multiple = false;\r\n  }\r\n\r\n  initData() {\r\n    return this.settings(GSListItemElement);\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    return this.data.length > 0 || this.query('gs-list-item');\r\n  }\r\n\r\n  renderClass() {\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'list-group': true,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  renderWrappedUI() {\r\n    return html`<slot>${this.renderItems()}</slot>`;\r\n  }\r\n\r\n  reset() {\r\n    this.items.forEach(el => el.reset());\r\n    this.notify();\r\n  }\r\n\r\n  renderItems() {\r\n    return this.data.map(o => {\r\n      return html`<gs-list-item generated\r\n        .active=\"${o.active === true}\"\r\n        .autofocus=\"${o.autofocus === true}\"\r\n        .selectable=\"${o.selectable === true}\"\r\n        .disabled=\"${ifDefined(o.disabled === true)}\" \r\n        icon=\"${ifDefined(o.icon)}\" \r\n        href=\"${ifDefined(o.href)}\" \r\n        target=\"${ifDefined(o.target)}\" \r\n        title=\"${ifDefined(o.title)}\"></gs-list-item>`;\r\n    });\r\n  }\r\n\r\n  isNavigable(el) {\r\n    return el?.tagName === 'GS-LIST-ITEM';\r\n  }\r\n\r\n  get items() {\r\n    return this.queryAll('gs-list-item');\r\n  }\r\n\r\n  static {\r\n    this.define('gs-list');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, ifDefined, html, createRef, ref } from '../lib.mjs';\r\nimport { NavTypes, PlacementTypes } from '../properties/index.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\n\r\nexport class GSNavItemElement extends GSElement {\r\n\r\n  static properties = {\r\n    href: {},\r\n    target: {},\r\n    title: {},\r\n    icon: {},\r\n    disabled: { type: Boolean },\r\n    autofocus: { type: Boolean },\r\n    active: { type: Boolean, reflect: true },\r\n    generated: { state: true, type : Boolean }\r\n  }\r\n\r\n  #refEl = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  shouldUpdate(changedProperties) {\r\n    return this.owner?.tagName === 'GS-NAV';\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    if (this.autofocus && !this.disabled) this.focus();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div class=\"nav-item ${classMap(me.renderClass())}\">${me.#button}</div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    return this.mapCSS(this.#itemsCSS, super.renderClass());\r\n  }\r\n\r\n  reset() {\r\n    this.active = this.autofocus || false;\r\n  }\r\n\r\n  click() {\r\n    this.#refEl.value?.click();\r\n  }\r\n\r\n  focus() {\r\n    requestAnimationFrame(() => this.#refEl.value?.focus());\r\n  }\r\n\r\n  get isNav() {\r\n    return true;\r\n  }\r\n\r\n  get vertical() {\r\n    return this.parentElement.vertical || false;\r\n  }\r\n\r\n  get placement() {\r\n    return this.parentElement.placement;\r\n  }\r\n\r\n  get owner() {\r\n    return (this.hasAttribute('generated') ? GSDOM.component(this) : this.parentElement);\r\n  }\r\n\r\n  get url() {\r\n    return this.href && this.target ? this.href : '#';\r\n  }\r\n\r\n  get #title() {\r\n    return html`<slot>${this.translate(this.title)}</slot>`;\r\n  }\r\n\r\n  get #icon() {\r\n    return this.icon ? html`<gs-icon name=\"${this.icon}\"></gs-icon>` : html`<slot name=\"icon\"></slot>`;\r\n  }\r\n\r\n  get #first() {\r\n    return this.rtl ? this.#title : this.#icon;\r\n  }\r\n\r\n  get #second() {\r\n    return this.rtl ? this.#icon : this.#title;\r\n  }\r\n\r\n  get #button() {\r\n    const me = this;\r\n    let obj = me.mapCSS(me.#buttonCSS, {});\r\n    if (me.active) obj = me.mapCSS(me.#buildCSS + ' ' + me.#activeCSS, obj);\r\n    return html`<a tabindex=\"0\" type=\"button\" role=\"nav\" \r\n     ${ref(me.#refEl)}\r\n     class=\"nav-link ${classMap(obj)}\"\r\n     href=\"${ifDefined(me.url)}\" \r\n     target=\"${ifDefined(me.target)}\">\r\n        ${me.#first} \r\n        ${me.#second}\r\n      </a>`;\r\n  }\r\n\r\n  get #itemsCSS() {\r\n    return this.owner.dataset?.cssItem || '';\r\n  }\r\n\r\n  get #buttonCSS() {\r\n    return this.owner.dataset?.cssButton || '';\r\n  }\r\n\r\n  get #activeCSS() {\r\n    return this.owner.dataset?.cssActive || '';\r\n  }\r\n\r\n  get #navType() {\r\n    return NavTypes.indexOf(this.owner.type);\r\n  }\r\n\r\n  // fiix for shadowed DOM, parent class=\"nav nav-pills..\" \r\n  // do not cross shadow dom, so item elements does not see CSS\r\n  // we have to simulate\r\n  get #buildCSS() {\r\n    const isVertical = this.vertical;\r\n    const isBefore = PlacementTypes.isBefore(this.placement);\r\n    switch (this.#navType) {\r\n      // pills\r\n      case 1: return 'rounded text-bg-primary';\r\n      // tabs\r\n      case 2:\r\n        if (isVertical) {\r\n          if (isBefore) {\r\n            return 'shadow-none border border-end-0';\r\n          } else {\r\n            return 'shadow-none border border-start-0';\r\n          }\r\n        }\r\n        return 'shadow-none border border-bottom-0';\r\n      // underline\r\n      case 3: return 'shadow-none border-bottom border-3 fw-medium';\r\n      default:\r\n        return '';\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-nav-item');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { html, ifDefined } from '../lib.mjs';\r\nimport { GSGroupElement } from './Group.mjs';\r\nimport { GSNavItemElement } from './NavItem.mjs';\r\nimport { PlacementTypes, nav, placement } from '../properties/index.mjs';\r\n\r\nexport class GSNavElement extends GSGroupElement {\r\n\r\n  static properties = {\r\n    type: nav,\r\n    placement: placement,\r\n    vertical: { type: Boolean }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.circular = true;\r\n    this.multiple = false;\r\n    this.type = 'pills';\r\n    this.placement = 'start';\r\n  }\r\n\r\n  initData() {\r\n    return this.settings(GSNavItemElement);\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    return this.data.length > 0 || this.query('gs-nav-item');\r\n  }\r\n  \r\n  renderWrappedClass() {\r\n    const me = this;\r\n    const isBefore = PlacementTypes.isBefore(me.placement);\r\n    const isTab = me.type === 'tabs';\r\n    const css = {\r\n      'nav': true,\r\n      [`nav-${me.type}`]: me.type,\r\n      'flex-column': me.vertical,\r\n      'border-bottom-0': me.vertical,\r\n      'border-end': isTab && isBefore && me.vertical,\r\n      'border-start': isTab && !isBefore && me.vertical,\r\n      [`justify-content-${me.placement}`]: !me.vertical\r\n    }\r\n    return css;\r\n  }\r\n\r\n  /**\r\n   * Render items based on data propprty (might be from gs-item)\r\n   * @returns \r\n   */\r\n  renderItems() {\r\n    return this.data.map(o => {\r\n      return html`<gs-nav-item generated\r\n        .active=\"${o.active === true}\"\r\n        .autofocus=\"${o.autofocus === true}\"\r\n        .disabled=\"${ifDefined(o.disabled === true)}\" \r\n        icon=\"${ifDefined(o.icon)}\" \r\n        href=\"${ifDefined(o.href)}\" \r\n        target=\"${ifDefined(o.target)}\" \r\n        title=\"${ifDefined(o.title)}\"></gs-nav-item>`;\r\n    });\r\n  }\r\n\r\n  isNavigable(el) {\r\n    return el?.tagName === 'GS-NAV-ITEM';\r\n  }\r\n\r\n  /**\r\n   * Callback when child element focused\r\n   * @param {*} el \r\n   */\r\n  onFocused(el) {\r\n    // el?.click();\r\n  }\r\n\r\n  static {\r\n    this.define('gs-nav');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { svg, html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\n\r\nexport class GSOverlayElement extends GSElement {\r\n\r\n    static properties = {\r\n        color: {},\r\n        target: {},\r\n        autoremove: { type: Boolean },\r\n        opened: { type: Boolean },\r\n        opacity: { type: Number },\r\n        padding: { type: Number },\r\n        radius: { type: Number },\r\n    }\r\n\r\n    #styleID = GSID.id;\r\n    #styleID2 = GSID.id;\r\n\r\n    constructor() {\r\n        super();\r\n        //this.color = 'rgb(0,0,0)';\r\n        this.color = '#000';\r\n        this.opacity = 0.7;\r\n        this.padding = 1;\r\n        this.radius = 6;\r\n        this.dynamicStyle(this.#styleID);\r\n        this.dynamicStyle(this.#styleID2);\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        const me = this;\r\n        me.attachEvent(window, 'resize', () => me.requestUpdate());\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        if (!me.opened) return '';\r\n        const path = me.#path;\r\n        return path ? html`<svg xmlns=\"http://www.w3.org/2000/svg\" xmlspce=\"preserve\"\r\n            xmlnsXlink=\"http://www.w3.org/1999/xlink\"\r\n            version=\"1.1\" preserveAspectRatio=\"xMinYMin slice\"\r\n            viewvbox=\"0 0 ${window.innerWidth} ${window.innerHeight}\"\r\n            class=\"gs-overlay gs-overlay-animated ${me.#styleID}\"\r\n            @click=\"${me.reset.bind(me)}\">\r\n            ${path}\r\n        </svg>` : '';\r\n    }\r\n\r\n    async firstUpdated(changed) {\r\n        const me = this;\r\n        const opt = {\r\n            fillRule: \"evenodd\",\r\n            clipRule: \"evenodd\",\r\n            strokeLinejoin: \"round\",\r\n            strokeMiterlimit: \"2\",\r\n            zIndex: \"10000\",\r\n            position: \"fixed\",\r\n            top: \"0\",\r\n            left: \"0\",\r\n            width: \"100%\",\r\n            height: \"100%\"\r\n        };\r\n        me.dynamicStyle(me.#styleID, opt);\r\n        super.firstUpdated(changed);\r\n    }\r\n\r\n    open() {\r\n        this.opened = true;\r\n    }\r\n\r\n    close() {\r\n        this.opened = false;\r\n    }\r\n\r\n    toggle() {\r\n        this.opened = !this.opened;\r\n    }\r\n\r\n    reset() {\r\n        const me = this;\r\n        if (me.autoremove) me.close();\r\n    }\r\n\r\n    get #path() {\r\n        const me = this;\r\n        const el = GSDOM.query(me.target);\r\n        if (!me.target) return '';\r\n        const pathStr = me.#createSVGPathString(el);\r\n        const opt = { fill: me.color, opacity: me.opacity, pointerEvents: 'auto', cursor: 'auto' };\r\n        me.dynamicStyle(me.#styleID2, opt);\r\n        return svg`<path class=\"${me.#styleID2}\"  d=\"${pathStr}\"></path>`;\r\n    }\r\n\r\n    #createSVGPathString(target) {\r\n\r\n        const me = this;\r\n        const windowX = window.innerWidth;\r\n        const windowY = window.innerHeight;\r\n\r\n        const rect = target.getBoundingClientRect();\r\n\r\n        const padding = me.padding;\r\n        const radius = me.radius;\r\n\r\n        const width = rect.width + padding * 2;\r\n        const height = rect.height + padding * 2;\r\n\r\n        // prevent glitches when stage is too small for radius\r\n        const limitedRadius = Math.min(radius, width / 2, height / 2);\r\n\r\n        // no value below 0 allowed + round down\r\n        const normalizedRadius = Math.floor(Math.max(limitedRadius, 0));\r\n\r\n        const highlightBoxX = rect.x - padding + normalizedRadius;\r\n        const highlightBoxY = rect.y - padding;\r\n        const highlightBoxWidth = width - normalizedRadius * 2;\r\n        const highlightBoxHeight = height - normalizedRadius * 2;\r\n\r\n        const val = `M${windowX},0L0,0L0,${windowY}L${windowX},${windowY}L${windowX},0Z\r\n            M${highlightBoxX},${highlightBoxY} \r\n            h${highlightBoxWidth} \r\n            a${normalizedRadius},${normalizedRadius} 0 0 1 ${normalizedRadius},${normalizedRadius} \r\n            v${highlightBoxHeight} \r\n            a${normalizedRadius},${normalizedRadius} 0 0 1 -${normalizedRadius},${normalizedRadius} \r\n            h-${highlightBoxWidth} \r\n            a${normalizedRadius},${normalizedRadius} 0 0 1 -${normalizedRadius},-${normalizedRadius} \r\n            v-${highlightBoxHeight} \r\n            a${normalizedRadius},${normalizedRadius} 0 0 1 ${normalizedRadius},-${normalizedRadius} z`;\r\n        return val.replace(/[\\t\\n]/g, ' ');\r\n    }\r\n\r\n    static {\r\n        this.define('gs-overlay');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, html, ifDefined, map, range, ref } from '../lib.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { size, SizeTypes } from '../properties/index.mjs';\r\n\r\nexport class GSPagerElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    size: { ...size },\r\n    first: { type: Boolean },\r\n    last: { type: Boolean },\r\n    next: { type: Boolean },\r\n    previous: { type: Boolean },\r\n    pages: { type: Number },\r\n\r\n    labelFirst: { attribute: 'label-first' },\r\n    labelLast: { attribute: 'label-last' },\r\n    labelNext: { attribute: 'label-next' },\r\n    labelPrevious: { attribute: 'label-previous' },\r\n\r\n    cssItem: { attribute: 'css-item' },\r\n\r\n  }\r\n\r\n  #ref = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    this.pages = 5;\r\n    this.labelFirst = '&laquo;';\r\n    this.labelLast = '&raquo;';\r\n    this.labelNext = '&rsaquo;';\r\n    this.labelPrevious = '&lsaquo;';\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const half = Math.floor((me.pages - 1) / 2);\r\n    const page = me.dataController?.page || 0;\r\n    const start = page - half < 1 ? 1 : page - half;\r\n    const end = page > 0 ? page + half : me.pages;\r\n\r\n    return html`<nav \r\n        dir=\"${ifDefined(me.direction)}\"\r\n        @click=\"${me.#onClick}\"\r\n        @keyup=\"${me.#onKeyUp}\"\r\n        @keydown=\"${me.#onKeyDown}\">\r\n        <ul ${ref(me.#ref)} class=\"${classMap(me.renderClass())}\">\r\n        ${me.#renderFirst()}\r\n        ${me.#renderPrevious()}\r\n        ${map(range(start, end + 1), (i) => me.#renderItem(i, '', '', i  === page))}\r\n        ${me.#renderNext()}\r\n        ${me.#renderLast()}\r\n        </ul></nav>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const size = me.size ? SizeTypes[me.size] || me.size : '';\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'pagination': true,\r\n      [`pagination-${size}`]: size,\r\n\r\n    }\r\n    return css;\r\n  }\r\n\r\n  updated() {\r\n    const target = this.#ref.value;\r\n    if (target && this.isFocused) {\r\n      target.querySelector('.active > a')?.focus();\r\n    }\r\n  }\r\n\r\n  onDataRead() {\r\n    this.requestUpdate();\r\n  }\r\n\r\n  #renderFirst() {\r\n    return this.first ? this.#renderItem(this.labelFirst, 'first', 'First page') : '';\r\n  }\r\n\r\n  #renderLast() {\r\n    return this.last ? this.#renderItem(this.labelLast, 'last', 'Last page') : '';\r\n  }\r\n\r\n  #renderPrevious() {\r\n    return this.previous ? this.#renderItem(this.labelPrevious, 'previous', 'Previous page') : '';\r\n  }\r\n\r\n  #renderNext() {\r\n    return this.next ? this.#renderItem(this.labelNext, 'next', 'Next page') : '';\r\n  }\r\n\r\n  #renderItem(text = '', name = '', title = '', active = false) {\r\n    const me = this;\r\n    text = GSUtil.decodeHTMLEntities(text);\r\n    return html`<li class=\"page-item ${active ? 'active' : ''}\">\r\n              <a class=\"page-link ${this.cssItem}\" \r\n                 name=\"${name}\" \r\n                 title=\"${me.translate(title)}\" \r\n                 href=\"#\">${me.translate(text)}</a>\r\n            </li>`;\r\n  }\r\n\r\n  #onClick(e) {\r\n\r\n    const me = this;\r\n    const el = this.#toTarget(e, 'a');\r\n    if (!el) return;\r\n\r\n    const ctrl = me.dataController;\r\n    if (!ctrl) return;\r\n\r\n    const val = el.name || el.text;\r\n    me.emit(val, el);\r\n    \r\n    switch (val) {\r\n      case 'first':\r\n        return ctrl.firstPage();\r\n      case 'last':\r\n        return ctrl.lastPage();\r\n      case 'next':\r\n        return ctrl.nextPage();\r\n      case 'previous':\r\n        return ctrl.prevPage();\r\n    }\r\n\r\n    ctrl.page = val;\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n    const current = this.#toTarget(e, 'li');\r\n    let el = null;\r\n    switch (e.code) {\r\n      case 'ArrowLeft':\r\n        el = current?.previousElementSibling;\r\n        break;\r\n      case 'ArrowRight':\r\n        el = current?.nextElementSibling;\r\n        break;\r\n    }\r\n    el = el?.querySelector('a');\r\n    el?.focus();\r\n  }\r\n\r\n  #onKeyUp(e) {\r\n    if (e.code === 'Space') {\r\n      this.#toTarget(e, 'a')?.click();\r\n    }\r\n  }\r\n\r\n  #toTarget(e, name) {\r\n    const el = e.target.closest(name) || e.target;\r\n    return el.tagName === name.toUpperCase() ? el : undefined;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-pagination');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, ref, classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { placement, position } from '../properties/index.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSPopper } from \"../base/GSPopper.mjs\";\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\n\r\nexport class GSPopupElement extends GSElement {\r\n\r\n  static properties = {\r\n    placement: { ...placement },\r\n    position: { ...position },\r\n    trigger: {},\r\n    target: {},\r\n    autoclose: { type: Boolean },\r\n    autofocus: { type: Boolean },\r\n    opened: { type: Boolean },\r\n    hPos: { type: Number, attribute: 'h-pos' },\r\n    vPos: { type: Number, attribute: 'v-pos' },\r\n    wMin: { type: Number, attribute: 'w-min' },\r\n    wMax: { type: Number, attribute: 'w-max' },\r\n    hMin: { type: Number, attribute: 'h-min' },\r\n    hMax: { type: Number, attribute: 'h-max' },\r\n\r\n  }\r\n\r\n  #caller = null;\r\n  #panelRef = createRef();\r\n  #styleID = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    this.autofocus = true;\r\n    this.autoclose = true;\r\n    this.trigger = 'click';\r\n    this.position = 'absolute';\r\n    this.placement = 'bottom';\r\n    this.dynamicStyle(this.#styleID);\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    const me = this;\r\n    me.#attachTaraget();\r\n    me.attachEvent(window, 'resize', me.close.bind(me));\r\n    me.on('mouseleave', me.#onAuto.bind(me));\r\n  }\r\n\r\n  firstUpdated(changedProperties) {\r\n    const me = this;\r\n    requestAnimationFrame(() => {\r\n      me.#resize();\r\n      me.#reposition();\r\n    });\r\n    super.firstUpdated();\r\n  }\r\n\r\n  updated() {\r\n    const me = this;\r\n    me.#reposition();\r\n    if (me.autofocus) me.focus();\r\n    me.notify();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div \r\n      ${ref(me.#panelRef)}\r\n      dir=\"${ifDefined(me.direction)}\"\r\n      class=\"fade ${classMap(me.renderClass())}\"\r\n      data-gs-class=\"${me.#styleID}\"\r\n      @keydown=\"${me.#onKeyDown}\">\r\n      ${me.renderTemplate()}\r\n      <slot></slot>\r\n    </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'show': me.opened,\r\n      //'d-none' : !me.opened,\r\n      [me.#styleID]: true,\r\n      [`position-${me.position}`]: me.position,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  focus() {\r\n    this.query('[tabindex], input, select, textarea, button, a', true)?.focus();\r\n  }\r\n\r\n  open() {\r\n    this.opened = true;\r\n  }\r\n\r\n  close() {\r\n    this.opened = false;\r\n  }\r\n\r\n  toggle() {\r\n    this.opened = !this.opened;\r\n  }\r\n\r\n  /**\r\n   * Show popup at x/y position on the screen\r\n   * @param {Number} x \r\n   * @param {Number} y \r\n   * @returns {void}\r\n   */\r\n  popup(x = 0, y = 0) {\r\n    const me = this;\r\n    const obj = {\r\n      top: '0px',\r\n      left: '0px',\r\n      translate: `${x}px ${y}px`\r\n    };\r\n    me.#resize(obj);\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n    const me = this;\r\n    switch (e.key) {\r\n      case 'Escape':\r\n        me.close();\r\n        break;\r\n    }\r\n  }\r\n\r\n  #reposition() {\r\n    const me = this;\r\n    //if (!me.opened) return;\r\n    if (me.vPos || me.hPos) {\r\n      const opt = {\r\n        top: '0px',\r\n        left: '0px',\r\n        translate: `${me.hPos}px ${me.vPos}px`\r\n      };\r\n      const rule = me.dynamicStyle(me.#styleID);\r\n      Object.assign(rule.style, opt);\r\n    } else if (me.target) {\r\n      let target = GSDOM.query(document.documentElement, me.target);\r\n      target = target.renderRoot?.firstElementChild || target;\r\n      GSPopper.popupFixed(me.placement, me.#panel, target);\r\n    }\r\n\r\n  }\r\n\r\n  #resize(obj = {}) {\r\n    const me = this;\r\n    const rule = me.dynamicStyle(me.#styleID);\r\n    if (me.wMax) obj['max-width'] = `${me.wMax}px`;\r\n    if (me.wMin) obj['min-width'] = `${me.wMin}px`;\r\n    if (me.hMax) obj['max-height'] = `${me.hMax}px`;\r\n    if (me.hMin) obj['min-height'] = `${me.hMin}px`;\r\n    Object.assign(rule.style, obj);\r\n  }\r\n\r\n  #onPopup(e) {\r\n    const me = this;\r\n    me.#caller = e;\r\n    if (e instanceof Event) {\r\n      GSEvents.prevent(e);\r\n      me.#caller = e.composedPath().filter(e => (!(e instanceof HTMLSlotElement))).shift();\r\n    }\r\n\r\n    if (me.placement) {\r\n      GSPopper.popupFixed(me.placement, me.#panel, me.#caller);\r\n      me.opened = true;\r\n      return;\r\n    }\r\n\r\n    let x = e.clientX, y = e.clientY;\r\n    const rect = me.#panel.getBoundingClientRect();\r\n    const overflowH = x + rect.width > window.innerWidth;\r\n    const overflowV = y + rect.height > window.innerHeight;\r\n\r\n    if (overflowH) x = window.innerWidth - rect.width;\r\n    if (overflowV) y = window.innerHeight - rect.height;\r\n\r\n    me.popup(x, y);\r\n    return true;\r\n  }\r\n\r\n  #attachTaraget() {\r\n    const me = this;\r\n    const targets = GSDOM.queryAll(document.documentElement, me.target);\r\n    me.trigger.split(' ').forEach(evt => {\r\n      targets.forEach(target => me.attachEvent(target, evt, me.#onPopup.bind(me)));\r\n    });\r\n  }\r\n\r\n  #onAuto(e) {\r\n    if (this.autoclose) this.close();\r\n  }\r\n\r\n  get #panel() {\r\n    return this.#panelRef.value;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-popup');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { html, classMap, ifDefined } from '../lib.mjs';\r\nimport { literalTemplate } from '../directives/literal.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\nexport class GSProgressElement extends GSElement {\r\n\r\n  static properties = {\r\n    min: { reflect: true, type: Number },\r\n    max: { reflect: true, type: Number },\r\n    step: { reflect: true, type: Number },\r\n    value: { reflect: true, type: Number },\r\n    label: { reflect: true }\r\n  }\r\n\r\n  #styleID = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    this.min = 0;\r\n    this.step = 1;\r\n    this.max = 100;\r\n    this.value = 0;\r\n    this.styles = { width: '0%' };\r\n    this.dynamicStyle(this.#styleID);\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'progress-bar' : true,\r\n      [me.#styleID] : true\r\n    }\r\n    return css;\r\n  }  \r\n\r\n  renderUI() {\r\n    const me = this;\r\n    me.#updateStyle();\r\n    const obj = {min :me.min, max:me.max, step:me.step, value:me.value, percentage:me.percentage};\r\n    return html`\r\n    <div class=\"progress\" @keydown=\"${me.#onKeySelect}\" dir=\"${ifDefined(me.direction)}\">\r\n        <div class=\"${classMap(me.renderClass())}\" \r\n             \r\n             role=\"progressbar\"\r\n             tabindex=\"0\">\r\n             ${literalTemplate(me.label, obj)}\r\n        </div>\r\n    </div>    \r\n    `;\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    const me = this;\r\n    if (changed.has('value')) {\r\n      let val = me.step + changed.get('value');\r\n      val = me.#update(val, val);\r\n      changed.set('value', val);\r\n    }\r\n  }\r\n\r\n  updated(changed) {\r\n    if (changed.has('value')) {\r\n      this.notify();\r\n    }\r\n  }\r\n\r\n  increase(val) {\r\n    const me = this;\r\n    val = GSUtil.isNumber(val) ? val : me.step;\r\n    me.value = me.#update(me.value + val, me.value);\r\n    return true;\r\n  }\r\n\r\n  decrease(val) {\r\n    const me = this;\r\n    val = GSUtil.isNumber(val) ? val : me.step;\r\n    me.value = me.#update(me.value - val, me.value);\r\n    return true;\r\n  }\r\n\r\n  get percentage() {\r\n    const me = this;\r\n    return Math.trunc((me.value / me.max) * 100);\r\n  }\r\n\r\n  #updateStyle() {\r\n    const me = this;\r\n    me.styles.width = `${me.percentage}%`;\r\n    me.dynamicStyle(me.#styleID, me.styles);\r\n  }\r\n\r\n  #update(val, old = 0) {\r\n    val = GSUtil.asNum(val, GSUtil.asNum(old));\r\n    const me = this;\r\n    if (val > me.max) val = me.max;\r\n    if (val < me.min) val = me.min;\r\n    return val;\r\n  }\r\n\r\n  #onKeySelect(e) {\r\n    const me = this;\r\n    switch (e.code) {\r\n      case 'ArrowUp' :\r\n      case 'ArrowRight' :\r\n          return me.increase();\r\n      case 'ArrowLeft' :\r\n      case 'ArrowDown' :\r\n         return me.decrease();\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-progress');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, css, html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color } from '../properties/index.mjs';\r\n\r\nexport class GSSpinnerElement extends GSElement {\r\n\r\n    static styles = css`.spinner-border { border: var(--bs-spinner-border-width) solid currentcolor; border-right-color: transparent; }`;\r\n\r\n    static properties = {\r\n        color: { ...color, reflect: true },\r\n        small: { type: Boolean, reflect: true },\r\n        pulsar: { type: Boolean }\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div class=\"${classMap(me.renderClass())}\" role=\"status\"></div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            \"spinner-border\": !me.pulsar,\r\n            \"spinner-grow\": me.pulsar,\r\n            [`text-${me.color}`]: me.color,\r\n            [`spinner-border-sm`]: !me.pulsar && me.small,\r\n            [`spinner-grow-sm`]: me.pulsar && me.small,\r\n        }\r\n        return css;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-spinner');\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSSplitterElement class\r\n * @module components/GSSplitterElement\r\n */\r\n\r\nimport { classMap, createRef, ref, html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSCSSMap } from '../base/GSCSSMap.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { notEmpty, numGT0, placement } from '../properties/index.mjs';\r\nimport { ElementMoveController } from '../controllers/ElementMoveController.mjs';\r\n\r\n/**\r\n * Renderer for element splitter\r\n * @class\r\n * @extends {Component}\r\n */\r\nexport class GSSplitterElement extends GSElement {\r\n\r\n    static properties = {\r\n        // Check if splitter use vertical or horizontal splitting\r\n        split: { reflect: true },\r\n        // start|end|top|bottom\r\n        resize: { ...placement, hasChanged: notEmpty },\r\n        size: { type: Number, hasChanged: numGT0 }\r\n    }\r\n\r\n    #cursor = 0;\r\n    #styleID = GSID.id;\r\n    #styleTGT = GSID.id;\r\n    #elRef = createRef();\r\n    #mouseController;\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;\r\n        me.size = 8;\r\n        me.resize = 'start';\r\n        me.dynamicStyle(me.#styleID);\r\n        me.#load();\r\n        me.#mouseController = new ElementMoveController(me);\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        super.disconnectedCallback();\r\n        //this.dynamicStyle(this.#styleTGT, null, true);\r\n    }\r\n\r\n    firstUpdated(changed) {\r\n        super.firstUpdated(changed);\r\n        const me = this;\r\n        me.#mouseController.attach(me.#splitter);\r\n        //const shadow = GSDOM.root(me.target) instanceof ShadowRoot;\r\n        //me.dynamicStyle(me.#styleTGT, {}, !shadow);\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div ${ref(me.#elRef)} \r\n            @dblclick=\"${me.#onDoubleClick}\"\r\n            data-gs-class=\"${me.#styleID}\" \r\n            class=\"${classMap(me.renderClass())}\">\r\n            <slot></slot>\r\n        </div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            'splitter': true,\r\n            [me.#styleID]: true\r\n        }\r\n        return css;\r\n    }\r\n\r\n    updated(changedProperties) {\r\n        const me = this;\r\n        me.#cssUpdate();\r\n    }\r\n\r\n    /**\r\n    * Lock UI for mouse events to enable resizing over embedded iframes\r\n    * @param {MouseEvent} e \r\n    */\r\n    onStartMove(e) {\r\n        const me = this;\r\n        me.#cursor = me.isVertical ? e.clientX : e.clientY;\r\n        me.#lock(true);\r\n        GSEvents.send(globalThis, 'gs-split', { start: true });\r\n    }\r\n\r\n    /**\r\n     * Handles resizing based on mouse move event\r\n     * @param {MouseEvent} e \r\n     */\r\n    onMouseMove(e) {\r\n        const me = this;\r\n        const pos = me.isVertical ? e.clientX : e.clientY;\r\n        me.#updateMouse(pos);\r\n    }\r\n\r\n    /**\r\n     * Save last position and unlock mouse UI events when resizing finished\r\n     * @param {*} e \r\n     */\r\n    onEndMove(e) {\r\n        const me = this;\r\n        me.#save();\r\n        me.#lock(false);\r\n        GSEvents.send(globalThis, 'gs-split', { stop: true });\r\n    }\r\n\r\n    /**\r\n    * Check if splitter use vertical or hotizontal splitting\r\n    * @returns {Boolean}\r\n    */\r\n    get isVertical() {\r\n        return this.split === 'vertical';\r\n    }\r\n\r\n    get isHorizontal() {\r\n        return !this.isVertical;\r\n    }\r\n\r\n    /**\r\n     * Return preceding element\r\n     * @returns {HTMLElement}\r\n     */\r\n    get start() {\r\n        return this.previousElementSibling;\r\n    }\r\n\r\n    /**\r\n    * Return following element\r\n    * @returns {HTMLElement}\r\n    */\r\n    get end() {\r\n        return this.nextElementSibling;\r\n    }\r\n\r\n    /**\r\n     * Return closest element found\r\n     * @returns {HTMLElement}\r\n     */\r\n    get target() {\r\n        const me = this;\r\n        let el = me.#isPreceeding ? me.start : me.end;\r\n        el = el || me.parentElement;\r\n        el = GSDOM.isGSElement(el) ? el.self : el;\r\n        if (el instanceof ShadowRoot) {\r\n            // no firefox support\r\n            el = Array.from(el.children).filter(o => !GSDOM.isStyleValue(o, 'display', 'none')).pop();\r\n        }\r\n        el.classList?.add(me.#styleTGT);\r\n        return el;\r\n    }\r\n\r\n    get #isPreceeding() {\r\n        const me = this;\r\n        const resize = me.resize;\r\n        return resize === 'start' || resize === 'top';\r\n    }\r\n\r\n    get #splitter() {\r\n        return this.#elRef.value;\r\n    }\r\n\r\n    get #styleDynamic() {\r\n        return this.target.style;\r\n    }\r\n\r\n    /**\r\n     * Get elements which must be protected to allow mouse move over \r\n     */\r\n    get #lockable() {\r\n        const me = this;\r\n        const qry = 'iframe,embed,portal';\r\n        const p = GSDOM.queryAll(me.previousElementSibling, qry);\r\n        const n = GSDOM.queryAll(me.nextElementSibling, qry);\r\n        return [...p, ...n];\r\n    }\r\n\r\n    #load() {\r\n        const me = this;\r\n        if (!me.id) return;\r\n        const key = GSID.hashCode(location.origin + location.pathname);\r\n        let val = localStorage.getItem(`gs-splitter-${key}-${me.id}`);\r\n        val = GSUtil.asNum(val);\r\n        me.#update(val);\r\n    }\r\n\r\n    #save() {\r\n        const me = this;\r\n        if (!me.id) return;\r\n        const css = GSCSSMap.getComputedStyledMap(me.target);\r\n        const val = me.isVertical ? css.get('width') : css.get('height');\r\n        if (!val) return;\r\n        const key = GSID.hashCode(location.origin + location.pathname);\r\n        localStorage.setItem(`gs-splitter-${key}-${me.id}`, val);\r\n    }\r\n\r\n    #onDoubleClick(e) {\r\n\r\n        const me = this;\r\n        let csize = 0;\r\n        let key = '';\r\n\r\n        if (me.isVertical) {\r\n            key = 'width';\r\n            csize = me.target.clientWidth;\r\n        } else {\r\n            key = 'height';\r\n            csize = me.target.clientHeight;\r\n        }\r\n\r\n        let min = GSCSSMap.styleValue(me.target, `min-${key}`);\r\n        let max = GSCSSMap.styleValue(me.target, `max-${key}`);\r\n\r\n        min = GSUtil.asNum(min.value);\r\n        max = GSUtil.asNum(max.value);\r\n\r\n        if ((max - min) / 2 > csize) {\r\n            csize = max;\r\n        } else {\r\n            csize = min;\r\n        }\r\n        me.#update(csize);\r\n\r\n    }\r\n\r\n    /**\r\n     * Lock IFRAME,EMBED,PORTAL elements for mouse move events\r\n     * @param {*} lock \r\n     */\r\n    #lock(lock = true) {\r\n        const me = this;\r\n        const cls = 'pe-none';\r\n        if (lock) {\r\n            me.#lockable\r\n                .filter(el => !GSDOM.hasClass(el, 'pe-none'))\r\n                .forEach(el => {\r\n                    GSDOM.toggleClass(el, cls, true);\r\n                    el.dataset.gsSplitter = true;\r\n                });\r\n        } else {\r\n            me.#lockable\r\n                .filter(el => el.dataset.gsSplitter)\r\n                .forEach(el => {\r\n                    GSDOM.toggleClass(el, cls, false);\r\n                    delete el.dataset.gsSplitter;\r\n                });\r\n        }\r\n    }\r\n\r\n    #updateMouse(pos) {\r\n        const me = this;\r\n        requestAnimationFrame(() => {\r\n            if (me.isVertical) {\r\n                me.#updateX(pos);\r\n            } else {\r\n                me.#updateY(pos);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Calculate width based on mouse position\r\n     * @param {Number} pos \r\n     */\r\n    #updateX(pos) {\r\n        const me = this;\r\n        const target = me.target;\r\n        const dir = me.#isPreceeding ? 1 : -1;\r\n        let dx = (pos - me.#cursor) * dir;\r\n        dx = dx + target.clientWidth;\r\n        dx = dx < 0 ? 0 : dx;\r\n        me.#styleDynamic.width = dx + \"px\";\r\n        //me.dynamicStyle(me.#styleTGT, { width: dx + \"px\" }, true);\r\n        me.#cursor = pos;\r\n    }\r\n\r\n    /**\r\n     * Calculate height based on mouse position\r\n     * @param {Number} pos \r\n     */\r\n    #updateY(pos) {\r\n        const me = this;\r\n        const target = me.target;\r\n        const dir = me.#isPreceeding ? 1 : -1;\r\n        let dx = (pos - me.#cursor) * dir;\r\n        dx = dx + target.clientHeight;\r\n        dx = dx < 0 ? 0 : dx;\r\n        me.#styleDynamic.height = dx + \"px\";\r\n        //me.dynamicStyle(me.#styleTGT, { height: dx + \"px\" }, true);\r\n        me.#cursor = pos;\r\n    }\r\n\r\n    #update(val = 0) {\r\n        if (val <= 0) return\r\n        const me = this;\r\n        me.#cursor = val;\r\n        const key = me.isVertical ? 'width' : 'height';\r\n        me.#styleDynamic[key] = val + \"px\";\r\n        //me.dynamicStyle(me.#styleTGT, { [key]: val + \"px\" }, true);\r\n    }\r\n\r\n    #cssUpdate() {\r\n        const me = this;\r\n        const size = me.isVertical ? 'width' : 'height';\r\n        const full = me.isVertical ? 'height' : 'width';\r\n        const cursor = me.isVertical ? 'w-resize' : 'n-resize';\r\n        const opt = {\r\n            [size]: `${me.size}px`,\r\n            [full]: '100%',\r\n            'border-width': '1px',\r\n            cursor: cursor,\r\n            'border-color': 'darkgray',\r\n            'border-style': 'solid',\r\n            'background-color': 'lightgray',\r\n        };\r\n        me.dynamicStyle(me.#styleID, opt);\r\n    }\r\n\r\n    static {\r\n        this.define('gs-splitter');\r\n    }\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from '../../base/GSUtil.mjs';\r\nimport { GSNavItemElement } from '../NavItem.mjs';\r\n\r\n/**\r\n * Tab component (gs-tab), generate selectable/switchable tabs on a panel\r\n */\r\nexport class GSTabItemElement extends GSNavItemElement {\r\n\r\n  static properties = {\r\n    name: {}\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.css = this.#updateCSS + this.css;\r\n  }\r\n\r\n  get #updateCSS() {\r\n    const me = this;\r\n    return me.shouldUpdate() ? GSUtil.normalize(me.parentElement?.tabCSS) : '';\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    return this.owner?.tagName === 'GS-TAB-GROUP';\r\n  }\r\n\r\n  static {\r\n    this.define('gs-tab');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSDOM } from '../../base/GSDOM.mjs';\r\nimport { classMap, html, ifDefined } from '../../lib.mjs';\r\n\r\n/**\r\n * Container for individual tab; part of tabed panel\r\n */\r\nexport class GSTabPanelElement extends GSElement {\r\n\r\n  static properties = {\r\n    name: {},\r\n    template: {},\r\n    active: { type: Boolean, reflect : true }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.active = false;\r\n  }\r\n\r\n  shouldUpdate(changedProperties) {\r\n    return this.owner?.tagName === 'GS-TAB-GROUP';\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\" \r\n      class=\"${classMap(this.renderClass())}\">\r\n      <slot>\r\n      ${this.template ? html`<gs-template flat src=\"${this.template}\"></gs-template>` : ''}\r\n      </slot></div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'tab-pane': true,\r\n      'd-none' : !me.active,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  get owner() {\r\n    return this.closest('gs-tab-group') || GSDOM.component(this);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-tab-panel');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSID } from '../../base/GSID.mjs';\r\nimport { html, ifDefined } from '../../lib.mjs';\r\nimport { PlacementTypes } from '../../properties/placement.mjs';\r\nimport { GSNavElement } from '../Nav.mjs';\r\nimport { GSTabItemElement } from './Tab.mjs';\r\n\r\n/**\r\n * Panel with tabs component (gs-tab-group), generate childrens gs-tab and gs-tab-panel \r\n */\r\nexport class GSTabGroupElement extends GSNavElement {\r\n\r\n  static properties = {\r\n    panelCSS: { attribute: 'css-panel' },\r\n    tabCSS: { attribute: 'css-tab' },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    // link tabs and panels\r\n    me.queryAll('gs-tab').forEach(el => me.#findPanel(el));\r\n  }\r\n\r\n  initData() {\r\n    return this.settings(GSTabItemElement);\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    const me = this;\r\n    const tabEl = me.query('gs-tab[active],gs-tab[autofocus],gs-tab');\r\n    me.onSelected(tabEl);\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    return this.data.length > 0 || this.query('gs-tab');\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'd-flex': me.vertical\r\n    }\r\n    return css;\r\n  }\r\n\r\n  renderWrappedUI() {\r\n    const me = this;\r\n    const reverse = PlacementTypes.isAfter(me.placement);\r\n    const list = [super.renderWrappedUI('tabs'),\r\n    html`<div class=\"tab-content flex-fill ${me.panelCSS}\"  dir=\"${ifDefined(me.direction)}\">\r\n        <slot name=\"panels\"></slot>\r\n      </div>\r\n      <slot class=\"d-none\"></slot>`];\r\n    return reverse ? list.reverse() : list;\r\n  }\r\n\r\n  renderWrappedClass() {\r\n    const me = this;\r\n    const css = super.renderWrappedClass();\r\n    return me.mapCSS(me.tabCSS, css);\r\n  }\r\n\r\n  /**\r\n   * Render items based on data property (might be from gs-item)\r\n   * @returns \r\n   */\r\n  renderItems() {\r\n    return this.data.map(o => {\r\n      if (!o.name) o.name = GSID.id;\r\n      return html`<gs-tab generated\r\n        .active=\"${o.active}\"\r\n        .autofocus=\"${o.autofocus || o.active}\"\r\n        .disabled=\"${ifDefined(o.disabled)}\" \r\n        icon=\"${ifDefined(o.icon)}\"    \r\n        title=\"${ifDefined(o.title)}\"\r\n        name=\"${o.name}\"></gs-tab>`;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Render items based on data property (might be from gs-item)\r\n   * @returns \r\n   */\r\n  renderPanels() {\r\n    return this.data.map(o => {\r\n      if (!o.name) o.name = GSID.id;\r\n      return html`<gs-tab-panel name=\"${o.name}\" \r\n        template=\"${ifDefined(o.template)}\"></gs-tab-panel>`;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Filter navigable element\r\n   * @param {HTMLElement} el \r\n   */\r\n  isNavigable(el) {\r\n    return el?.tagName === 'GS-TAB';\r\n  }\r\n\r\n  /**\r\n   * Callback when tab selected\r\n   * @param {GSTabElement} el \r\n   */\r\n  onSelected(el) {\r\n    el?.click();\r\n    const panel = this.#findPanel(el);\r\n    if (panel) panel.active = true;\r\n  }\r\n\r\n  /**\r\n   * Callback when tab deselected\r\n   * @param {GSTabElement} el \r\n   */\r\n  onDeselected(el) {\r\n    const panel = this.#findPanel(el);\r\n    if (panel) panel.active = false;\r\n  }\r\n\r\n  /**\r\n   * Selected Tab node name is used to find the panel.\r\n   * If panel found, auto-link it with node element\r\n   * @param {GSTabElement} el \r\n   */\r\n  #findPanel(el) {\r\n    if (!el) return null;\r\n    const me = this;\r\n    const key = Symbol.for('gs-element');\r\n    const generated = false; // me.data?.length > 0;\r\n    let panel = el[key] || me.query(`gs-tab-panel[name=\"${el.name}\"]`, generated);\r\n    if (!el[key]) el[key] = panel;\r\n    return panel;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-tab-group');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, css, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color } from '../properties/color.mjs';\r\nimport { GSData } from '../base/GSData.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSDate } from '../base/GSDate.mjs';\r\n\r\n/**\r\n * A simple HTML Table rederer for read-only tabular data representation\r\n * For complex interactive dat use gs-table\r\n */\r\nexport class GSTableElement extends GSElement {\r\n\r\n  static #icons = ['sort-up', 'arrow-down-up', 'sort-down-alt'];\r\n\r\n  static styles = css`th:hover { opacity: 50% !important; }`;\r\n\r\n  static CELLS = {\r\n    align: {},\r\n    width: {},\r\n    width: {},\r\n    css: {},\r\n    title: {},\r\n    filter: { type: Boolean },\r\n    filterType: { attribute: 'filter-type' },\r\n    cssFilter: { attribute: 'css-filter' },\r\n    cssHeader: { attribute: 'css-header' },\r\n    ...GSData.PROPERTIES\r\n  }\r\n\r\n  static properties = {\r\n    storage: {},\r\n    color: { ...color },\r\n    colorHead: { ...color, attribute: 'head-color' },\r\n    colorSelect: { ...color, attribute: 'select-color' },\r\n    colorSort: { ...color, attribute: 'sort-color' },\r\n    stripedColumn: { type: Boolean, attribute: 'striped-column' },\r\n    cssFilter: { attribute: 'css-filter' },\r\n    cssHeader: { attribute: 'css-header' },\r\n    divider: { type: Boolean },\r\n    striped: { type: Boolean },\r\n    hover: { type: Boolean },\r\n    small: { type: Boolean },\r\n    grid: { type: Boolean },\r\n    borderless: { type: Boolean },\r\n\r\n    sort: { type: Array, state: true },\r\n    columns: { type: Array, state: true },\r\n    selections: { type: Array, state: true },\r\n    key: { type: Number, state: true },\r\n\r\n    data: { type: Array },\r\n    datacolumn: { type: Boolean },\r\n    multisort: { type: Boolean },\r\n    multiselect: { type: Boolean },\r\n    protected: { type: Boolean },\r\n    selectable: { type: Boolean },\r\n    sortable: { type: Boolean },\r\n  }\r\n\r\n  #config = [];\r\n  #sortOrder = [];\r\n\r\n  constructor() {\r\n    super();\r\n    this.headColor = 'secondary';\r\n    this.colorSelect = 'info';\r\n    this.columns = [];\r\n    this.selections = [];\r\n    this.data = [];\r\n    this.sort = [];\r\n    this.key = 0;\r\n  }\r\n\r\n  get selected() {\r\n    const me = this;\r\n    return me.data.filter((v, i) => me.selections.includes(i));\r\n  }\r\n\r\n  set search(val) {\r\n    const me = this;\r\n    if (me.storage) {\r\n      return me.dataController.search = val;\r\n    }\r\n  }\r\n\r\n  connectedCallback() {\r\n    const me = this;\r\n    me.#config = GSItem.proxify(me, GSTableElement.CELLS);\r\n    if (me.columns.length === 0) me.columns = me.#config.map(v => v.name);\r\n    super.connectedCallback();\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    super.disconnectedCallback();\r\n    this.data = [];\r\n    this.selections = [];\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'user-select-none': me.protected,\r\n      'table': true,\r\n      'table-sm': me.small,\r\n      'table-hover': me.hover,\r\n      'table-striped': me.striped,\r\n      'table-bordered': me.grid,\r\n      'table-borderless': me.borderless,\r\n      'table-striped-columns': me.stripedColumns,\r\n      [`table-${me.color}`]: me.color,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  firstUpdated() {\r\n    this.dataController?.read();\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    const me = this;\r\n    if (me.columns.length != me.sort.length) me.sort = Array(me.columns.length).fill(0);\r\n    if (me.datacolumn && me.data.length > 0) {\r\n      me.columns = me.data[0];\r\n      me.data = me.data.slice(1);\r\n    }\r\n    if (changed.has('multiselect') && !me.multiselect) me.selections = [];\r\n    if (changed.has('selectable') && !me.selectable) me.selections = [];\r\n    if (changed.has('sortable') || changed.has('multisort')) {\r\n      me.sort = Array(me.columns.length).fill(0);\r\n      me.#sortOrder = [];\r\n    }\r\n\r\n    super.willUpdate(changed);\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const headColor = me.colorHead ? `table-${me.colorHead}` : '';\r\n    return html`\r\n      <table  \r\n       dir=\"${ifDefined(me.direction)}\"\r\n       @keyup=\"${me.#onKeyUp}\"\r\n       @keydown=\"${me.#onKeyDown}\"\r\n       class=\"${classMap(me.renderClass())}\">\r\n        <thead class=\"${ifDefined(headColor)}\">\r\n          ${me.#renderFilters()}\r\n          <tr @click=${me.#onSort}>\r\n            ${me.columns.map((entry, index) => me.#renderColumn(entry, index))}\r\n          </tr>\r\n        </thead>\r\n        <tbody @click=${me.#onSelect} class=\"${me.divider ? 'table-group-divider' : ''}\" role=\"button\">\r\n          ${me.data.map((entry, index) => me.#renderRecord(entry, index))}\r\n          ${me.#renderEmpty()}\r\n        </tbody>\r\n      </table>\r\n      <slot name=\"extra\"></slot>\r\n    `;\r\n  }\r\n\r\n  onDataRead(data) {\r\n    const me = this;\r\n    me.data = data;\r\n    me.selections = [];\r\n\r\n    // update filtering\r\n    if (data.length > 0 && me.#hasFilters) {\r\n      me.#config.forEach((entry, index) => {\r\n        entry.columnType = me.#columType(index);\r\n      });\r\n    }\r\n  }\r\n\r\n  clear() {\r\n    this.#input.forEach(el => el.value = '');\r\n    this.dataController?.filter([]);\r\n  }\r\n\r\n  valueAt(row, cell) {\r\n    return this.data.length > row ? this.data[row][cell] : undefined;\r\n  }\r\n\r\n  get #input() {\r\n    return this.queryAll('th > input', true);\r\n  }\r\n\r\n  get #hasFilters() {\r\n    return this.#config.filter(o => o.filter).length > 0;\r\n  }\r\n\r\n  #columType(index) {\r\n    const me = this;\r\n    const cfg = me.#config[index];\r\n    const cell = me.valueAt(0, me.columns[index]);\r\n    cfg.type = cfg.type || 'text';\r\n    const cfgType = { 'string': 'text', 'currency': 'number', 'timestamp': 'datetime-local' }[cfg.type]\r\n    const dataType = cell instanceof Date ? 'date' : typeof cell;\r\n    return cell ? dataType : cfgType || cfg.type;\r\n  }\r\n\r\n  #renderFilters() {\r\n    const me = this;\r\n    return me.#hasFilters ? html`<tr>${me.columns.map((entry, index) => me.#renderFilter(entry, index))}</tr>` : '';\r\n  }\r\n\r\n  #renderFilter(cell, index) {\r\n    const me = this;\r\n    const cfg = me.#config[index];\r\n    if (!cfg?.filter) return html`<th></th>`;\r\n    let mask = '';\r\n    const isDate = cfg.columnType === 'date';\r\n    if (isDate) mask = cfg.format || GSUtil.getDateFormat(cfg.locale || GSUtil.locale);\r\n    const css = `${GSUtil.normalize(me.cssFilter)} ${GSUtil.normalize(cell.cssFilter)}`; \r\n\r\n    return html`<th .index=${index} @change=\"${me.#onFilter}\">\r\n        <input is=\"gs-ext-input\" .index=${index}\r\n            class=\"form-control ${css}\" \r\n            mask=\"${ifDefined(mask)}\"\r\n            name=\"${cell}\" \r\n            type=\"${cfg.filterType || cfg.columnType}\"\r\n            data-slots=\"${ifDefined(isDate ? 'DMY' : undefined)}\">\r\n        </th>`;\r\n  }\r\n\r\n  #renderColumn(cell, index) {\r\n    const me = this;\r\n    const cfg = me.#config[index];\r\n    const css = `${GSUtil.normalize(me.cssHeader)} ${GSUtil.normalize(cell.cssHeader)}`; \r\n    return html`\r\n      <th .index=${index} class=\"${css}\" width=\"${ifDefined(me.#config[index]?.width)}\">\r\n        <div class=\"d-flex justify-content-between\"> \r\n          <span>${cfg?.title || cell}</span>\r\n          ${me.#renderIcon(index)}\r\n        </div>\r\n      </th>\r\n    `\r\n  }\r\n\r\n  #renderIcon(index) {\r\n    const me = this;\r\n    if (!me.sortable) return '';\r\n    const icons = GSTableElement.#icons;\r\n    const sortType = me.sort[index];\r\n    const order = me.multisort ? me.#sortOrder.indexOf(index) + 1 : '';\r\n    return html`<gs-icon name=\"${icons[sortType + 1]}\" super=\"${order > 0 ? order : ''}\" color=\"${ifDefined(me.colorSort)}\"></gs-icon>`;\r\n  }\r\n\r\n  #renderRecord(entry, index) {\r\n    const me = this;\r\n    if (!Array.isArray(entry)) entry = me.columns.map(v => entry[v]);\r\n    entry = entry.map((val, i) => me.#config[i] ? GSData.format(me.#config[i], val) : val);\r\n    const color = me.colorSelect && me.selections.includes(index) ? `table-${me.colorSelect}` : '';\r\n    return html`\r\n        <tr .index=${index} class=\"${color}\" tabindex=\"0\">\r\n          ${entry.map((cell, i) => html`<td class=\"text-${me.#config[i]?.align}\"><span>${cell}</span></td>`)}\r\n        </tr>\r\n      `;\r\n  }\r\n\r\n  #renderEmpty() {\r\n    const me = this;\r\n    if (me.data.length > 0 ) return '';\r\n    return html`<tr data-ignore=\"true\"><td colspan=\"${me.columns.length}\" class=\"text-center fw-bold text-muted\">${me.translate('No Data')}</td></tr>`;\r\n\r\n  }\r\n\r\n  #onFilter(e) {\r\n    const me = this;\r\n    const filter = me.#input\r\n      .map(el => {\r\n        if (!el.value) return undefined;\r\n        const isDate = el.type === 'date';\r\n        const val = isDate ? el.valueAsDate : el.value;\r\n        const cfg = me.#config[el.index];\r\n        return { name: el.name, value: val, locale : cfg?.locale }\r\n      })\r\n      .filter(el => el?.value);\r\n    me.dataController.filter(filter);\r\n  }  \r\n\r\n  #onSort(e) {\r\n    const me = this;\r\n    if (!me.sortable) return;\r\n    const icon = e.target.tagName === 'GS-ICON' ? e.target : e.target.closest('gs-icon');\r\n    const column = e.target.closest('th');\r\n    if (!icon || !column) return;\r\n    const idx = column.index !== undefined ? column.index : GSDOM.getElementIndex(column);\r\n    const current = me.sort[idx];\r\n    const sortType = current === 1 ? -1 : current + 1;\r\n\r\n    if (me.multisort) {\r\n      if (sortType == 0) {\r\n        me.#sortOrder = me.#sortOrder.filter(v => v != idx);\r\n      } else if (!me.#sortOrder.includes(idx)) {\r\n        me.#sortOrder.push(idx);\r\n      }\r\n    } else {\r\n      me.sort = Array(me.columns.length).fill(0);\r\n      me.#sortOrder = [idx];\r\n    }\r\n\r\n    me.sort[idx] = sortType;\r\n\r\n    const sort = me.#prepareSorter(me.sort, me.#sortOrder);\r\n\r\n    if (me.storage) {\r\n      return me.dataController.sort(sort);\r\n    }\r\n\r\n    me.data = GSData.sortData(me.data, sort);\r\n    me.emit('sort');\r\n  }\r\n\r\n  #prepareSorter(sort, sortOrder) {\r\n    const me = this;\r\n\r\n    if (sort.filter(v => v).length === 0) {\r\n      sort = Array(me.columns.length).fill(0);\r\n      sort[me.key] = 1;\r\n    }\r\n\r\n    // if data record is object (not simple array)\r\n    const isComplex = me.data[0] && !Array.isArray(me.data[0]);\r\n\r\n    // sort list \r\n    const list = sort.map((v, i) => v ? { name: isComplex ? me.columns[i] : undefined, col: i, ord: v, idx: sortOrder.indexOf(i) } : null).filter(v => v);\r\n\r\n    // order sort list by idx\r\n    sort = GSData.sortData(list, [{ name: 'idx', ord: 1 }]);\r\n\r\n    return sort;\r\n  }\r\n\r\n  #onSelect(e) {\r\n    const me = this;\r\n    if (!me.selectable) return;\r\n    const tr = e.target.tagName === 'TR' ? e.target : e.target.closest('tr');\r\n    if (!tr) return;\r\n    const isSelected = me.selections.includes(tr.index);\r\n    if (me.multiselect) {\r\n      if (isSelected) {\r\n        me.selections = me.selections.filter(v => v != tr.index);\r\n      } else {\r\n        me.selections.push(tr.index);\r\n        me.requestUpdate();\r\n      }\r\n    } else {\r\n      me.selections = isSelected ? [] : [tr.index];\r\n    }\r\n    me.emit('select');\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n\r\n    if (!e.target.matches('tbody tr')) return;\r\n    let el = null;\r\n\r\n    switch (e.code) {\r\n      case 'ArrowUp':\r\n        el = e.target.previousElementSibling;\r\n        break;\r\n      case 'ArrowDown':\r\n        el = e.target.nextElementSibling;\r\n        break;\r\n    }\r\n\r\n    if (el) {\r\n      el.focus();\r\n      this.emit('focus', el);\r\n    }\r\n  }\r\n\r\n  #onKeyUp(e) {\r\n    if (e.code === 'Space') this.#onSelect(e);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-table');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSTag class\r\n * @module components/GSTag\r\n */\r\n\r\nimport { createRef, ref, classMap, css, html, ifDefined } from '../lib.mjs';\r\nimport { stringArrayConverter, color } from '../properties/index.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\n\r\n/**\r\n * Tag list element\r\n * \r\n * @class\r\n * @extends {GSTagElement}\r\n */\r\nexport default class GSTagElement extends GSElement {\r\n\r\n    static #KEYS = ['Enter', 'NumpadEnter', 'Comma', 'Space'];\r\n\r\n    static styles = css`\r\n        .tag-input:focus-visible {\r\n            outline:none;\r\n        }\r\n        .tag .btn-close {\r\n            background: none;\r\n        }            \r\n        .tag .btn-close::after {\r\n            content: 'x';\r\n        }`;\r\n\r\n    static properties = {\r\n        placeholder: {},\r\n        max: { type: Number },\r\n        size: { type: Number },\r\n        name: {},\r\n        data: { type: Array },\r\n        values: { type: Array, reflect: true, converter: stringArrayConverter },\r\n        appendable: { type: Boolean },\r\n        color: { ...color },\r\n        closeColor: { ...color, attribute: 'close-color' },\r\n        cssClose: { attribute: 'css-close' },\r\n        cssTag: { attribute: 'css-tag' },\r\n    }\r\n\r\n    // GS-ITEM attributes mapping\r\n    static options = {\r\n        name: {}\r\n    }\r\n\r\n    #dataListRef = createRef();\r\n    #inputRef = createRef();\r\n\r\n    constructor() {\r\n        super();\r\n        this.name = '';\r\n        this.data = this.#items;\r\n        this.closeColor = 'light';\r\n        this.color = 'primary';\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        const tags = me.#renderTags();\r\n        return html`\r\n        <div  dir=\"${ifDefined(me.direction)}\" \r\n            class=\"${classMap(me.renderClass())}\"\r\n            @click=\"${me.#onClick.bind(me)}\">\r\n            ${tags}\r\n            <input type=\"text\" \r\n            @keydown=\"${me.#onKeyDown.bind(me)}\"\r\n            @input=\"${me.#onInput.bind(me)}\"\r\n            ${ref(me.#inputRef)}\r\n            name=\"${me.name}\" \r\n            list=\"${me.name}_list\"\r\n            class=\"form-control d-flex w-auto flex-grow-1\" \r\n            placeholder=\"${me.#info}\">\r\n            <datalist ${ref(me.#dataListRef)} id=\"${me.name}_list\">${me.#renderList()}</datalist>\r\n        </div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            \"d-flex\": true,\r\n            \"flex-wrap\": true,\r\n            \"align-items-center\": true,\r\n            \"gap-1 \": true,\r\n        }\r\n        return css;\r\n    }\r\n\r\n    get #info() {\r\n        const me = this;\r\n        const alt = me.max > 0 ? `Add max ${me.max} tags...` : '';\r\n        return me.placeholder ? me.placeholder : alt;\r\n    }\r\n\r\n    #onInput(e) {\r\n        if (!e.inputType) this.#updateTag(e);\r\n    }\r\n\r\n    #onKeyDown(e) {\r\n        if (GSTagElement.#KEYS.includes(e.code)) this.#updateTag(e);\r\n    }\r\n\r\n    #onClick(e) {\r\n        const isClose = e.srcElement === e.target && e.target instanceof HTMLButtonElement;\r\n        if (isClose) this.#removeTag(e.target.parentElement);\r\n    }\r\n\r\n    #updateTag(e) {\r\n        GSEvents.prevent(e);\r\n        const me = this;\r\n        me.#addTag(me.#selected);\r\n    }\r\n\r\n    get #isMax() {\r\n        const me = this;\r\n        return me.max > 0 && me.data.length >= me.max;\r\n    }\r\n\r\n    get #options() {\r\n        return Array.from(this.#datalist.children);\r\n    }\r\n\r\n    get #selected() {\r\n        const me = this;\r\n        return me.#options.filter(el => el.value.toLowerCase() === me.#input.value.toLowerCase()).pop();\r\n    }\r\n\r\n    #addTag(optEl) {\r\n        const me = this;\r\n        const fld = me.#input;\r\n        if (me.#isMax || (!optEl && me.appendable == false)) {\r\n            fld.value = '';\r\n            return;\r\n        }\r\n        if (!me.values.includes(fld.value)) {\r\n            me.values.push(fld.value);\r\n            fld.value = '';\r\n            me.requestUpdate();\r\n        }\r\n    }\r\n\r\n    #removeTag(tagEl) {\r\n        if (!tagEl) return;\r\n        const me = this;\r\n        const value = tagEl.dataset.value;\r\n        me.values = me.values.filter(v => v != value);\r\n    }\r\n\r\n    #renderTags() {\r\n        const me = this;\r\n        return me.values.map(v => me.#renderTag(v));\r\n    }\r\n\r\n    #renderTag(val = '') {\r\n        if (!val) return '';\r\n        const me = this;\r\n        const size = me.size > 0 ? `fs-${me.size}` : '';\r\n        return html`<div class=\"${classMap(me.#tagClass)}\" data-value=\"${val}\">${val}<button type=\"button\" class=\"${classMap(me.#btnClass)}\"></button></div>`;\r\n    }\r\n\r\n    get #tagClass() {\r\n        const me = this;\r\n        const opt = {\r\n            badge: true,\r\n            tag: true,\r\n            [`fs-${me.size}`]: me.size > 0,\r\n            [`bg-${me.color}`]: me.color ? true : false\r\n        }\r\n        return me.mapCSS(me.cssTag, opt);\r\n    }\r\n\r\n    get #btnClass() {\r\n        const me = this;\r\n        const opt = {\r\n            'btn-close': true,\r\n            'ms-1': true,\r\n            [`bg-${me.closeColor}`]: me.closeColor ? true : false\r\n        }\r\n        return me.mapCSS(me.cssClose, opt);\r\n    }\r\n\r\n    #renderList() {\r\n        const me = this;\r\n        return me.data.map(v => html`<option value=\"${v}\">`);\r\n    }\r\n\r\n    /**\r\n     * Proxify GS-ITEM elements to easily read attributes\r\n     */\r\n    #proxify(root) {\r\n        return GSItem.collect(root).map(el => GSAttr.proxify(el));\r\n    }\r\n\r\n    get #items() {\r\n        return this.#proxify(this).map(el => el.name).filter(v => v ? true : false);\r\n    }\r\n\r\n    get #input() {\r\n        return this.#inputRef.value;\r\n    }\r\n\r\n    get #datalist() {\r\n        return this.#dataListRef.value;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-tag');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSTextElement extends GSElement {\r\n\r\n  #text = \"\";\r\n\r\n  constructor() {\r\n    super();\r\n    this.flat = true;\r\n    this.#text = this.innerText;\r\n    this.innerText = \"\";\r\n  }\r\n\r\n  renderUI() {\r\n    return this.translate(this.#text);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-text');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, ref, classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { placement } from '../properties/index.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSPopper } from '../base/GSPopper.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\n\r\nexport class GSTooltipElement extends GSElement {\r\n\r\n  static properties = {\r\n    placement: { ...placement },\r\n    title: {},\r\n    target: {},\r\n    opened: { type: Boolean },\r\n    local: { type: Boolean },\r\n  }\r\n\r\n  #arrowRef = createRef();\r\n  #panelRef = createRef();\r\n  #styleID = GSID.id;\r\n  #arrowStyle = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    this.placement = 'top';\r\n    this.dynamicStyle(this.#styleID);\r\n    this.dynamicStyle(this.#arrowStyle);\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.connectedCallback();\r\n    const me = this;\r\n    me.#attachEvents();\r\n    me.#reposition();\r\n    super.firstUpdated(changed);\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    this.#reposition();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`\r\n    <div ${ref(me.#panelRef)} \r\n      dir=\"${ifDefined(me.direction)}\"\r\n      role=\"tooltip\"\r\n      data-popper-placement=\"${me.placement}\"\r\n      data-gs-class=\"${me.#styleID}\"\r\n      class=\"${classMap(me.renderClass())}\">\r\n      <div ${ref(me.#arrowRef)} \r\n          class=\"tooltip-arrow ${me.#arrowStyle}\" \r\n          data-gs-class=\"${me.#arrowStyle}\">\r\n      </div>\r\n      <div class=\"tooltip-inner\">${me.translate(me.title)}</div>\r\n    </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'tooltip': true,\r\n      'bs-tooltip-auto': true,\r\n      'fade': true,\r\n      'show': me.opened,\r\n      [me.#styleID]: true\r\n    }\r\n    return css;\r\n  }\r\n\r\n  open() {\r\n    this.opened = true;\r\n  }\r\n\r\n  close() {\r\n    this.opened = false;\r\n  }\r\n\r\n  toggle() {\r\n    this.opened = !this.opened;\r\n  }\r\n\r\n  #attachEvents() {\r\n    const me = this;\r\n    me.attachEvent(me.#ref, 'mouseenter', me.open.bind(me));\r\n    me.attachEvent(me.#ref, 'mouseleave', me.close.bind(me));\r\n  }\r\n\r\n  #reposition() {\r\n    const me = this;\r\n    const arrowEl = me.#arrow;\r\n    const panelEl = me.#panel;\r\n    if (!panelEl) return;\r\n    if (me.opened) {\r\n      GSPopper.popupFixed(me.placement, panelEl, me.#ref, arrowEl);\r\n    } else {\r\n      me.dynamicStyle(me.#styleID, { top: '-1000px', left: '-1000px' });\r\n    }\r\n  }\r\n\r\n  get #ref() {\r\n    const me = this;\r\n    switch (me.target) {\r\n      case '@parent':\r\n        return this.parentElement;\r\n      case '@previous':\r\n        return this.previousElementSibling;\r\n      case '@next':\r\n        return this.nextElementSibling;\r\n      default:\r\n        return me.local ? me.#refLocal : me.#refGlobal;\r\n    }\r\n  }\r\n\r\n  get #refLocal() {\r\n    const root = GSDOM.root(this);\r\n    return GSDOM.query(root, this.target);\r\n  }\r\n  \r\n  get #refGlobal() {\r\n    return GSDOM.query(document.body, this.target);\r\n  }\r\n\r\n  get #arrow() { return this.#arrowRef.value; }\r\n  get #panel() { return this.#panelRef.value; }\r\n\r\n  static {\r\n    this.define('gs-tooltip');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { notEmpty } from '../properties/index.mjs';\r\n\r\nexport class GSTemplateElement extends GSElement {\r\n\r\n  static properties = {\r\n    src: { reflect: true, hasChanged: notEmpty }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  createRenderRoot() {\r\n    const me = this;\r\n    if (me.flat) {\r\n      me.renderOptions.renderBefore = me;\r\n      return me.parentElement;\r\n    }\r\n    return super.createRenderRoot();\r\n  }\r\n\r\n  renderUI() {\r\n    return html`${this.renderTemplate()}`;\r\n  }\r\n\r\n\ttemplateInjected() {\r\n\t\tthis.emit('template-injected', null, true, true);\r\n\t}\r\n\r\n  static {\r\n    this.define('gs-template');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../../../base/GSUtil.mjs\";\r\n\r\n/**\r\n * Handle automatic field value copy and select\r\n */\r\nexport class CopySelectController {\r\n\r\n  #host;\r\n\r\n  #clickCallback;\r\n  #copyCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#clickCallback = me.#onClick.bind(me);\r\n    me.#copyCallback = me.#onCopy.bind(me);\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.#host.on('click', me.#clickCallback);\r\n    me.#host.on('copy', me.#copyCallback);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host.off('click', me.#clickCallback);\r\n    me.#host.off('copy', me.#copyCallback);\r\n  }\r\n\r\n  #onCopy() {\r\n    GSUtil.writeToClipboard(this.#host.value);\r\n  }\r\n\r\n  #onClick(e) {\r\n      const me = this;\r\n      if (me.#host.autocopy) GSUtil.writeToClipboard(me.#host.value);\r\n      if (me.#host.autoselect) me.#host.select();\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Handle field mask \r\n */\r\nexport class MaskController {\r\n\r\n  static #special = '.^$*+?()[]{}\\|';\r\n\r\n  static #maskType = {\r\n    x: /[0-9a-fA-F]/g,\r\n    n: /[0-9]/g,\r\n    y: /[0-9]/g,\r\n    m: /[0-9]/g,\r\n    d: /[0-9]/g,\r\n    h: /[0-9]/g,\r\n    s: /[0-9]/g,\r\n    '.': /[0-9]/g,\r\n    '#': /[a-zA-Z]/g,\r\n    '*': /[0-9a-zA-Z]/g,\r\n    '_': /./g\r\n  };\r\n\r\n  #back = false;\r\n  #slots;\r\n  #prev;\r\n  #first;\r\n  #accept;\r\n  #pattern;\r\n\r\n  #host;\r\n\r\n  #keyDownCallback;\r\n  #inputCallback;\r\n  #focusCallback;\r\n  #blurCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#keyDownCallback = me.#onKeyDown.bind(me);\r\n    me.#inputCallback = me.#format.bind(me);\r\n    me.#focusCallback = me.#onFocus.bind(me);\r\n    me.#blurCallback = me.#onBlur.bind(me);\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.initRules();\r\n    me.#host.on('keydown', me.#keyDownCallback);\r\n    me.#host.on('input', me.#inputCallback);\r\n    me.#host.on('focus', me.#focusCallback);\r\n    me.#host.on('blur', me.#blurCallback);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host.off('keydown', me.#keyDownCallback);\r\n    me.#host.off('input', me.#inputCallback);\r\n    me.#host.off('focus', me.#focusCallback);\r\n    me.#host.off('blur', me.#blurCallback);\r\n  }\r\n\r\n  initRules() {\r\n    const me = this;\r\n    if (!me.pattern) return;\r\n    me.#slots = me.#builSlots();\r\n    me.#prev = (j => Array.from(me.pattern, (c, i) => me.#slots.has(c) ? j = i + 1 : j))(0);\r\n    me.#first = [...me.pattern].findIndex(c => me.#slots.has(c));\r\n    me.#accept = me.#builAccept();\r\n    me.#toPattern();    \r\n  }\r\n  \r\n  validate() {\r\n    const me = this;\r\n    me.setCustomValidity('');\r\n    me.#pattern.lastIndex = 0;\r\n    const isMatch = me.required ? me.#pattern.test(me.raw) : true;\r\n    const isValid = isMatch && me.checkValidity();\r\n    if (!isMatch) me.setCustomValidity('Data did not match pattern!');\r\n    if (!isValid) me.reportValidity();\r\n    return isValid;\r\n  }\r\n\r\n  checkValidity() {\r\n    return this.#host.checkValidity();\r\n  }\r\n\r\n  setCustomValidity(val) {\r\n    return this.#host.setCustomValidity(val);\r\n  }\r\n\r\n  reportValidity() {\r\n    return this.#host.reportValidity();\r\n  }\r\n\r\n  setSelectionRange(i, j) {\r\n    this.#host.setSelectionRange(i, j);\r\n  }\r\n  \r\n  select() {\r\n    this.#host.select();\r\n  }\r\n\r\n  get value() {\r\n    const [i, j] = this.#range();\r\n    return this.raw.substring(0, j);\r\n  }\r\n\r\n  set value(val) {\r\n    this.#host.value = val;\r\n  }\r\n\r\n  get raw() {\r\n    return this.#host.raw;\r\n  }\r\n\r\n  get required() {\r\n    return this.#host.required;\r\n  }\r\n\r\n  get pattern() {\r\n    return this.#host.mask;\r\n  }\r\n\r\n  get dataset() {\r\n    return this.#host.dataset;\r\n  }\r\n\r\n  get selectionStart() {\r\n    return this.#host.selectionStart;\r\n  }\r\n\r\n  get selectionEnd() {\r\n    return this.#host.selectionEnd;\r\n  }\r\n\r\n  get autoselect() {\r\n    return this.#host.autoselect;\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n    this.#back = e.key === \"Backspace\";\r\n  }\r\n\r\n  #onFocus(e) {\r\n    const me = this;\r\n    me.#format(e);\r\n    if (me.autoselect) me.select();\r\n  }\r\n\r\n  #onBlur(e) {\r\n    // me.value === me.pattern && (me.value = \"\");\r\n    this.validate();\r\n  }\r\n\r\n  /**\r\n   * If data-slots not defined, try to detect automatically\r\n   * @returns \r\n   */\r\n  #builSlots() {\r\n    const me = this;\r\n    let slots = me.dataset.slots;\r\n    if (!slots) {\r\n      const maskType = MaskController.#maskType;\r\n      slots = [...new Set(me.pattern)]\r\n        .filter(v => maskType[v.toLowerCase()])\r\n        .join('');\r\n    }\r\n    return new Set(slots || \"_\");\r\n  }\r\n\r\n  /**\r\n   * If data-accept not defined, try to detect automatically\r\n   * @returns \r\n   */\r\n  #builAccept() {\r\n    const me = this;\r\n    let accept = me.dataset.accept;\r\n    if (!accept) {\r\n      const maskType = MaskController.#maskType;\r\n      accept = [...new Set(me.pattern)]\r\n      .map(v => maskType[v.toLowerCase()])\r\n      .filter(v => v);\r\n      if (accept.length > 0) {\r\n        const tmp = {};\r\n        accept.forEach(v => tmp[v.src] = v);\r\n        accept = Object.values(tmp);\r\n        return accept.length === 1 ? accept.pop() : accept;\r\n      } \r\n\r\n    }\r\n    return new RegExp(accept || \"\\\\d\", \"g\");\r\n  }\r\n\r\n  #range() {\r\n    const me = this;\r\n    const value = me.raw;\r\n    return [me.selectionStart, me.selectionEnd].map(i => {\r\n      i = me.#clean(value.slice(0, i)).findIndex(c => me.#slots.has(c));\r\n      return i < 0 ? me.#prev[me.#prev.length - 1] : me.#back ? me.#prev[i - 1] || me.#first : i;\r\n    });\r\n  }\r\n\r\n  #format(e) {\r\n    const me = this;\r\n    const [i, j] = me.#range();\r\n    me.value = me.#clean(me.#host.raw).join``;\r\n    me.setSelectionRange(i, j);\r\n    me.#back = false;\r\n  }\r\n\r\n  //  TODO support multi #accecpt\r\n  #clean(input) {\r\n    const me = this;\r\n    input = input.match(me.#accept) || [];\r\n    return Array.from(me.pattern, c => input[0] === c || me.#slots.has(c) ? input.shift() || c : c);\r\n  }\r\n\r\n  #toPattern() {\r\n\r\n    const me = this;\r\n\r\n    if (me.pattern.length === 0) return;\r\n\r\n    const chars = me.pattern.split('');\r\n    const masks = ['^'];\r\n\r\n    const maskType = MaskController.#maskType;\r\n    const special = MaskController.#special;\r\n\r\n    let cnt = 0;\r\n    chars.forEach((v, i) => {\r\n      const m = maskType[v.toLowerCase()];\r\n      if (!m) {\r\n        if (cnt > 0) masks.push(`{${++cnt}}`);\r\n        cnt = 0;\r\n        if (special.includes(v)) masks.push('\\\\');\r\n        return masks.push(v);\r\n      }\r\n\r\n      chars[i] = new RegExp(m, 'g');\r\n\r\n      if (masks.length === 0) return masks.push(m.source);\r\n\r\n      if (masks[masks.length - 1] === m.source) return cnt++;\r\n\r\n      if (cnt > 0) masks.push(`{${++cnt}}`);\r\n      cnt = 0;\r\n      masks.push(m.source);\r\n    });\r\n\r\n    if (cnt > 0) masks.push(`{${++cnt}}`);\r\n    masks.push('$');\r\n\r\n    me.#pattern = new RegExp(masks.join(''), 'g');\r\n    // me.#max = me.pattern.length;\r\n    // me.#masks = chars;\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../../../base/GSUtil.mjs\";\r\n\r\n/**\r\n * Handle for input type number to support max length entry\r\n */\r\nexport class NumberController {\r\n\r\n  #host;\r\n\r\n  #inputCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#inputCallback = me.#onInput.bind(me);\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.#host.on('input', me.#inputCallback);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host.off('input', me.#inputCallback);\r\n  }\r\n\r\n  get maxLength() {\r\n    return GSUtil.asNum(this.#host.maxLength, 0);\r\n  }\r\n\r\n  get value() {\r\n    return this.#host.value;\r\n  }\r\n\r\n  set value(val) {\r\n    this.#host.value = val;\r\n  }\r\n\r\n  get type() {\r\n    return this.#host?.type;\r\n  }\r\n    \r\n  #onInput(e) {\r\n    const me = this;\r\n    if (me.type === 'number') return me.#onNumberInput(e);\r\n  }\r\n\r\n  #onNumberInput(e) {\r\n    const me = this;\r\n    if (me.maxLength > 0 && me.value.length > me.maxLength) {\r\n        me.value = me.value.substring(0, me.maxLength);\r\n    }\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Handle for input tpye password tosupport keyboard shortcut for password reveal.\r\n */\r\nexport class PasswordController {\r\n\r\n  #host;\r\n\r\n  #revealing = false;\r\n\r\n  #keyUpCallback;\r\n  #keyDownCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#keyUpCallback = me.#onKeyUp.bind(me);\r\n    me.#keyDownCallback = me.#onKeyDown.bind(me);\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.#host.on('keyup', me.#keyUpCallback);\r\n    me.#host.on('keydown', me.#keyDownCallback);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host.off('keyup', me.#keyUpCallback);\r\n    me.#host.off('keydown', me.#keyDownCallback);\r\n  }\r\n\r\n  get reveal() {\r\n    return this.#host.hasAttribute('reveal');\r\n  }\r\n\r\n  get type() {\r\n    return this.#host?.type;\r\n  }\r\n\r\n  set type(val) {\r\n    if (this.#host) this.#host.type = val;\r\n  }\r\n\r\n  #isReveal(e) {\r\n    return this.reveal && e.key === 'Shift' && e.altKey && e.shiftKey && this.type === 'password';\r\n  }\r\n\r\n  #onKeyUp(e) {\r\n    const me = this;\r\n    if (e.key === 'Shift' && me.#revealing) {\r\n      me.type = 'password';\r\n    }\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n    const me = this;\r\n    if (me.#isReveal(e)) {\r\n      me.#revealing = true;\r\n      me.type = 'text';\r\n    }\r\n  }\r\n}  ","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSCSSMap } from \"../../../base/GSCSSMap.mjs\";\r\nimport { GSUtil } from \"../../../base/GSUtil.mjs\";\r\n\r\n/**\r\n * Handle for input type text to support text value changes based on CSS\r\n */\r\nexport class TextController {\r\n\r\n  #host;\r\n\r\n  #inputCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#inputCallback = me.#onInput.bind(me);\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.#host.on('input', me.#inputCallback);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host.off('input', me.#inputCallback);\r\n  }\r\n\r\n  get value() {\r\n    return this.#host.value;\r\n  }\r\n\r\n  set value(val) {\r\n    this.#host.value = val;\r\n  }\r\n\r\n  get type() {\r\n    return this.#host?.type;\r\n  }\r\n\r\n  #onInput(e) {\r\n    const me = this;\r\n    if (me.type === 'text') me.value = me.#updateText(me.value);\r\n  }\r\n\r\n  #updateText(value = '') {\r\n    const map = GSCSSMap.styleValue(this.#host, 'text-transform');\r\n    if (map) value = GSUtil.textTransform(map.value, value);\r\n    return value;\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSAttr } from \"../../../base/GSAttr.mjs\";\r\nimport { GSDOM } from \"../../../base/GSDOM.mjs\";\r\nimport { GSEvents } from \"../../../base/GSEvents.mjs\";\r\n\r\n/**\r\n * Handle data filtering for list atribute, and linked fields.\r\n * Changes in one field list, update avaialble selections in another field selections.\r\n */\r\nexport class ListController {\r\n\r\n  #host;\r\n\r\n  #monitorCallback;\r\n  #changeCallback;\r\n  #blurCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#blurCallback = me.#onBlur.bind(me);\r\n    me.#monitorCallback = me.#onMonitor.bind(me);\r\n    me.#changeCallback = me.#onDataChange.bind(me);\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    const list = me.list;\r\n    if (list) {\r\n      me.#host.on('blur', me.#blurCallback);\r\n      me.#host.on('change', me.#changeCallback);\r\n      me.#host.attachEvent(me.filter, 'change', me.#monitorCallback);\r\n    }\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host.off('blur', me.#blurCallback);\r\n    me.#host.off('change', me.#changeCallback);\r\n    me.#host.removeEvent(me.filter, 'change', me.#monitorCallback);\r\n  }\r\n\r\n  hostUpdated() {\r\n    // trigger only first time\r\n    if (!this.#host.hasUpdated) {\r\n      this.#onDataChange();\r\n    }\r\n  }\r\n\r\n  get value() {\r\n    return this.#host.value;\r\n  }\r\n\r\n  set value(val) {\r\n    this.#host.value = val;\r\n  }\r\n\r\n  get list() {\r\n    const me = this;\r\n    if (me.#host.list) return me.#host.list;\r\n    const list = GSAttr.get(me.#host, 'list');\r\n    return GSDOM.getByID(me.#host.owner, list);\r\n  }\r\n\r\n  get filter() {\r\n    const me = this;\r\n    const filter = GSAttr.get(me.#host, 'data-filter');\r\n    return GSDOM.getByID(me.#host.owner, filter);\r\n  }\r\n\r\n  get owner() {\r\n    return this.#host.owner;\r\n  }\r\n\r\n  get strict() {\r\n    return GSAttr.get(this.#host, 'strict', '');\r\n  }\r\n\r\n  #onBlur(e) {\r\n    if (!this.#isInList()) GSEvents.send(this.#host, 'strict', { ok: false, source: e });\r\n  }\r\n\r\n  #onDataChange(e) {\r\n    const me = this;\r\n    const own = me.owner;\r\n    let opt = GSDOM.query(me.list, `option[value=\"${me.value}\"]`);\r\n    let clean = false;\r\n    if (!opt) {\r\n        opt = me.list?.querySelector('option');\r\n        clean = true;\r\n    }\r\n\r\n    const obj = opt?.dataset || {};\r\n    Object.entries(obj).forEach(p => {\r\n        const val = clean ? '' : p[1];\r\n        const key = p[0];\r\n        GSAttr.set(me.#host, `data-${key}`, p[1]);\r\n        if (key === 'id' || key === 'group') return;\r\n\r\n        const filter = `[data-${key}]:not([data-${key}=\"\"]`;\r\n        const els = Array.from(GSDOM.queryAll(own, filter));\r\n        els.filter(el => el.tagName !== 'OPTION')\r\n            .filter(el => el !== me)\r\n            .filter(el => GSAttr.get(el, 'list').length === 0)\r\n            .forEach(el => me.#togleEl(el, key, val))\r\n    });\r\n  }\r\n\r\n  #onMonitor(e) {\r\n    const me = this;\r\n    const list = me.list;\r\n    me.value = '';\r\n    const dataGroup = GSAttr.get(me.filter, 'data-group');\r\n    GSDOM.queryAll(list, 'option').forEach(el => GSAttr.set(el, 'disabled', true));\r\n    const filter = dataGroup ? `option[data-group=\"${dataGroup}\"]` : `option[data-id=\"${e.target.value}\"]`;\r\n    GSDOM.queryAll(list, filter).forEach(el => GSAttr.set(el, 'disabled'));\r\n\r\n  }\r\n\r\n  #togleEl(el, key = '', value = '') {\r\n\r\n    const data = GSAttr.get(el, `data-${key}`, '').split(/[,;;]/);\r\n    const isMatch = value.length > 0 && data.includes(value);\r\n    const frmel = GSDOM.isFormElement(el) || GSDOM.isButtonElement(el);\r\n\r\n    if (frmel) {\r\n      GSAttr.toggle(el, 'disabled', !isMatch);\r\n    } else {\r\n      isMatch ? GSDOM.show(el) : GSDOM.hide(el);\r\n    }\r\n\r\n    const form = GSDOM.closest(el, 'form');\r\n    GSDOM.formElements(form)\r\n      .forEach(el => GSAttr.set(el, 'data-ignore', isMatch ? null : true));\r\n  }\r\n\r\n  #isInList() {\r\n    const me = this;\r\n    const list = me.list;\r\n    if (!list) return true;\r\n    if (!me.strict) return true;\r\n    if (!list.querySelector('option')) return true;\r\n    const opt = list.querySelector(`option[value=\"${me.value}\"]`);\r\n    return opt != null;\r\n  }\r\n\r\n}  ","\r\nimport { notEqual, defaultConverter } from '../../lib.mjs';\r\n\r\n\r\nconst defaultPropertyDeclaration = {\r\n    attribute: true,\r\n    reflect: false,\r\n    type: String,\r\n    converter: defaultConverter,\r\n    hasChanged: notEqual,\r\n}\r\n\r\nconst attributeToPropertyMap = Symbol();\r\nconst prepare = Symbol();\r\nconst elementProperties = Symbol();\r\nconst finalize = Symbol();\r\nconst finalized = Symbol();\r\n\r\nconst prepareFn = function () {\r\n    const me = this;\r\n    if (Object.getOwnPropertySymbols(me).includes(elementProperties)) return;\r\n    const superCtor = Object.getPrototypeOf(me);\r\n    if (typeof superCtor[finalize] === 'function') superCtor[finalize]();\r\n    me[elementProperties] = new Map(superCtor[elementProperties]);\r\n}\r\n\r\nconst attributeNameForProperty = (name, options) => {\r\n    const attribute = options.attribute;\r\n    return attribute === false\r\n        ? undefined\r\n        : typeof attribute === 'string'\r\n            ? attribute\r\n            : typeof name === 'string'\r\n                ? name.toLowerCase()\r\n                : undefined;\r\n}\r\n\r\n/**\r\n * Reactivity for HTMLInputElement based on Google ltd. Lit ReactiveElement\r\n */\r\nexport class ReactiveInput extends HTMLInputElement {\r\n\r\n    // user defiend \r\n    static properties = {};\r\n    \r\n    static [finalized] = false;\r\n\r\n    #reflectingProperties = undefined;\r\n    #instanceProperties = undefined;\r\n\r\n    #controllers = undefined;\r\n    #updatePromise = undefined;\r\n    #changedProperties = undefined;\r\n    #reflectingProperty = undefined;\r\n\r\n    #hasUpdated = false;\r\n    #isUpdatePending = false;\r\n\r\n    /**\r\n     * Returns a list of attributes corresponding to the registered properties.\r\n    */\r\n    static get observedAttributes() {\r\n        Object.defineProperty(ReactiveInput.__proto__, prepare, { value: prepareFn });\r\n        const me = this;\r\n        me[finalize]();\r\n        return me[attributeToPropertyMap] && [...me[attributeToPropertyMap].keys()];\r\n    }\r\n\r\n    static addInitializer(initializer) {\r\n        const me = this;\r\n        me[prepare]();\r\n        me.initializers ??= [].push(initializer);\r\n    }\r\n\r\n    static [finalize]() {\r\n        const me = this;\r\n        //if (Object.hasOwn(me, 'finalized')) return;\r\n        if (me[finalized] === true) return;\r\n        me[finalized] = true;\r\n        me[prepare]();\r\n\r\n        if (Object.hasOwn(me, 'properties')) {\r\n            const props = me.properties;\r\n            const propKeys = [\r\n                ...Object.getOwnPropertyNames(props),\r\n                ...Object.getOwnPropertySymbols(props),\r\n            ];\r\n            for (const p of propKeys) {\r\n                me.createProperty(p, props[p]);\r\n            }\r\n        }\r\n\r\n        // Create the attribute-to-property map\r\n        me[attributeToPropertyMap] = new Map();\r\n        for (const [p, options] of me[elementProperties]) {\r\n            const attr = attributeNameForProperty(p, options);\r\n            if (attr !== undefined) {\r\n                me[attributeToPropertyMap].set(attr, p);\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    static createProperty(name, options) {\r\n        const me = this;\r\n        if (options.state) options.attribute = false;\r\n        me[prepare]();\r\n        me[elementProperties].set(name, options);\r\n        if (!options.noAccessor) {\r\n            const key = Symbol();\r\n            const descriptor = me.getPropertyDescriptor(name, key, options);\r\n            if (descriptor !== undefined) {\r\n                Object.defineProperty(me.prototype, name, descriptor);\r\n            }\r\n        }\r\n    }\r\n\r\n    static getPropertyDescriptor(name, key, options) {\r\n        const { get, set } = Object.getOwnPropertyDescriptor(this.prototype, name) ?? {\r\n            get() {\r\n                return this[key];\r\n            },\r\n            set(v) {\r\n                this[key] = v;\r\n            },\r\n        }\r\n        return {\r\n            get() {\r\n                return get?.call(this);\r\n            },\r\n            set(value) {\r\n                const me = this;\r\n                const oldValue = get?.call(me);\r\n                set?.call(me, value);\r\n                me.requestUpdate(name, oldValue, options);\r\n            },\r\n            configurable: true,\r\n            enumerable: true,\r\n        }\r\n    }\r\n\r\n    static getPropertyOptions(name) {\r\n        return this[elementProperties].get(name) ?? defaultPropertyDeclaration;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.#initialize();\r\n    }\r\n\r\n    connectedCallback() {\r\n        const me = this;\r\n        me.enableUpdating(true);\r\n        me.#controllers?.forEach((c) => c.hostConnected?.());\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        this.#controllers?.forEach((c) => c.hostDisconnected?.());\r\n    }\r\n\r\n    attributeChangedCallback(name, oldValue, newValue) {\r\n        this.#attributeToProperty(name, newValue);\r\n    }\r\n\r\n    // ******************************\r\n    // PUBLIC GETTERS\r\n    // ******************************\r\n\r\n    get hasUpdated() { return this.#hasUpdated; }\r\n    get isUpdatePending() { return this.#isUpdatePending; }\r\n    get renderRoot() { return this; }\r\n\r\n    // ******************************\r\n    // PROTECTED FUNCTIONS \r\n    // ******************************\r\n\r\n    addController(controller) {\r\n        // if (!(controller instanceof ReactiveController)) throw new Error('Argument not instance of ReactiveController');\r\n        const me = this;\r\n        (me.#controllers ??= new Set()).add(controller);\r\n        if (me.isConnected) {\r\n            controller.hostConnected?.();\r\n        }\r\n    }\r\n\r\n    removeController(controller) {\r\n        this.#controllers?.delete(controller);\r\n    }\r\n\r\n    createRenderRoot() {\r\n        return this;\r\n    }\r\n\r\n    enableUpdating(requestedUpdate) { }\r\n\r\n    firstUpdated(changedProperties) { }\r\n\r\n    updated(changedProperties) { }\r\n\r\n    getUpdateComplete() { return this.#updatePromise; }\r\n\r\n    scheduleUpdate() { return this.performUpdate(); }\r\n\r\n    shouldUpdate(changedProperties) { return true; }\r\n\r\n    willUpdate(changedProperties) { }\r\n\r\n    update(changedProperties) {\r\n        const me = this;\r\n        // The forEach() expression will only run when when #reflectingProperties is\r\n        // defined, and it returns undefined, setting #reflectingProperties to undefined\r\n        me.#reflectingProperties &&= me.#reflectingProperties.forEach((p) => me.#propertyToAttribute(p, this[p]));\r\n        me.#markUpdated();\r\n    }\r\n\r\n    get updateComplete() {\r\n        return this.getUpdateComplete();\r\n    }\r\n\r\n    requestUpdate(name, oldValue, options) {\r\n        const me = this;\r\n        if (name !== undefined) {\r\n            options ??= (me.constructor).getPropertyOptions(name);\r\n            const hasChanged = options.hasChanged ?? notEqual;\r\n            const newValue = me[name];\r\n            if (hasChanged(newValue, oldValue)) {\r\n                me.#changeProperty(name, oldValue, options);\r\n            } else {\r\n                return;\r\n            }\r\n        }\r\n        if (me.#isUpdatePending === false) {\r\n            me.#updatePromise = me.#enqueueUpdate();\r\n        }\r\n    }\r\n\r\n    performUpdate() {\r\n\r\n        const me = this;\r\n        if (!me.#isUpdatePending) return;\r\n\r\n        if (!me.#hasUpdated) {\r\n\r\n            // Mixin instance properties once, if they exist.\r\n            if (me.#instanceProperties) {\r\n                for (const [p, value] of me.#instanceProperties) {\r\n                    this[p] = value;\r\n                }\r\n                me.#instanceProperties = undefined;\r\n            }\r\n\r\n            const elementProps = me.constructor[elementProperties];\r\n            if (elementProps.size > 0) {\r\n                for (const [p, options] of elementProps) {\r\n                    if (\r\n                        options.wrapped === true &&\r\n                        !me.#changedProperties.has(p) &&\r\n                        me[p] !== undefined\r\n                    ) {\r\n                        me.#changeProperty(p, this[p], options);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        let shouldUpdate = false;\r\n        const changedProperties = me.#changedProperties;\r\n        try {\r\n            shouldUpdate = me.shouldUpdate(changedProperties);\r\n            if (shouldUpdate) {\r\n                me.willUpdate(changedProperties);\r\n                me.#controllers?.forEach((c) => c.hostUpdate?.());\r\n                me.update(changedProperties);\r\n            } else {\r\n                me.#markUpdated();\r\n            }\r\n        } catch (e) {\r\n            shouldUpdate = false;\r\n            me.#markUpdated();\r\n            throw e;\r\n        }\r\n\r\n        if (shouldUpdate) {\r\n            me.#didUpdate(changedProperties);\r\n        }\r\n    }\r\n\r\n    // ******************************\r\n    // PRIVATE FUNCTIONS \r\n    // ******************************\r\n\r\n    #didUpdate(changedProperties) {\r\n        const me = this;\r\n        me.#controllers?.forEach((c) => c.hostUpdated?.());\r\n        if (!me.#hasUpdated) {\r\n            me.#hasUpdated = true;\r\n            me.firstUpdated(changedProperties);\r\n        }\r\n        me.updated(changedProperties);\r\n    }\r\n\r\n    #markUpdated() {\r\n        const me = this;\r\n        me.#changedProperties = new Map();\r\n        me.#isUpdatePending = false;\r\n    }\r\n\r\n    async #enqueueUpdate() {\r\n        const me = this;\r\n        me.#isUpdatePending = true;\r\n        try {\r\n            await me.#updatePromise;\r\n        } catch (e) {\r\n            Promise.reject(e);\r\n        }\r\n        const result = me.scheduleUpdate();\r\n\r\n        if (result != null) {\r\n            await result;\r\n        }\r\n        return !me.#isUpdatePending;\r\n    }\r\n\r\n    #changeProperty(name, oldValue, options) {\r\n        const me = this;\r\n        if (!me.#changedProperties.has(name)) {\r\n            me.#changedProperties.set(name, oldValue);\r\n        }\r\n\r\n        if (options.reflect === true && me.#reflectingProperty !== name) {\r\n            (me.#reflectingProperties ??= new Set()).add(name);\r\n        }\r\n    }\r\n\r\n    #attributeToProperty(name, value) {\r\n        const me = this;\r\n        const ctor = me.constructor;\r\n        const propName = (ctor[attributeToPropertyMap]).get(name);\r\n        if (propName !== undefined && me.#reflectingProperty !== propName) {\r\n            const options = ctor.getPropertyOptions(propName);\r\n            const converter =\r\n                typeof options.converter === 'function'\r\n                    ? { fromAttribute: options.converter }\r\n                    : options.converter?.fromAttribute !== undefined\r\n                        ? options.converter\r\n                        : defaultConverter;\r\n            // mark state reflecting\r\n            me.#reflectingProperty = propName;\r\n            me[propName] = converter?.fromAttribute(value, options.type);\r\n            // mark state not reflecting\r\n            me.#reflectingProperty = null;\r\n        }\r\n    }\r\n\r\n    #propertyToAttribute(name, value) {\r\n        const me = this;\r\n        const elementProps = me.constructor[elementProperties];\r\n        const options = elementProps?.get(name);\r\n        const attr = attributeNameForProperty(name, options);\r\n        if (attr !== undefined && options.reflect === true) {\r\n            const converter =\r\n                (options.converter)?.toAttribute !==\r\n                    undefined\r\n                    ? (options.converter)\r\n                    : defaultConverter;\r\n            const attrValue = converter?.toAttribute(value, options.type);\r\n\r\n            me.#reflectingProperty = name;\r\n            if (attrValue == null) {\r\n                me.removeAttribute(attr);\r\n            } else {\r\n                me.setAttribute(attr, attrValue);\r\n            }\r\n            // mark state not reflecting\r\n            me.#reflectingProperty = null;\r\n        }\r\n    }\r\n\r\n    #saveInstanceProperties() {\r\n        const me = this;\r\n        const instanceProperties = new Map();\r\n        const elementProps = me.constructor[elementProperties];\r\n        for (const p of elementProps.keys()) {\r\n            if (Object.hasOwn(me, p)) {\r\n                instanceProperties.set(p, me[p]);\r\n                delete me[p];\r\n            }\r\n        }\r\n        if (instanceProperties.size > 0) {\r\n            me.#instanceProperties = instanceProperties;\r\n        }\r\n    }\r\n\r\n    #initialize() {\r\n        const me = this;\r\n        me.#updatePromise = new Promise((res) => me.enableUpdating = res);\r\n        me.#changedProperties = new Map();\r\n        me.#saveInstanceProperties();\r\n        me.requestUpdate();\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDataListExt class\r\n * @module components/ext/GSDataListExt\r\n */\r\n\r\nimport { GSID } from \"../../base/GSID.mjs\";\r\nimport { GSDOM } from \"../../base/GSDOM.mjs\";\r\nimport { GSLoader } from \"../../base/GSLoader.mjs\";\r\n\r\n/**\r\n * Add JSON loader to select element\r\n * <select is=\"gs-ext-select\" data=\"data.json\">\r\n * \r\n * [{text:'', value:'' selected:true}]\r\n * \r\n * @class\r\n * @extends {HTMLSelectElement}\r\n */\r\nexport class GSComboExt extends HTMLSelectElement {\r\n\r\n    static {\r\n        customElements.define('gs-ext-select', GSComboExt, { extends: 'select' });\r\n        Object.seal(GSComboExt);\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    static get observedAttributes() {\r\n        return ['data'];\r\n    }\r\n\r\n    attributeChangedCallback(name, oldValue, newValue) {\r\n        //GSLog.error(null, `name:${name}, oldValue:${oldValue}, newValue:${newValue}`);\r\n        if (name === 'data') this.load(newValue);\r\n    }\r\n\r\n    connectedCallback() {\r\n        GSID.setIf(this);\r\n    }\r\n\r\n    validate() {\r\n        const me = this;\r\n        const isValid = me.checkValidity();\r\n        if (!isValid) me.reportValidity();\r\n        return isValid;\r\n    }\r\n\r\n    get owner() {\r\n        const own = GSDOM.root(this);\r\n        return GSDOM.unwrap(own);\r\n    }\r\n\r\n    async load(url = '') {\r\n        if (!url) return;\r\n        const data = await GSLoader.loadSafe(url, 'GET', null, true);\r\n        this.apply(data);\r\n    }\r\n\r\n    apply(data) {\r\n\r\n        if (!Array.isArray(data)) return false;\r\n\r\n        const me = this;\r\n\r\n        queueMicrotask(() => {\r\n\r\n            const list = [];\r\n            data.forEach(o => {\r\n                list.push(me.#objToHTML(o));\r\n            });\r\n\r\n            GSDOM.setHTML(me, list.join('\\n'));\r\n        });\r\n        return true;\r\n    }\r\n\r\n    #objToHTML(o) {\r\n        const seg = ['<option'];\r\n\r\n        Object.entries(o).forEach(it => {\r\n            const key = it[0];\r\n            const val = it[1];\r\n            if ('text' === key) return;\r\n            if ('selected' === key) return seg.push(key);\r\n            seg.push(`${key}=\"${val}\"`);\r\n        });\r\n\r\n        seg.push('>')\r\n        seg.push(o.text);\r\n        seg.push('</option>')\r\n\r\n        return seg.join(' ');\r\n    }\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDataListExt class\r\n * @module components/ext/GSDataListExt\r\n */\r\n\r\n\r\nimport { GSID } from \"../../base/GSID.mjs\";\r\nimport { GSDOM } from \"../../base/GSDOM.mjs\";\r\nimport { GSUtil } from \"../../base/GSUtil.mjs\";\r\nimport { GSLoader } from \"../../base/GSLoader.mjs\";\r\n\r\n/**\r\n * Add JSON loader to datalist element\r\n * \r\n * <datalist is=\"gs-ext-datalist\" data=\"data.json\">\r\n * \r\n * [{text:'', value:'' selected:true}]\r\n * \r\n * @class\r\n * @extends {HTMLDataListElement}\r\n */\r\nexport class GSDataListExt extends HTMLDataListElement {\r\n\r\n    static {\r\n        customElements.define('gs-ext-datalist', GSDataListExt, { extends: 'datalist' });\r\n        Object.seal(GSDataListExt);\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    static get observedAttributes() {\r\n        return ['data'];\r\n    }\r\n\r\n    attributeChangedCallback(name, oldValue, newValue) {\r\n        //GSLog.error(null, e);`name:${name}, oldValue:${oldValue}, newValue:${newValue}`);\r\n        if (name === 'data') this.load(newValue);\r\n    }\r\n\r\n    connectedCallback() {\r\n        GSID.setIf(this);\r\n    }\r\n\r\n    get owner() {\r\n        const own = GSDOM.root(this);\r\n        return GSDOM.unwrap(own);\r\n    }\r\n\r\n    async load(url = '') {\r\n        if (!url) return;\r\n        const data = await GSLoader.loadSafe(url, 'GET', null, true);\r\n        this.apply(data);\r\n    }\r\n\r\n    apply(data) {\r\n\r\n        if (!Array.isArray(data)) return false;\r\n\r\n        const me = this;\r\n\r\n        queueMicrotask(() => {\r\n\r\n            const list = [];\r\n            data.forEach(o => {\r\n                list.push(me.#objToHTML(o));\r\n            });\r\n\r\n            GSDOM.setHTML(me, list.join('\\n'));\r\n        });\r\n        return true;\r\n    }\r\n\r\n    #objToHTML(o) {\r\n        const seg = ['<option'];\r\n\r\n        if (GSUtil.isString(o)) o = { value: o };\r\n\r\n        Object.entries(o).forEach(it => {\r\n            const key = it[0];\r\n            const val = it[1];\r\n            if ('text' === key) return;\r\n            if ('selected' === key) return seg.push(key);\r\n            seg.push(`${key}=\"${val}\"`);\r\n        });\r\n\r\n        seg.push(o.text);\r\n        seg.push('>')\r\n\r\n        return seg.join(' ');\r\n    }\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSDOM } from '../../base/GSDOM.mjs';\r\nimport { GSData } from '../../base/GSData.mjs';\r\nimport { GSEvents } from '../../base/GSEvents.mjs';\r\nimport { AdoptedController } from '../../controllers/AdoptedController.mjs';\r\nimport { AttributeController } from '../../controllers/AttributeController.mjs';\r\nimport { CopySelectController } from './controllers/CopySelectController.mjs';\r\nimport { MaskController } from './controllers/MaskController.mjs';\r\nimport { PasswordController } from './controllers/PasswordController.mjs';\r\nimport { NumberController } from './controllers/NumberController.mjs';\r\nimport { TextController } from './controllers/TextController.mjs';\r\nimport { ListController } from './controllers/ListController.mjs';\r\n\r\nimport { ReactiveInput } from './ReactiveInput.mjs';\r\n\r\n/**\r\n * Extended HTMLInputElement with controllers support\r\n * adding various feature such as masked input support \r\n */\r\nexport class GSInputElement extends ReactiveInput {\r\n\r\n  static properties = {\r\n    autocopy: { type: Boolean },\r\n    autofocus: { type: Boolean },\r\n    autoselect: { type: Boolean },\r\n    reveal: { type: Boolean },\r\n    mask: { reflect: true }\r\n  }\r\n\r\n  #adopted;\r\n  #uiHandler;\r\n\r\n  #copyselect;\r\n  #maskController;\r\n  #passwordController;\r\n  #numberController;\r\n  #textController;\r\n  #listController;\r\n\r\n  constructor() {\r\n    super();\r\n    this.#copyselect = new CopySelectController(this);\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    if (this.isBindable) this.binded();\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    GSEvents.deattachListeners(this);\r\n    super.disconnectedCallback();\r\n  }\r\n\r\n  willUpdate(changed) {\r\n\r\n    super.willUpdate(changed);\r\n\r\n    if (changed.has('mask') && this.mask && this.type === 'text') {\r\n      this.placeholder = this.mask;\r\n      this.#maskController ??= new MaskController(this);\r\n      this.#maskController.initRules();\r\n    }\r\n\r\n    if (this.list) {\r\n      this.#listController ??= new ListController(this);\r\n    }\r\n\r\n    switch (this.type) {\r\n      case 'text':\r\n        this.#textController ??= new TextController(this);\r\n        break;\r\n      case 'password':\r\n        this.#passwordController ??= new PasswordController(this);\r\n        break;\r\n      case 'number':\r\n        this.#numberController ??= new NumberController(this);\r\n        break;\r\n    }\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    if (this.autofocus) this.focus();\r\n  }\r\n\r\n  /**\r\n   * Attach bindings\r\n   */\r\n  binded() {\r\n    this.#uiHandler ??= new AttributeController(this);\r\n  }\r\n\r\n  /**\r\n   * Handle bindings \r\n   * @param {*} e \r\n   */\r\n  handle(e) {\r\n    this.#uiHandler?.handle(e);\r\n  }\r\n\r\n  /**\r\n   * Initialize dynamic style for component.\r\n   * Call it from constructor for style to be applied to the component\r\n   * Creates a dynamic StyleSheet which holds dynamic StyleRules\r\n   * @param {String} id \r\n   * @param {String|Object} value \r\n   * @returns {CSSStyleRule}\r\n   */\r\n  dynamicStyle(id, value) {\r\n    this.#adopted ??= new AdoptedController(me);\r\n    return this.#adopted.style(id, value);\r\n  }\r\n\r\n  /**\r\n   * Find element by its ID\r\n   * @param {String} name \r\n   * @returns {HTMLElement}\r\n   */\r\n  getByID(query = '') {\r\n    return GSDOM.getByID(this, query);\r\n  }\r\n\r\n  /**\r\n   * Find closest top element by CSS selector\r\n   * @param {String} query \r\n   * @returns {HTMLElement}\r\n   */\r\n  closest(query = '') {\r\n    return GSDOM.closest(this, query);\r\n  }\r\n\r\n  /**\r\n   * Generic component signal\r\n   * @param {Boolean} bubbles  Does buuble to upper nodes\r\n   * @param {Boolean} composed Does traverse from shadow DOM \r\n   */\r\n  notify(bubbles = true, composed = false, data) {\r\n    this.emit('notify', data, bubbles, composed, true);\r\n  }\r\n\r\n  /**\r\n   * Send event\r\n   * @param {String} name \r\n   * @param {Object} obj \r\n   * @param {Boolean} bubbles \r\n   * @param {Boolean} composed \r\n   * @param {Boolean} cancelable \r\n   */\r\n  emit(name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n    return GSEvents.send(this, name, obj, bubbles, composed, cancelable);\r\n  }\r\n\r\n  /**\r\n   * Wait for event to happen\r\n   * @async\r\n   * @param {String} name \r\n   * @returns {Promise}\r\n   */\r\n  waitEvent(name = '', timeout = 0) {\r\n    return GSEvents.wait(this, name, timeout);\r\n  }\r\n\r\n  /**\r\n   * Listen once for triggered event\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  once(name, func) {\r\n    return this.listen(name, func, true);\r\n  }\r\n\r\n  /**\r\n   * Alternative function for event listen\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  on(name, func, once = false) {\r\n    return this.listen(name, func, once);\r\n  }\r\n\r\n  /**\r\n   * Alternative function for event unlisten\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  off(name, func) {\r\n    return this.unlisten(name, func);\r\n  }\r\n\r\n  /**\r\n   * Prevent event firing up the DOM tree\r\n   * @param {Event} e \r\n   */\r\n  prevent(e) {\r\n    GSEvents.prevent(e);\r\n  }\r\n\r\n  /**\r\n   * Attach event to this element\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  listen(name, func, once = false) {\r\n    return this.attachEvent(this, name, func, once);\r\n  }\r\n\r\n  /**\r\n   * Remove event from this element\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  unlisten(name, func) {\r\n    return this.removeEvent(this, name, func);\r\n  }\r\n\r\n  /**\r\n  * Generic event listener appender\r\n  * \r\n  * @param {HTMLElement} el Element on which to monitor for named events\r\n  * @param {String} name Event name to watch for\r\n  * @param {Function} fn Event trigger callback\r\n  * @param {Boolean} once Listen only once\r\n  * @returns {Boolean} State if attachment was successful\r\n  */\r\n  attachEvent(el, name = '', fn, once = false) {\r\n    return GSEvents.attach(this, el, name, fn, once);\r\n  }\r\n\r\n  /**\r\n  * Generic event listener remove\r\n  * @param {HTMLElement} el Element on which to monitor for named events\r\n  * @param {String} name Event name to watch for\r\n  * @param {Function} fn Event trigger callback\r\n  * @returns {Boolean} State if attachment was successful\t\r\n  */\r\n  removeEvent(el, name = '', fn) {\r\n    return GSEvents.remove(this, el, name, fn);\r\n  }\r\n\r\n  get owner() {\r\n    const own = GSDOM.root(this);\r\n    return GSDOM.unwrap(own);\r\n  }\r\n\r\n  get raw() {\r\n    return super.value;\r\n  }\r\n\r\n  get value() {\r\n    return this.#maskController ? this.#maskController.value : super.value;\r\n  }\r\n\r\n  set value(val) {\r\n    super.value = val;\r\n  }\r\n\r\n  /**\r\n   * Check if component is bindable to process data-gs-atributes\r\n   */\r\n  get isBindable() {\r\n    return this.dataset.gsTarget;\r\n  }\r\n\r\n  /**\r\n   * Return true if current element or chadow dom child is focused\r\n   */\r\n  get isFocused() {\r\n    return this === document.activeElement;\r\n  }\r\n\r\n  /**\r\n   * Element tag name\r\n   */\r\n  get tag() {\r\n    return this.tagName.toLowerCase();\r\n  }\r\n\r\n  /**\r\n   * Get this class name\r\n   */\r\n  get clazzName() {\r\n    return this.constructor.name;\r\n  }\r\n\r\n  get definitions() {\r\n    const list = [...GSDOM.inheritance(this)].map(o => o.constructor?.properties).filter(o => o);\r\n    list.push(this.constructor?.properties);\r\n    return GSData.mergeObjects(list);\r\n  }\r\n\r\n  /**\r\n   * Extract and merge all static properties definition from WebComponent instance\r\n   * @param {GSInputElement} obj \r\n   * @returns {Object}\r\n   */\r\n  static allProperties(obj) {\r\n    const list = [...GSDOM.inheritance(obj)].map(o => o.properties).filter(o => o);\r\n    list.push(obj.constructor?.properties || obj.properties);\r\n    return GSData.mergeObjects(list);\r\n  }\r\n\r\n  /**\r\n   * Register class as WebComponent to the browser\r\n   * @param {String} name \r\n   * @param {class} clazz Optional, if not set, use self\r\n   */\r\n  static define(name, clazz) {\r\n    if (!customElements.get(name)) {\r\n      customElements.define(name, clazz || this, { extends: 'input' });\r\n    }\r\n  }\r\n\r\n  static {\r\n    GSInputElement.define('gs-ext-input', GSInputElement);\r\n  }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { html, ifDefined, repeat } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { color } from '../../properties/color.mjs';\r\n\r\nexport class GSBreadcrumbElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    data: { type: Array },\r\n    color: { ...color },\r\n    divider: { reflect: true },\r\n    spacing: { reflect: true, type: Number },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.spacing = 1;\r\n    me.divider = 'chevron-right';\r\n    me.#updateChildren();\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    this.#updateChildren();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<nav part=\"base\" class=\"breadcrumb\" @click=\"${me.#onClick}\" dir=\"${ifDefined(me.direction)}\"><slot>\r\n      ${repeat(me.data || [], (item) => item, (item) => html`\r\n        <gs-breadcrumb-item  \r\n        href=\"${item.href}\"\r\n        color=\"${item.color}\"\r\n        .data=${item}     \r\n        .active=${item.active}\r\n        .divider=\"${item.divider || me.divider}\"\r\n        .spacing=\"${item.spacing || me.spacing}\">\r\n          ${item.$text}\r\n        </gs-breadcrumb-item>\r\n      `)}\r\n    </slot></nav>`;\r\n  }\r\n\r\n  onDataRead(data) {\r\n    this.data = data;\r\n  }\r\n\r\n  #updateChildren() {\r\n    const me = this;\r\n    me.queryAll('gs-breadcrumb-item').forEach(el => {\r\n      el.divider = me.divider;\r\n      el.spacing = me.spacing;\r\n      el.color = me.color;\r\n    });\r\n  }\r\n\r\n  #onClick(e) {\r\n    const el = e.target.closest('gs-bradcrumb-item');\r\n    el?.handle(e);\r\n  } \r\n\r\n  static {\r\n    this.define('gs-breadcrumb');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { color } from '../../properties/color.mjs';\r\nimport { GSLinklement } from '../Link.mjs';\r\nimport { GSAttributeHandler } from '../../base/GSAttributeHandler.mjs';\r\n\r\nexport class GSBreadcrumbItemElement extends GSElement {\r\n\r\n  static properties = {\r\n    href: {},\r\n    color: { ...color },\r\n    data: { state: true, type: Object },\r\n    active: { reflect: true, type: Boolean },\r\n    divider: { state: true, type: Boolean },\r\n    spacing: { state: true, type: Number },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.data = {};\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div part=\"base\" class=\"breadcrumb-item ${classMap(me.renderClass())}\"  dir=\"${ifDefined(me.direction)}\">\r\n        <span part=\"prefix\"><slot name=\"prefix\"></slot></span>        \r\n        ${me.#label}\r\n        <span part=\"suffix\"><slot name=\"suffix\"></slot></span>\r\n        <span part=\"separator\"><slot name=\"separator\">${me.#separator}</slot></span>\r\n      </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'active': me.active,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  get #label() {\r\n    const me = this;\r\n    if (me.active) return html`<slot></slot>`;\r\n    me.data.url = me.data.url || me.href;\r\n    me.data.part = 'label';\r\n    return GSLinklement.generate(me.data, {})\r\n  }\r\n\r\n  get #separator() {\r\n    const me = this;\r\n    return me.nextElementSibling && me.divider ? html`<gs-icon size=\"7\" color=\"${me.color}\" css=\"mx-${me.spacing}\" name=\"${me.divider}\"></gs-icon>` : '';\r\n  }\r\n\r\n  handle(e) {\r\n    GSAttributeHandler.process(this.query('a', true), e);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-breadcrumb-item');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSUtil } from '../../base/GSUtil.mjs';\r\n\r\n/**\r\n * A module rendering current time on a page\r\n * @module components/TimeFormat\r\n */\r\n\r\n/**\r\n * Render Time value\r\n * \r\n * @class\r\n * @extends {HTMLElement}\r\n */\r\nexport class GSTimeFormat extends GSElement {\r\n\r\n    static properties = {\r\n        interval: {reflect:true, type:Number},\r\n        locale: {reflect:true},\r\n    }\r\n\r\n    #id = 0;\r\n\r\n    constructor() {\r\n        super();\r\n        this.interval = 1;\r\n        this.locale = GSUtil.locale;\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        this.start();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        this.stop();\r\n        super.disconnectedCallback();\r\n    }\r\n\r\n    renderUI() {\r\n        const date = new Date();\r\n        return date.toLocaleTimeString(this.locale);\r\n    }    \r\n\r\n    start() {\r\n        const me = this;\r\n        if (me.interval >0 && me.#id === 0) {\r\n            me.#id = setInterval(me.#update.bind(me), me.interval * 1000);\r\n        } else {\r\n            me.requestUpdate();\r\n        }\r\n    }\r\n\r\n    stop() {\r\n        clearInterval(this.#id);\r\n        this.#id = 0;\r\n    }\r\n    \r\n    #update() {\r\n       requestAnimationFrame(() => this.requestUpdate());\r\n    }\r\n\r\n    static {\r\n        this.define('gs-time-format');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module rendering date with specific langauge support\r\n * @module components/DateFormat\r\n */\r\n\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSDate } from '../../base/GSDate.mjs';\r\n\r\n/**\r\n * Render Date value with international language support\r\n * \r\n * All options - set dasta-[name]; data-weekday etc...\r\n       {\r\n       weekday: 'narrow' | 'short' | 'long',\r\n       era: 'narrow' | 'short' | 'long',\r\n       year: 'numeric' | '2-digit',\r\n       month: 'numeric' | '2-digit' | 'narrow' | 'short' | 'long',\r\n       day: 'numeric' | '2-digit',\r\n       hour: 'numeric' | '2-digit',\r\n       minute: 'numeric' | '2-digit',\r\n       second: 'numeric' | '2-digit',\r\n       timeZoneName: 'short' | 'long',\r\n\r\n       // Time zone to express it in\r\n       timeZone: 'Asia/Shanghai',\r\n       // Force 12-hour or 24-hour\r\n       hour12: true | false,\r\n\r\n       dateStyle: full | long | medium | short\r\n       timeStyle: full | long | medium | short\r\n\r\n       // Rarely-used options\r\n       hourCycle: 'h11' | 'h12' | 'h23' | 'h24',\r\n       formatMatcher: 'basic' | 'best fit'\r\n       }\r\n * @class\r\n * @extends {HTMLElement}\r\n */\r\nexport class GSDateFormat extends GSElement {\r\n\r\n    static properties = {\r\n        value: {},\r\n        locale: {},\r\n        format: {},\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.locale = navigator.locale;\r\n        this.value = new Date();\r\n    }\r\n\r\n    renderUI() {\r\n        return this.result;\r\n    }    \r\n\r\n    get result() {\r\n        const me = this;\r\n        const val = me.date;\r\n        if (me.format) return val.format(me.format);\r\n        return new Intl.DateTimeFormat(me.locale, me.dataset).format(val);\r\n    }\r\n\r\n    get date() {\r\n        const me = this;\r\n        const o = Date.parse(me.value || new Date());\r\n        const date = new GSDate(o);\r\n        date.locale = me.locale;\r\n        return date;\r\n    }\r\n\r\n\r\n    static {\r\n        this.define('gs-date-format');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module rendering current year on a page\r\n * @module components/YearFormat\r\n */\r\nimport { GSElement } from '../../GSElement.mjs';\r\n\r\n/**\r\n * Render Year value\r\n * \r\n * @class\r\n * @extends {HTMLElement}\r\n */\r\nexport class GSYearFormat extends GSElement {\r\n\r\n    static properties = {\r\n        offset: {type :Number},\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.offset = 0;\r\n    }\r\n\r\n    renderUI() {\r\n        return this.value;\r\n    }\r\n\r\n    get value() {\r\n        return this.current + this.offset;\r\n    }\r\n\r\n    get current() {\r\n        return new Date().getFullYear();\r\n    }\r\n\r\n    static {\r\n        this.define('gs-year-format');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/NumberFormat/NumberFormat#options\r\n\r\n\r\n/**\r\n * A module rendering numeric value as curency format with specific langauge support\r\n * @module components/CurrencyFormat\r\n */\r\nimport { GSElement } from '../../GSElement.mjs';\r\n\r\n/**\r\n * Render Year value\r\n * \r\n * @class\r\n * @extends {HTMLElement}\r\n */\r\nexport class GSCurrencyFormat extends GSElement {\r\n\r\n    static properties = {\r\n        value: {},\r\n        locale: {},\r\n        currency: {},\r\n    }\r\n\r\n    renderUI() {\r\n        return this.format;\r\n    }\r\n\r\n    get #options() {\r\n        const me = this;\r\n        return Object.apply(me.dataset, { style: 'currency', currency: me.currency });\r\n    }\r\n\r\n    get format() {\r\n        const me = this;\r\n        return new Intl.NumberFormat(me.locale, me.#options).format(me.value);\r\n    }\r\n\r\n    static {\r\n        this.define('gs-currency-format');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { GSCacheStyles } from \"../../base/GSCacheStyles.mjs\";\r\n\r\n/**\r\n * A module loading GSStepStyle class\r\n * @module components/steps/GSStepStyle\r\n */\r\nexport class GSStepStyle {\r\n\r\n    static {\r\n        GSCacheStyles.adopt(GSStepStyle.style);\r\n    }\r\n\r\n    static get style() {\r\n        return `\r\n        .step .step-icon-wrap {\r\n            height: 80px;\r\n        }\r\n        \r\n        .step .step-icon-wrap::before,\r\n        .step .step-icon-wrap::after {\r\n            display: block;\r\n            position: absolute;\r\n            top: 50%;\r\n            width: 50%;\r\n            height: 3px;\r\n            margin-top: -1px;\r\n            background-color: var(--bs-gray-200);\r\n            content: '';\r\n            z-index: 1\r\n        }\r\n        \r\n        .step .step-icon-wrap::before {\r\n            left: 0\r\n        }\r\n        \r\n        .step .step-icon-wrap::after {\r\n            right: 0\r\n        }\r\n        \r\n        .step .step-icon {\r\n            width: 80px;\r\n            height: 80px;\r\n            line-height: 81px;\r\n            z-index: 5\r\n        }\r\n                \r\n        .step:first-child .step-icon-wrap::before {\r\n            display: none\r\n        }\r\n        \r\n        .step:last-child .step-icon-wrap::after {\r\n            display: none\r\n        }\r\n                \r\n        @media (max-width: 576px) {\r\n            .flex-sm-nowrap .step .step-icon-wrap::before,\r\n            .flex-sm-nowrap .step .step-icon-wrap::after {\r\n                display: none\r\n            }\r\n        }\r\n        \r\n        @media (max-width: 768px) {\r\n            .flex-md-nowrap .step .step-icon-wrap::before,\r\n            .flex-md-nowrap .step .step-icon-wrap::after {\r\n                display: none\r\n            }\r\n        }\r\n        \r\n        @media (max-width: 991px) {\r\n            .flex-lg-nowrap .step .step-icon-wrap::before,\r\n            .flex-lg-nowrap .step .step-icon-wrap::after {\r\n                display: none\r\n            }\r\n        }\r\n        \r\n        @media (max-width: 1200px) {\r\n            .flex-xl-nowrap .step .step-icon-wrap::before,\r\n            .flex-xl-nowrap .step .step-icon-wrap::after {\r\n                display: none\r\n            }\r\n        }        \r\n        `;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSStepElement class\r\n * @module components/steps/GSStepElement\r\n */\r\n\r\nimport { html, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\n\r\n/**\r\n * GSStep a signle element\r\n * @class\r\n * @extends {Component}\r\n */\r\nexport default class GSStepElement extends GSElement {\r\n\r\n    static INACTIVE = 'text-bg-light';\r\n    static SELECTED = 'text-bg-primary';\r\n    static COMPLETED = 'text-bg-secondary';\r\n\r\n    static ICON_CSS = 'border rounded-circle fs-1';\r\n    static TITLE_CSS = 'mb-0 fs-6 mt-3 fw-bold';\r\n\r\n    static properties = {\r\n        title: {},\r\n        icon: {},\r\n        color: {},\r\n        iconCSS: { attribute: 'icon-css' },\r\n        titleCSS: { attribute: 'title-css' },\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const clazz = GSStepElement;\r\n        this.icon = clazz.INACTIVE;\r\n        this.iconCSS = clazz.ICON_CSS;\r\n        this.titleCSS = clazz.TITLE_CSS;\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`\r\n        <div class=\"step d-block w-100 text-center mb-4\"  dir=\"${ifDefined(me.direction)}\">\r\n            <div class=\"step-icon-wrap d-block w-100 text-center position-relative\">\r\n                <div class=\"step-icon position-relative d-inline-block ${me.iconCSS} ${me.color || GSStepElement.INACTIVE}\">\r\n                    ${me.#renderIcon()}\r\n                </div>\r\n            </div>\r\n            <div class=\"step-title ${me.titleCSS}\">${me.translate(me.title)}</div>\r\n        </div>        \r\n        `;\r\n    }\r\n\r\n    #renderIcon() {\r\n        return this.icon ? html`<gs-icon name=\"${this.icon}\"></gs-icon>` : html`<slot name=\"icon\"></slot>`;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-step');\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSStepsElement class\r\n * @module components/steps/GSStepsElement\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSStepStyle } from \"./StepStyle.mjs\";\r\nimport GSStepElement from './Step.mjs';\r\n\r\n/**\r\n * Steps walker prev/next track current step and update step status\r\n * \r\n * @class\r\n * @extends {Component}\r\n */\r\nexport default class GSStepsElement extends GSElement {\r\n\r\n    static CSS = 'steps d-flex flex-wrap flex-sm-nowrap justify-content-between padding-top-2x padding-bottom-1x';\r\n\r\n    #index = -1;\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    shouldUpdate(changedProperties) { \r\n        return this.steps.length > 0;\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div class=\"${classMap(me.renderClass())}\"  dir=\"${ifDefined(me.direction)}\"><slot></slot></div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        return this.mapCSS(GSStepsElement.CSS, super.renderClass());\r\n    }\r\n\r\n    get steps() {\r\n        return this.queryAll('gs-step');\r\n    }\r\n\r\n    get length() {\r\n        return this.steps.length;\r\n    }\r\n\r\n    get index() {\r\n        return this.#index;\r\n    }\r\n\r\n    set index(val = 0) {\r\n        const me = this;\r\n        if (val < 0 || val >= me.length) return;\r\n        me.#index = val;\r\n    }\r\n\r\n    get current() {\r\n        const me = this;\r\n        return me.steps[me.#index];\r\n    }\r\n\r\n    get isFirst() {\r\n        return this.#index === 0;\r\n    }\r\n\r\n    get isLast() {\r\n        return this.#index === this.length - 1;\r\n    }\r\n\r\n    next() {\r\n        const me = this;\r\n        if (me.steps.length === 0) return;\r\n        if (me.isLast) return false;\r\n        if (me.#index > - 1) me.current.color = GSStepElement.COMPLETED;\r\n        me.index++;\r\n        me.current.color = GSStepElement.SELECTED;\r\n        return me.current;\r\n    }\r\n\r\n    previous() {\r\n        const me = this;\r\n        if (me.steps.length === 0) return;\r\n        if (me.isFirst) return false;\r\n        me.current.color = GSStepElement.INACTIVE;\r\n        me.index--;\r\n        me.current.color = GSStepElement.SELECTED;\r\n        return me.current;\r\n    }\r\n\r\n    reset() {\r\n        const me = this;\r\n        me.steps.forEach(it => it.color = GSStepElement.INACTIVE);\r\n        requestAnimationFrame(() => {\r\n            me.#index = 0;\r\n            me.current.color = GSStepElement.SELECTED;\r\n        });\r\n    }\r\n\r\n    static {\r\n        GSStepStyle.style;\r\n        this.define('gs-steps', GSStepsElement);\r\n    }\r\n\r\n}","\r\nimport { classMap, html, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\n\r\nexport class GSNotificationElement extends GSElement {\r\n\r\n    static TOP_START = \"position-fixed top-0 start-0\";\r\n    static TOP_CENTER = \"position-fixed top-0 start-50 translate-middle-x\";\r\n    static TOP_END = \"position-fixed top-0 end-0\";\r\n\r\n    static MIDDLE_START = \"position-fixed top-50 start-0 translate-middle-y\";\r\n    static MIDDLE_CENTER = \"position-fixed top-50 start-50 translate-middle\";\r\n    static MIDDLE_END = \"position-fixed top-50 end-0 translate-middle-y\";\r\n    \r\n    static BOTTOM_START = \"position-fixed bottom-0 start-0\";\r\n    static BOTTOM_CENTER = \"position-fixed bottom-0 start-50 translate-middle-x\";\r\n    static BOTTOM_END = \"position-fixed bottom-0 end-0\";\r\n\r\n    static DEFAULT = GSNotificationElement.BOTTOM_END;\r\n\r\n    static properties = {\r\n        position: { reflect: true },\r\n        native: { reflect: true, type: Boolean }\r\n    };\r\n\r\n    #list = new Set();\r\n\r\n    constructor() {\r\n        super();\r\n        this.css = 'p-3';\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div  dir=\"${ifDefined(me.direction)}\"\r\n            class=\"toast-container z-10k ${classMap(me.renderClass())}\">\r\n            <slot></slot>\r\n        </div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        return me.mapCSS(me.#positionCSS, super.renderClass());\r\n    }    \r\n\r\n    get #positionCSS() {\r\n        const clazz = GSNotificationElement;\r\n        const val = this.position || clazz.DEFAULT;\r\n        return val.indexOf('_') > 0 && clazz[val] ? clazz[val] : val;\r\n    }\r\n\r\n    clear() {\r\n        this.queryAll('gs-toast').forEach(el => el.dismiss());\r\n    }\r\n\r\n    info(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-info', closable, timeout, delay, options);\r\n    }\r\n\r\n    success(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-success', closable, timeout, delay, options);\r\n    }\r\n\r\n    warn(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-warning', closable, timeout, delay, options);\r\n    }\r\n\r\n    danger(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-danger', closable, timeout, delay, options);\r\n    }\r\n\r\n    primary(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-primary', closable, timeout, delay, options);\r\n    }\r\n\r\n    secondary(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-secondary', closable, timeout, delay, options);\r\n    }\r\n\r\n    dark(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-dark', closable, timeout, delay, options);\r\n    }\r\n\r\n    light(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-light', closable, timeout, delay, options);\r\n    }\r\n\r\n    /**\r\n     * Main function to show notification. \r\n     * It has support for Bootstrap based and web based notifications.\r\n     * \r\n     * @async\r\n     * @param {String} title Notification title\r\n     * @param {String} message Notification message\r\n     * @param {String} css CSS styling (web only)\r\n     * @param {Boolean} closable Can user close it (web only)\r\n     * @param {Number} timeout Timeout after which to close notification  (default 2 sec)\r\n     * @param {Number} delay Timeout after which to show notification (default 1 sec)\r\n     * @param {Object} options Options for native Notification\r\n     * @returns {Promise<Notification|GSToast>}\r\n     */\r\n    async display(title = '', message = '', css = '', closable = false, timeout = 2, delay = 0.5, options) {\r\n        if (!message) return;\r\n        const me = this;\r\n        if (me.native) {\r\n            let sts = await GSNotificationElement.requestPermission();\r\n            if (sts) sts = me.#showNative(title, message, timeout, delay, options);\r\n            if (sts) return sts;\r\n        }\r\n        return me.#showWeb(title, message, css, closable, timeout, delay);\r\n    }\r\n\r\n    #showWeb(title, message, css, closable, timeout, delay) {\r\n        const me = this;\r\n        const tpl = `<gs-toast css=\"${css}\"  opened ${closable ? 'closable' : ''} timeout=\"${timeout}\"  delay=\"${delay}\" message=\"${message}\" title=\"${title}\" locale=\"${me.locale}\" ></gs-toast>`;\r\n        const el = GSDOM.parse(tpl, true);\r\n        requestAnimationFrame(async () => {\r\n            await me.#delay(delay);\r\n            const toast = me.#dialogToast;\r\n            if (toast !== me) GSAttr.set(toast, 'class', `toast-container ${me.css} ${me.position}`);\r\n            toast.appendChild(el);\r\n        });\r\n        return el;\r\n    }\r\n\r\n    async #showNative(title, message, timeout, delay, options = {}) {\r\n        const me = this;\r\n        await me.#delay(delay);\r\n        options.body = options.body || message;\r\n        const notification = new Notification(title, options);\r\n        me.#list.add(notification);\r\n        const callback = me.#clearNative.bind({ notification: notification, owner: me });\r\n        notification.addEventListener('close', callback);\r\n        if (timeout > 0) notification.iid = setTimeout(callback, timeout * 1000);\r\n        return notification;\r\n    }\r\n\r\n    get #dialogToast() {\r\n        const dlg = customElements.get('gs-dialog')?.top;\r\n        return dlg && dlg.isConnected ? (GSDOM.query(dlg, '.toast-container') || this) : this;\r\n    }\r\n\r\n    async #delay(delay = 0) {\r\n        if (GSUtil.isNumber(delay) && delay > 0) await GSUtil.timeout(delay * 1000);\r\n    }\r\n\r\n    #clearNative() {\r\n        const me = this;\r\n        me.notification.close();\r\n        me.owner.#list.delete(me.notification);\r\n        if (me.notification.iid) clearTimeout(me.notification.iid);\r\n    }\r\n\r\n    /**\r\n     * Clear all triggered notifications\r\n     */\r\n    clear() {\r\n        const me = this;\r\n        Array.from(me.querySelectorAll('gs-toast')).forEach(el => el.remove());\r\n        me.#list.forEach(nn => nn.close());\r\n        me.#list.clear();\r\n    }\r\n\r\n    /**\r\n     * Check if native notification is supported\r\n     * @returns {Boolean} \r\n     */\r\n    static get isNativeSupported() {\r\n        return \"Notification\" in self;\r\n    }\r\n\r\n    /**\r\n     * Check if native notification is allowed\r\n     * @returns {Boolean} \r\n     */\r\n    static get isGranted() {\r\n        return Notification.permission === \"granted\";\r\n    }\r\n\r\n    /**\r\n     * Request useage for browser native notification\r\n     * \r\n     * @async\r\n     * @returns {Promise<boolean>} Return granted status\r\n     */\r\n    static async requestPermission() {\r\n        const clazz = GSNotificationElement;\r\n        if (!clazz.isNativeSupported) return false;\r\n        if (!clazz.isGranted) await Notification.requestPermission();\r\n        return clazz.isGranted;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-notification');\r\n    }\r\n}","\r\nimport { classMap, html, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSDOM } from '../../base/GSDOM.mjs';\r\nimport { GSUtil } from '../../base/GSUtil.mjs';\r\nimport { GSNotificationElement } from './Notification.mjs';\r\n\r\nexport class GSToastElement extends GSElement {\r\n\r\n    static properties = {\r\n        closable: { reflect: true, type: Boolean },\r\n        opened: { reflect: true, type: Boolean },\r\n        message: { reflect: true },\r\n        title: { reflect: true },\r\n        delay: { reflect: true, type: Number },\r\n        timeout: { reflect: true, type: Number }\r\n    }\r\n\r\n    #pending = false;\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;\r\n        me.timeout = 2;\r\n        me.delay = 2;\r\n        me.auto = true; \r\n    }\r\n\r\n    shouldUpdate(changedProperties) {\r\n        const me = this;\r\n        const visibilityChange = changedProperties.has('opened');\r\n        if (me.delay > 0 && me.opened && visibilityChange) {\r\n            me.#pending = true;\r\n            me.#pendingUpdate();\r\n        }\r\n        return me.#validParent && (!me.#pending);\r\n    }\r\n\r\n    async #pendingUpdate() {\r\n        const me = this;\r\n        await GSUtil.timeout(me.delay * 1000);\r\n        me.#pending = false;\r\n        me.requestUpdate();\r\n    }\r\n\r\n    async updated(changedProperties) {\r\n        const me = this;\r\n        if (me.timeout > 0) {\r\n            await GSUtil.timeout(me.timeout * 1000);\r\n            me.opened = false;\r\n            await GSUtil.timeout(GSDOM.SPEED);\r\n            me.remove();\r\n        }\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return me.title ? me.#renderWithHeader() : me.#renderSimple();\r\n    }\r\n\r\n    #renderWithHeader() {\r\n        const me = this;\r\n        return html`\r\n        <div dir=\"${ifDefined(me.direction)}\"\r\n            class=\"mt-1 mb-1 toast fade ${classMap(me.renderClass())}\">\r\n            <div class=\"toast-header\">\r\n                ${me.translate(me.title)}\r\n                <slot name=\"header\"></slot>\r\n                ${me.closable ? me.#button : ''}\r\n            </div>\r\n            <div class=\"toast-body\">\r\n                ${me.translate(me.message)}\r\n                <slot name=\"body\"></slot>\r\n            </div>\r\n        </div>            \r\n        `;\r\n    }\r\n\r\n    #renderSimple() {\r\n        const me = this;\r\n        return html`\r\n        <div class=\"mt-1 mb-1 toast fade ${classMap(me.renderClass())}\">\r\n          <div class=\"d-flex\">\r\n              <div class=\"toast-body\">\r\n              ${me.translate(me.message)}\r\n              <slot name=\"body\"></slot>\r\n              </div>\r\n              ${me.closable ? me.#button : ''}\r\n          </div>\r\n        </div>            \r\n        `;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            'show': me.opened,\r\n        }\r\n        return css;\r\n    }\r\n\r\n    dismiss() {\r\n        this.opened = false;\r\n    }\r\n\r\n    get #button() {\r\n        const me = this;\r\n        return html`<button type=\"button\" class=\"btn-close me-2 m-auto\" @click=\"${me.dismiss}\"></button>`;\r\n    }\r\n\r\n    get #validParent() {\r\n        return this.parentElement instanceof GSNotificationElement;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-toast');\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Controller managing data tree navigation.\r\n * Controller is added to every gs-tree-node and \r\n * reacts on Tree node changes to update UI\r\n */\r\nexport class AbstractTreeController {\r\n\r\n    #host;\r\n    #node;\r\n\r\n    constructor(host) {\r\n        const me = this;\r\n        me.#host = host;\r\n        host.addController(me);\r\n    }\r\n    \r\n    hostConnected() {\r\n        const me = this;\r\n        me.#node = me.#host.node;\r\n        me.#addNodeController(me);\r\n    }\r\n\r\n    hostDisconnected() {\r\n        const me = this;\r\n        me.#removeNodeController(me);\r\n        me.#host.removeController(me);\r\n    }\r\n\r\n    // before rendering\r\n    hostUpdate() {\r\n        const me = this;\r\n        const oldNode = me.#node;\r\n        me.#node = me.#host.node;\r\n        if (oldNode != me.#node) {\r\n            me.#removeNodeController(me);\r\n            me.#addNodeController(me);\r\n        }\r\n    }\r\n\r\n    // link Tree node callbacks with controller and component\r\n    #addNodeController(controller) {\r\n        this.#host.node?.addController?.(controller);\r\n    }\r\n\r\n    // unlink Tree node callbacks with controller and component\r\n    #removeNodeController(controller) {\r\n        this.#node?.removeController?.(controller);\r\n    }\r\n\r\n    host(node) {\r\n        return node[Symbol.for('gs-element')] || this.#host;\r\n    }\r\n\r\n    match(node) {\r\n        const host = this.host(node);\r\n        return host?.node === node;\r\n    }\r\n\r\n    get store() {\r\n        return this.#host.dataController?.store;\r\n    }\r\n\r\n    requestUpdate(node) {\r\n        if (this.match(node)) this.host(node).requestUpdate();\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { AbstractTreeController } from './AbstractTreeController.mjs';\r\n\r\n/**\r\n * Controller managing data TreeNode callbacks to reflect UI.\r\n */\r\nexport class TreeController extends AbstractTreeController {\r\n\r\n    constructor(host) {\r\n        super(host);\r\n    }\r\n\r\n    #toggleState(node, state = false) {\r\n        const el = this.host(node);\r\n        if (el) el.loading = state;\r\n    }\r\n\r\n    // Tree controller callbacks\r\n    onLoad(node) {\r\n        this.#toggleState(node, true);\r\n    }\r\n\r\n    onRefresh(node) {\r\n        this.requestUpdate(node);\r\n    }\r\n\r\n    onAppend(node, addedNode) {\r\n        this.#toggleState(node);\r\n        this.requestUpdate(node.root);\r\n    }\r\n\r\n    onInsert(node, insertedNode) {\r\n        this.#toggleState(node);\r\n        this.requestUpdate(node.root);\r\n    }\r\n\r\n    onExpand(node) {\r\n        const store = this.store;\r\n        if (store) {\r\n            store.onExpand(node);\r\n        } else {\r\n            this.requestUpdate(node);\r\n        }\r\n    }\r\n\r\n    onCollapse(node) {\r\n        this.requestUpdate(node);\r\n    }\r\n\r\n    onFocusChanged(node) {\r\n        this.requestUpdate(node);\r\n    }\r\n\r\n    onSelectionChanged(node, selectedNode) {\r\n        this.requestUpdate(node);\r\n    }\r\n\r\n    onRemove(node) {\r\n        if (this.match(node)) this.host(node).remove();\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { html } from '../../lib.mjs';\r\nimport { TreeNode } from '../../data/TreeNode.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSLinklement } from '../Link.mjs';\r\nimport { GSAttributeHandler } from '../../base/GSAttributeHandler.mjs';\r\n\r\nexport class GSTreeItemElement extends GSElement {\r\n\r\n  /*\r\n  static styles = css`            \r\n    :focus-visible {\r\n      outline: none !important;\r\n    }  \r\n    .list-group-item {\r\n      cursor: pointer;\r\n    }`;\r\n    */\r\n\r\n  static properties = {\r\n    loading: { state: true },\r\n    node: { type: Object, hasChanged: (newVal) => newVal instanceof TreeNode }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.flat = true;\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    return this.node ? true : false;\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    if (changed.has('node')) this.node[Symbol.for('gs-element')] = this;\r\n  }\r\n\r\n  updated() {\r\n    if (this.focused) this.query('a')?.focus();\r\n    this.dataset.visible = this.visible;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const node = me.node;\r\n    const opt = me.value || {};\r\n    opt.tooltip = me.translate(opt.tooltip)\r\n    opt.title = me.translate(opt.title)\r\n    const before = me.loading ? me.#renderSpinner(node.level) : me.#renderIcon(node.level);\r\n    return GSLinklement.generate(opt, me.renderClass(), before);\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const opt = {\r\n      'list-group-item': true,\r\n      'list-group-item-action': true,\r\n      'user-select-none  ': true,\r\n      'border-0': me.#border ? false : true,\r\n      'gs-hide': !me.visible\r\n    };\r\n    return me.mapCSS(me.#cssFocus, me.mapCSS(me.#cssSelected, opt, me.selected && !me.multiselect), me.focused);\r\n  }\r\n\r\n  /**\r\n   * Toggle folder\r\n   */\r\n  toggle() {\r\n    this.opened ? this.close() : this.open();\r\n  }\r\n\r\n  /**\r\n   * Open folder\r\n   */\r\n  open() {\r\n    this.#status(true);\r\n    this.focus();\r\n  }\r\n\r\n  /**\r\n   * Close folder\r\n   */\r\n  close() {\r\n    this.#status(false);\r\n  }\r\n\r\n  focus(val = true) {\r\n    if (val) super.focus();\r\n    this.focused = val == true;\r\n  }\r\n\r\n  select(val = true) {\r\n    this.selected = val == true;\r\n  }\r\n\r\n  handle(e) {\r\n    GSAttributeHandler.process(this.querySelector('a'), e);\r\n  }\r\n\r\n  get isLeaf() {\r\n    return this.node?.isLeaf;\r\n  }\r\n\r\n  get isFolder() {\r\n    return !this.isLeaf;\r\n  }\r\n\r\n  get key() {\r\n    return this.node?.key;\r\n  }\r\n\r\n  get value() {\r\n    return this.node?.value || {};\r\n  }\r\n\r\n  get level() {\r\n    return this.node?.level || -1;\r\n  }\r\n\r\n  get focused() {\r\n    return this.node?.focused;\r\n  }\r\n\r\n  get visible() {\r\n    const parent = this.parent;\r\n    return parent?.opened || parent?.level === -1;\r\n  }\r\n\r\n  get parent() {\r\n    return this.node?.parent;\r\n  }\r\n\r\n  get parentItem() {\r\n    const item = this.parent?.[Symbol.for('gs-element')];\r\n    return item instanceof GSTreeItemElement ? item : undefined;\r\n  }\r\n\r\n  set focused(val) {\r\n    val = val === true;\r\n    this.node.focused = val;\r\n  }\r\n\r\n  get selected() {\r\n    return this.node?.selected;\r\n  }\r\n\r\n  set selected(val) {\r\n    val = val === true;\r\n    const me = this;\r\n    if (me.isFolder && me.owner.leaf) val = false;\r\n\r\n    if (me.multiselect) {\r\n      if (val) {\r\n        me.node.selectAll();\r\n      } else {\r\n        me.node.deselectAll();\r\n      }\r\n    } else {\r\n      me.node.selected = val;\r\n    }\r\n  }\r\n\r\n  get opened() {\r\n    return this.node?.opened;\r\n  }\r\n\r\n  set opened(val) {\r\n    this.#status(val === true);\r\n  }\r\n\r\n  get owner() {\r\n    return this.closest('gs-tree');\r\n  }\r\n\r\n  get multiselect() {\r\n    return this.owner.multiselect;\r\n  }\r\n\r\n  get #cssFocus() { return this.owner.cssFocus || 'focus-ring'; }\r\n  get #cssSelected() { return this.owner.cssSelected || 'active'; }\r\n  get #cssCheck() { return this.owner.cssCheck || ''; }\r\n  get #checkColor() { return this.owner.checkColor || 'secondary'; }\r\n  get #checkColorSelected() { return this.owner.checkColorSelected || 'primary'; }\r\n\r\n  get #border() {\r\n    return this.value?.border === true || this.owner.border === true;\r\n  }\r\n\r\n  get #icon() {\r\n    const me = this;\r\n    const node = me.node;\r\n    const data = me.value;\r\n    const ui = me.owner;\r\n    let itemIco = data.icon || ui.itemIcon;\r\n    if (node.isFolder) itemIco = node.opened ? (data.openIcon || ui.openIcon) : (data.closeIcon || ui.closeIcon);\r\n    return itemIco;\r\n  }\r\n\r\n  #renderIndent(level) {\r\n    return html`<gs-indent size=\"${level}\"></gs-indent>`;\r\n  }\r\n\r\n  #renderSpinner(level) {\r\n    return html`${this.#renderIndent(level)}<gs-spinner small></gs-spinner>`;\r\n  }\r\n\r\n  #renderIcon(level) {\r\n    return html`${this.#renderIndent(level)}${this.#renderMulti()}<gs-icon size=\"5\" name=\"${this.#icon}\"></gs-icon>`;\r\n  }\r\n\r\n  #renderMulti() {\r\n    const me = this;\r\n    if (!me.multiselect) return '';\r\n    const color = me.selected ? me.#checkColorSelected : me.#checkColor;\r\n    const icon = me.node.isPartialySelected ? 'dash-square-fill' : me.selected ? 'check-square-fill' : 'square';\r\n    return html`<gs-icon size=\"6\" data-type=\"state\" \r\n                css=\"me-1 text-${color} ${me.#cssCheck}\"\r\n                name=\"${icon}\"></gs-icon>`;\r\n  }\r\n\r\n  #status(val = false) {\r\n    const me = this;\r\n    if (me.node?.isFolder) {\r\n      me.node.opened = val;\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-tree-item');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, css, createRef, ref, repeat, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSDOM } from '../../base/GSDOM.mjs';\r\nimport { TreeNode } from '../../data/TreeNode.mjs';\r\nimport { TreeController } from './controllers/TreeController.mjs';\r\nimport { color } from '../../properties/color.mjs';\r\n\r\nexport class GSTreeElement extends GSElement {\r\n\r\n  static styles = css`            \r\n    :focus-visible {\r\n      outline: none !important;\r\n    }  \r\n    .list-group-item {\r\n      cursor: pointer;\r\n    }`;\r\n\r\n  static shared = {\r\n    itemIcon: { attribute: 'icon-item' },\r\n    closeIcon: { attribute: 'icon-close' },\r\n    openIcon: { attribute: 'icon-open' },\r\n    cssCheck: { attribute: 'css-check' },\r\n    cssFocus: { attribute: 'css-focus' },\r\n    cssSelected: { attribute: 'css-selected' },\r\n    checkColor: { attribute: 'check-color', ...color },\r\n    checkColorSelected: { attribute: 'check-color-selected', ...color },\r\n  }\r\n\r\n  static properties = {\r\n    storage: {},\r\n    data: { type: Object },\r\n    node: { type: Object, hasChanged: (newVal) => newVal instanceof TreeNode },\r\n    border: { type: Boolean, reflect: true },\r\n    guide: { type: Boolean, reflect: true },\r\n    leaf: { type: Boolean, reflect: true },\r\n    multiselect: { type: Boolean, reflect: true },\r\n    circular: { type: Boolean, reflect: true },\r\n    ...GSTreeElement.shared\r\n  }\r\n\r\n  // GS-ITEM attributes mapping\r\n  static options = {\r\n    ...GSTreeElement.shared,\r\n    css: {},\r\n    icon: {},\r\n    color: {},\r\n    title: {},\r\n    tooltip: {},\r\n    opened: { type: Boolean },\r\n    selected: { type: Boolean }\r\n  }\r\n\r\n  #queued = false;\r\n  #listRef = createRef();\r\n\r\n  #controller = null;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.leaf = false;\r\n    me.multiselect = false;\r\n    me.data = GSDOM.toJson(me, true, true).items;\r\n    me.node = new TreeNode(null, { '#tagName': this.tagName }, null, -1);\r\n    me.itemIcon = 'file-earmark';\r\n    me.closeIcon = 'folder'; // caret-right; chevron-right\r\n    me.openIcon = 'folder2-open'; // caret-down; chevron-down\r\n    me.cssSelected = 'active'; // fw-bold\r\n    me.cssFocus = 'focus-ring';\r\n    me.node[Symbol.for('gs-element')] = me;\r\n    me.#controller = new TreeController(me);\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\"\r\n          class=\"treeview ${classMap(me.renderClass())}\"          \r\n          @click=\"${me.#onClick}\"\r\n          @keydown=\"${me.#onKeyDown}\"\r\n          @keyup=\"${me.#onKeyUp}\">\r\n          <div class=\"list-group\" ${ref(me.#listRef)}>\r\n          ${repeat(me.node.walk(me.node, false, false), (node) => node.key, (node) => html`\r\n            <gs-tree-item .node=\"${node}\"></gs-tree-item>\r\n          `)}\r\n          </div>    \r\n        </div>`;\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    const me = this;\r\n    if (changed.has('data') && me.data && !me.#queued) {\r\n      me.#queued = true;\r\n      queueMicrotask(() => {\r\n        me.node.clear();\r\n        me.node.fromJSON(me.data);\r\n        me.#queued = false;\r\n        me.requestUpdate();\r\n      });\r\n    }\r\n    return this.node ? true : false;\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    if (changed.has('multiselect') && !this.multiselect) this.node?.deselectAll();\r\n    this.node.multi = this.multiselect;\r\n  }\r\n\r\n  onDataRead(data) {\r\n    if (data instanceof TreeNode) {\r\n      if (data.root !== this.node) this.node = data;\r\n    } else {\r\n      this.data = data;\r\n    }\r\n  }\r\n\r\n  next(expand = false) {\r\n    const me = this;\r\n    let item = me.nextItem;\r\n    if (!item & me.circular) item = me.#first;\r\n    if (item?.visible) {\r\n      item.focus();\r\n      if (expand && me.focused?.isFolder) me.focused.open();\r\n    }\r\n    return me.focused;\r\n  }\r\n\r\n  previous(collapse = false) {\r\n    const me = this;\r\n    let item = me.previousItem;\r\n    if (!item & me.circular) item = me.#last;\r\n    if (item?.visible) {\r\n      item.focus();\r\n      if (item.isFolder && collapse) item.close();\r\n    }\r\n    return me.focused;\r\n\r\n  }\r\n\r\n  expandAll() {\r\n    this.node?.expandAll();\r\n  }\r\n\r\n  collapseAll() {\r\n    this.node?.collapseAll();\r\n  }\r\n\r\n  /**\r\n   * Open folder\r\n   */\r\n  open(path) {\r\n    const me = this;\r\n    me.focused?.open();\r\n  }\r\n\r\n  /**\r\n   * Close folder\r\n   * TODO - path navigation\r\n   */\r\n  close(path) {\r\n    const me = this;\r\n    me.focused?.close();\r\n  }\r\n\r\n  clear() {\r\n    this.node?.clear();\r\n    this.requestUpdate();\r\n  }\r\n\r\n  reload() {\r\n    this.clear();\r\n    this.dataController?.read();\r\n  }\r\n\r\n  get selected() {\r\n    return this.#host(this.node.selectedNode());\r\n  }\r\n\r\n  get focused() {\r\n    return this.#host(this.node.focusedNode());\r\n  }\r\n\r\n  /**\r\n   * Previous visible ge-node-item\r\n   */\r\n  get previousItem() {\r\n    return this.focused?.node.find(n => n?.visible, true, true)?.[Symbol.for('gs-element')];\r\n  }\r\n\r\n  /**\r\n   * Next visible ge-node-item\r\n   */\r\n  get nextItem() {\r\n    return this.focused?.node.find(n => n?.visible, true)?.[Symbol.for('gs-element')];\r\n  }\r\n\r\n  get #list() {\r\n    return this.#listRef.value;\r\n  }\r\n\r\n  get #first() {\r\n    return this.#list.firstElementChild;\r\n  }\r\n\r\n  get #last() {\r\n    return this.#list.lastElementChild;\r\n  }\r\n\r\n  #host(node) {\r\n    return node?.[Symbol.for('gs-element')];\r\n  }\r\n\r\n  #onClick(e) {\r\n\r\n    const isIcon = e.target.closest('gs-icon')?.dataset.type === 'state';\r\n    const el = e.target.closest('gs-tree-item');\r\n    if (!el.node) return;\r\n\r\n    const me = this;\r\n\r\n    if (me.multiselect) {\r\n      if (isIcon) el.select(!el.selected);\r\n    } else {\r\n      el.select(true);\r\n    }\r\n\r\n    const expandable = (me.multiselect && !isIcon) || (!me.multiselect);\r\n    if (el.isFolder && expandable) el.toggle();\r\n\r\n    el.focus();\r\n    el.handle(e);\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n\r\n    const me = this;\r\n    const el = me.focused;\r\n    if (!el) return;\r\n\r\n    switch (e.code) {\r\n      case 'ArrowUp':\r\n        me.previous();\r\n        break;\r\n      case 'ArrowDown':\r\n        me.next();\r\n        break;\r\n      case 'ArrowLeft':\r\n        if (el.isFolder) {\r\n          if (el.opened) {\r\n            me.close();\r\n          } else {\r\n            (el.parentItem || el)?.focus();\r\n          }\r\n        } else {\r\n          me.previous();\r\n        }\r\n        break;\r\n      case 'ArrowRight':\r\n        if (el.isFolder && !el.opened) {\r\n          me.open();\r\n        } else {\r\n          me.next();\r\n        }\r\n        break;\r\n    }\r\n  }\r\n\r\n  #onKeyUp(e) {\r\n\r\n    const el = e.target.closest('gs-tree-item');\r\n    if (!(el?.node)) return;\r\n\r\n    switch (e.code) {\r\n      case 'Enter':\r\n        el.handle(e);\r\n        break;\r\n      case 'Tab':\r\n        el.focus();\r\n        break;\r\n      case 'Space':\r\n        el.select(this.multiselect ? !el.selected : true);\r\n        el.focus();\r\n        break;\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-tree');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, html, ifDefined, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSLog } from '../base/GSLog.mjs';\r\n\r\nexport class GSChartElement extends GSElement {\r\n\r\n    static get URL_LIB() {\r\n        return globalThis.GS_URL_CHART || globalThis.location?.origin || '/bootstrap-lit';\r\n    }\r\n\r\n    static properties = {\r\n        url: {},\r\n        config: {},\r\n        storage: {},\r\n        height: { type: Number },\r\n        width: { type: Number },\r\n        data: { type: Array },\r\n        options: { type: Object },\r\n    }\r\n\r\n    #canvasRef = createRef();\r\n    #chart = null;\r\n\r\n    constructor() {\r\n        super();\r\n        this.height = 0;\r\n        this.width = 0;\r\n        GSChartElement.#init();\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        this.#waitInit();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        super.disconnectedCallback();\r\n        const me = this;\r\n        if (me.#chart) me.#chart.destroy();\r\n        me.#chart = null;\r\n    }\r\n\r\n    shouldUpdate(changed) {\r\n        return GSChartElement.#isChart;\r\n    }\r\n\r\n    firstUpdated(changed) {\r\n        this.#render();\r\n        super.firstUpdated(changed);\r\n    }\r\n\r\n    updated(changed) {\r\n        const me = this;\r\n        if (changed.has('url') || changed.has('config')) me.#render();\r\n        if (changed.has('data') || changed.has('options')) me.#renderData(me.data, me.options);\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<canvas ${ref(me.#canvasRef)} \r\n                class=\"${classMap(me.renderClass())}\"\r\n                width=\"${ifDefined(me.width > 0 ? me.width : false)}\" \r\n                height=\"${ifDefined(me.height > 0 ? me.height : false)}\" >\r\n            </canvas>`;\r\n    }\r\n\r\n    onDataRead(data) {\r\n        this.data = data;\r\n    }\r\n\r\n    get canvas() {\r\n        return this.#canvasRef.value;\r\n    }\r\n\r\n    // https://www.chartjs.org/docs/latest/developers/api.html\r\n\r\n    reset() {\r\n        this.#chart?.reset();\r\n    }\r\n\r\n    refresh() {\r\n        this.#chart?.render();\r\n    }\r\n\r\n    updateChart(val) {\r\n        this.#chart?.update(val);\r\n    }\r\n\r\n    stop() {\r\n        this.#chart?.stop();\r\n    }\r\n\r\n    clear() {\r\n        this.#chart?.clear();\r\n    }\r\n\r\n    resize(x, y) {\r\n        const me = this;\r\n        if (!me.#chart) return;\r\n        requestAnimationFrame(() => {\r\n            const div = me.query('div');\r\n            if (div) {\r\n                div.style.width = `${x}px`;\r\n                div.style.height = `${y}px`;\r\n            }\r\n            me.#chart.resize(x, y);\r\n        });\r\n    }\r\n\r\n    toBase64Image(type = \"image/png\", quality = 1) {\r\n        return this.#chart?.toBase64Image(type, quality);\r\n    }\r\n\r\n    // internal functions to render JSON from gs-items elements\r\n\r\n    async #render() {\r\n        const me = this;\r\n        const options = await GSLoader.loadSafe(me.config, 'GET', null, true, {});\r\n        const data = await GSLoader.loadSafe(me.url, 'GET', null, true, []);\r\n        me.data = data;\r\n        me.options = options;\r\n    }\r\n\r\n    #renderData(data, options) {\r\n        const me = this;\r\n        const el = me.querySelector('gs-item[group=\"options\"]');\r\n        const opt = Object.assign(options, GSChartElement.toJson(el));\r\n\r\n        const sets = opt.data.datasets;\r\n        sets.forEach((o, i) => o.data = sets.length === 1 ? data : data[i] || []);\r\n\r\n        if (me.#chart) return me.updateChart(opt);\r\n\r\n        const ctx = me.canvas.getContext('2d');\r\n        me.#chart = new GSChartElement.#Chart(ctx, opt);\r\n    }\r\n\r\n    async #waitInit() {\r\n        if (!GSChartElement.#isChart) await GSEvents.wait(document, 'gs-chart', 0, false);\r\n        this.requestUpdate();\r\n    }\r\n\r\n    static #isChart = false;\r\n    static #initializing = false;\r\n    static #Chart = null;\r\n\r\n    static async #init() {\r\n        const me = GSChartElement;\r\n        if (me.URL_LIB === false) return;\r\n        if (me.#isChart || me.#initializing) return;\r\n        me.#initializing = true;\r\n        try {\r\n            const origin = GSChartElement.URL_LIB;\r\n            const url = `${origin}/assets/chart/chart.mjs`;\r\n            const { Chart, registerables } = await import(url);\r\n            Chart.register(...registerables);\r\n            me.#Chart = Chart;\r\n            me.#isChart = true;\r\n            GSEvents.send(document, 'gs-chart');\r\n        } catch (e) {\r\n            GSLog.error(null, e);\r\n        } finally {\r\n            me.#initializing = false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Convert DOM tree into a JSON structure\r\n     * \r\n     * @param {HTMLElement} obj HTML element instance to convert\r\n     * @param {string} name DOM attribute name for object key\r\n     * @param {string} value DOM attribute name for object value\r\n     * @param {string} type DOM attribute name for object type\r\n     * @returns {object}\r\n     */\r\n    static toJson(el, name = 'name', value = 'value', type = 'type') {\r\n\r\n\r\n        if (!(el instanceof HTMLElement)) return {};\r\n\r\n        const nameV = el.getAttribute(name);\r\n        const valV = el.getAttribute(value);\r\n        const typeV = el.getAttribute(type);\r\n\r\n        let obj = null;\r\n\r\n        switch (typeV) {\r\n            case 'array':\r\n                obj = [];\r\n                break;\r\n            case 'object':\r\n                obj = {};\r\n                break;\r\n            default:\r\n                return GSChartElement.#toType(valV, typeV);\r\n        }\r\n\r\n        const childs = Array.from(el.children);\r\n        const isArray = typeV === 'array';\r\n        const isObject = typeV === 'object';\r\n\r\n        childs.forEach(el => {\r\n            const _nam = el.getAttribute(name);\r\n            if (isArray) {\r\n                obj.push(GSChart.toJson(el, name, value, type));\r\n            } else if (isObject) {\r\n                const tmp = GSChartElement.toJson(el, name, value, type);\r\n                obj[_nam] = tmp;\r\n            } else {\r\n                const _val = el.getAttribute(value);\r\n                const _typ = el.getAttribute(type);\r\n                obj[nameV][_nam] = GSChart.#toType(_val, _typ);\r\n            }\r\n        });\r\n\r\n        return obj;\r\n    }\r\n\r\n    static #toType(val, type) {\r\n        switch (type) {\r\n            case 'boolean': return val === 'true';\r\n            case 'number': return parseFloat(val);\r\n            default: return val\r\n        }\r\n    }\r\n\r\n    static {\r\n        this.define('gs-chart');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, ref, classMap, html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\nexport class GSHighlightElement extends GSElement {\r\n\r\n    static get URL_LIB() {\r\n        return globalThis.GS_URL_HLJS || 'https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0';\r\n    }\r\n\r\n    static properties = {\r\n        url: {},\r\n        theme: {},\r\n        target: {},\r\n        language: {},\r\n    }\r\n\r\n    #codeRef = createRef();\r\n    #data;\r\n\r\n    constructor() {\r\n        super();\r\n        this.theme = 'default';\r\n    }\r\n\r\n    willUpdate(changed) {\r\n        const me = this;\r\n        if (changed.has('theme')) me.#onTheme();\r\n        if (changed.has('target')) me.#onTarget();\r\n        if (changed.has('url')) me.#onURL();\r\n        if (changed.has('language')) me.#onHighlight(me.#data);\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<pre><code ${ref(me.#codeRef)} class=\"${classMap(me.renderClass())}\"><code/><pre/>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const hasLangauge = GSUtil.isStringNonEmpty(me.language);\r\n        const css = {\r\n            [`language-${me.language}`]: hasLangauge\r\n        }\r\n        return css;\r\n    }\r\n\r\n    /**\r\n     * Highligh some code in programmatic way\r\n     * \r\n     * @param {string} data \r\n     */\r\n    highlight(data = '', append = false) {\r\n        this.#data = data;\r\n        this.#onHighlight(data, append);\r\n    }\r\n\r\n    set content(val ='') {\r\n        this.#data = val;\r\n        this.#onHighlight(val);\r\n    }\r\n\r\n    get content() {\r\n        return this.#data;\r\n    }\r\n\r\n    async #onTheme() {\r\n        const url = `${GSHighlightElement.URL_LIB}/styles/${this.theme}.min.css`;\r\n        GSDOM.injectCSS(this, url);\r\n    }\r\n\r\n    /**\r\n     * Search with CSS query for element, if found, \r\n     * get innerHTML, and send to highlighting\r\n     */\r\n    #onTarget() {\r\n        const me = this;\r\n        const el = me.target ? GSDOM.query(me.target) : null;\r\n        if (!el) return GSDOM.setHTML(me.#code, `Element with id ${me.target} not found!`);\r\n        me.#data = el.innerHTML;\r\n        me.#onHighlight(el.innerHTML);\r\n    }\r\n\r\n    /**\r\n     * Download source from URL, then send to highlighting\r\n     */\r\n    async #onURL() {\r\n        const me = this;\r\n        const data = await GSLoader.load(me.url);\r\n        if (!data) return GSDOM.setHTML(me.#code, `Code URL ${me.url} unreachable!`);\r\n        me.#data = data;\r\n        me.#onHighlight(data);\r\n    }\r\n\r\n    get #code() {\r\n        return this.#codeRef.value;\r\n    }\r\n\r\n    #onMessage(e) {\r\n        const me = this;\r\n        const content = e.data.data;\r\n        URL.revokeObjectURL(e.data.url);\r\n        GSDOM.setHTML(me.#code, e.data.append ? me.#code.innerHTML + content : content);\r\n        e.target.terminate();\r\n    }\r\n\r\n    #onHighlight(data = '', append = false) {\r\n        const me = this;\r\n        if (!data) return GSDOM.setHTML(me.#code, 'No data!');\r\n        const response = me.#worker;\r\n        const blob = new Blob([response], { type: 'application/javascript' });\r\n        const blobURL = URL.createObjectURL(blob);\r\n        const worker = new Worker(blobURL);\r\n        worker.onmessage = me.#onMessage.bind(me);\r\n        worker.postMessage({ data: data, url: blobURL, append: append });\r\n    }\r\n\r\n    get #worker() {\r\n        const me = this;\r\n        const langs = me.language ? me.language.split(',').map(v => `importScripts('${GSHighlightElement.URL_LIB}/languages/${v.trim()}.min.js');`).join('') : '';\r\n        return `globalThis.onmessage = (event) => {\r\n                importScripts('${GSHighlightElement.URL_LIB}/highlight.min.js');\r\n                ${langs}\r\n                const result = globalThis.hljs.highlightAuto(event.data.data);\r\n                postMessage({data:result.value, url:event.data.url, append: event.data.append});};`\r\n    }\r\n\r\n    static {\r\n        this.define('gs-highlight');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, html, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\nexport class GSMarkdownElement extends GSElement {\r\n\r\n    static get URL_LIB() {\r\n        return globalThis.GS_URL_MARKDOWN || 'https://unpkg.com/showdown/dist/showdown.min.js';\r\n    }\r\n\r\n    static properties = {\r\n        url: {},\r\n        history: { type: Number },\r\n        maxHeight: { type: Number, attribute: 'max-height' },\r\n    }\r\n\r\n    #containerRef = createRef();\r\n    #converter = null;\r\n    #last = null;\r\n    #first = null;\r\n    #root = null;\r\n    #path = null;\r\n    #cache = [];\r\n\r\n    #styleID = GSID.id;\r\n\r\n    constructor() {\r\n        super();\r\n        this.history = 10;\r\n        this.dynamicStyle(this.#styleID);\r\n    }\r\n\r\n    async connectedCallback() {\r\n        const me = this;\r\n        await me.#initLib();\r\n        if (globalThis.showdown) {\r\n            const opt = { tasklists: true, tables: true };\r\n            me.#converter = new globalThis.showdown.Converter(opt);\r\n            super.connectedCallback();\r\n        }\r\n    }\r\n\r\n    willUpdate(changed) {\r\n        const me = this;\r\n        if (changed.has('url')) {\r\n            me.#toCache(me.url);\r\n            me.#onURL(me.url);\r\n        }\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        const height = me.maxHeight > 0 ? `${me.maxHeight}px;` : false;\r\n        const opt = { 'max-height': height }\r\n        me.dynamicStyle(me.#styleID, opt);\r\n        return html`<div ${ref(me.#containerRef)} class=\"overflow-auto ${classMap(me.renderClass())}\"><div/>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const hasLangauge = GSUtil.isStringNonEmpty(me.language);\r\n        const css = {\r\n            [me.#styleID] : true,\r\n            [`language-${me.language}`]: hasLangauge\r\n        }\r\n        return css;\r\n    }\r\n\r\n    back() {\r\n        const me = this;\r\n        const url = me.#fromCache();\r\n        me.#onURL(url);\r\n    }\r\n\r\n    get root() {\r\n        return this.#root || '';\r\n    }\r\n\r\n    /**\r\n     * Return injection point for rendered markdown\r\n     */\r\n    get #container() {\r\n        return this.#containerRef.value;\r\n    }\r\n\r\n    /**\r\n     * Download source from URL, then send to rendering\r\n     */\r\n    async #onURL(url = '') {\r\n        const me = this;\r\n\r\n        url = me.#normalize(url);\r\n        if (!url) return;\r\n\r\n        let data = await GSLoader.load(url);\r\n        if (!data) return;\r\n\r\n        me.#path = me.#parent(url);\r\n        if (!me.#root) me.#root = me.#path;\r\n\r\n        // MD library error fix\r\n        data = data.replace(/^[-_\\*]{3}$/gm, '<hr>');\r\n\r\n        me.#container.innerHTML = me.#makeHtml(data);\r\n\r\n        GSEvents.send(me, 'data', url);\r\n        requestAnimationFrame(() => {\r\n            me.#handleLinks();\r\n            me.#handleTables();\r\n            me.#handleCode();\r\n        });\r\n    }\r\n\r\n    #normalize(url = '') {\r\n        const me = this;\r\n        if (!url || url.startsWith('http')) return url;\r\n        return me.#path ? new URL(url, me.#path).toString() :\r\n            GSLoader.normalizeURL(url, true);\r\n    }\r\n\r\n    #parent(url = '') {\r\n        return url.endsWith('/') ? url : GSLoader.parentPath(url);\r\n    }\r\n\r\n    #handleCode() {\r\n        this.#handleStyles('pre:has(code)', 'text-white bg-dark p-1');\r\n    }\r\n\r\n    #handleTables() {\r\n        const me = this;\r\n        const clss = \"table table-light table-hover table-striped table-bordered w-auto shadow-sm\";\r\n        me.#handleStyles('table', clss);\r\n    }\r\n\r\n    #handleStyles(qry, css) {\r\n        const me = this;\r\n        const list = GSDOM.queryAll(me.#container, qry);\r\n        requestAnimationFrame(() => list.forEach(el => GSDOM.toggleClass(el, css)) );\r\n    }\r\n\r\n    #handleLinks() {\r\n        const me = this;\r\n        const links = GSDOM.queryAll(me.#container, 'a').filter(el => !GSAttr.get(el, 'href').startsWith('#'));\r\n\r\n        links\r\n            .filter(el => !(GSAttr.get(el, 'href').endsWith('.md') || GSAttr.get(el, 'href').endsWith('/')))\r\n            .forEach(el => el.target = \"_blank\");\r\n\r\n        links\r\n            .filter(el => GSAttr.get(el, 'href').endsWith('.md') || GSAttr.get(el, 'href').endsWith('/'))\r\n            .forEach(el => GSEvents.attach(el, el, 'click', me.#onLinkClick.bind(me)));\r\n\r\n    }\r\n\r\n    #onLinkClick(e) {\r\n        const me = this;\r\n        const el = e.target;\r\n        const href = GSAttr.get(el, 'href');\r\n        if (href.startsWith('#')) return;\r\n        GSEvents.prevent(e);\r\n        el.href = me.#normalize(href);\r\n\r\n        const success = GSEvents.send(me, 'link', el.href, false, false, true);\r\n        if (!success) return;\r\n\r\n        me.#toCache(el.href);\r\n        me.#onURL(el.href);\r\n        return false;\r\n    }\r\n\r\n    #fromCache() {\r\n        const me = this;\r\n        if (me.#cache.length === 0 ) return me.#first;\r\n        const url = me.#cache.pop();\r\n        return url && url === me.#last ? me.#fromCache() : url;\r\n    }\r\n\r\n    #toCache(url) {\r\n        const me = this;\r\n        if (me.#cache.length >= me.history) me.#cache = me.#cache.slice(1);\r\n        if (me.#last == url) return;\r\n        me.#cache.push(url);\r\n        me.#last = url;\r\n        if (!me.#first) me.#first = url;\r\n    }\r\n\r\n    #makeHtml(data) {\r\n        return this.#converter.makeHtml(data);\r\n    }\r\n\r\n    async #initLib() {\r\n        const me = this;\r\n        if (globalThis.showdown) return;\r\n        const script = document.createElement('script');\r\n        const promise = GSEvents.wait(script, 'load', 0, false);\r\n        script.type = \"text/javascript\";\r\n        script.src = GSMarkdownElement.URL_LIB;\r\n        GSDOM.appendChild(document.head, script);\r\n        await promise;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-markdown');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2024 Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, html, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\n\r\nexport class GSMonacoElement extends GSElement {\r\n\r\n    static get URL_LIB() {\r\n        return globalThis.GS_URL_MONACO || 'https://unpkg.com/monaco-editor@latest/min/';\r\n    }\r\n\r\n    static properties = {\r\n        url: {},\r\n        theme: {},\r\n        target: {},\r\n        language: {},\r\n    }\r\n\r\n    #containerRef = createRef();\r\n    #editor = null;\r\n\r\n    constructor() {\r\n        super();\r\n        this.language = '';\r\n        this.theme = 'vs-dark';\r\n    }\r\n\r\n    async connectedCallback() {\r\n        await GSMonacoElement.#init();\r\n        super.connectedCallback();\r\n    }\r\n\r\n    createRenderRoot() {\r\n        return this;\r\n    }\r\n\r\n    firstUpdated() {\r\n        this.#onMonacoReady();\r\n        super.firstUpdated();\r\n    }\r\n\r\n    willUpdate(changed) {\r\n        const me = this;\r\n        if (!me.#editor) return;\r\n        if (changed.has('theme')) me.#onTheme(me.theme);\r\n        if (changed.has('target')) me.#onTarget(me.target);\r\n        if (changed.has('url')) me.#onURL(me.url);\r\n        if (changed.has('language')) me.#onLanguage(me.language);\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div ${ref(me.#containerRef)} class=\"${classMap(me.renderClass())}\"><div/>`;\r\n    }\r\n\r\n    get monaco() {\r\n        return window.monaco;\r\n    }\r\n\r\n    get editor() {\r\n        return this.#editor;\r\n    }\r\n\r\n    get model() {\r\n        return this.#editor.getModel();\r\n    }\r\n\r\n    /**\r\n     * Get editor code \r\n     * \r\n     * @param {string} data \r\n     */\r\n    get code() {\r\n        return this.#editor?.getValue() || '';\r\n    }\r\n\r\n    set code(data = '') {\r\n        const me = this;\r\n        if (me.#editor) me.#editor.setValue(data);\r\n    }\r\n\r\n    /**\r\n     * Get text selected in Monaco\r\n     */\r\n    get selection() {\r\n        const me = this;\r\n        return me.model.getValueInRange(me.editor.getSelection());\r\n    }\r\n\r\n    get owner() {\r\n        return this.parentElement;\r\n    }\r\n\r\n    #onLanguage(language) {\r\n        const me = this;\r\n        if (me.monaco && language) {\r\n            me.monaco.editor.setModelLanguage(me.model, language);\r\n        }\r\n    }\r\n\r\n    #onTheme(theme) {\r\n        const me = this;\r\n        if (me.monaco && theme) me.monaco.editor.setTheme(theme);\r\n    }\r\n\r\n    /**\r\n     * Search with CSS query for element, if found, \r\n     * get innerHTML, and send to highlighting\r\n     */\r\n    #onTarget(target) {\r\n        const me = this;\r\n        const el = target ? GSDOM.query(target) : null;\r\n        if (!el) return me.code = `Element with id ${target} not found!`;\r\n        me.code = el.innerHTML;\r\n    }\r\n\r\n    /**\r\n     * Download source from URL, then send to highlighting\r\n     */\r\n    async #onURL(url) {\r\n        const me = this;\r\n        const data = url ? await GSLoader.load(url) : null;\r\n        if (!data) return me.code = `Code URL ${url} unreachable!`;\r\n        me.code = '';\r\n        me.#onLanguage(me.language);\r\n        me.code = data;\r\n    }\r\n\r\n    #onMonacoReady() {\r\n\r\n        const me = this;\r\n\r\n        const opt = {\r\n            value: ``,\r\n            language: me.language,\r\n            theme: me.theme,\r\n            automaticLayout: true,\r\n            minimap: { enabled: false }\r\n        };\r\n\r\n        me.#editor = me.monaco?.editor?.create(me.#container, opt);\r\n\r\n        me.attachEvent(window, 'resize', me.#onResize.bind(me));\r\n\r\n        try {\r\n            if (me.url) {\r\n                me.#onURL(me.url);\r\n            } else if (me.target) {\r\n                me.#onTarget(me.target);\r\n            }\r\n        } finally {\r\n            requestAnimationFrame(() => me.emit('initialized'));\r\n            me.#onResize();\r\n        }\r\n    }\r\n\r\n    #onResize(e) {\r\n        const me = this;\r\n        me.#editor?.layout({ width: 0, height: 0 });\r\n\r\n        requestAnimationFrame(() => {\r\n            const rect = me.owner.getBoundingClientRect();\r\n            me.#editor?.layout({ width: rect.width, height: rect.height });\r\n        })\r\n    }\r\n\r\n    get #container() {\r\n        return this.#containerRef.value;\r\n    }\r\n\r\n    static #initialized;\r\n\r\n    static async #initLib() {\r\n        if (globalThis.monaco) return;\r\n        const script = document.createElement('script');\r\n        const promise = GSEvents.wait(script, 'load', 0, false);\r\n        script.type = \"text/javascript\";\r\n        script.src = `${GSMonacoElement.URL_LIB}vs/loader.js`;\r\n        GSDOM.appendChild(document.head, script);\r\n        await promise;\r\n    }\r\n\r\n    // Before loading vs/editor/editor.main, define a global MonacoEnvironment that overwrites\r\n    // the default worker url location (used when creating WebWorkers). The problem here is that\r\n    // HTML5 does not allow cross-domain web workers, so we need to proxy the instantiation of\r\n    // a web worker through a same-domain script\r\n    static #initEnv() {\r\n        const url = GSMonacoElement.URL_LIB;\r\n        window.MonacoEnvironment = {\r\n            baseUrl: `${url}`,\r\n            getWorkerUrl: (workerId, label) => {\r\n                return `data:text/javascript;charset=utf-8,${encodeURIComponent(`\r\n                globalThis.MonacoEnvironment = {baseUrl: '${url}'};\r\n                importScripts('${url}vs/base/worker/workerMain.js');`\r\n                )}`;\r\n            }\r\n        };\r\n    }\r\n\r\n    static #initMonaco() {\r\n        return new Promise((resolve, reject) => {\r\n            // TODO  set disabled to true and manually load themes into shadow dom\r\n            require.config({\r\n                paths: { 'vs': `${GSMonacoElement.URL_LIB}/vs` },\r\n                'vs/css': { disabled: false }\r\n            });\r\n            require(['vs/editor/editor.main'], resolve);\r\n        });\r\n    }\r\n\r\n    static async #init() {\r\n        const me = GSMonacoElement;\r\n        if (me.#initialized) return;\r\n        me.#initEnv();\r\n        await me.#initLib();\r\n        await me.#initMonaco();\r\n        me.#initialized = true;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-monaco');\r\n    }\r\n\r\n}"],"names":["GSVersion","version","build","gsstyles","GSLog","static","el","msg","this","print","tracing","forced","type","logging","tmp","nodeName","id","fn","console","log","Error","Object","seal","GSUtil$1","GSUtil","globalThis","GS_FLAT","n","isNaN","parseFloat","isFinite","v","Date","Boolean","value","toString","val","trim","toLowerCase","str","obj","replace","x","g","split","reverse","join","word","toUpperCase","slice","map","i","capitalize","constructor","min","max","Math","match","dft","locale","isString","sep","numberSeparator","extractNumber","replaceAll","isNumber","url","test","startsWith","endsWith","pattern","charset","floor","random","length","navigator","language","languages","flags","RegExp","isStringEmpty","undefined","Intl","NumberFormat","format","DateTimeFormat","string","isNull","Array","isArray","isJsonString","isJsonType","normalize","JSON","parse","normalizeJson","warn","JSON_NORMALIZE","def","separator","filter","capitalizeAll","tpl","params","names","keys","vals","values","Function","text","textArea","document","createElement","innerHTML","isStringNonEmpty","o","window","forEach","a","left","right","lmatch","rmatch","time","signal","AbortSignal","timeout","Promise","resolve","reject","iid","setTimeout","bind","addEventListener","clearTimeout","data","name","blob","Blob","URL","createObjectURL","href","download","click","revokeObjectURL","clazz","ext","freeze","expose","HTMLElement","isPrototypeOf","customElements","get","define","extends","isSealed","isFrozen","self","src","import","result","permissions","query","state","clipboard","writeText","readText","GSFunction$1","GSFunction","isFunction","includes","own","isFunctionDefined","desc","Reflect","getOwnPropertyDescriptor","__proto__","isValid","callFunctionAsync","Symbol","toStringTag","owner","args","arguments","from","apply","native","parseFunction","isFunctionNative","isFunctionAsync","callFunctionSync","parseValue","context","cnt","async","contextualize","accept","queueMicrotask","e","GSID","prefx","next","s","l","h","charCodeAt","GSAttr$1","GSAttr","isHTMLElement","setAttribute","removeAttribute","isInstance","getAttribute","attr","asBool","asNum","toJson","set","NaN","stringify","entries","kv","attributes","host","opt","recursive","Proxy","target","prop","dataset","attribute","toggle","Number","setAsNum","children","proxify","safe","unsafe","dflt","default","multi","hasAttribute","toStringArray","GSCSSMap$1","GSCSSMap","body","computedStyleMap","element","getMap","me","modern","capitalizeAttr","asText","to","unit","shift","matches","getComputedStyle","getComputedStyledMap","String","on","selText","ors","some","selector","logicalORs","styleSheets","cssRules","reduce","all","concat","containsAny","selectorText","GSDate","DEFAULT_FORMAT","asJSON","REGEX_FORMAT","last","getDate","first","getDay","mondayFirst","isMondayFirst","days","repeat","push","year","getFullYear","setFullYear","month","getMonth","setMonth","day","setDate","YY","YYYY","M","MM","padStart","MMM","toLocale","MMMM","D","DD","d","dd","ddd","weekday","dddd","H","getHours","HH","formatHour","hh","meridiem","A","m","getMinutes","mm","getSeconds","ss","SSS","getMilliseconds","Z","zoneStr","ZZ","Q","ceil","k","kk","W","date","getTime","setHours","week1","round","WW","X","short","offset","Locale","weekInfo","firstDay","charAt","toLocaleString","size","isLowercase","hour","hour12","pop","negMinutes","getTimezoneOffset","minutes","abs","minuteOffset","getDateFormat","regex","getFormattedDateRegex","parseFormattedDate","groups","y","Y","valueOf","GSData","currency","extract","Set","b","every","index","toSorted","compareArrays","second","arr","indexOf","list","it","cfg","toType","rule","toRegex","fmt","style","fields","limit","sts","rec","filterRecord","filterSimple","filterComplex","key","filterValue","found","flt","matchDate","matchNumber","op","toLocaleLowerCase","local","toLocaleDateString","iso","toISOString","operator","sort","sortPair","ord","idx","col","v1","v2","compare","order","compareNum","compareString","isBool","compareBool","isDate","s1","s2","localeCompare","ignoreNull","seg","writeSingleToOject","tree","hasOwnProperty","partial","r","readFromProperty","readFromObject","GSDOM$1","GSDOM","activeElement","active","shadowRoot","css","visibility","display","opacity","rect","getBoundingClientRect","width","height","html","single","mime","doc","DOMParser","parseFromString","head","firstElementChild","error","forceWrap","nodes","fromNode","wrap","appendChild","link","slot","isText","tagName","FORMEL","queryAll","HTMLButtonElement","hasClass","ownClazz","inheritance","pel","HTMLSlotElement","HTMLTemplateElement","SVGElement","Text","Comment","clazzName","childNodes","isGSElement","orientation","classList","add","remove","newEl","injectable","isSVGElement","isOK","invalid","parentNode","nextElementSibling","insertBefore","placement","isok","insertAdjacentElement","parent","removeChild","node","closest","shadow","parentAll","childAll","child","parentElement","offsetParent","c","ShadowRoot","HTMLBodyElement","root","getByID","documentElement","walk","qry","levels","proxy","res","receiver","sanitize","sanitizer","setHTML","Document","textContent","requestAnimationFrame","toggleClass","contains","unwrap","querySelectorAll","valueAsNumber","selectedOptions","checked","getValue","styleValue","textTransform","ignore","checkValidity","writeToOject","toValue","fromObject2Element","objectPathExist","fromValue","plain","innerText","items","tag","asString","fromJsonAsString","fromJsonAsDOM","title","sub","location","hash","setValue","group","disabled","createTreeWalker","NodeFilter","SHOW_TEXT","nextNode","ts","textNodesUnder","t","wholeText","nextSibling","nodeValue","CLEANUP1","whiteList","asState","isAllowed","toValidationError","allowElement","allowTag","fetch","ok","sheet","CSSStyleSheet","replaceSync","adoptedStyleSheets","GSEvents","Map","altContext","protect","listen","onContext","onKeyDown","event","shiftKey","prevent","code","ctrlKey","callback","loaded","wait","callFunction","sendSuspended","once","chained","susspended","removeEventListener","unlisten","toSignal","internal","full","hasFunction","preventDefault","stopPropagation","stopImmediatePropagation","sender","bubbles","composed","cancelable","CustomEvent","detail","dispatchEvent","evt","ClipboardEvent","FocusEvent","InputEvent","KeyboardEvent","MouseEvent","SubmitEvent","TouchEvent","WheelEvent","PointerEvent","send","capture","Window","isConnected","eventKey","elmap","getElementMap","eventMap","fnkey","defineProperty","gsid","writable","delete","removeListener","cache","removeElementMap","clear","elid","getElementID","fnid","getCallbackID","hashCode","for","action","onAction","prefix","findAction","onError","GS_LOG_ACTION","rid","waitAnimationFrame","onResize","attach","GSAbortController","AbortController","super","abort","clearInterval","GSDOMObserver","MutationObserver","observe","childList","subtree","observer","onObserve","forRemove","filtersDel","filtersAdd","hasFilters","hasFiltersAdd","hasFiltersDel","mutations","mutation","addedNodes","removedNodes","rootEL","filters","isFunctions","getFilter","exec","create","GSDynamicStyle","deleteRule","getRule","setRule","sync","insertRule","updateRule","isImportant","setProperty","source","dynamicStyleSheetByID","dynamicStyleSheet","gsClass","dynamicRule","dynamicRuleByID","dynamicStyle","assign","dynamicStyleByID","GSCacheStyles","store","dynamic","styles","adopt","adoptedId","GSAdoptedEngine","now","preload","timerID","setInterval","sheets","adoptable","adoptSheet","update","scheduled","sorted","ID","cssText","monitorAttributes","ownerNode","adoptStyle","disconnect","mutationList","onAttributeChange","attributeFilter","attributeOldValue","HTMLLinkElement","rel","as","HTMLStyleElement","then","adoptLink","registerFilter","onMonitorFilter","onMonitorConnect","onMonitorDisconnect","init","GSEnvironment","isMobile","userAgentData","mobile","userAgent","isDesktop","isWebkit","protocol","strVal","brands","brand","strAgt","isEdge","isDevice","platform","screen","otype","GSPromise","callbacks","promise","onAbort","await","aborted","onResolve","onReject","ps","p","GSEvent","EventTarget","listeners","listener","abortable","controller","off","emit","delayed","unbind","GSEventBus","register","registry","has","exist","bus","GSGesture","xDiff","yDiff","xDown","yDown","bindings","swipe","tap","longPress","delay","querySelector","move","handleTouchMove","start","handleTouchStart","end","handleTouchEnd","touches","clientX","clientY","onLongPress","xUp","yUp","GSItem","validate","tags","collect","definition","GSLoader","GS_TEMPLATE_URL","origin","TEMPLATE_URL","hasKey","NO_CACHE","GS_NO_CACHE","localStorage","setItem","getItem","base","path","isFile","pathname","isExt","uri","UNIQUE","searchParams","append","level","isHTML","getTemplateURL","loadSafe","templateURL","normalizeURL","templatePath","method","load","headers","asjson","ct","Accept","json","isJson","func","isFunc","GS_LOCALIZATION_LANGUAGE","lang","GSLocalization","GSLocalizationImpl","queue","queued","GS_LOCALIZATION_URL","translate","deft","getLanguage","texthash","reset","promises","loadWait","sequential","Pragma","isDefault","hk","details","GSPopper","asRect","sx","scrollX","sy","scrollY","top","bottom","centerX","centerY","calcPadding","padding","elementPadding","paddingX","paddingY","elementWidth","clientWidth","elementHeight","clientHeight","elementX","elementY","arrow","pos","fromPlacement","isPlacementValid","position","margin","transform","offh","offw","boundingRect","arect","updateArrow","offH","offW","srcH","srcW","calcFixed","astyle","inset","srect","getOffset","calcAbsolute","aopt","isTop","isBottom","isStart","isEnd","trect","erect","arrowPosW","arrowPosH","applyDynamicStyle","GSQueryCSS","property","object","GSQuery","instance","GSTemplateCache","template","isTemplateElement","content","cloneNode","cached","getOrCreate","isHTMLTemplate","initTemplate","loadTemplate","isFunctionTemplate","getElementById","loadHTMLTemplate","loadFunctionTemplate","loadURLTemplate","GSTheme","switch","theme","STORAGE","htmlEl","bsTheme","matchMedia","q","URLSearchParams","onTheme","settings","getSystemDefaultTheme","darkMode","lightMode","setup","GSAttributeHandler","anchor","call","inject","swap","trigger","calls","toggles","triggers","handle","targets","handleTarget","handleBinding","handleAction","handleAttribute","handleProperty","handleToggle","handleTrigger","handleCall","handleExec","handleSwap","handleInject","handleTemplate","field","form","isForm","HTMLFormElement","isField","isFormElement","toObject","isAttributeJSON","jsonToAttr","toggleAttribute","isPropertyJSON","properties","toggleProperty","tout","symbol","toHTML","applyContent","applyTemplate","clone","insertAdjacent","deattach","DEFINITION","Stack","item","unshift","peek","isEmpty","Queue","enqueue","dequeue","BinaryTreeNode","isLeaf","hasChildren","isRoot","BinaryTree","inOrderTraversal","postOrderTraversal","preOrderTraversal","insert","parentNodeKey","canInsertLeft","canInsertRight","find","Node","previous","release","toJSON","DoublyLinkedList","tail","previousNode","insertAt","splice","insertFirst","insertLast","getAt","removeAt","acc","toArray","iterator","isInvalid","isInvalidIndex","isInteger","Tree","folder","leaf","up","levelID","nodeID","isFolder","hasMore","firstChild","lastChild","down","previousSibling","inclusive","flat","iterate","filtered","Je","newOne","findByKey","flatten","fromJSON","raw","hasParent","GSReadWriteRegistryImpl","handlers","INTERNAL","addHandler","removeHandler","getHandler","newHandler","enabled","verify","unregister","rw","GSReadWriteRegistry","GSAbstractReadWrite","processors","enable","addProcessor","processor","removeProcessor","disable","isRegistered","notify","onRead","postRead","onWrite","postWrite","GSReadWrite","reader","writer","mode","skip","MODES","isQuark","METHOD","toURL","encodeURIComponent","fromLiteral","isOffline","isRemote","GSCachedReader","reformat","records","postFilter","sortData","filterData","search","read","TreeNode","opened","focused","selected","focusedNode","selectedNode","controllers","select","focus","open","addController","removeController","visible","expand","collapse","changed","onFocusChanged","onSelectionChanged","isPartialySelected","selectAll","deselectAll","selectionFlag","onSelectAll","onDeselectAll","selectedNodes","refresh","onRefresh","loading","onLoad","expandAll","collapseAll","expanded","collapsed","onExpand","onCollapse","onAppend","onInsert","GSTreeReader","litUrl","GS_LIT_URL","litModule","ReactiveController","ReactiveElement","AsyncDirective","AsyncReplaceDirective","CSSResult","Directive","LitElement","PartType","TemplateResultType","UnsafeHTMLDirective","UntilDirective","_$LE","_$LH","adoptStyles","asyncAppend","asyncReplace","choose","classMap","clearPart","createRef","defaultConverter","directive","getCommittedValue","getCompatibleStyle","getDirectiveClass","guard","ifDefined","insertPart","isCompiledTemplateResult","isDirectiveResult","isPrimitive","isServer","isSingleExpression","isTemplateResult","keyed","literal","live","noChange","notEqual","nothing","range","ref","removePart","render","setChildPartValue","setCommittedValue","staticHtml","staticSvg","styleMap","supportsAdoptingStyleSheets","svg","templateContent","unsafeCSS","unsafeHTML","unsafeSVG","unsafeStatic","until","when","withStatic","gsAction","gsAnchor","gsAttribute","gsCall","gsExec","gsInject","gsProperty","gsSwap","gsTarget","gsTemplate","gsToggle","gsTrigger","gsValue","DatasetDirective","part","srcset","DOMStringMap","remap","hasOwn","descriptors","getOwnPropertyDescriptors","listProperties","listGetters","getPrototypeOf","literalTemplate","listGettable","cssMap","CssMapDirective","partInfo","ATTRIBUTE","strings","classInfo","_previousClasses","_staticClasses","notEmpty","newVal","oldVal","numGT0","numGE0","numLT0","numLE0","ButtonTypes","buttonType","hasChanged","is","ColorTypes","color","EnvironmentTypes","environment","InputTypes","inputType","NavTypes","nav","OrientationTypes","PlacementTypes","PositionTypes","ProtocolTypes","SizeTypes","normal","medium","small","large","big","stringArrayConverter","fromAttribute","toAttribute","AdoptedController","hostConnected","hostDisconnected","isGlobal","rules","removeRule","renderRoot","onAdopted","AttributeController","eventName","onNotify","isFormEl","ContentController","refs","removeContent","hostUpdated","isSelf","contentRef","options","renderOptions","renderBefore","previousElementSibling","keep","DataController","readCallback","writeCallback","errorCallback","write","storeID","storage","firstPage","page","lastPage","nextPage","prevPage","onDataRead","onDataWrite","onDataError","ElementMoveController","attached","cursorX","cursorY","mouseUpCallback","mouseDownCallback","mouseMoveCallback","onMouseUp","onMouseDown","onMouseMove","attachEvent","removeEvent","onStartMove","onEndMove","onCursorRight","onCursorLeft","onCursorUp","onCursorDown","ElementNavigationController","multiselect","circular","multiple","onKeyUp","onClick","onFocusIn","onFocusOut","lastElementChild","blur","onSelected","onDeselected","onFocused","isNavigable","composedPath","OrientationController","hosts","requestUpdate","onOrientation","ThemeController","hostUpdate","updateTheme","updateThemeExt","TemplateController","lastRef","injected","request","templateInjected","templateRef","schedule","tasks","task","process","finally","SlotController","onSlotChanged","assignedElements","onSlotInjected","LocalizationController","updateLanguage","updateLanguageExt","langauge","onLanguage","GSElement","rtl","reflect","hide","rounded","bordered","onready","os","browser","adopted","uiHandler","localization","dataController","slotController","themes","attributeChangedCallback","oldValue","newValue","connectedCallback","isBindable","binded","disconnectedCallback","deattachListeners","createRenderRoot","firstUpdated","willUpdate","relink","isAllowRender","renderUI","renderTemplate","renderClass","border","mapCSS","flag","waitEvent","direction","isFocused","isValidEnvironment","isValidBrowser","isValidOS","isValidProtocol","isValidOrientation","parentComponent","definitions","mergeObjects","elementStyles","cssRule","setCSSProperty","GSAccordionElement","autoclose","cssItem","cssHeader","cssBody","renderItems","close","message","isItemCloser","GSAccordionItemElement","shouldUpdate","changedProperties","component","GSAlertElement","closed","closable","pause","interval","handleBillboard","updated","show","isBillboard","button","billboard","GSButtonElement","clickCss","hoverCss","toggleColor","autofocus","outline","toggling","icon","tooltip","refEl","refIco","onMouseOver","onMouseOut","iconEl","animate","isReset","isSubmit","submit","hover","isReest","iconHtml","renderIcon","GSCalendarElement","arrovPrev","arrowNext","cssDays","cssToday","cssWeeks","cssMonth","cssYear","cssNav","cssSelected","minYear","maxYear","arrowPrev","previousMonth","nextMonth","previousYear","nextYear","formatted","updateTarget","week","dayList","months","monthsHTML","yearHTML","onKey","onDay","daysHTML","tgt","HTMLInputElement","valueAsDate","isToday","today","c1","c2","current","monthList","onMonth","onYear","selectedIndex","GSCardElement","imageStyle","overlay","align","image","subtitle","footer","header","colorText","colorBack","colorBorder","cssTitle","cssSubtitle","cssFooter","cssImage","styleID","isVertical","renderVertical","renderHorizontal","imageTop","imageBottom","isBefore","startClass","endClass","startHtml","images","endHtml","isHorizontal","imageSlot","GSCenterElement","GSMenuElement","auto","dark","menuRef","closeSubmenus","updatePosition","onMouseLeave","submenu","dropend","dropstart","popup","caller","isMouseOrPointerEvent","renderSubmenu","renderHeader","renderMenu","renderDivider","menu","toSubmenu","menuItem","isSubmenu","innerWidth","GSContextElement","attachTarget","assignedSlot","onPopup","GSCompareElement","background","before","after","elRef","clipRef","slideRef","mouseController","elPosition","splitter","onDoubleClick","isAuto","pct","isFixed","slider","clip","GSControllerElement","module","changes","initialize","GSCopyrightElement","company","isCompany","isYear","GSDataHandler","autoload","autorefresh","config","handler","lifoReadRef","initLIFO","PROPERTIES","updateHandler","formatSort","formatFilter","isDebug","gsDebug","formated","verifyHandler","save","callOnceLifo","lifoReadRefCallback","lifoRead","GSDialogElement","standard","escapable","cancelText","confirmText","minWidth","buttonAlign","iconCancel","iconConfirm","colorCancel","colorConfirm","cssCancel","cssConfirm","cssContent","dialogRef","btnConfirmRef","btnCancelRef","CSS","TITLE_CSS","HEADER_CSS","ALIGN","CANCEL","CONFIRM","updateStack","STACK","dialog","showModal","focusable","renderConfirm","onConfirm","renderCancel","onCancel","renderFooter","onForm","onSubmit","info","confirm","prompt","forms","f","tab","btnConfirm","btnCancel","QUERY_INPUT","isVisible","ret","GSDrawerElement","backdrop","scroll","fingers","transition","duration","cssHead","onLeave","onEnter","hasHeader","headSlot","GSDropdownElement","renderButton","buttonClass","btn","GSEmailElement","user","domain","dev","updateUser","updateDomain","GSFormElement","formRef","onChange","elements","inputs","fromObject","disableInput","enableInput","reportValidity","defaultValue","onFieldChange","GSFormGroupElement","layout","description","label","placeholder","mask","step","minLength","maxLength","autoid","autocopy","autoselect","autocapitalize","autocomplete","reveal","readonly","required","cellField","cellLabel","cssLabel","cssField","inputRef","ouptutRef","patterns","validateAllowed","ICON","CSS_LABEL","CSS_LABEL_CELL","onRange","formElements","renderFloating","cssCheck","renderInput","renderOutput","renderLabel","renderInfo","renderLabelWrap","renderField","isIcon","CSS_ICON","renderTooltip","isRange","idattr","isFieldset","radioLayout","fieldSet","inputHTML","fld","vertical","isSwitch","onBlur","isCheckable","isFloating","setCustomValidity","slots","tagList","isCheck","isRadio","isChecked","isPassword","isEmail","isURL","GSFormPanelElement","formStorage","GSGroupElement","initData","renderWrappedUI","renderWrappedClass","getName","allProperties","GSIconElement","superColor","_clicked","_hovered","postAnimate","fs","GSIndentElement","multiplier","numdef","GSImageElement","invert","grayscale","brightness","contrast","saturate","hue","sepia","alt","imageRef","complete","renderStyle","buildFilter","GSLayoutElement","resizable","autofit","vPos","hPos","els","dyncss","horizontal","lev","tplEl","elementTemplate","tc","dir","did","panelCSS","panelStyle","resize","grow","vpos","hpos","GSLinklement","ping","GSListItemElement","selectable","generated","initial","renderFirst","renderSecond","itemCSS","itemStatusCSS","renderText","activeCSS","cssActive","inactiveCSS","cssInactive","GSListElement","GSNavItemElement","itemsCSS","isNav","buttonCSS","buildCSS","cssButton","navType","GSNavElement","isTab","GSOverlayElement","autoremove","radius","styleID2","innerHeight","fillRule","clipRule","strokeLinejoin","strokeMiterlimit","zIndex","pathStr","createSVGPathString","fill","pointerEvents","cursor","windowX","windowY","limitedRadius","normalizedRadius","highlightBoxWidth","highlightBoxHeight","GSPagerElement","pages","labelFirst","labelLast","labelNext","labelPrevious","half","renderPrevious","renderItem","renderNext","renderLast","pagination","decodeHTMLEntities","toTarget","ctrl","GSPopupElement","wMin","wMax","hMin","hMax","panelRef","attachTaraget","onAuto","reposition","popupFixed","panel","Event","overflowH","overflowV","GSProgressElement","updateStyle","percentage","onKeySelect","increase","decrease","trunc","old","GSSpinnerElement","pulsar","GSSplitterElement","styleTGT","cssUpdate","lock","updateMouse","stop","isPreceeding","isStyleValue","styleDynamic","lockable","csize","cls","gsSplitter","updateX","updateY","dx","GSTabItemElement","updateCSS","tabCSS","GSTabPanelElement","GSTabGroupElement","findPanel","tabEl","isAfter","renderPanels","GSTableElement","filterType","cssFilter","colorHead","colorSelect","colorSort","stripedColumn","divider","striped","grid","borderless","columns","selections","datacolumn","multisort","protected","sortable","sortOrder","headColor","CELLS","table","stripedColumns","renderFilters","onSort","entry","renderColumn","onSelect","renderRecord","renderEmpty","columnType","columType","input","valueAt","row","cell","cfgType","timestamp","dataType","renderFilter","onFilter","icons","sortType","column","getElementIndex","prepareSorter","isComplex","tr","isSelected","GSTagElement","converter","appendable","closeColor","cssClose","cssTag","dataListRef","renderTags","onInput","renderList","updateTag","KEYS","srcElement","removeTag","addTag","isMax","datalist","optEl","tagEl","renderTag","tagClass","btnClass","badge","GSTextElement","GSTooltipElement","arrowRef","arrowStyle","attachEvents","fade","arrowEl","panelEl","refLocal","refGlobal","GSTemplateElement","CopySelectController","clickCallback","copyCallback","onCopy","writeToClipboard","MaskController","_","back","prev","keyDownCallback","inputCallback","focusCallback","blurCallback","onFocus","initRules","j","builSlots","findIndex","builAccept","toPattern","lastIndex","isMatch","setSelectionRange","substring","selectionStart","selectionEnd","maskType","clean","chars","masks","special","NumberController","onNumberInput","PasswordController","revealing","keyUpCallback","isReveal","altKey","TextController","updateText","ListController","monitorCallback","changeCallback","onMonitor","onDataChange","hasUpdated","strict","isInList","togleEl","dataGroup","isButtonElement","defaultPropertyDeclaration","attributeToPropertyMap","prepare","elementProperties","finalize","finalized","prepareFn","getOwnPropertySymbols","superCtor","attributeNameForProperty","ReactiveInput","reflectingProperties","instanceProperties","updatePromise","reflectingProperty","isUpdatePending","observedAttributes","initializer","initializers","props","propKeys","getOwnPropertyNames","createProperty","noAccessor","descriptor","getPropertyDescriptor","prototype","configurable","enumerable","enableUpdating","attributeToProperty","requestedUpdate","getUpdateComplete","scheduleUpdate","performUpdate","propertyToAttribute","markUpdated","updateComplete","getPropertyOptions","changeProperty","enqueueUpdate","elementProps","wrapped","didUpdate","ctor","propName","attrValue","saveInstanceProperties","GSComboExt","HTMLSelectElement","setIf","objToHTML","GSDataListExt","HTMLDataListElement","GSInputElement","copyselect","maskController","passwordController","numberController","textController","listController","GSBreadcrumbElement","spacing","updateChildren","$text","GSBreadcrumbItemElement","generate","GSTimeFormat","toLocaleTimeString","GSDateFormat","GSYearFormat","GSCurrencyFormat","GSStepStyle","GSStepElement","iconCSS","titleCSS","INACTIVE","ICON_CSS","GSStepsElement","steps","isFirst","isLast","COMPLETED","SELECTED","GSNotificationElement","BOTTOM_END","positionCSS","DEFAULT","dismiss","success","danger","primary","secondary","light","requestPermission","showNative","showWeb","toast","dialogToast","notification","Notification","clearNative","dlg","nn","isNativeSupported","isGranted","permission","GSToastElement","pending","visibilityChange","pendingUpdate","validParent","SPEED","renderWithHeader","renderSimple","AbstractTreeController","addNodeController","removeNodeController","oldNode","TreeController","toggleState","addedNode","insertedNode","onRemove","GSTreeItemElement","renderSpinner","cssFocus","status","parentItem","checkColor","checkColorSelected","ui","itemIco","itemIcon","openIcon","closeIcon","renderIndent","renderMulti","GSTreeElement","guide","shared","listRef","nextItem","previousItem","reload","expandable","GSChartElement","URL_LIB","GS_URL_CHART","canvasRef","chart","waitInit","destroy","isChart","renderData","canvas","updateChart","div","toBase64Image","quality","sets","datasets","ctx","getContext","Chart","initializing","registerables","nameV","valV","typeV","childs","isObject","_nam","GSChart","_val","_typ","GSHighlightElement","GS_URL_HLJS","codeRef","onTarget","onURL","onHighlight","hasLangauge","highlight","injectCSS","onMessage","terminate","response","worker","blobURL","Worker","onmessage","postMessage","langs","GSMarkdownElement","GS_URL_MARKDOWN","history","maxHeight","containerRef","initLib","showdown","tasklists","tables","Converter","toCache","fromCache","container","makeHtml","handleLinks","handleTables","handleCode","parentPath","handleStyles","links","onLinkClick","script","GSMonacoElement","GS_URL_MONACO","editor","onMonacoReady","monaco","model","getModel","selection","getValueInRange","getSelection","setModelLanguage","setTheme","automaticLayout","minimap","MonacoEnvironment","baseUrl","getWorkerUrl","workerId","require","paths","vs","initialized","initEnv","initMonaco"],"mappings":"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"}