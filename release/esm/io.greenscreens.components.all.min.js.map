{"version":3,"file":"io.greenscreens.components.all.min.js","sources":["../../modules/base/GSVersion.mjs","../../modules/base/style.mjs","../../modules/base/GSConst.mjs","../../modules/base/GSLog.mjs","../../modules/base/GSUtil.mjs","../../modules/base/GSFunction.mjs","../../modules/base/GSID.mjs","../../modules/base/GSAttr.mjs","../../modules/base/GSCSSMap.mjs","../../modules/base/GSDate.mjs","../../modules/base/GSData.mjs","../../modules/base/GSDOM.mjs","../../modules/base/GSEvents.mjs","../../modules/base/GSAbortController.mjs","../../modules/base/GSDOMObserver.mjs","../../modules/base/GSDynamicStyle.mjs","../../modules/base/GSCacheStyles.mjs","../../modules/base/GSAdoptedEngine.mjs","../../modules/base/GSLoader.mjs","../../modules/base/GSTemplateCache.mjs","../../modules/base/GSAttributeHandler.mjs","../../modules/base/GSBeep.mjs","../../modules/base/GSEnvironment.mjs","../../modules/base/GSPromise.mjs","../../modules/base/GSEvent.mjs","../../modules/base/GSEventBus.mjs","../../modules/base/GSGesture.mjs","../../modules/base/GSItem.mjs","../../modules/base/GSLocalization.mjs","../../modules/base/GSPopper.mjs","../../modules/base/GSQueryCSS.mjs","../../modules/base/GSQuery.mjs","../../modules/base/GSRouter.mjs","../../modules/base/GSTheme.mjs","../../modules/helpers/BinaryTree.mjs","../../modules/helpers/DoublyLinkedList.mjs","../../modules/helpers/LinkedList.mjs","../../modules/helpers/Stack.mjs","../../modules/helpers/Queue.mjs","../../modules/helpers/Tree.mjs","../../modules/data/DataSelector.mjs","../../modules/data/ReadWriteRegistry.mjs","../../modules/data/AbstractReadWrite.mjs","../../modules/data/ReadWrite.mjs","../../modules/data/CachedReadWrite.mjs","../../modules/data/TreeNode.mjs","../../modules/data/TreeReader.mjs","../../modules/lib1.mjs","../../modules/directives/dataset.mjs","../../modules/directives/literal.mjs","../../modules/directives/css-map.mjs","../../modules/properties/verificator.mjs","../../modules/properties/autocapitalize.mjs","../../modules/properties/autocomplete.mjs","../../modules/properties/autocorrect.mjs","../../modules/properties/buttonType.mjs","../../modules/properties/color.mjs","../../modules/properties/environment.mjs","../../modules/properties/inputType.mjs","../../modules/properties/nav.mjs","../../modules/properties/orientation.mjs","../../modules/properties/placement.mjs","../../modules/properties/position.mjs","../../modules/properties/protocol.mjs","../../modules/properties/size.mjs","../../modules/properties/arrayConverter.mjs","../../modules/controllers/AdoptedController.mjs","../../modules/controllers/AttributeController.mjs","../../modules/controllers/ContentController.mjs","../../modules/controllers/DataController.mjs","../../modules/controllers/ElementMoveController.mjs","../../modules/controllers/LocalizationController.mjs","../../modules/controllers/OrientationController.mjs","../../modules/controllers/TemplateController.mjs","../../modules/controllers/ThemeController.mjs","../../modules/controllers/SlotController.mjs","../../modules/GSElement.mjs","../../modules/controllers/ElementNavigationController.mjs","../../modules/controllers/GroupController.mjs","../../modules/components/Router.mjs","../../modules/components/Accordion.mjs","../../modules/components/AccordionItem.mjs","../../modules/components/Alert.mjs","../../modules/components/Button.mjs","../../modules/components/Calendar.mjs","../../modules/components/Card.mjs","../../modules/components/Center.mjs","../../modules/components/Menu.mjs","../../modules/components/Context.mjs","../../modules/components/Compare.mjs","../../modules/components/Controller.mjs","../../modules/components/Copyright.mjs","../../modules/components/DataHandler.mjs","../../modules/components/Dialog.mjs","../../modules/components/Drawer.mjs","../../modules/components/Dropdown.mjs","../../modules/components/Email.mjs","../../modules/components/Form.mjs","../../modules/components/FormGroup.mjs","../../modules/components/FormPanel.mjs","../../modules/components/Group.mjs","../../modules/components/Icon.mjs","../../modules/components/Indent.mjs","../../modules/components/Image.mjs","../../modules/components/Layout.mjs","../../modules/components/Link.mjs","../../modules/components/List.mjs","../../modules/components/ListItem.mjs","../../modules/components/Mouse.mjs","../../modules/components/Movable.mjs","../../modules/components/Nav.mjs","../../modules/components/NavItem.mjs","../../modules/components/Overlay.mjs","../../modules/components/Pager.mjs","../../modules/components/Popup.mjs","../../modules/components/Popover.mjs","../../modules/components/Progress.mjs","../../modules/components/Spinner.mjs","../../modules/components/Splitter.mjs","../../modules/components/tab/TabHeader.mjs","../../modules/components/tab/TabPanel.mjs","../../modules/components/tab/TabGroup.mjs","../../modules/components/Table.mjs","../../modules/components/Tag.mjs","../../modules/components/Text.mjs","../../modules/components/Tooltip.mjs","../../modules/components/Template.mjs","../../modules/components/ext/controllers/CopySelectController.mjs","../../modules/components/ext/controllers/MaskController.mjs","../../modules/components/ext/controllers/MultipatternController.mjs","../../modules/components/ext/controllers/NumberController.mjs","../../modules/components/ext/controllers/PasswordController.mjs","../../modules/components/ext/controllers/TextController.mjs","../../modules/components/ext/controllers/InteractiveController.mjs","../../modules/components/ext/controllers/ComboController.mjs","../../modules/components/ext/controllers/ListController.mjs","../../modules/components/ext/controllers/ValidityController.mjs","../../modules/components/ext/controllers/PropagateController.mjs","../../modules/components/ext/EventsMixin.mjs","../../modules/components/ext/controllers/FormController.mjs","../../modules/components/ext/ControllerHandler.mjs","../../modules/components/ext/controllers/ButtonController.mjs","../../modules/components/ext/GSButtonElement.mjs","../../modules/components/ext/GSInputElement.mjs","../../modules/components/ext/GSTextAreaElement.mjs","../../modules/components/ext/GSSelectElement.mjs","../../modules/components/ext/GSDataListElement.mjs","../../modules/components/ext/GSFormElement.mjs","../../modules/components/breadcrumb/Breadcrumb.mjs","../../modules/components/breadcrumb/BreadcrumbItem.mjs","../../modules/components/filebox/Attachment.mjs","../../modules/components/filebox/FileBox.mjs","../../modules/components/intl/TimeFormat.mjs","../../modules/components/intl/DateFormat.mjs","../../modules/components/intl/YearFormat.mjs","../../modules/components/intl/CurrencyFormat.mjs","../../modules/components/steps/StepStyle.mjs","../../modules/components/steps/Step.mjs","../../modules/components/steps/Steps.mjs","../../modules/components/toast/Notification.mjs","../../modules/components/toast/Toast.mjs","../../modules/components/tree/controllers/AbstractTreeController.mjs","../../modules/components/tree/controllers/TreeController.mjs","../../modules/components/tree/TreeItem.mjs","../../modules/components/tree/Tree.mjs","../../modules/components/ServiceWorker.mjs","../../modules/extra/Chart.mjs","../../modules/extra/Highlight.mjs","../../modules/extra/Markdown.mjs","../../modules/extra/Monaco.mjs"],"sourcesContent":["/*\r\n * Copyright (C) 2015, 2026 Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSVersion class\r\n * @module base/GSVersion\r\n */\r\n\r\n/**\r\n * A class with library version / build\r\n * @class\r\n */\r\nexport class GSVersion {\r\n\r\n    static get version() {\r\n        return '2.0.0';\r\n    }\r\n\r\n    static get build() {\r\n        return 2026.0128;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Required CSS Styles for WebCompoents, regardless Bootstrap CSS.\r\n */\r\nexport const gsstyles = `.z-10k{z-index:10000 !important;}\r\n.gs-hide,gs-item{display:none !important;}\r\ngs-popover,gs-tooltip{position:fixed;top:0px;left:0px;},\r\n.d-contents{display:contents;}';\r\ngs-button-group::part(.btn-group){box-shadow:rgba(72, 72, 72, 0.4) 0px 0.125rem 0.25rem;}\r\ngs-group>gs-button::part(button) {box-shadow: none;}\r\ngs-group>gs-button:not(:last-child)::part(button) {border-top-right-radius: 0;border-bottom-right-radius: 0;}\r\ngs-group>gs-button:not(:first-child)::part(button) {margin-left: calc(var(--bs-border-width) * -5);border-top-left-radius: 0;border-bottom-left-radius: 0;}\r\ngs-layout {width: 100%;height: 100%;}\r\ngs-split-panel{flex: 1 1 auto !important;}\r\ninput[is=\"gs-ext-input\"][type=\"date\"]:before {content: attr(data-value);display: inline-block;position: absolute;}\r\ninput[is=\"gs-ext-input\"][type=\"date\"]::-webkit-datetime-edit, input::-webkit-inner-spin-button, input::-webkit-clear-button {visibility: hidden;display: inline-block;}\r\ninput[is=\"gs-ext-input\"][type=\"date\"]::-webkit-calendar-picker-indicator {position: relative;top: 0px;right: 0;color: black;opacity: 0.5;}\r\n`;","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nexport const KEY = Symbol.for('gs-element');\r\nexport const OWNER = Symbol.for('gs-owner');\r\nexport const PARENT = Symbol.for('gs-parent');\r\nexport const HANDLER = Symbol.for('gs-handler');\r\nexport const GROUP = Symbol.for('gs-group');\r\nexport const EVENTID = Symbol.for('gs-event-id')\r\nexport const NEXT = Symbol.for('gs-next');\r\nexport const PREV = Symbol.for('gs-prev');\r\nexport const RENDER = Symbol.for(\"GS-TEMPLATE-RENDER\");\r\nexport const DEF = Symbol.for('#def');","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSLog class\r\n * @module base/GSLog\r\n */\r\n\r\n/** \r\n * Internal logging mechanism\r\n * @Class\r\n */\r\nexport class GSLog {\r\n\r\n\t/**\r\n\t * static flag is loging enabled or disabled\r\n\t */\r\n\tstatic logging = true;\r\n\tstatic tracing = false;\r\n\r\n\t/**\r\n\t * Log info message\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} msg \r\n\t */\r\n\tstatic info(el, msg) {\r\n\t\tthis.#print(el, msg, true, 'info');\r\n\t}\r\n\r\n\t/**\r\n\t * Log warn message\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} msg \r\n\t */\r\n\tstatic warn(el, msg) {\r\n\t\tthis.#print(el, msg, true, 'warn');\r\n\t}\r\n\r\n\t/**\r\n\t * Log error message\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} msg \r\n\t */\r\n\tstatic error(el, msg) {\r\n\t\tthis.#print(el, msg, true, 'error');\r\n\t}\r\n\r\n\t/**\r\n\t * Debug messages only if tracing flag enabled\r\n\t * @param {*} el \r\n\t * @param {*} msg \r\n\t */\r\n\tstatic trace(el, msg) {\r\n\t\tif (GSLog.tracing) this.#print(el, msg, false, 'error');\r\n\t}\r\n\r\n\t/**\r\n\t * Generic logging function\r\n\t * @param {HTMLElement} el Element to log (optional)\r\n\t * @param {String} msg Message to log\r\n\t * @param {Boolean} forced - when logging disabled globaly, use this to force logging\r\n\t */\r\n\tstatic log(el, msg, forced) {\r\n\t\tthis.#print(el, msg, forced);\r\n\t}\r\n\r\n\tstatic #print(el, msg, forced, type) {\r\n\t\tif (!(forced || this.logging)) return;\r\n\t\tconst tmp = el ? `${el.nodeName} -> ${el.id}: ${msg}` : msg;\r\n\t\tlet fn = console[type || 'log'];\r\n\t\tfn = typeof fn === 'function' ? fn : console.log;\r\n\t\tfn(tmp);\r\n\t\tif (msg instanceof Error) fn(msg);\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.seal(GSLog);\r\n\t}\r\n}\r\n\r\n\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSUtil class\r\n * @module base/GSUtil\r\n */\r\n\r\nimport { GSLog } from \"./GSLog.mjs\";\r\n\r\n/**\r\n * A generic set of static functions used across GS WebComponents framework\r\n * @class\r\n */\r\nexport class GSUtil {\r\n\r\n\tstatic FLAT = globalThis.GS_FLAT == true;\r\n\tstatic ALPHANUM = /^[a-zA-Z0-9-_]+$/;\r\n\tstatic #JSON_NORMALIZE = /(['\"])?([a-z0-9A-Z_]+)(['\"])?\\s*:/g;\r\n\tstatic #JSON_CHECK = /^(\\{.*\\}$|\\[.*\\]$)/g;\r\n\r\n\tstatic isNumber = (n) => { return !isNaN(parseFloat(n)) && isFinite(n); };\r\n\r\n\tstatic isDate = (v) => { return v instanceof Date };\r\n\r\n\tstatic isBool = (v) => { return typeof v === 'boolean' || v instanceof Boolean };\r\n\r\n\tstatic isString = value => typeof value === 'string';\r\n\r\n\tstatic isNull = value => value === null || value === undefined;\r\n\r\n\tstatic toBinary = (value = 0) => value.toString(2);\r\n\r\n\tstatic asBool = (val = false) => {\r\n\t\tconst v = GSUtil.normalize(val).toLowerCase();\r\n\t\treturn v === 'true' || v === '1';\r\n\t};\r\n\r\n\tstatic fromLiteral = (str = '', obj) => str.replace(/\\${(.*?)}/g, (x, g) => obj[g]);\r\n\r\n\tstatic reverse = (str) => (str || \"\").split(\"\").reverse().join(\"\");\r\n\r\n\tstatic capitalize = (word = '') => word ? word[0].toUpperCase() + word.slice(1).toLowerCase() : '';\r\n\r\n\tstatic capitalizeAll = (word = '', split = ' ') => word.split(split).map((v, i) => GSUtil.capitalize(v)).join(split);\r\n\r\n\tstatic capitalizeAttr = (word = '') => word.split('-').map((v, i) => i ? GSUtil.capitalize(v) : v).join('');\r\n\r\n\tstatic initerror = () => { throw new Error('This class cannot be instantiated') };\r\n\r\n\tstatic isInstance = (el) => el instanceof el.constructor;\r\n\r\n\tstatic isPrimitive = (o) => !Array.isArray(o) && (this.isBool(o) || this.isDate(o) || this.isNumber(o) || this.isString(o));\r\n\r\n\tstatic range = (val = 0, min = 0, max = 100) => (Math.max(Math.min(max, val), min));\r\n\r\n\tstatic extractNumber = (val = '') => val.match(/[\\d,\\.]*\\d/)?.[0];\r\n\r\n\tstatic nonNull = value => !GSUtil.isNull(value);\r\n\r\n\tstatic asArray(val) {\r\n\t\treturn Array.isArray(val) ? val : [val];\r\n\t}\r\n\r\n\tstatic asNum(val, dft = 0, language) {\r\n\t\tlanguage = language || GSUtil.language;\r\n\t\tif (GSUtil.isString(val)) {\r\n\t\t\tconst sep = GSUtil.numberSeparator(language);\r\n\t\t\tval = GSUtil.extractNumber(val)?.replaceAll(sep, '') || val;\r\n\t\t}\r\n\t\treturn GSUtil.isNumber(val) ? parseFloat(val) : dft;\r\n\t}\r\n\r\n\t/**\r\n\t * Validate string for url format\r\n\t * @param {String} url \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isURL = (url = '') => /^(https?:\\/\\/|\\/{1,2}|\\.\\/{1})(\\S*\\/*){1,}/i.test(url.trim());\r\n\r\n\tstatic isHTML = (val = '') => val.trim().startsWith('<') && val.trim().endsWith('>');\r\n\r\n\t/**\r\n\t * Generate random set of characters\r\n\t * @param {String} pattern \r\n\t * @param {String} charset \r\n\t * @returns {String}\r\n\t */\r\n\tstatic generateUUID = (pattern = \"xxxx-xxxx-xxxx-xxxx-xxxx\", charset = \"abcdef0123456789\") => pattern.replace(/[x]/g, () => charset[Math.floor(Math.random() * charset.length)]);\r\n\r\n\t/**\r\n\t * Get browser default language\r\n\t * @returns {String}\r\n\t */\r\n\tstatic get language() {\r\n\t\treturn navigator.language ? navigator.language : navigator.languages[0];\r\n\t}\r\n\r\n\t/**\r\n\t * Convert string to regex isntance\r\n\t * @param {*} val \r\n\t * @param {*} flags \r\n\t * @returns \r\n\t */\r\n\tstatic toRegex(val, flags) {\r\n\t\tif (val instanceof RegExp) return val;\r\n\t\treturn GSUtil.isStringEmpty(val) ? undefined : new RegExp(val, flags);\r\n\t}\r\n\r\n\t/**\r\n\t * Find number separator for given language\r\n\t * @param {string} language \r\n\t * @returns \r\n\t */\r\n\tstatic decimalSeparator(language) {\r\n\t\treturn Intl.NumberFormat(language).format(1.1)[1];\r\n\t}\r\n\r\n\t/**\r\n\t * Find decimal separator for given language\r\n\t * @param {string} language \r\n\t * @returns \r\n\t */\r\n\tstatic numberSeparator(language) {\r\n\t\treturn Intl.NumberFormat(language).format(1000)[1];\r\n\t}\r\n\r\n\t/**\r\n\t * Check if number is in range, inclusive\r\n\t * @param {Number} x \r\n\t * @param {Number} min \r\n\t * @param {Number} max \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic inRange(x = 0, min = 0, max = 0) {\r\n\t\treturn x >= min && x <= max;\r\n\t}\r\n\r\n\t/**\r\n\t * Try to find data format based on language\r\n\t * @param {string} language \r\n\t * @returns \r\n\t */\r\n\tstatic getDateFormat(language = undefined) {\r\n\t\tconst formatted = new Intl.DateTimeFormat(language).format(new Date(2000, 0, 2));\r\n\t\treturn formatted\r\n\t\t\t.replace('2000', 'YYYY')\r\n\t\t\t.replace('01', 'MM')\r\n\t\t\t.replace('1', 'M')\r\n\t\t\t.replace('02', 'DD')\r\n\t\t\t.replace('2', 'D');\r\n\t}\r\n\r\n\t/**\r\n\t * Sanitize text for HTML generation\r\n\t * @param {string} string \r\n\t * @returns \r\n\t */\r\n\tstatic sanitize(string = '') {\t\t\r\n\t\tconst map = {\r\n\t\t\t'&': '&amp;',\r\n\t\t\t'<': '&lt;',\r\n\t\t\t'>': '&gt;',\r\n\t\t\t'\"': '&quot;',\r\n\t\t\t\"'\": '&#x27;',\r\n\t\t\t\"/\": '&#x2F;',\r\n\t\t\t\"\\n\": '<br>',\r\n\t\t\t\"\\r\": '<br>',\r\n\t\t\t\"\\t\": '&nbsp;&nbsp;&nbsp;&nbsp;',\r\n\t\t\t' ': '&nbsp;',\r\n\t\t\t'\\\\': '&#x5C;',\r\n\t\t\t'`': '&#x60;'\r\n\t\t};\r\n\t\tconst reg = new RegExp(`[${Object.keys(map).join('')}]`, 'ig');\r\n\t\treturn string.replace(reg, (match) => (map[match]));\r\n\t}\r\n\t\t\r\n\tstatic isJsonString(val = '') {\r\n\t\tGSUtil.#JSON_CHECK.lastIndex = 0;\r\n\t\treturn typeof val == 'string' && GSUtil.#JSON_CHECK.test(val);\r\n\t}\r\n\r\n\t/**\r\n\t * Check if provided parameter is of JSON type\r\n\t * @param {String|object} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isJsonType(val = '') {\r\n\t\treturn !GSUtil.isNull(val) && (Array.isArray(val) || typeof val == \"object\");\r\n\t}\r\n\r\n\t/**\r\n\t * Check if provided paramter is JSON\r\n\t * @param {String|object} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isJson(val = '') {\r\n\t\treturn GSUtil.isJsonString(val) || GSUtil.isJsonType(val);\r\n\t}\r\n\r\n\t/**\r\n\t * Convert provided paramter to JSON\r\n\t * @param {String|object} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic toJson(val = '', dft = {}, normalize = true) {\r\n\t\tif (GSUtil.isJsonString(val)) return JSON.parse(normalize ? GSUtil.normalizeJson(val) : val);\r\n\t\tif (GSUtil.isJsonType(val)) return val;\r\n\t\tif (val) GSLog.warn(null, `Invalid data to convert into JSON: ${val}`);\r\n\t\treturn dft;\r\n\t}\r\n\r\n\t/**\r\n\t * Normalize unquoted JSON\r\n\t * @param {String} val \r\n\t * @returns {String}\r\n\t */\r\n\tstatic normalizeJson(val = '') {\r\n\t\treturn val?.replace(GSUtil.#JSON_NORMALIZE, '\"$2\": ');\r\n\t}\r\n\r\n\t/**\r\n\t * Makes string value safe, always return value\r\n\t * @param {String|object} val \r\n\t * @returns {String}\r\n\t */\r\n\tstatic normalize(val, def = '') {\r\n\t\treturn (val ?? def).toString().trim();\r\n\t}\r\n\r\n\t/**\r\n\t * Convert string separated values into an array\r\n\t * @param {String} val \r\n\t * @param {String} separator \r\n\t * @returns {Array<String>}\r\n\t */\r\n\tstatic toStringArray(val = '', separator = ' ') {\r\n\t\treturn val.split(separator).map(v => v.trim()).filter(v => v.length > 0);\r\n\t}\r\n\r\n\t/**\r\n\t * Transform text based on CSS text attribute format\r\n\t * @param {String} format \r\n\t * @param {String} value \r\n\t * @returns {String}\r\n\t */\r\n\tstatic textTransform(format = '', value = '') {\r\n\t\tswitch (format) {\r\n\t\t\tcase 'lowercase':\r\n\t\t\t\tvalue = value.toLowerCase();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'uppercase':\r\n\t\t\t\tvalue = value.toUpperCase();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'capitalize':\r\n\t\t\t\tvalue = GSUtil.capitalizeAll(value);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert parameterized string literal as template to string \r\n\t * \r\n\t * \t const template = 'Example text: ${text}';\r\n\t *   const result = interpolate(template, {text: 'Foo Boo'});\r\n\t * \r\n\t * @param {String} tpl \r\n\t * @param {Object} params \r\n\t * @returns {function}\r\n\t */\r\n\tstatic fromTemplateLiteral(tpl, params) {\r\n\t\tconst names = Object.keys(params);\r\n\t\tconst vals = Object.values(params);\r\n\t\treturn new Function(...names, `return \\`${tpl}\\`;`)(...vals);\r\n\t}\r\n\r\n\t/**\r\n\t * Decode HTML entities (&nbsp; &laquot; etc...)\r\n\t * @param {string} text \r\n\t * @returns {string}\r\n\t */\r\n\tstatic decodeHTMLEntities(text) {\r\n\t\tconst textArea = document.createElement('textarea');\r\n\t\ttextArea.innerHTML = text;\r\n\t\treturn textArea.value;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert string pointer to object\r\n\t * @param {String} value \r\n\t * @returns {*}\r\n\t */\r\n\tstatic parseValue(value) {\r\n\t\tif (!GSUtil.isString(value)) return;\r\n\t\tif (!GSUtil.isStringNonEmpty(value)) return;\r\n\t\tlet o = window;\r\n\t\tlet fn = null;\r\n\t\tvalue.trim().split('.').forEach((v, i, a) => {\r\n\t\t\tif (!o) return;\r\n\t\t\tif (i < a.length - 1) {\r\n\t\t\t\treturn o = o[v];\r\n\t\t\t}\r\n\t\t\tfn = o[v];\r\n\t\t});\r\n\t\treturn fn;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if strings has data\r\n\t * \r\n\t * @param {String} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isStringNonEmpty(val = '') {\r\n\t\treturn !GSUtil.isStringEmpty(val);\r\n\t}\r\n\r\n\t/**\r\n\t * Check if strings is empty\r\n\t * \r\n\t * @param {String} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isStringEmpty(val = '') {\r\n\t\treturn GSUtil.normalize(val).trim().length === 0;\r\n\t}\r\n\r\n\t/**\r\n\t * match two strings, or first is not set\r\n\t * \r\n\t * @param {String} left \r\n\t * @param {String} right \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isStringMatch(left, right) {\r\n\t\tconst lmatch = GSUtil.isStringNonEmpty(left);\r\n\t\tconst rmatch = GSUtil.isStringNonEmpty(right);\r\n\t\tif (lmatch && rmatch) {\r\n\t\t\treturn left.trim().toLowerCase() === right.trim().toLowerCase();\r\n\t\t}\r\n\t\treturn lmatch === rmatch;\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * Async version of timeout\r\n\t * \r\n\t * @async\r\n\t * @param {Number} time \r\n\t * @param {number|AbortSignal} signal Abort object\r\n\t * @returns {Promise<void>}\r\n\t */\r\n\tstatic async timeout(time = 0, signal) {\r\n\t\tif (time <= 0) return;\r\n\t\tsignal = GSUtil.isNumber(signal) ? AbortSignal.timeout(signal) : signal;\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tconst iid = setTimeout(resolve.bind(null, true), time);\r\n\t\t\tif (signal instanceof AbortSignal) {\r\n\t\t\t\tsignal.addEventListener('abort', () => {\r\n\t\t\t\t\tclearTimeout(iid);\r\n\t\t\t\t\treject(new Error('aborted timeout'));\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Download provided data\r\n\t * \r\n\t * @async\r\n\t * @param {Array} data \r\n\t * @param {String} name File name\r\n\t * @param {String} type Mime type, default octet/stream\r\n\t */\r\n\tstatic async export(data, name, type = 'octet/stream') {\r\n\r\n\t\tconst blob = new Blob(data, { type: type });\r\n\t\tconst url = URL.createObjectURL(blob);\r\n\t\ttry {\r\n\t\t\tconst a = document.createElement(\"a\");\r\n\t\t\ta.href = url;\r\n\t\t\ta.download = name;\r\n\t\t\ta.click();\r\n\r\n\t\t\tawait GSUtil.timeout(2000);\r\n\r\n\t\t} finally {\r\n\t\t\tURL.revokeObjectURL(url);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Registration helper function, replacement for class static initializers\r\n\t * Mostly to support Safari browser.\r\n\t * \r\n\t * GSUtil.register(null, GSUtil, null, true, false, true);\r\n\t * \r\n\t * @param {String} name Custom element name\r\n\t * @param {HTMLElement} clazz Class extensing at least HTMLElement\r\n\t * @param {String} ext If existing tag extended, this is tagName\r\n\t * @param {Boolean} seal Should class be sealed\r\n\t * @param {Boolean} freeze Should class be freezed\r\n\t * @param {Boolean} expose Should class be exposed to \"self\"\r\n\t * \r\n\t * @returns {void}\r\n\t */\r\n\tstatic register(name, clazz, ext, seal = true, freeze = false, expose = false) {\r\n\t\tif (!HTMLElement.isPrototypeOf(clazz)) return;\r\n\t\tif (customElements.get(name)) return;\r\n\t\tcustomElements.define(name, clazz, { extends: ext?.toLowerCase() });\r\n\t\tif (seal && !Object.isSealed(clazz)) Object.seal(clazz);\r\n\t\tif (freeze && !Object.isFrozen(clazz)) Object.freeze(clazz);\r\n\t\tif (expose) self[clazz.name] = clazz;\r\n\t}\r\n\r\n\t/**\r\n\t * Import and initialize source in JavaScript modules\r\n\t * Standard eval or new Function can not be used\r\n\t * @param {String} src \r\n\t * @returns {*}\r\n\t */\r\n\tstatic async importSource(src) {\r\n\t\tconst blob = new Blob([src], { type: \"text/javascript\" });\r\n\t\tconst url = URL.createObjectURL(blob);\r\n\t\ttry {\r\n\t\t\treturn await import(url);\r\n\t\t} finally {\r\n\t\t\tURL.revokeObjectURL(url);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Use Clipboard API to write to the clipboard\r\n\t * @returns \r\n\t */\r\n\tstatic async writeToClipboard(value = '') {\r\n\t\tconst result = await navigator.permissions.query({ name: \"clipboard-write\" })\r\n\t\tif (result.state === \"granted\" || result.state === \"prompt\") {\r\n\t\t   return navigator.clipboard.writeText(value);\r\n\t\t}\r\n\t\treturn '';\r\n\t}\r\n\r\n\t/**\r\n\t * Use Clipboard API to read from the clipboard\r\n\t * @returns \r\n\t */\r\n\tstatic async readFromClipboard() {\r\n\t\tconst result = await navigator.permissions.query({ name: \"clipboard-read\" })\r\n\t\tif (result.state === \"granted\" || result.state === \"prompt\") {\r\n\t\t   return navigator.clipboard.readText();\r\n\t\t}\r\n\t\treturn '';\r\n\t}\t\r\n\r\n\tstatic {\r\n\t\tObject.seal(GSUtil);\r\n\t\tglobalThis.GSUtil = GSUtil;\r\n\t}\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSFunction class\r\n * @module base/GSFunction\r\n */\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A set of static functions used for processing functions\r\n * @class\r\n */\r\nexport class GSFunction {\r\n\r\n    /**\r\n     * Check if object is of type function\r\n     * \r\n     * @param {function} fn \r\n     * @returns {Boolean}\r\n     */\r\n    static isFunction = (fn) => typeof fn === 'function';\r\n\r\n    static isFunctionNative(fn) {\r\n        return GSFunction.isFunction(fn) && fn.toString().includes('native code');\r\n    }\r\n\r\n    /**\r\n     * Check if object has function\r\n     * \r\n     * @param {Object} o \r\n     * @param {function} fn \r\n     * @returns {Boolean}\r\n     */\r\n    static hasFunction(o, fn) {\r\n        return o && GSFunction.isFunction(o[fn]);\r\n    }\r\n\r\n    /**\r\n     * Check if class has defined getter\r\n     * @param {*} own \r\n     * @param {*} name \r\n     * @returns \r\n     */\r\n    static hasGetter(own, name) {\r\n        return GSFunction.isFunctionDefined(own, name, 'get');\r\n    }\r\n\r\n    /**\r\n     * * Check if class has defined setter\r\n     * @param {*} own \r\n     * @param {*} name \r\n     * @returns \r\n     */\r\n    static hasSetter(own, name) {\r\n        return GSFunction.isFunctionDefined(own, name, 'set');\r\n    }\r\n\r\n    /**\r\n     * Check if class instance has defined function\r\n     * @param {object} own Class instance\r\n     * @param {string} name Function name to check\r\n     * @param {string} fn Function name to check\r\n     * @returns {boolean} Returns true if getter exist\r\n     */\r\n    static isFunctionDefined(own, name, fn) {\r\n        const desc = own ? Reflect.getOwnPropertyDescriptor(own.__proto__, name) : false;\r\n        return desc && typeof desc[fn] === 'function';\r\n    }\r\n\r\n    /**\r\n     * Check if object is of type async function\r\n     * \r\n     * @param {function} fn \r\n     * @returns  {Boolean}\r\n     */\r\n    static isFunctionAsync(fn) {\r\n        if (!GSFunction.isFunction(fn)) return false;\r\n        const AsyncFunction = GSFunction.callFunctionAsync.constructor\r\n        let isValid = fn instanceof AsyncFunction;\r\n        if (!isValid) isValid = fn[Symbol.toStringTag] == \"AsyncFunction\";\r\n        return isValid;\r\n    }\r\n\r\n    /**\r\n     * Check if object is of type generator function\r\n     * \r\n     * @param {function} fn \r\n     * @returns {Boolean}\r\n     */\r\n    static isFunctionGenerator(fn) {\r\n        if (!GSFunction.isFunction(fn)) return false;\r\n        const GeneratorFunction = (function* () { }).constructor;\r\n        return fn instanceof GeneratorFunction;\r\n    }\r\n\r\n    /**\r\n     * Generic asynchronous function caller\r\n     * \r\n     * @async\r\n     * @param {function} fn \r\n     * @param {Object} owner \r\n     * @returns  {Promise}\r\n     * @throws {Error} \r\n     */\r\n    static async callFunctionAsync(fn, owner) {\r\n        const args = arguments ? Array.from(arguments).slice(2) : [];\r\n        return await fn.apply(owner || null, args);\r\n    }\r\n\r\n    /**\r\n     * Generic synchronous function caller\r\n     * \r\n     * @param {function} fn \r\n     * @param {Object} owner \r\n     * @returns {Object}\r\n     * @throws {Error}\r\n     */\r\n    static callFunctionSync(fn, owner) {\r\n        const args = arguments ? Array.from(arguments).slice(2) : [];\r\n        return fn.apply(owner || null, args);\r\n    }\r\n\r\n    /**\r\n     * Generic function caller\r\n     * \r\n     * @param {function} fn \r\n     * @param {Object} owner \r\n     * @returns {Object}\r\n     */\r\n    static async callFunction(fn, owner, native = true) {\r\n        fn = GSUtil.isString(fn) ? GSFunction.parseFunction(fn) : fn;\r\n        if (!GSFunction.isFunction(fn)) return;\r\n        if (!native && GSFunction.isFunctionNative(fn)) return;\r\n        const args = arguments ? Array.from(arguments).slice(3) : [];\r\n        if (GSFunction.isFunctionAsync(fn)) {\r\n            return await GSFunction.callFunctionAsync(fn, owner, ...args);\r\n        }\r\n        return GSFunction.callFunctionSync(fn, owner, ...args);\r\n    }\r\n\r\n    /**\r\n     * Convert string pointer to function call\r\n     * \r\n     * @param {String} value \r\n     * @returns  {function}\r\n     */\r\n    static parseFunction(value) {\r\n        const fn = GSUtil.parseValue(value);\r\n        return GSFunction.isFunction(fn) ? fn : null;\r\n    }\r\n\r\n    static async #contextualize(fn, context, args) {\r\n        if (!GSFunction.isFunction(fn)) return;\r\n        const isAsync = GSFunction.isFunctionAsync(fn);\r\n        if (isAsync) {\r\n            return await fn.apply(context, args);\r\n        } else {\r\n            return fn.apply(context, args);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Wrap function into a single call - loop first call executed\r\n     * @param {function} fn Function to be called\r\n     * @param {*} context Instance at which to call the function\r\n     * @returns {*} Function result\r\n     */\r\n    static callOnceFifo(fn, context) {\r\n        let cnt = false;\r\n        return async (...args) => {\r\n            if (cnt) return;\r\n            cnt = true;\r\n            const own = context || this;\r\n            return await GSFunction.#contextualize(fn, own, args);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Wrap function into a single call - loop last call executed\r\n     * @param {function} fn Function to be called\r\n     * @param {*} context Instance at which to call the function\r\n     * @returns {*} Function result\r\n     */\r\n    static callOnceLifo(fn, context) {\r\n        let cnt = 0;\r\n        return (...args) => {\r\n            if (cnt < 0) return;\r\n            cnt++;\r\n            const own = context || this;\r\n            return new Promise((accept, reject) => {\r\n                queueMicrotask(async () => {\r\n                    if (cnt <= 0) return;\r\n                    cnt--;\r\n                    if (cnt !== 0) return;\r\n                    try {\r\n                        const o = await GSFunction.#contextualize(fn, own, args);\r\n                        accept(o);\r\n                    } catch (e) {\r\n                        reject(e);\r\n                    } finally {\r\n                        cnt = -1;\r\n                    }\r\n                });\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Debounce function makes sure that code is only triggered once per user input. \r\n     * Search box suggestions, text-field auto-saves, and eliminating double-button clicks are all use cases for debounce.\r\n     * @param {Function} func \r\n     * @param {Number} timeout \r\n     * @returns {Function}\r\n     */\r\n    static debounce(func, timeout = 300, leading = false) {\r\n        return leading ? GSFunction.#debounceLifo(func, timeout) : GSFunction.#debounceFifo(func, timeout);\r\n    }\r\n\r\n    /**\r\n     * Call only last function call within timeout period.\r\n     * @param {Function} func \r\n     * @param {Number} timeout \r\n     * @returns {Function}\r\n     */\r\n    static #debounceLifo(func, timeout = 300) {\r\n        let timer;\r\n        return (...args) => {\r\n            clearTimeout(timer);\r\n            timer = setTimeout(() => { func.apply(this, args); }, timeout);\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Call only first function call within timeout period.\r\n     * @param {*} func \r\n     * @param {*} timeout \r\n     * @returns \r\n     */\r\n    static #debounceFifo(func, timeout = 300) {\r\n        let timer;\r\n        return (...args) => {\r\n            if (!timer) {\r\n                func.apply(this, args);\r\n            }\r\n            clearTimeout(timer);\r\n            timer = setTimeout(() => {\r\n                timer = undefined;\r\n            }, timeout);\r\n        };\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSFunction);\r\n        globalThis.GSFunction = GSFunction;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSID class\r\n * @module base/GSID\r\n */\r\n\r\n/**\r\n * Generic unique ID generator for element\r\n * @class\r\n */\r\nexport class GSID {\r\n\r\n\tstatic #id = 0;\r\n\r\n\t/**\r\n\t * Reset ID counter to 0\r\n\t */\r\n\tstatic reset() {\r\n\t\tthis.#id = 0;\r\n\t}\r\n\r\n\t/**\r\n\t * Get next unique generated ID\r\n\t * @param {*} prefx Value to prepend to ID counter\r\n\t * @returns {String} A generated ID\r\n\t */\r\n\tstatic next(prefx = 'GSId-') {\r\n\t\treturn `${prefx}${++this.#id}`;\r\n\t}\r\n\r\n\t/**\r\n\t * Auto generate next ID\r\n\t * @returns {String} A generated ID\r\n\t */\r\n\tstatic get id() {\r\n\t\treturn this.next();\r\n\t}\r\n\r\n\t/**\r\n\t * Calculate hashcode from string (Java compatible)\r\n\t * @param {*} s A text fro mwhich hashcode is calculated \r\n\t * @returns {Number} Generated numeric hashcode\r\n\t */\r\n\tstatic hashCode(s) {\r\n\t\tconst l = (s || '').length;\r\n\t\tlet h = 0, i = 0;\r\n\t\tif (l === 0) return h;\r\n\t\twhile (i < l) {\r\n\t\t\th = (h << 5) - h + s.charCodeAt(i++) | 0;\r\n\t\t}\r\n\t\treturn h;\r\n\t}\r\n\r\n\t/**\r\n\t * Set element id if not set already\r\n\t * @param {HTMLElement} el \r\n\t */\r\n\tstatic setIf(el) {\r\n\t\tif (el) {\r\n\t\t\tel.id = typeof el.id !== 'string' ? GSID.id : el.id || GSID.id;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.freeze(GSID);\r\n\t}\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\nconst isProxy = Symbol(\"isProxy\")\r\n\r\n/**\r\n * A module loading GSAttr class\r\n * @module base/GSAttr\r\n */\r\n\r\n/**\r\n * A generic set of static functions to handle DOM Attributes\r\n * @class\r\n */\r\nexport class GSAttr {\r\n\r\n\t/**\r\n\t * Check if given element is of type HTMLElement\r\n\t * NOTE: GSDOM.isHTMLElement duplicate - prevent circular import\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isHTMLElement(el) {\r\n\t\treturn el instanceof HTMLElement;\r\n\t}\r\n\r\n\t/**\r\n\t  * Generic function to change element node attribute\r\n\t  * \r\n\t  * @param {HTMLElement} el Target to receive attribute value\r\n\t  * @param {String} name Attribute name\r\n\t  * @param {Boolean} val Attribute value\r\n\t  */\r\n\tstatic toggle(el, name, val = false) {\r\n\t\tif (!GSAttr.isHTMLElement(el)) return;\r\n\t\tif (GSUtil.asBool(val)) {\r\n\t\t\tel.setAttribute(name, '');\r\n\t\t} else {\r\n\t\t\tel.removeAttribute(name);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Generic function to change elment node attribute\r\n\t * \r\n\t * @param {HTMLElement} el Target to receive attribute value\r\n\t * @param {String} name Attribite name\r\n\t * @param {String} val Attribute value\r\n\t */\r\n\tstatic set(el, name, val) {\r\n\t\tif (!GSAttr.isHTMLElement(el)) return;\r\n\t\tif (GSUtil.normalize(val)) {\r\n\t\t\tel.setAttribute(name, val);\r\n\t\t} else {\r\n\t\t\tel.removeAttribute(name);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Generic function to get element node attribute\r\n\t * \r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {String} val Default value\r\n\t * @returns {String}\r\n\t */\r\n\tstatic get(el, name = '', val = '') {\r\n\t\tif (!GSAttr.isHTMLElement(el)) return val;\r\n\t\tif (!GSUtil.isInstance(el)) return val;\r\n\t\tconst v = el.getAttribute(name) ?? val;\r\n\t\treturn GSUtil.normalize(v);\r\n\t}\r\n\r\n\t/**\r\n\t * Get attribute as boolean type\r\n\t * \r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {String} val Default value\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic getAsBool(el, name = '', val = 'false') {\r\n\t\tconst attr = GSAttr.get(el, name, val);\r\n\t\treturn GSUtil.asBool(attr, val);\r\n\t}\r\n\r\n\t/**\r\n\t * Get attribute as numberic type\r\n\t * \r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {String} val Default value\r\n\t * @returns {Number}\r\n\t */\r\n\tstatic getAsNum(el, name = '', val = '0') {\r\n\t\tconst attr = GSAttr.get(el, name, val);\r\n\t\treturn GSUtil.asNum(attr, val);\r\n\t}\r\n\r\n\t/**\r\n\t * Get attribute as JSON object type\r\n\t * \r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {String} val Default value\r\n\t * @returns {JSON}\r\n\t */\r\n\tstatic getAsJson(el, name = '', val = '{}') {\r\n\t\tconst attr = GSAttr.get(el, name, val);\r\n\t\treturn GSUtil.toJson(attr, val);\r\n\t}\r\n\r\n\t/**\r\n\t * Store data into attribute as boolean\r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {Boolean} val Default value\r\n\t */\r\n\tstatic setAsBool(el, name = '', val = 'false') {\r\n\t\t//GSAttr.toggle(el, name, GSUtil.asBool(val));\r\n\t\tGSAttr.set(el, name, GSUtil.asBool(val), false);\r\n\t\t/*\r\n\t\tif (!GSAttr.isHTMLElement(el)) return;\r\n\t\tel.toggleAttribute(name, GSUtil.asBool(val));\r\n\t\t*/\r\n\t}\r\n\r\n\t/**\r\n\t * Store data into attribute as numeric\r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {Number} val Default value\r\n\t */\r\n\tstatic setAsNum(el, name = '', val = '0') {\r\n\t\tGSAttr.set(el, name, GSUtil.asNum(val), NaN);\r\n\t}\r\n\r\n\t/**\r\n\t * Store data into attribute as JSON string\r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {string} val Default value\r\n\t */\r\n\tstatic setAsJson(el, name = '', val = '{}') {\r\n\t\tGSAttr.set(el, name, JSON.stringify(val), val);\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON object to attribute string \r\n\t * @param {*} obj \r\n\t * @returns {String}\r\n\t */\r\n\tstatic flattenJson(obj) {\r\n\t\treturn Object.entries(obj || {}).map(kv => `${kv[0]}=${kv[1]}`).join(' ');\r\n\t}\r\n\r\n\t/**\r\n\t * Apply JSON object to element attributes\r\n\t * @param {*} obj \r\n\t */\r\n\tstatic jsonToAttr(obj, el) {\r\n\t\tif (!GSAttr.isHTMLElement(el)) return;\r\n\t\tObject.entries(obj || {})\r\n\t\t.filter(kv => kv[0] != 'items')\r\n\t\t.filter(kv => kv[0][0] != '#')\r\n\t\t.filter(kv => kv[0][0] != '$')\r\n\t\t.map(kv => GSAttr.set(el, kv[0], kv[1]));\r\n\t}\r\n\r\n\t/**\r\n\t * Convert list of data attributes into a string list\r\n\t * @param {HTMLElement} el \r\n\t * @returns {String}\r\n\t */\r\n\tstatic dataToString(el) {\r\n\t\treturn Array.from(el.attributes)\r\n\t\t\t.filter(v => v.name.startsWith('data-'))\r\n\t\t\t.map(v => `${v.name}=\"${v.value}\"`)\r\n\t\t\t.join(' ');\r\n\t}\r\n\r\n\t/**\r\n\t * Convert list of element attributes into a flat list separated by given separator (default ' ')\r\n\t * @param {HTMLMediaElement} el \r\n\t * @param {String} sep \r\n\t * @returns {String}\r\n\t */\r\n\tstatic flatten(el, sep = ' ') {\r\n\t\treturn Array.from(el?.attributes || []).map(a => `${a.name}=\"${a.value}\"`).join(sep);\r\n\t}\r\n\r\n\t/**\r\n\t * Generic attribute retriever \r\n\t * opt format { prop: {type:Number, attribute: 'alt-prop-name'}}\r\n\t * @param {HTMLElement} host The host element to proxify\r\n\t * @param {Object} [opt={}] Options object describing attribute mapping and types\r\n\t * @param {String} [recursive='items'] Property name for recursive proxification of children\r\n\t * @returns {Proxy}\r\n\t */\r\n\tstatic proxify(host, opt = {}, recursive = 'items') {\r\n\r\n\t\tconst instance = new Proxy(host, {\r\n\t\t\t\r\n\t\t\tset(target, prop, value) {\r\n\t\t\t\t\r\n\t\t\t\tif (prop === 'self') return;\r\n\t\t\t\tif (prop === 'dataset') return target.dataset = value;\r\n\t\t\t\tif (typeof prop === 'symbol') return target[prop] = value;\r\n\r\n\t\t\t\tconst type = opt[prop]?.type;\r\n\t\t\t\tprop = opt[prop]?.attribute || prop;\r\n\t\t\t\t\r\n\t\t\t\tswitch(type) {\r\n\t\t\t\t\tcase Boolean :\r\n\t\t\t\t\t\tGSAttr.toggle(target, prop,  GSUtil.asBool(value));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase Number :\r\n\t\t\t\t\t\tGSAttr.setAsNum(target, prop, value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase Object :\r\n\t\t\t\t\tcase Array :\r\n\t\t\t\t\t\tGSAttr.set(target, prop, JSON.stringify(value));\r\n\t\t\t\t\tdefault:\t\t\t\t\t\r\n\t\t\t\t\t\tGSAttr.set(target, prop, value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\r\n\t\t\tget(target, prop) {\r\n\t\t\t\t\r\n\t\t\t\tif (prop === 'self') return target;\r\n\t\t\t\tif (prop === 'dataset') return target.dataset;\r\n\t\t\t\tif (typeof prop === 'symbol') return target[prop];\r\n\t\t\t\tif (prop === 'isProxy') return isProxy;\r\n\t\t\t\tif (prop === recursive) return Array.from(target.children).map(el => GSAttr.proxify(el, opt, recursive)); \r\n\t\t\t\t\r\n\t\t\t\tconst tmp = opt; // Object.hasOwn(opt, prop) ? opt : target;\r\n\t\t\t\t\r\n\t\t\t\tconst type = tmp[prop]?.type;\r\n\t\t\t\tconst safe = tmp[prop]?.unsafe ? true : false;\r\n\t\t\t\tconst dflt = tmp[prop]?.default;\r\n\t\t\t\tconst multi = tmp[prop]?.multi === true;\r\n\t\t\t\t\r\n\t\t\t\tprop = tmp[prop]?.attribute || prop;\r\n\t\t\t\tlet val = target.hasAttribute(prop) ? GSAttr.get(target, prop) : target[prop];\r\n\r\n\t\t\t\tif (GSFunction.isFunction(val)) return val.bind(target);\r\n\t\t\t\t\r\n\t\t\t\tswitch(type) {\r\n\t\t\t\t\tcase Boolean :\r\n\t\t\t\t\t\treturn target.hasAttribute(prop);\r\n\t\t\t\t\tcase Number :\r\n\t\t\t\t\t\treturn GSUtil.asNum(val, 0);\r\n\t\t\t\t\tcase Object :\r\n\t\t\t\t\t\treturn GSUtil.toJson(val, {});\r\n\t\t\t\t\tcase Array :\r\n\t\t\t\t\t\treturn GSUtil.toJson(val, []);\r\n\t\t\t\t\tdefault:\t\t\t\t\t\r\n\t\t\t\t\t\tval = safe ? (val || dflt || '') : (val || dflt || undefined);\r\n\t\t\t\t\t\treturn multi ? GSUtil.toStringArray(val) : val;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\treturn instance;\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.seal(GSAttr);\r\n\t\tglobalThis.GSAttr = GSAttr;\r\n\t}\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\n\r\n/**\r\n * A module loading GSCSSMap class\r\n * @module base/GSCSSMap\r\n */\r\n\r\n/**\r\n * Wrapper around computedStyleMap to support Firefox and WebKit Mode\r\n * @class\r\n */\r\nexport class GSCSSMap {\r\n\r\n    static #modern = globalThis.document?.body?.computedStyleMap ? true : false;\r\n\r\n    #map;\r\n\r\n    constructor(element) {\r\n        const me = this;\r\n        me.#map = GSCSSMap.#getMap(element);\r\n    }\r\n\r\n    get(name) {\r\n        const me = this;\r\n        if (!me.#map) return undefined;\r\n        return GSCSSMap.#modern ? me.#map.get(name) : me.#map[GSUtil.capitalizeAttr(name)];\r\n    }\r\n\r\n    asText(name) {\r\n        return (this.get(name) || '')?.toString();\r\n    }\r\n\r\n    asBool(name) {\r\n        const val = this.get(name);\r\n        return GSUtil.asBool(GSCSSMap.#modern ? val?.value : val);\r\n    }\r\n\r\n    asNum(name) {\r\n        let val = this.get(name);\r\n        if (GSCSSMap.#modern && GSFunction.isFunction(val?.to)) {\r\n            if (val.unit !== 'number') val = val.to('px');\r\n        }\r\n        if (GSCSSMap.#modern) return GSUtil.asNum(val?.value);\r\n        const num = val?.match(/\\d*(\\.\\d*)?/g).filter(v => GSUtil.isNumber(v)).shift();\r\n        return GSUtil.asNum(num);\r\n    }\r\n\r\n    matches(name, value) {\r\n        return this.asText(name) == value;\r\n    }\r\n\r\n    /**\r\n     * Support for Firefox/Gecko to get element computedStyleMap\r\n     * @param {HTMLElement} el \r\n     * @returns {CSSStyleDeclaration}\r\n     */\r\n    static #getMap(el) {\r\n        if (GSCSSMap.#modern) return el.computedStyleMap();\r\n        if (globalThis.window?.getComputedStyle) return globalThis.window.getComputedStyle(el);\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Support for Firefox/Gecko to get element computedStyleMap item\r\n     * @param {HTMLElement} el \r\n     * @returns {}\r\n     */\r\n    static styleValue(el, name) {\r\n        return GSCSSMap.getComputedStyledMap(el).get(name);\r\n    }\r\n\r\n    /**\r\n     * Support for Firefox/Gecko to get element computedStyleMap\r\n     * @param {HTMLElement} element \r\n     * @returns {GSCSSMap}\r\n     */\r\n    static getComputedStyledMap(element) {\r\n        return new GSCSSMap(element);\r\n    }\r\n\r\n    static #normalize(str) {\r\n        if (!str) return '';\r\n        str = String(str).replace(/\\s*([>~+])\\s*/g, ' $1 ');\r\n        return str.replace(/(\\s+)/g, ' ').trim();\r\n    }\r\n\r\n    static #split(str, on) {\r\n        return str.split(on).map(x => x.trim()).filter(x => x);\r\n    }\r\n\r\n    static #containsAny(selText, ors) {\r\n        return selText ? ors.some(x => selText.includes(x)) : false;\r\n    }\r\n\r\n    /**\r\n     * Find css defined rules by css selector\r\n     * @param {String} selector \r\n     * @returns {CSSStyleRule}\r\n     */\r\n    static findRule(selector) {\r\n        const me = GSCSSMap;\r\n        const logicalORs = me.#split(me.#normalize(selector), ',');\r\n        const sheets = Array.from(globalThis.document.styleSheets);\r\n        const ruleArrays = sheets.map(x => Array.from(x.cssRules || []));\r\n        const allRules = ruleArrays.reduce((all, x) => all.concat(x), []);\r\n        return allRules.filter((x) => me.#containsAny(me.#normalize(x.selectorText), logicalORs));\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSCSSMap);\r\n        globalThis.GSCSSMap = GSCSSMap;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A module loading GSDate class\r\n * @module base/GSDate\r\n */\r\n\r\n/**\r\n * Custom Date class to help handling calendar and date formatting\r\n * \r\n * @class\r\n */\r\nexport class GSDate extends Date {\r\n\r\n    static DEFAULT_FORMAT = 'YYYY-MM-DDTHH:mm:ssZ';\r\n    static REGEX_FORMAT = /\\[([^\\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g\r\n\r\n    #language = navigator.language;\r\n\r\n    format(val = GSDate.DEFAULT_FORMAT, language) {\r\n        const me = this;\r\n        if (language) me.language = language;\r\n        const obj = me.asJSON();\r\n        return val.replace(GSDate.REGEX_FORMAT, (match, val) => val || obj[match]);\r\n    }\r\n\r\n    /**\r\n     * Build array days/weeks for a month\r\n     * @returns {Array<string>}\r\n     */\r\n    build() {\r\n        const me = this;\r\n        const last = me.last.getDate();\r\n        const first = me.first.getDay();\r\n        const mondayFirst = me.#isMondayFirst();\r\n        const dayOffset = mondayFirst ? (first + 6) % 7 : first;\r\n        const days = Array(dayOffset).fill('');\r\n\r\n        let i = 1;\r\n        while (i <= last) {\r\n            days.push(i.toString());\r\n            i++;\r\n        }\r\n\r\n        while (days.length % 7 != 0) days.push('');\r\n\r\n        return days;\r\n    }\r\n\r\n    get language() {\r\n        return this.#language;\r\n    }\r\n\r\n    set language(val) {\r\n        this.#language = val || navigator.language;\r\n    }\r\n\r\n    get year() {\r\n        return this.getFullYear();\r\n    }\r\n\r\n    set year(val = 0) {\r\n        this.setFullYear(val);\r\n    }\r\n\r\n    get month() {\r\n        return this.getMonth();\r\n    }\r\n\r\n    set month(val = 0) {\r\n        this.setMonth(val);\r\n    }\r\n\r\n    get day() {\r\n        return this.getDate();\r\n    }\r\n\r\n    set day(val = 0) {\r\n        this.setDate(val);\r\n    }\r\n\r\n    /**\r\n     * First date of the month\r\n     * @returns {Date}\r\n     */\r\n    get first() {\r\n        return new GSDate(this.getFullYear(), this.getMonth(), 1);\r\n    }\r\n\r\n    /**\r\n     * Last date of the month\r\n     * @returns {Date}\r\n     */\r\n    get last() {\r\n        return new GSDate(this.getFullYear(), this.getMonth() + 1, 0);\r\n    }\r\n\r\n    get YY() {\r\n        return String(this.YYYY).slice(-2);\r\n    }\r\n\r\n    get YYYY() {\r\n        return this.getFullYear();\r\n    }\r\n\r\n    get M() {\r\n        return this.getMonth() + 1;\r\n    }\r\n\r\n    get MM() {\r\n        return this.M.toString().padStart(2, '0');\r\n    }\r\n\r\n    get MMM() {\r\n        return this.#toLocale({ month: 'short' });\r\n    }\r\n\r\n    get MMMM() {\r\n        return this.#toLocale({ month: 'long' });\r\n    }\r\n\r\n    get D() {\r\n        return this.getDate().toString();\r\n    }\r\n\r\n    get DD() {\r\n        return this.D.padStart(2, '0');\r\n    }\r\n\r\n    get d() {\r\n        return this.getDay().toString();\r\n    }\r\n\r\n    get dd() {\r\n        return this.ddd.slice(0, 2);\r\n    }\r\n\r\n    get ddd() {\r\n        return this.#toLocale({ weekday: 'short' });\r\n    }\r\n\r\n    get dddd() {\r\n        return this.#toLocale({ weekday: 'long' });\r\n    }\r\n\r\n    get H() {\r\n        return this.getHours().toString();\r\n    }\r\n\r\n    get HH() {\r\n        return this.H.padStart(2, '0');\r\n    }\r\n\r\n    get h() {\r\n        return this.#formatHour(1);\r\n    }\r\n\r\n    get hh() {\r\n        return this.#formatHour(2);\r\n    }\r\n\r\n    get a() {\r\n        return this.#meridiem(true);\r\n    }\r\n\r\n    get A() {\r\n        return this.#meridiem(false);\r\n    }\r\n\r\n    get m() {\r\n        return this.getMinutes().toString();\r\n    }\r\n\r\n    get mm() {\r\n        return this.m.padStart(2, '0');\r\n    }\r\n\r\n    get s() {\r\n        return this.getSeconds().toString();\r\n    }\r\n\r\n    get ss() {\r\n        return this.s.padStart(2, '0');\r\n    }\r\n\r\n    get SSS() {\r\n        return this.getMilliseconds().toString().padStart(3, '0');\r\n    }\r\n\r\n    get Z() {\r\n        return this.#zoneStr();\r\n    }\r\n\r\n    get ZZ() {\r\n        return this.Z.replace(':', '');\r\n    }\r\n\r\n    get Q() {\r\n        return Math.ceil(this.M / 3);\r\n    }\r\n\r\n    get k() {\r\n        return (this.getHours() + 1).toString();\r\n    }\r\n\r\n    get kk() {\r\n        return this.k.padStart(2, '0');\r\n    }\r\n\r\n    get W() {\r\n        const date = new Date(this.getTime());\r\n        date.setHours(0, 0, 0, 0);\r\n        date.setDate(date.getDate() + 3 - (date.getDay() + 6) % 7);\r\n        const week1 = new Date(date.getFullYear(), 0, 4);\r\n        return 1 + Math.round(((date.getTime() - week1.getTime()) / 86400000 - 3 + (week1.getDay() + 6) % 7) / 7);\r\n    }\r\n\r\n    get WW() {\r\n        return this.W.toString().padStart(2, '0');\r\n    }\r\n\r\n    get x() {\r\n        return this.getTime();\r\n    }\r\n\r\n    get X() {\r\n        return Math.floor(this.x / 1000);\r\n    }\r\n\r\n    asJSON() {\r\n        const me = this;\r\n        return {\r\n            YY: me.YY,\r\n            YYYY: me.YYYY,\r\n            M: me.M,\r\n            MM: me.MM,\r\n            MMM: me.MMM,\r\n            MMMM: me.MMMM,\r\n            D: me.D,\r\n            DD: me.DD,\r\n            d: me.d,\r\n            dd: me.dd,\r\n            ddd: me.ddd,\r\n            dddd: me.dddd,\r\n            H: me.H,\r\n            HH: me.HH,\r\n            h: me.h,\r\n            hh: me.hh,\r\n            a: me.a,\r\n            A: me.A,\r\n            m: me.m,\r\n            mm: me.mm,\r\n            s: me.s,\r\n            ss: me.ss,\r\n            SSS: me.SSS,\r\n            Z: me.Z,\r\n            ZZ: me.ZZ,\r\n            Q: me.Q,\r\n            k: me.k,\r\n            kk: me.kk,\r\n            W: me.W,\r\n            WW: me.WW,\r\n            x: me.x,\r\n            X: me.X\r\n        }\r\n    }\r\n\r\n    static monthList(short = false, language = navigator.language, capitalize = true) {\r\n        const tmp = new GSDate();\r\n        tmp.language = language;\r\n        tmp.setDate(1);\r\n        tmp.setMonth(0);\r\n        const days = [];\r\n        let val = null;\r\n        let d = 12;\r\n        while (d--) {\r\n            val = short ? tmp.MMM : tmp.MMMM;\r\n            val = capitalize ? tmp.#capitalize(val) : val;\r\n            days.push(val);\r\n            tmp.setMonth(tmp.getMonth() + 1);\r\n        }\r\n        return days;\r\n    }\r\n\r\n    static dayList(short = false, language = navigator.language, capitalize = true) {\r\n        const tmp = new GSDate();\r\n        tmp.language = language;\r\n        const mondayFirst = tmp.#isMondayFirst();\r\n        const offset = mondayFirst ? 1 : 0;\r\n        tmp.setDate(tmp.getDate() - tmp.getDay() + offset);\r\n        const days = [];\r\n        let val = null;\r\n        let d = 7;\r\n        while (d--) {\r\n            val = short ? tmp.ddd : tmp.dddd;\r\n            val = capitalize ? tmp.#capitalize(val) : val;\r\n            days.push(val);\r\n            tmp.setDate(tmp.getDate() + 1);\r\n        }\r\n        return days;\r\n    }\r\n\r\n    #isMondayFirst() {\r\n        // TODO Firefox does not support it\r\n        return new Intl.Locale(this.#language)?.getWeekInfo()?.firstDay === 1;\r\n    }\r\n\r\n    #capitalize(val = '') {\r\n        return val.charAt(0).toUpperCase() + val.slice(1);\r\n    }\r\n\r\n    #toLocale(opt) {\r\n        return this.toLocaleString(this.#language, opt);\r\n    }\r\n\r\n    #formatHour(size) {\r\n        return (this.getHours() % 12 || 12).toString().padStart(size, '0');\r\n    }\r\n\r\n    #meridiem(isLowercase) {\r\n        const opt = { hour: '2-digit', hour12: true };\r\n        const val = this.#toLocale(opt).split(' ').pop(-1);\r\n        return isLowercase ? val.toLowerCase() : val;\r\n    }\r\n\r\n    #zoneStr() {\r\n        const me = this;\r\n        const negMinutes = -1 * me.getTimezoneOffset();\r\n        const minutes = Math.abs(negMinutes)\r\n        const hourOffset = Math.floor(minutes / 60)\r\n        const minuteOffset = minutes % 60;\r\n\r\n        const seg1 = negMinutes <= 0 ? '+' : '-';\r\n        const seg2 = hourOffset.toString().padStart(2, '0');\r\n        const seg3 = minuteOffset.toString().padStart(2, '0');\r\n\r\n        return `${seg1}${seg2}:${seg3}`;\r\n    }\r\n\r\n    static parse(value, format, language) {\r\n        format = format || GSUtil.getDateFormat(language);\r\n        const regex = GSDate.#getFormattedDateRegex(format);\r\n        return GSDate.#parseFormattedDate(value, regex);\r\n    }\r\n\r\n    static #getFormattedDateRegex(format) {\r\n        return new RegExp(\r\n            '^\\\\s*' + format.toUpperCase().replaceAll(/([MDY])\\1*/g, '(?<$1>\\\\d+)') + '\\\\s*$'\r\n        );\r\n    }\r\n\r\n    static #parseFormattedDate(value, regex) {\r\n\r\n        const { groups } = value.match(regex) ?? {};\r\n\r\n        if (!groups) return null;\r\n\r\n        const y = Number(groups.Y);\r\n        const m = Number(groups.M);\r\n        const d = Number(groups.D);\r\n\r\n        // Validate range of year and month\r\n        if (y < 1000 || y > 2999) return null;\r\n        if (m < 1 || m > 12) return null;\r\n\r\n        const date = new Date(y, m - 1, d);\r\n\r\n        // Validate day of month exists\r\n        if (d !== date.getDate()) return null;\r\n\r\n        return isNaN(date.valueOf()) ? null : date;\r\n    }\r\n\r\n    /**\r\n     * Check if a year is a leap year\r\n     * @param {number} year \r\n     * @returns {Boolean}\r\n     */\r\n    static isLeapYear(year) {\r\n        return (year % 4 === 0 && year % 100 !== 0) || (year % 400 === 0);\r\n    }\r\n\r\n    static {\r\n        globalThis.GSDate = GSDate;\r\n    }\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSData class\r\n * @module base/GSData\r\n */\r\n\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSDate } from \"./GSDate.mjs\";\r\nimport { GSAttr } from \"./GSAttr.mjs\";\r\n\r\n/**\r\n * A set of static functions used for loading resources\r\n * @class\r\n */\r\nexport class GSData {\r\n\r\n    static PROPERTIES = { name: {}, type: {}, format: {}, currency: {}, language: {}, extract: {}, key: { type: Boolean } };\r\n\r\n    /**\r\n     * Removes duplicates from list\r\n     * @param {Array} data \r\n     * @returns {Array}\r\n     */\r\n    static unique(data) {\r\n        return Array.from(new Set(data));\r\n    }\r\n\r\n    static compareArrays = (a, b) => a.length === b.length && a.every((element, index) => element === b[index]);\r\n\r\n    /**\r\n     * Check if two arrays are equal\r\n     * \r\n     * @param {Array} a \r\n     * @param {Array} b \r\n     * @returns {Boolean}\r\n     */\r\n    static arraysEqual(a, b) {\r\n\r\n        if (!Array.isArray(a)) return false;\r\n        if (!Array.isArray(b)) return false;\r\n        if (a === b) return true;\r\n\r\n        a = a.toSorted();\r\n        b = b.toSorted();\r\n\r\n        return GSData.compareArrays(a, b);\r\n    }\r\n\r\n    /**\r\n     * Simple array merge, without duplicates. Used by observableAttributes\r\n     * TODO: improve https://www.geeksforgeeks.org/how-to-convert-array-of-objects-into-unique-array-of-objects-in-javascript/\r\n     * @param {Array} first \r\n     * @param {Array} second \r\n     * @param {Boolean} advanced Used when data is Object instead of string\r\n     * @returns {Array}\r\n     */\r\n    static mergeArrays(first = [], second = [], advanced = false) {\r\n        if (advanced) {\r\n            return [...new Set([...first, ...second].map(JSON.stringify))].map(JSON.parse);\r\n        }\r\n        return [...first, ...second].filter((value, index, arr) => arr.indexOf(value) === index);\r\n    }\r\n\r\n    /**\r\n     * Simple Object merge\r\n     * @param {*} list \r\n     * @returns \r\n     */\r\n    static mergeObjects(list = []) {\r\n        let o = {};\r\n        list.filter(o => o).forEach(it => o = { ...o, ...it });\r\n        return o;\r\n    }\r\n\r\n    /**\r\n     * Convert data to format by given definition.\r\n     * @param {object} cfg {name:'field_name' , type:'date', format:'d/m/y', currency:'eur', language:'hr', extract:'REGEX'}\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    static format(cfg, val) {\r\n\r\n        const type = GSData.#toType(cfg, val);\r\n        const language = cfg.language || GSUtil.language;\r\n        const rule = GSUtil.toRegex(cfg.extract, 'g');\r\n        val = rule ? val.match(rule)[0] : val;\r\n\r\n        // intercept overrides; used b GS-TABLE cell Ui remapping\r\n        if (cfg.childElementCount > 0) {\r\n            const el = cfg.querySelector(`gs-item[value=\"${val}\"]`);\r\n            return GSAttr.get(el, \"map\", val);\r\n        }\r\n\r\n        switch (type) {\r\n            case 'timestamp':\r\n                if (val instanceof Date) return val;\r\n                if (GSUtil.isNumber(val)) return new GSDate(val).format(cfg.format, language);\r\n                if (cfg.format) return GSDate.parse(val, cfg.format, language);\r\n                return Date.parse(val);\r\n            case 'date':\r\n                if (val instanceof Date) return val;\r\n                const fmt = GSUtil.asBool(cfg.format) ? undefined : cfg.format;\r\n                if (GSUtil.isString(val)) return GSDate.parse(val, fmt, language);\r\n                return val && val != 0 ? new GSDate(val).format(fmt, language) : val;\r\n            case 'string':\r\n            case 'text':\r\n                if (val instanceof Date) {\r\n                    const fmt = cfg.format || GSUtil.getDateFormat(language);\r\n                    return new GSDate(val).format(fmt, language);\r\n                };\r\n                break;\r\n            case 'boolean':\r\n                return GSUtil.asBool(val, false);\r\n            case 'number':\r\n                return GSUtil.asNum(val, val, language);\r\n            case 'currency':\r\n                if (GSUtil.isString(val)) val = GSUtil.asNum(val);\r\n                const opt = { style: 'currency', currency: cfg.currency };\r\n                return new Intl.NumberFormat(language, opt).format(val);\r\n        }\r\n\r\n        return val;\r\n    }\r\n\r\n    static #toType(cfg, val) {\r\n        if (cfg.type) return cfg.type;\r\n        if (val instanceof Date) return 'date';\r\n        if (val instanceof Number) return 'number';\r\n        if (val instanceof Boolean) return 'boolean';\r\n        return typeof val;\r\n    }\r\n\r\n    /**\r\n     * Filter array of records \r\n     * @param {Array} data Array of JSON objects or array of array of primitive types\r\n     * @param {Array<object>|String} filter Check filterComplex function for details\r\n     * @param {Array<String>} fields List of Object properties to check, if not set, all are checked\r\n     * @returns {Array}\r\n     */\r\n    static *filter(data = [], filter = [], fields, limit = 0) {\r\n        let cnt = 0;\r\n        let sts = false;\r\n        for (let rec of data) {\r\n            sts = GSData.filterRecord(rec, filter, fields);\r\n            if (sts) {\r\n                cnt++\r\n                yield rec;\r\n            }\r\n            if (limit > 0 && cnt >= limit) break;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Filter array of records \r\n     * @param {Array} data Array of JSON objects or array of array of primitive types\r\n     * @param {Array<object>|String} filter Check filterComplex function for details\r\n     * @param {Array<String>} fields List of Object properties to check, if not set, all are checked\r\n     * @returns {Array}\r\n     */\r\n    static filterData(data = [], filter = [], fields, limit = 0) {\r\n        data = Array.isArray(data) ? data : [data];\r\n        filter = Array.isArray(filter) ? filter : [filter];\r\n        if (filter.length === 0) return data;\r\n        return [...GSData.filter(data, filter, fields, limit)];\r\n    }\r\n\r\n    /**\r\n     * Filter single record to a matchign critheria\r\n     * @param {Array<object>|String} filter Check filterComplex function for details\r\n     * @param {Array} data Array of JSON objects or array of array of primitive types\r\n     * @param {Array<String>} fields List of Object properties to check, if not set, all are checked\r\n     * @returns {Array}\r\n     */\r\n    static filterRecord(rec, filter, fields) {\r\n        const isSimple = GSUtil.isPrimitive(filter);\r\n        return isSimple ? GSData.filterSimple(rec, filter, fields) : GSData.filterComplex(rec, filter, fields);\r\n    }\r\n\r\n    /**\r\n     * Check if JSON object contains a value in any of defined properties\r\n     * @param {Object} rec Json object to check\r\n     * @param {String} filter Value to search for\r\n     * @param {Array<string>} fields List of properties to serach\r\n     * @returns {Boolean} Return true if any of given properties (or all) contains provided value\r\n     */\r\n    static filterSimple(rec, filter = '', fields) {\r\n        filter = filter.toLowerCase();\r\n        fields = fields || Object.keys(rec);\r\n        let value = null;\r\n        for (let key of fields) {\r\n            value = rec[key];\r\n            if (GSData.filterValue(value, filter)) return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Check if object contains data in selected properties\r\n     * @todo Add support for eq,gt,lt,like,or operators\r\n     * @param {Object|Array} rec Json object or array of primitive values to check\r\n     * @param {Array<Object>} filter List of filter objects in format\r\n     *        [{name: idx[num] || name[string], value: ''  , op:'eq'}]\r\n     *        Where:\r\n     *           - name is numeric index only if rec is array of primitive values ([1,'a','b',4]...etc)\r\n     *           - name is string if rec is JSON object\r\n     * @returns {Boolean} Flag indicating if record is matched to a given filter critheria\r\n     */\r\n    static filterComplex(rec, filter, fields) {\r\n\r\n        let primitive = false;\r\n        let found = true;\r\n        let value = null;\r\n\r\n        for (let flt of filter) {\r\n\r\n            primitive = GSUtil.isPrimitive(flt);\r\n            if (primitive) {\r\n                found = found && GSData.filterSimple(rec, flt, fields);\r\n            } else {\r\n                value = rec[flt.name];\r\n                if (flt.name) {\r\n                    found = found && GSData.filterValue(value, flt)\r\n                } else {\r\n                    found = found && GSData.filterSimple(rec, flt.value, fields);\r\n                }\r\n            }\r\n\r\n            if (!found) break;\r\n        }\r\n\r\n        return found;\r\n    }\r\n\r\n    static filterValue(value, filter) {\r\n        const toCheck = GSUtil.isPrimitive(filter) ? filter : filter.value;\r\n        if (GSUtil.isDate(value)) {\r\n            return GSData.matchDate(value, filter);\r\n        } else if (GSUtil.isNumber(value)) {\r\n            return GSData.matchNumber(value, GSUtil.asNum(toCheck, null), filter.op);\r\n        } else {\r\n            return (GSUtil.normalize(value)).toLocaleLowerCase().includes(GSUtil.normalize(toCheck).toLocaleLowerCase());\r\n        }\r\n    }\r\n\r\n    static matchDate(val, filter, language) {\r\n\r\n        if (typeof filter === 'string') {\r\n            const value = '' + filter;\r\n            const local = val.toLocaleDateString(language);\r\n            const iso = val.toISOString();\r\n            return local.includes(value) || iso.includes(value);\r\n        }\r\n\r\n        if (!filter.value) return false;\r\n\r\n        const qry = filter.value instanceof Date ? 'date' : typeof filter.value;\r\n\r\n        switch (qry) {\r\n            case 'number':\r\n                return GSData.matchNumber(val.getTime(), filter.value, filter.op);\r\n            case 'date':\r\n                return GSData.matchNumber(val.getTime(), filter.value.getTime(), filter.op);\r\n        }\r\n\r\n        return GSData.matchDate(val, '' + filter.value, filter.language);\r\n    }\r\n\r\n    /**\r\n     * Match number by operator\r\n     * @param {*} value \r\n     * @param {*} query \r\n     * @param {*} operator \r\n     */\r\n    static matchNumber(value = 0, query = 0, operator = 'eq') {\r\n        switch (operator) {\r\n            case 'gt': return query > value;\r\n            case 'lt': return query < value;\r\n            case 'ge': return query >= value;\r\n            case 'le': return query <= value;\r\n        }\r\n        return value === query;\r\n    }\r\n\r\n    /**\r\n     * Sort data\r\n     * @param {*} data \r\n     * @param {*} sort \r\n     * @returns {Array}\r\n     */\r\n    static sortData(data, sort) {\r\n        if (sort.length === 0) return data;\r\n        return data.toSorted((a, b) => GSData.sortPair(a, b, sort));\r\n    }\r\n\r\n    /**\r\n     * Sort two values, recursion supported\r\n     * @param {*} v1 Array of primitive types or JSON object\r\n     * @param {*} v2 Array of primitive types or JSON object\r\n     * @param {Number} sort -1 | 0 | 1 (descending, as id, ascending )\r\n     * @returns {Number} -1 | 0 | 1\r\n     */\r\n    static sortPair(a, b, sort) {\r\n\r\n        const isArray = Array.isArray(a);\r\n        let sts = 0;\r\n\r\n        sort.forEach((o, i) => {\r\n            if (!o) return;\r\n            const ord = GSUtil.isNumber(o) ? o : o.ord;\r\n            const idx = GSUtil.isNumber(o.col) ? o.col : i;\r\n            const key = isArray ? idx : o.name;\r\n            const v1 = a[key];\r\n            const v2 = b[key];\r\n\r\n            sts = GSData.compare(v1, v2, ord, sts);\r\n        });\r\n\r\n        return sts;\r\n    }\r\n\r\n    /**\r\n     * Compare two values, recursion supported\r\n     * @param {*} v1 \r\n     * @param {*} v2 \r\n     * @param {Number} order -1 | 0 | 1 (descending, as id, ascending )\r\n     * @param {Number} sts previous value\r\n     * @returns {Number} -1 | 0 | 1\r\n     */\r\n    static compare(v1, v2, order, sts) {\r\n        if (GSUtil.isNumber(v1) && GSUtil.isNumber(v2)) {\r\n            return sts || GSData.compareNum(v1, v2, order);\r\n        } else if (GSUtil.isString(v1) || GSUtil.isString(v2)) {\r\n            return sts || GSData.compareString(v1, v2, order);\r\n        } else if (GSUtil.isBool(v1) || GSUtil.isBool(v2)) {\r\n            return sts || GSData.compareBool(v1, v2, order);\r\n        } else if (GSUtil.isDate(v1) || GSUtil.isDate(v2)) {\r\n            return sts || GSData.compareNum(Number(v1), Number(v2), order);\r\n        }\r\n        return sts;\r\n    }\r\n\r\n    /**\r\n     * Safely compare two boolean values\r\n     * @param {Boolean} v1 \r\n     * @param {Boolean} v2 \r\n     * @param {Number} ord \r\n     * @returns {Number} -1 | 0 | 1\r\n     */\r\n    static compareBool(v1, v2, ord) {\r\n        v1 = v1 ? 1 : 0;\r\n        v2 = v2 ? 1 : 0;\r\n        return GSData.compareNum(v1, v2, ord);\r\n    }\r\n\r\n    /**\r\n     * Compare two string values \r\n     * @param {String} v1 \r\n     * @param {String} v2 \r\n     * @param {Number} ord \r\n     * @returns {Number} -1, 1, 0\r\n     */\r\n    static compareString(v1, v2, ord) {\r\n        const s1 = (v1 || '').toString();\r\n        const s2 = (v2 || '').toString();\r\n        return ord < 0 ? s2.localeCompare(s1) : s1.localeCompare(s2);\r\n    }\r\n\r\n    /**\r\n     * Compare two numeric values\r\n     * @param {Number} v1 \r\n     * @param {Number} v2 \r\n     * @param {Number} ord positive = ascending, negative - descending \r\n     * @returns {Number} < 0 or 1 or > 0\r\n     */\r\n    static compareNum(v1, v2, ord) {\r\n        return ord < 0 ? v2 - v1 : v1 - v2;\r\n    }\r\n\r\n    /**\r\n     * Write value to JSON object into structured name.\r\n     * Name subelements are separated by dot (users.name etc.).\r\n     * @param {Object} obj \r\n     * @param {String} name  \r\n     * @param {Boolean} ignoreNull  \r\n     * @param {Object} value \r\n     */\r\n    static writeToObject(obj, name, value, ignoreNull = true) {\r\n        if (ignoreNull && GSUtil.isNull(value)) return;\r\n\r\n        const seg = name.split('.');\r\n        if (seg.length === 1) {\r\n            return GSData.#writeSingleToObject(obj, name, value);\r\n        }\r\n\r\n        const tree = seg.slice(0, -1);\r\n        const key = seg.slice(-1)[0];\r\n\r\n        tree.forEach(v => {\r\n            if (!obj.hasOwnProperty(v)) obj[v] = {};\r\n            obj = obj[v];\r\n        });\r\n\r\n        return GSData.#writeSingleToObject(obj, key, value);\r\n    }\r\n\r\n    static #writeSingleToObject(obj, name, value) {\r\n        if (obj.hasOwnProperty(name)) {\r\n            if (!Array.isArray(obj[name])) {\r\n                obj[name] = [obj[name]];\r\n            }\r\n            if (Array.isArray(value)) {\r\n                obj[name] = obj[name].concat(value);\r\n            } else {\r\n                obj[name].push(value);\r\n            }\r\n        } else {\r\n            obj[name] = value;\r\n        }\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Read object property by supporting arrays\r\n     * name can be plain name or name[idx]\r\n     * @param {*} obj \r\n     * @param {String} name \r\n     * @returns {*}\r\n     */\r\n    static readFromProperty(obj, name, partial = false) {\r\n        if (GSUtil.isNull(obj)) return;\r\n        const r = /\\[\\d+\\]$/g;\r\n        const isArray = r.test(name);\r\n        let n = name;\r\n        let i = '';\r\n\r\n        if (isArray) {\r\n            n = name.replace(r, '')\r\n            i = name.match(r).shift().match(/\\d+/).shift();\r\n            i = GSUtil.asNum(i);\r\n            obj = obj.hasOwnProperty(n) ? obj[n][i] : null;\r\n        } else if (obj.hasOwnProperty(n)) {\r\n            obj = partial ? obj[n] || obj : obj[n];\r\n        } else {\r\n            obj = null;\r\n        }\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Read value from JSON object by structured name.\r\n     * Name subelements are separated by dot (users.name etc.).\r\n     * @param {Object} obj \r\n     * @param {String} name \r\n     * @returns {*}\r\n     */\r\n\tstatic readFromObject(obj, name) {\r\n        if (obj?.hasOwnProperty(name)) return GSData.readFromProperty(obj, name);\r\n\t\treturn name ? name.split('.').reduce((a, v) => GSData.readFromProperty(a, v), obj) : undefined;\r\n\t}\r\n\t\r\n    /**\r\n     * Check if named path exist within the object\r\n     * @param {Object} obj \r\n     * @param {String} name \r\n     * @returns {Boolean}\r\n     */\r\n\tstatic objectPathExist(obj, name) {\r\n        return GSData.readFromObject(obj, name) !== undefined;\r\n\t}\r\n\r\n    /**\r\n     * Create a deep clone of an object\r\n     * @param {Object} obj \r\n     * @returns {Object}\r\n     */\r\n    static deepClone(obj) {\r\n        return JSON.parse(JSON.stringify(obj));\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSData);\r\n        globalThis.GSData = GSData;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDOM class\r\n * @module base/GSDOM\r\n */\r\n\r\nimport { DEF } from './GSConst.mjs';\r\nimport { GSAttr } from \"./GSAttr.mjs\";\r\nimport { GSCSSMap } from \"./GSCSSMap.mjs\";\r\nimport { GSData } from \"./GSData.mjs\";\r\nimport { GSLog } from \"./GSLog.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A generic set of static functions to handle DOM tree and DOM elements\r\n * @class\r\n */\r\nexport class GSDOM {\r\n\r\n\tstatic QUERY_FOCUSABLE = \"a[href]:not([tabindex='-1']),area[href]:not([tabindex='-1']),input:not([disabled]):not([tabindex='-1']),select:not([disabled]):not([tabindex='-1']),textarea:not([disabled]):not([tabindex='-1']),button:not([disabled]):not([tabindex='-1']),iframe:not([tabindex='-1']),[tabindex]:not([tabindex='-1']),[contentEditable=true]:not([tabindex='-1'])\";\r\n\tstatic QUERY_INPUT = \"input:not([type='hidden']):not(disabled):not(readonly),select:not([type='hidden']):not(disabled):not(readonly),textarea:not([type='hidden']):not(disabled):not(readonly)\";\r\n\tstatic #FORMEL = ['INPUT', 'SELECT', 'TEXTAREA', 'OUTPUT'];\r\n\t//static #CLEANUP1 = /(\\n*\\t*)*(?=\\n\\t*)/g\r\n\tstatic #CLEANUP1 = /(?:\\n+\\t*)+/g\r\n\r\n\t// Timeout for removing element\r\n\tstatic SPEED = 300;\r\n\r\n\t/**\r\n\t * Recursevly clean child elements. Helper for GC\r\n\t * @param {*} owner \r\n\t */\r\n\tstatic cleanup(owner) {\r\n\t\tArray.from(GSDOM.walk(owner, false, true, false))\r\n\t\t.forEach(el => {\r\n\t\t\tif (GSDOM.isTemplateElement(el)) GSDOM.cleanup(el.content);\r\n\t\t\t//el.remove?.();\r\n\t\t\t//owner.removeChild(el);\r\n\t\t\tel.parentElement?.removeChild?.(el);\r\n\t\t\tel.innerHTML = '';\r\n\t\t\tel.nodeValue = undefined;\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Find active (focused) element\t\r\n\t * @returns {HTMLElement} Focused element\r\n\t */\r\n\tstatic get activeElement() {\r\n\t\treturn GSDOM.active(document.activeElement);\r\n\t}\r\n\r\n\t/**\r\n\t * Find active (focused) element\r\n\t * @param {HTMLElement} el Starting node\r\n\t * @returns {HTMLElement} Focused element\r\n\t */\r\n\tstatic active(el) {\r\n\t\treturn el.shadowRoot?.activeElement ? GSDOM.active(el.shadowRoot?.activeElement) : el;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if element is visible\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isVisible(el) {\r\n\t\tif (!GSDOM.isHTMLElement(el)) return false;\r\n\t\tconst css = GSCSSMap.getComputedStyledMap(el);\r\n\t\tconst visibility = !css.matches('visibility', 'hidden');\r\n\t\tconst display = !css.matches('display', 'none');\r\n\t\tconst opacity = css.asNum('opacity') > 0;\r\n\t\tconst rect = el.getBoundingClientRect();\r\n\t\tconst size = (rect.width > 0 && rect.height > 0);\r\n\t\treturn size && opacity && visibility && display;\r\n\t}\r\n\r\n\t/**\r\n\t* Parse string into html DOM\r\n\t*\r\n\t* @param {String} html Source to parse\r\n\t* @param {Boolean} single Return first element or all\r\n\t* @param {String} mime Src mime type\r\n\t* @return {HTMLElement}\r\n\t*/\r\n\tstatic parse(html = '', single = false, mime = 'text/html') {\r\n\t\ttry {\r\n\t\t\tconst parser = new DOMParser();\r\n\t\t\tconst doc = parser.parseFromString(html, mime);\r\n\t\t\treturn single ? (doc?.head?.firstElementChild || doc?.body?.firstElementChild) : doc;\r\n\t\t} catch (e) {\r\n\t\t\tGSLog.error(null, e);\r\n\t\t\tthrow e;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Parse source and auto wrap if required\r\n\t * @param {GSElement} own \r\n\t * @param {String} src \r\n\t * @returns {HTMLElement}\r\n\t */\r\n\tstatic parseWrapped(own, src = '', forceWrap = false) {\r\n\r\n\t\tconst doc = GSDOM.parse(src);\r\n\t\tconst head = GSDOM.#fromNode(doc.head.children);\r\n\t\tconst body = GSDOM.#fromNode(doc.body.children);\r\n\r\n\t\tconst nodes = [...head, ...body];\r\n\r\n\t\tconst wrap = forceWrap || nodes.length !== 1;\r\n\r\n\t\tconst tpl = GSDOM.wrap(own, wrap ? null : nodes.shift());\r\n\r\n\t\twhile (nodes.length > 0) tpl.appendChild(nodes.shift());\r\n\r\n\t\treturn tpl;\r\n\t}\r\n\r\n\t/**\r\n\t * The same as link function, with default wrapper element\r\n\t * \r\n\t * @param {HTMLElement} own Owner element to which target is linked\r\n\t * @param {HTMLElement} target Target elemetn to link to owner\r\n\t * @returns {HTMLElement} Return target\r\n\t */\r\n\tstatic wrap(own, target) {\r\n\t\treturn GSDOM.link(own, target || document.createElement('gs-block'));\r\n\t}\r\n\r\n\t/**\r\n\t * Create reference between two HTMLElements\r\n\t * \r\n\t * @param {HTMLElement} own Owner element to which target is linked\r\n\t * @param {HTMLElement} target Target elemetn to link to owner\r\n\t * @returns {HTMLElement} Return target\r\n\t */\r\n\tstatic link(own, target) {\r\n\t\ttarget.setAttribute('proxy', `#${own.id}`);\r\n\t\tif (own.slot) target.setAttribute('slot', own.slot);\r\n\t\treturn target;\r\n\t}\r\n\r\n\tstatic #fromNode(nodes) {\r\n\t\treturn Array.from(nodes || []).filter(el => !GSDOM.isText(el));\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given value is part of HTMLFormElement\r\n\t * @param {string | HTMLElement} el \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isFormElement(el) {\r\n\t\tconst name = GSUtil.isString(el) ? el : el?.tagName;\r\n\t\treturn GSDOM.#FORMEL.includes(name);\r\n\t}\r\n\r\n\t/**\r\n\t * Return all form elements for a given root element\r\n\t * @param {HTMLElement} el \r\n\t * @param {Boolean} shadow \r\n\t * @returns \r\n\t */\r\n\tstatic formElements(el, shadow = false) {\r\n\t\treturn GSDOM.queryAll(el, GSDOM.#FORMEL.map(v => v.toLowerCase()), shadow);\r\n\t}\r\n\r\n\t/**\r\n\t * Check if element is button\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isButtonElement(el) {\r\n\t\treturn (el instanceof HTMLButtonElement)\r\n\t\t\t|| el?.tagName === 'GS-BUTTON'\r\n\t\t\t|| GSDOM.hasClass(el, 'btn');\r\n\t}\r\n\r\n\t/**\r\n\t  * Check if given element is of given type \r\n\t  * \r\n\t  * @param {HTMLElement} el\r\n\t  * @param {String|class} type Tag Name, class name or Class\r\n\t  * @returns {Boolean}\r\n\t  */\r\n\tstatic isElement(el, type) {\r\n\r\n\t\tconst isArgs = type && el;\r\n\t\tif (!isArgs) return false;\r\n\r\n\t\tconst isStr = GSUtil.isString(type);\r\n\r\n\t\tif (!isStr) return el instanceof type;\r\n\r\n\t\tconst ownClazz = customElements.get(type.toLowerCase());\r\n\t\tif (ownClazz && el instanceof ownClazz) return el;\r\n\r\n\t\tconst it = GSDOM.inheritance(el);\r\n\t\tfor (let pel of it) {\r\n\t\t\tif (pel?.constructor?.name === type) return el;\r\n\t\t}\r\n\r\n\t\tif (type.toUpperCase() === el.tagName) return el;\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type HTMLSelectElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isSelect(el) {\r\n\t\treturn el instanceof HTMLSelectElement;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type HTMLSlotElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isSlotElement(el) {\r\n\t\treturn el instanceof HTMLSlotElement;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type HTMLElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isTemplateElement(el) {\r\n\t\treturn el instanceof HTMLTemplateElement;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type HTMLElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isHTMLElement(el) {\r\n\t\treturn el instanceof HTMLElement;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type SVGElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isSVGElement(el) {\r\n\t\treturn el instanceof SVGElement;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type Text\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isText(el) {\r\n\t\treturn el instanceof Text;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type Comment\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isComment(el) {\r\n\t\treturn el instanceof Comment;\r\n\t}\r\n\r\n\t/*\r\n\t * Check if given element is of type GSElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isGSElement(el) {\r\n\t\tif (!el?.clazzName) return false;\r\n\t\tconst it = GSDOM.inheritance(el);\r\n\t\tfor (let v of it) {\r\n\t\t\tif (!v) break;\r\n\t\t\tif (v?.clazzName === 'GSElement') return true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if standard element extended with GS\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isGSExtra(el) {\r\n\t\treturn el?.getAttribute('is')?.indexOf('GS-') === 0;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if element is inside shadowDom\r\n\t * @param {*} el \r\n\t */\r\n\tstatic isShadowed(el) {\r\n\t\treturn GSDOM.parentAll(el).filter(e => e instanceof ShadowRoot).next()?.value;\r\n\t}\r\n\r\n\t/**\r\n\t * Get all child GSElement\t\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Array<HTMLElement>}\r\n\t */\r\n\tstatic getChilds(el) {\r\n\t\treturn Array.from(el?.childNodes || []).filter(e => GSDOM.isGSElement(e));\r\n\t}\r\n\r\n\t/**\r\n\t * Hide html element\r\n\t * @param {HTMLElement} el \r\n\t * @param {Boolean} orientation \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic hide(el, orientation = false) {\r\n\t\treturn el?.classList?.add(orientation ? 'gs-hide-orientation' : 'gs-hide');\r\n\t}\r\n\r\n\t/**\r\n\t * Show html element\r\n\t * @param {HTMLElement} el \r\n\t * @param {Boolean} orientation \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic show(el, orientation = false) {\r\n\t\treturn el?.classList?.remove(orientation ? 'gs-hide-orientation' : 'gs-hide');\r\n\t}\r\n\r\n\t/**\r\n\t * Add node as next in list of nodes\r\n\t * @param {HTMLElement} target \r\n\t * @param {HTMLElement} newEl \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic addSibling(target, newEl) {\r\n\t\tconst injectable = GSDOM.isHTMLElement(newEl) || GSDOM.isSVGElement(newEl);\r\n\t\tconst isOK = GSDOM.isHTMLElement(target) && injectable;\r\n\t\tconst invalid = target === newEl && target.parentNode === newEl || target.nextElementSibling === newEl;\r\n\t\treturn isOK && !invalid ? target.parentNode.insertBefore(newEl, target.nextElementSibling) : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Add child node to a target\r\n\t * @param {HTMLElement} target \r\n\t * @param {HTMLElement} newEl \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic appendChild(target, newEl) {\r\n\t\tconst isok = GSDOM.isHTMLElement(target) && GSDOM.isHTMLElement(newEl);\r\n\t\treturn isok && target !== newEl ? target.appendChild(newEl) : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Add node to a target at specified place\r\n\t * @param {HTMLElement} target \r\n\t * @param {HTMLElement} newEl \r\n\t * @param {String} placement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic insertAdjacent(target, newEl, placement) {\r\n\t\tconst isok = GSDOM.isHTMLElement(target) && GSDOM.isHTMLElement(newEl);\r\n\t\tconst invalid = target === newEl && target.parentNode === newEl\r\n\t\treturn isok && !invalid ? target.insertAdjacentElement(placement, newEl) : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Remove genarated componnt from parent\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic removeElement(el) {\r\n\t\treturn GSDOM.parent(el)?.removeChild(el);\r\n\t}\r\n\r\n\t/**\r\n\t * Walk node tree\r\n\t * \r\n\t * @param {HTMLLegendElement} node Start node to walk from \r\n\t * @param {Boolean} closest Direction down (false) or up (true)\r\n\t * @param {Boolean} all  Filter HTMLElements (false) only or text also (true) (only down)\r\n\t * @param {Boolean} shadow Traverse shadow DOM also (only down)\r\n\t * @returns {Iterable}\r\n\t */\r\n\tstatic walk(node, closest = false, all = false, shadow = true) {\r\n\t\treturn closest ? GSDOM.parentAll(node) : GSDOM.childAll(node, all, shadow);\r\n\t}\r\n\r\n\t/**\r\n\t * Traverse DOM tree top-to-bottom\r\n\t * \r\n\t * @param {*} node Start node\r\n\t * @param {*} all  Include all elements (Text,Comment, HTMLElements)\r\n\t * @param {*} shadow Include traversing across shadow tree\r\n\t * @param {*} child Inernal, do not use\r\n\t * @returns {Iterable}\r\n\t */\r\n\tstatic *childAll(node, all = false, shadow = true, child = false) {\r\n\t\tif (!node) return;\r\n\t\tif (child) yield node;\r\n\t\tif (shadow) yield* GSDOM.childAll(node.shadowRoot, all, shadow, true);\r\n\t\tconst list = all ? node.childNodes : node.children;\r\n\t\tif (!list) return;\r\n\t\tfor (let child of list) {\r\n\t\t\tyield* GSDOM.childAll(child, all, shadow, true);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Get parent element\r\n\t * \r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement}\r\n\t */\r\n\tstatic parent(el) {\r\n\t\treturn el ? (el.parentElement || el.parentNode || el.host) : null;\r\n\t}\r\n\r\n\t/**\r\n\t * Parent element iterator\r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement}\r\n\t * @iterator\r\n\t */\r\n\tstatic *parentAll(el) {\r\n\t\tlet e = GSDOM.parent(el);\r\n\t\twhile (e) {\r\n\t\t\tyield e;\r\n\t\t\te = GSDOM.parent(e);\r\n\t\t}\r\n\t\tif (e) return yield e;\r\n\t}\r\n\r\n\t/**\r\n\t * Element prototype iterator\r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement}\r\n\t * @iterator\r\n\t */\r\n\tstatic *inheritance(el) {\r\n\t\tlet e = el.__proto__;\r\n\t\twhile (e) {\r\n\t\t\tyield e;\r\n\t\t\te = e.__proto__;\r\n\t\t}\r\n\t\tif (e) return yield e;\r\n\t}\r\n\r\n\t/**\r\n\t * Recursively find offsetparent; used in positional offset calculation\r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement}\r\n\t */\r\n\tstatic offsetParent(el) {\r\n\t\tlet offset = el?.offsetParent;\r\n\t\tif (offset) return offset;\r\n\t\tconst it = GSDOM.parentAll(el);\r\n\t\tfor (const c of it) {\r\n\t\t\toffset = c.offsetParent;\r\n\t\t\tif (offset) break;\r\n\t\t}\r\n\t\treturn offset;\r\n\t}\r\n\r\n\t/**\r\n\t * Get root element whch might be shadow root, GSElement, any parent element\r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement|ShadowRoot}\r\n\t */\r\n\tstatic root(el) {\r\n\r\n\t\tif (!el) return null;\r\n\r\n\t\tconst it = GSDOM.parentAll(el);\r\n\t\tfor (let v of it) {\r\n\t\t\tif (v instanceof ShadowRoot) return v;\r\n\t\t\tif (v instanceof HTMLBodyElement) return v;\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * Get WebComponent owning element inside rendered shadow root\r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement}\r\n\t */\r\n\tstatic component(el) {\r\n\t\treturn GSDOM.parent(GSDOM.root(el));\r\n\t}\r\n\r\n\t/**\r\n\t * Get node index between siblings\r\n\t * @param {HTMLElement} node \r\n\t * @returns {Number}\r\n\t */\r\n\tstatic getElementIndex(node) {\r\n\t\tif (!GSDOM.isHTMLElement(node)) return 0;\r\n\t\treturn [...node.parentElement.children].indexOf(node);\r\n\t}\r\n\r\n\t/**\r\n\t * Find element by ID within DOM Tree across Shadow DOM\r\n\t * @param {HTMLElement} el Root node to start from\r\n\t * @param {String} id Element id\r\n\t * @returns {HTMLElement} \r\n\t */\r\n\tstatic getByID(el, id) {\r\n\t\tif (typeof el === 'string') return GSDOM.getByID(document.documentElement, el);\r\n\t\tif (!(el && id)) return null;\r\n\t\tconst it = GSDOM.walk(el, false);\r\n\t\tfor (let o of it) {\r\n\t\t\tif (o.id === id) return o;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * Query DOM Tree up to find closest element across Shadow DOM\r\n\t * @param {HTMLElement} el Root node to start from\r\n\t * @param {String} qry CSS query\r\n\t * @param {Number} level How many levels to walk, 0 = all\r\n\t * @returns {HTMLElement} \r\n\t */\r\n\tstatic closest(el, qry, levels = 0) {\r\n\t\tif (typeof el === 'string') return GSDOM.closest(document.documentElement, qry);\r\n\t\tif (!(el && qry)) return null;\r\n\t\tlevels = GSUtil.asNum(levels, 0);\r\n\t\tconst limit = levels > 0;\r\n\t\tconst it = GSDOM.walk(el, true);\r\n\t\tfor (let o of it) {\r\n\t\t\tif (GSDOM.matches(o, qry)) return o;\r\n\t\t\tif (limit && --levels == 0) return null;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * Query DOM tree with support for Shadow DOM\r\n\t * \r\n\t * @param {HTMLElement} el Root node to start from\r\n\t * @param {String} qry CSS query\r\n\t * @param {boolean} all If true, filter text elements also\r\n\t * @param {boolean} shadow If true, will cross shadow boundary\r\n\t * @returns {HTMLElement} \r\n\t */\r\n\tstatic query(el, qry, all = false, shadow = true) {\r\n\t\tif (typeof el === 'string') return GSDOM.query(document.documentElement, el, all, shadow);\r\n\t\tif (!(el && qry)) return null;\r\n\t\tif (GSDOM.matches(el, qry)) return GSDOM.#proxy(el);\r\n\t\tconst it = GSDOM.walk(el, false, all, shadow);\r\n\t\tfor (let o of it) {\r\n\t\t\tif (GSDOM.matches(o, qry)) return GSDOM.#proxy(o);\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * Query DOM tree with support for Shadow DOM\r\n\t * \r\n\t * @param {HTMLElement|String} el Root node to start from\r\n\t * @param {String} qry CSS query\r\n\t * @param {boolean} all If true, filter text elements also\r\n\t * @param {boolean} shadow If true, will cross shadow boundary\r\n\t * @returns {Array<HTMLElement>}\r\n\t*/\r\n\tstatic queryAll(el, qry, all = false, shadow = true) {\r\n\t\tif (typeof el === 'string') {\r\n\t\t\tif (qry) {\r\n\t\t\t\tel = GSDOM.query(el);\r\n\t\t\t} else {\r\n\t\t\t\treturn GSDOM.queryAll(document.documentElement, el, all, shadow);\r\n\t\t\t}\r\n\t\t} \r\n\t\tconst res = [];\r\n\t\tif (!(el && qry)) return res;\r\n\t\tconst it = GSDOM.walk(el, false, all, shadow);\r\n\t\tfor (let o of it) {\r\n\t\t\tif (GSDOM.matches(o, qry)) res.push(GSDOM.#proxy(o));\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n\r\n\t/**\r\n\t * Overide native to prevent DOM issue when input field name=id\r\n\t * @returns{Proxy}\r\n\t */\r\n\tstatic #proxy(el) {\r\n\t\tif (el.tagName !== 'FORM') return el;\r\n\t\tif (!GSDOM.isHTMLElement(el.id)) return el;\r\n\t\treturn new Proxy(el, {\r\n\t\t\tget: function (target, prop, receiver) {\r\n\t\t\t\tif (prop === '_owner_') return target;\r\n\t\t\t\tif (prop === 'id') return target.getAttribute('id');\r\n\t\t\t\tconst res = Reflect.get(target, prop);\r\n\t\t\t\treturn GSFunction.isFunction(res) ? res.bind(target) : res;\r\n\t\t\t},\r\n\t\t\tset: function (target, prop, value) {\r\n\t\t\t\treturn target[prop] = value;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Match element against CSS query\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} qry \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic matches(el, qry) {\r\n\t\t// return el && qry && typeof el.matches === 'function' && el.matches(qry);\r\n\t\treturn el && typeof el.matches === 'function' && el.matches(qry);\r\n\t}\r\n\r\n\t/**\r\n\t * Set html text to provided element.\r\n\t * NOTE: Done intentionaly like this to prevent source validation warning.\r\n\t *       Use sanitizer when not any more experimental feature;\r\n\t *       Watch for default Sanitizer.getDefaultConfiguration()\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} val \r\n\t * @param {Boolean} sanitize \r\n\t * @param {Sanitizer} sanitizer \r\n\t * @returns {void}\r\n\t */\r\n\tstatic setHTML(el, val = '', sanitize = false, sanitizer) {\r\n\t\tconst isValid = el instanceof ShadowRoot || el instanceof HTMLElement || el instanceof HTMLTemplateElement;\r\n\t\tif (!isValid) return;\r\n\t\tif (sanitize && el?.setHTML) {\r\n\t\t\tsanitizer ? el.setHTML(val, { sanitizer }) : el.setHTML(val);\r\n\t\t} else {\r\n\t\t\tel.innerHTML = val instanceof Document ? val.body.innerHTML : val;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Set text to provided element\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} val \r\n\t * @returns {void}\r\n\t */\r\n\tstatic setText(el, val = '') {\r\n\t\tif (el) el.textContent = val;\r\n\t}\r\n\r\n\t/**\r\n\t * Set style to an element\r\n\t * @param {HTMLElement|string} el \r\n\t * @param {Object} obj \r\n\t */\r\n\tstatic css(el, obj) {\r\n\t\tif (GSUtil.isString(el)) el = GSDOM.queryAll(el);\r\n\t\tif (GSDOM.isHTMLElement(el)) el = [el];\r\n\t\tif (!(Array.isArray(el) && el.length > 0)) return false;\r\n\t\trequestAnimationFrame(() => {\r\n\t\t\tel.forEach(it => Object.assign(it.style, obj));\r\n\t\t\t/*\r\n\t\t\tel.forEach(it => {\r\n\t\t\t\tObject.entries(obj).forEach(kv => {\r\n\t\t\t\t\tit.style[kv[0]] = kv[1];\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\t*/\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Safe way to toggle CSS class on element, multipel classes are supported in space separated string list\r\n\t * @param {HTMLElement|string} el \r\n\t * @param {*} val list of css classes in space separated string\r\n\t * @param {Boolean} sts True to add, false to remove\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic toggleClass(el, val, sts) {\r\n\t\tif (GSUtil.isString(el)) el = GSDOM.queryAll(el);\r\n\t\tif (GSDOM.isHTMLElement(el)) el = [el];\r\n\t\tif (!(Array.isArray(el) && el.length > 0)) return false;\r\n\t\tif (!val || val.trim().length == 0) return false;\r\n\t\tval = val.split(' ').filter(v => v && v.trim().length > 0);\r\n\t\tif (GSUtil.isNull(sts)) return val.forEach(v => {\r\n\t\t\tel.forEach(it => it.classList.toggle(v));\r\n\t\t});\r\n\t\tel.forEach(it => {\r\n\t\t\tsts ? it.classList.add.apply(it.classList, val) : it.classList.remove.apply(it.classList, val);\r\n\t\t});\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t * Toggle element visibility\r\n\t * @param {HTMLElement|string} el \r\n\t * @param {Boolean} sts \r\n\t */\r\n\tstatic toggle(el, sts) {\r\n\t\treturn GSDOM.toggleClass(el, 'd-none', GSUtil.isNull(sts) ? sts : !sts);\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if element contains a css class\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic hasClass(el, val = '') {\r\n\t\treturn el?.classList?.contains(val);\r\n\t}\r\n\r\n\t/**\r\n\t * Alternative way to clear fields instead of form.reset()\r\n\t * @param {HTMLElement} owner \r\n\t * @param {String} qry \r\n\t */\r\n\tstatic clearInputs(owner, qry = 'input, textarea, output') {\r\n\t\tconst root = GSDOM.unwrap(owner);\r\n\t\trequestAnimationFrame(() => {\r\n\t\t\troot.querySelectorAll(qry).forEach((el) => el.value = '');\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Get proper value from element\r\n\t * @param {HTMLElement} el \r\n\t * @param {Boolean} defaults Set default value for form reset \r\n\t * @returns {String|Number}\r\n\t */\r\n\tstatic getValue(el, defaults = false) {\r\n\t\tlet val = null;\r\n\t\tswitch (el.type) {\r\n\t\t\tcase 'datetime-local':\r\n\t\t\t\tval = el.value ? el.valueAsNumber : el.value;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'number':\r\n\t\t\t\tval = el.value ? el.valueAsNumber : 0;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'select-multiple':\r\n\t\t\t\tval = Array.from(el.selectedOptions).map(o => o.value);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'checkbox':\r\n\t\t\t\tif (GSUtil.isStringNonEmpty(el.value)) {\r\n\t\t\t\t\tval = el.checked ? el.value : null;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tval = el.checked;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tval = el.value;\r\n\t\t}\r\n\r\n\t\tif (GSUtil.isNull(val) && defaults) {\r\n\t\t\tval = el.defaultValue;\r\n\t\t}\r\n\t\treturn val;\r\n\t}\r\n\r\n\t/**\r\n\t * Get value from form element\r\n\t * @param {HTMLElement} el \r\n\t * @param {Boolean} defaults Set default value for form reset \r\n\t * @returns {String}\r\n\t */\r\n\tstatic toValue(el, defaults = false) {\r\n\t\tif (!GSDOM.isHTMLElement(el)) return undefined;\r\n\t\tlet value = GSDOM.getValue(el, defaults);\r\n\t\tif ('text' === el.type) {\r\n\t\t\tconst map = GSCSSMap.styleValue(el, 'text-transform');\r\n\t\t\tif (map) value = GSUtil.textTransform(map.value, value);\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\t/**\r\n\t * Set element value, taking chekbox into consideration\r\n\t * @param {HTMLElement} el \r\n\t * @param {String|Boolean|Number} val \r\n\t * @param {Boolean} defaults Set default value for form reset\r\n\t */\r\n\tstatic fromValue(el, val, defaults = false) {\r\n\t\tif (!GSDOM.isHTMLElement(el)) return;\r\n\t\tconst data = Array.isArray(val) ? val[0] || '' : val;\r\n\r\n\t\tswitch (el.type) {\r\n\t\t\tcase 'checkbox':\r\n\t\t\t\tif (GSUtil.isStringNonEmpty(el.value)) {\r\n\t\t\t\t\tel.checked = data === el.value;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tel.checked = data == true;\r\n\t\t\t\t}\r\n\t\t\t\tif (defaults) el.defaultValue = el.checked;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tel.value = GSUtil.normalize(data);\r\n\t\t\t\tif (defaults) el.defaultValue = el.value;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Convert form elements into JSON object\r\n\t * @param {HTMLElement} owner \r\n\t * @param {String} qry \r\n\t * @param {Boolean} invalid Should include invalid fields\r\n\t * @param {Boolean} defaults Set default value for form reset\r\n\t * @returns {Object}\r\n\t */\r\n\tstatic toObject(owner, qry = 'input, textarea, select, output', invalid = true, defaults = false) {\r\n\t\tconst root = GSDOM.unwrap(owner);\r\n\t\tconst params = {};\r\n\t\tGSDOM.queryAll(root, qry)\r\n\t\t\t.filter(el => el.name)\r\n\t\t\t.filter(el => el.dataset.ignore !== 'true')\r\n\t\t\t.filter(el => invalid ? true : el.checkValidity())\r\n\t\t\t.forEach(el => GSDOM.fromElement2Object(el, params, defaults));\r\n\t\treturn params;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON Object into HTMLElements (input)\r\n\t * @param {HTMLElement} owner Root selector (form)\r\n\t * @param {Object} obj Data source key/value pairs\r\n\t * @param {String} qry Element type selector,defaults to form elements \r\n\t * @param {Boolean} defaults Set default value for form reset  \r\n\t * @returns {Object}\r\n\t */\r\n\tstatic fromObject(owner, obj, qry = 'input, textarea, select, output', defaults = false) {\r\n\t\tobj = GSUtil.toJson(obj);\r\n\t\t// if (Object.entries(obj).length === 0) return;\r\n\t\tconst root = GSDOM.unwrap(owner);\r\n\t\tconst list = GSDOM.queryAll(root, qry); // root.querySelectorAll(qry);\r\n\t\tArray.from(list).forEach(el => GSDOM.fromObject2Element(el, obj, defaults));\r\n\t\treturn obj;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON Object into HTMLElement (input)\r\n\t * @param {HTMLElement} owner Element to populate\r\n\t * @param {Object} obj Data source key/value pairs\r\n\t * @param {Boolean} defaults Set default value for form reset\r\n\t */\r\n\tstatic fromObject2Element(el, obj, defaults = false) {\r\n\t\tif (!GSData.objectPathExist(obj, el?.name)) return;\r\n\t\tconst val = GSData.readFromObject(obj, el.name);\r\n\t\tif (el.type !== 'radio') {\r\n\t\t\tGSDOM.fromValue(el, val, defaults);\r\n\t\t} else if (el.value === val) el.checked = true;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert HTMLElement (input) value to JSON Object  \r\n\t * @param {HTMLElement} owner Element value source\r\n\t * @param {Object} obj Object to populate \r\n\t * @param {Boolean} defaults Set default value for form reset\r\n\t */\r\n\tstatic fromElement2Object(el, obj, defaults = false, noEmpty = false) {\r\n\t\tif (el?.name) {\r\n\t\t\tif (noEmpty && GSUtil.isStringEmpty(el.value)) return obj;\r\n\t\t\tif (el.type !== 'radio') {\r\n\t\t\t\t//params[el.name] = GSDOM.toValue(el);\r\n\t\t\t\tGSData.writeToObject(obj, el.name, GSDOM.toValue(el, defaults));\r\n\t\t\t} else if (el.checked) {\r\n\t\t\t\t//params[el.name] = GSDOM.toValue(el);\r\n\t\t\t\tGSData.writeToObject(obj, el.name, GSDOM.toValue(el, defaults));\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconsole.warn('Skipping element, name not defined!', el);\r\n\t\t}\r\n\t\treturn obj;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert HTMLElement into a JSON object\r\n\t * @param {HTMLElement|Array} own \r\n\t * @param {Boolean} recursive \r\n\t * @param {Boolean} plain  If false, will include #tagName\r\n\t * @param {Object} definitions Json data type definitions\t\r\n\t * @returns {Object}\r\n\t */\r\n\tstatic toJson(own, recursive = true, plain = false, definitions) {\r\n\t\tif (Array.isArray(own)) return own.map(o => GSDOM.toJson(o, recursive, plain, definitions));\r\n\t\tconst obj = {};\r\n\t\tif (!GSDOM.isHTMLElement(own)) return obj;\r\n\r\n\t\tif (!plain) obj['#tagName'] = own.tagName.toLowerCase();\r\n\t\tobj['$text'] = own.innerText;\r\n\r\n\t\t//obj.dataset = Object.assign({}, own.dataset);\r\n\r\n\t\tconst props = definitions || GSDOM.allProperties(own);\r\n\t\tArray.from(own.attributes).forEach(v => {\r\n\t\t\tconst type = props[v.name]?.type;\r\n\t\t\tswitch (type) {\r\n\t\t\t\tcase Boolean:\r\n\t\t\t\t\tobj[v.name] = own.hasAttribute(v.name);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Number:\r\n\t\t\t\t\tobj[v.name] = GSAttr.getAsNum(own, v.name);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tobj[v.name] = v.value;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (recursive) {\r\n\t\t\tconst children = Array.from(own.children).map(el => GSDOM.toJson(el, recursive, plain, definitions));\r\n\t\t\tif (children.length > 0) obj.items = children;\r\n\t\t}\r\n\r\n\t\treturn obj;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON object to DOM/html\r\n\t * @param {Object} obj \r\n\t * @param {Boolean} asString As string or HTMLElement Tree \r\n\t * @param {String} tag \r\n\t */\r\n\tstatic fromJson(obj, tag = 'gs-item', asString = false) {\r\n\t\treturn asString ? GSDOM.fromJsonAsString(obj, tag) : GSDOM.fromJsonAsDOM(obj, tag);\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON object to DOM tree\r\n\t * @param {Object} obj \r\n\t * @param {String} tag \r\n\t * @returns {HTMLElement|Array}\r\n\t */\r\n\tstatic fromJsonAsDOM(obj, tag = 'gs-item') {\r\n\t\tif (!obj) return null;\r\n\r\n\t\tconst isPrimitive = GSUtil.isNumber(obj) || GSUtil.isString(obj);\r\n\t\tif (isPrimitive) return GSDOM.fromJsonAsDOM({ title: obj }, tag);\r\n\r\n\t\tconst isArray = Array.isArray(obj);\r\n\t\tif (isArray) return obj.map(o => GSDOM.fromJsonAsDOM(o, tag));\r\n\r\n\t\tconst name = obj['#tagName'] || tag;\r\n\t\tconst el = document.createElement(name);\r\n\r\n\t\tObject.keys(obj)\r\n\t\t\t.filter(v => v != 'items')\r\n\t\t\t.filter(v => v[0] != '#')\r\n\t\t\t.filter(v => v[0] != '$')\r\n\t\t\t.forEach(v => el.setAttribute(v, obj[v]));\r\n\r\n\t\tif (obj[\"#def\"]) {\r\n\t\t\tel[DEF] = obj[\"#def\"];\r\n\t\t}\r\n\r\n\t\tif (Array.isArray(obj.items)) {\r\n\t\t\tobj.items.forEach(o => {\r\n\t\t\t\tconst sub = GSDOM.fromJsonAsDOM(o, tag);\r\n\t\t\t\tel.appendChild(sub);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn el;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON object to HTML source\r\n\t * @param {Object} obj \r\n\t * @param {String} tag \r\n\t * @returns {String}\r\n\t */\r\n\tstatic fromJsonAsString(obj, tag = 'gs-item') {\r\n\t\tif (!obj) return null;\r\n\r\n\t\tif (Array.isArray(obj)) return obj.map(o => GSDOM.fromJsonAsString(o)).join('');\r\n\r\n\t\tconst name = obj['#tagName'] || tag;\r\n\t\tconst src = [];\r\n\t\tsrc.push(`<${name} `);\r\n\r\n\t\tObject.keys(obj)\r\n\t\t\t.filter(v => v != 'items')\r\n\t\t\t.filter(v => v[0] != '#')\r\n\t\t\t.filter(v => v[0] != '$')\r\n\t\t\t.forEach(v => src.push(` ${v}=\"${obj[v]}\" `));\r\n\r\n\t\tsrc.push(`>`);\r\n\r\n\t\tif (Array.isArray(obj.items)) {\r\n\t\t\tobj.items.forEach(o => {\r\n\t\t\t\tconst sub = GSDOM.fromJsonAsString(o, tag);\r\n\t\t\t\tsrc.push(sub);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tsrc.push(`</${name}>`);\r\n\r\n\t\treturn src.join('');\r\n\t}\r\n\r\n\t/**\r\n\t * Convert URL hash key/value to form elements\r\n\t * @param {HTMLElement} owner \r\n\t */\r\n\tstatic fromURLHashToForm(owner) {\r\n\t\tlocation.hash.slice(1).split('&')\r\n\t\t\t.filter(v => v.length > 1)\r\n\t\t\t.forEach(v => {\r\n\t\t\t\tconst d = v.split('=');\r\n\t\t\t\tGSDOM.setValue(`input[name=${d[0]}]`, d[1], owner);\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Return element shadowRoot or self\r\n\t * @param {HTMLElement} owner \r\n\t * @returns {HTMLElement|shadowRoot}\r\n\t */\r\n\tstatic unwrap(owner) {\r\n\t\treturn owner ? owner.self || owner : document;\r\n\t}\r\n\r\n\tstatic #filter(own, qry = '', group = '') {\r\n\t\tgroup = GSUtil.capitalizeAttr(group);\r\n\t\treturn GSDOM.queryAll(own, qry).filter(el => group ? GSUtil.asBool(el.dataset[group]) : true) ;\r\n\t}\r\n\r\n\t/**\r\n\t * Enable input on all input elements under provided owner\r\n\t * @param {HTMLElement} own \r\n\t * @param {String} qry Default to form\r\n\t * @param {String} group Filter specific group if defined\r\n\t */\r\n\tstatic enableInput(own, qry = 'input, select, textarea, button, .btn', group) {\r\n\t\tGSDOM.#filter(own, qry, group).forEach(el => el.removeAttribute('disabled'));\r\n\t}\r\n\r\n\t/**\r\n\t * Disable input on all input elements under provided owner\r\n\t * @param {HTMLElement} own \r\n\t * @param {String} qry Default to form\r\n\t * @param {String} group Filter specific group if defined\r\n\t */\r\n\tstatic disableInput(own, qry = 'input, select, textarea, button, .btn', group) {\r\n\t\tGSDOM.#filter(own, qry, group).forEach(el => el.setAttribute('disabled', ''));\r\n\t}\r\n\r\n\t/**\r\n\t * Set value to a element by css selector\r\n\t * @param {String} qry \r\n\t * @param {String} val \r\n\t * @param {HTMLElement} own\r\n\t * @param {Boolean} defaults Set default value for form reset \r\n\t */\r\n\tstatic setValue(qry, val, own, defaults = false) {\r\n\t\tconst el = GSDOM.queryAll(own, qry);\r\n\t\tel.forEach(it => GSDOM.fromValue(it, val, defaults));\r\n\t}\r\n\r\n\t/**\r\n\t * Find text nodes\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Array<string>}\r\n\t */\r\n\tstatic textNodesUnder(el) {\r\n\t\tconst walk = document.createTreeWalker(el || document, NodeFilter.SHOW_TEXT, null, false);\r\n\t\tconst a = [];\r\n\t\tlet n;\r\n\t\twhile (n = walk.nextNode()) a.push(n);\r\n\t\treturn a;\r\n\t}\r\n\r\n\t/**\r\n\t * Remove invalid text characters from html element nodes\r\n\t * @param {HTMLElement} root \r\n\t */\r\n\tstatic cleanHTML(root) {\r\n\t\tconst ts = GSDOM.textNodesUnder(root || document).filter(t => t.wholeText.trim().length === 0);\r\n\t\tts.filter(el => el.nextSibling instanceof Text).forEach(el => el.remove());\r\n\t\tts.forEach(t => t.nodeValue = t.wholeText.replaceAll(/\\u0020{4}/g, '\\t').replaceAll(GSDOM.#CLEANUP1, ''));\r\n\t}\r\n\r\n\t/**\r\n\t * Validate against provided list, if child elements allowed inside provided element\r\n\t * @param {HTMLElement} el Element which child list to validate\r\n\t * @param {String} tagName Expected owner element tag name\r\n\t * @param {String} whiteList Uppercase list of tag names allowed as child\r\n\t * @param {String} slotList List of named slots allowed\r\n\t * @param {Boolean} asState return state as bool or throw an error (default)\r\n\t * @returns {Boolean} return true if validation is ok.\r\n\t * @throws {Error}\r\n\t */\r\n\tstatic validate(own, tagName, whiteList, asState = false) {\r\n\t\tif (own.tagName !== tagName) {\r\n\t\t\tif (asState) return false;\r\n\t\t\tthrow new Error(`Owner element : ${own.tagName}, id:${own.id} is not of excpected type: ${tagName}`);\r\n\t\t}\r\n\t\tconst ok = GSDOM.isAllowed(Array.from(own.childNodes), whiteList);\r\n\t\tif (ok) return true;\r\n\t\tif (asState) return false;\r\n\t\tconst msg = GSDOM.toValidationError(own, whiteList);\r\n\t\tthrow new Error(msg);\r\n\t}\r\n\r\n\t/**\r\n\t * Check against provided list, if child elements allowed inside provided element\r\n\t * @param {HTMLElement|Array<HTMLElement>} el Element which childs to validate against provided list\r\n\t * @param {String} whiteList Uppercase list of tag names allowed as child nodes\r\n\t * @param {String} slotList List of elements with named  slots allowed\r\n\t * @returns {Boolean} return tr ue if validation is ok.\r\n\t */\r\n\tstatic isAllowed(el, whiteList) {\r\n\t\tif (Array.isArray(el)) return el.filter(el => GSDOM.isAllowed(el, whiteList)).length === 0;\r\n\t\tconst allowElement = !(el instanceof Text || el instanceof Comment);\r\n\t\tconst allowTag = !whiteList.includes(el.tagName);\r\n\t\treturn allowElement && allowTag;\r\n\t}\r\n\r\n\tstatic toValidationError(own, whiteList) {\r\n\t\tconst list = `<${whiteList.join('>, <')}>`;\r\n\t\treturn `${own.tagName} ID: ${own.id} allows as a child nodes only : ${list}!`;\r\n\t}\r\n\r\n\t/**\r\n\t * Inject css directly into a shadowRoot of an element\r\n\t * \r\n\t * @async\r\n\t * @param {HTMLElement} own \r\n\t * @param {String} url \r\n\t * @returns {Promise<boolean>}\r\n\t */\r\n\tstatic async injectCSS(own, url) {\r\n\t\tif (!own?.shadowRoot instanceof ShadowRoot) return false;\r\n\t\tlet sts = true;\r\n\t\ttry {\r\n\t\t\tconst res = await fetch(url);\r\n\t\t\tif (!res.ok) return;\r\n\t\t\tconst css = await res.text();\r\n\t\t\tconst sheet = new CSSStyleSheet();\r\n\t\t\tsheet.replaceSync(css);\r\n\t\t\town.shadowRoot.adoptedStyleSheets = [sheet];\r\n\t\t} catch (e) {\r\n\t\t\tGSLog.error(null, e);\r\n\t\t\tsts = false;\r\n\t\t}\r\n\t\treturn sts;\r\n\t}\r\n\r\n\t/**\r\n\t * Reset form element\r\n\t * @param {*} element \r\n\t * @returns \r\n\t */\r\n\tstatic reset(element) {\r\n\t\tif (GSDOM.isFormElement(element)) {\r\n\t\t\tif (!GSDOM.resetSelect(element)) {\r\n\t\t\t\telement.dataset.typed = false;\r\n\t\t\t\telement.value = element.defaultValue;\r\n\t\t\t\t//GSDOM.#dispatch(element);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Reset select element to default value\r\n\t * @param {HTMLSelectElement} element \r\n\t */\r\n\tstatic resetSelect(element) {\r\n\t\tif (GSDOM.isSelect(element)) {\r\n\t\t\tArray.from(element.options).forEach(el => el.selected = el.hasAttribute('selected'));\r\n\t\t\t//GSDOM.#dispatch(element);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic #dispatch(element) {\r\n\t\telement.dispatchEvent(new Event('change', { bubbles: true, composed: true }));\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Extract and merge all static properties definition from WebComponent instance\r\n\t * @param {GSElement} obj \r\n\t * @returns {Object}\r\n\t */\r\n\tstatic allProperties(obj) {\r\n\t\tconst list = [...GSDOM.inheritance(obj)].map(o => o.properties).filter(o => o);\r\n\t\tlist.push(obj.constructor?.properties || obj.properties);\r\n\t\treturn GSData.mergeObjects(list);\r\n\t}\r\n\r\n\t/**\r\n\t * Return element template ref\r\n\t * @param {GSElement} host \r\n\t * @returns \r\n\t */\r\n\tstatic templateRef(host) {\r\n\t\tif (!host) return;\r\n\t\tif (host.tagName === 'GS-TEMPLATE') return host.src;\r\n\t\treturn host.template || host.query?.('template', false);\r\n\t}\r\n\r\n\tstatic #globalDispatch(name, opt) {\r\n\t\tqueueMicrotask(() => {\r\n\t\t\tglobalThis.dispatchEvent?.(new CustomEvent(name, opt));\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Register class as WebComponent to the browser\r\n\t * @param {String} name \r\n\t * @param {class} clazz Optional, if not set, use self\r\n\t * @param {Object} opt Options, used only when extending non HTMLElement class  \r\n\t */\r\n\tstatic define(name, clazz, opt) {\r\n\t\tif (!customElements.get(name)) {\r\n\t\t\tcustomElements.define(name, clazz, opt);\r\n\t\t\tGSDOM.#globalDispatch(name, { detail: { customElements: true } });\r\n\t\t}\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.seal(GSDOM);\r\n\t\tglobalThis.GSDOM = GSDOM;\r\n\t\tGSDOM.#globalDispatch('gs-base-ready', {\r\n\t\t\tdetail: {\r\n\t\t\t\tmessage: 'GS Base is ready',\r\n\t\t\t\ttime: new Date(),\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\n\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSEvents class\r\n * @module base/GSEvents\r\n */\r\n\r\nimport { EVENTID } from './GSConst.mjs';\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSID } from \"./GSID.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSLog } from \"./GSLog.mjs\";\r\n\r\n/**\r\n * Class for handling events, also a registry of all GS-* element listeners\r\n * @Class\r\n */\r\nexport class GSEvents {\r\n\r\n\tstatic #rid = 0;\r\n\tstatic #protect = false;\r\n\tstatic #cache = new Map();\r\n\r\n\tstatic #loaded = false;\r\n\tstatic #suspended = 0; // Corrected typo\r\n\r\n\tget altContext() {\r\n\t\treturn GSEvents.#protect;\r\n\t}\r\n\r\n\tset altContext(val) {\r\n\t\tGSEvents.#protect = GSUtil.asBool(val, true);\r\n\t}\r\n\r\n\t/**\r\n\t * Disable browser console and default context menu\r\n\t */\r\n\tstatic protect() {\r\n\t\tGSEvents.listen(globalThis, null, 'contextmenu', GSEvents.#onContext);\r\n\t\tGSEvents.listen(globalThis.document, null, 'keydown', GSEvents.#onKeyDown);\r\n\t}\r\n\r\n\tstatic #onContext(event) {\r\n\t\tif (GSEvents.#protect || !event.shiftKey) GSEvents.prevent(event);\r\n\t}\r\n\r\n\tstatic #onKeyDown(event) {\r\n\t\tconst code = event.code;\r\n\t\tif (code == 'F12') { // Prevent F12\r\n\t\t\treturn false;\r\n\t\t} else if (event.ctrlKey && event.shiftKey && code == 'KeyI') { // Prevent Ctrl+Shift+I\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Wait for web page to completely load, then send event to target element\r\n\t * DOMContentLoaded vs load ?!\r\n\t * @async\r\n\t * @param {HTMLElement} target \r\n\t * @param {String} name \r\n\t * @param {function} callback \r\n\t * @param {Promise<number>} timeout \r\n\t */\r\n\tstatic async waitPageLoad(target, name = 'loaded', callback, timeout = 0, prevent = true) {\r\n\t\tif (!GSEvents.#loaded) {\r\n\t\t\ttry {\r\n\t\t\t\tawait GSEvents.wait(globalThis.window, 'load', timeout, prevent);\r\n\t\t\t\tGSEvents.#loaded = true;\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error('Error waiting for page load:', e); // Improved error handling\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (GSEvents.#loaded) {\r\n\t\t\tawait GSFunction.callFunction(callback);\r\n\t\t\tGSEvents.sendSuspended(target, name);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Async version of event listener\r\n\t * \r\n\t * @async\r\n\t * @param {HTMLElement} own \r\n\t * @param {String} name \r\n\t * @param {Number} timeout  \r\n\t * @param {Boolean} prevent \r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic wait(own, name = '', timeout = 0, prevent = true) {\r\n\t\tif (GSUtil.isStringEmpty(name)) throw new Error('Event undefined!');\r\n\t\tif (!GSUtil.isNumber(timeout)) throw new Error('Invalid timeout value!');\r\n\t\tif (timeout > 0) return GSEvents.once(own, null, name, null, timeout);\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tGSEvents.once(own, null, name, e => {\r\n\t\t\t\tif (prevent) GSEvents.prevent(e);\r\n\t\t\t\tresolve(e);\r\n\t\t\t}, timeout);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Async version of animation frame\r\n\t * \r\n\t * @async\r\n\t * @param {function} callback \r\n\t * @param {Boolean} chaind Prevent consequtive chained calls.\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic async waitAnimationFrame(callback, chained = false) {\r\n\r\n\t\tif (chained) {\r\n\t\t\tif (typeof callback !== 'function') return;\r\n\t\t\tif (GSEvents.#suspended > 0) return GSFunction.callFunction(callback);\r\n\t\t\tGSEvents.#suspended++;\r\n\t\t}\r\n\r\n\t\treturn new Promise((accept, reject) => {\r\n\t\t\trequestAnimationFrame(async () => {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst o = await GSFunction.callFunction(callback);\r\n\t\t\t\t\taccept(o);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\treject(e);\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tif (chained && GSEvents.#suspended > 0) GSEvents.#suspended--;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Listen for an event on a given element or query\r\n\t * @param {*} own \r\n\t * @param {*} qry \r\n\t * @param {*} event \r\n\t * @param {*} callback \r\n\t * @param {*} opt \r\n\t * @returns {boolean|Array<boolean>} \r\n\t */\r\n\tstatic listen(own, qry, event, callback, opt = false) {\r\n\t\tif (!qry && own) return own.addEventListener(event, callback, opt);\r\n\t\treturn GSDOM.queryAll(own, qry).map(el => el.addEventListener(event, callback, opt));\r\n\t}\r\n\r\n\t/**\r\n\t * Unlisten for an event on a given element or query\r\n\t * @param {*} own \r\n\t * @param {*} qry \r\n\t * @param {*} event \r\n\t * @param {*} callback \r\n\t * @returns {boolean|Array<boolean>} \r\n\t */\r\n\tstatic unlisten(own, qry, event, callback) {\r\n\t\tif (!qry && own) return own.removeEventListener(event, callback);\r\n\t\treturn GSDOM.queryAll(own, qry).map(el => el.removeEventListener(event, callback));\r\n\t}\r\n\r\n\tstatic on = GSEvents.listen;\r\n\tstatic off = GSEvents.unlisten;\r\n\r\n\t/**\r\n\t * Wait for an event. Also, trigger on timeout if event not triggered.\r\n\t * @param {HTMLElement} own \r\n\t * @param {String} qry Optional selector within owner\r\n\t * @param {String} event Event name to wait for\r\n\t * @param {*} callback Function to call \r\n\t * @param {Number | AbortSignal} timeout If GT 0, retrun Promise\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic once(own, qry, event, callback, timeout = 0) {\r\n\t\tconst signal = GSEvents.#toSignal(timeout);\r\n\t\tif (signal && signal.internal) {\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tGSEvents.listen(own, qry, event, evt => {\r\n\t\t\t\t\tsignal.removeEventListener('abort', reject);\r\n\t\t\t\t\tcallback?.(evt);\r\n\t\t\t\t\tresolve(evt);\r\n\t\t\t\t}, { once: true, signal: signal });\r\n\t\t\t\tsignal.addEventListener('abort', reject);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn GSEvents.listen(own, qry, event, callback, { once: true, signal: signal });\r\n\t}\r\n\r\n\t/**\r\n\t * Generic prevent event\r\n\t *  default - prevent system default event handling\r\n\t *  propagation - prevent all bubbling\r\n\t *  immedate - prevent all bubbling + this element \r\n\t * \r\n\t * @param {Event} e \r\n\t */\r\n\tstatic prevent(e, defaults = true, propagate = true, immediate = true) {\r\n\t\tif (e) {\r\n\t\t\tif (defaults) e.preventDefault?.();\r\n\t\t\tif (propagate) e.stopPropagation?.();\r\n\t\t\tif (immediate) e.stopImmediatePropagation?.();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Generic event disaptcher.\r\n\t * NOTE: If expecting to catch return value, do not use async in listeners\r\n\t * \r\n\t * @param {HTMLElement} sender element that send event\r\n\t * @param {String} name  Event name to trigger \r\n\t * @param {Object} obj Data object to send \r\n\t * @param {Boolean} bubbles Send event to parent\r\n\t * @param {Boolean} composed Send event across shadowDom\r\n\t * @param {Boolean} cancelable Event is cancelable\r\n\t * @returns {Boolean} false if event is cancelable, and at least one of the event handlers which received event called Event.preventDefault(). Otherwise true.\r\n\t */\r\n\tstatic send(sender = document, name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n\t\tif (!GSUtil.isString(name) || name.length === 0) return false;\r\n\t\tconst opt = { detail: obj, bubbles: bubbles, composed: composed, cancelable: cancelable };\r\n\t\tconst event = new CustomEvent(name, opt);\r\n\t\treturn sender?.dispatchEvent(event);\r\n\t}\r\n\r\n\t/**\r\n\t * Redispatch event to target, preventing original event handling\r\n\t * @param {HTMLElement} target\r\n\t * @param {Event} e \r\n\t */\r\n\tstatic redispatch(target, e) {\r\n\t\tGSEvents.prevent(e, true, true, true);\r\n    \tGSEvents.send(target, e.type, e.detail, e.bubbles, e.composed, e.cancelable );\r\n\t}\t\r\n\r\n\t/**\r\n\t * Convert event type to native event\r\n\t * @param {String} type \r\n\t * @param {Object} opt \r\n\t * @returns {Event}\r\n\t */\r\n\tstatic toEvent(type, opt) {\r\n\t\tlet evt = null;\r\n\t\tswitch (type) {\r\n\t\t\tcase 'copy':\r\n\t\t\tcase 'cut':\r\n\t\t\tcase 'paste':\r\n\t\t\t\tevt = new ClipboardEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'blur':\r\n\t\t\tcase 'focus':\r\n\t\t\tcase 'focusin':\r\n\t\t\tcase 'focusout':\r\n\t\t\t\tevt = new FocusEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'input':\r\n\t\t\tcase 'beforeinput':\r\n\t\t\t\tevt = new InputEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'keydown':\r\n\t\t\tcase 'keyup':\r\n\t\t\tcase 'keypress':\r\n\t\t\t\tevt = new KeyboardEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'dblclick':\r\n\t\t\tcase 'mousedown':\r\n\t\t\tcase 'mouseenter':\r\n\t\t\tcase 'mouseleave':\r\n\t\t\tcase 'mousemove':\r\n\t\t\tcase 'mouseout':\r\n\t\t\tcase 'mouseover':\r\n\t\t\tcase 'mouseup':\r\n\t\t\t\tevt = new MouseEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'submit':\r\n\t\t\t\tevt = new SubmitEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'touchstart':\r\n\t\t\tcase 'touchend':\r\n\t\t\tcase 'touchmove':\r\n\t\t\tcase 'touchcancel':\r\n\t\t\t\tevt = new TouchEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'whell':\r\n\t\t\t\tevt = new WheelEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'pointerover':\r\n\t\t\tcase 'pointerenter':\r\n\t\t\tcase 'pointerdown':\r\n\t\t\tcase 'pointermove':\r\n\t\t\tcase 'pointerup':\r\n\t\t\tcase 'pointercancel':\r\n\t\t\tcase 'pointerout':\r\n\t\t\tcase 'pointerleave':\r\n\t\t\tcase 'pointerrawupdate':\r\n\t\t\tcase 'gotpointercapture':\r\n\t\t\tcase 'lostpointercapture':\r\n\t\t\t\tevt = new PointerEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tevt = new CustomEvent(type, opt);\r\n\t\t}\r\n\t\treturn evt;\r\n\t}\r\n\r\n\t/**\r\n\t * Helper to fix some Firefox issues, detect event\r\n\t * @param {Event} e \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isMouseOrPointerEvent(e) {\r\n\t\treturn e instanceof MouseEvent || e instanceof PointerEvent;\r\n\t}\r\n\r\n\t/** \r\n\t * Generic event disaptcher in suspended rendering\r\n\t * \r\n\t * @param {HTMLElement} sender element that send event\r\n\t * @param {String} name  Event name to trigger\r\n\t * @param {Object} obj Data object to send \r\n\t * @param {Boolean} bubbles Send event to parent\r\n\t * @param {Boolean} composed Send event across shadowDom\r\n\t * @param {Boolean} cancelable Event is cancelable\r\n\t * @returns {void} \r\n\t */\r\n\tstatic sendSuspended(sender = document, name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n\t\treturn requestAnimationFrame(() => {\r\n\t\t\tGSEvents.send(sender, name, obj, bubbles, composed, cancelable);\r\n\t\t});\r\n\t}\r\n\r\n\t/** \r\n\t * Generic event disaptcher delayed in miliseconds\r\n\t * \r\n\t * @param {Number} timeout Time to delay event\r\n\t * @param {HTMLElement} sender element that send event\r\n\t * @param {String} name  Event name to trigger\r\n\t * @param {Object} obj Data object to send \r\n\t * @param {Boolean} bubbles Send event to parent\r\n\t * @param {Boolean} composed Send event across shadowDom\r\n\t * @param {Boolean} cancelable Event is cancelable\r\n\t * @returns {Number} setTimeout id for cancelation\r\n\t */\r\n\tstatic sendDelayed(timeout = 1, sender = document, name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n\t\treturn setTimeout(() => GSEvents.send(sender, name, obj, bubbles, composed, cancelable), timeout);\r\n\t}\r\n\r\n\t/**\r\n\t* Generic event listener appender\r\n\t * @param {HTMLElement} own Event owner (used to store event handler for later release by element destruction )\r\n\t * @param {HTMLElement} el Owner element to monitor\r\n\t * @param {String} name Event name to monitor\r\n\t * @param {Function} fn Callback to trigger on event\r\n\t * @param {Boolean} once Monitor event only once\r\n\t * @param {Boolean} capture Allow event capture\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic attach(own, el, name = '', fn, once = false, capture = false) {\r\n\t\tif (!el) return false;\r\n\t\tif (!(window instanceof Window || el.isConnected)) return false;\r\n\t\tif (!GSFunction.isFunction(fn)) return false;\r\n\t\tif (!GSFunction.hasFunction(el, 'addEventListener')) return false;\r\n\t\tconst me = this;\r\n\t\tconst obj = me.#eventKey(own, el, name, fn);\r\n\t\tconst elmap = me.#getElementMap(own);\r\n\t\tconst map = me.#eventMap(elmap, obj.key);\r\n\t\tmap.set(obj.fnkey, obj);\r\n\t\tobj.capture = capture;\r\n\t\tif (once) {\r\n\t\t\tobj.once = (e) => {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tobj.fn(e);\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tme.remove(obj.own, obj.el, obj.name, obj.once);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tObject.defineProperty(obj.once, 'gsid', { value: fn.gsid, writable: false });\r\n\t\t}\r\n\t\tel.addEventListener(name, once ? obj.once : obj.fn, { once: once, capture: capture });\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t* Generic event listener remover\r\n\t * @param {HTMLElement} own Event owner\r\n\t * @param {HTMLElement} el Owner element to monitor\r\n\t * @param {String} name Event name to moinitor\r\n\t * @param {Function} fn Callback to trigger on event\r\n\t */\r\n\tstatic remove(own, el, name = '', fn) {\r\n\t\tconst me = this;\r\n\t\tconst obj = me.#eventKey(own, el, name, fn);\r\n\t\tconst elmap = me.#getElementMap(own);\r\n\t\tconst map = me.#eventMap(elmap, obj.key);\r\n\t\tconst cfg = map.get(obj.fnkey);\r\n\t\tif (cfg) {\r\n\t\t\tmap.delete(cfg.fnkey);\r\n\t\t\tme.#removeListener(cfg);\r\n\t\t} else if (obj.fnkey === obj.key) {\r\n\t\t\tfor (let m of map.values()) {\r\n\t\t\t\tmap.delete(m.fnkey);\r\n\t\t\t\tme.#removeListener(m);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (map.size === 0) elmap.delete(obj.key);\r\n\t\tif (elmap.size === 0) me.#cache.delete(own);\r\n\t}\r\n\r\n\t/**\r\n\t * Release internal engine event listeners\r\n\t * @param {HTMLElement} own Event owner\r\n\t */\r\n\tstatic detachListeners(own) {\r\n\t\tconst me = this;\r\n\t\tconst map = me.#removeElementMap(own);\r\n\t\tif (!map) return;\r\n\r\n\t\tconst it = map.values();\r\n\t\tfor (let m of it) {\r\n\t\t\tfor (let o of m.values()) {\r\n\t\t\t\tme.#removeListener(o);\r\n\t\t\t}\r\n\t\t\tm.clear();\r\n\t\t}\r\n\t\tmap.clear();\r\n\t}\r\n\r\n\t/**\r\n\t * Generate an event key object\r\n\t * @param {*} el \r\n\t * @param {*} name \r\n\t * @param {*} fn \r\n\t * @returns {Object}\r\n\t */\r\n\tstatic #eventKey(own, el, name = '', fn = '') {\r\n\t\tif (!el) return false;\r\n\t\tconst me = this;\r\n\t\tconst elid = me.#getElementID(el);\r\n\t\tconst fnid = me.#getCallbackID(fn);\r\n\t\tconst key = GSID.hashCode(`${elid}${name}`);\r\n\t\tconst fnkey = GSID.hashCode(`${elid}${name}${fnid || ''}`);\r\n\t\treturn { own: own, fn: fn, el: el, name: name, key: key, fnkey: fnkey };\r\n\t}\r\n\r\n\t/**\r\n\t * Get or create a map holding an event map\r\n\t * @param {Map<HTMLElement, Object>} elmap\r\n\t * @param {HTMLElement} key\r\n\t * @returns {Map<HTMLElement, Object>}\r\n\t */\r\n\tstatic #eventMap(elmap, key) {\r\n\t\tconst me = this;\r\n\t\tlet map = elmap.get(key);\r\n\t\tif (!map) {\r\n\t\t\tmap = new Map();\r\n\t\t\telmap.set(key, map);\r\n\t\t}\r\n\t\treturn map;\r\n\t}\r\n\r\n\tstatic #getCallbackID(fn) {\r\n\t\tif (!GSFunction.isFunction(fn)) return null;\r\n\t\tif (!fn.gsid) Object.defineProperty(fn, 'gsid', { value: GSID.next(), writable: false });\r\n\t\treturn fn.gsid;\r\n\t}\r\n\r\n\tstatic #getElementID(el) {\r\n\t\tlet elid = el[EVENTID];\r\n\t\tif (!elid) {\r\n\t\t\telid = GSID.id;\r\n\t\t\tel[EVENTID] = elid;\r\n\t\t}\r\n\t\treturn elid;\r\n\t}\r\n\r\n\t/**\r\n\t * Get or create a map holding an event map\r\n\t * @param {HTMLElement} own\r\n\t * @returns {Map<HTMLElement, Object>}\r\n\t */\r\n\tstatic #getElementMap(own) {\r\n\t\tconst me = this;\r\n\t\treturn me.#eventMap(me.#cache, own);\r\n\t}\r\n\r\n\tstatic #removeElementMap(own) {\r\n\t\tconst me = this;\r\n\t\tconst map = me.#cache.get(own);\r\n\t\tif (!map) return;\r\n\t\tme.#cache.delete(own);\r\n\t\treturn map;\r\n\t}\r\n\r\n\tstatic #removeListener(o) {\r\n\t\to.el.removeEventListener(o.name, o.once ? o.once : o.fn, { capture: o.capture });\r\n\t\to.el = null;\r\n\t\to.fn = null;\r\n\t\to.once = null;\r\n\t}\r\n\r\n\t/**\r\n\t * Internal helper, converter to Abortignal\r\n\t * @param {*} timeout \r\n\t */\r\n\tstatic #toSignal(timeout = 0) {\r\n\t\tif (GSUtil.isNumber(timeout) && timeout > 0) {\r\n\t\t\ttimeout = AbortSignal.timeout(timeout);\r\n\t\t\ttimeout.internal = true;\r\n\t\t\treturn timeout;\r\n\t\t}\r\n\t\tif (timeout instanceof AbortSignal) return timeout;\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\t/**\r\n\t * Monitor GSElement 'action' events and trigger class functions if available.\r\n\t * @param {HTMLElement} owner \r\n\t * @param {String} type \r\n\t */\r\n\tstatic monitorAction(owner, type) {\r\n\t\towner.on('action', (e) => {\r\n\t\t\tconst me = owner;\r\n\t\t\tconst data = e.detail;\r\n\t\t\tconst action = GSUtil.isString(data) ? data : data.action || data.data?.action;\r\n\t\t\tGSEvents.onAction(me, action, type, e);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Trigger class function defined in 'action' attribute\r\n\t * @param {HTMLElement} owner \r\n\t * @param {String} action \r\n\t * @param {String} prefix \r\n\t * @param {Event} evt \r\n\t * @returns {*} Action result or false\r\n\t */\r\n\tstatic async onAction(owner, action, prefix, evt) {\r\n\r\n\t\tconst callback = GSEvents.findAction(owner, action, prefix);\r\n\t\tif (!callback) return;\r\n\r\n\t\tGSEvents.prevent(evt);\r\n\t\tlet sts = false;\r\n\t\ttry {\r\n\t\t\tif (GSFunction.isFunctionAsync(callback)) {\r\n\t\t\t\tsts = await callback(evt);\r\n\t\t\t} else {\r\n\t\t\t\tsts = callback(evt);\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tsts = e;\r\n\t\t\tif (!GSFunction.isFunction(owner.onError)) throw e;\r\n\t\t\towner.onError(e);\r\n\t\t}\r\n\t\treturn sts;\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Find object instance action by name\r\n\t * @param {Object} owner \r\n\t * @param {String} action \r\n\t * @returns {Function}\r\n\t */\r\n\tstatic findAction(owner, action = '', prefix = '') {\r\n\t\tlet sts = false;\r\n\t\tif (!action) return sts;\r\n\t\tconst me = owner;\r\n\t\taction = GSUtil.capitalizeAttr(GSUtil.capitalize(action));\r\n\t\tprefix = GSUtil.capitalizeAttr(GSUtil.capitalize(prefix));\r\n\t\tconst name = `on${prefix}${action}`;\r\n\t\tif (globalThis.GS_LOG_ACTION) GSLog.warn(owner, `Action : ${name}`);\r\n\t\tconst fn = me[name];\r\n\t\tsts = GSFunction.isFunction(fn);\r\n\t\tsts = sts && !GSFunction.isFunctionNative(fn);\r\n\t\treturn sts ? me[name].bind(me) : null\r\n\t}\r\n\r\n\tstatic #onResize() {\r\n\t\tclearTimeout(GSEvents.#rid);\t\t\t\r\n\t\tGSEvents.#rid = setTimeout(async () => {\r\n\t\t\tawait GSEvents.waitAnimationFrame();\r\n\t\t\tGSEvents.send(window, 'resized');\r\n\t\t}, 100);\r\n\t}\r\n\r\n\t/**\r\n\t * Helper tool to notify when window resized. \r\n\t * Can be activated only once.\r\n\t * Trigger 'resized' event on window on resize timeout.\r\n\t */\r\n\tstatic resizeMonitor() {\r\n\t\tconst me = GSEvents;\r\n\t\tconst own = document.documentElement;\r\n\t\tconst obj = me.#eventKey(own, window, 'resize', me.#onResize);\r\n\t\tconst elmap = me.#getElementMap(own);\r\n\t\tconst def = elmap.get(obj.key)?.get(obj.fnkey);\r\n\t\tif (!def) me.attach(own, window, 'resize', me.#onResize);\r\n\t}\r\n\r\n\tstatic {\r\n\t\t//GSEvents.resizeMonitor();\r\n\t\tObject.freeze(GSEvents);\r\n\t\tglobalThis.GSEvents = GSEvents;\r\n\t\tGSEvents.waitPageLoad();\r\n\t}\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\nimport { GSEvents } from \"./GSEvents.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n\r\n/**\r\n * A module loading GSAbortController class\r\n * @module base/GSAbortController\r\n */\r\n\r\n/**\r\n * Extend native AbortController with timeout \r\n * @class\r\n */\r\nexport class GSAbortController extends AbortController {\r\n\r\n    #iid = 0;\r\n\r\n    constructor(timeout = 0) {\r\n        super();\r\n        if (!GSUtil.isNumber(timeout)) throw new Error('Timeout parameter must be number');\r\n        const me = this;\r\n        if (timeout) me.#iid = setTimeout(me.abort.bind(me), timeout);\r\n        me.signal.addEventListener('abort', () => clearInterval(me.#iid));\r\n    }\r\n\r\n    wait(timeout = 0) {\r\n        return GSEvents.wait(this.signal, 'abort', timeout);\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSLog } from \"./GSLog.mjs\";\r\n\r\n/**\r\n * A module loading GSDOMObserver class\r\n * @module base/GSDOMObserver\r\n */\r\n\r\n/**\r\n * Generic HTMLElement node add/remove from DOM tree.\r\n * This Class accepts filter/callback function registration\r\n * as creation of independent observers for each Shadow DOM.\r\n * NOTE: Shadow dom must have independent observers!!!\r\n * Mostly used for dynamic attaching events to the elements not extended with is=\"gs-*\"\r\n * @class\r\n * @extends MutationObserver\r\n */\r\nexport class GSDOMObserver extends MutationObserver {\r\n\r\n    static #filtersAdd = new Map();\r\n    static #filtersDel = new Map();\r\n\r\n    /**\r\n     * Observe element for insertion / deletion\r\n     * @param {HTMLElement} el A HTMLElement instance to observe for child changes\r\n     * @param {Object} opt A JSON configuration object\r\n     * @returns {Boolean} A status of successful observer registration\r\n     */\r\n    observe(el, opt) {\r\n        const cfg = opt || { childList: true, subtree: true };\r\n        return super.observe(el, cfg);\r\n    }\r\n\r\n    /**\r\n     * Create a new observer instance for given root element\r\n     * @param {HTMLElement} el An element to monitor for changes \r\n     * @param {Object} opt A JSON configuration object\r\n     * @returns {GSDOMObserver}\r\n     */\r\n    static create(el, opt) {\r\n        const observer = new GSDOMObserver(GSDOMObserver.#onObserve);\r\n        observer.observe(el, opt);\r\n        return observer;\r\n    }\r\n\r\n    /**\r\n     * Get add or remove filter\r\n     * @param {Boolean} forRemove If \"true\", return injection filter functions, else removal functions\r\n     * @returns {Map<Function, Function>} Returns map of filter functions\r\n     */\r\n    static #getFilter(forRemove = false) {\r\n        return forRemove ? GSDOMObserver.#filtersDel : GSDOMObserver.#filtersAdd;\r\n    }\r\n\r\n    /**\r\n     * Is there any filter registered\r\n     */\r\n    static get #hasFilters() {\r\n        return GSDOMObserver.#hasFiltersAdd || GSDOMObserver.#hasFiltersDel;\r\n    }\r\n\r\n    static get #hasFiltersAdd() {\r\n        return GSDOMObserver.#filtersAdd.size > 0;\r\n    }\r\n\r\n    static get #hasFiltersDel() {\r\n        return GSDOMObserver.#filtersDel.size > 0;\r\n    }\r\n\r\n    /**\r\n     * Observer callback to filter elements\r\n     * @param {*} mutations \r\n     */\r\n    static #onObserve(mutations) {\r\n        if (!GSDOMObserver.#hasFilters) return;\r\n        mutations.forEach((mutation) => {\r\n            if (GSDOMObserver.#hasFiltersAdd) mutation.addedNodes.forEach(el => GSDOMObserver.#walk(el, GSDOMObserver.#filtersAdd));\r\n            if (GSDOMObserver.#hasFiltersDel) mutation.removedNodes.forEach(el => GSDOMObserver.#walk(el, GSDOMObserver.#filtersDel));\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Walk node tree\r\n     * @param {HTMLElement} rootEL node root\r\n     * @param {Map} filters\r\n     * @returns {Boolean} \r\n     */\r\n    static #walk(rootEL, filters) {\r\n        if (filters.size === 0) return false;\r\n        GSDOMObserver.#parse(rootEL, filters);\r\n        rootEL.childNodes.forEach(el => GSDOMObserver.#walk(el, filters));\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Call filter and callback function if node accepted\r\n     * @param {HTMLElement} el node root\r\n     * @param {Map} filters\r\n     * @returns {void}\r\n     */\r\n    static #parse(el, filters) {\r\n        filters.forEach((v, k) => {\r\n            try {\r\n                if (k(el)) v(el);\r\n            } catch (e) {\r\n                GSLog.error(null, e);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Execute observer logic \r\n     * \r\n     * @param {HTMLElement} el node root\r\n     * @param {Function} filter function to filter nodes\r\n     * @param {Function} callback function to be called on selected node\r\n     * \r\n     * @returns {Boolean}\r\n     */\r\n    static #exec(el, filter, callback) {\r\n        if (el instanceof HTMLElement == false) return false;\r\n        const tmp = new Map();\r\n        tmp.set(filter, callback);\r\n        return GSDOMObserver.#walk(el, tmp);\r\n    }\r\n\r\n    /**\r\n     * Check if parameter is function\r\n     * @param {function} fn \r\n     * @returns {Boolean} true if parameter is function type\r\n     */\r\n    static #isFunction(fn) {\r\n        return typeof fn === 'function';\r\n    }\r\n\r\n    /**\r\n     * Check if registration functions are valid\r\n     * @param {Function} filter function to filter nodes\r\n     * @param {Function} callback function to be called on selected node\r\n     * @returns {Boolean}\r\n     */\r\n    static #isFunctions(filter, callback) {\r\n        return GSDOMObserver.#isFunction(filter) && GSDOMObserver.#isFunction(callback);\r\n    }\r\n\r\n    /**\r\n     * Register element filter\r\n     * \r\n     * @param {Function} filter - filter function returns true\r\n     * @param {Function} callback - result function\r\n     * @param {Boolean} forRemove - call on node remove or add\r\n     * @param {HTMLElement} target - element to monitor\r\n     * @returns {Boolean} Returns true if filter registered\r\n     */\r\n    static registerFilter(filter, callback, forRemove = false, target) {\r\n\r\n        if (!GSDOMObserver.#isFunctions(filter, callback)) return false;\r\n\r\n        GSDOMObserver.#getFilter(forRemove).set(filter, callback);\r\n\r\n        // initially loaded does not trigger \r\n        if (!forRemove) GSDOMObserver.#exec(target || document.body, filter, callback);\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Unregister element filter\r\n     * \r\n     * @param {Function} fn Filter function\r\n     * @param {Boolean} forRemove Call on node remove or add\r\n     * \r\n     * @returns {Boolean} Returns true if unregistered\r\n     */\r\n    static unregisterFilter(fn, forRemove = false) {\r\n        return GSDOMObserver.#isFunction(fn) ? GSDOMObserver.#getFilter(forRemove).delete(fn) : false;\r\n    }\r\n\r\n    /**\r\n     * Static constructor with default body monitoring\r\n     */\r\n    static {\r\n        Object.freeze(GSDOMObserver);\r\n        globalThis.GSDOMObserver = GSDOMObserver;\r\n        GSDOMObserver.create(document.documentElement);\r\n    }\r\n\r\n}\r\n\r\n\r\n/*\r\nGSDOMObserver.registerFilter((el)=>{ return el.tagName ==='DIV'}, (el) => {\r\n    console.log(el);\r\n});\r\n*/\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSID } from \"./GSID.mjs\";\r\n\r\n/**\r\n * A dynamic CSSStyleSheet used for dynamic programmable changed\r\n * css classes attached to a WebComponent html template elements.\r\n * Programmatically changing dynamic class elements will not reflect \r\n * element style properties.\r\n */\r\nexport class GSDynamicStyle extends CSSStyleSheet {\r\n\r\n    /**\r\n     * Constructor for DynamicStlye\r\n     * @param {String} id Unique name for easier filtering  \r\n     */\r\n    constructor(id = 'dynamic') {\r\n        super();\r\n        this.id = id || GSID.id;\r\n    }\r\n\r\n    /**\r\n     * Convert id to CSS class name .[name] or [name] if raw\r\n     * @param {String} id \r\n     * @param {boolean} raw If true, id is used as is, otherwise prefixed with '.'\r\n     * @returns \r\n     */\r\n    #toName(id = '', raw = false) {\r\n        return raw ? id : `.${id}`;\r\n    }\r\n\r\n\t/**\r\n\t * Remove dynamic element rule\r\n\t * @param {String} id  \r\n     * @param {boolean} raw If true, id is used as is, otherwise prefixed with '.'\r\n\t */\r\n\tdeleteRule(id = '', raw = false) {\r\n        const me = this;\r\n        const name = me.#toName(id, raw);\r\n\t\tArray.from(me.cssRules)\r\n\t\t\t.map((v, i) => v.selectorText === name ? i : -1)\r\n\t\t\t.filter(v => v > -1)\r\n\t\t\t.forEach(v => super.deleteRule(v));\r\n\t}    \r\n\r\n    /**\r\n     * Get individual rule from dynamic styles cache\r\n     * @param {String} id CSS class name\r\n     * @param {boolean} raw If true, id is used as is, otherwise prefixed with '.'\r\n     * @returns {CSSRule} \r\n     */\r\n    getRule(id = '', raw = false) {\r\n        const me = this;\r\n        const name = me.#toName(id, raw);\r\n        return Array.from(me.cssRules).filter(v => v.selectorText === name).pop();\r\n    }\r\n\r\n    /**\r\n     * Set dynamic element rule. Accepts string or json object representation\r\n     * @param {String} id Unique css class name used\r\n     * @param {string|object} style CSS style properties to apply\r\n     * @param {boolean} sync If true, applys rules immediately, otherwise on next animation frame\r\n     * @param {boolean} raw If true, id is used as is, otherwise prefixed with '.'\r\n     */\r\n    setRule(id, style = '', sync = false, raw = false) {\r\n\r\n        const me = this;\r\n\r\n        if (!id) return;\r\n\r\n\t\tlet rule = me.getRule(id, raw);\r\n\t\tif (!rule) {\r\n            const name = me.#toName(id, raw);\r\n\t\t\tme.insertRule(`${name} {}`);\r\n\t\t\treturn me.setRule(id, style, sync, raw);\r\n\t\t}        \r\n\r\n        if (!style) return rule;\r\n\r\n        let data = [];\r\n        if (typeof style === 'string') {\r\n            data = style.replaceAll('\\n', '').split(';').map(v => v.trim().split(':')).filter(v => v.length === 2);\r\n        } else {\r\n            data = Object.entries(style);\r\n        }\r\n\r\n        if (sync) {\r\n            data.forEach(kv => me.#updateRule(rule, kv[0], kv[1]));\r\n        } else {\r\n            requestAnimationFrame(() => {\r\n                data.forEach(kv => me.#updateRule(rule, kv[0], kv[1]));\r\n            });\r\n        }\r\n\r\n        return rule;\r\n    }\r\n\r\n    #updateRule(rule, prop = '', style = '') {\r\n        style = (style || '').toString();\r\n        const isImportant = style.includes('!important');\r\n        style = style.replace('!important', '');\r\n        prop = prop.trim();\r\n        rule.style.setProperty(prop, style, isImportant ? 'important' : '');\r\n    }\r\n\r\n    /**\r\n     * Find element dynamic style attached. \r\n     * Will search for a StyleSheet within element shadow addoptedStyleSheet by element data-sheet property.\r\n     * @param {HTMLElement} source A html element continaing dynamically injected html style\r\n     * @returns {CSSStyleSheet} An instance of dynamic stylesheet containing dynamic rules\r\n     */\r\n\tstatic dynamicStyleSheet(source) {\r\n\t\t// find shadow root (or document)\r\n\t\tconst root = GSDOM.root(source);\r\n        const id = source.dataset.sheet || 'dynamic';\r\n\t\t// find custom; dynamic style\r\n\t\treturn GSDynamicStyle.dynamicStyleSheetByID(root, id);\r\n\t}\r\n\r\n    /**\r\n     * Fnd custom dynamic style\r\n     * @param {Document} root Document or shadowDom\r\n     * @param {String} id Dynamic CSS name\r\n     * @returns {CSSStyleSheet} An instance of dynamic stylesheet containing dynamic rules\r\n     */\r\n    static dynamicStyleSheetByID(root, id) {\r\n\t\treturn root?.adoptedStyleSheets ?  Array.from(root?.adoptedStyleSheets).filter(el => el.id === id).pop() : null;\r\n    }\r\n\r\n\t/**\r\n\t * Find dynamic style & rule for element\r\n\t * @param {HTMLElement} source A html element with dynamic style attached  (with data-gs-class attribute set)\r\n     * @param {boolean} raw If true, id is used as is, otherwise prefixed with '.'\r\n\t * @returns {CSSStyleRule} Instance of dynamic css class \r\n\t */\r\n\tstatic dynamicRule(source, raw = false) {\r\n\t\tconst style = GSDynamicStyle.dynamicStyleSheet(source);\r\n\t\treturn style?.getRule(source.dataset.gsClass, raw);\t\t\r\n\t}\r\n\r\n    /**\r\n     * Fnd custom dynamic rule\r\n     * @param {Document} root Document or shadowDom\r\n     * @param {String} id Dynamic CSS name\r\n     * @param {boolean} raw If true, id is used as is, otherwise prefixed with '.'\r\n     * @returns {CSSStyleRule} Instance of dynamic css class \r\n     */    \r\n    static dynamicRuleByID(root, id, raw = false) {\r\n        const style = GSDynamicStyle.dynamicStyleSheetByID(root, 'dynamic');\r\n        return style?.getRule(id, raw);\r\n    }\r\n\r\n    /**\r\n     * Find element dynamic style\r\n     * @param {HTMLElement} source \r\n     * @param {boolean} raw If true, id is used as is, otherwise prefixed with '.'\r\n     * @returns {CSSStyle} Element dynamic style or default style if dynamic not defined\r\n     */\r\n\tstatic dynamicStyle(source, raw = false) {\r\n\t\tconst rule = GSDynamicStyle.dynamicRule(source, raw);\r\n\t\treturn rule?.style; // || source.style;\r\n\t}\r\n\r\n    /**\r\n     * Find element dynamic style\r\n     * @param {Document} source Document or shadowDOM\r\n     * @param {boolean} raw If true, id is used as is, otherwise prefixed with '.'\r\n     * @returns {CSSStyle} Element dynamic style or default style if dynamic not defined\r\n     */\r\n\tstatic dynamicStyleByID(root, id, raw = false) {\r\n\t\tconst rule = GSDynamicStyle.dynamicRuleByID(root, id, raw);\r\n\t\treturn rule?.style; // || source.style;\r\n\t}\r\n\r\n    /**\r\n     * Apply CSS properties to the element style.\r\n     * Will search for a StyleSheet within element shadow addoptedStyleSheet by element data-gs-class property.\r\n     * @param {HTMLElement} source Element with dynamic style attached (with data-gs-class attribute set)\r\n     * @param {Object} opt A JSON object of css arguments to apply \r\n     * @param {boolean} raw If true, id is used as is, otherwise prefixed with '.'\r\n     * @returns {CSSStyle} A copy of modifid CSSStyle object \r\n     */\r\n\tstatic applyDynamicStyle(source, opt, raw = false) {\r\n        queueMicrotask(() => {\r\n            const style = GSDynamicStyle.dynamicStyle(source, raw);\r\n            return Object.assign(style, opt);\r\n        });\r\n\t}\r\n    \r\n    /**\r\n     * \r\n     * @param {Document || ShadowRoot} root Element with dynamic style attached\r\n     * @param {String} id Dynamic CSS style name\r\n     * @param {Object} opt A JSON object of css arguments to apply \r\n     * @param {boolean} raw If true, id is used as is, otherwise prefixed with '.'\r\n     * @returns {CSSStyle} A copy of modifid CSSStyle object \r\n     */\r\n\tstatic applyDynamicStyleByID(root, id, opt, raw = false) {\r\n        queueMicrotask(() => {\r\n            const style = GSDynamicStyle.dynamicStyleByID(root, id, raw);\r\n            return Object.assign(style, opt);\r\n        });\r\n\t}     \r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSCacheStyles class\r\n * @module head/GSCacheStyles\r\n */\r\n\r\nimport { GSDynamicStyle } from \"./GSDynamicStyle.mjs\";\r\nimport { GSID } from \"./GSID.mjs\";\r\nimport { GSLog } from \"./GSLog.mjs\";\r\n\r\nimport { gsstyles } from \"./style.mjs\";\r\n\r\n/**\r\n * Cache for dynamically loaded styles.\r\n * Used to share styles among GS-* WebComponents\r\n * @class\r\n */\r\nexport class GSCacheStyles {\r\n\r\n\tstatic #store = new Map();\r\n\r\n\t/**\r\n\t * Create a new CSSStyleSheet\r\n\t * @param {String} id Unique ID\r\n\t * @returns {CSSStyleSheet} Created instance\r\n\t */\r\n\tstatic create(id) {\r\n\t\tconst sheet = new GSDynamicStyle(id);\r\n\t\tthis.#store.set(id, sheet);\r\n\t\treturn sheet;\r\n\t}\r\n\r\n\t/**\r\n\t * Store initialized stylesheet under the unique ID\r\n\t * @param {String} id \r\n\t * @param {CSSStyleSheet} style \r\n\t * @returns {CSSStyleSheet} Stored stylesheet\r\n\t */\r\n\tstatic set(id, style) {\r\n\r\n\t\tconst me = this;\r\n\r\n\t\tif (style instanceof CSSStyleSheet) {\r\n\t\t\tme.#store.set(id, style);\r\n\t\t}\r\n\r\n\t\tif (style && typeof style === 'string') {\r\n\t\t\tconst sheet = GSCacheStyles.create(id);\r\n\t\t\tsheet.replaceSync(style);\r\n\t\t}\r\n\r\n\t\treturn me.get(id);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Remove stylesheet by unique ID\r\n\t * @param {String} id \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic remove(id) {\r\n\t\treturn this.#store.delete(id);\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve stylesheet by unique ID\r\n\t * @param {String} id \r\n\t * @returns {CSSStyleSheet}\r\n\t */\r\n\tstatic get(id) {\r\n\t\treturn this.#store.get(id);\r\n\t}\r\n\r\n\t/**\r\n\t * Get list of dynamic styles\r\n\t * @returns {CSSStyleSheet}\r\n\t */\r\n\tstatic get dynamic() {\r\n\r\n\t\tconst me = GSCacheStyles;\r\n\t\tconst id = 'gs-dynamic';\r\n\t\t\r\n\t\tlet sheet = me.get(id);\r\n\t\tif (!sheet) {\r\n\t\t\tsheet = GSCacheStyles.create(id);\r\n\t\t\tdocument.adoptedStyleSheets = GSCacheStyles.styles;\r\n\t\t}\r\n\t\t\r\n\t\treturn sheet;\r\n\t}\r\n\r\n\t/**\r\n\t * Get individual rule from dynamic styles cache\r\n\t * @param {String} id \r\n\t * @returns {CSSRule}\r\n\t */\r\n\tstatic getRule(id = '', raw = false) {\r\n\t\treturn GSCacheStyles.dynamic.getRule(id, raw);\r\n\t}\r\n\r\n\t/**\r\n\t * Set dynamic element rule. Accepts string or json object representation\r\n\t * @param {String} id \r\n\t * @param {string|object} style \r\n\t */\r\n\tstatic setRule(id = '', style = '', sync = false, raw = false) {\r\n\t\treturn GSCacheStyles.dynamic.setRule(id, style, sync, raw);\r\n\t}\r\n\r\n\t/**\r\n\t * Remove dynamic element rule\r\n\t * @param {String} id  \r\n\t */\r\n\tstatic deleteRule(id = '', raw = false) {\r\n\t\tGSCacheStyles.dynamic.deleteRule(id, raw);\r\n\t}\r\n\r\n\t/**\r\n\t * Return list of registered style sheets\r\n\t * @returns {Array<CSSStyleSheet>}\r\n\t */\r\n\tstatic get styles() {\r\n\t\treturn Array.from(new Map([...GSCacheStyles.#store].sort((a, b) => String(a[0]).localeCompare(b[0]))).values());\r\n\t}\r\n\r\n\t/**\r\n\t * Inject CSS used by framework across all shadows\r\n\t * @param {string} css CSS string to inject\r\n\t * @param {number} [hash=0] Optional hash for the style\r\n\t */\r\n\tstatic adopt(css = '', hash = 0) {\r\n\t\tif (!css) return;\r\n\t\ttry {\r\n\t\t\thash = hash || GSID.hashCode(css);\r\n\t\t\tGSCacheStyles.set(hash, css);\r\n\t\t\tdocument.adoptedStyleSheets = GSCacheStyles.styles;\r\n\t\t} catch (e) {\r\n\t\t\tGSLog.error(null, e);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.freeze(GSCacheStyles);\r\n\t\tglobalThis.GSCacheStyles = GSCacheStyles;\r\n\t\tGSCacheStyles.adopt(gsstyles);\r\n\t}\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\nimport { GSDOM } from './GSDOM.mjs';\r\nimport { GSEvents } from './GSEvents.mjs';\r\nimport { GSDOMObserver } from './GSDOMObserver.mjs';\r\nimport { GSCacheStyles } from './GSCacheStyles.mjs';\r\n\r\nconst adoptedId = Symbol();\r\nconst observer = Symbol();\r\n\r\n/**\r\n * Monitor HTMLStyleElement & HTMLLinkElement (of type stylesheet) for changes.\r\n * Every such element marked with data-adoptable=\"true\" will be cached and\r\n * will trigger gs-adopted event to notify component controller to update adoptableStyleSheet list\r\n */\r\nexport class GSAdoptedEngine {\r\n\r\n  static timeout = 1000; // Default timeout for adopting stylesheets\r\n  static #timerID = 0;\r\n  static #ID = Date.now();\r\n  static #scheduled = false;\r\n\r\n  static #init() {\r\n    const me = GSAdoptedEngine;\r\n    me.observe(document.head);\r\n    me.#preload();\r\n    me.#timerID = setInterval(() => me.#adopt(), me.timeout);\r\n  }\r\n\r\n  static #clear() {\r\n    const me = GSAdoptedEngine;\r\n    clearInterval(me.#timerID);\r\n    me.#timerID = undefined;\r\n  }\r\n\r\n  static #adopt() {\r\n    const me = GSAdoptedEngine;\r\n    const sheets = me.#adoptable;\r\n    if (sheets.length == 0) return me.#clear();\r\n    sheets.map(s => me.#adoptSheet(s));\r\n    me.update();\r\n  }\r\n\r\n  static update() {\r\n    const me = GSAdoptedEngine;\r\n    if (me.#scheduled) return;\r\n    me.#scheduled = true;\r\n    queueMicrotask(() => {\r\n      requestAnimationFrame(() => {\r\n        try {\r\n          document.adoptedStyleSheets = me.#sorted;\r\n          document.adoptedStyleSheets.id = ++me.#ID;\r\n        } finally {\r\n          me.#scheduled = false;\r\n          globalThis.dispatchEvent(new CustomEvent('gs-adopted'));\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  static #asText(sheet) {\r\n    return Object.values(sheet.cssRules).map(o => o.cssText).join('');\r\n  }\r\n\r\n  static #adoptLink(el) {\r\n    const me = GSAdoptedEngine;\r\n    GSAdoptedEngine.#monitorAttributes(el);\r\n    Array.from(document.styleSheets).filter(s => s.ownerNode === el).map(s => me.#adoptSheet(s));\r\n  }\r\n\r\n  static #adoptSheet(sheet) {\r\n    const me = GSAdoptedEngine;\r\n    const style = me.#asText(sheet);\r\n    return me.#adoptStyle(sheet.ownerNode, style);\r\n  }\r\n\r\n  static #adoptStyle(ownerNode, style) {\r\n    const me = GSAdoptedEngine;\r\n    const sheet = new CSSStyleSheet();\r\n    sheet.replaceSync(style);\r\n    sheet.id = ++me.#ID;\r\n    ownerNode[adoptedId] = sheet.id;\r\n    me.#store(ownerNode, sheet);\r\n    return sheet;\r\n  }\r\n\r\n  static #store(ownerNode, sheet) {\r\n    GSCacheStyles.set(sheet.id, sheet);\r\n  }\r\n\r\n  static #remove(ownerNode, sheet) {\r\n    GSCacheStyles.remove(sheet.id);\r\n    ownerNode[observer]?.disconnect?.();\r\n    ownerNode[observer] = undefined;\r\n  }\r\n\r\n  static get #sorted() {\r\n    return GSCacheStyles.styles;\r\n  }\r\n\r\n  /**\r\n   * List of adoptable styles or links. Filter only those with dataset.adoptable=true\r\n   * @returns {HTMLStyleElement|HTMLLinkElement}\r\n   */\r\n  static get #adoptable() {\r\n    return Object.values(document.styleSheets)\r\n      .filter(o => o.ownerNode)\r\n      .filter(o => o.ownerNode.dataset.adoptable)\r\n      .filter(o => !o.ownerNode[adoptedId]);\r\n  }\r\n\r\n  static #preload() {\r\n    GSDOM.queryAll(document.head, 'link[rel=\"preload\"][as=\"style\"]')\r\n    .forEach(el => {\r\n      el.remove();\r\n      document.head.appendChild(el);\r\n    });\r\n  }\r\n\r\n  static #onAttributeChange(mutationList) {\r\n    mutationList.forEach((mutation) => {\r\n       const id = mutation.target[adoptedId];\r\n       const style = GSCacheStyles.get(id);\r\n       if(style) style.disabled = mutation.target.hasAttribute('disabled');\r\n    });\r\n    GSAdoptedEngine.update();\r\n  }\r\n  \r\n  static #monitorAttributes(element) {\r\n    const me = GSAdoptedEngine;\r\n    const callback = me.#onAttributeChange.bind(me);\r\n    const observer = new MutationObserver(callback);\r\n    observer.observe(element, {\r\n      attributeFilter: [\"disabled\"],\r\n      attributeOldValue: true,\r\n      subtree: false,\r\n    });\r\n    return observer;\r\n  }\r\n  \r\n  /**\r\n   * Filter style and link(css) elements which will be shared\r\n   * with all web components. Filter only those marked with data-adoptable\r\n   * @param {HTMLElement} el \r\n   * @returns {Boolean} Return true if monitored element is selected for further processing\r\n   */\r\n  static #onMonitorFilter(el) {\r\n    return (Boolean(el.dataset?.adoptable))\r\n      && (\r\n        (el instanceof HTMLLinkElement && (el.rel === 'stylesheet' || el.as === \"style\"))\r\n        || el instanceof HTMLStyleElement\r\n      );\r\n  }\r\n\r\n  /**\r\n   * When style added to the HTML page, attach it to the WebComponents\r\n   * @param {HTMLStyleElement|HTMLLinkElement} el \r\n   */\r\n  static #onMonitorConnect(el) {\r\n    const me = GSAdoptedEngine;\r\n    if (el instanceof HTMLStyleElement) {\r\n      me.#adoptStyle(el, el.innerText);\r\n      me.update();\r\n    } else if (el instanceof HTMLLinkElement) {\r\n      GSEvents.wait(el, 'load', 0, false).then(e => {\r\n        if (el.rel === 'preload') return el.rel = \"stylesheet\";\r\n        me.#adoptLink(e.target);\r\n        me.update();\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * When style removed, remove from adoptable and update\r\n   * @param {HTMLElement} el \r\n   */\r\n  static #onMonitorDisconnect(el) {\r\n    const me = GSAdoptedEngine;\r\n    me.#sorted.filter(o => o.id === el[adoptedId])\r\n          .forEach(o => me.#remove(el, o));\r\n    me.update();\r\n  }\r\n\r\n  /**\r\n   * Observe DOM tree for mutations\r\n   * @param {HTMLElement} owner Root element to watch DOM tree from \r\n   */\r\n  static observe(owner) {\r\n    const me = GSAdoptedEngine;\r\n    GSDOMObserver.registerFilter(me.#onMonitorFilter, me.#onMonitorConnect, false, owner);\r\n    GSDOMObserver.registerFilter(me.#onMonitorFilter, me.#onMonitorDisconnect, true, owner);\r\n  }\r\n\r\n  static {\r\n    this.#init();\r\n  }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSLoader class\r\n * @module base/GSLoader\r\n */\r\n\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSLog } from \"./GSLog.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSVersion } from \"./GSVersion.mjs\";\r\n\r\n/**\r\n * A set of static functions used for loading resources\r\n * @class\r\n */\r\nexport class GSLoader {\r\n\r\n    static TEMPLATE_URL = globalThis.GS_TEMPLATE_URL || location.origin;\r\n    static ROUTER_URL = globalThis.GS_ROUTER_URL || location.origin;\r\n\r\n    static NO_CACHE = false;\r\n    static UNIQUE = GSVersion.build;\r\n\r\n    static {\r\n        const rootURL = GSLoader.#defaultURL;\r\n        if (!globalThis.GS_TEMPLATE_URL) {\r\n            GSLoader.TEMPLATE_URL = rootURL;\r\n            globalThis.GS_TEMPLATE_URL = rootURL;\r\n        }\r\n\r\n        if (!globalThis.GS_ROUTER_URL) {\r\n            GSLoader.ROUTER_URL = rootURL;\r\n            globalThis.GS_ROUTER_URL = rootURL;\r\n        }\r\n\r\n        //const hasKey = Object.hasOwn(self, 'GS_NO_CACHE');\r\n        const hasKey = 'GS_NO_CACHE' in self;\r\n        if (hasKey) {\r\n            GSLoader.NO_CACHE = globalThis.GS_NO_CACHE === true;\r\n            if (localStorage) localStorage.setItem('GS_NO_CACHE', GSLoader.NO_CACHE);\r\n        }\r\n        GSLoader.NO_CACHE = localStorage ? localStorage.getItem('GS_NO_CACHE') == 'true' : false;\r\n\r\n    }\r\n\r\n    static get #defaultURL() {\r\n        const url = location.href.split('?').pop();\r\n        const seg = url.split('/');\r\n        return url.endsWith('/') ? url : seg.slice(0, -1).join('/');\r\n    }\r\n\r\n    /**\r\n     * Convert partial URL to a real URL\r\n     * @param {String} url \r\n     * @return {String}\r\n     */\r\n    static normalizeURL(url = '', base = false) {\r\n\r\n        url = url || '';\r\n        let path = null;\r\n        const isFile = location.pathname.split('/').pop(-1).includes('\\.');\r\n        const isExt = url.includes('extension:/');\r\n        const isUrl = url.startsWith('http');\r\n\r\n        if (isUrl || isExt) {\r\n            path = url;\r\n        } else if (url.startsWith('/')) {\r\n            path = `${location.origin}/${url}`;\r\n        } else if (isFile) {\r\n            path = `${location.origin}${location.pathname}/../${url}`;\r\n        } else {\r\n            path = `${location.origin}${location.pathname}/${url}`;\r\n        }\r\n\r\n        path = path.split('://').map(v => v.replaceAll(/\\/{2,}/g, '/')).join('://');\r\n        const uri = new URL(path);\r\n\r\n        // to handle caching\r\n        //if (!base && GSLoader.NO_CACHE) uri.searchParams.append('_dc', Date.now());\r\n        if (!base) {\r\n            const val = GSLoader.NO_CACHE ? Date.now() : GSLoader.UNIQUE;\r\n            uri.searchParams.append('_dc', val);\r\n        }\r\n\r\n        return uri.href;\r\n    }\r\n\r\n    /**\r\n     * Extrach parent path from provided URL string\r\n     * @param {String} url \r\n     * @param {Number} level How many levels to go up the chain\r\n     * @returns {String}\r\n     */\r\n    static parentPath(url = '', level = 1) {\r\n        return (url || '').split('/').slice(0, -1 * level).join('/') + '/';\r\n    }\r\n\r\n    /**\r\n     * Used to load router definition from virtual path\r\n     * \r\n     * @async\r\n     * @param {String} def\r\n     * @return {Promise<string>}\r\n     */\r\n    static async getRouter(def = '') {\r\n\r\n        if (!def) return def;\r\n\r\n        const isRef = def.startsWith('#');\r\n        if (isRef) {\r\n            const el = GSDOM.query(document.documentElement, def);\r\n            return el ? GSUtil.toJson(el.innerHTML) : {};\r\n        }\r\n\r\n        const isHTML = GSUtil.isHTML(def);\r\n        if (isHTML) return def;\r\n\r\n        def = GSLoader.#getRouterURL(def);\r\n        return GSLoader.loadSafe(def, 'GET', null, true);\r\n    }\r\n\r\n    /**\r\n     * Decode template URL into a real URL\r\n     * @param {String} url \r\n     * @return {String}\r\n     */\r\n    static #getRouterURL(url = '') {\r\n        url = url.startsWith('//') ? GSLoader.#routerURL + '/' + url : url;\r\n        return GSLoader.normalizeURL(url);\r\n    }\r\n\r\n    /**\r\n     * Retrieve default template url\r\n     * @return {String}\r\n     */\r\n    static get #routerURL() {\r\n        return GSLoader.normalizeURL(GSLoader.#routerPath, true);\r\n    }\r\n\r\n    /**\r\n     * Retrieve defult template path\r\n     * @return {String}\r\n     */\r\n    static get #routerPath() {\r\n        return GSLoader.ROUTER_URL ? GSLoader.ROUTER_URL.replace('//', '/') : '';\r\n    }\r\n\r\n    /**\r\n     * Used for override to get predefined template\r\n     * Can be html source or url, checks if load or not\r\n     * \r\n     * @async\r\n     * @param {String} def\r\n     * @return {Promise<string>}\r\n     */\r\n    static async getTemplate(def = '') {\r\n\r\n        if (!def) return def;\r\n\r\n        const isRef = def.startsWith('#');\r\n        if (isRef) {\r\n            const el = GSDOM.query(document.documentElement, def);\r\n            return el ? el.innerHTML : def;\r\n        }\r\n\r\n        const isHTML = GSUtil.isHTML(def);\r\n        if (isHTML) return def;\r\n\r\n        def = GSLoader.#getTemplateURL(def);\r\n        return GSLoader.loadSafe(def);\r\n    }\r\n\r\n    /**\r\n     * Decode template URL into a real URL\r\n     * @param {String} url \r\n     * @return {String}\r\n     */\r\n    static #getTemplateURL(url = '') {\r\n        /*\r\n        const isDirect =  /^(https?:\\/\\/)/i.test(url);\r\n        url = isDirect ? url : GSLoader.#templateURL + '/' + url;\r\n        */\r\n        url = url.startsWith('//') ? GSLoader.#templateURL + '/' + url : url;\r\n        return GSLoader.normalizeURL(url);\r\n    }\r\n\r\n    /**\r\n     * Retrieve default template url\r\n     * @return {String}\r\n     */\r\n    static get #templateURL() {\r\n        return GSLoader.normalizeURL(GSLoader.#templatePath, true);\r\n    }\r\n\r\n    /**\r\n     * Retrieve defult template path\r\n     * @return {String}\r\n     */\r\n    static get #templatePath() {\r\n        return GSLoader.TEMPLATE_URL ? GSLoader.TEMPLATE_URL.replace('//', '/') : '';\r\n    }\r\n\r\n    /**\r\n     * Load html template (used for template cache)\r\n     * \r\n     * @async\r\n     * @param {String} val Full or partial url path\r\n     * @param {String} method HTTP methog get|put|post\r\n     * @returns {Promise<string>}\r\n     * @throws {Error}\r\n     */\r\n    static async loadTemplate(val = '', method = 'GET') {\r\n        const url = GSLoader.#getTemplateURL(val);\r\n        return await GSLoader.load(url, method);\r\n    }\r\n\r\n    /**\r\n     * Load remote data as text (for loading templates)\r\n     * \r\n     * @async\r\n     * @param {String} val Full or partial url path\r\n     * @param {String} method HTTP method get|put|post\r\n     * @param {Object} headers HTTP request headers in JSON key/value pairs\r\n     * @param {Boolean} asjson Parse returned data as JSON\r\n     * @param {} body Data to send in a request \r\n     * @returns {Promise<object|string>}\r\n     */\r\n    static async load(val = '', method = 'GET', headers, asjson = false, body) {\r\n        let data = null;\r\n        const ct = 'Content-Type';\r\n        headers = { ...headers };\r\n        headers[ct] = asjson ? 'application/json; utf-8' : headers[ct] || 'text/plain';\r\n        headers.Accept = 'application/json';\r\n        const url = GSLoader.normalizeURL(val, true);\r\n        const opt = { method: method, headers: headers };\r\n        if (method === 'POST' || method === 'PUT' && body) {\r\n            // TODO - detect if binary\r\n            opt.body = JSON.stringify(body);\r\n        }\r\n        const res = await fetch(url, opt);\r\n        if (res.ok) data = asjson ? await res.json() : await res.text();\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * Load remote data without throwing an exception\r\n     * \r\n     * @async\r\n     * @param {String} url Full or partial url path\r\n     * @param {String} method http method GET|POST|PUT\r\n     * @param {Object} headers return json or string\r\n     * @param {Boolean} asjson return json or string\r\n     * @param {Object} dft default value\r\n     * @returns {Promise<object|string>}\r\n     */\r\n    static async loadSafe(url = '', method = 'GET', headers, asjson = false, dft, body) {\r\n        try {\r\n            if (url) return GSLoader.load(url, method, headers, asjson, body);\r\n        } catch (e) {\r\n            GSLog.error(null, e);\r\n        }\r\n        if (dft) return dft;\r\n        return asjson ? {} : '';\r\n    }\r\n\r\n\r\n    /**\r\n     * Load data from various sources\r\n     * \r\n     * @async\r\n     * @param {JSON|func|url} val \r\n     * @returns {Promise}\r\n     */\r\n    static async loadData(val = '') {\r\n\r\n        const isJson = GSUtil.isJson(val);\r\n        const func = !isJson && GSFunction.parseFunction(val);\r\n        const isFunc = func && GSFunction.isFunction(func);\r\n        const isData = !isFunc && GSUtil.parseValue(val);\r\n\r\n        if (isData || isJson) val = GSUtil.toJson(val);\r\n\r\n        if (isFunc) val = await GSFunction.callFunction(func);\r\n\r\n        if (!GSUtil.isJsonType(val)) return;\r\n\r\n        return val;\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSLoader);\r\n        globalThis.GSLoader = GSLoader;\r\n    }\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2022  Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSTemplateCache class\r\n * @module templating/GSTemplateCache\r\n */\r\n\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSLoader } from \"./GSLoader.mjs\";\r\nimport { GSLog } from \"./GSLog.mjs\";\r\n\r\n/**\r\n * Template cache to store loaded and preprocessed templates for reuse\r\n * @class\r\n */\r\nexport class GSTemplateCache {\r\n\r\n\tstatic #store = new Map();\r\n\r\n\t static clear() {\r\n\t\tGSTemplateCache.#store.clear();\r\n\t}\r\n\r\n\t/**\r\n\t * Store pre-processed template into a cache under given name. \r\n\t * Name is usually a path to a template.\r\n\t * @param {String} name Name of a template\r\n\t * @param {HTMLTemplateElement} template Preprocessed template\r\n\t */\r\n\tstatic store(name, template) {\r\n\t\tthis.#store.set(name, template);\r\n\t}\r\n\r\n\t/**\r\n\t * Remove template from cache\r\n\t * @param {String} name Name of a template\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic remove(name) {\r\n\t\treturn this.#store.delete(name);\r\n\t}\r\n\r\n\t/**\r\n\t * Get template from cache by its name.\r\n\t * @param {*} name Name of a template\r\n\t * @returns {HTMLTemplateElement}\r\n\t */\r\n\tstatic load(name) {\r\n\t\treturn this.#store.get(name);\r\n\t}\r\n\r\n\t/**\r\n\t * Helper function to retrieve already existing template by name,\r\n\t * or inject a new one if it does not exist already and return template instance.\r\n\t * @param {String} name \r\n\t * @param {String} template \r\n\t * @returns {HTMLTemplateElement}\r\n\t */\r\n\tstatic getOrCreate(name, template) {\r\n\t\tconst me = GSTemplateCache;\r\n\t\tlet el = me.load(name);\r\n\t\tif (el) return el;\r\n\t\tel = me.create(template);\r\n\t\tme.store(name, el);\r\n\t\treturn el;\r\n\t}\r\n\r\n\t/**\r\n\t * Create template element from loaded template source\r\n\t * \r\n\t * @param {String} template \r\n\t * @returns {HTMLTemplateElement}\r\n\t */\r\n\tstatic create(template) {\r\n\t\tconst el = document.createElement('template');\r\n\t\tGSDOM.setHTML(el, template);\r\n\t\treturn el;\r\n\t}\r\n\r\n\t/**\r\n\t * Clone data from template element\r\n\t * \r\n\t * @param {HTMLTemplateElement} template \r\n\t * @returns {HTMLTemplateElement}\r\n\t */\r\n\tstatic clone(template) {\r\n\t\treturn GSDOM.isTemplateElement(template) ? template.content.cloneNode(true) : null;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if template is retrieved from function\r\n\t * \r\n\t * @param {String} tpl \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isFunctionTemplate(tpl) {\r\n\t\tconst fn = GSFunction.parseFunction(tpl);\r\n\t\treturn GSFunction.isFunction(fn) ? fn : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if template is retrieved from html code\r\n\t * \r\n\t * @param {String} tpl \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isHTMLTemplate(tpl) {\r\n\t\tconst val = tpl ? tpl.trim() : '';\r\n\t\t//return (val.startsWith('<') && val.endsWith('>')) ? tpl : false;\r\n\t\treturn /^<(.*)>$/s.test(val) ? tpl : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if template is retrieved from URL\r\n\t * \r\n\t * @param {String} tpl \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isURLTemplate(tpl) {\r\n\t\tconst val = tpl ? tpl.trim() : '';\r\n\t\treturn /^(https?:\\/\\/|.{0,2}\\/{1,2})/i.test(val) ? tpl : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Initialize loaded template\r\n\t * \r\n\t * @param {Boolean} cached Set to true to auto cache if template does not exist\r\n\t * @param {String} name Template name\r\n\t * @param {String} template Template source\r\n\t * @returns {HTMLTemplateElement} Template instance\r\n\t */\r\n\tstatic initTemplate(cached = false, name = '', template) {\r\n\t\tconst me = GSTemplateCache;\r\n\t\tif (cached) return me.getOrCreate(name, template);\r\n\t\treturn me.create(template);\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve template from given HTML text\r\n\t * \r\n\t * @param {Boolean} cached Set to true to auto cache if template does not exist\r\n\t * @param {String} name Template name\r\n\t * @param {String} tpl Template source\r\n\t * @returns {HTMLTemplateElement} Template instance\r\n\t */\r\n\tstatic loadHTMLTemplate(cached = false, name = '', tpl) {\r\n\t\tconst me = GSTemplateCache;\r\n\t\tconst o = me.isHTMLTemplate(tpl);\r\n\t\tif (!o) return o;\r\n\t\treturn me.initTemplate(cached, name, o);\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve template from given URL\r\n\t * \r\n\t * @async\r\n\t * @param {Boolean} cached Set to true to auto cache if template does not exist\r\n\t * @param {String} name Template name\r\n\t * @param {String} template Template source\r\n\t * @returns {Promise<HTMLTemplateElement>} Template instance\r\n\t */\r\n\tstatic async loadURLTemplate(cached = false, name = '', tpl) {\r\n\t\tconst me = GSTemplateCache;\r\n\t\ttry {\r\n\t\t\tlet template = null;\r\n\t\t\tif (cached) template = me.load(tpl);\r\n\t\t\tif (template) return template;\r\n\t\t\ttemplate = await GSLoader.loadTemplate(tpl);\r\n\t\t\treturn me.initTemplate(cached, name, template);\r\n\t\t} catch (e) {\r\n\t\t\tGSLog.error(me, e);\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve template from given function\r\n\t * \r\n\t * @async\r\n\t * @param {Boolean} cached Set to true to auto cache if template does not exist\r\n\t * @param {String} name Template name\r\n\t * @param {String} template Template source\r\n\t * @returns {Promise<HTMLTemplateElement>} Template instance\r\n\t */\r\n\tstatic async loadFunctionTemplate(cached = false, name = '', tpl) {\r\n\t\tconst me = GSTemplateCache;\r\n\t\tconst fn = me.isFunctionTemplate(tpl);\r\n\t\tif (!fn) return fn;\r\n\t\ttry {\r\n\t\t\tlet template = null;\r\n\t\t\tif (me.cached) template = me.load(o);\r\n\t\t\tif (template) return template;\r\n\t\t\ttemplate = GSFunction.isFunctionAsync(fn) ? await fn() : fn();\r\n\t\t\treturn me.initTemplate(cached, name, template);\r\n\t\t} catch (e) {\r\n\t\t\tGSLog.error(null, e);\r\n\t\t}\r\n\t\treturn fn;\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve and cache html template for element\r\n\t * \r\n\t * @async\r\n\t * @param {Boolean} cached Set to true to auto cache if template does not exist\r\n\t * @param {String} name Template name\r\n\t * @param {String} template Template source\r\n\t * @returns {Promise<HTMLTemplateElement>} Template instance\r\n\t */\r\n\tstatic async loadTemplate(cached = false, name = '', tpl) {\r\n\r\n\t\tif (!name) return false;\r\n\t\tif (!tpl) return false;\r\n\r\n\t\tconst me = GSTemplateCache;\r\n\r\n\t\t// try to load override template (by GSElement tag name)\r\n\t\tlet template = false;\r\n\r\n\t\tif (tpl.indexOf('#') == 0) {\r\n\t\t\t// return document.getElementById(tpl.slice(1));\r\n\t\t\treturn GSDOM.query(`template[id=\"${tpl.slice(1)}\"]`, true);\r\n\t\t}\r\n\r\n\t\tif (!template) {\r\n\t\t\ttemplate = me.loadHTMLTemplate(cached, name, tpl);\r\n\t\t}\r\n\r\n\t\tif (!template) {\r\n\t\t\ttemplate = await me.loadFunctionTemplate(cached, name, tpl);\r\n\t\t}\r\n\r\n\t\tif (!template) {\r\n\t\t\ttemplate = await me.loadURLTemplate(cached, name, tpl);\r\n\t\t}\r\n\r\n\t\treturn template;\r\n\t}\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { DEF } from './GSConst.mjs';\r\nimport { GSLog } from \"./GSLog.mjs\";\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSAttr } from \"./GSAttr.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSEvents } from \"./GSEvents.mjs\";\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSTemplateCache } from \"./GSTemplateCache.mjs\";\r\n\r\n/**\r\n * A module GSAttributeHandler GSAttr class\r\n * @module base/GSDOM\r\n */\r\n\r\n/**\r\n * Attributes to control click actions for buttons and links.\r\n * Used for meta linking between UI elements\r\n * \r\n * Attributes handled:\r\n * - data-gs-action - trigger action event\r\n * - data-gs-anchor - where to anchor injected html (self, beforebegin, afterbegin, etc.)\r\n * - data-gs-attribute - toggle element attribute (receive k=v;k1=v1 or JSON format)\r\n * - data-gs-call - calls a function on a given target (multiple functions supported)\r\n * - data-gs-event - emit event (can bubble or compose)\r\n * - data-gs-exec - execute a function (alternative to the call)\r\n * - data-gs-inject - inject HTML content; used for WebComponent append\r\n * - data-gs-property - togle element property (receive k=v;k1=v1 or JSON format)\r\n * - data-gs-swap - swap HTML content; used for WebComponent replacement\r\n * - data-gs-base - CSS query for a target owner (from where to start querying)\r\n * - data-gs-target - CSS query for a target or targets\r\n * - data-gs-template - template to load and inject template\r\n * - data-gs-timeout - a timeout between class toggle\r\n * - data-gs-toggle - toggle CSS classes on a given target\r\n * - data-gs-trigger - triggers an event on a given target\r\n * - data-gs-value - value to pass to a gs-call or gs-trigger\r\n *\r\n * NOTE: \r\n * data-gs-swap and gs-inject uses data-gs-anchor to determine \r\n * where to inject html. If not, set, innerHTML is used\r\n * \r\n * data-gs-target determine element on which to execute,\r\n * if not specified, it means current element\r\n * \r\n * @class\r\n */\r\nexport class GSAttributeHandler {\r\n\r\n    static #reverse = Symbol();\r\n    static #link = Symbol();\r\n\r\n    static DEFINITION = {\r\n        action: { attribute: 'data-gs-action' },\r\n        anchor: { attribute: 'data-gs-anchor' },\r\n        attribute: { attribute: 'data-gs-attribute' },\r\n        call: { attribute: 'data-gs-call' },\r\n\r\n        event: { attribute: 'data-gs-event' },\r\n        bubbles: { attribute: 'data-gs-bubbles', type: Boolean },\r\n        composed: { attribute: 'data-gs-composed', type: Boolean },\r\n\r\n        exec: { attribute: 'data-gs-exec' },\r\n        inject: { attribute: 'data-gs-inject' },\r\n        property: { attribute: 'data-gs-property' },\r\n        swap: { attribute: 'data-gs-swap' },\r\n        base: { attribute: 'data-gs-base' },\r\n        target: { attribute: 'data-gs-target' },\r\n        template: { attribute: 'data-gs-template' },\r\n        toggle: { attribute: 'data-gs-toggle' },\r\n        trigger: { attribute: 'data-gs-trigger' },\r\n        value: { attribute: 'data-gs-value' },\r\n\r\n        hashed: { attribute: 'data-gs-hashed', type: Boolean },\r\n\r\n        calls: { attribute: 'data-gs-call', multi: true },\r\n        toggles: { attribute: 'data-gs-toggle', multi: true },\r\n        timeout: { attribute: 'data-gs-timeout', type: Number },\r\n        triggers: { attribute: 'data-gs-trigger', multi: true },\r\n    }\r\n\r\n    #host;\r\n    #proxy;\r\n    #targetList = null\r\n    #active = false;\r\n    #callback;\r\n\r\n    constructor(el, target) {\r\n        const me = this;\r\n        me.#host = el.isProxy ? el.self : el;\r\n        me.#callback = me.handle.bind(me);\r\n        me.#proxy = el.isProxy ? el : GSAttributeHandler.proxify(me.#host);\r\n        if (target) me.#targetList = Array.isArray(target) ? target : [target];\r\n    }\r\n\r\n    /**\r\n     * Main function to process element data-gs-* attributes\r\n     * @param {Event} e \r\n     */\r\n    handle(e) {\r\n        const me = this;\r\n        me.targets.forEach(el => me.#handleTarget(me.#host, el, e));\r\n    }\r\n\r\n    /**\r\n     * Process each individual data-gs-* attribute\r\n     * @param {GSElement} host \r\n     * @param {String|HTMLElement} target \r\n     * @param {Event} evt \r\n     */\r\n    #handleTarget(host, target, evt) {\r\n        const me = this;\r\n        me.#handleBinding(target, evt);\r\n        me.#handleAction(target);\r\n        me.#handleSwap(host, target);\r\n        me.#handleInject(host, target);\r\n        me.#handleAttribute(target);\r\n        me.#handleProperty(target);\r\n        me.#handleToggle(target);\r\n        me.#handleTrigger(target, evt);\r\n        me.#handleEvent(host, evt);\r\n        me.#handleCall(host, target, evt);\r\n        me.#handleExec(host, target, evt);\r\n        me.#handleTemplate(host, target);\r\n    }\r\n\r\n    /**\r\n     * Bind provided value to the form or form element\r\n     * @param {HTMLFormElement|HTMLInputElement} target \r\n     * @param {Event} evt \r\n     * @returns \r\n     */\r\n    #handleBinding(target, evt) {\r\n        const source = evt?.target?.field || evt?.target?.form || evt?.target;\r\n        const isForm = source instanceof HTMLFormElement;\r\n        const isField = GSDOM.isFormElement(source);\r\n        if (!(isField || isForm)) return;\r\n        if (isField) {\r\n            target[source.name] = GSDOM.getValue(source);\r\n        } else {\r\n            Object.assign(target, GSDOM.toObject(source));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Trigger 'action' event on target to execute specific function\r\n     * @param {GSElement} target \r\n     */\r\n    #handleAction(target) {\r\n        if (this.action) GSEvents.send(target, 'action', this.action, true, true);\r\n    }\r\n\r\n    /**\r\n     * Set target attribute value\r\n     * @param {HTMLElement} target \r\n     * @returns \r\n     */\r\n    #handleAttribute(target) {\r\n        const me = this;\r\n\r\n        if (GSUtil.isNull(me.attribute) && me.attributes.length === 0) return;\r\n\r\n        if (me.inject) target = GSDOM.query(target, me.inject);\r\n        if (me.swap) target = GSDOM.query(target, me.swap);\r\n\r\n        if (me.isAttributeJSON) {\r\n            const obj = GSUtil.toJson(me.attribute);\r\n            return GSAttr.jsonToAttr(target, obj);\r\n        }\r\n        const attrs = me.attributes;\r\n        attrs.forEach(v => me.#toggleAttribute(target, v[0], me.value || v[1]));\r\n    }\r\n\r\n    /**\r\n     * Set value to target propery\r\n     * @param {GSElement} target \r\n     * @returns \r\n     */\r\n    #handleProperty(target) {\r\n        const me = this;\r\n        if (GSUtil.isNull(me.property) && me.properties.length === 0) return;\r\n        if (me.inject) target = GSDOM.query(target, me.inject);\r\n        if (me.swap) target = GSDOM.query(target, me.swap);\r\n        if (me.isPropertyJSON) {\r\n            const obj = GSUtil.toJson(me.property);\r\n            return Object.assign(target, obj);\r\n        }\r\n        const props = me.properties;\r\n        props.forEach(v => me.#toggleProperty(target, v[0], me.value || v[1]));\r\n    }\r\n\r\n    #toggleAttribute(target, name, value) {\r\n        const me = this;\r\n        if (GSUtil.isBool(target[name])) {\r\n            const value = me.isToggling ? me.isActive : !target[name];\r\n            return GSAttr.toggle(target, name, value);\r\n        } else if (GSUtil.isNumber(target[name])) {\r\n            value = GSUtil.asNum(value);\r\n        }\r\n        GSAttr.set(target, name, value);\r\n    }\r\n\r\n    #toggleProperty(target, name, value) {\r\n        if (GSUtil.isBool(target[name])) {\r\n            if (GSUtil.isStringEmpty(value)) {\r\n                target[name] = !target[name];\r\n            } else {\r\n                target[name] = GSUtil.asBool(value);\r\n            }\r\n        } else if (GSUtil.isNumber(target[name])) {\r\n            target[name] = GSUtil.asNum(value);\r\n        } else {\r\n            target[name] = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Toggle target css class\r\n     * @param {HTMLElement} target \r\n     */\r\n    async #handleToggle(target) {\r\n        const me = this;\r\n        const tout = me.timeout * 1000;\r\n        let toggles = me.toggles;\r\n        if (tout === 0) {\r\n            toggles.forEach(v => GSDOM.toggleClass(target, v));\r\n        } else {\r\n            if (target[me.#symbol]) toggles = toggles.slice().reverse();\r\n            for (const v of toggles) {\r\n                await GSUtil.timeout(tout);\r\n                GSDOM.toggleClass(target, v);\r\n            }\r\n            target[me.#symbol] = !target[me.#symbol];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Calls a function on a target\r\n     * @param {GSElement} host \r\n     * @param {HTMLElement} target \r\n     * @param {Event} evt \r\n     */\r\n    #handleCall(host, target, evt) {\r\n        const val = GSUtil.isJsonString(host.value) ? GSUtil.toJson(host.value) : host.value;\r\n        this.calls.forEach(v => GSFunction.callFunction(target[v], target, true, val || evt));\r\n    }\r\n\r\n    /**\r\n     * Calls a function on a target\r\n     * @param {*} host \r\n     * @param {*} target \r\n     * @param {*} evt \r\n     * @returns \r\n     */\r\n    #handleExec(host, target, evt) {\r\n        if (!this.exec) return;\r\n        try {\r\n            new Function(this.exec).bind(target)(evt);\r\n        } catch (e) {\r\n            GSLog.error(target, e);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Send an event to a target\r\n     * @param {HTMLElement} target \r\n     * @param {Event} evt \r\n     */\r\n    #handleTrigger(target, evt) {\r\n        this.triggers.forEach(v => GSEvents.send(target, v, evt));\r\n    }\r\n\r\n    #handleEvent(host, evt) {\r\n        //host.emit?.(this.event, evt, this.bubbles, this.composed, true);\r\n        GSEvents.send(host, this.event, evt, this.bubbles, this.composed, true);\r\n    }\r\n\r\n    #handleContent(host, target, value, clean = false) {\r\n        const me = this;\r\n        if (value) {\r\n            let src = '';\r\n            const useDef = GSUtil.asBool(value);\r\n            if (useDef) {\r\n                src = GSDOM.fromJsonAsString(me.definition);\r\n            } else {\r\n                src = me.#toHTML(value);\r\n            }\r\n\r\n            const content = GSDOM.parse(src, true);\r\n\r\n            if (!useDef) {\r\n                GSAttr.jsonToAttr(me.definition, content);\r\n            }\r\n\r\n            if (clean) {\r\n                //target.innerHTML = '';\r\n                GSDOM.cleanup(target);\r\n            }\r\n\r\n            content.dataset.gsHashed = me.hashed;\r\n            me.#applyContent(host, target, content);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * Inject HTML to target\r\n     * @param {GSElement} host \r\n     * @param {HTMLElement} target \r\n     */\r\n    #handleInject(host, target) {\r\n        this.#handleContent(host, target, this.inject, false);\r\n    }\r\n\r\n    /**\r\n     * Swap inner HTML on a target\r\n     * @param {HTMLElement} target \r\n     */\r\n    #handleSwap(host, target) {\r\n        this.#handleContent(host, target, this.swap, true);\r\n    }\r\n\r\n    /**\r\n     * Convert value as URL to a template or as a component name to inject\r\n     * @param {String} value \r\n     * @returns {String}\r\n     */\r\n    #toHTML(value = '') {\r\n        return value.indexOf('/') < 0 ? `<${value}></${value}>` : `<gs-template flat src=\"${value}\"></gs-template>`;\r\n    }\r\n\r\n    /**\r\n     * Load HTML template and apply to a target\r\n     * @param {GSElement} host \r\n     * @param {HTMLElement} target \r\n     */\r\n    async #handleTemplate(host, target) {\r\n        const tpl = await GSTemplateCache.loadTemplate(true, this.template, this.template);\r\n        this.#applyTemplate(host, target, tpl);\r\n    }\r\n\r\n    /**\r\n     * Apply htmltemplate to a target\r\n     * @param {GSElement} host \r\n     * @param {HTMLElement} target \r\n     * @param {HTMLTemplateElement} template \r\n     */\r\n    #applyTemplate(host, target, template) {\r\n        const content = GSTemplateCache.clone(template);\r\n        this.#applyContent(host, target, content);\r\n    }\r\n\r\n    /**\r\n     * Apply html template to a target\r\n     * @param {GSElement} host \r\n     * @param {HTMLElement} target \r\n     * @param {HTMLTemplateElement} content \r\n     */\r\n    #applyContent(host, target, content) {\r\n        if (host?.anchor) {\r\n            GSDOM.insertAdjacent(target, content, host.anchor);\r\n        } else {\r\n            GSDOM.appendChild(target, content);\r\n        }\r\n    }\r\n\r\n    attach(name = 'click') {\r\n        const me = this;\r\n        if (!me.#active) {\r\n            GSEvents.on(me.#host, null, name, me.#callback);\r\n            me.#active = true;\r\n        }\r\n    }\r\n\r\n    detach(name = 'click') {\r\n        //GSEvents.detachListeners(this.#host);\r\n        const me = this;\r\n        GSEvents.off(me.#host, null, name, me.#callback);\r\n        me.#active = false;\r\n    }\r\n\r\n    get #symbol() {\r\n        return GSAttributeHandler.#reverse;\r\n    }\r\n\r\n    get targets() {\r\n\r\n        const me = this;\r\n\r\n        // if target not set (element #id), use owner element where to inject actions\r\n        if (!me.target && me.#targetList) {\r\n            return me.#targetList;\r\n        }\r\n\r\n        switch (me.target) {\r\n            case 'this':\r\n            case 'self':\r\n                return [me.#host];\r\n            case 'owner':\r\n                //return [GSDOM.root(me.#host)];\r\n                return [me.#host.parentComponent];\r\n            case 'parent':\r\n                return [me.#host.parentElement];\r\n        }\r\n\r\n        const owner = me.base ? GSDOM.query(me.base) : document.body;\r\n        const list = GSDOM.queryAll(owner, me.target, false, true).filter(el => el.tagName !== 'GS-ITEM');\r\n        if (list.length === 0) list.push(me.#host);\r\n        return list;\r\n    }\r\n\r\n    get host() { return this.#host; }\r\n\r\n    // if host is button with toggling flag, then use that for data-attribute\r\n    get isActive() { return this.#host.active || false; }\r\n    get isToggling() { return this.#host.toggling || false; }\r\n\r\n    get definition() { return this.#proxy[DEF]; }\r\n\r\n    get action() { return this.#proxy.action; }\r\n    get anchor() { return this.#proxy.anchor; }\r\n    get attribute() { return this.#proxy.attribute; }\r\n    get exec() { return this.#proxy.exec; }\r\n    get event() { return this.#proxy.event; }\r\n    get bubbles() { return this.#proxy.bubbles; }\r\n    get composed() { return this.#proxy.composed; }\r\n    get call() { return this.#proxy.call; }\r\n    get inject() { return this.#proxy.inject; }\r\n    get property() { return this.#proxy.property; }\r\n    get swap() { return this.#proxy.swap; }\r\n    get target() { return this.#proxy.target; }\r\n    get base() { return this.#proxy.base; }\r\n    get toggle() { return this.#proxy.toggle; }\r\n    get trigger() { return this.#proxy.trigger; }\r\n    get timeout() { return this.#proxy.timeout; }\r\n    get template() { return this.#proxy.template; }\r\n    get value() { return this.#proxy.value; }\r\n    get hashed() { return this.#proxy.hashed; }\r\n\r\n    get calls() { return this.#proxy.calls; }\r\n    get toggles() { return this.#proxy.toggles; }\r\n    get triggers() { return this.#proxy.triggers; }\r\n\r\n    get attributes() {\r\n        const val = this.#proxy.attribute || '';\r\n        return val.split(/[,;]/g).map(v => v.split('=')).filter(v => GSUtil.isStringNonEmpty(v[0]));\r\n    }\r\n\r\n    get properties() {\r\n        const val = this.#proxy.property || '';\r\n        return val.split(/[,;]/g).map(v => v.split('=')).filter(v => GSUtil.isStringNonEmpty(v[0]));\r\n    }\r\n\r\n    /**\r\n     * Is property value JSON\r\n     */\r\n    get isPropertyJSON() {\r\n        return GSUtil.isJson(this.property);\r\n    }\r\n\r\n    /**\r\n     * Is element attribute value JSON\r\n     */\r\n    get isAttributeJSON() {\r\n        return GSUtil.isJson(this.attribute);\r\n    }\r\n\r\n    /**\r\n     * Wrap any element into data-gs-* handler\r\n     * @param {HTMLElement} el \r\n     * @returns {Proxy}\r\n     */\r\n    static proxify(el) {\r\n        return GSAttr.proxify(el, GSAttributeHandler.DEFINITION);\r\n    }\r\n\r\n    /**\r\n     * Process data-gs-* attributes on a element\r\n     * @param {HTMLElement} el \r\n     * @param {Event} e \r\n     * @returns \r\n     */\r\n    static process(el, e) {\r\n        //if (!el?.hasAttribute('data-gs-target')) return;\r\n        if (!el?.dataset?.gsTarget) return;\r\n        let me = el[GSAttributeHandler.#link];\r\n        if (!(me instanceof GSAttributeHandler)) {\r\n            me = new GSAttributeHandler(el);\r\n            el[GSAttributeHandler.#link] = me;\r\n        }\r\n        me.handle(e);\r\n    }\r\n\r\n    /**\r\n     * Create a new attribute handler instance\r\n     * @param {HTMLElement} el \r\n     * @returns \r\n     */\r\n    static create(el) {\r\n        const me = new GSAttributeHandler(el);\r\n        me.attach();\r\n        return me;\r\n    }\r\n\r\n    /**\r\n     * Clone element attributes (GS-ITEM to real WebComponent)\r\n     * @param {HTMLElement} from \r\n     * @param {HTMLElement} to \r\n     * @param {boolean} override If 'false' will skip existing attributes\r\n     */\r\n    static clone(from, to, override = true) {\r\n        const def = GSAttributeHandler.DEFINITION;\r\n        Object.values(def)\r\n            .filter(o => from.hasAttribute(o.attribute))\r\n            .filter(o => override || !to.hasAttribute(o.attribute))\r\n            .forEach(o => to.setAttribute(o.attribute, from.getAttribute(o.attribute)));\r\n    }\r\n\r\n    /**\r\n     * Check if component is bindable to events\r\n     * @param {HTMLElement} el \r\n     * @returns \r\n     */\r\n    static isBindable(el) {\r\n        const def = GSAttributeHandler.DEFINITION;\r\n        return Object.values(def)\r\n            .filter(o => el.hasAttribute(o.attribute))\r\n            .length > 0;\r\n\r\n    }\r\n\r\n    static {\r\n        const def = GSAttributeHandler.DEFINITION;\r\n        Object.values(def).forEach(o => Object.freeze(o));\r\n        Object.freeze(def);\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSBeep class\r\n * @module base/GSBeep\r\n */\r\n\r\n\r\n/**\r\n * A helper class to use browser AudiContext to make tones\r\n * @class\r\n */\r\nexport class GSBeep {\r\n\r\n    static audioCtx = globalThis.AudioContext || globalThis.webkitAudioContext || globalThis.audioContext;\r\n\r\n    /**\r\n     * Helper function to emit a beep sound in the browser using the Web Audio API.\r\n     * \r\n     * @param {number} duration - The duration of the beep sound in milliseconds.\r\n     * @param {number} frequency - The frequency of the beep sound.\r\n     * @param {number} volume - The volume of the beep sound.\r\n     * @param {string} tyoe - The sound type (sine, square, sawtooth, triangle, custom)\r\n     * \r\n     * @returns {Promise} - A promise that resolves when the beep sound is finished.\r\n     */\r\n    static beep(duration = 200, frequency = 440, volume = 1, type = 'sine') {\r\n        return new Promise((resolve, reject) => {\r\n            try{\r\n                if (!GSBeep.isAvailable) return resolve();\r\n                const context = new GSBeep.audioCtx();\r\n                const oscillatorNode = context.createOscillator();\r\n                const gainNode = context.createGain();\r\n                oscillatorNode.connect(gainNode);\r\n\r\n                // Set the oscillator frequency in hertz\r\n                oscillatorNode.frequency.value = frequency;\r\n\r\n                // Set the type of oscillator\r\n                oscillatorNode.type = type;\r\n                gainNode.connect(context.destination);\r\n\r\n                // Set the gain to the volume\r\n                gainNode.gain.value = volume * 0.01;\r\n\r\n                // Start audio with the desired duration\r\n                oscillatorNode.start(context.currentTime);\r\n                oscillatorNode.stop(context.currentTime + duration * 0.001);\r\n\r\n                // Resolve the promise when the sound is finished\r\n                oscillatorNode.onended = () => resolve();                \r\n            }catch(error) {\r\n                reject(error);\r\n            }\r\n        });\r\n    }\r\n\r\n    static get isAvailable() {\r\n        const {isActive, hasBeenActive } =  navigator.userActivation;\r\n        return isActive || hasBeenActive;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSEnvironment class\r\n * @module base/GSEnvironment\r\n */\r\n\r\n/**\r\n * A set of static functions used for detecting browser environment\r\n * such as OS, orientation, browser type etc.\r\n * @class\r\n */\r\nexport class GSEnvironment {\r\n\r\n    /**\r\n     * Check if page is inside mobile device\r\n     * @returns {Boolean}\r\n     */\r\n    static get isMobile() {\r\n        if (navigator.userAgentData) return navigator.userAgentData.mobile;\r\n        return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\r\n    }\r\n\r\n    /** \r\n     * Check if page is inside desktop\r\n     * @returns {Boolean}\r\n     */\r\n    static get isDesktop() {\r\n        return !GSEnvironment.isMobile;\r\n    }\r\n\r\n    static get isWebkit() {\r\n        return /webkit/.test(navigator.userAgent.toLowerCase());\r\n    }\r\n\r\n    /**\r\n     * Check if value match current URL scheme\r\n     * @param {*} val \r\n     */  \r\n    static isValidProtocol(val = '') {\r\n        if (!val) return true;\r\n        return location.protocol.slice(0, -1) === val;\r\n\t}\r\n\r\n    /**\r\n     * Check if value match current browser type\r\n     * @param {String} val \r\n     * @returns {Boolean}\r\n     */\r\n    static isValidBrowser(val = '') {\r\n        if (!val) return true;\r\n        const strVal = val.toLowerCase();\r\n        if (navigator.userAgentData) {\r\n            let sts = false;\r\n            navigator.userAgentData.brands.forEach((v) => {\r\n                if (v.brand.toLowerCase().includes(strVal)) {\r\n                    sts = true;\r\n                }\r\n            });\r\n            return sts;\r\n        }\r\n        const strAgt = navigator.userAgent.toLocaleLowerCase() || '';\r\n        const isEdge = strAgt.includes('edg');\r\n        if (isEdge && strVal.startsWith('edg')) return true;\r\n        return !isEdge && strAgt.includes(strVal);\r\n    }\r\n\r\n    /**\r\n     * Returns if environment matched\r\n     * dektop, mobile, tablet, android, linux, windows, macos, ios\r\n     * @returns {Boolean}\r\n     */\r\n    static isValidEnvironment(val = '') {\r\n\r\n        if (!val) return true\r\n\r\n        if (val === 'desktop') {\r\n            return GSEnvironment.isDesktop;\r\n        }\r\n\r\n        if (val === 'mobile') {\r\n            return GSEnvironment.isMobile;\r\n        }\r\n\r\n        return GSEnvironment.isDevice(val);\r\n    }\r\n\r\n    /**\r\n     * Returns true if device /os is valid\r\n     * @param {String} val \r\n     * @returns {Boolean}\r\n     */\r\n    static isDevice(val = '') {\r\n        if (!val) return true;\r\n        const strVal = val.toLowerCase();\r\n\r\n        if (navigator.userAgentData && navigator.userAgentData.platform) {\r\n            const platform = navigator.userAgentData.platform.toLowerCase();\r\n            return platform === strVal;\r\n        }\r\n\r\n        const strAgt = navigator.userAgent.toLocaleLowerCase();\r\n        return strAgt.indexOf(strVal) > 1;\r\n    }\r\n\r\n    /**\r\n     * Returns if orientation matched\r\n     * horizontal, vertical, portrait, landscape\r\n     * retuns true if value not set\r\n     * \r\n     * @param {String} val\r\n     * @returns {Boolean}\r\n     */\r\n    static isValidOrientation(val = '') {\r\n\r\n        if (!val) return true;\r\n\r\n        if (!screen.orientation) return true;\r\n\r\n        const otype = screen.orientation.type;\r\n\r\n        if (otype.includes('portrait')) {\r\n            return val === 'portrait' || val === 'vertical';\r\n        }\r\n\r\n        if (otype.includes('landscape')) {\r\n            return val === 'landscape' || val === 'horizontal';\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSEnvironment);\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A module loading GSPromise class\r\n * @module base/GSPromise\r\n */\r\n\r\n/**\r\n * A Promise wrapper for timeouted and cancelable events\r\n * @class\r\n */\r\nexport class GSPromise {\r\n\r\n    #signal;\r\n    #callback;\r\n    #callbacks;\r\n    #resolve;\r\n    #reject;\r\n    #promise;\r\n\r\n    /**\r\n     * \r\n     * @param {*} callback \r\n     * @param {Number|AbortSignal} signal Timeout or custom signal\r\n     */\r\n    constructor(callback, signal) {\r\n        const me = this;\r\n        me.#callback = callback;\r\n        me.#signal = signal instanceof AbortSignal ? signal : null;\r\n        me.#signal = GSUtil.isNumber(signal) ? AbortSignal.timeout(signal) : me.#signal;\r\n        me.#callbacks = {\r\n            abort: me.#onAbort.bind(me)\r\n        };\r\n    }\r\n\r\n    await() {\r\n        const me = this;\r\n        if (me.#promise) return me.#promise;\r\n        me.#signal?.addEventListener('abort', me.#callbacks.abort);\r\n        me.#promise = new Promise(me.#wrap.bind(me));\r\n        return me.#promise;\r\n    }\r\n\r\n    get aborted() {\r\n        return this.#signal?.aborted === true;\r\n    }\r\n\r\n    #wrap(resolve, reject) {\r\n        const me = this;\r\n        me.#resolve = resolve;\r\n        me.#reject = reject;\r\n        try {\r\n            me.#callback(me.#onResolve.bind(me), me.#onReject.bind(me));\r\n        } catch (e) {\r\n            me.#clear();\r\n            reject(e);\r\n        }\r\n    }\r\n\r\n    #onAbort() {\r\n        const me = this;\r\n        me.#clear();\r\n        me.#reject(new Error('Promise aborted!'));\r\n    }\r\n\r\n    #onResolve(o) {\r\n        const me = this;\r\n        me.#clear();\r\n        return me.aborted ? null : me.#resolve(o);\r\n    }\r\n\r\n    #onReject(e) {\r\n        const me = this;\r\n        me.#clear();\r\n        return me.aborted ? null : me.#reject(e);\r\n    }\r\n\r\n    #clear() {\r\n        const me = this;\r\n        me.#signal?.removeEventListener('abort', me.#callbacks.abort);\r\n    }\r\n\r\n\t/**\r\n\t * Execute array of promises sequentially\r\n\t * @param {Array<Promise>} ps \r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic sequential(ps) {\r\n\t\tif (!Array.isArray(ps)) ps = [];\r\n\t\treturn ps.reduce((p, next) => p.then(next), Promise.resolve());\r\n\t}\r\n\r\n    static {\r\n        globalThis.GSPromise = GSPromise;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSPromise } from \"./GSPromise.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A module loading GSEvent class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Class extending native event with additional features\r\n * @Class\r\n */\r\nexport class GSEvent extends EventTarget {\r\n\r\n    #listeners = new Set();\r\n\r\n    #list(type = '', listener) {\r\n        const me = this;\r\n        const list = Array.from(me.#listeners);\r\n        return me.#isFunction(listener) ?\r\n            list.filter(o => o.type === type && o.listener === listener)\r\n            :\r\n            list.filter(o => o.type === type);\r\n    }\r\n\r\n    #isFunction(fn) {\r\n        return typeof fn === 'function';\r\n    }\r\n\r\n    /**\r\n     * Listen for events\r\n     * \r\n     * @param {String} type Event name to be listened\r\n     * @param {Function} listener  Callback to be called on event trigger\r\n     * @param {Number} timeout It event timeout set, return AbortSignal\r\n     * @param {boolean|AbortController} abortable If abortable set, return AbortController\r\n     */\r\n    on(type = '', listener, timeout = 0, abortable = false) {\r\n        if (!type) return reject('Event undefined!');\r\n        const controller = abortable instanceof AbortController ? abortable : (abortable ? new GSAbortController(timeout) : null);\r\n        const signal = controller || timeout == 0 ? controller?.signal : AbortSignal.timeout(timeout);\r\n        this.addEventListener(type, listener, { signal: signal });\r\n        return controller || signal;\r\n    }\r\n\r\n    /**\r\n     * Listen for events only once\r\n     * \r\n     * @param {String} type Event name to be listened\r\n     * @param {Function} listener  Callback to be called on event trigger\r\n     * @param {Number} timeout It event timeout set, return AbortSignal\r\n     * @param {boolean|AbortController} abortable If abortable set, return AbortController\r\n     */\r\n    once(type, listener, timeout = 0, abortable = false) {\r\n        if (!type) return reject('Event undefined!');\r\n        const me = this;\r\n        const wrap = (e) => {\r\n            listener(e);\r\n            me.#listeners.delete(wrap);\r\n        }\r\n        wrap.type = type;\r\n        wrap.listener = listener;\r\n        wrap.timeout = timeout;\r\n        wrap.controller = abortable instanceof AbortController ? abortable : (abortable ? new GSAbortController(timeout) : null);\r\n        wrap.signal = wrap.controller || timeout == 0 ? wrap.controller?.signal : AbortSignal.timeout(timeout);\r\n        me.addEventListener(type, wrap, { once: true, signal: wrap.signal });\r\n        return wrap.controller || wrap.signal;\r\n    }\r\n\r\n    /**\r\n     * Stop listening for events\r\n     * \r\n     * @param {String} type Event name to be listened\r\n     * @param {Function} listener  Callback to be called on event trigger\r\n     */\r\n    off(type = '', listener) {\r\n        this.removeEventListener(type, listener);\r\n    }\r\n\r\n    /**\r\n     * Send event to listeners\r\n     * \r\n     * @param {String} type Event name to be listened\r\n     * @param {Object} data  Data to send \r\n     * @param {Number} delayed Emit event delay in miliseconds\r\n     */\r\n    emit(type = '', data, delayed = 0) {\r\n        const me = this;\r\n        if (delayed === true) {\r\n            return queueMicrotask(() => me.#send(type, data));\r\n        }\r\n        delayed = GSUtil.asNum(delayed, 0);\r\n        if (delayed <= 0) return me.#send(type, data);\r\n        return setTimeout(() => me.#send(type, data), delayed);\r\n    }\r\n\r\n    #send(type = '', data) {\r\n        const evt = new CustomEvent(type, { detail: data });\r\n        return this.dispatchEvent(evt);\r\n    }\r\n\r\n    /**\r\n     * Wait for an event using GSPromise wrapper\r\n     * @param {String} type Event name to be listened\r\n     * @param {AbortSignal} signal Used to abort listener\r\n     * @returns {Event}\r\n    */\r\n    wait(type = '', signal) {\r\n        const me = this;\r\n        const callback = (resolve, reject) => {\r\n            me.once(type, resolve);\r\n        }\r\n        return new GSPromise(callback, signal).await();\r\n    }\r\n\r\n    listen(type, listener) { this.on(type, listener); }\r\n    unlisten(type, listener) { this.off(type, listener); }\r\n\r\n    /**\r\n     * Remove all listeners\r\n     */\r\n    unbind() {\r\n        const me = this;\r\n        Array.from(me.#listeners).forEach(o => {\r\n            super.removeEventListener(o.type, o.listener);\r\n        });\r\n        me.#listeners.clear();\r\n    }\r\n\r\n    addEventListener(type, listener, opt) {\r\n        const me = this;\r\n        if (!me.#isFunction(listener)) return false;\r\n        me.#listeners.add({ type: type, listener: listener });\r\n        return super.addEventListener(type, listener, opt);\r\n    }\r\n\r\n    removeEventListener(type, listener) {\r\n        const me = this;\r\n        const list = me.#list(type, listener);\r\n        list.forEach(o => {\r\n            super.removeEventListener(o.type, o.listener);\r\n            me.#listeners.delete(o);\r\n        });\r\n    }\r\n\r\n    static {\r\n        Object.freeze(GSEvent);\r\n        globalThis.GSEvent = GSEvent;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSEventBus class\r\n * @module base/GSEventBus\r\n */\r\n\r\nimport { GSEvent } from './GSEvent.mjs';\r\n\r\n/**\r\n * Class for handling shared events among components\r\n * Difference from native BroadcastChannel is :\r\n *  - support for multiple named events\r\n *  - does not work across different pages\r\n * @Class\r\n */\r\nexport class GSEventBus {\r\n\r\n    static #registry = new Map();\r\n\r\n    /**\r\n     * Static event emiter. If named event does not exist, create a new one\r\n     * \r\n     * @param {String} name EventBus name\r\n     * @param {String} type Event name\r\n     * @param {Object} data Dat to send\r\n     * \r\n     * @returns {boolean|object}\r\n     */\r\n    static send(name = '', type = '', data) {\r\n        return GSEventBus.register(name).emit(type, data);\r\n    }\r\n\r\n    /**\r\n     * Check if named event bus already exists\r\n     * \r\n     * @param {String} name \r\n     * @returns {Boolean}\r\n     */\r\n    static exist(name = '') {\r\n        return name && GSEventBus.#registry.has(name);\r\n    }\r\n\r\n    /**\r\n     * Register a named event bus. If already exists, will return existsing instance.\r\n     * @param {String} name unique bus name\r\n     * @returns {GSEventBus}\r\n     */\r\n    static register(name = '') {\r\n        if (!GSEventBus.exist(name)) {\r\n            GSEventBus.#registry.set(name, new GSEvent());\r\n        }\r\n        return GSEventBus.#registry.get(name);\r\n    }\r\n\r\n    /**\r\n     * Unregister named event bus from registry.\r\n     * @param {String} name unique buss name\r\n     * @returns {Boolean} State of removal.\r\n     */\r\n    static unregister(name = '') {\r\n        const bus = GSEventBus.#registry.get(name);\r\n        if (bus?.unbind) bus.unbind();\r\n        return GSEventBus.#registry.delete(name);\r\n    }\r\n\r\n    static {\r\n        Object.freeze(GSEventBus);\r\n        globalThis.GSEventBus = GSEventBus;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSGesture class\r\n * @module base/GSGesture\r\n */\r\nimport { GSEvents } from \"./GSEvents.mjs\";\r\n\r\n/**\r\n * A class for handling touch swipe and long press events.\r\n * @class\r\n */\r\nexport class GSGesture {\r\n\r\n    #xDiff = 0;\r\n    #yDiff = 0;\r\n    #xDown = null;\r\n    #yDown = null;\r\n    #element = null;\r\n    #bindings = null;\r\n\r\n    #swipe = false;\r\n    #tap = false;\r\n    #longPress = false;\r\n\r\n    // setTimeout id for longpress\r\n    #delay = 0;\r\n\r\n    // longpress delay\r\n    static timeout = 1500;\r\n\r\n    /**\r\n     * Constructor to attach Gesture featuer to an HTML element\r\n     * @param {HTMLElement} element \r\n     * @param {Boolean} swipe Monitor swipe gesture\r\n     * @param {Boolean} tap Monitor tap gesture\r\n     * @param {Boolean} longPress Monitor long press gesture\r\n     */\r\n    constructor(element, swipe, tap, longPress) {\r\n        const me = this;\r\n        me.#swipe = swipe;\r\n        me.#tap = tap;\r\n        me.#longPress = longPress;\r\n        me.#xDown = null;\r\n        me.#yDown = null;\r\n        me.#element = typeof (element) === 'string' ? document.querySelector(element) : element;\r\n\r\n        me.#bindings = {\r\n            move: me.#handleTouchMove.bind(me),\r\n            start: me.#handleTouchStart.bind(me),\r\n            end: me.#handleTouchEnd.bind(me)\r\n        };\r\n        GSEvents.attach(me.#element, me.#element, 'touchmove', me.#bindings.move, false);\r\n        GSEvents.attach(me.#element, me.#element, 'touchstart', me.#bindings.start, false);\r\n        GSEvents.attach(me.#element, me.#element, 'touchend', me.#bindings.end, false);\r\n    }\r\n\r\n    /**\r\n     * Remove gesture events from element\r\n     */\r\n    unbind() {\r\n        const me = this;\r\n        GSEvents.remove(me.#element, me.#element, 'touchmove', me.#bindings.move);\r\n        GSEvents.remove(me.#element, me.#element, 'touchstart', me.#bindings.start);\r\n        GSEvents.remove(me.#element, me.#element, 'touchend', me.#bindings.end);\r\n    }\r\n\r\n    #handleTouchStart(evt) {\r\n        const me = this;\r\n        me.#xDown = evt.touches[0].clientX;\r\n        me.#yDown = evt.touches[0].clientY;\r\n        if (me.#longPress) setTimeout(me.#onLongPress.bind(me), GSGesture.timeout);\r\n    }\r\n\r\n    #handleTouchEnd(evt) {\r\n        clearTimeout(this.#delay);\r\n    }\r\n\r\n    #handleTouchMove(evt) {\r\n\r\n        const me = this;\r\n\r\n        if (!me.#xDown || !me.#yDown) {\r\n            return;\r\n        }\r\n\r\n        if (!me.#swipe) return;\r\n\r\n        const xUp = evt.touches[0].clientX;\r\n        const yUp = evt.touches[0].clientY;\r\n\r\n        if (me.#longPress) {\r\n            const isMoving = Math.abs(me.#xDiff) > 10 && Math.abs(me.#yDiff) > 10;\r\n            if (isMoving) clearTimeout(me.#delay);\r\n        }\r\n\r\n        me.#xDiff = me.#xDown - xUp;\r\n        me.#yDiff = me.#yDown - yUp;\r\n\r\n        // Most significant.\r\n        const isHorisontal = Math.abs(me.#xDiff) > Math.abs(me.#yDiff);\r\n\r\n        let name = '';\r\n        if (isHorisontal) {\r\n            name = me.#xDiff > 0 ? 'swipe-left' : 'swipe-right';\r\n        } else {\r\n            name = me.#yDiff > 0 ? 'swipe-up' : 'swipe-down';\r\n        }\r\n\r\n        GSEvents.send(me.#element, name, evt);\r\n\r\n        // Reset values.\r\n        me.#xDown = null;\r\n        me.#yDown = null;\r\n    }\r\n\r\n    #onLongPress() {\r\n        GSEvents.send(me.#element, 'long-press');\r\n    }\r\n\r\n    /**\r\n     * Return number of fingers used in touch event\r\n     * @param {Event} e \r\n     * @returns {Number}\r\n     */\r\n    static fingers(e) {\r\n        return e.detail.touches?.length;\r\n    }\r\n\r\n    /**\r\n     * Attach swipe event to a element\r\n     * @param {HTMLElement} element \r\n     * @returns {GSGesture}\r\n     */\r\n    static attach(element, swipe = true, tap = false, longPress = false) {\r\n        return new GSGesture(element, swipe, tap, longPress);\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSAttr } from \"./GSAttr.mjs\";\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\n\r\n/**\r\n * A module loading GSItem class\r\n * @module base/GSItem\r\n */\r\n\r\n/**\r\n * Static class for handling generic configurable tag GS-ITEM\r\n */\r\nexport class GSItem extends HTMLElement {\r\n\r\n\tstatic #tags = ['GS-ITEM', 'TEMPLATE']\r\n\r\n\tstatic properties = {\r\n\t\tactive: { type: Boolean },\r\n\t\tdisabled: { type: Boolean },\r\n\t\tselected: { type: Boolean },\r\n\t\tautofocus: { type: Boolean },\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tGSItem.validate(this);\r\n\t}\r\n\r\n\t/**\r\n\t * Return template content of GS-ITEM element (if exists)\r\n\t * \r\n\t * @param {HTMLElement} el \r\n\t * @returns {String}\r\n\t */\r\n\tget body() {\r\n\t\tlet tpl = GSAttr.get(this, 'template');\r\n\t\tif (tpl) return `<gs-template flat src=\"${tpl}\"></gs-template>`;\r\n\t\ttpl = this.querySelector('template');\r\n\t\treturn tpl?.innerHTML || '';\r\n\t}\r\n\r\n\t/**\r\n\t * Get first level of generic gs-item elements\r\n\t * @param {HTMLElement} root \r\n\t * @returns {Array<HTMLElement>} \r\n\t */\r\n\tget items() {\r\n\t\treturn Array.from(this.children).filter(el => el.tagName == 'GS-ITEM')\r\n\t}\r\n\r\n\tget name() {\r\n\t\treturn GSAttr.get(this, 'name', '');\r\n\t}\r\n\r\n\t/**\r\n\t * Get parent GS-* component\r\n\t */\r\n\tget parentComponent() {\r\n\t\treturn GSDOM.parentAll(this).filter(x => x instanceof GSElement).next()?.value;\r\n\t}\r\n\t\t\r\n\tasJSON(recursive = true) {\r\n\t\treturn GSDOM.toJson(this, recursive);\r\n\t}\r\n\r\n\t/**\r\n\t * Validate that parent element contains only specific childrens\r\n\t * @param {*} own \r\n\t * @param {*} tagName \r\n\t * @returns \r\n\t */\r\n\tstatic validate(own, tagName = 'GS-ITEM') {\r\n\t\treturn GSDOM.validate(own, tagName, GSItem.#tags);\r\n\t}\r\n\r\n\t/**\r\n\t * Get first level of generic gs-item element, used for configuring gs-* components\r\n\t * @param {HTMLElement} root \r\n\t * @returns {Array<HTMLElement>} \r\n\t */\r\n\tstatic collect(root) {\r\n\t\tif (!GSDOM.isHTMLElement(root)) return [];\r\n\t\treturn Array.from(root.children).filter(el => el.tagName == 'GS-ITEM')\r\n\t}\r\n\t\t\r\n\t/**\r\n\t * Convert GS-ITEM list to JSON\r\n\t * @param {HTMLElement} root Element containing GS-ITEM childs \r\n\t * @returns {Array} Arary of JSON objects\r\n\t */\r\n\tstatic toJSON(root) {\r\n\t\treturn GSItem.collect(root).map(el => el.asJSON(true));\r\n\t}\r\n\r\n\t/**\r\n\t * Make GS-ITEM attributes JSON compatible \r\n\t * @param {*} root \r\n\t * @param {*} definition \r\n\t * @returns \r\n\t */\r\n    static proxify(root, definition) {        \r\n        return GSItem.collect(root).map(el => GSAttr.proxify(el, definition));\r\n    }\r\n\r\n\tstatic {\r\n\t\tcustomElements.define('gs-item', GSItem);\r\n\t\tObject.seal(GSItem);\r\n\t}\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\nimport { GSID } from './GSID.mjs';\r\nimport { GSLoader } from './GSLoader.mjs';\r\nimport { GSPromise } from './GSPromise.mjs';\r\nimport { GSEvents } from './GSEvents.mjs';\r\nimport { GSUtil } from './GSUtil.mjs';\r\n\r\n/**\r\n * A module loading GSLocalization class\r\n * @module base/GSLocalization\r\n */\r\n\r\nconst GS_LOCALIZATION_LANGUAGE = globalThis.GS_LOCALIZATION_LANGUAGE || document.documentElement.lang || navigator.language;\r\n\r\n/**\r\n * Generic text translation engine.\r\n * Each JSON langauge file is of 2 files format \r\n * default.json  {'UI text', 'KEY_NAME'}\r\n * language.json {$language$: 'langauge_name', KEY_NAME : 'translation text'}\r\n * @class\r\n */\r\nclass GSLocalizationImpl {\r\n\r\n    #languages = new Map();\r\n    #queue = new Set();\r\n    #queued = false;\r\n\r\n    #url = globalThis.GS_LOCALIZATION_URL;\r\n    #default = GS_LOCALIZATION_LANGUAGE;\r\n    #language;\r\n\r\n    constructor() {\r\n        this.load();\r\n    }\r\n\r\n    /**\r\n     * Default page langugae, use page language, or browser languge if value not set\r\n     */\r\n    get default() {\r\n        return this.#default;\r\n    }\r\n\r\n    set default(val = '') {\r\n        this.#default = val || GS_LOCALIZATION_LANGUAGE;\r\n    }\r\n\r\n    /**\r\n     * Language to which to translate\r\n     */\r\n    get lang() {\r\n        return this.#language || this.default;\r\n    }\r\n\r\n    set lang(val = '') {\r\n        this.#language = val;\r\n    }\r\n\r\n    /**\r\n     * URL from where to load JSON translation documents\r\n     */\r\n    get url() {\r\n        return this.#url;\r\n    }\r\n\r\n    set url(val = '') {\r\n        this.#url = val || globalThis.GS_LOCALIZATION_URL;\r\n    }\r\n\r\n    translate(language = '', value = '') {\r\n        const me = this;\r\n        if (GSUtil.isStringEmpty(language)) return value;\r\n        if (!me.#languages.has(language)) {\r\n            me.load(language);\r\n            return value;\r\n        }\r\n        const deft = me.#getLanguage('default');\r\n        const lang = me.#getLanguage(language);\r\n        const texthash = deft.get(GSID.hashCode(value));\r\n        return texthash ? lang.get(texthash) || value : value;\r\n    }\r\n\r\n    reset() {\r\n        const me = this;\r\n        me.#default = GS_LOCALIZATION_LANGUAGE;\r\n        me.#language = undefined;\r\n        me.load();\r\n    }\r\n\r\n    load(language = 'default') {\r\n        const me = this;\r\n        if (GSUtil.isStringEmpty(language)) return;\r\n        if (GSUtil.isStringEmpty(me.url)) return;\r\n        if (me.#languages.has(language)) return;\r\n        me.#queue.add(language);\r\n        if (me.#queued) return;\r\n        me.#queued = true;\r\n        queueMicrotask(async () => {\r\n            const promises = Array.from(me.#queue.values()).map(l => me.loadWait(l));\r\n            await GSPromise.sequential(promises);\r\n            me.#queued = false;\r\n        });\r\n\r\n    }\r\n\r\n    async loadWait(language) {\r\n        const me = this;\r\n        if (GSUtil.isStringEmpty(language)) return;\r\n        if (GSUtil.isStringEmpty(me.url)) return;\r\n        const headers = {\r\n            'Cache-Control': 'no-cache',\r\n            'Pragma': 'no-cache'\r\n        };\r\n        const url = GSLoader.normalizeURL(`${me.url}/${language}.json`);\r\n        let res = await GSLoader.loadSafe(url, 'GET', headers, true);\r\n        if (!res && language.indexOf('-') > 0) res = await me.loadWait(language.split('-')[0]);\r\n        if (!res) return false;\r\n        me.#queue.delete(language);\r\n        me.#store(language, res);\r\n    }\r\n\r\n    /**\r\n     * Store object properties as set of key-value pairs,\r\n     * keys are not stores as name, but as hash calc\r\n     * values double stored as a hash-key/value and hash-value/hash-key\r\n     * \r\n     * @param {string} lang \r\n     * @param {object} obj \r\n     * @returns \r\n     */\r\n    #store(lang, obj) {\r\n        if (!(obj && lang)) return false;\r\n        const isDefault = lang === 'default';\r\n        const map = this.#getLanguage(lang);\r\n        Object.entries(obj).forEach((kv) => {\r\n            const hk = GSID.hashCode(kv[0].trim());\r\n            map.set(hk, isDefault ? GSID.hashCode(kv[1]) : kv[1]);\r\n        });\r\n        GSEvents.send(window, 'gs-language', { details: lang });\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Get language map. Create a new one if not found.\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    #getLanguage(val = '') {\r\n        const me = this;\r\n        if (!me.#languages.has(val)) {\r\n            me.#languages.set(val, new Map());\r\n        }\r\n        return me.#languages.get(val);\r\n    }\r\n\r\n}\r\n\r\nexport const GSLocalization = new GSLocalizationImpl();","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSPopper class\r\n * @module base/GSPopper\r\n */\r\n\r\nimport { GSLog } from \"./GSLog.mjs\";\r\nimport { GSCSSMap } from \"./GSCSSMap.mjs\";\r\nimport { GSDynamicStyle } from \"./GSDynamicStyle.mjs\";\r\n\r\n/**\r\n * A generic set of static functions used across GS WebComponents framework\r\n * used for placing elements at fixed positions.\r\n * Also used to replace Bootstrap popper.\r\n * @class\r\n */\r\nexport class GSPopper {\r\n\r\n\t/**\r\n\t * A simple wrapper to get element DOMRect\r\n\t * @param {HTMLElement} el \r\n\t * @returns {DOMRect}\r\n\t */\r\n\tstatic asRect(el) {\r\n\t\treturn el.getBoundingClientRect();\r\n\t}\r\n\r\n\t/**\r\n\t * Get element offset position\r\n\t * Returns absolute position {left:0, top:0, width:0, height:0,centeY:0 centerX:0}\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Object} \r\n\t */\r\n\tstatic getOffset(el) {\r\n\t\tconst rect = GSPopper.asRect(el);\r\n\t\tconst sx = window.scrollX;\r\n\t\tconst sy = window.scrollY;\r\n\t\tconst obj = {\r\n\t\t\tleft: rect.left + sx,\r\n\t\t\tright: rect.right + sx,\r\n\t\t\ttop: rect.top + sy,\r\n\t\t\tbottom: rect.bottom + sy,\r\n\t\t\theight: rect.height,\r\n\t\t\twidth: rect.width,\r\n\t\t\tx: rect.x + sx,\r\n\t\t\ty: rect.y + sy\r\n\t\t};\r\n\t\tobj.centerX = obj.left + (obj.width / 2);\r\n\t\tobj.centerY = obj.top + (obj.height / 2);\r\n\t\treturn obj;\r\n\t}\r\n\r\n\t/**\r\n\t * Return element position and size without padding\r\n\t * Returned objext is the same format as native getBoundingRect\r\n\t * @param {HTMLElement} element \r\n\t * @returns {Object} \r\n\t */\r\n\tstatic boundingRect(element, calcPadding) {\r\n\r\n\t\tconst rect = GSPopper.asRect(element);\r\n\t\tconst padding = GSPopper.elementPadding(calcPadding ? element : null);\r\n\r\n\t\tconst paddingX = padding.x;\r\n\t\tconst paddingY = padding.y;\r\n\r\n\t\tconst elementWidth = element.clientWidth - paddingX;\r\n\t\tconst elementHeight = element.clientHeight - paddingY;\r\n\r\n\t\tconst elementX = rect.left + padding.left;\r\n\t\tconst elementY = rect.top + padding.top;\r\n\r\n\t\tconst centerX = (elementWidth / 2) + elementX;\r\n\t\tconst centerY = elementY + (elementHeight / 2);\r\n\r\n\t\treturn {\r\n\t\t\twidth: elementWidth,\r\n\t\t\theight: elementHeight,\r\n\t\t\ttop: elementY,\r\n\t\t\tleft: elementX,\r\n\t\t\tx: elementX,\r\n\t\t\ty: elementY,\r\n\t\t\tcenterX: centerX,\r\n\t\t\tcenterY: centerY\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * Calculate element padding\r\n\t * @param {HTMLElement} element \r\n\t * @returns {Object}\r\n\t */\r\n\tstatic elementPadding(element) {\r\n\r\n\t\tconst obj = {\r\n\t\t\tleft: 0,\r\n\t\t\tright: 0,\r\n\t\t\ttop: 0,\r\n\t\t\tbottom: 0,\r\n\t\t\tx: 0,\r\n\t\t\ty: 0\r\n\t\t};\r\n\r\n\t\tconst isEl = element instanceof HTMLElement;\r\n\t\tif (!isEl) return obj;\r\n\t\tconst css = GSCSSMap.getComputedStyledMap(element);\r\n\r\n\t\tobj.left = css.asNum('padding-left');\r\n\t\tobj.right = css.asNum('padding-right');\r\n\t\tobj.top = css.asNum('padding-top');\r\n\t\tobj.bottom = css.asNum('padding-bottom');\r\n\t\tobj.x = obj.left + obj.right;\r\n\t\tobj.y = obj.top + obj.bottom;\r\n\r\n\t\treturn obj;\r\n\t}\r\n\r\n\t/**\r\n\t * Fixed positioning on a viewport.\r\n\t * @param {String} placement Location on target element top|bottom|left|right\r\n\t * @param {HTMLElement} source Element to show\r\n\t * @param {HTMLElement} target Element location at which to show\r\n\t * @param {Boolean} arrow if true, will calculate arrow position\r\n\t * @returns {void}\r\n\t */\r\n\tstatic popupFixed(placement = 'top', source, target, arrow) {\r\n\r\n\t\tif (!(source && target)) return false;\r\n\r\n\t\tconst pos = GSPopper.#fromPlacement(placement);\r\n\r\n\t\tif (!GSPopper.#isPlacementValid(pos)) {\r\n\t\t\tGSLog.warn(source, `Invalid popover position: ${placement}!`);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst style = GSDynamicStyle.dynamicStyle(source);\r\n\t\tif (!style) return;\r\n\r\n\t\tconst css = {\r\n\t\t\tposition: 'fixed',\r\n\t\t\ttop: '0px',\r\n\t\t\tleft: '0px',\r\n\t\t\tmargin: '0px',\r\n\t\t\tpadding: '0px',\r\n\t\t\ttransform: '',\r\n\t\t\ttranslate: ''\r\n\t\t};\r\n\r\n\t\tObject.assign(style, css);\r\n\r\n\t\tconst offh = source.clientHeight / 2;\r\n\t\tconst offw = source.clientWidth / 2;\r\n\r\n\t\tconst rect = GSPopper.boundingRect(target, arrow instanceof HTMLElement);\r\n\t\tconst arect = GSPopper.#updateArrow(source, arrow, pos);\r\n\r\n\t\tconst obj = {\r\n\t\t\tx: rect.centerX,\r\n\t\t\ty: rect.centerY,\r\n\t\t\toffH: offh,\r\n\t\t\toffW: offw,\r\n\t\t\tsrcH: source.clientHeight,\r\n\t\t\tsrcW: source.clientWidth\r\n\t\t}\r\n\r\n\t\tGSPopper.#calcFixed(pos, obj, rect, arect);\r\n\t\tstyle.translate = `${obj.x}px ${obj.y}px`;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Place element around target element. Bootstrap support for popup etc.\r\n\t * @param {String} placement Location on target element top|bottom|left|right\r\n\t * @param {HTMLElement} source Element to show\r\n\t * @param {HTMLElement} target Element location at which to show\r\n\t * @param {Boolean} arrow if true, will calculate arrow position\r\n\t * @returns {void}\r\n\t */\r\n\tstatic popupAbsolute(placement = 'top', source, target, arrow) {\r\n\r\n\t\tif (!(source && target)) return false;\r\n\r\n\t\tconst pos = GSPopper.#fromPlacement(placement);\r\n\r\n\t\tif (!GSPopper.#isPlacementValid(pos)) {\r\n\t\t\tGSLog.warn(source, `Invalid popover position: ${placement}!`);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst style = GSDynamicStyle.dynamicStyle(source);\r\n\t\tconst astyle = GSDynamicStyle.dynamicStyle(arrow);\r\n\t\tif (!style) return;\r\n\t\t\r\n\t\tconst css = {\r\n\t\t\tinset: GSPopper.#inset(pos),\r\n\t\t\tposition: 'absolute',\r\n\t\t\tmargin: '0px',\r\n\t\t\ttop: '0px',\r\n\t\t\tleft: '0px',\r\n\t\t\twidth: 'max-content',\r\n\t\t\theight: 'max-content',\t\t\t\r\n\t\t\ttransform: '',\r\n\t\t\ttranslate: ''\r\n\t\t};\r\n\r\n\t\tObject.assign(style, css);\r\n\t\tastyle.position = 'absolute';\r\n\r\n\t\tconst srect = GSPopper.asRect(source);\r\n\t\tconst arect = GSPopper.asRect(arrow);\r\n\t\tconst offset = GSPopper.getOffset(target);\r\n\r\n\t\tconst obj = {\r\n\t\t\tx: offset.centerX,\r\n\t\t\ty: offset.centerY\r\n\t\t}\r\n\r\n\t\tconst arr = {\r\n\t\t\tx: (srect.width / 2) - (arect.width / 2),\r\n\t\t\ty: (srect.height / 2) - (arect.height / 2)\r\n\t\t}\r\n\r\n\t\tGSPopper.#calcAbsolute(pos, obj, arr, srect, arect, offset);\r\n\r\n\t\tconst aopt = {\r\n\t\t\ttranslate: `${arr.x}px ${arr.y}px`,\r\n\t\t\ttop: arr.top ? arr.top : '',\r\n\t\t\tleft: arr.left ? arr.left : ''\r\n\t\t}\r\n\r\n\t\tconst opt = {\r\n\t\t\ttranslate : `${obj.x}px ${obj.y}px`\r\n\t\t};\r\n\r\n\t\tObject.assign(style, opt);\r\n\t\tObject.assign(astyle, aopt);\r\n\t}\r\n\r\n\tstatic #calcAbsolute(pos, obj, arr, srect, arect, offset) {\r\n\t\tif (pos.isTop) {\r\n\t\t\tarr.y = 0;\r\n\t\t\tarr.left = '0px';\r\n\t\t\tobj.x = obj.x - (srect.width / 2);\r\n\t\t\tobj.y = -1 * (srect.bottom - offset.top + arect.height);\r\n\t\t} else if (pos.isBottom) {\r\n\t\t\tarr.y = 0;\r\n\t\t\tarr.left = '0px';\r\n\t\t\tobj.x = obj.x - (srect.width / 2);\r\n\t\t\tobj.y = offset.bottom + arect.height;\r\n\t\t} else if (pos.isStart) {\r\n\t\t\tarr.x = 0;\r\n\t\t\tarr.top = '0px';\r\n\t\t\tobj.x = -1 * (srect.right - offset.left + arect.width);\r\n\t\t\tobj.y = obj.y - (srect.height / 2);\r\n\t\t} else if (pos.isEnd) {\r\n\t\t\tarr.x = 0;\r\n\t\t\tarr.top = '0px';\r\n\t\t\tobj.x = offset.right + arect.width;\r\n\t\t\tobj.y = obj.y - (srect.height / 2);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic #calcFixed(pos, obj, trect, arect) {\r\n\t\tif (pos.isTop) {\r\n\t\t\tobj.y = trect.top - obj.srcH - arect.size;\r\n\t\t\tobj.x = obj.x - obj.offW;\r\n\t\t} else if (pos.isBottom) {\r\n\t\t\tobj.y = trect.top + trect.height + arect.size;\r\n\t\t\tobj.x = obj.x - obj.offW;\r\n\t\t} else if (pos.isStart) {\r\n\t\t\tobj.x = trect.left - obj.srcW - arect.size;\r\n\t\t\tobj.y = obj.y - obj.offH + arect.size;\r\n\t\t} else if (pos.isEnd) {\r\n\t\t\tobj.x = trect.left + trect.width + arect.size;\r\n\t\t\tobj.y = obj.y - obj.offH + arect.size;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic #inset(obj) {\r\n\t\tif (obj.isTop) {\r\n\t\t\treturn 'auto auto 0px 0px';\r\n\t\t} else if (obj.isBottom) {\r\n\t\t\treturn '0px auto auto 0px';\r\n\t\t} else if (obj.isStart) {\r\n\t\t\treturn '0px 0px auto auto';\r\n\t\t} else if (obj.isEnd) {\r\n\t\t\treturn '0px auto auto 0px';\r\n\t\t}\r\n\t}\r\n\r\n\tstatic #isPlacementValid(obj) {\r\n\t\treturn obj.isStart || obj.isEnd || obj.isTop || obj.isBottom;\r\n\t}\r\n\r\n\tstatic #fromPlacement(placement) {\r\n\t\treturn {\r\n\t\t\tisStart: placement == 'start' || placement == 'left',\r\n\t\t\tisEnd: placement == 'end' || placement == 'right',\r\n\t\t\tisTop: placement == 'top',\r\n\t\t\tisBottom: placement == 'bottom'\r\n\t\t}\r\n\t}\r\n\r\n\tstatic #updateArrow(element, arrow, pos) {\r\n\r\n\t\tif (!arrow) return { x: 0, y: 0, size: 0, width: 0, height: 0 };\r\n\r\n\t\tlet shift = 0;\r\n\t\tconst erect = GSPopper.boundingRect(element);\r\n\t\tconst arect = GSPopper.boundingRect(arrow);\r\n\r\n\t\tconst size = pos.isStart || pos.isEnd ? arect.width : arect.height;\r\n\r\n\t\tconst arrowPosW = (erect.width / 2) - (size / 2);\r\n\t\tconst arrowPosH = (erect.height / 2) - (size / 2);\r\n\r\n\t\tarect.size = size;\r\n\r\n\t\tconst opt = {};\r\n\r\n\t\topt.position = 'absolute';\r\n\r\n\t\tif (pos.isStart || pos.isEnd) {\r\n\t\t\topt.left = '';\r\n\t\t\topt.top = '0px';\r\n\t\t\tshift = 0; //pos.isStart ? size : -1 * size;\r\n\t\t\topt.translate = `${shift}px ${arrowPosH / 2}px`;\r\n\t\t} else {\r\n\t\t\topt.top = '';\r\n\t\t\topt.left = '0px';\r\n\t\t\tshift = 0; //pos.isTop ? size : -1 * size;\r\n\t\t\topt.translate = `${arrowPosW}px ${shift}px`;\r\n\t\t}\r\n\r\n\t\tGSDynamicStyle.applyDynamicStyle(arrow, opt);\r\n\r\n\t\treturn arect;\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.seal(GSPopper);\r\n\t\tglobalThis.GSPopper = GSPopper;\r\n\t}\r\n}\r\n\r\n\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSCSSMap } from \"./GSCSSMap.mjs\";\r\n\r\n/**\r\n * Proxy class to handle chained css.\r\n * Used internally, see GSQuery class.\r\n */\r\nexport class GSQueryCSS {\r\n\r\n    #map = null;\r\n\r\n    constructor(element) {\r\n        if (!GSDOM.isHTMLElement(element)) throw new Error('Only HTMLElement type allowed!');\r\n        this.#map = new GSCSSMap(element);\r\n    }\r\n\r\n    #isFunc(property) {\r\n        return GSFunction.hasFunction(this.#map, property);\r\n    }\r\n\r\n    get(object, property, receiver) {\r\n        return (value, dft) => {\r\n            const me = this;\r\n            if (GSUtil.isNull(value)) return me.#map.get(property);\r\n            if (me.#isFunc(property)) return me.#map[property](value, dft);\r\n            object[property] = value;\r\n            return receiver;\r\n        }\r\n    }\r\n\r\n    static wrap(element) {\r\n        return new Proxy(element.style, new GSQueryCSS(element));\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSQueryCSS } from \"./GSQueryCSS.mjs\";\r\n\r\n/**\r\n * Proxy class for wrapping HTMLElement, allowing to use GS query across shadow dom\r\n * and css operations for easier property get /set\r\n * \r\n * const el = GSQuery.wrap(document.body);\r\n * el.query('div') // query across shadow dom\r\n * el.css = {width:'100px'} // easier way to set css\r\n * \r\n * // chained css property setup\r\n * el.css.width('100px').background('red')\r\n * \r\n * // retrieve calculated value\r\n * console.log(el.css.background)\r\n * console.log(el.css.asNum('width'))\r\n */\r\nexport class GSQuery {\r\n\r\n    #css = null;\r\n\r\n    constructor(element) {\r\n        if (!Array.isArray(element)) this.#css = GSQueryCSS.wrap(element);\r\n    }\r\n\r\n    get(object, property) {\r\n        if (property === 'css') return this.#css;\r\n        if (property === 'query') {\r\n            return (value, all, shadow) => {\r\n                const el = GSDOM.query(object, value, all, shadow);\r\n                return GSQuery.wrap(el);\r\n            }\r\n        }\r\n        if (property === 'queryAll') {\r\n            return (value, all, shadow) => {\r\n                const el = GSDOM.queryAll(object, value, all, shadow);\r\n                return GSQuery.wrap(el);\r\n            }\r\n        }\r\n        return object[property];\r\n    }\r\n\r\n    set(object, property, value) {\r\n        switch (property) {\r\n            case 'css':\r\n                if (Array.isArray(object)) {\r\n                    object.forEach(element => element[property] = value);\r\n                } else {\r\n                    GSDOM.css(object, value);\r\n                }\r\n                break;\r\n            default:\r\n                object[property] = value;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    static instance(node) {\r\n        return new Proxy(node, new GSQuery(node));\r\n    }\r\n\r\n    static wrap(node) {\r\n        if (GSDOM.isHTMLElement(node)) return GSQuery.instance(node);\r\n        if (!Array.isArray(node)) return node;\r\n        node = node.map(element => GSQuery.wrap(element));\r\n        return GSQuery.instance(node);\r\n    }\r\n\r\n    static all(own, qry, all, shadow) {\r\n        return GSQuery.wrap(GSDOM.queryAll(own, qry, all, shadow));\r\n    }\r\n\r\n    static first(own, qry, all, shadow) {\r\n        return GSQuery.wrap(GSDOM.query(own, qry, all, shadow));\r\n    }\r\n\r\n    static {\r\n        Object.freeze(GSQuery);\r\n        globalThis.GSQuery = GSQuery;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSRouter class\r\n * @module base/GSRouter\r\n */\r\n\r\nimport { GSLog } from \"./GSLog.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSData } from \"./GSData.mjs\";\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSEvents } from \"./GSEvents.mjs\";\r\nimport { GSLoader } from \"./GSLoader.mjs\";\r\nimport { GSAttributeHandler } from \"./GSAttributeHandler.mjs\";\r\n\r\n/**\r\n * Class for handling hash based routing.\r\n * Class uses GSAttributeHandler and optional JSON definition to handle routing.\r\n * \r\n * Use globalThis.GS_ROUTER_URL before loading this module to define JSON definition file location\r\n * @Class\r\n */\r\nexport class GSRouter {\r\n\r\n    #owner = null;\r\n    #logging = true;\r\n    #enabled = false;\r\n    #hashCallback = null;\r\n    #cache = null;\r\n    #definition = {};\r\n\r\n    constructor(owner) {\r\n        const me = this;\r\n        me.#owner = owner;\r\n        me.#cache ??= new Map();\r\n        me.#hashCallback = me.#onHashChange.bind(me);\r\n    }\r\n\r\n    /**\r\n     * Loda JSON definition for routing from JSON document.\r\n     * @param {string} url \r\n     * @returns \r\n     */\r\n    async loadDefinition(url) {\r\n        return GSLoader.getRouter(url);\r\n    }\r\n\r\n    /**\r\n     * Initialize routing from provided URL\r\n     * @param {string} url \r\n     * @param {number} wait in ms\r\n     */\r\n    async initialize(url, wait = 0) {\r\n        const me = this;\r\n        me.#cache.clear();        \r\n        if (GSUtil.isStringNonEmpty(url)) {\r\n            me.#definition = await me.loadDefinition(url);\r\n        }\r\n        if (wait > 0) {\r\n            await GSEvents.waitPageLoad(null, null, null, wait);\r\n        }\r\n        me.enable();\r\n        me.#onHashChange();        \r\n    }\r\n\r\n    /**\r\n     * Enable routing\r\n     */\r\n    enable() {\r\n        if (this.#enabled) return;\r\n        GSEvents.on(globalThis, null, 'hashchange', this.#hashCallback);\r\n        this.#enabled = true;\r\n    }\r\n\r\n    /**\r\n     * Disable routing\r\n     */\r\n    disable() {\r\n        GSEvents.off(globalThis, null, 'hashchange', this.#hashCallback);\r\n        this.#enabled = false;\r\n    }\r\n\r\n    /**\r\n     * Register a single route with options\r\n     * @param {string} route Abstract url for a route\r\n     * @param {Object} options \r\n     */\r\n    register(route, options) {\r\n        this.#definition[route] = options;\r\n    }\r\n\r\n    /**\r\n     * Unregister a single route\r\n     * @param {string} route \r\n     */\r\n    unregister(route) {\r\n        delete this.#definition[route];\r\n    }\r\n\r\n    /**\r\n     * Get URL hashbang without hash\r\n     */\r\n    get hash() {\r\n        return location.hash.slice(1);\r\n    }\r\n\r\n    /**\r\n     * Return routing definition object\r\n     */\r\n    get definition() {\r\n        return GSData.deepClone(this.#definition);\r\n    }\r\n\r\n    get log() {\r\n        return this.#logging;\r\n    }\r\n\r\n    set log(val) {\r\n        this.#logging = GSUtil.asBool(val);\r\n    }\r\n\r\n    #onHashChange(e) {\r\n        const me = this;\r\n        const hash = me.hash;\r\n        let px = me.#cache.get(hash);\r\n        if (!px) {   \r\n            px = me.#proxify();         \r\n            if (px) me.#cache.set(hash, px);\r\n        }\r\n        // 1. 31.07.2025.\r\n        // GSAttributeHandler.process(px);\r\n        px?.handle(e);\r\n    }\r\n\r\n    #proxify() {\r\n        let px = undefined;\r\n        const me = this;\r\n        const hash = me.hash;\r\n        const def = me.#definition[\"#def\"] || {};\r\n        const defaults = me.#definition[\"#defaults\"] || {};\r\n        const route = me.#definition[hash];\r\n        if (route) {\r\n            const el = GSDOM.fromJson(Object.assign({}, route, def, defaults));\r\n            el.dataset.gsHashed = true;\r\n            // 1. 31.07.2025.\r\n            //px = GSAttributeHandler.proxify(el);\r\n            px = new GSAttributeHandler(el, me.#owner);\r\n        } else if (me.#logging) {\r\n            GSLog.warn(null, `No routing definition found for: ${hash}`);\r\n        }\r\n        return px;\r\n    }\r\n\r\n    static {\r\n        if (globalThis.GS_DEFINITION_URL) {\r\n            new GSRouter().initialize(globalThis.GS_DEFINITION_URL, globalThis.GS_ROUTER_WAIT);\r\n        }\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSTheme class\r\n * @module base/GSTheme\r\n */\r\n\r\n/**\r\n * Switch between dark and light mode\r\n * @Class\r\n */\r\nexport class GSTheme {\r\n\r\n    static #STORAGE = 'gs-theme-mode';\r\n\r\n    /**\r\n     * Changes the theme to 'dark mode' and save settings to local stroage.\r\n     * Basically, replaces/toggles every CSS class that has '-light' class with '-dark'\r\n     * @param {HTMLElement} el \r\n     */\r\n    static darkMode(el) {\r\n        GSTheme.#switch(el, 'light', 'dark');\r\n    }\r\n\r\n    /**\r\n     * Changes the theme to 'light mode' and save settings to local stroage.\r\n     * @param {HTMLElement} el \r\n     */\r\n    static lightMode(el) {\r\n        GSTheme.#switch(el, 'dark', 'light');\r\n    }\r\n\r\n    static #switch(el, from = 'light', to = 'dark') {\r\n\r\n        const root = el || document.body;\r\n\r\n        // TODO  switch dark/light mode ?!??!? \r\n\r\n        // save last state\r\n        GSTheme.theme = to;\r\n    }\r\n\r\n    static get theme() {\r\n        return localStorage.getItem(GSTheme.#STORAGE);\r\n    }\r\n\r\n    static set theme(val) {\r\n        localStorage.setItem(GSTheme.#STORAGE, val);\r\n        window.dispatchEvent(new CustomEvent('gs-theme', { detail: val }));\r\n        const htmlEl = document.head.parentElement;\r\n        if (val) {\r\n            htmlEl.dataset.bsTheme = val;\r\n        } else {\r\n            delete htmlEl.dataset.bsTheme;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get system default theme by media query\r\n     * @returns {String} dark|light \r\n     */\r\n    static getSystemDefaultTheme() {\r\n        const darkThemeMq = window.matchMedia('(prefers-color-scheme: dark)');\r\n        return darkThemeMq.matches ? 'dark' : 'light';\r\n    }\r\n\r\n    static #onTheme(e) {\r\n        const q = new URLSearchParams(location.hash.slice(1));\r\n        GSTheme.theme = q.get('theme');\r\n    }\r\n\r\n    static #setup() {\r\n        window.addEventListener('hashchange', GSTheme.#onTheme)\r\n        let settings = localStorage.getItem(GSTheme.#STORAGE);\r\n        if (settings == null) {\r\n            settings = GSTheme.getSystemDefaultTheme();\r\n        }\r\n\r\n\r\n        if (settings == 'dark') return GSTheme.darkMode();\r\n        if (settings == 'light') return GSTheme.lightMode();\r\n        // TODO switch\r\n\r\n    }\r\n\r\n    static {\r\n        GSTheme.#setup();\r\n        globalThis.GSTheme = GSTheme;\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/*\r\nconst tree = new BinaryTree(1, 'AB');\r\n\r\ntree.insert(1, 11, 'AC');\r\ntree.insert(1, 12, 'BC');\r\ntree.insert(12, 121, 'BG', { right: true });\r\n\r\n[...tree.preOrderTraversal()].map(x => x.value);\r\n// ['AB', 'AC', 'BC', 'BCG']\r\n\r\n[...tree.inOrderTraversal()].map(x => x.value);\r\n// ['AC', 'AB', 'BC', 'BG']\r\n\r\ntree.value;                // 'AB'\r\ntree.hasChildren;          // true\r\n\r\ntree.find(12).isLeaf;           // false\r\ntree.find(121).isLeaf;          // true\r\ntree.find(121).parent.value;    // 'BC'\r\ntree.find(12).left;             // null\r\ntree.find(12).right.value;      // 'BG'\r\n\r\ntree.remove(12);\r\n\r\n[...tree.postOrderTraversal()].map(x => x.value);\r\n// ['AC', 'AB']\r\n*/\r\n\r\n/**\r\n * Binary Tree Node data holder\r\n */\r\nexport class BinaryTreeNode {\r\n\r\n    constructor(key, value = key, parent = null) {\r\n        this.key = key;\r\n        this.value = value;\r\n        this.parent = parent;\r\n        this.left = null;\r\n        this.right = null;\r\n    }\r\n\r\n    /**\r\n     * Check if both left and right are empty.\r\n     */\r\n    get isLeaf() {\r\n        return this.left === null && this.right === null;\r\n    }\r\n\r\n    /**\r\n     * Check if node has children\r\n     */\r\n    get hasChildren() {\r\n        return !this.isLeaf;\r\n    }\r\n\r\n    /**\r\n     * Check if node is main root node \r\n     */\r\n    get isRoot() {\r\n        return this.parent ? false : true;\r\n    }\r\n\r\n    /**\r\n     * Get main root node\r\n     */\r\n    get root() {\r\n        return this.parent?.root || this;\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * Binary tree implementation\r\n */\r\nexport class BinaryTree extends BinaryTreeNode {\r\n\r\n    constructor(key, value = key) {\r\n        super(key, value);\r\n    }\r\n\r\n    /**\r\n     * Generator method that traverses the binary tree in in-order, \r\n     * using the yield* syntax to recursively delegate traversal to itself.\r\n     * @param {BinaryTreeNode} node \r\n     */\r\n    *inOrderTraversal(node = this) {\r\n        if (node.left) yield* this.inOrderTraversal(node.left);\r\n        yield node;\r\n        if (node.right) yield* this.inOrderTraversal(node.right);\r\n    }\r\n\r\n    /**\r\n     * Generator method that traverses the binary tree in post-order, \r\n     * using the yield* syntax to recursively delegate traversal to itself.\r\n     * @param {BinaryTreeNode} node \r\n     */\r\n    *postOrderTraversal(node = this) {\r\n        if (node.left) yield* this.postOrderTraversal(node.left);\r\n        if (node.right) yield* this.postOrderTraversal(node.right);\r\n        yield node;\r\n    }\r\n\r\n    /**\r\n     * Generator method that traverses the binary tree in pre-order, \r\n     * using the yield* syntax to recursively delegate traversal to itself.\r\n     * @param {BinaryTreeNode} node \r\n     */\r\n    *preOrderTraversal(node = this) {\r\n        yield node;\r\n        if (node.left) yield* this.preOrderTraversal(node.left);\r\n        if (node.right) yield* this.preOrderTraversal(node.right);\r\n    }\r\n\r\n    /**\r\n     * Uses the preOrderTraversal() method to find the given parent node and \r\n     * insert a new child BinaryTreeNode either as the left or right child, \r\n     * depending on the passed options object.\r\n     * @param {*} parentNodeKey \r\n     * @param {*} key \r\n     * @param {*} value \r\n     * @param {*} options \r\n     * @returns {boolean} Return true if data inserted\r\n     */\r\n    insert(\r\n        parentNodeKey,\r\n        key,\r\n        value = key,\r\n        { left, right } = { left: true, right: true }\r\n    ) {\r\n        for (let node of this.preOrderTraversal()) {\r\n            if (node.key === parentNodeKey) {\r\n                const canInsertLeft = left && node.left === null;\r\n                const canInsertRight = right && node.right === null;\r\n                if (!canInsertLeft && !canInsertRight) return false;\r\n                if (canInsertLeft) {\r\n                    node.left = new BinaryTreeNode(key, value, node);\r\n                    return true;\r\n                }\r\n                if (canInsertRight) {\r\n                    node.right = new BinaryTreeNode(key, value, node);\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Uses the preOrderTraversal() method to remove a BinaryTreeNode from the binary tree.\r\n     * @param {*} key \r\n     * @returns \r\n     */\r\n    remove(key) {\r\n        for (let node of this.preOrderTraversal()) {\r\n            if (node.left.key === key) {\r\n                node.left = null;\r\n                return true;\r\n            }\r\n            if (node.right.key === key) {\r\n                node.right = null;\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Uses the preOrderTraversal() method to retrieve the given node in the binary tree.\r\n     * @param {*} key \r\n     * @returns \r\n     */\r\n    find(key) {\r\n        for (let node of this.preOrderTraversal()) {\r\n            if (node.key === key) return node;\r\n        }\r\n        return undefined;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/*\r\nconst list = new DoublyLinkedList();\r\n\r\nlist.insertFirst(1);\r\nlist.insertFirst(2);\r\nlist.insertFirst(3);\r\nlist.insertLast(4);\r\nlist.insertAt(3, 5);\r\n\r\nlist.size;                      // 5\r\nlist.head.value;                // 3\r\nlist.head.next.value;           // 2\r\nlist.tail.value;                // 4\r\nlist.tail.previous.value;       // 5\r\n[...list].map(e => e.value);    // [3, 2, 1, 5, 4]\r\n\r\nlist.removeAt(1);               // 2\r\nlist.getAt(1).value;            // 1\r\nlist.head.next.value;           // 1\r\n[...list].map(e => e.value);    // [3, 1, 5, 4]\r\n\r\nlist.reverse();\r\n[...list].map(e => e.value);    // [4, 5, 1, 3]\r\n\r\nlist.clear();\r\nlist.size;                      // 0\r\n*/\r\n\r\n/**\r\n *  Linear data structure following doubly linked list order of operations.\r\n */\r\nexport class Node {\r\n\r\n    value = null;\r\n    next = null;\r\n    previous = null;\r\n\r\n    constructor(value, next = null, previous = null) {\r\n        this.value = value;\r\n        this.next = next;\r\n        this.previous = previous;\r\n    }\r\n\r\n    /**\r\n     * Use internally only or make sure node is deatached\r\n     */\r\n    release() {\r\n        this.value = undefined;\r\n        this.next = undefined;\r\n        this.previous = undefined;\r\n    }\r\n\r\n    toJSON() {\r\n        return this.value;\r\n    }\r\n}\r\n\r\nexport class DoublyLinkedList {\r\n\r\n    #nodes = [];\r\n\r\n    /**\r\n     * Number of elements in the list\r\n     */\r\n    get size() {\r\n        return this.#nodes.length;\r\n    }\r\n\r\n    /**\r\n     * First element in the list\r\n     */\r\n    get head() {\r\n        return this.size ? this.#nodes[0] : null;\r\n    }\r\n\r\n    /**\r\n     * Last elemet in the list\r\n     */\r\n    get tail() {\r\n        return this.size ? this.#nodes[this.size - 1] : null;\r\n    }\r\n\r\n    /**\r\n     * Create new linked node\r\n     * @param {*} value \r\n     * @param {*} nextNode \r\n     * @param {*} previousNode \r\n     * @returns \r\n     */\r\n    create(value, nextNode, previousNode) {\r\n        return new Node(value, nextNode, previousNode);\r\n    }\r\n\r\n    /**\r\n     * Insert data to the given position in the list\r\n     * @param {*} index \r\n     * @param {*} value \r\n     * @param {*} safe \r\n     * @returns \r\n     */\r\n    insertAt(index, value, safe) {\r\n        if (!this.#validate(index, safe)) return false;\r\n\r\n        const previousNode = this.#nodes[index - 1] || null;\r\n        const nextNode = this.#nodes[index] || null;\r\n        const node = this.create(value, nextNode, previousNode);\r\n\r\n        if (previousNode) previousNode.next = node;\r\n        if (nextNode) nextNode.previous = node;\r\n        this.#nodes.splice(index, 0, node);\r\n    }\r\n\r\n    /**\r\n     * Insert data to the beginning of the list\r\n     * @param {*} value \r\n     */\r\n    insertFirst(value) {\r\n        this.insertAt(0, value);\r\n    }\r\n\r\n    /**\r\n     * Insert data to the end of the list\r\n     * @param {*} value \r\n     */\r\n    insertLast(value) {\r\n        this.insertAt(this.size, value);\r\n    }\r\n\r\n    /**\r\n     * Retrieves the data in the given index\r\n     * @param {Number} index \r\n     * @returns \r\n     */\r\n    getAt(index) {\r\n        return this.#nodes[index];\r\n    }\r\n\r\n    indexOf(val) {\r\n        return this.#nodes.indexOf(val);\r\n    }\r\n\r\n    /**\r\n     * Remove the data at the given index\r\n     * @param {*} index \r\n     * @param {*} safe \r\n     * @returns \r\n     */\r\n    removeAt(index, safe) {\r\n\r\n        if (!this.#validate(index, safe)) return false;\r\n\r\n        const previousNode = this.#nodes[index - 1] || null;\r\n        const nextNode = this.#nodes[index + 1] || null;\r\n\r\n        if (previousNode) previousNode.next = nextNode;\r\n        if (nextNode) nextNode.previous = previousNode;\r\n\r\n        return this.#nodes.splice(index, 1);\r\n    }\r\n\r\n    /**\r\n     * Clear list\r\n     */\r\n    clear(full = true) {\r\n        if (full) this.#nodes.forEach(o => o.release());\r\n        this.#nodes = [];\r\n    }\r\n\r\n    /**\r\n     * Reverse data order\r\n     */\r\n    reverse() {\r\n        this.#nodes = this.#nodes.reduce((acc, { value }) => {\r\n            const nextNode = acc[0] || null;\r\n            const node = new Node(value, nextNode, null);\r\n            if (nextNode) nextNode.previous = node;\r\n            return [node, ...acc];\r\n        }, []);\r\n    }\r\n\r\n    toArray() {\r\n        return this.#nodes.map(e => e.value);\r\n    }\r\n\r\n    toJSON() {\r\n        return this.#nodes;\r\n    }\r\n\r\n    *[Symbol.iterator]() {\r\n        yield* this.#nodes;\r\n    }\r\n\r\n    #validate(index, safe = false) {\r\n        const isInvalid = this.#isInvalidIndex(index);\r\n        if (isInvalid) {\r\n            if (safe) {\r\n                console.log(this.#error());\r\n            } else {\r\n                throw new Error(this.#error());\r\n            }\r\n        }\r\n        return !isInvalid;\r\n    }\r\n\r\n    #isInvalidIndex(index) {\r\n        return !Number.isInteger(index) || index < 0 || index > this.size;\r\n    }\r\n\r\n    #error() {\r\n        return `Invalid index. Current length is ${this.size}.`;\r\n    }\r\n\r\n    /**\r\n     * Convert array to linked list\r\n     * @param {*} data \r\n     * @returns \r\n     */\r\n    static from(data) {\r\n        const list = new DoublyLinkedList();\r\n        if (Array.isArray(data)) data.forEach(v => list.insertLast(v));\r\n        return list;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { NEXT, PREV } from '../base/GSConst.mjs';\r\n\r\n/*\r\nconst list = new LinkedList(1);\r\nlist.append(2).append(3).append(4);\r\n*/\r\n\r\n/**\r\n * Node data holder\r\n */\r\nexport class LinkedList {\r\n\r\n    #value = null;\r\n    #next = null;\r\n    #previous = null;\r\n\r\n    constructor(value) {\r\n        this.#value = value;\r\n    }\r\n\r\n    [NEXT](val) {\r\n        this.#next = val;\r\n    }\r\n\r\n    [PREV](val) {\r\n        this.#previous = val;\r\n    }\r\n\r\n    remove() {\r\n        const me = this;\r\n        me.#previous?.[NEXT](me.#next);\r\n        me.#next?.[PREV](me.#previous);\r\n        return me.#release();\r\n    }\r\n\r\n    delete() {\r\n        return this.remove();\r\n    }\r\n    \r\n    /**\r\n     * Append node after \r\n     * @param {*} node \r\n     */\r\n    append(node) {\r\n\r\n        node = LinkedList.wrap(node);\r\n        node.#next = this.#next;\r\n        node.#previous = this;\r\n        this.#next = node;\r\n        return node;\r\n    }\r\n\r\n    add(node) {\r\n        return this.append(node);\r\n    }\r\n\r\n    /**\r\n     * Insert node before\r\n     * @param {*} node \r\n     */\r\n    insert(node) {\r\n        node = LinkedList.wrap(node);\r\n        node.#previous = this.#previous;\r\n        node.#next = this;\r\n        this.#previous = node;\r\n        return node;\r\n    }\r\n\r\n    update(val) {\r\n        this.#value = val;\r\n        return this;\r\n    }\r\n\r\n    find(cb) {\r\n        return this.iterator.find(cb);\r\n    }\r\n\r\n    filter(cb) {\r\n        return this.iterator.filter(cb);\r\n    }\r\n\r\n    map(cb) {\r\n        return this.iterator.map(cb);\r\n    }\r\n\r\n    forEach(cb) {\r\n        for (let n of this.iterator) {\r\n            cb(n, -1, this);\r\n        }\r\n    }\r\n    \r\n    every(cb) {\r\n        let result = undefined;\r\n        for (let n of this.iterator) {\r\n            result = cb(n, -1, this);\r\n            if (result) break;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    toArray(values = true) {\r\n        return values ? this.asValues : this.asNodes;\r\n    }\r\n\r\n    toJSON() {\r\n        return this.value;\r\n    }\r\n\r\n    /**\r\n     * Use internally only or make sure node is deatached\r\n     */\r\n    #release() {\r\n        this.#value = undefined;\r\n        this.#next = undefined;\r\n        this.#previous = undefined;\r\n        return this;\r\n    }\r\n        \r\n    get head() {\r\n        return this.previous?.head || this;\r\n    }\r\n\r\n    get tail() {\r\n        return this.next?.tail || this;\r\n    }\r\n\r\n    get next() {\r\n        return this.#next;\r\n    }\r\n\r\n    get previous() {\r\n        return this.#previous;\r\n    }\r\n\r\n    get value() {\r\n        return this.#value;\r\n    }\r\n\r\n    set value(val) {\r\n        this.#value = val;\r\n    }    \r\n\r\n    get asValues() {\r\n        return [...this].map(v => v.value);\r\n    }\r\n\r\n    get asNodes() {\r\n        return [...this];\r\n    }\r\n    \r\n    get iterator() {\r\n        return this[Symbol.iterator]();\r\n    }\r\n\r\n    *[Symbol.iterator]() {\r\n        yield this;\r\n        if (this.#next) yield* this.#next.iterator;        \r\n    }\r\n\r\n    static wrap(node) {\r\n        return node instanceof LinkedList ? node : new LinkedList(node);\r\n    }\r\n    \r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n *  Linear data structure following last in, first out (LIFO) order of operations.\r\n */\r\nexport class Stack extends Array {\r\n    \r\n    push(item) {\r\n        this.unshift(item);\r\n    }\r\n\r\n    pop() {\r\n        return this.shift();\r\n    }\r\n\r\n    peek() {\r\n        return this[0];\r\n    }\r\n\r\n    isEmpty() {\r\n        return this.length === 0;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n *  Linear data structure following first in, first out (FIFO) order of operations.\r\n */\r\nexport class Queue extends Array {\r\n    \r\n    enqueue(item) {\r\n        this.push(item);\r\n    }\r\n\r\n    dequeue() {\r\n        return this.shift();\r\n    }\r\n\r\n    peek() {\r\n        return this[0];\r\n    }\r\n\r\n    isEmpty() {\r\n        return this.length === 0;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Tree Node data holder\r\n */\r\nexport class Tree {\r\n\r\n    value;\r\n\r\n    #key = null;\r\n    #parent = null;\r\n    #children;\r\n\r\n    #folder = false;\r\n    #level = 0;\r\n\r\n    constructor(key, value = key, parent = null, level = 0) {\r\n        this.#key = key;\r\n        this.#parent = parent;\r\n        this.#folder = value?.leaf === false;\r\n        this.#level = parent ? parent.level + 1 : level;\r\n        this.#children = this.#folder ? [] : undefined;\r\n        this.value = value;\r\n    }\r\n\r\n    /**\r\n     * Return tree list from root to this node.\r\n     */\r\n    get subtree() {\r\n        return Array.from(this.up(undefined, false, true, true));\r\n    }\r\n\r\n    get levelID() {\r\n        return this.subtree.map(o => o.level).join('.');\r\n    }\r\n\r\n    /**\r\n     * Unique node canonical form\r\n     */\r\n    get nodeID() {\r\n        //if (this.parent?.level < 0) return this.index;\r\n        return this.subtree.map(o => o.index).join('.');\r\n    }\r\n\r\n    get path() {\r\n        return this.subtree.map(o => o.key).join('/');\r\n    }\r\n\r\n    get index() {\r\n        return this.parent?.nodes.indexOf(this) || 0;\r\n    }\r\n\r\n    get size() {\r\n        return this.#children?.length || -1;\r\n    }\r\n\r\n    get level() {\r\n        return this.#level;\r\n    }\r\n\r\n    /**\r\n     * Check if node is main root node \r\n     */\r\n    get isRoot() {\r\n        return this.parent ? false : true;\r\n    }\r\n\r\n    /**\r\n     * Check if #children is empty\r\n     */\r\n    get isLeaf() {\r\n        return !this.#folder;\r\n    }\r\n\r\n    get isFolder() {\r\n        return this.#folder;\r\n    }\r\n\r\n    /**\r\n     * Check if has #childrens\r\n     */\r\n    get hasChildren() {\r\n        return this.#folder && this.size > 0;\r\n    }\r\n\r\n    /**\r\n     * Get parent node, readonly\r\n     */\r\n    get key() {\r\n        this.#key ??= this.nodeID;\r\n        return this.#key;\r\n    }\r\n\r\n    get nodes() {\r\n        return this.#children;\r\n    }\r\n\r\n    /**\r\n     * Get parent node, readonly\r\n     */\r\n    get parent() {\r\n        return this.#parent;\r\n    }\r\n\r\n    /**\r\n     * Get main root node\r\n     */\r\n    get root() {\r\n        return this.parent?.root || this;\r\n    }\r\n\r\n    /**\r\n     * Check if there are more siblings \r\n     */\r\n    get hasMore() {\r\n        return this.#parent?.size > this.index + 1;\r\n    }\r\n\r\n    get firstChild() {\r\n        return this.hasMore ? this.#children[0] : undefined;\r\n    }\r\n\r\n    get lastChild() {\r\n        return this.hasMore ? this.#children[this.#children.length - 1] : undefined;\r\n    }\r\n\r\n    get next() {\r\n        return this.down(this, false, false).next().value || this.nextSibling || this.parent?.nextSibling;\r\n    }\r\n\r\n    get previous() {\r\n        const node = this.previousSibling;\r\n        return (node?.hasChildren) ? node.lastChild : node || this.up(this, false, false).next().value;\r\n    }\r\n\r\n    get nextSibling() {\r\n        return this.hasMore ? this.#parent.#children[this.index + 1] : undefined;\r\n    }\r\n\r\n    get previousSibling() {\r\n        return this.index > 0 ? this.#parent.#children[this.index - 1] : undefined;\r\n    }\r\n\r\n    /**\r\n     * Clear all #children\r\n     */\r\n    clear() {\r\n        if (this.#children) {\r\n            this.#children.forEach(o => o.release?.());\r\n            this.#children = [];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Used internally, if called externally, \r\n     * make sure node is removed from parent \r\n     */\r\n    release() {\r\n        this.clear();\r\n        this.#key = null;\r\n        this.value = null;\r\n        this.#parent = null;\r\n    }\r\n\r\n    /**\r\n     * Walk down the tree\r\n     * @param {Tree} node starting node\r\n     * @param {Boolean} values yield values instead nodes\r\n     * @param {Boolean} inclusive include self\r\n     * @param {Boolean} reverse Order direction\r\n     * @param {Boolean} flat Navigate all nodes out of subtree\r\n     */\r\n    *down(node = this, values = false, inclusive = true, reverse = false, flat = false) {\r\n        const o = values ? node.value : node;\r\n        if (inclusive && !reverse && node.level > -1) yield o;\r\n        if (node.#children?.length) {\r\n            for (let child of node.#children) {\r\n                yield* this.down(child, values, true, reverse, flat);\r\n            }\r\n        }\r\n        if (flat) {\r\n            const item = node.nextSibling || node.parent.nextSibling;\r\n            if (item) yield* this.down(item, values, true, reverse, flat);\r\n        }\r\n        /*\r\n        */\r\n        if (inclusive && reverse && node.level > -1) yield o;\r\n    }\r\n\r\n    /**\r\n     * Walk up the tree\r\n     * @param {Tree} node starting node\r\n     * @param {Boolean} values yield values instead nodes\r\n     * @param {Boolean} inclusive include self\r\n     * @param {Boolean} reverse Order direction\r\n     */\r\n    *up(node = this, values = false, inclusive = true, reverse = false, flat = false) {\r\n        const o = values ? node.value : node;\r\n        if (inclusive && !reverse && node.level > -1) yield o;\r\n        if (flat) {\r\n            let item = node.previousSibling;\r\n            item = item?.isFolder ? item.lastChild : item;\r\n            if (item) yield* this.up(item, values, true, reverse, flat);\r\n        }        \r\n        if (node.parent) {\r\n            yield* this.up(node.parent, values, true, reverse, flat);\r\n        }\r\n        if (inclusive && reverse && node.level > -1) yield o;\r\n    }\r\n\r\n    /**\r\n     * Walk through all nodes\r\n     * @param {*} node \r\n     */\r\n    walk = this.down;\r\n\r\n    /**\r\n     * Simulate array function \"forEach\"\r\n     * @param {*} callback \r\n     * @param {*} flat If set, will iterate all nodes, otherwise only cildrens and subtrees\r\n     * @param {*} reverse If set, will iterate up the tree\r\n     * @returns \r\n     */\r\n    forEach(callback, flat = false, reverse = false) {\r\n        this.every((node, index) => {\r\n            callback(node, index);\r\n            return true;\r\n        }, flat, reverse);\r\n    }\r\n\r\n    /**\r\n     * Simulate array function \"every\"\r\n     * @param {*} callback \r\n     * @param {*} flat If set, will iterate all nodes, otherwise only cildrens and subtrees\r\n     * @param {*} reverse If set, will iterate up the tree\r\n     * @returns \r\n     */    \r\n    every(callback, flat = false, reverse = false) {\r\n        const it = this.iterate(flat, reverse);\r\n        let sts = true;\r\n        let i = 0;\r\n        for (let node of it) {\r\n            sts = callback(node, i++);\r\n            if (!sts) break;\r\n        }\r\n        return sts;\r\n    }\r\n\r\n    /**\r\n     * Simulate array function \"find\"\r\n     * @param {*} callback \r\n     * @param {*} flat If set, will iterate all nodes, otherwise only cildrens and subtrees\r\n     * @param {*} reverse If set, will iterate up the tree\r\n     * @returns \r\n     */    \r\n    find(callback, flat = false, reverse = false) {\r\n        const it = this.iterate(flat, reverse);\r\n        let i = 0;\r\n        for (let node of it) {\r\n            if (callback(node, i++)) return node;\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    /**\r\n     * Simulate array function \"filter\"\r\n     * @param {*} callback \r\n     * @param {*} flat If set, will iterate all nodes, otherwise only childrens and subtrees\r\n     * @param {*} reverse If set, will iterate up the tree\r\n     * @returns \r\n     */    \r\n    filter(callback, flat, reverse) {\r\n        return [...this.#filtered(callback, flat, reverse)];\r\n    }\r\n\r\n    *#filtered(callback, flat, reverse) {\r\n        const it = this.iterate(flat, reverse);\r\n        for (let node of it) {\r\n            let res = callback(node);\r\n            if (res) yield node;\r\n        }        \r\n    }\r\n\r\n    /**\r\n     * Iterate all nodes\r\n     * @param {boolean} flat If set, will iterate all nodes, otherwise only cildrens and subtrees\r\n     * @param {boolean} reverse If set, will iterate up the tree\r\n     */\r\n    *iterate(flat, reverse) {\r\n        reverse ? yield* this.up(this, false, false, false, flat) : yield* this.down(this, false, false,  false, flat);\r\n    }\r\n\r\n    /**\r\n     * Add a new Tree to the tree.\r\n     * @param {*} key \r\n     * @param {*} value \r\n     * @returns \r\n     */\r\n    append(key, value = key) {\r\n        let newOne = undefined;\r\n        if (key instanceof Tree) {\r\n            key.#parent = this;\r\n            key.#level = this.#level + 1;\r\n            newOne = key;\r\n        } else {\r\n            newOne = new Tree(key, value, this);\r\n        }\r\n        this.#folder = true;\r\n        this.#children ??= [];\r\n        this.#children.push(newOne);\r\n        return newOne;\r\n    }\r\n\r\n    /**\r\n     * Uses the walk() method and Array.prototype.push() \r\n     * to add a new Tree to the tree.\r\n     * @param {*} parentNodeKey \r\n     * @param {*} key \r\n     * @param {*} value \r\n     * @returns \r\n     */\r\n    insert(parentNodeKey, key, value = key) {\r\n        for (let node of this.walk()) {\r\n            if (node.key === parentNodeKey) {\r\n                const newOne = new Tree(key, value, node);\r\n                this.#folder = true;\r\n                this.#children ??= [];\r\n                node.#children.push(newOne);\r\n                return newOne;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Remove node from tree. If key is set, will search for first node with matching key.\r\n     * @param {*} key \r\n     * @returns \r\n     */\r\n    remove(key) {\r\n\r\n        const me = this;\r\n\r\n        if (key) {\r\n            const node = me.findByKey(key);\r\n            node?.remove();\r\n            return node;\r\n        }\r\n\r\n        if (me.isRoot) throw new Error('Root node can\\'t be removed!');\r\n        const node = me.parent;\r\n        const filtered = node.#children.filter(c => c !== me);\r\n        if (filtered.length !== node.#children.length) {\r\n            node.#children = filtered;\r\n            return me;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Uses the walk() method to retrieve the given node in the tree.\r\n     * @param {*} key \r\n     * @returns \r\n     */\r\n    findByKey(key) {\r\n        for (let node of this.walk()) {\r\n            if (node.key === key) return node;\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    /**\r\n     * Convert tree into array list\r\n     * @returns \r\n     */\r\n    flatten(values, inclusive, reverse) {\r\n        return [...this.down(this, values, inclusive, reverse)];\r\n    }\r\n\r\n    /**\r\n     * Load JSON data into tree\r\n     * @param {*} data \r\n     */\r\n    fromJSON(data) {\r\n        if (data) Tree.from(this, data);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Used by JSON.stringify to properly export as JSON\r\n     * @returns \r\n     */\r\n    toJSON() {\r\n        if (this.level < 0) return this.#children?.map(o => o.toJSON()) || {};\r\n        return this.isLeaf ? { key: this.key, value: this.value } :\r\n            {\r\n                key: this.key,\r\n                value: this.value,\r\n                items: this.#children.map(o => o.toJSON())\r\n            };\r\n    }\r\n\r\n    /**\r\n     * Make node iterable\r\n     */\r\n    *[Symbol.iterator]() {\r\n        yield* this.down();\r\n    }\r\n\r\n    /**\r\n     * Convert JSON tree into Linked Tree \r\n     * @param {*} data \r\n     * @returns \r\n     */\r\n    static from(parent, data) {\r\n        const raw = data || parent;\r\n        const hasParent = parent instanceof Tree;\r\n        if (Array.isArray(raw)) {\r\n            if (!hasParent) throw new Error('Parent required when data is array');\r\n            raw.forEach(o => Tree.from(parent, o));\r\n            return parent;\r\n        }\r\n        const { items, ...obj } = raw;\r\n        const tree = new Tree(obj.key, obj, data ? parent : undefined);\r\n        if (hasParent) parent.append(tree);\r\n        if (items) Tree.from(tree, items);\r\n        return tree;\r\n    }\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\n\r\n/**\r\n * A module loading GSAbstractReadWrite class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Generic Class for data read/write for various components such as grid/form/dynamic menu etc.\r\n * @Class\r\n */\r\nexport class DataSelector  {\r\n\r\n    static #SELECT = Symbol('select');\r\n\r\n    /**\r\n     * Store selected record ID\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    static addSelected(val) {\r\n        if (!val) return false;\r\n\r\n        if (Array.isArray(val)) {\r\n            val[DataSelector.#SELECT] = true;\r\n        } else {\r\n            GSUtil.asArray(val).forEach(o => o[DataSelector.#SELECT] = true);\r\n        }\r\n        return val;\r\n    }\r\n\r\n    /**\r\n     * Remove selected record ID\r\n     * @param {*} val \r\n     */\r\n    static removeSelected(val) {\r\n        if (!val) return false;\r\n        delete val[DataSelector.#SELECT];\r\n        return val;\r\n    }\r\n\r\n    /**\r\n     * Remove all selections\r\n     */\r\n    static clearSelected(data) {\r\n        const me = this;\r\n        GSUtil.asArray(data).forEach(o => me.removeSelected(o));\r\n    }\r\n\r\n    /**\r\n     * Return list of all selected record id's\r\n     */\r\n    static getSelected(data = []) {\r\n        const me = this;        \r\n        return me.isSelected(data) || GSUtil.asArray(data).filter(o => me.isSelected(o));\r\n    }\r\n\r\n    /**\r\n     * Check if record id is in list of selected records\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    static isSelected(val) {\r\n        return val ? val[DataSelector.#SELECT] === true : false;\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSEvent } from \"../base/GSEvent.mjs\";\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\n\r\n/**\r\n * A module loading GSReadWriteRegistry class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Global registry for GSAbstractReadWrite instances - data read/write \r\n * @Class\r\n */\r\nclass GSReadWriteRegistryImpl extends GSEvent {\r\n\r\n    static #instance = null;\r\n    static #INTERNAL = Symbol();\r\n\r\n    #handlers = new Map();\r\n\r\n    #map = new Map();\r\n\r\n    constructor(key) {\r\n        if (key != GSReadWriteRegistryImpl.#INTERNAL) throw new Error('Creating new instance not allowed.');\r\n        super();\r\n    }\r\n\r\n    /**\r\n     * Register data handler\r\n     * @param {string} type unique handler name\r\n     * @param {GSReadWriteRegistry} clazz \r\n     */\r\n    addHandler(type, clazz) {        \r\n        this.#handlers.set(type, clazz);\r\n    }\r\n\r\n    /**\r\n     * Unregister data handler\r\n     * @param {string} type unique handler name\r\n     */\r\n    removeHandler(type) {        \r\n        this.#handlers.delete(type);\r\n    }\r\n\r\n    /**\r\n     * Get registered handler by name\r\n     * @param {string} type unique handler name\r\n     */    \r\n    getHandler(type) {\r\n        return this.#handlers.get(type);\r\n    }\r\n\r\n    /**\r\n     * Initialize data handler instance\r\n     * @param {string} type unique handler name\r\n     * @param {string} name unique instance name\r\n     * @param {GSReadWriteRegistry} clazz \r\n     */    \r\n    newHandler(type, name, enabled) {\r\n        const clazz = this.getHandler(type);\r\n        return clazz ? new clazz(name, enabled) : undefined;\r\n    }\r\n\r\n    /**\r\n     * Register GSAbstractReadWrite instance or inherited classes\r\n     * @param {GSAbstractReadWrite} obj \r\n     */\r\n    register(obj) {\r\n        const me = this;\r\n        me.#verify(obj);\r\n        const cache = me.find(obj.id);\r\n        if (cache == obj) return;\r\n        if (cache) throw new Error(`Key (${obj.id}) already exist in read/write registry!`);\r\n        me.#map.set(obj.id, obj);\r\n        me.emit(`register-${obj.id}`, obj);\r\n        me.emit(`register`, obj);\r\n    }\r\n\r\n    /**\r\n     * Unregister GSAbstractReadWrite instance or inherited classes\r\n     * @param {GSAbstractReadWrite} obj \r\n     * @returns {boolean} Deletion status\r\n     */\r\n    unregister(obj) {\r\n        const me = this;\r\n        if (GSUtil.isString(obj)) obj = me.find(obj);\r\n        me.#verify(obj);\r\n        const sts = me.#map.delete(obj.id);\r\n        if (sts) {\r\n            me.emit(`unregister-${obj.id}`, obj);\r\n            me.emit(`unregister`, obj);\r\n        }\r\n        return sts;\r\n    }\r\n\r\n    /**\r\n     * Find registered handler\r\n     * @param {string} val \r\n     * @returns \r\n     */\r\n    find(val) {\r\n        return this.#map.get(val);\r\n    }\r\n\r\n    /**\r\n     * Wait for specific habdler to be either registered or unregistered\r\n     * @param {string} id \r\n     * @param {number|AbortSignal} signal Cancelation in timeout or provided signal\r\n     * @param {boolean} register Listen for register or unregister\r\n     * @returns \r\n     */\r\n    async wait(id = '', signal, register = true) {\r\n        if (!id) throw new Error('GSReadWrite ID not valid.');\r\n        const me = this;\r\n        if (register) {\r\n            const rw = me.find(id);\r\n            if (rw) return rw;\r\n        }\r\n        const type = register ? 'register' : 'unregister';\r\n        await super.wait(`${type}-${id}`, signal);\r\n        return me.find(id);\r\n    }\r\n\r\n    /**\r\n     * Reset the registry\r\n     */\r\n    resetRegistry() {\r\n        this.#handlers.clear();\r\n        this.#map.clear();\r\n    }\r\n\r\n    #verify(obj) {\r\n        //if (!(obj instanceof GSAbstractReadWrite)) throw new Error('Invalid parameter type.');\r\n    }\r\n\r\n    static get #self() {\r\n        if (!GSReadWriteRegistryImpl.#instance) GSReadWriteRegistryImpl.#instance = new GSReadWriteRegistryImpl(GSReadWriteRegistryImpl.#INTERNAL);\r\n        return GSReadWriteRegistryImpl.#instance;\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSReadWriteRegistryImpl);\r\n        globalThis.GSReadWriteRegistry = GSReadWriteRegistryImpl.#self;\r\n    }\r\n\r\n}\r\n\r\nexport const GSReadWriteRegistry = globalThis.GSReadWriteRegistry;\r\n\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSID } from \"../base/GSID.mjs\";\r\nimport { GSEvent } from \"../base/GSEvent.mjs\";\r\nimport { GSReadWriteRegistry } from \"./ReadWriteRegistry.mjs\";\r\nimport { DataSelector } from \"./DataSelector.mjs\";\r\n\r\n/**\r\n * A module loading GSAbstractReadWrite class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Generic Class for data read/write for various components such as grid/form/dynamic menu etc.\r\n * @Class\r\n */\r\nexport class GSAbstractReadWrite extends GSEvent {\r\n\r\n    static #SELECT = Symbol('select');\r\n\r\n    #id = null;\r\n    #processors = null;\r\n\r\n    constructor(name, enabled = true) {\r\n        super();\r\n        const me = this;\r\n        me.#id = name || GSID.next();\r\n        if (enabled) me.enable();\r\n    }\r\n\r\n    /**\r\n     * Data preprocessor to register\r\n     * @param {object} processor\r\n     */\r\n    addProcessor(processor) {\r\n        if (!processor) return;\r\n        this.#processors ??= new Set();\r\n        this.#processors.add(processor);\r\n    }\r\n\r\n    /**\r\n     * Data preprocessor to remove\r\n     * @param {object} processor \r\n     */    \r\n    removeProcessor(processor) {\r\n        if (processor) this.#processors?.delete(processor);\r\n    }\r\n\r\n    /**\r\n     * Unique data handler name\r\n     * @returns {string} \r\n     */\r\n    get id() {\r\n        return this.#id;\r\n    }\r\n\r\n    /**\r\n     * Register into global data handler registry\r\n     */\r\n    enable() {\r\n        const me = this;\r\n        GSReadWriteRegistry.register(me);\r\n        me.emit('enabled');\r\n    }\r\n\r\n    /**\r\n     * Unregister from global data handler registry\r\n     */\r\n    disable() {\r\n        const me = this;\r\n        GSReadWriteRegistry.unregister(me);\r\n        me.emit('disabled');\r\n    }\r\n\r\n    /**\r\n     * Check if data handler is registered in global registry\r\n     * @returns {boolean}\r\n     */\r\n    get isRegistered() {\r\n        return GSReadWriteRegistry.find(this.id) ? true : false;\r\n    }\r\n\r\n    /**\r\n     * Generic event dispatcher, can be overriden to controll when to fire event\r\n     * @param {*} owner \r\n     * @param {*} type \r\n     * @param {*} data \r\n     * @param {*} error \r\n     */\r\n    notify(owner, type, data, error) {\r\n        this.emit(error ? 'error' : type, { type: type, error: error, owner: owner, data: data }, true);\r\n    }\r\n\r\n    /**\r\n     * Initiate data read from remote\r\n     * @param {HTMLElement} owner \r\n     * @returns {Array|Object} JSON data response\r\n     */\r\n    async read(owner) {\r\n        const me = this;\r\n        let data = null;\r\n        try {\r\n            data = await me.onRead(owner);\r\n            me.#processors?.forEach(c => c.postRead?.(data));\r\n            if (data) me.notify(owner, 'read', data);\r\n        } catch (e) {\r\n            me.notify(owner, 'read', data, e);\r\n            throw e;\r\n        }\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * Initiate data write to remote\r\n     * @param {HTMLElement} owner \r\n     * @returns {Array|Object} JSON data response\r\n     */\r\n    async write(owner, data) {\r\n        const me = this;\r\n        let result = null;\r\n        try {\r\n            result = await me.onWrite(owner, data);\r\n            me.#processors?.forEach(c => c.postWrite?.(data));\r\n            if (result) me.notify(owner, 'write', data);\r\n        } catch (e) {\r\n            me.notify(owner, 'write', data, e);\r\n            throw e;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Override in inherited class to implement read logic\r\n     * @param {} owner \r\n     * @returns \r\n     */\r\n    async onRead(owner) {\r\n        throw new Error('Extend base GSAbstractReadWrite to implement read operation');\r\n    }\r\n\r\n    /**\r\n     * Store selected record ID\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    addSelected(val) {\r\n        if (!val) return false;\r\n        DataSelector.addSelected(val);\r\n        const me = this;\r\n        me.emit('selection-add', val);\r\n        me.emit('select');\r\n        return val;\r\n    }\r\n\r\n    /**\r\n     * Remove selected record ID\r\n     * @param {*} val \r\n     */\r\n    removeSelected(val) {\r\n        if (!val) return false;\r\n        DataSelector.removeSelected(val);\r\n        const me = this;\r\n        me.emit('selection-remove', val);\r\n        me.emit('select');\r\n        return val;\r\n    }\r\n\r\n    /**\r\n     * Remove all selections\r\n     */\r\n    clearSelected(data) {\r\n        DataSelector.clearSelected(data);\r\n        const me = this;\r\n        me.emit('selection-clear');\r\n        me.emit('select');\r\n    }\r\n\r\n    /**\r\n     * Return list of all selected record id's\r\n     */\r\n    getSelected(data = []) {\r\n        return DataSelector.getSelected(data);\r\n    }\r\n\r\n    /**\r\n     * Check if record id is in list of selected records\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    isSelected(val) {\r\n        return DataSelector.isSelected(val);\r\n    }\r\n\r\n    /**\r\n     * Get list of selected records.\r\n     * Override in inherited class\r\n     */\r\n    get selected() {\r\n        return [];\r\n    }\r\n\r\n    /**\r\n     * Override in inherited class to implement write logic\r\n     * @param {} owner \r\n     * @param {} data\r\n     * @returns \r\n     */\r\n    async onWrite(owner, data) {\r\n        throw new Error('Extend base GSAbstractReadWrite to implement write operation');\r\n    }\r\n\r\n    /**\r\n     * Reset the abstract read/write handler\r\n     */\r\n    reset() {\r\n        this.#processors = null;\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSFunction } from \"../base/GSFunction.mjs\";\r\nimport { GSLoader } from \"../base/GSLoader.mjs\";\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\nimport { GSAbstractReadWrite } from \"./AbstractReadWrite.mjs\";\r\nimport { GSReadWriteRegistry } from \"./ReadWriteRegistry.mjs\";\r\n\r\n/**\r\n * A module loading GSReadWrite class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Generic Class for QUERY/REST data read/write for various components such as grid/form/dynamic menu etc.\r\n * Also, Green Screens Quark Engine or external functions are supported.\r\n * If mode=\"\", instance is used as local reader. \r\n * Use events to detect read/write requests or manually populate using this.setData([...]) \r\n * @Class\r\n */\r\nexport class GSReadWrite extends GSAbstractReadWrite {\r\n\r\n    static #TYPE = \"remote\";\r\n\r\n    static #MODES = ['', 'rest', 'query', 'quark'];\r\n    static #METHOD = ['GET', 'PUT', 'POST', 'DELETE'];\r\n\r\n    #src = '';\r\n    #headers = {};\r\n    #reader = 'GET';\r\n    #writer = 'POST';\r\n    #action = '';\r\n    #mode = '';\r\n\r\n    #key = null;\r\n\r\n    #skip = 0;\r\n    #limit = 0;\r\n\r\n    #sort = [];\r\n    #filter = [];\r\n\r\n    /**\r\n     * Instance constructor\r\n     * @param {string} name Unique handler name\r\n     * @param {boolean} enabled Automatically register in global registry. \r\n     */\r\n    constructor(name, enabled) {\r\n        super(name, enabled);\r\n    }\r\n\r\n    /**\r\n     * Handler type\r\n     */\r\n    get type() {\r\n        return GSReadWrite.#TYPE;\r\n    }\r\n\r\n    /**\r\n     * Handler operational mode\r\n     * rest, query, quark \r\n     * @returns {string} Operational mode\r\n     */\r\n    get mode() {\r\n        return GSUtil.normalize(this.#mode);\r\n    }\r\n\r\n    /**\r\n     * Handler operational mode\r\n     * Values: '', query, rest, quark\r\n     * @var {String} \r\n     */\r\n    set mode(val) {\r\n        const me = this;\r\n        val = GSUtil.normalize(val);\r\n        const isok = GSReadWrite.#MODES.includes(val);\r\n        if (!isok) throw new Error(null, `Invalid mode, allowed: ${GSReadWrite.#MODES}`);\r\n        if (me.#mode === 'quark' && me.#mode != val) {\r\n            me.#reader = 'GET';\r\n            me.#writer = 'POST';\r\n        }\r\n        return this.#mode = val;\r\n    }\r\n\r\n    /**\r\n     * HTTP method for reader (query/rest)\r\n     * @returns {string} Values GET,POST,PUT\r\n     */\r\n    get reader() {\r\n        return this.#reader;\r\n    }\r\n\r\n    /**\r\n     * HTTP method for reader (query/rest)\r\n     * Values GET,POST,PUT\r\n     * @var {String} \r\n     */\r\n    set reader(val) {\r\n        const me = this;\r\n        const isok = me.isQuark ? true : GSReadWrite.#METHOD.includes(val);\r\n        if (!isok) throw new Error(null, `Invalid method, allowed: ${GSReadWrite.#METHOD}`);\r\n        return me.#reader = val;\r\n    }\r\n\r\n    /**\r\n     * HTTP method for writer (query/rest)\r\n     * @returns {string} Values POST,PUT\r\n     */\r\n    get writer() {\r\n        return this.#writer;\r\n    }\r\n\r\n    /**\r\n     * HTTP method for writer (query/rest)\r\n     * Values POST,PUT\r\n     * @var {String} \r\n     */\r\n    set writer(val) {\r\n        const me = this;\r\n        const isok = me.isQuark ? true : GSReadWrite.#METHOD.includes(val);\r\n        if (!isok) throw new Error(null, `Invalid method, allowed: ${GSReadWrite.#METHOD}`);\r\n        return this.#writer = val;\r\n    }\r\n\r\n    /**\r\n     * Custom HTTP headers\r\n     * @returns {Object} Json structure\r\n     */\r\n    get headers() {\r\n        return { ...this.#headers };\r\n    }\r\n\r\n    /**\r\n     * Custom HTTP headersas String or Json structure\r\n     * @var {Object} \r\n     */\r\n    set headers(val = {}) {\r\n        val = GSUtil.toJson(val);\r\n        const me = this;\r\n        me.#headers = { ...val };\r\n    }\r\n\r\n    /**\r\n     * Record key field\r\n     */\r\n    get key() {\r\n        return this.#key;\r\n    }\r\n\r\n    /**\r\n     * Record key field\r\n     * @var {String} \r\n     */\r\n    set key(val) {\r\n        this.#key = val;\r\n    }\r\n\r\n    /**\r\n     * Base URL part\r\n     * @returns {string} \r\n     */\r\n    get src() {\r\n        return this.#src;\r\n    }\r\n\r\n    /**\r\n     * Base URL part\r\n     * @var {String} \r\n     */\r\n    set src(val = '') {\r\n        const me = this;\r\n        me.#src = val;\r\n    }\r\n\r\n    /**\r\n     * Number of records to return\r\n     * @returns {Number} \r\n     */\r\n    get limit() {\r\n        return this.#limit;\r\n    }\r\n\r\n    /**\r\n     * Number of records to return\r\n     * @var {Number} \r\n     */\r\n    set limit(val = 10) {\r\n        this.#limit = GSUtil.asNum(val, 10);\r\n    }\r\n\r\n    /**\r\n     * Number of records to skip\r\n     * @returns {Number} \r\n     */\r\n    get skip() {\r\n        return this.#skip;\r\n    }\r\n\r\n    /**\r\n     * Number of records to skip\r\n     * @var {Number} \r\n     */\r\n    set skip(val = 0) {\r\n        this.#skip = GSUtil.asNum(val, 0);\r\n    }\r\n\r\n    /**\r\n     * Filter data in format \r\n     * [{name: idx[num] || name[string], value: ''  , op:'eq'}]\r\n     * @returns {Array<Object>} \r\n     */\r\n    get filter() {\r\n        return this.#filter;\r\n    }\r\n\r\n    set filter(val) {\r\n        const me = this;\r\n        val = val || [];\r\n        val = GSUtil.isJson(val) ? GSUtil.toJson(val) : val;\r\n        me.#filter = Array.isArray(val) ? val : [val];\r\n    }\r\n\r\n    /**\r\n     * Sort data in format\r\n     * [{col: idx[num] || name[string]  , op: -1 | 1 }]\r\n     * @returns {Array<Object>} \r\n     */\r\n    get sort() {\r\n        return this.#sort;\r\n    }\r\n\r\n    set sort(val) {\r\n        const me = this;\r\n        val = val || [];\r\n        val = GSUtil.isJson(val) ? GSUtil.toJson(val) : val;\r\n        me.#sort = Array.isArray(val) ? val : [val];\r\n    }\r\n\r\n    /**\r\n     * Generated URL segment based on selected mode (query/rest)\r\n     * - quark - JSON path to CRUD object; ie. io.greenscreens.CRUD\r\n     * - rest - url rest format, ie. /${limit}/${skip}?sort=${sort}&filter=${filter}\r\n     * - query - url format, ie. ?limit=${limit}&skip=${skip}&sort=${sort}&filter=${filter}\r\n     * @returns {string} \r\n     */\r\n    get action() {\r\n        const me = this;\r\n        let def = '';\r\n        switch (me.mode) {\r\n            case 'query':\r\n                def = '?limit=${limit}&skip=${skip}&sort=${sort}&filter=${filter}';\r\n                break;\r\n            case 'rest':\r\n                def = '/${limit}/${skip}?sort=${sort}&filter=${filter}';\r\n                break;\r\n        }\r\n        return me.#action || def;\r\n    }\r\n\r\n    /**\r\n     * Set custom URL segment to be attached to based 'src'.\r\n     * Format depends on mode[query|rest]\r\n     * @var {String}\r\n     */\r\n    set action(val = '') {\r\n        const me = this;\r\n        me.#action = val;\r\n    }\r\n\r\n    /**\r\n    * Generate URL from src and mode type\r\n    */\r\n    get url() {\r\n        const me = this;\r\n        return me.#toURL(me.#src, me.#skip, me.#limit, me.#filter, me.#sort);\r\n    }\r\n\r\n    #toURL(src, skip, limit, filter, sort) {\r\n        const me = this;\r\n        if (GSUtil.isStringEmpty(src)) throw new Error('Attribute \"src\" not set!');\r\n        sort = sort ? JSON.stringify(sort) : '';\r\n        filter = filter ? JSON.stringify(filter) : '';\r\n        const opt = { limit: limit, skip: skip, sort: encodeURIComponent(sort), filter: encodeURIComponent(filter) };\r\n        return src + GSUtil.fromLiteral(me.action, opt);\r\n    }\r\n\r\n    /**\r\n     * If handler is local for manual data entry\r\n     * @returns {boolean}\r\n     */\r\n    get isOffline() {\r\n        return this.mode === '';\r\n    }\r\n\r\n    /**\r\n     * If handler is for Green Screens Quark Engine or custom global function.\r\n     * @returns {boolean}\r\n     */\r\n    get isQuark() {\r\n        return this.mode === 'quark';\r\n    }\r\n\r\n    /**\r\n     * If handler is for HTTP requests (query|rest)\r\n     * @returns {boolean}\r\n     */\r\n    get isRemote() {\r\n        return ['rest', 'query'].includes(this.mode);\r\n    }\r\n\r\n    /**\r\n     * Override in inherited class\r\n     * @param {} owner Calling HTMLElement\r\n     * @returns {Array<Object>} Json Array data loaded \r\n     */\r\n    async onRead(owner) {\r\n        const me = this;\r\n        if (me.isOffline) return;\r\n        if (!me.#reader) return super.onRead(owner);\r\n        if (me.isRemote) return await GSLoader.load(me.url, me.#reader, me.#headers, true);\r\n        if (!me.isQuark) return;\r\n        const fn = GSFunction.parseFunction(me.#reader);\r\n        if (!fn) throw new Error('Reader quark function not found!')\r\n        return fn(me.skip, me.limit, me.filter, me.sort);\r\n    }\r\n\r\n    /**\r\n     * Override in inherited class\r\n     * @param {} owner Calling HTMLElement\r\n     * @param {Object} data JSON object to send to the remote\r\n     * @returns {Object} Json Object with write response\r\n     */\r\n    async onWrite(owner, data) {\r\n        const me = this;\r\n        if (me.isOffline) return;\r\n        if (!me.#writer) return super.onWrite(owner);\r\n        if (!me.isRemote) return await GSLoader.load(me.url, me.#writer, me.#headers, true, data);\r\n        if (!me.isQuark) return;\r\n        const fn = GSFunction.parseFunction(me.#writer);\r\n        if (!fn) throw new Error('Writer quark function not found!')\r\n        return fn(data);\r\n    }\r\n\r\n    /**\r\n     * Reset the read/write handler\r\n     */\r\n    reset() {\r\n        this.#src = '';\r\n        this.#headers = {};\r\n        this.#reader = 'GET';\r\n        this.#writer = 'POST';\r\n        this.#action = '';\r\n        this.#mode = '';\r\n        this.#key = null;\r\n        this.#skip = 0;\r\n        this.#limit = 0;\r\n        this.#sort = [];\r\n        this.#filter = [];\r\n    }\r\n\r\n    /**\r\n     * Register generic handler under unique name.\r\n     * @param {string} name Unique handler name\r\n     * @returns {GSReadWrite} Data handler instance\r\n     */\r\n    static register(name) {\r\n        return new GSReadWrite(name, true);\r\n    }\r\n\r\n    static {\r\n        GSReadWriteRegistry.addHandler(GSReadWrite.#TYPE, GSReadWrite);\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSData } from \"../base/GSData.mjs\";\r\nimport { GSReadWrite } from \"./ReadWrite.mjs\";\r\nimport { GSReadWriteRegistry } from \"./ReadWriteRegistry.mjs\";\r\n\r\n/**\r\n * A module loading GSCachedReadWrite class\r\n * @module base/GSCachedReadWrite\r\n */\r\n\r\n/**\r\n * ReadWrite with cached memory data. \r\n * @Class\r\n */\r\nexport class GSCachedReadWrite extends GSReadWrite {\r\n\r\n    static #TYPE = 'cached';\r\n\r\n    #data = [];\r\n\r\n    #reformat(data = []) {\r\n\r\n        let records = [];\r\n        if (Array.isArray(data)) {\r\n            records = data;\r\n        } else if (Array.isArray(data.data)) {\r\n            records = data.data;\r\n        } else {\r\n            records = [data];\r\n        }\r\n\r\n        return records;\r\n    }\r\n\r\n    #postFilter(data) {\r\n        const me = this;\r\n        data = GSData.sortData(data, me.sort);        \r\n        let limit = me.limit === 0 ? data.length : me.limit;\r\n        data = data.slice(me.skip, me.skip + limit);\r\n        return data;\r\n    }\r\n\r\n    clear() {\r\n        this.clearSelected(this.#data);\r\n        this.#data = [];\r\n    }\r\n\r\n    append(data) {\r\n        if(!data) return false;\r\n        const me = this;\r\n        data = me.#reformat(data);\r\n        me.#data = me.#data.concat(data);\r\n        return me.#data;\r\n    }\r\n\r\n    remove(data) {\r\n        const me = this;\r\n        me.removeSelected(data);\r\n        me.#data = me.#data.filter(o => o =! data);\r\n        return me.#data;\r\n    }\r\n\r\n    /**\r\n     * Override in inherited class\r\n     * @param {} owner Calling HTMLElement\r\n     * @returns {Array<Object>} Json Array data loaded \r\n     */\r\n    async onRead(owner) {\r\n        const me = this;\r\n\r\n        if (me.#data.length === 0) {\r\n            const data = await super.onRead();\r\n            me.#data = me.#reformat(data);\r\n        }\r\n\r\n        let data = GSData.filterData(me.#data, me.filter, me.fields, me.limit);\r\n        data = me.#postFilter(data);\r\n        return data;\r\n    }\r\n\r\n    async onWrite(owner, data) {\r\n        return this.append(data);        \r\n    }\r\n\r\n    disable() {\r\n        this.#data = [];\r\n        super.disable();\r\n    }\r\n\r\n    set search(val) {\r\n        const me = this;\r\n        me.filter = val ? [{value : val}] : [];\r\n        me.read();\r\n        /*\r\n        let data = GSData.filterData(me.#data, [{value : val}]);\r\n        data = me.#postFilter(data);\r\n        me.notify(me, 'read', data);\r\n        */\r\n    }\r\n\r\n    clearSelected() {\r\n        return super.clearSelected(this.#data);\r\n    }\r\n\r\n    /**\r\n     * Return list of all selected record id's\r\n     */\r\n    get selected() {\r\n        return super.getSelected(this.#data);\r\n    }\r\n\r\n    /**\r\n     * Handler type\r\n     */\r\n    get type() {\r\n        return GSCachedReadWrite.#TYPE;\r\n    }\r\n\r\n    /**\r\n     * Reset the cached read/write handler\r\n     */\r\n    reset() {\r\n        this.clear();\r\n        super.reset();\r\n    }\r\n\r\n    /**\r\n     * Register generic handler under unique name.\r\n     * @param {string} name Unique handler name\r\n     * @returns {GSReadWrite} Data handler instance\r\n     */\r\n    static register(name) {\r\n        return new GSCachedReadWrite(name, true);\r\n    }\r\n\r\n    static {\r\n        GSReadWriteRegistry.addHandler(GSCachedReadWrite.#TYPE, GSCachedReadWrite);\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { Tree } from \"../helpers/Tree.mjs\";\r\n\r\n/**\r\n * A module loading TreeNode class\r\n * @module data/TreeNode\r\n */\r\n\r\n/**\r\n * UI mediator between Tree linked nodes and WebComponents\r\n * @Class\r\n */\r\nexport class TreeNode extends Tree {\r\n\r\n    #multi = false;\r\n    #opened = false;\r\n    #focused = false;\r\n    #selected = false;\r\n    \r\n    #focusedNode = undefined;\r\n    #selectedNode = undefined;\r\n    #controllers = undefined;\r\n\r\n    constructor(key, value = key, parent = null, level = 0) {\r\n        super(key, value, parent, level);\r\n\r\n        if (value?.select === true || (this.multi && parent?.selected)) this.selected = true;\r\n        if (value?.focus === true) this.focused = true;\r\n        if (value?.open === true) this.opened = true;\r\n    }\r\n\r\n    addController(controller) {\r\n        const root = this.root;\r\n        (root.#controllers ??= new Set()).add(controller);\r\n    }\r\n\r\n    removeController(controller) {\r\n        this.root.#controllers?.delete(controller);\r\n    }\r\n\r\n    /**\r\n     * Is multi selection available\r\n     */\r\n    get multi() {\r\n        return this.root.#multi === true;\r\n    }\r\n\r\n    set multi(val) {\r\n        this.root.#multi = val === true;\r\n    }\r\n\r\n    get visible() {\r\n        if (this.level < 0) return true;\r\n        return this.parent?.opened;\r\n    }\r\n\r\n    /**\r\n     * select single node, removing seelction flag from all other nodes\r\n     */\r\n    get opened() {\r\n        if (this.level < 0) return true;\r\n        return this.isLeaf ? this.parent?.opened : this.#opened;\r\n    }\r\n\r\n    set opened(val) {\r\n        val = val === true;\r\n        if (val) {\r\n            this.expand();\r\n        } else {\r\n            this.collapse();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Focus single node, removing focus flag from all other nodes\r\n     */\r\n    get focused() {\r\n        return this.#focused;\r\n    }\r\n\r\n    set focused(val) {\r\n        val = val === true;\r\n        const root = this.root;\r\n        const changed = this.#focused != val;\r\n        const focusedNode = root.focusedNode();\r\n        \r\n        root.#focusedNode = undefined;        \r\n        this.#focused = val;\r\n        if (focusedNode && focusedNode !== this) {\r\n            focusedNode.focused = false;\r\n        }\r\n\r\n        if (val) root.#focusedNode = this;\r\n        if (changed) root.#controllers?.forEach((c) => c.onFocusChanged?.(this));\r\n    }\r\n\r\n    /**\r\n     * Select single or multi node, depending on multi selection flag\r\n     * If single, remove selection flag from all other nodes\r\n     */\r\n    get selected() {\r\n        return this.#selected;\r\n    }\r\n\r\n    set selected(val) {\r\n        val = val === true;\r\n        const root = this.root;\r\n        const selectedNode = root.selectedNode();\r\n        const changed = this.#selected != val;\r\n        this.#selected = val;\r\n        if (val) {\r\n            if (selectedNode && selectedNode !== this && !root.multi) {\r\n                selectedNode.selected = false;\r\n            }\r\n            root.#selectedNode = this;\r\n        }\r\n        if (changed) {\r\n            root.#controllers?.forEach((c) => c.onSelectionChanged?.(this, selectedNode));\r\n            if (root.multi) root.#controllers?.forEach((c) => c.onSelectionChanged?.(this.parent, selectedNode));\r\n        } \r\n    }\r\n\r\n    get isPartialySelected() {\r\n        return this.selected && this.hasChildren && this.nodes.length > this.nodes.filter(n => n.selected).length;\r\n    }\r\n\r\n    selectAll() {\r\n        const root = this.root;\r\n        if (!root.multi) {\r\n            this.deselectAll();\r\n            this.selected = true;\r\n            return\r\n        }\r\n        this.#selectionFlag(true);\r\n        root.#selectedNode = this;\r\n        root.#controllers?.forEach((c) => c.onSelectAll?.(root));\r\n    }\r\n\r\n    deselectAll() {\r\n        const root = this.root;\r\n        this.#selectionFlag(false);\r\n        root.#selectedNode = undefined;\r\n        root.#controllers?.forEach((c) => c.onDeselectAll?.(root));\r\n    }\r\n\r\n    /**\r\n     * Return last focused node\r\n     * @returns \r\n     */\r\n    focusedNode() {\r\n        const node = this.root.#focusedNode;\r\n        return node?.focused ? node : undefined;\r\n    }\r\n\r\n    /**\r\n     * Return last selected node\r\n     * @returns \r\n     */\r\n    selectedNode() {\r\n        const node = this.root.#selectedNode;\r\n        return node?.selected ? node : undefined;\r\n    }\r\n\r\n    /**\r\n     * List all selected nodes.\r\n     * @returns \r\n     */\r\n    selectedNodes() {\r\n        const root = this.root;\r\n        if (!root.multi) {\r\n            const node = root.selectedNode()\r\n            return node?.selected ? [node] : [];\r\n        }\r\n        return Array.from(root.walk().filter(o => o.selected));\r\n    }\r\n\r\n    /**\r\n     * Call from external controller data must be refresshed (to notify UI optionally)\r\n     * @param {*} root \r\n     */\r\n    refresh(root) {\r\n        root = root || this.root;\r\n        root.#controllers?.forEach((c) => c.onRefresh?.(this));\r\n    }\r\n\r\n    /**\r\n     * Notify controllers about data loading (from async controller)\r\n     * @param {*} root \r\n     */\r\n    loading(root) {\r\n        root = root || this.root;\r\n        root.#controllers?.forEach((c) => c.onLoad?.(this));\r\n    }\r\n\r\n    expandAll(root) {\r\n        const me = this;\r\n        root = root || me.root;\r\n        for (let node of this.walk()) {\r\n            if (!node.isLeaf) node.expand(root);\r\n        }\r\n    }\r\n\r\n    collapseAll(root) {\r\n        const me = this;\r\n        root = root || me.root;\r\n        for (let node of this.walk()) {\r\n            if (!node.isLeaf) node.collapse(root);\r\n        }\r\n    }\r\n\r\n    expand(root) {\r\n        const me = this;\r\n        root = root || me.root;\r\n        if (!me.parent?.opened) {\r\n            me.parent?.expand(root);\r\n        }\r\n        const update = !me.opened;\r\n        me.#opened = true;\r\n        if (update) me.#expanded(root);\r\n        //me.nodes?.filter( n => !n.opened).forEach(c => c.refresh(root));\r\n        me.nodes?.forEach(c => c.refresh(root));\r\n    }\r\n\r\n    collapse(root) {\r\n        const me = this;\r\n        root = root || me.root;\r\n        const update = me.#opened || me.parent.#opened;\r\n        me.nodes?.filter(n => n.opened || n.parent.opened).forEach(o => o.collapse(root));\r\n        //me.nodes?.forEach(o => o.collapse(root));\r\n        me.#opened = false;\r\n        if (update) me.#collapsed(root);\r\n    }\r\n\r\n    select(val = true) {\r\n        this.selected = val === true;\r\n    }\r\n\r\n    #expanded(root) {\r\n        root.#controllers?.forEach((c) => c.onExpand?.(this));\r\n    }\r\n\r\n    #collapsed(root) {\r\n        root.#controllers?.forEach((c) => c.onCollapse?.(this));\r\n    }\r\n\r\n    release() {\r\n        if (this.#selected) this.selected = false;\r\n        super.release();\r\n    }\r\n\r\n    append(key, value = key) {\r\n        const me = this;\r\n        const node = super.append(key, value);\r\n        if (node) me.root.#controllers?.forEach((c) => c.onAppend?.(me, node));\r\n        return node;\r\n    }\r\n\r\n    insert(parentNodeKey, key, value = key) {\r\n        const me = this;\r\n        const node = super.insert(parentNodeKey, key, value);\r\n        if (node) me.root.#controllers?.forEach((c) => c.onInsert?.(me, node));\r\n        return node;\r\n    }\r\n\r\n    remove() {\r\n        const node = super.remove();\r\n        if (node) this.root.#controllers?.forEach((c) => c.onInsert?.(node));\r\n        return node;\r\n    }\r\n\r\n    #selectionFlag(val = false) {\r\n        val = val === true\r\n        for (let node of this.walk()) {\r\n            node.selected = val;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Load JSON data into tree\r\n     * @param {*} data \r\n     */\r\n    fromJSON(data) {\r\n        if (data) TreeNode.from(this, data);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Used by JSON.stringify to properly export as JSON\r\n     * @returns \r\n     */\r\n    toJSON() {\r\n        if (this.level < 0) return this.nodes?.map(o => o.toJSON()) || {};\r\n        const obj = Object.assign({\r\n            key: this.key,\r\n            opened: this.#opened,\r\n            focused: this.#focused,\r\n            selected: this.#selected,\r\n            items: undefined\r\n        }, this.value);\r\n        obj.items = this.nodes?.map(o => o.toJSON());\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Reset the tree node\r\n     */\r\n    reset() {\r\n        this.#multi = false;\r\n        this.#opened = false;\r\n        this.#focused = false;\r\n        this.#selected = false;\r\n        this.#focusedNode = undefined;\r\n        this.#selectedNode = undefined;\r\n        this.#controllers = undefined;\r\n    }\r\n\r\n    static get root() {\r\n        return new TreeNode(null, null, null, -1);\r\n    }\r\n\r\n    /**\r\n     * Convert JSON tree into Linked Tree \r\n     * @param {*} data \r\n     * @returns \r\n     */\r\n    static from(parent, data) {\r\n        const raw = data || parent;\r\n        const hasParent = parent instanceof TreeNode;\r\n        if (Array.isArray(raw)) {\r\n            if (!hasParent) return TreeNode.from(TreeNode.root, raw);\r\n            raw.forEach(o => TreeNode.from(parent, o));\r\n            return parent;\r\n        }\r\n        const { items, ...obj } = raw;\r\n        obj.leaf = !Array.isArray(items);\r\n        const tree = new TreeNode(obj.key, obj, data ? parent : undefined);\r\n        if (items) TreeNode.from(tree, items);\r\n        if (hasParent) parent.append(tree);\r\n        return tree;\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSReadWrite } from \"./ReadWrite.mjs\";\r\nimport { GSReadWriteRegistry } from \"./ReadWriteRegistry.mjs\";\r\nimport { TreeNode } from \"./TreeNode.mjs\";\r\n\r\n/**\r\n * A module loading GSTreeReader class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Generic Class for reading Tree nodes\r\n * @Class\r\n */\r\nexport class GSTreeReader extends GSReadWrite {\r\n\r\n    #data = TreeNode.root;\r\n\r\n    /**\r\n     * Instance constructor\r\n     * @param {string} name Unique handler name\r\n     * @param {boolean} enabled Automatically registe in global registry. \r\n     */\r\n    constructor(name, enabled) {\r\n        super(name, enabled);\r\n    }\r\n\r\n    async write(val) {\r\n        throw new Error('Writer not available for TreeReader')\r\n    }\r\n\r\n    async read(owner) {\r\n        const me = this;\r\n        let node = undefined;\r\n        const data = await super.read(owner);\r\n        if (!this.#data) {\r\n            node = TreeNode.from(data);\r\n            this.#data = node;\r\n        } else {\r\n            const parent = me.filter?.length > 0 ? me.#data.findByKey(me.filter[0]) : me.#data;\r\n            parent.clear();\r\n            node = parent.fromJSON(data);\r\n        }\r\n        me.filter = undefined;\r\n        me.notify(owner, 'read', node);\r\n        return node;\r\n    }\r\n\r\n    disable() {\r\n        super.disable();\r\n        this.#data?.release();\r\n    }\r\n\r\n    notify(owner, type, data, error) {\r\n        const isNode = data instanceof TreeNode;\r\n        if (!error && !isNode && type === 'read') return;\r\n        super.notify(owner, type, data, error);\r\n    }\r\n\r\n    /**\r\n     * Called from Tree when node is expanded \r\n     * @param {*} node \r\n     */\r\n    async onExpand(node) {\r\n        if (node.hasChildren) return;\r\n        node.loading();\r\n        this.filter = node.key;\r\n        return await this.read();\r\n    }\r\n\r\n    get data() {\r\n        return this.#data;\r\n    }\r\n\r\n    /**\r\n     * Reset the tree data\r\n     */\r\n    resetData() {\r\n        this.#data = TreeNode.root;\r\n    }\r\n\r\n    /**\r\n     * Register generic handler under unique name.\r\n     * @param {string} name Unique handler name\r\n     * @returns {GSTreeReader} Data handler instance\r\n     */\r\n    static register(name) {\r\n        return new GSTreeReader(name, true);\r\n    }\r\n\r\n    static {\r\n        GSReadWriteRegistry.addHandler('tree', GSTreeReader);\r\n    }\r\n\r\n}","// Lit 3.0 Google\r\nconst litUrl = globalThis.GS_LIT_URL || '/bootstrap-lit/assets/lib/lit-all.min.js';\r\nconst litModule = await import(litUrl);\r\n\r\n// small helper to print this exports (or any other module); use it when upgrading to a new Lit version to regenerte export list below\r\nexport const printModuleExports = (module) => console.log(Object.keys(module || litModule).map(v => `export const ${v} = litModule.${v};`).join('\\n'));\r\n\r\nexport const ReactiveController = litModule.ReactiveController;\r\nexport const ReactiveElement = litModule.ReactiveElement;\r\nexport const AsyncDirective = litModule.AsyncDirective;\r\nexport const AsyncReplaceDirective = litModule.AsyncReplaceDirective;\r\nexport const CSSResult = litModule.CSSResult;\r\nexport const Directive = litModule.Directive;\r\nexport const LitElement = litModule.LitElement;\r\nexport const PartType = litModule.PartType;\r\nexport const TemplateResultType = litModule.TemplateResultType;\r\nexport const UnsafeHTMLDirective = litModule.UnsafeHTMLDirective;\r\nexport const UntilDirective = litModule.UntilDirective;\r\nexport const _$LE = litModule._$LE;\r\nexport const _$LH = litModule._$LH;\r\nexport const adoptStyles = litModule.adoptStyles;\r\nexport const asyncAppend = litModule.asyncAppend;\r\nexport const asyncReplace = litModule.asyncReplace;\r\nexport const cache = litModule.cache;\r\nexport const choose = litModule.choose;\r\nexport const classMap = litModule.classMap;\r\nexport const clearPart = litModule.clearPart;\r\nexport const createRef = litModule.createRef;\r\nexport const css = litModule.css;\r\nexport const defaultConverter = litModule.defaultConverter;\r\nexport const directive = litModule.directive;\r\nexport const getCommittedValue = litModule.getCommittedValue;\r\nexport const getCompatibleStyle = litModule.getCompatibleStyle;\r\nexport const getDirectiveClass = litModule.getDirectiveClass;\r\nexport const guard = litModule.guard;\r\nexport const html = litModule.html;\r\nexport const ifDefined = litModule.ifDefined;\r\nexport const insertPart = litModule.insertPart;\r\nexport const isCompiledTemplateResult = litModule.isCompiledTemplateResult;\r\nexport const isDirectiveResult = litModule.isDirectiveResult;\r\nexport const isPrimitive = litModule.isPrimitive;\r\nexport const isServer = litModule.isServer;\r\nexport const isSingleExpression = litModule.isSingleExpression;\r\nexport const isTemplateResult = litModule.isTemplateResult;\r\nexport const join = litModule.join;\r\nexport const keyed = litModule.keyed;\r\nexport const literal = litModule.literal;\r\nexport const live = litModule.live;\r\nexport const map = litModule.map;\r\nexport const noChange = litModule.noChange;\r\nexport const notEqual = litModule.notEqual;\r\nexport const nothing = litModule.nothing;\r\nexport const range = litModule.range;\r\nexport const ref = litModule.ref;\r\nexport const removePart = litModule.removePart;\r\nexport const render = litModule.render;\r\nexport const repeat = litModule.repeat;\r\nexport const setChildPartValue = litModule.setChildPartValue;\r\nexport const setCommittedValue = litModule.setCommittedValue;\r\nexport const staticHtml = litModule.staticHtml;\r\nexport const staticSvg = litModule.staticSvg;\r\nexport const styleMap = litModule.styleMap;\r\nexport const supportsAdoptingStyleSheets = litModule.supportsAdoptingStyleSheets;\r\nexport const svg = litModule.svg;\r\nexport const templateContent = litModule.templateContent;\r\nexport const unsafeCSS = litModule.unsafeCSS;\r\nexport const unsafeHTML = litModule.unsafeHTML;\r\nexport const unsafeSVG = litModule.unsafeSVG;\r\nexport const unsafeStatic = litModule.unsafeStatic;\r\nexport const until = litModule.until;\r\nexport const when = litModule.when;\r\nexport const withStatic = litModule.withStatic;","import { Directive, directive, nothing } from \"../lib.mjs\";\r\n\r\nconst definition = {\r\n    'action': 'gsAction',\r\n    'anchor': 'gsAnchor',\r\n    'attribute': 'gsAttribute',\r\n    'call': 'gsCall',\r\n    'exec': 'gsExec',\r\n    'inject': 'gsInject',\r\n    'property': 'gsProperty',\r\n    'swap': 'gsSwap',\r\n    'target': 'gsTarget',\r\n    'template': 'gsTemplate',\r\n    'toggle': 'gsToggle',\r\n    'trigger': 'gsTrigger',\r\n    'value': 'gsValue',\r\n    'calls':'gsCall',\r\n    'toggles':'gsToggle',\r\n    'timeout':'gsTimeout',\r\n    'triggers':'gsTrigger'\r\n};\r\n\r\nconst template = {\r\n    'gsAction': undefined,\r\n    'gsAnchor': undefined,\r\n    'gsAttribute': undefined,\r\n    'gsCall': undefined,\r\n    'gsExec': undefined,\r\n    'gsInject': undefined,\r\n    'gsProperty': undefined,\r\n    'gsSwap': undefined,\r\n    'gsTarget': undefined,\r\n    'gsTemplate': undefined,\r\n    'gsToggle': undefined,\r\n    'gsTrigger': undefined,\r\n    'gsValue': undefined,\r\n    'gsCall': undefined,\r\n    'gsToggle': undefined,\r\n    'gsTimeout': undefined,\r\n    'gsTrigger': undefined\r\n};\r\n\r\nclass DatasetDirective extends Directive {\r\n\r\n    render(obj) {\r\n        console.log(obj);\r\n        return nothing;\r\n    }\r\n\r\n    update(part, [obj, flat = true]) {\r\n\r\n        if (!obj) return nothing;\r\n        const dataset = part.element.dataset;\r\n        const srcset = obj.dataset || obj;\r\n        const isDataset = srcset instanceof DOMStringMap;\r\n\r\n        if (isDataset) {\r\n            Object.assign(dataset, srcset);\r\n        } \r\n        \r\n        if (flat) this.#remap(dataset, obj);\r\n\r\n        return nothing;\r\n    }\r\n\r\n    #remap(dataset, obj) {\r\n        const opt = Object.assign({}, template);\r\n        const list = Object.entries(obj).filter(v => Object.hasOwn(definition, v[0]));\r\n        if (list.length > 0) {\r\n            list.forEach(kv => opt[definition[kv[0]]] = kv[1]);\r\n            Object.keys(opt)\r\n            .filter(k => opt[k] !== undefined)\r\n            .forEach(k => dataset[k] = opt[k]);\r\n        }\r\n    }\r\n}\r\n\r\nexport const dataset = directive(DatasetDirective);\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { html } from '../lib.mjs';\r\n\r\n/**\r\n * Generic object property descriptor getter\r\n * @param {Object} instance \r\n * @returns {PropertyDescriptor}\r\n */\r\nfunction descriptors(instance) {\r\n  return Object.entries(Object.getOwnPropertyDescriptors(instance));\r\n}\r\n\r\n/**\r\n * List of all object property descriptors \r\n * @param {Object} instance Object instance \r\n * @returns {Array<PropertyDescriptor>}\r\n */\r\nfunction listProperties(instance) {\r\n  return descriptors(instance)\r\n    .filter(e => typeof e[1].value !== 'function')\r\n    .map(e => e[0]);\r\n}\r\n\r\n/**\r\n * List all object property getters\r\n * @param {Object} instance \r\n * @returns {Array}\r\n */\r\nfunction listGetters(instance) {\r\n  return descriptors(Reflect.getPrototypeOf(instance))\r\n    .filter(e => typeof e[1].get === 'function' && e[0] !== '__proto__')\r\n    .map(e => e[0]);\r\n}\r\n\r\n/**\r\n * List of all gettable properties from an object\r\n * @param {Object} instance \r\n * @returns {Array}\r\n */\r\nfunction listGettable(instance) {\r\n  return new Set([...listGetters(instance), ...listProperties(instance)]);\r\n}\r\n\r\n/**\r\n * Parse string literal template into Lit html instance\r\n * @param {*} tpl \r\n * @param {*} params \r\n * @returns {function}\r\n */\r\nexport function literalTemplate(tpl, params) {\r\n  const names = Array.from(listGettable(params));\r\n  const vals = names.map(v => params[v]);\r\n  names.push('html');\r\n  vals.push(html);\r\n  return new Function(...names, `return html\\`${tpl}\\`;`)(...vals);\r\n}","/**\r\n * A clone of classMap directive to support CSS directive.\r\n * Lit classs is not expoed, so we have to clone it and create our own.\r\n */\r\n\r\nimport { Directive, PartType, directive, noChange } from \"../lib.mjs\";\r\n\r\nclass CssMapDirective extends Directive {\r\n\r\n    constructor(partInfo) {\r\n        super(partInfo);\r\n        if (partInfo.type !== PartType.ATTRIBUTE ||\r\n            partInfo.name !== 'css' ||\r\n            partInfo.strings?.length > 2) {\r\n            throw new Error('`classMap()` can only be used in the `css` attribute ' +\r\n                'and must be the only part in the attribute.');\r\n        }\r\n    }\r\n\r\n    render(classInfo) {\r\n        // Add spaces to ensure separation from static classes\r\n        return (' ' +\r\n            Object.keys(classInfo)\r\n                .filter((key) => classInfo[key])\r\n                .join(' ') +\r\n            ' ');\r\n    }\r\n\r\n    update(part, [classInfo]) {\r\n\r\n        // Remember dynamic classes on the first render\r\n        if (this._previousClasses === undefined) {\r\n            this._previousClasses = new Set();\r\n            if (part.strings !== undefined) {\r\n                this._staticClasses = new Set(part.strings\r\n                    .join(' ')\r\n                    .split(/\\s/)\r\n                    .filter((s) => s !== ''));\r\n            }\r\n\r\n            for (const name in classInfo) {\r\n                if (classInfo[name] && !this._staticClasses?.has(name)) {\r\n                    this._previousClasses.add(name);\r\n                }\r\n            }\r\n            return this.render(classInfo);\r\n        }\r\n\r\n        const classList = part.element.classList;\r\n\r\n        // Remove old classes that no longer apply\r\n        for (const name of this._previousClasses) {\r\n            if (!(name in classInfo)) {\r\n                classList.remove(name);\r\n                this._previousClasses.delete(name);\r\n            }\r\n        }\r\n\r\n        // Add or remove classes based on their classMap value\r\n        for (const name in classInfo) {\r\n            // We explicitly want a loose truthy check of `value` because it seems\r\n            // more convenient that '' and 0 are skipped.\r\n            const value = !!classInfo[name];\r\n            if (value !== this._previousClasses.has(name) &&\r\n                !this._staticClasses?.has(name)) {\r\n                if (value) {\r\n                    classList.add(name);\r\n                    this._previousClasses.add(name);\r\n                } else {\r\n                    classList.remove(name);\r\n                    this._previousClasses.delete(name);\r\n                }\r\n            }\r\n        }\r\n        return noChange;\r\n    }\r\n}\r\n\r\n/**\r\n * A directive that applies dynamic CSS classes.\r\n *\r\n * This must be used in the `css` attribute and must be the only part used in\r\n * the attribute. It takes each property in the `classInfo` argument and adds\r\n * the property name to the element's `classList` if the property value is\r\n * truthy; if the property value is falsey, the property name is removed from\r\n * the element's `css`.\r\n *\r\n * For example `{foo: bar}` applies the class `foo` if the value of `bar` is\r\n * truthy.\r\n *\r\n * @param classInfo\r\n */\r\nexport const cssMap = directive(CssMapDirective);\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nexport const notEmpty = (newVal, oldVal) => newVal !== oldVal && newVal;\r\nexport const numGT0 = (newVal, oldVal) => newVal !== oldVal && Number(newVal) > 0;\r\nexport const numGE0 = (newVal, oldVal) => newVal !== oldVal && Number(newVal) >= 0;\r\nexport const numLT0 = (newVal, oldVal) => newVal !== oldVal && Number(newVal) < 0;\r\nexport const numLE0 = (newVal, oldVal) => newVal !== oldVal && Number(newVal) <= 0;\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nexport const AutocapitalizeTypes = ['', 'none', 'off', 'on', 'sentences', 'words', 'characters'];\r\n\r\nexport const autocapitalize = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && AutocapitalizeTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nexport const AutocompleteTypes = ['', 'off', 'on'];\r\n\r\nexport const autocomplete = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && AutocompleteTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nexport const AutocorrectTypes = ['', 'on', 'off'];\r\n\r\nexport const autocorrect = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && AutocorrectTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\n\r\nexport class ButtonTypes {\r\n\r\n    static values = ['button', 'reset', 'submit'];\r\n\r\n    static is(val) {\r\n        return ButtonTypes.values.includes(val);\r\n    }\r\n\r\n    static isReset(val) {\r\n        return  ButtonTypes.isType(val, 'reset');\r\n    }\r\n\r\n    static isSubmit(val) {\r\n        return  ButtonTypes.isType(val, 'submit');\r\n    }\r\n\r\n    /**\r\n     * Check button type, by spec, if not set, default is 'submit'\r\n     * @param {*} type - button type\r\n     * @param {*} value - matching value\r\n     * @returns \r\n     */\r\n    static isType(type, value) {\r\n        return ButtonTypes.#normalize(type) === value;\r\n    }\r\n\r\n    static #normalize(type) {\r\n        return GSUtil.normalize(type, 'submit').toLowerCase();\r\n    }\r\n} \r\n\r\nexport const buttonType = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && ButtonTypes.is(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nexport const ColorTypes = ['', 'primary', 'secondary', 'dark', 'light', 'info', 'warning', 'danger', 'alert', 'link', 'success'];\r\n\r\nexport const color = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && ColorTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nexport const EnvironmentTypes = ['', 'desktop', 'mobile', 'tablet', 'android', 'linux', 'windows', 'macos', 'ios'];\r\n\r\nexport const environment = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && EnvironmentTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nexport const InputTypes = [\r\n   { type: 'checkbox', ignore: true},\r\n   { type: 'radio', ignore: true},\r\n   { type: 'switch', ignore: true},\r\n   { type: 'range', ignore: true},\r\n   { type: 'number', native: true},\r\n   { type: 'email', native: true},\r\n   { type: 'url',  native: true},\r\n   { type: 'file', native: true}, \r\n   { type: 'text'},\r\n   { type: 'password'}\r\n];\r\n\r\nexport const inputType = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && InputTypes.filter(o => o.type === newVal).length === 1;\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nexport const NavTypes = ['', 'pills', 'tabs', 'underline'];\r\n\r\nexport const nav = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && NavTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nexport class OrientationTypes {\r\n\r\n    static values =  ['', 'horizontal', 'vertical', 'portrait', 'landscape'];\r\n\r\n    static includes(val) {\r\n        return OrientationTypes.values.includes(val);\r\n    }\r\n\r\n    static isVertical(val) {\r\n        const idx = OrientationTypes.values.indexOf(val);\r\n        return idx === 2 || idx === 3;\r\n    }\r\n\r\n    static isHorizontal(val) {\r\n        const idx = OrientationTypes.values.indexOf(val);\r\n        return idx === 1 || idx === 4;\r\n    }\r\n\r\n}\r\n\r\nexport const orientation = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && OrientationTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nexport class PlacementTypes {\r\n\r\n    static values = ['center', 'left', 'right', 'start', 'end', 'top', 'bottom'];\r\n\r\n    static includes(val) {\r\n        return PlacementTypes.values.includes(val);\r\n    }\r\n\r\n    static isVertical(val) {\r\n        return PlacementTypes.values.indexOf(val) > 4;\r\n    }\r\n\r\n    static isHorizontal(val) {\r\n        const idx = PlacementTypes.values.indexOf(val)\r\n        return idx > 0 && idx < 5;\r\n    }\r\n\r\n    static isCenter(val) {\r\n        return PlacementTypes.values.indexOf(val) === 0;\r\n    }\r\n\r\n    static isBefore(val) {\r\n        return ['left', 'start', 'top'].includes(val);\r\n    }\r\n\r\n    static isAfter(val) {\r\n        return ['right', 'end', 'bottom'].includes(val);\r\n    }\r\n}\r\n\r\n\r\nexport const placement = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && PlacementTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nexport class PositionTypes {\r\n\r\n    static values = ['absolute', 'fixed', 'relative', 'sticky', 'static'];\r\n\r\n    static includes(val) {\r\n        return PositionTypes.values.includes(val);\r\n    }\r\n}\r\n\r\n\r\nexport const position = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && PositionTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nexport const ProtocolTypes = ['', 'http', 'https'];\r\n\r\nexport const protocol = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && ProtocolTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nexport const SizeTypes = { 'default' : '', 'normal': '',  'medium': '', 'small': 'sm', 'large': 'lg', 'big' : 'lg', 'extra' : 'xl' };\r\n\r\nexport const size = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && Object.hasOwn(SizeTypes, newVal);\r\n    }\r\n\r\n};","export const stringArrayConverter = {\r\n    fromAttribute: (value, type) => {\r\n        return (value || '').split(',');\r\n    },\r\n    toAttribute: (value, type) => {\r\n        return (value || []).join(',');\r\n    }\r\n};","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDynamicStyle } from '../base/GSDynamicStyle.mjs';\r\nimport { GSCacheStyles } from '../base/GSCacheStyles.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\n/**\r\n * Controller register self to gs-adopted event listener list.\r\n * Every time gs-adopted event is triggered by the GSAdoptedEngine class,\r\n * all registered controllers will be processed for reapplaying stylesheet. \r\n * Also, this controller takes care of adding a custom dynamic styles \r\n * to the end fo the list.\r\n * \r\n * Custom dynamic styles are used internally by the components for dynamic \r\n * style changes to prevent DOM node pollution.\r\n */\r\nexport class AdoptedController {\r\n\r\n  #host;\r\n  #dynamic;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    AdoptedController.#controllers.add(me);\r\n    me.#adopt();\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    AdoptedController.#controllers.delete(me);\r\n    me.#host.removeController(me);\r\n    me.#host = null;\r\n    me.#dynamic = null;\r\n  }\r\n\r\n  /**\r\n   * Initialize dynamic style for component instance\r\n   * Call it from constructor for style to be applied to the current component\r\n   * @param {String} name CSS class name\r\n   * @param {Object|String} values CSS class styles to be applied\r\n   * @returns {CSSStyleRule} An instance of a CSS class\r\n   */\r\n  style(name, values, isGlobal = false) {\r\n    const me = this;\r\n    let style = null;\r\n    if (isGlobal) {\r\n      style = GSCacheStyles.dynamic;\r\n    } else {\r\n      me.#dynamic = me.#dynamic ?? new GSDynamicStyle('dynamic');      \r\n      style = me.#dynamic;\r\n    }    \r\n    if (values === null && style.cssRules.length > 0 ) return style.removeRule(name);\r\n    return style.setRule(name, values, true);\r\n  }\r\n\r\n  #adopt(forced = false) {\r\n    const me = this;\r\n    if (!me.#sheets) return;\r\n    if (forced || me.#changed) {\r\n      const sheets = [...document.adoptedStyleSheets];\r\n      const internal = me.#staticRules;\r\n      if (me.#hasRules) internal.push(me.#dynamic);\r\n      me.#root.adoptedStyleSheets = [...sheets, ...internal].filter(v => v.cssRules.length > 0);\r\n      me.#root.adoptedStyleSheets.id = document.adoptedStyleSheets.id;\r\n    }\r\n  }\r\n  \r\n  // support for lit \"static styles = css``\"\r\n  get #staticRules() {\r\n    return this.#sheets?.filter(v => GSUtil.isNull(v.id)) || [];\r\n  }\r\n\r\n  // is there any dynamic rules set\r\n  get #hasRules() {\r\n    return this.#dynamic?.cssRules.length > 0 || false;\r\n  }\r\n\r\n  // have adopted styles changed in document\r\n  get #changed() {\r\n    return document.adoptedStyleSheets.id !== this.#sheets?.id;\r\n  }\r\n\r\n  get #root() {\r\n    return this.#host?.renderRoot;\r\n  }\r\n\r\n  get #sheets() {\r\n    return this.#root?.adoptedStyleSheets;\r\n  }\r\n\r\n  /**\r\n   * Global listener for gs-adopted event triggered from GSAdoptedEngine\r\n   */\r\n  static #controllers = new Set();\r\n\r\n  static #onAdopted(e) {\r\n    requestAnimationFrame(() => {\r\n      AdoptedController.#controllers.forEach(c => c.#adopt());\r\n    });\r\n  }\r\n\r\n  static #init() {\r\n    const me = AdoptedController;\r\n    GSEvents.on(window, null, 'gs-adopted', me.#onAdopted);\r\n  }\r\n\r\n  static {\r\n    this.#init();\r\n  }\r\n\r\n}  \r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSAttributeHandler } from \"../base/GSAttributeHandler.mjs\";\r\nimport { GSDOM } from \"../base/GSDOM.mjs\";\r\n\r\n/**\r\n * Attributes to control click actions for buttons and links.\r\n * Used to brings meta linking between UI elements\r\n */\r\nexport class AttributeController extends GSAttributeHandler {\r\n\r\n  constructor(host) {\r\n    super(host);\r\n    const me = this;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.attach(me.#eventName);\r\n    // me.host.on('notify', e => me.onNotify(e));\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.host.removeController(me);\r\n    me.detach(me.#eventName);\r\n  }\r\n\r\n  onNotify(evt) {\r\n    const me = this;\r\n    me.handle(evt);\r\n  }\r\n\r\n  get #eventName() {\r\n    const tag = this.host?.tagName.toLowerCase();\r\n    const clazz = this.host?.clazzName;\r\n    const isFormEl = GSDOM.isFormElement(this.host);\r\n    const v1 = ['gs-form', 'gs form-group'].includes(tag);\r\n    const v2 = ['GSFormGroupElement'].includes(clazz);\r\n    return v1 || v2 || isFormEl ? 'change' : 'click';\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSDOM } from \"../base/GSDOM.mjs\";\r\n\r\n/**\r\n * Handle rendered content cleanup (remove by default)\r\n * Set \"keep\" to the component to prevent rendered content removal.\r\n */\r\nexport class ContentController {\r\n\r\n  #host;\r\n  #ref;\r\n  #refs = new Set();\r\n\r\n  constructor(host) {\r\n    this.#host = host;\r\n    host.addController(this);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#removeContent();\r\n    me.#host = null;\r\n    me.#refs = null;\r\n    me.#ref = null;\r\n  }\r\n\r\n  // called only once, before host.firstUpdate\r\n  hostUpdated() {\r\n    const me = this;\r\n    if (!me.#isSelf() && me.#target) me.#refs.add(me.#target);\r\n  }\r\n\r\n  get contentRef() {\r\n    return this.#ref;\r\n  }\r\n\r\n  get #options() {\r\n    return this.#host?.renderOptions;\r\n  }\r\n\r\n  get #target() {\r\n    return this.#options?.renderBefore?.previousElementSibling;\r\n  }\r\n\r\n  #isSelf() {\r\n    const me = this;\r\n    const target = me.#target;\r\n    const root = me.#host?.renderRoot;\r\n    const shadow = me.#host?.shadowRoot;\r\n    return (target === shadow || target == root);\r\n  }\r\n\r\n  #removeContent() {\r\n    const me = this;\r\n    if (!me.#host?.keep) {\r\n      Array.from(me.#refs)\r\n        .filter(el => el ? true : false)\r\n        .forEach(el => GSDOM.cleanup(el));\r\n    }\r\n    me.#refs?.clear();\r\n  }\r\n}  ","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSLog } from \"../base/GSLog.mjs\";\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\nimport { DataSelector } from \"../data/DataSelector.mjs\";\r\nimport { GSReadWriteRegistry } from \"../data/ReadWriteRegistry.mjs\";\r\n\r\n/**\r\n * Controller between component and DataReadWrite.\r\n */\r\nexport class DataController {\r\n\r\n  #host;\r\n\r\n  #readCallback;\r\n  #writeCallback;\r\n  #errorCallback;\r\n  #selectCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#readCallback = me.#onRead.bind(me);\r\n    me.#writeCallback = me.#onWrite.bind(me);\r\n    me.#errorCallback = me.#onError.bind(me);\r\n    me.#selectCallback = me.#onSelect.bind(me);\r\n    me.#host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.#listen(false);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#unlisten();\r\n    me.#host.removeController(me);\r\n  }\r\n\r\n  async read(obj) {\r\n    return this.store?.read(this.#host);\r\n  }\r\n\r\n  async write(obj) {\r\n    return this.store?.write(this.#host, obj);\r\n  }\r\n\r\n  async storage() {\r\n    return GSReadWriteRegistry.wait(this.storeID);\r\n  }\r\n\r\n  sort(val) {\r\n    if (!this.store) return;\r\n    this.store.sort = val;\r\n    return this.store.read();\r\n  } \r\n\r\n  filter(val) {\r\n    if (!this.store) return;\r\n    this.store.filter = val;\r\n    return this.store.read();\r\n  }\r\n\r\n  search(val) {\r\n    if (!this.store) return;\r\n    this.store.search = val;\r\n  }\r\n\r\n  firstPage() {\r\n    this.page = 1;\r\n  }\r\n\r\n  lastPage() {\r\n    this.nextPage();\r\n  }\r\n\r\n  nextPage() {\r\n    this.page = this.page + 1;\r\n  }\r\n\r\n  prevPage() {\r\n    this.page = this.page - 1;\r\n  }\r\n\r\n  get selected() {\r\n    return this.store?.selected;\r\n  }\r\n\r\n  isSelected(val) {\r\n    return this.#selector.isSelected(val);\r\n  }\r\n\r\n  addSelected(val) {\r\n    return this.#selector.addSelected(val);\r\n  }\r\n  \r\n  removeSelected(val) {\r\n    return this.#selector.removeSelected(val);\r\n  }\r\n\r\n  clearSelected(data) {\r\n    return this.#selector.clearSelected(data);\r\n  }\r\n\r\n  getSelected(data) {\r\n    return GSUtil.asArray(data).filter(o => DataSelector.isSelected(o));\r\n  }\r\n\r\n  get #selector() {\r\n    return this.store || DataSelector;\r\n  }\r\n\r\n  get store() {\r\n    return GSReadWriteRegistry.find(this.storeID);\r\n  }\r\n\r\n  get storeID() {\r\n    return this.#host?.storage;\r\n  }\r\n\r\n  get page() {\r\n    const store = this.store;\r\n    return store ? Math.floor(store.skip / Math.max(store.limit, 1)) + 1 : 1;\r\n  }\r\n\r\n  set page(val) {\r\n    val = Math.max(1, GSUtil.asNum(val, 1));    \r\n    const store = this.store;\r\n    if (store) {\r\n      store.skip = val > 0 ? (store.limit * val) - store.limit : 0;\r\n      store.read(this.#host);\r\n    }\r\n  }\r\n\r\n  async #listen(read = true) {\r\n    const me = this;\r\n    const storage = await me.storage();\r\n    if (storage) {\r\n      storage.on('read', me.#readCallback);\r\n      storage.on('write', me.#writeCallback);\r\n      storage.on('error', me.#errorCallback);\r\n      storage.on('select', me.#selectCallback);\r\n      if (read) storage.read(me.#host);\r\n    }\r\n  }\r\n\r\n  #unlisten() {\r\n    const me = this;\r\n    const storage = me.store;\r\n    if (storage) {\r\n      storage.off('read', me.#readCallback);\r\n      storage.off('write', me.#writeCallback);\r\n      storage.off('error', me.#errorCallback);\r\n      storage.off('select', me.#selectCallback);\r\n    }\r\n  }\r\n\r\n  #onSelect(e) {\r\n    this.#host.requestUpdate?.();\r\n  }\r\n\r\n  #onRead(e) {\r\n    const me = this;\r\n    me.#host.onDataRead?.(e.detail.data);\r\n    me.#notify('data-read', e.detail.data);\r\n  }\r\n\r\n  #onWrite(e) {\r\n    const me = this;\r\n    me.#host.onDataWrite?.(e.detail.data);\r\n    me.#notify('data-write', e.detail.data);\r\n  }\r\n\r\n  #onError(e) {\r\n    const me = this;\r\n    GSLog.error(me.#host, e);\r\n    me.#host.onDataError?.(e);\r\n    me.#notify('data-error', e.detail.data);\r\n  }\r\n\r\n  #notify(name, data) {\r\n    this.#host.emit(name, data, true, false, true);\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Controller for elment move events, properly handling mouse events.\r\n */\r\nexport class ElementMoveController {\r\n\r\n  #host;\r\n  #element;\r\n  #attached = false;\r\n\r\n  #cursorX = 0;\r\n  #cursorY = 0;\r\n\r\n  #mouseUpCallback;\r\n  #mouseDownCallback;\r\n  #mouseMoveCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n    me.#mouseUpCallback = me.#onMouseUp.bind(me);\r\n    me.#mouseDownCallback = me.#onMouseDown.bind(me);\r\n    me.#mouseMoveCallback = me.#onMouseMove.bind(me);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host = null;\r\n  }\r\n\r\n  attach(element) {\r\n    const me = this;\r\n    if (!me.#attached) {\r\n      me.#element = element;\r\n      me.#attached = true;\r\n      me.#host.attachEvent(me.#element, 'mousedown', me.#mouseDownCallback);\r\n    }\r\n  }\r\n\r\n  reset() {\r\n    const me = this;\r\n    me.#cursorX = 0;\r\n    me.#cursorY = 0;\r\n    me.#host.removeEvent(document, 'mouseup', me.#mouseUpCallback);\r\n    me.#host.removeEvent(document, 'mousemove', me.#mouseMoveCallback);\r\n  }\r\n\r\n  /**\r\n  * Call host onStartMove function\r\n  * @param {MouseEvent} e \r\n  */\r\n  #onMouseDown(e) {\r\n    const me = this;\r\n    me.#host.prevent(e);\r\n    me.#cursorX = e.clientX;\r\n    me.#cursorY = e.clientY;\r\n    me.#host.onStartMove?.(e, me.#cursorX, me.#cursorY);\r\n    me.#host.attachEvent(document, 'mouseup', me.#mouseUpCallback, true);\r\n    me.#host.attachEvent(document, 'mousemove', me.#mouseMoveCallback);\r\n  }\r\n\r\n  /**\r\n   * Remove mousemove listener and call host onEndMove function\r\n   * @param {MouseEvent} e \r\n   */\r\n  #onMouseUp(e) {\r\n    const me = this;\r\n    me.#host.prevent(e);\r\n    me.#host.removeEvent(document, 'mousemove', me.#mouseMoveCallback);\r\n    return me.#host.onEndMove?.(e, me.#cursorX, me.#cursorY);\r\n  }\r\n\r\n  /**\r\n   * Call host onMouseMove function\r\n   * @param {MouseEvent} e \r\n   */\r\n  #onMouseMove(e) {\r\n    const me = this;\r\n    me.#host.prevent(e);\r\n\r\n    me.#host.onMouseMove?.(e, me.#cursorX, me.#cursorY);\r\n\r\n    if (me.#cursorX < e.clientX) {\r\n      me.#host.onCursorRight?.(e, me.#cursorX, me.#cursorY);\r\n    } else if (me.#cursorX > e.clientX) {\r\n      me.#host.onCursorLeft?.(e, me.#cursorX, me.#cursorY);\r\n    }\r\n\r\n    if (me.#cursorY < e.clientY) {\r\n      me.#host.onCursorUp?.(e, me.#cursorX, me.#cursorY);\r\n    } else if (me.#cursorY > e.clientY) {\r\n      me.#host.onCursorDown?.(e, me.#cursorX, me.#cursorY);\r\n    }\r\n\r\n    me.#cursorX = e.clientX;\r\n    me.#cursorY = e.clientY;\r\n\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\n\r\n/**\r\n * Listens for theme change and update component to apply new theme.\r\n * External theme changes only if component theme is not set.\r\n * Bootstrap uses CSS selector for theme in form of attribute value [data-bs-theme=\"***\"]\r\n * Compoennt and all first level childern in shadow dom are updated\r\n */\r\nexport class LocalizationController {\r\n\r\n  #host;\r\n  #language;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#language = host.language;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    LocalizationController.#controllers.add(this);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    LocalizationController.#controllers.delete(me);\r\n    me.#host.removeController(me);\r\n    me.#host = null;\r\n    me.#language = null;\r\n  }\r\n\r\n  // called every time host is updated\r\n  hostUpdate() {\r\n    const me = this;\r\n    if (me.#language !== me.#host?.language) {\r\n      me.#language === me.#host?.language;\r\n      me.updateLanguage(me.#language);\r\n    }\r\n  }\r\n\r\n  updateLanguageExt(langauge) {\r\n    if (!this.#language) this.updateLanguage(langauge);\r\n  }\r\n\r\n  updateLanguage(lang) {\r\n    if (!lang) return;\r\n    this.#host.requestUpdate();\r\n  }\r\n\r\n  static #controllers = new Set();\r\n\r\n  static #onLanguage(e) {\r\n    const me = LocalizationController;\r\n    me.#controllers.forEach(c => c.updateLanguageExt(e.detail));\r\n  }\r\n\r\n  static #init() {\r\n    GSEvents.on(window, null, 'gs-language', LocalizationController.#onLanguage);\r\n  }\r\n\r\n  static {\r\n    LocalizationController.#init();\r\n  }\r\n\r\n}  \r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Handle screen orientation events.\r\n * Trigger rerender to optionally hide element if \r\n * screen orientation is not supported\r\n */\r\nexport class OrientationController {\r\n\r\n    static #hosts = new Set();\r\n    #host;\r\n    \r\n    constructor(host) {\r\n      this.#host = host;\r\n      host.addController(this);\r\n    }\r\n    \r\n    hostConnected() {\r\n      OrientationController.#hosts.add(this);\r\n      this.update();\r\n    }\r\n    \r\n    hostDisconnected() {\r\n      const me = this;\r\n      OrientationController.#hosts.delete(me);\r\n      me.#host.removeController(me);      \r\n      me.#host = null;\r\n    }\r\n\r\n    update() {\r\n      this.#host.requestUpdate();\r\n    }\r\n\r\n    static #onOrientation(e) {\r\n      Array.from(OrientationController.#hosts).forEach(h => h.update());\r\n    }\r\n    \r\n    static {\r\n      screen.orientation.addEventListener('change', OrientationController.#onOrientation);\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { RENDER } from '../base/GSConst.mjs';\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\nimport { GSTemplateCache } from \"../base/GSTemplateCache.mjs\";\r\nimport { GSDOM } from \"../base/GSDOM.mjs\";\r\n\r\n\r\n\r\n/**\r\n * Handle element template and signal rerender when ready\r\n * Sequencial template load is used to prevent multiple request for the same URL\r\n */\r\nexport class TemplateController {\r\n\r\n  #host;\r\n  #template;\r\n  #lastRef;\r\n  #once;\r\n\r\n  static #scheduled = false;\r\n  static #tasks = new Set();\r\n  static #cache = new Map();\r\n  static #refs = new Set();\r\n\r\n  static get isPrefetch() {\r\n    return globalThis.GS_TEMPLATE_PREFETCH || false;\r\n  }\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#once = true;\r\n    host[RENDER] = false;\r\n    host.addController(this);\r\n  }\r\n\r\n  // inherited\r\n  hostConnected() {\r\n    const me = this;\r\n    /* \r\n    if(TemplateController.isPrefetch) {\r\n      me.hostUpdate();\r\n    }\r\n    */\r\n  }\r\n\r\n  // inherited\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    delete me.#host[RENDER];\r\n    me.#host = null;\r\n    me.#lastRef = null;\r\n    me.#template = null;\r\n  }\r\n\r\n  // inherited\r\n  hostUpdate() {\r\n    const me = this;\r\n    if (me.#template) return;\r\n    const ref = me.templateRef;\r\n    if (me.#lastRef !== ref) {\r\n      const template = TemplateController.#cache.get(me.#toKey(ref));\r\n      if (GSUtil.isJsonType(template)) me.#applyTemplate(template);\r\n      me.#lastRef = ref;\r\n      if (ref && !me.#template) {\r\n        TemplateController.#schedule(me);\r\n      }\r\n    }\r\n  }\r\n\r\n  // inherited\r\n  hostUpdated() {\r\n    const me = this;\r\n    const host = me.#host;\r\n    // after fixing gselement.#updateHide this controller can be auto-removed\r\n    // in case of issues, replace with commented block\r\n    if (me.#template && host.hasUpdated) {\r\n      host.removeController(me);\r\n      host.templateInjected?.();\r\n      queueMicrotask(()=> me.hostDisconnected());\r\n    }\r\n\r\n    /*\r\n    if (me.#template && me.#once) {\r\n      me.#once = false;\r\n      host.templateInjected?.();\r\n    }\r\n    */\r\n\r\n  }\r\n\r\n  #toKey(ref) {\r\n    const me = this;\r\n    return GSUtil.isString(ref) ? `${ref}@${me.#host?.tagName || ''}` : ref;\r\n  }\r\n\r\n  #hasKey(key) {\r\n    return TemplateController.#refs.has(key) || TemplateController.#cache.has(key);\r\n  }\r\n\r\n  // applly template opts {simple, slots}\r\n  #applyTemplate({ simple, slots }) {\r\n\r\n    const me = this;\r\n    if (!me.#host) return;\r\n\r\n    const hasSlots = GSDOM.isTemplateElement(slots);\r\n    const hasSimple = GSDOM.isTemplateElement(simple);\r\n\r\n    let signal = true;\r\n\r\n    if (hasSlots) {\r\n      // slot elements must be added only once \r\n      if (me.#host[RENDER] === false) {\r\n        me.#host[RENDER] = true;\r\n        const clone = slots.cloneNode(true);\r\n        Array.from(clone.content.children).forEach(el => me.#host.appendChild(el));\r\n      }\r\n    }\r\n\r\n    if (hasSimple) {\r\n      if (simple.content.childElementCount > 0) {\r\n        signal = false;\r\n        me.#template = simple.cloneNode(true);\r\n        me.#host.requestUpdate();\r\n      }\r\n    }\r\n\r\n    if (signal) me.#host.templateInjected?.();\r\n\r\n  }\r\n\r\n  // separate first level nodes into sloted nodes and plain shadow injectable node \r\n  #preprocessTemplate(template) {\r\n    let templateSimple = null;\r\n    let templateSlots = null;\r\n    const slots = Array.from(template.content.children).filter(el => el.hasAttribute('slot'));\r\n    const hasSlots = slots.length > 0;\r\n    const hasSimple = template.content.childElementCount > slots.length;\r\n    if (hasSlots) {\r\n      if (hasSimple) {\r\n        templateSlots = document.createElement('template');\r\n        slots.forEach(el => templateSlots.content.appendChild(el));\r\n      } else {\r\n        templateSlots = template;\r\n      }\r\n    }\r\n    templateSimple = hasSimple && template?.content.childElementCount > 0 ? template : null;\r\n    templateSlots = hasSlots && templateSlots?.content.childElementCount > 0 ? templateSlots : null;\r\n    // cache copy for page injected templates as they might be cleared elswhere\r\n    templateSimple = templateSimple?.isConnected ? templateSimple.cloneNode(true) : templateSimple;\r\n    return { simple: templateSimple, slots: templateSlots };\r\n  }\r\n\r\n  async #load() {\r\n\r\n    const me = this;\r\n    const ref = me.templateRef;\r\n    \r\n    if (!ref) return;\r\n    const key = me.#toKey(ref);\r\n\r\n    // if already cached, just apply it\r\n    if (TemplateController.#cache.has(key)) {\r\n      me.#applyTemplate(TemplateController.#cache.get(key));\r\n      return;\r\n    }\r\n\r\n    // prevents double load\r\n    if (me.#hasKey(key)) {\r\n      // already scheduled\r\n      return;\r\n    }\r\n    TemplateController.#refs.add(key);\r\n\r\n    let templates = null;\r\n\r\n    const isTplEl = GSDOM.isTemplateElement(ref);\r\n    const cacheable = GSUtil.isString(ref);\r\n    if (cacheable) {\r\n      templates = TemplateController.#cache.get(key);\r\n    }\r\n\r\n    if (!templates) {\r\n      \r\n      try {\r\n        const template = isTplEl ? ref : await GSTemplateCache.loadTemplate(true, ref, ref);\r\n        templates = me.#preprocessTemplate(template);\r\n      } catch (err) {\r\n        TemplateController.#refs.delete(key);\r\n        throw err;\r\n      }\r\n\r\n      if (cacheable) {\r\n        if (templates.simple) templates.simple.dataset.gsCache = true;\r\n        TemplateController.#cache.set(key, templates);\r\n      }\r\n    }\r\n    \r\n    TemplateController.#refs.delete(key);\r\n    me.#applyTemplate(templates);\r\n  }\r\n\r\n  get isTemplateElement() {\r\n    return this.#host?.tagName === 'GS-TEMPLATE';\r\n  }\r\n\r\n  get template() {\r\n    return this.#template;\r\n  }\r\n\r\n  get templateRef() {\r\n    return GSDOM.templateRef(this.#host);\r\n  }\r\n\r\n  static async #process(tasks) {\r\n    const list = Array.from(tasks);\r\n    for (let item of list) {\r\n      await item.#load();\r\n      tasks.delete(item);\r\n    }\r\n  }\r\n\r\n  static #schedule(task) {\r\n    const me = TemplateController;\r\n    me.#tasks.add(task);\r\n    if (!me.#scheduled) {\r\n      me.#scheduled = true;\r\n      queueMicrotask(() => me.#process(me.#tasks).finally(me.#scheduled = false));\r\n    }\r\n  }\r\n\r\n  static clear() {\r\n    GSTemplateCache.clear();\r\n    TemplateController.#tasks.clear();\r\n    TemplateController.#cache.clear();\r\n    TemplateController.#refs.clear();\r\n  }\r\n\r\n}  \r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\n\r\n/**\r\n * Listens for theme change and update component to apply new theme.\r\n * External theme changes only if component theme is not set.\r\n * Bootstrap uses CSS selector for theme in form of attribute value [data-bs-theme=\"***\"]\r\n * Compoennt and all first level childern in shadow dom are updated\r\n */\r\nexport class ThemeController {\r\n\r\n  #host;\r\n  #theme;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#theme = host.theme;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    ThemeController.#controllers.add(this);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    ThemeController.#controllers.delete(me);\r\n    me.#host.removeController(me);\r\n    me.#host = null;\r\n    me.#theme = null;\r\n  }\r\n\r\n  hostUpdate() {\r\n    const me = this;\r\n    if (me.#theme !== me.#host?.theme) {\r\n      me.#theme === me.#host?.theme;\r\n      me.updateTheme(me.#theme);\r\n    }\r\n  }\r\n\r\n  updateThemeExt(theme) {\r\n    if (!this.#theme) this.updateTheme(theme);\r\n  }\r\n\r\n  updateTheme(theme) {\r\n    if (!theme) return;\r\n    const me = this;\r\n    GSAttr.set(me.#host, 'data-bs-theme', theme);\r\n    const children = me.#host?.renderRoot?.children || [];\r\n    Array.from(children).forEach(el => GSAttr.set(el, 'data-bs-theme', theme));\r\n  }\r\n\r\n  static #controllers = new Set();\r\n\r\n  static #onTheme(e) {\r\n    const me = ThemeController;\r\n    me.#controllers.forEach(c => c.updateThemeExt(e.detail));\r\n  }\r\n\r\n  static #init() {\r\n    GSEvents.on(window, null, 'gs-theme', ThemeController.#onTheme);\r\n  }\r\n\r\n  static {\r\n    ThemeController.#init();\r\n  }\r\n\r\n}  \r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Handle event when template slot changes\r\n */\r\nexport class SlotController {\r\n\r\n    #host;\r\n    \r\n    constructor(host) {\r\n      this.#host = host;\r\n      host.addController(this);\r\n    }\r\n    \r\n    hostConnected() {\r\n      const me = this;\r\n      const target = me.#host.renderRoot || me.#host;\r\n      me.#host.attachEvent(target, 'slotchange', me.#onSlotChanged.bind(me));\r\n    }\r\n    \r\n    hostDisconnected() {\r\n      const me = this;\r\n      me.#host.removeController(me);      \r\n      me.#host = null;\r\n    }\r\n\r\n    #onSlotChanged(e) {\r\n      if (typeof e.target.assignedElements === 'function') {\r\n        e.target.assignedElements().forEach(el => {\r\n          el.onSlotInjected?.(e.target);\r\n        });\r\n      }\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { templateContent, noChange, LitElement } from './lib.mjs';\r\n\r\nimport { GSEvents } from './base/GSEvents.mjs';\r\nimport { GSEnvironment } from './base/GSEnvironment.mjs';\r\nimport { GSFunction } from './base/GSFunction.mjs';\r\nimport { GSLocalization } from './base/GSLocalization.mjs';\r\nimport { AdoptedController } from './controllers/AdoptedController.mjs';\r\nimport { ContentController } from './controllers/ContentController.mjs';\r\nimport { AttributeController } from './controllers/AttributeController.mjs';\r\nimport { LocalizationController } from './controllers/LocalizationController.mjs';\r\nimport { OrientationController } from './controllers/OrientationController.mjs';\r\nimport { TemplateController } from './controllers/TemplateController.mjs';\r\nimport { orientation } from './properties/orientation.mjs';\r\nimport { protocol } from './properties/protocol.mjs';\r\nimport { environment } from './properties/environment.mjs';\r\nimport { ThemeController } from './controllers/ThemeController.mjs';\r\nimport { notEmpty } from './properties/verificator.mjs';\r\nimport { DataController } from './controllers/DataController.mjs';\r\nimport { GSDOM } from './base/GSDOM.mjs';\r\nimport { GSData } from './base/GSData.mjs';\r\nimport { GSUtil } from './base/GSUtil.mjs';\r\nimport { SlotController } from './controllers/SlotController.mjs';\r\nimport { GSAttributeHandler } from './base/GSAttributeHandler.mjs';\r\nimport { GSDOMObserver } from './base/GSDOMObserver.mjs';\r\nimport { GSID } from './base/GSID.mjs';\r\nimport { GSCacheStyles } from './base/GSCacheStyles.mjs';\r\nimport { HANDLER } from \"./base/GSConst.mjs\";\r\n\r\n\r\n/**\r\n * Main WebComponent used by all other GS-* components\r\n */\r\nexport class GSElement extends LitElement {\r\n\r\n  static properties = {\r\n    flat: { type: Boolean },\r\n    rtl: { type: Boolean, reflect: true },\r\n    hide: { type: Boolean, reflect: true },\r\n    padding: { type: Number },\r\n    margin: { type: Number },\r\n    rounded: { type: Boolean },\r\n    bordered: { type: Boolean },\r\n    shadow: { type: Boolean },\r\n    keep: { type: Boolean },\r\n\r\n    onready: {},\r\n    css: {},\r\n    theme: {},\r\n\r\n    os: {},\r\n    browser: {},\r\n    language: { reflect: true, hasChanged: notEmpty },\r\n    environment: environment,\r\n    orientation: orientation,\r\n    protocol: protocol,\r\n\r\n    template: {}\r\n  }\r\n\r\n  #adopted = undefined;\r\n  #uiHandler = undefined;\r\n  #orientation = undefined;\r\n  #localization = undefined;\r\n  #dataController = undefined;\r\n  #slotController = undefined;\r\n  #themes = undefined;\r\n  #template = undefined;\r\n  #content = undefined;\r\n\r\n  #ref = undefined;\r\n  #refs = undefined;\r\n  #refx = undefined;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.css = '';\r\n    me.language = \"\";\r\n    me.#adopted = new AdoptedController(me);\r\n    me.#content = new ContentController(me);\r\n    me.#localization = new LocalizationController(me);\r\n    me.#orientation = new OrientationController(me);\r\n    //me.#template = new TemplateController(me);\r\n    me.#themes = new ThemeController(me);\r\n    me.#slotController = new SlotController(me);\r\n  }\r\n\r\n  attributeChangedCallback(name, oldValue, newValue) {\r\n    super.attributeChangedCallback(name, oldValue, newValue);\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    const me = this;\r\n    const tpl = GSDOM.templateRef(me);\r\n    if (tpl) me.#template = new TemplateController(me);\r\n    if (me.isBindable) me.binded();\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    const me = this;\r\n    GSEvents.detachListeners(this);\r\n    super.disconnectedCallback();\r\n    me.#ref?.clear();\r\n    me.#refs?.clear();\r\n    me.#refx?.clear();\r\n    me.#ref = null;\r\n    me.#refs = null;\r\n    me.#refx = null;\r\n    me.#adopted = null;\r\n    me.#uiHandler = null;\r\n    me.#orientation = null;\r\n    me.#localization = null;\r\n    me.#dataController = null;\r\n    me.#slotController = null;\r\n    me.#themes = null;\r\n    me.#template = null;\r\n    me.#content = null;\r\n    //me.renderOptions = null;\r\n    me.adoptedStyleSheets = [];\r\n    GSCacheStyles.deleteRule(me.#ruleName, true);\r\n    const shadow = me.shadowRoot;\r\n    if (shadow) {\r\n      //if (shadow._$litPart$) shadow._$litPart$ = null;\r\n      shadow.adoptedStyleSheets = [];\r\n      // shadow.innerHTML = '';\r\n      //GSDOM.cleanup(shadow);\r\n      queueMicrotask(() => GSDOM.cleanup(shadow));\r\n    }\r\n    queueMicrotask(() => GSDOM.cleanup(me));\r\n    // GSDOM.cleanup(me);\r\n    // console.log('deleted', me);\r\n  }\r\n\r\n  addController(controller) {\r\n    const me = this;\r\n    if (controller.templateInjected) {\r\n      (me.#controllers ??= new Set()).add(controller);\r\n    }\r\n    super.addController?.(controller);\r\n  }\r\n\r\n  removeController(controller) {\r\n    this.#controllers?.delete(controller);\r\n    super.removeController?.(controller);\r\n  }\r\n\r\n  get #controllers() {\r\n    this[HANDLER] ??= new Set();\r\n    return this[HANDLER];\r\n  }\r\n\r\n  shouldUpdate(changedProperties) {\r\n    return this.isConnected; // && this.isAllowRender;\r\n  }\r\n\r\n  /**\r\n   * Override Lit element createRenderRoot function.\r\n   * If flat, do not create shadowRoot, render within self\r\n   * @returns \r\n   */\r\n  createRenderRoot() {\r\n    return this.flat ? this : super.createRenderRoot();\r\n  }\r\n\r\n  /**\r\n   * Override Lit element firstUpdated function.\r\n   * Here we call attribute script onready if available\r\n   * Make sure that inherited classes calls super.firstUpdated\r\n   */\r\n  firstUpdated() {\r\n    super.firstUpdated();\r\n    const me = this;\r\n    if (me.onready) {\r\n      const owner = me.onready.startsWith('this') ? this : window;\r\n      GSFunction.callFunction(me.onready, owner);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Override Lit element willUpdate function.\r\n   * Make sure that inherited classes calls super.willUpdate\r\n   * @param {*} changed \r\n   */\r\n  willUpdate(changed) {\r\n    const me = this;\r\n    if (changed.has('hide')) {\r\n      me.#updateHide();\r\n    }\r\n    if (changed.has('storage')) {\r\n      me.#updateStorage();\r\n    }\r\n  }\r\n\r\n  get #ruleName() {\r\n    const me = this;\r\n    me.id = me.id ? me.id : GSID.id;\r\n    return `${me.tagName.toLowerCase()}#${me.id}`;\r\n  }\r\n\r\n  #updateHide() {\r\n    const me = this;\r\n    const value = me.hide ? 'none' : '';\r\n    GSCacheStyles.setRule(me.#ruleName, { display: value }, false, true);\r\n  }\r\n\r\n  #updateStorage() {\r\n    const me = this;\r\n    me.#dataController?.hostDisconnected();\r\n    me.#dataController = undefined;\r\n    if (me.storage) {\r\n      me.#dataController = new DataController(me);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Called when this element injected in some slot\r\n   * @param {*} slot \r\n   */\r\n  onSlotInjected(slot) {\r\n\r\n  }\r\n\r\n  /**\r\n   * Override Lit element render function and control rendering\r\n   * @returns {*} Parsed lit html structure\r\n   */\r\n  render() {\r\n    // replaced by #updateHide\r\n    //return this.isAllowRender && !this.hide ? this.renderUI() : '';\r\n    return this.isAllowRender ? this.renderUI() : '';\r\n  }\r\n\r\n  /**\r\n   * Actual render function to override in inherited components\r\n   * @returns {*} Parsed lit html structure\r\n   */\r\n  renderUI() {\r\n    return this.renderTemplate();\r\n  }\r\n\r\n  /**\r\n   * Render html from provided template element or template url\r\n   * @returns {*}\r\n   */\r\n  renderTemplate() {\r\n    return this.templateRef ? templateContent(this.templateRef) : noChange;\r\n  }\r\n\r\n  /**\r\n   * Render this class css attributes.\r\n   * @returns {Object} JSON object with CSS properties\r\n   */\r\n  renderClass() {\r\n    const me = this;\r\n    const obj = {\r\n      'border': me.bordered,\r\n      'shadow-sm': me.shadow,\r\n      'rounded': me.rounded,\r\n      [`p-${me.padding}`]: me.padding >= 0,\r\n      [`m-${me.margin}`]: me.margin >= 0\r\n    };\r\n    return me.mapCSS(me.css, obj);\r\n  }\r\n\r\n  /**\r\n   * Called when asynchronnous template is injected into component\r\n   */\r\n  templateInjected() {\r\n    const me = this;\r\n    me.#controllers?.forEach((c) => c.templateInjected?.(me));\r\n  }\r\n\r\n  /**\r\n   * Attach bindings\r\n   */\r\n  binded() {\r\n    this.#uiHandler ??= new AttributeController(this);\r\n  }\r\n\r\n  /**\r\n   * Handle bindings \r\n   * @param {*} e \r\n   */\r\n  handle(e) {\r\n    this.#uiHandler?.handle(e);\r\n  }\r\n\r\n  /**\r\n   * Parse CSS string into JSON object\r\n   * @param {String} css CSS string to parse into JSON object\r\n   * @param {Object} obj JSON object to which to add parsed CSS\r\n   * @param {boolean} flag Default activation (true|false) for each CSS property\r\n   * @returns {Object} css parsed JSON object \r\n   */\r\n  mapCSS(css, obj, flag = true) {\r\n    obj = obj || {};\r\n    (css || '').split(' ')\r\n      .map(v => v.trim())\r\n      .filter(v => v.length > 0)\r\n      .forEach(v => obj[v.trim()] = flag);\r\n    return obj;\r\n  }\r\n\r\n  /**\r\n   * Initialize dynamic style for component.\r\n   * Call it from constructor for style to be applied to the component\r\n   * Creates a dynamic StyleSheet which holds dynamic StyleRules for template elements\r\n   * @param {String} id \r\n   * @param {String|Object} value \r\n   * @param {boolean} isGlobal \r\n   * @returns {CSSStyleRule}\r\n   */\r\n  dynamicStyle(id, value, isGlobal = false) {\r\n    return this.#adopted?.style(id, value, isGlobal);\r\n  }\r\n\r\n  /**\r\n   * Find element by its ID\r\n   * @param {String} name \r\n   * @returns {HTMLElement}\r\n   */\r\n  getByID(query = '') {\r\n    return GSDOM.getByID(this, query);\r\n  }\r\n\r\n  /**\r\n   * Find closest top element by CSS selector\r\n   * @param {String} query \r\n   * @param {Number} levels - walk limit\r\n   * @returns {HTMLElement}\r\n   */\r\n  closest(query = '', levels = -1, cached = false) {\r\n    const me = this;\r\n\r\n    let result = me.#refx?.get(query);\r\n    if (result && !result.isConnected) {\r\n      result = undefined;\r\n      me.#refx?.delete(query);\r\n    }\r\n    result ??= GSDOM.closest(this, query, levels);\r\n\r\n    if (result && cached && !me.#ref?.has(query)) {\r\n      me.#refx ??= new Map();\r\n      me.#refx.set(query, result);\r\n    }\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Find element by CSS selector (top level is this element)\r\n   * @param {String} name \r\n   * @returns {HTMLElement}\r\n   */\r\n  query(query = '', shadow = false, cached = false) {\r\n    const me = this;\r\n\r\n    let result = me.#refs?.get(query);\r\n    if (result && !result.isConnected) {\r\n      result = undefined;\r\n      me.#refs?.delete(query);\r\n    }\r\n    result ??= GSDOM.query(this, query, false, shadow);\r\n\r\n    if (result && cached && !me.#ref?.has(query)) {\r\n      me.#ref ??= new Map();\r\n      me.#ref.set(query, result);\r\n    }\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Find multiple elements by CSS selector (top level is this element)\r\n   * @param {String} query \r\n   * @returns {Array<HTMLElement>}\r\n   */\r\n  queryAll(query = '', shadow = false, cached = false) {\r\n    const me = this;\r\n    let result = me.#refs?.get(query);\r\n    if (result && !result.isConnected) {\r\n      result = undefined;\r\n      me.#refs?.delete(query);\r\n    }\r\n    result ??= GSDOM.queryAll(this, query, false, shadow);\r\n    if (result && cached && !me.#refs?.has(query)) {\r\n      me.#refs ??= new Map();\r\n      me.#refs.set(query, result);\r\n    }\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Generic component signal\r\n   * @param {Boolean} bubbles  Does buuble to upper nodes\r\n   * @param {Boolean} composed Does traverse from shadow DOM \r\n   */\r\n  notify(bubbles = true, composed = false, data) {\r\n    this.emit('notify', data, bubbles, composed, true);\r\n  }\r\n\r\n  /**\r\n   * Send event\r\n   * @param {String} name \r\n   * @param {Object} obj \r\n   * @param {Boolean} bubbles \r\n   * @param {Boolean} composed \r\n   * @param {Boolean} cancelable \r\n   */\r\n  emit(name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n    return GSEvents.send(this, name, obj, bubbles, composed, cancelable);\r\n  }\r\n\r\n  /**\r\n   * Wait for event to happen\r\n   * @async\r\n   * @param {String} name \r\n   * @returns {Promise}\r\n   */\r\n  waitEvent(name = '', timeout = 0) {\r\n    return GSEvents.wait(this, name, timeout);\r\n  }\r\n\r\n  /**\r\n   * Listen once for triggered event\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @param {Boolean} capture Capture event on the way down\r\n   * @returns {Boolean}\r\n   */\r\n  once(name, func, capture = false) {\r\n    return this.listen(name, func, true, capture);\r\n  }\r\n\r\n  /**\r\n   * Alternative function for event listen\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @param {Boolean} once Listen only once\r\n   * @param {Boolean} capture Capture event on the way down\r\n   * @returns {Boolean}\r\n   */\r\n  on(name, func, once = false, capture = false) {\r\n    return this.listen(name, func, once, capture);\r\n  }\r\n\r\n  /**\r\n   * Alternative function for event unlisten\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  off(name, func) {\r\n    return this.unlisten(name, func);\r\n  }\r\n\r\n  /**\r\n   * Prevent event firing up the DOM tree\r\n   * @param {Event} e \r\n   */\r\n  prevent(e, defaults, propagate, immediate) {\r\n    return GSEvents.prevent(e, defaults, propagate, immediate);\r\n  }\r\n\r\n  /**\r\n   * Attach event to this element\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @param {Boolean} once Listen only once\r\n   * @param {Boolean} capture Capture event on the way down\r\n   * @returns {Boolean}\r\n   */\r\n  listen(name, func, once = false, capture = false) {\r\n    return this.attachEvent(this, name, func, once, capture);\r\n  }\r\n\r\n  /**\r\n   * Remove event from this element\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  unlisten(name, func) {\r\n    return this.removeEvent(this, name, func);\r\n  }\r\n\r\n  /**\r\n  * Generic event listener appender\r\n  * \r\n  * @param {HTMLElement} el Element on which to monitor for named events\r\n  * @param {String} name Event name to watch for\r\n  * @param {Function} fn Event trigger callback\r\n  * @param {Boolean} once Listen only once\r\n  * @param {Boolean} capture Capture event on the way down\r\n  * @returns {Boolean} State if attachment was successful\r\n  */\r\n  attachEvent(el, name = '', fn, once = false, capture = false) {\r\n    return GSEvents.attach(this, el, name, fn, once, capture);\r\n  }\r\n\r\n  /**\r\n  * Generic event listener remove\r\n  * @param {HTMLElement} el Element on which to monitor for named events\r\n  * @param {String} name Event name to watch for\r\n  * @param {Function} fn Event trigger callback\r\n  * @returns {Boolean} State if attachment was successful\t\r\n  */\r\n  removeEvent(el, name = '', fn) {\r\n    return GSEvents.remove(this, el, name, fn);\r\n  }\r\n\r\n  /**\r\n   * Generic element hide function\r\n   */\r\n  toggle() {\r\n    this.hide = !this.hide;\r\n  }\r\n\r\n  translate(value) {\r\n    return GSLocalization.translate(this.language, value);\r\n  }\r\n\r\n  get direction() {\r\n    if (GSUtil.isNull(this.rtl)) return undefined;\r\n    return this.rtl ? 'rtl' : 'ltr';\r\n  }\r\n\r\n  /**\r\n   * Check if component is bindable to process data-gs-atributes\r\n   */\r\n  get isBindable() {\r\n    //return this.dataset.gsTarget;\r\n    return GSAttributeHandler.isBindable(this);\r\n  }\r\n\r\n  /**\r\n   * Return true if current element or chadow dom child is focused\r\n   */\r\n  get isFocused() {\r\n    return this === document.activeElement;\r\n  }\r\n\r\n  /**\r\n   * Element tag name\r\n   */\r\n  get tag() {\r\n    return this.tagName.toLowerCase();\r\n  }\r\n\r\n  /**\r\n   * Reference to cached template if set\r\n   */\r\n  get templateRef() {\r\n    return this.#template?.template;\r\n  }\r\n\r\n  /**\r\n   * Reference to rendered content\r\n   */\r\n  get contentRef() {\r\n    return this.#content?.contentRef;\r\n  }\r\n\r\n  /**\r\n   * Reference to data controller if initialized\r\n   */\r\n  get dataController() {\r\n    return this.#dataController;\r\n  }\r\n\r\n  /**\r\n  * Check if element is allowed to be rendered\r\n  * @returns {Boolean} \r\n  */\r\n  get isAllowRender() {\r\n    // this.isConnected &&\r\n    return this.isValidEnvironment\r\n      && this.isValidBrowser\r\n      && this.isValidOS\r\n      && this.isValidProtocol\r\n      && this.isValidOrientation;\r\n  }\r\n\r\n  /**\r\n   * Returns if environment matched\r\n   * dektop, mobile, tablet, android, linux, winwdows, macos\r\n   * @returns {Boolean} \r\n   */\r\n  get isValidEnvironment() {\r\n    return GSEnvironment.isValidEnvironment(this.environment ?? '');\r\n  }\r\n\r\n  /**\r\n   * Return true if element can be rendered bysed on OS matching\r\n   * linux, windows...etc\r\n   * @returns {Boolean} \r\n   */\r\n  get isValidOS() {\r\n    return GSEnvironment.isDevice(this.os ?? '');\r\n  }\r\n\r\n  /**\r\n   * Returns if orientation matched for element rendering\r\n   * horizontal | landscape), vertical | portrait), ; return true if not set\r\n   * @returns {Boolean} \r\n   */\r\n  get isValidOrientation() {\r\n    return GSEnvironment.isValidOrientation(this.orientation ?? '');\r\n  }\r\n\r\n  /**\r\n   * Returns if browser matched, used to determine rendering/removal\r\n   * @returns {Boolean} \r\n   */\r\n  get isValidBrowser() {\r\n    return GSEnvironment.isValidBrowser(this.browser ?? '');\r\n  }\r\n\r\n  /**\r\n   * Returns if browser matched, used to determine rendering/removal\r\n   * @returns {Boolean} \r\n   */\r\n  get isValidProtocol() {\r\n    return GSEnvironment.isValidProtocol(this.protocol ?? '');\r\n  }\r\n\r\n  /**\r\n   * Internal attribute set if component is generated by other components\r\n   */\r\n  get isGenerated() {\r\n    return this.hasAttribute('generated');\r\n  }\r\n\r\n  /**\r\n   * Get parent GS-* component\r\n   */\r\n  get parentComponent() {\r\n    return GSDOM.parentAll(this).filter(x => x instanceof GSElement).next()?.value;\r\n  }\r\n\r\n  /**\r\n   * Get this class name\r\n   */\r\n  get clazzName() {\r\n    return this.constructor.name;\r\n  }\r\n\r\n  get definitions() {\r\n    const list = [...GSDOM.inheritance(this)].map(o => o.constructor?.properties).filter(o => o);\r\n    list.push(this.constructor?.properties);\r\n    return GSData.mergeObjects(list);\r\n  }\r\n\r\n  /**\r\n   * Get instance of internal styles\r\n   */\r\n  get elementStyles() {\r\n    return this.constructor.elementStyles\r\n      .filter(o => o instanceof CSSStyleSheet || o.styleSheet instanceof CSSStyleSheet)\r\n      .map(o => o.styleSheet || o)\r\n      .pop();\r\n    /*\r\n    .map(s => {\r\n       Object.values(s)\r\n        .filter(o => o instanceof CSSStyleSheet || o instanceof CSSResult)\r\n        .map(o => o.styleSheet || o)\r\n        .pop()\r\n    }).pop();\r\n    */\r\n  }\r\n\r\n  /**\r\n   * Internal shadow styles rule\r\n   * @param {*} name \r\n   * @returns \r\n   */\r\n  cssRule(name) {\r\n    return Array.from(this.elementStyles?.rules ?? []).filter(r => r.selectorText === name).pop();\r\n  }\r\n\r\n  /**\r\n   * Set dynamic CSS rule \r\n   * See GSIcon hot it is done\r\n   * @param {*} rule \r\n   * @param {*} name \r\n   * @param {*} value \r\n   */\r\n  setCSSProperty(rule, name, value) {\r\n    this.cssRule(rule)?.style?.setProperty(name, value);\r\n  }\r\n\r\n  /**\r\n   * Extract and merge all static properties definition from WebComponent instance\r\n   * @param {GSElement} obj \r\n   * @returns {Object}\r\n   */\r\n  static allProperties(obj) {\r\n    return GSDOM.allProperties(obj);\r\n  }\r\n\r\n  /**\r\n   * Register class as WebComponent to the browser\r\n   * @param {String} name \r\n   * @param {class} clazz Optional, if not set, use self\r\n   * @param {Object} opt Options, used only when extending non HTMLElement class  \r\n   */\r\n  static define(name, clazz, opt) {\r\n    return GSDOM.define(name, clazz || this, opt);\r\n  }\r\n\r\n  static {\r\n    GSElement.define('gs-element', GSElement);\r\n    // global document element removal monitor, help GS cleanup\r\n    GSDOMObserver.registerFilter(el => true, el => { GSDOM.cleanup(el) }, true, document.body);\r\n  }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GROUP, DEF } from \"../base/GSConst.mjs\";\r\nimport { GSEvents } from \"../base/GSEvents.mjs\";\r\nimport { GSElement } from \"../GSElement.mjs\";\r\n\r\n/**\r\n * Controller for child element navigation / selection / focusing\r\n * Used for button, navs, tabs and element groups\r\n */\r\nexport class ElementNavigationController {\r\n\r\n  #host;\r\n  #focused;\r\n  #hostUpdated = false;\r\n  #tagName = undefined;\r\n\r\n  #onClickListener = undefined;\r\n  #onKeyUpListener = undefined;\r\n  #onKeyDownListener = undefined;\r\n  #onFocusInListener = undefined;\r\n  #onFocusOutListener = undefined;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#tagName = me.#childTagName;\r\n    me.#onClickListener = me.onClick.bind(me);\r\n    me.#onKeyUpListener = me.onKeyUp.bind(me);\r\n    me.#onKeyDownListener = me.onKeyDown.bind(me);\r\n    me.#onFocusInListener = me.onFocusIn.bind(me);\r\n    me.#onFocusOutListener = me.onFocusOut.bind(me);\r\n\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    const target = me.#target;\r\n    if (target) {\r\n      me.#host.removeEvent(target, 'keydown', me.#onKeyDownListener);\r\n      me.#host.removeEvent(target, 'keyup', me.#onKeyUpListener);\r\n      me.#host.removeEvent(target, 'click', me.#onClickListener);\r\n      me.#host.removeEvent(target, 'focusin', me.#onFocusInListener);\r\n      me.#host.removeEvent(target, 'focusout', me.#onFocusOutListener);\r\n    }    \r\n    me.#host.removeController(me);\r\n    me.#host = null;\r\n  }\r\n\r\n  hostUpdated() {\r\n    const me = this;\r\n    if (!me.#hostUpdated) {\r\n      me.#hostUpdated = true;\r\n      me.firstUpdate();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Called on first update from host component\r\n   */\r\n  firstUpdate() {\r\n    const me = this;\r\n    me.#tagName = me.first?.tagName || '';\r\n    const target = me.#target;\r\n    if (target) {\r\n      me.#host.attachEvent(target, 'keydown', me.#onKeyDownListener);\r\n      me.#host.attachEvent(target, 'keyup', me.#onKeyUpListener);\r\n      me.#host.attachEvent(target, 'click', me.#onClickListener);\r\n      me.#host.attachEvent(target, 'focusin', me.#onFocusInListener);\r\n      me.#host.attachEvent(target, 'focusout', me.#onFocusOutListener);\r\n    }\r\n  }\r\n\r\n  get circular() {\r\n    return this.#host?.circular === true;\r\n  }\r\n\r\n  get multiple() {\r\n    return this.#host?.multiple === true;\r\n  }\r\n\r\n  get focused() {\r\n    return this.#focused;\r\n  }\r\n\r\n  get selected() {\r\n    const me = this;\r\n    const list = me.items.filter(el => el.active);\r\n    return me.multiple ? list : list.pop();\r\n  }\r\n\r\n  get items() {\r\n    const me = this;    \r\n    return Array.from(me.#host.children)\r\n    .filter(el => el.tagName !== 'GS-ITEM')\r\n    .filter(el => me.#tagName ? el.tagName === me.#tagName : true);\r\n  }\r\n\r\n  get first() {\r\n    return this.items.shift();\r\n  }\r\n\r\n  get last() {\r\n    return this.items.pop();\r\n  }\r\n\r\n  /**\r\n   * Element that listens for events\r\n   */\r\n  get #target() {\r\n    return this.#host[DEF] || this.#host.shadowRoot.firstElementChild;\r\n  }\r\n\r\n  /**\r\n   * As default use data-gs-child-tag-name\r\n   */\r\n  get #childTagName() {\r\n    const me = this;\r\n    return (me.#host.dataset.gsChildTagName || me.#host[GROUP] || '').toUpperCase();\r\n  }\r\n\r\n  previous() {\r\n    const me = this;\r\n    let el = me.#focused?.previousElementSibling;\r\n    while (el?.disabled) el = el.previousElementSibling;\r\n    if (me.circular && !el) el = me.last;\r\n    el?.focus();\r\n  }\r\n\r\n  next() {\r\n    const me = this;\r\n    let el = me.#focused?.nextElementSibling;\r\n    while (el?.disabled) el = el.nextElementSibling;\r\n    if (me.circular && !el) el = me.first;\r\n    el?.focus();\r\n  }\r\n\r\n  /**\r\n   * Reset focus / selection\r\n   */\r\n  reset() {\r\n    const me = this;\r\n    const active = me.selected;\r\n    if (me.multiple) {\r\n      active.forEach(el => {\r\n        el.active = false;\r\n        el.blur();\r\n      });\r\n    } else if (active) {\r\n      active.active = false;\r\n      active.blur();\r\n    }\r\n    me.#focused = undefined;\r\n    me.#host?.onReset?.(el);\r\n    me.#host?.emit('group-reset', undefined, true);\r\n  }\r\n\r\n  /**\r\n   * Callback when child element selected\r\n   * @param {*} el \r\n   */\r\n  #onSelected(el) {\r\n    const me = this;\r\n    me.#host?.onSelected?.(el);\r\n    me.#host?.emit('group-selected', el, true);\r\n  }\r\n\r\n  /**\r\n   * Callback when child element deselected\r\n   * @param {*} el \r\n   */\r\n  #onDeselected(el) {\r\n    this.#host?.onDeselected?.(el);\r\n    this.#host?.emit('group-deselected', el, true);\r\n  }\r\n\r\n  /**\r\n   * Callback when child element focused\r\n   * @param {*} el \r\n   */\r\n  #onFocused(el) {\r\n    this.#host?.onFocused?.(el);\r\n    this.#host?.emit('group-focused', el, true);\r\n  }\r\n\r\n  /**\r\n   * Element navigation filter where we can select if focused element is navigable\r\n   * @param {*} el \r\n   * @returns \r\n   */\r\n  #isNavigable(el) {\r\n    return el?.tagName === this.#tagName || el?.isNav || false;\r\n  }\r\n\r\n\r\n  #focus(el) {\r\n    const me = this;\r\n    me.#focused = el;\r\n    if (el) {\r\n      me.#onFocused(me.#focused);\r\n    }\r\n  }\r\n\r\n  #toggle(el) {\r\n    const me = this;\r\n    if (el.active) {\r\n      me.#onSelected(el);\r\n    } else {\r\n      me.#onDeselected(el);\r\n    }\r\n  }\r\n\r\n  #select(el) {\r\n    const me = this;\r\n    const active = me.selected;\r\n    if (active && !me.multiple) {\r\n      active.active = false;\r\n      me.#toggle(active);\r\n    }\r\n\r\n    if (me.multiple) {\r\n      el.active = !el.active;\r\n    } else {\r\n      el.active = true;\r\n    }\r\n    me.#toggle(el);\r\n  }\r\n\r\n  onFocusOut(e) {\r\n    const me = this;\r\n    //if (me.#focused === e.target) me.#focused = undefined;\r\n  }\r\n\r\n  onFocusIn(e) {\r\n    const me = this;\r\n    if(me.#isNavigable(e.target)) {\r\n      if(me.#isNavigable(e.relatedTarget)) {\r\n        me.#focus(e.target)\r\n      } else if (me.multiple) {\r\n        me.selected?.pop?.()?.focus?.();\r\n      } else {\r\n        me.selected?.focus();\r\n      }\r\n    }\r\n  }\r\n\r\n  onClick(e) {\r\n    const me = this;\r\n    const el = e.composedPath()\r\n    .filter(el => el instanceof GSElement)\r\n    .filter(el => el.parentComponent === me.#host).pop();\r\n    if(me.#isNavigable(e.target)) {\r\n      if (e.ctrlKey) me.reset();\r\n      me.#onDeselected(me.selected);\r\n      me.#select(el);\r\n    }\r\n  }\r\n\r\n  onKeyDown(e) {    \r\n    const me = this;\r\n    if(me.#isNavigable(e.target)) {\r\n      switch (e.code) {\r\n        case 'ArrowUp':\r\n        case 'ArrowLeft':\r\n          me.previous();\r\n          break;\r\n        case 'ArrowDown':\r\n        case 'ArrowRight':\r\n          me.next();\r\n          break;\r\n        case 'Space':\r\n        case 'Enter':\r\n          GSEvents.prevent(e);\r\n          break;        \r\n      }\r\n    }\r\n  }\r\n\r\n  onKeyUp(e) {\r\n    const me = this;\r\n    if(me.#isNavigable(e.target)) {\r\n      switch (e.code) {\r\n        case 'Space':\r\n        case 'Enter':\r\n          //me.#focused?.click();\r\n          e.target.click();\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSEventBus } from \"../base/GSEventBus.mjs\";\r\n\r\n/**\r\n * Controller for multiple elements groups\r\n */\r\nexport class GroupController {\r\n\r\n  #host;\r\n\r\n  #busEvent;\r\n  #busCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    if (me.#host.group) {\r\n      me.#busCallback = me.#onBusEvent.bind(me);\r\n      me.#busEvent = GSEventBus.register(me.#host.clazzName);\r\n      me.#busEvent.on(me.#host.group, me.#busCallback);\r\n    }\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#busEvent?.off(me.#host.group, me.#busCallback);\r\n    me.#host.removeController(me);\r\n    me.#host = null;\r\n  }\r\n\r\n  #onBusEvent(e) {\r\n    this.#host.onBusEvent?.(e);\r\n  }\r\n\r\n  notify(data) {\r\n    const me = this;\r\n    me.#busEvent?.emit(me.#host.group, {owner: me.#host, item:data}); \t\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSRouter } from '../base/GSRouter.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { html } from '../lib1.mjs';\r\n\r\nexport class GSRouterElement extends GSElement {\r\n\r\n  #router = null;\r\n\r\n  static properties = {\r\n    url: {},\r\n    disabled: { type: Boolean },\r\n    logging: { type: Boolean }\r\n  };\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.id = GSID.next();\r\n    me.logging = false;\r\n    me.#router = new GSRouter(me);\r\n    me.#router.log = false;\r\n  }\r\n\r\n  renderUI() {\r\n    //return super.renderUI();\r\n    return html`<slot><slot/>`;\r\n  }\r\n\r\n  updated(changed) {\r\n    const me = this;\r\n    me.#router.log = me.logging;\r\n    if (changed.has('url')) {\r\n      me.#router.initialize(me.url);\r\n    }\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    const me = this;\r\n    me.#router?.disable();\r\n    me.#router = null;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-router');\r\n  }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\n\r\nexport class GSAccordionElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    autoclose: { type: Boolean },\r\n    cssItem: { reflect: true, attribute: 'css-item' },\r\n    cssHeader: { reflect: true, attribute: 'css-header' },\r\n    cssBody: { reflect: true, attribute: 'css-body' },\r\n    data: { type: Array }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.data = this.settings;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\"\r\n       @notify=\"${me.#onNotify.bind(me)}\"\r\n       @click=\"${me.#onClick}\" \r\n       @keyup=\"${me.#onKeyUp}\" \r\n       class=\"accordion ${classMap(me.renderClass())}\">\r\n       ${this.#renderItems()}\r\n       <slot></slot></div>`\r\n  }\r\n\r\n  get items() {\r\n    return this.queryAll('gs-accordion-item', false, true);\r\n  }\r\n\r\n  get settings() {\r\n    const cfg = this.constructor.properties;\r\n    return GSItem.collect(this).map(el => GSAttr.proxify(el, cfg));\r\n  }\r\n\r\n  close() {\r\n    this.#state(false);\r\n  }\r\n\r\n  open() {\r\n    this.#state(true);\r\n  }\r\n\r\n  onDataRead(data) {\r\n    this.data = data;\r\n  }\r\n\r\n  #renderItems() {\r\n    return this.data.map(o => {\r\n      return html`<gs-accordion-item generated\r\n        .opened=\"${ifDefined(o.disabled === true)}\" \r\n        message=\"${ifDefined(o.message)}\" \r\n        template=\"${ifDefined(o.template)}\" \r\n        title=\"${ifDefined(o.title)}\"></gs-accordion-item>`;\r\n    });\r\n  }\r\n\r\n  #state(val = false) {\r\n    this.items.forEach(el => el.opened = val);\r\n    this.notify();\r\n  }\r\n\r\n  #onNotify(e) {\r\n    const me = this;\r\n    if (me.autoclose && e.target.opened) {\r\n      me.items.filter(el => el != e.target).forEach(el => el.opened = false);\r\n    }\r\n  }\r\n\r\n  #onClick(e) {\r\n    const isItemCloser = e?.composedPath()[0]?.matches('.accordion-button');\r\n    if(isItemCloser) e.target.toggle?.();\r\n  }\r\n\r\n  #onKeyUp(e) {\r\n    switch (e.code) {\r\n      case 'ArrowLeft':\r\n        e.target.close?.();\r\n        break;\r\n      case 'ArrowRight':\r\n        e.target.open?.();\r\n        break;\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-accordion');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { html } from '../lib.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSAccordionItemElement extends GSElement {\r\n\r\n  static properties = {\r\n    cssHeader: { reflect: true, attribute: 'css-header' },\r\n    cssBody: { reflect: true, attribute: 'css-body' },\r\n    message: { reflect: true, },\r\n    title: { reflect: true, },\r\n    opened: { type: Boolean, reflect: true },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  shouldUpdate(changedProperties) {\r\n    return this.owner?.tagName === 'GS-ACCORDION';\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const owner = me.owner;\r\n    const cssHeader = me.cssHeader || owner?.cssHeader;\r\n    const cssBody = me.cssBody || owner?.cssBody;\r\n    return html`<div class=\"accordion-item ${me.css}\">\r\n             <h2 class=\"accordion-header\">\r\n               <button type=\"button\" \r\n                class=\"accordion-button  ${cssHeader} ${me.opened ? '' : 'collapsed'}\"> \r\n                 ${me.translate(me.title)}\r\n               </button>\r\n             </h2>\r\n             <div class=\"accordion-collapse collapse  ${cssBody} ${me.opened ? 'show' : ''}\">\r\n               <div class=\"accordion-body\">\r\n                   ${me.translate(me.message)}\r\n                   ${me.renderTemplate()}\r\n                   <slot></slot>\r\n               </div>\r\n             </div>      \r\n     </div>`\r\n  }\r\n\r\n  open() {\r\n    this.notify(true);\r\n  }\r\n  \r\n  close() {\r\n    this.notify(false);\r\n  }\r\n\r\n  toggle() {\r\n    this.notify(!this.opened);\r\n  }\r\n\r\n  notify(val = false) {\r\n    const me = this;\r\n    me.opened = val;\r\n    super.notify();\r\n  }\r\n\r\n  get owner() {\r\n    return this.closest('gs-accordion') || GSDOM.component(this);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-accordion-item');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, ref, html, ifDefined } from '../lib.mjs';\r\nimport { color } from '../properties/index.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\n\r\nexport class GSAlertElement extends GSElement {\r\n\r\n    static properties = {\r\n        message: { reflect: true },\r\n        color: { ...color },\r\n        closed: { reflect: true, type: Boolean },\r\n        closable: { reflect: true, type: Boolean },\r\n        delay: { reflect: true, type: Number },\r\n    }\r\n\r\n    #ref;\r\n    #pause = false;\r\n    #interval = 0;\r\n    #last = 0;\r\n    #data;\r\n\r\n    constructor() {\r\n        super();\r\n        this.delay = 1;\r\n        this.#ref = createRef();\r\n        this.#data = this.#proxify(this);\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        clearInterval(this.#interval);\r\n        super.disconnectedCallback();\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div role=\"alert\" dir=\"${ifDefined(me.direction)}\" ${ref(me.#ref)} \r\n            @mouseover=\"${() => me.#pause = true}\"\r\n            @mouseout=\"${() => me.#pause = false}\"\r\n            class=\"alert fade ${classMap(me.renderClass())}\" >\r\n            ${me.#first}\r\n            ${me.renderTemplate()}\r\n            <slot></slot>\r\n            ${me.#second}\r\n        </div>`;\r\n    }\r\n\r\n    firstUpdated(changed) {\r\n        this.#handleBillboard();\r\n        super.firstUpdated(changed);\r\n    }\r\n\r\n    updated(changed) {\r\n        if (!changed.has('opened')) return;\r\n        this.#handleBillboard();\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            'show': !me.closed,\r\n            'alert-dismissible': me.closable,\r\n            [`alert-${me.color}`]: me.color,\r\n\r\n        }\r\n        return css;\r\n    }\r\n\r\n    open() {\r\n        this.notify(false);\r\n    }\r\n\r\n    close() {\r\n        this.notify(true);\r\n    }\r\n\r\n    toggle() {\r\n        this.notify(!this.closed);\r\n    }\r\n\r\n    notify(val = false) {\r\n        const me = this;\r\n        me.closed = val;\r\n        if (me.closed) setTimeout(() => { me.#ref.value.classList.toggle('d-none', true) }, 250);\r\n        super.notify();\r\n    }\r\n\r\n    get isBillboard() {\r\n        return this.#data?.length > 0;\r\n    }\r\n\r\n    get #message() {\r\n        return this.translate(this.message);\r\n    }\r\n\r\n    get #first() { return this.rtl ? this.#button : this.#message; };\r\n\r\n    get #second() { return this.rtl ? this.#message : this.#button; };\r\n\r\n    get #button() {\r\n        return this.closable ? html`<button type=\"button\" class=\"btn-close\" aria-label=\"Close\" @click=\"${this.close}\"></button>` : '';\r\n    }\r\n\r\n    /**\r\n     * Proxify GS-ITEM elements to easily read attributes\r\n     */\r\n    #proxify(root) {\r\n        return GSItem.collect(root).map(el => GSAttr.proxify(el, {message:{}}));\r\n    }\r\n\r\n    #handleBillboard() {\r\n        const me = this;\r\n        if (me.closed) {\r\n            clearInterval(me.#interval);\r\n            me.#interval = 0;\r\n        } else {\r\n            me.#billboard();\r\n        }        \r\n    }\r\n\r\n    #billboard() {\r\n        const me = this;\r\n        if (!me.isBillboard) return;\r\n        const items = me.#data;\r\n        if (me.message) {\r\n            me.#last = -1;\r\n        } else {\r\n            me.message = items[0].message;\r\n        }\r\n        me.#interval = setInterval(() => {\r\n            if (me.#pause) return;\r\n            me.#last++;\r\n            if (me.#last >= items.length ) me.#last = 0;\r\n            me.message = items[me.#last].message;\r\n        }, me.delay * 1000);\r\n    }\r\n\r\n    static {\r\n        this.define('gs-alert');\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, ifDefined, html, ref, createRef } from '../lib.mjs';\r\nimport { color, size, buttonType, ButtonTypes, SizeTypes } from '../properties/index.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSButtonElement extends GSElement {\r\n\r\n  static properties = {\r\n    type: { ...buttonType }, // reset, submit\r\n    size: { ...size }, // small, large, normal\r\n    color: { ...color },\r\n    clickCss: { attribute : 'click-css'},\r\n    hoverCss: { attribute : 'hover-css'},\r\n    toggleColor: { ...color, attribute : 'toggle-color' },\r\n    autofocus: { type: Boolean },\r\n    disabled: { type: Boolean, reflect: true },\r\n    outline: { type: Boolean, reflect: true },\r\n    active: { type: Boolean, reflect: true },\r\n    toggling: { type: Boolean },\r\n    icon: {},\r\n    title: {},\r\n    tooltip: {},\r\n    text: {},\r\n    url: {}\r\n  };\r\n\r\n  #refEl = createRef();\r\n  #refIco = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    this.type = 'button';\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    if (this.autofocus && !this.disabled) this.focus();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<button is=\"gs-ext-button\" part=\"button\" role=\"button\"\r\n        data-gs-type=\"${me.dataset.gsType || ''}\" \r\n        ${ref(me.#refEl)}\r\n        dir=\"${ifDefined(me.direction)}\"\r\n        type=\"${ifDefined(me.type)}\" \r\n        class=\"btn ${classMap(me.renderClass())}\" \r\n        title=\"${ifDefined(me.#tooltip)}\"\r\n        ?disabled=${me.disabled}\r\n        @mouseover=\"${me.#onMouseOver}\"\r\n        @mouseout=\"${me.#onMouseOut}\"\r\n        @disabled=\"${me.#onDisabled}\"\r\n        @click=\"${me.#onClick}\">\r\n          ${me.#first} ${me.#second}</button>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const size = SizeTypes[me.size];\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'active': me.active,\r\n      'focus-ring': document.activeElement === me,\r\n      [`text-${me.text}`]: me.text,\r\n      [`btn-${size}`]: size,\r\n      [`btn-outline-${me.color}`]: me.outline,\r\n      [`btn-${me.color}`]: !me.outline && me.color,\r\n      [`btn-${me.toggleColor}`]: me.active && me.toggleColor,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  click() {\r\n    this.#refEl.value?.click();\r\n  }\r\n\r\n  focus() {\r\n    requestAnimationFrame(() => this.#refEl.value?.focus());\r\n  }\r\n\r\n  toggle() {\r\n    this.active = !this.active;\r\n  }\r\n\r\n  #onClick(e) {\r\n    const me = this;\r\n    if(me.toggling) me.toggle();\r\n    me.iconEl?.animate?.();\r\n    me.#onHref(e)\r\n    if (me.dataset.event) return me.emit(me.dataset.event, null, me.dataset.bubbles, me.dataset.composed, true);\r\n    if (me.isReset) return me.form?.reset();\r\n    if (me.isSubmit) return me.form?.submit();\r\n    me.notify();\r\n  }\r\n\r\n  #onDisabled(e) {\r\n    this.disabled = this.buttonEl.disabled;\r\n  }\r\n\r\n  #onHref(e) {\r\n    const me = this;\r\n    if (!me.url) return;\r\n    if (me.url.startsWith('#')) {\r\n      location.hash = me.url;\r\n    } else {\r\n      location.href = me.url;\r\n    }\r\n  }\r\n\r\n  #onMouseOver() {\r\n    this.iconEl?.hover?.(true);\r\n  }\r\n\r\n  #onMouseOut() {\r\n    this.iconEl?.hover?.(false);\r\n  }\r\n\r\n  get isReset() {\r\n    return ButtonTypes.isReset(this.type);\r\n  }\r\n\r\n  get isSubmit() {\r\n    return ButtonTypes.isSubmit(this.type);\r\n  }\r\n\r\n  get iconEl() {\r\n    return this.#refIco.value;\r\n  }\r\n\r\n  get buttonEl() {\r\n    return this.#refEl.value;\r\n  }\r\n  \r\n\r\n  get form() {\r\n    return this.closest('gs-form, form');\r\n  }\r\n\r\n  get #title() {\r\n    return this.translate(this.title);\r\n  }\r\n\r\n  get #tooltip() {\r\n    return this.translate(this.tooltip);\r\n  }\r\n\r\n  get #first() { return this.rtl ? this.#title : this.#iconHtml; };\r\n\r\n  get #second() { return this.rtl ? this.#iconHtml : this.#title; };\r\n\r\n  get #iconHtml() { return this.icon ? this.#renderIcon : html`<slot name=\"icon\"></slot>`; }\r\n\r\n  get #renderIcon() {\r\n    return  html`\r\n    <gs-icon ${ref(this.#refIco)} \r\n    name=\"${this.icon}\" \r\n    click-css=\"${ifDefined(this.clickCss)}\" \r\n    hover-css=\"${ifDefined(this.hoverCss)}\" \r\n    data-delay=\"1\"></gs-icon>`;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-button');\r\n  }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { unsafeHTML, classMap, html, ifDefined, css } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSDate } from '../base/GSDate.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { notEmpty, numGE0 } from '../properties/index.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\nexport class GSCalendarElement extends GSElement {\r\n\r\n  static styles = css`.year::-webkit-outer-spin-button,.year::-webkit-inner-spin-button {-webkit-appearance: none;margin: 0;} .year {-moz-appearance: textfield;} .day:focus{font-weight: bold;}`\r\n\r\n  static properties = {\r\n    date: {},\r\n    target: {},\r\n    format: { hasChanged: notEmpty },\r\n    editable: { type: Boolean },\r\n    range: { type: Number },\r\n    year: { type: Number },\r\n    month: { type: Number, hasChanged: numGE0 },\r\n    day: { type: Number, hasChanged: numGE0 },\r\n    minYear: { attribute: 'year-min', type: Number },\r\n    maxYear: { attribute: 'year-max', type: Number },\r\n    arrovPrev: { attribute: 'arrow-prev' },\r\n    arrowNext: { attribute: 'arrow-next' },\r\n    cssDays: { attribute: 'css-days' },\r\n    cssToday: { attribute: 'css-today' },\r\n    cssWeeks: { attribute: 'css-weeks' },\r\n    cssMonth: { attribute: 'css-month' },\r\n    cssYear: { attribute: 'css-year' },\r\n    cssNav: { attribute: 'css-nav' },\r\n    cssHeader: { attribute: 'css-header' },\r\n    cssSelected: { attribute: 'css-selected' },\r\n  }\r\n\r\n  #date;\r\n  #selected;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.#date = new GSDate();\r\n    me.#date.day = 1;\r\n    me.#selected = new GSDate();\r\n    me.#date.language = GSUtil.language;\r\n    me.#selected.language = GSUtil.language;\r\n    \r\n    me.language = GSUtil.language;\r\n    me.day = me.#selected.day;\r\n    me.month = me.#selected.month;\r\n    me.year = me.#selected.year;\r\n    \r\n    me.editable = false;\r\n    me.range = 5;\r\n    me.minYear = 1900;\r\n    me.maxYear = 2100;\r\n    me.arrowPrev = '&#10094;';\r\n    me.arrowNext = '&#10095;';\r\n    me.cssNav = 'btn-light';\r\n    me.cssToday = 'btn-secondary';\r\n    me.cssSelected = 'btn-primary';\r\n    me.cssWeeks = 'fw-bold text-bg-dark';\r\n    me.cssYear = 'form-control fs-5 fw-bold border-0 text-center m-1 p-0';\r\n    me.cssMonth = 'form-control fs-3 fw-bold border-0 text-center m-1 p-0';\r\n  }\r\n\r\n  get date() {\r\n    const me = this;\r\n    //return this.#date.toISOString();\r\n    return new Proxy(this.#date, {\r\n      set(target, prop, value) {\r\n        if (typeof target[prop] != 'function') {\r\n          target[prop] = value;\r\n          me.#update();\r\n        }\r\n        return true;\r\n      },\r\n      get(target, prop, receiver) {\r\n        const value = target[prop];\r\n        if (value instanceof Function) {\r\n          return function (...args) {\r\n            try {\r\n              return value.apply(this === receiver ? target : this, args);\r\n            } finally {\r\n              me.#update();\r\n            }\r\n          };\r\n        }\r\n        return value;\r\n      }\r\n    });\r\n  }\r\n\r\n  previousMonth() {\r\n    const me = this;\r\n    if (me.month == 0) {\r\n      me.month = 11;\r\n      me.year--;\r\n    } else {\r\n      me.month--;\r\n    }\r\n  }\r\n\r\n  nextMonth() {\r\n    const me = this;\r\n    if (me.month == 11) {\r\n      me.month = 0;\r\n      me.year++;\r\n    } else {\r\n      me.month++;\r\n    }\r\n  }\r\n\r\n  previousYear() {\r\n    this.year--;\r\n  }\r\n\r\n  nextYear() {\r\n    this.year++;\r\n  }\r\n\r\n  formatted(date) {\r\n    const me = this;\r\n    return (date || me.#date).format(me.format, me.language);\r\n  }\r\n\r\n  updated() {\r\n    const me = this;\r\n    const date = new GSDate(me.#date);\r\n    me.#updateTarget(date);\r\n    me.emit('date', { type: 'calendar', date: date, val: me.formatted(date) }, true, true);\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    me.#date.day = 1;\r\n    me.#date.month = me.month;\r\n    me.#date.year = me.year;\r\n    me.#date.day = me.day;\r\n    me.#date.language = me.language;\r\n\r\n    const week = GSDate.dayList(true, me.language).map(v => html`<div class=\"col\">${v}</div>`);\r\n    const months = me.#monthsHTML();\r\n    const year = me.#yearHTML();\r\n\r\n    return html`\r\n          <div class=\"container-fluid text-center ${classMap(me.renderClass())}\"\r\n          dir=\"${ifDefined(me.direction)}\"\r\n          @keydown=\"${me.#onKey}\"\r\n          @click=\"${me.#onDay}\">\r\n          <div class=\"row align-items-center ${me.cssHeader} header\">\r\n              <div class=\"col-auto\">\r\n                  <a href=\"#\" @click=\"${me.previousMonth}\" class=\"btn ${me.cssNav} arrow prev\">${unsafeHTML(me.arrowPrev)}</a>\r\n              </div>\r\n              <div class=\"col\"></div>\r\n              <div class=\"col-auto\">\r\n                  ${months}\r\n                  ${year}\r\n              </div>\r\n              <div class=\"col\"></div>\r\n              <div class=\"col-auto\">\r\n                  <a href=\"#\" @click=\"${me.nextMonth}\" class=\"btn ${me.cssNav} arrow next\">${unsafeHTML(me.arrowNext)}</a>\r\n              </div>\r\n          </div>\r\n          <div class=\"row weeks ${me.cssWeeks}\">${week}</div>\r\n          ${unsafeHTML(me.#daysHTML())}\r\n      </div>`;\r\n  }\r\n\r\n  #updateTarget(date) {\r\n    const me = this;\r\n    if (!me.target) return;\r\n    const tgt = GSDOM.query(document.documentElement, me.target);\r\n    if (!tgt) return;\r\n\r\n    if (tgt instanceof HTMLInputElement) {\r\n      if (tgt.type === 'date') return tgt.valueAsDate = date;\r\n      return tgt.value = me.formatted(date);\r\n    }\r\n    GSDOM.setHTML(tgt, me.formatted(date));\r\n  }\r\n\r\n  #update() {\r\n    const me = this;\r\n    me.#selected.day = 1;\r\n    me.#selected.month = me.#date.month;\r\n    me.#selected.year = me.#date.year;\r\n    me.#selected.day = me.#date.day;\r\n    me.#selected.language = me.#date.language;\r\n\r\n    me.day = me.#date.day;\r\n    me.month = me.#date.month;\r\n    me.year = me.#date.year;\r\n    me.language = me.#date.language;\r\n  }\r\n\r\n  #isToday(v, date) {\r\n    const me = this;\r\n    return v && GSUtil.asNum(v) === date.day && date.month === me.#date.month && me.#date.year === date.year;\r\n  }\r\n\r\n  #daysHTML() {\r\n    const me = this;\r\n    const today = new GSDate();\r\n    today.language = me.language;\r\n    const list = me.#date.build(me.language);\r\n    const result = list\r\n      .map(v => {\r\n        const c1 = me.#isToday(v, today) ? me.cssToday : '';\r\n        const c2 = me.#isToday(v, me.#selected) ? me.cssSelected : '';\r\n\r\n        const d = v ? `<a tabindex=\"0\" href=\"#\" class=\"btn shadow-none ${c2} ${c1} day\" data-day=\"${v}\">${v}</a>` : ''\r\n        return `<div class=\"col p-0\">${d}</div>`;\r\n      })\r\n      .map((v, i) => {\r\n        if (i === 0) return `<div class=\"row days\">${v}`;\r\n        const isBreak = i % 7 == 0;\r\n        return isBreak ? `</div><div class=\"row days\">${v}` : v;\r\n      });\r\n    result.push('</div>');\r\n    return result.join('');\r\n  }\r\n\r\n  #monthsHTML() {\r\n    const me = this;\r\n    const current = me.#date.MMMM.toLowerCase();\r\n    const months = GSDate.monthList(false, me.language);\r\n    const list = months.map((v, i) => html`<option value=\"${i}\" selected=${ifDefined(current == v.toLowerCase() ? true : undefined)}>${v}</option>`);\r\n    return html`<select @change=\"${me.#onMonth}\" name=\"month\" class=\"month ${me.cssMonth}\" value=\"${months.indexOf(current)}\">${list}</select>`;\r\n  }\r\n\r\n  #yearHTML() {\r\n\r\n    const me = this;\r\n\r\n    const options = [];\r\n    let minYear = me.minYear;\r\n    let maxYear = me.maxYear;\r\n\r\n    if (me.range > 0) {\r\n      const year = new GSDate().year;\r\n      minYear = year - me.range;\r\n      maxYear = year + me.range;\r\n      me.#optionsHTML(options, minYear, maxYear);\r\n    }\r\n\r\n    if (!me.editable) {\r\n      return html`<select @change=\"${me.#onYear}\" name=\"year\" class=\"year ${me.cssYear}\" data-gs-min=\"${minYear}\" data-gs-max=\"${maxYear}\">${options}</select>`;\r\n    }\r\n\r\n    const isList = me.editable && me.range && options.length > 0;\r\n    const listID = isList ? GSID.next : null;\r\n    const list = isList ? html`<datalist id=\"${listID}\">${options}</datalist>` : '';\r\n\r\n    return html`<input name=\"year\" \r\n      type=\"number\" \r\n      list=\"${ifDefined(listID)}\"\r\n      class=\"year ${me.cssYear}\" \r\n      @change=\"${me.#onYear}\" \r\n      min=\"${minYear}\" \r\n      max=\"${maxYear}\"\r\n      value=\"${me.#date.getFullYear()}\">\r\n      ${list}`;\r\n  }\r\n\r\n  #optionsHTML(options, minYear = 0, maxYear = 0) {\r\n    const me = this;\r\n    let val = minYear;\r\n    while (val <= maxYear) {\r\n      if (me.editable) {\r\n        options.push(html`<option value=\"${val}\" selected=${ifDefined(val == me.year ? true : undefined)}>`);\r\n      } else {\r\n        options.push(html`<option value=\"${val}\" selected=${ifDefined(val == me.year ? true : undefined)}>${val}</option>`);\r\n      }\r\n      val++;\r\n    }\r\n\r\n    return options;\r\n  }\r\n\r\n  #onDay(e) {\r\n    GSEvents.prevent(e);\r\n    if (!e.target.classList.contains('day')) return;\r\n    const me = this;\r\n    const day = GSUtil.asNum(e.target.dataset.day, me.day);\r\n\r\n    me.#selected.day = 1;\r\n    me.#selected.month = me.month;\r\n    me.#selected.year = me.year;\r\n    me.#selected.day = day;\r\n\r\n    me.day = day;\r\n  }\r\n\r\n  #onMonth(e) {\r\n    this.month = e.target.selectedIndex;\r\n  }\r\n\r\n  #onYear(e) {\r\n    const yearEl = e?.target;\r\n    if (yearEl?.validity.valid) {\r\n      this.year = yearEl.value;\r\n    }\r\n  }\r\n\r\n  #onKey(e) {\r\n    // console.log(e);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-calendar');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, css, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { placement, PlacementTypes } from '../properties/placement.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\nexport class GSCardElement extends GSElement {\r\n\r\n  static styles = css`.card-header, .card-footer{ background-color: inherit; color: inherit;}`;\r\n\r\n  static properties = {\r\n\r\n    imageStyle: { type: Object, attribute: 'image-style', reflect : true },\r\n\r\n    overlay: { type: Boolean },\r\n    placement: { ...placement },\r\n    align: { ...placement },\r\n\r\n    image: {},\r\n    title: {},\r\n    subtitle: {},\r\n    text: {},\r\n    footer: {},\r\n    header: {},\r\n\r\n    colorText: { attribute: 'color-text' },\r\n    colorBack: { attribute: 'color-back' },\r\n    colorBorder: { attribute: 'color-border' },\r\n\r\n    cssTitle: { attribute: 'css-title' },\r\n    cssSubtitle: { attribute: 'css-subtitle' },\r\n    cssText: { attribute: 'css-text' },\r\n    cssFooter: { attribute: 'css-footer' },\r\n    cssHeader: { attribute: 'css-header' },\r\n    cssBody: { attribute: 'css-body' },\r\n    cssImage: { attribute: 'css-image' },\r\n\r\n  }\r\n\r\n  #styleID = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    this.border = false;\r\n    this.shadow = false;\r\n    this.align = 'start';\r\n    this.placement = 'top';\r\n    this.imageStyle = this.imageStyle || {};\r\n    this.dynamicStyle(this.#styleID);\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const content =  me.isVertical ? me.#renderVertical() : me.#renderHorizontal();\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\" class=\"card ${classMap(me.renderClass())}\">${content}</div>`;\r\n  }\r\n\r\n  #renderVertical() {\r\n    const me = this;\r\n    return [me.#imageTop, me.#header, me.#body, me.#footer, me.#imageBottom];\r\n  }\r\n\r\n  #renderHorizontal() {\r\n    const me = this;\r\n    const start = PlacementTypes.isBefore(me.placement);\r\n    const startClass = start ? 'col-4' : 'col-8';\r\n    const endClass = start ? 'col-8' : 'col-4';\r\n    const startHtml = start ? me.#images : me.#body;\r\n    const endHtml =  start ? me.#body : me.#images;\r\n    return html`<div class=\"row g-0\">\r\n        <div class=\"${startClass}\">\r\n            ${startHtml}\r\n        </div>\r\n        <div class=\"${endClass}\">\r\n          ${endHtml}\r\n        </div>\r\n      </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      border: me.border || me.colorBorder,\r\n      [`text-${me.align}`]: me.align,\r\n      [`text-${me.colorText}`]: me.colorText,\r\n      [`bg-${me.colorBack}`]: me.colorBack,\r\n      [`border-${me.colorBorder}`]: me.colorBorder,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  get isVertical() {\r\n    return PlacementTypes.isVertical(this.placement);\r\n  }\r\n\r\n  get isHorizontal() {\r\n    return PlacementTypes.isHorizontal(this.placement);\r\n  }\r\n\r\n  get #body() {\r\n    const me = this;\r\n    return html`<div class=\"${me.overlay ? 'card-img-overlay' : 'card-body'} ${me.cssBody}\">\r\n      <h5 class=\"card-title  ${me.cssTitle}\"><slot name=\"title\">${me.translate(me.title)}</slot></h5>\r\n      <h6 class=\"card-subtitle  ${me.cssSubtitle}\"><slot name=\"subtitle\">${me.translate(me.subtitle)}</slot></h6>\r\n      <p class=\"card-text ${me.cssText}\"><slot name=\"text\">${me.translate(me.text)}</slot></p>\r\n      <slot name=\"body\"></slot>\r\n    </div>    \r\n    `;\r\n  }\r\n\r\n  get #header() {\r\n    return this.overlay ? '' : html`<div class=\"card-header  ${this.cssHeader}\"><slot name=\"header\">${this.header}</slot></div>`;\r\n  }\r\n\r\n  get #footer() {\r\n    return this.overlay ? '' : html`<div class=\"card-footer ${this.cssFooter}\"><slot name=\"footer\">${this.footer}</slot></div>`;\r\n  }\r\n\r\n  get #imageSlot() {\r\n    return html`<slot name=\"image\"></slot>`;\r\n  }\r\n\r\n  get #image() {\r\n    const me = this;\r\n    const css = me.isHorizontal ? 'img-fluid' : 'card-img';\r\n    me.dynamicStyle(me.#styleID, me.imageStyle);\r\n    return html`<img src=\"${me.image}\" class=\"rounded-${me.placement} ${css} ${me.cssImage} ${me.#styleID}\" alt=\"...\">`;\r\n  }\r\n\r\n  get #images() {\r\n    return this.image ? this.#image : this.#imageSlot;\r\n  }\r\n\r\n  get #imageTop() {\r\n    return this.placement === 'top' ? this.#images : '';\r\n  }\r\n\r\n  get #imageBottom() {\r\n    return this.placement === 'bottom' ? this.#images : '';\r\n  }\r\n\r\n  static {\r\n    this.define('gs-card');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSCenterElement extends GSElement {\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\"\r\n      class=\"position-absolute top-50 start-50 translate-middle ${classMap(me.renderClass())}\">\r\n    ${me.renderTemplate()}<slot></slot></div>`;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-center');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSMenuElement class\r\n * @module components/GSMenuElement\r\n */\r\n\r\nimport { classMap, ifDefined, html, ref, createRef } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { dataset } from '../directives/dataset.mjs';\r\nimport { GroupController } from '../controllers/GroupController.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\n/**\r\n * Renderer for panel layout \r\n * @class\r\n * @extends {Component}\r\n */\r\nexport class GSMenuElement extends GSElement {\r\n\r\n    static properties = {\r\n        storage: {},\r\n        auto: { type: Boolean, reflect: true },\r\n        opened: { type: Boolean, reflect: true },\r\n        dark: { type: Boolean },\r\n        reverse: { type: Boolean },\r\n        offset: { type: Number },\r\n        data: { type: Array },\r\n    }\r\n\r\n    // GS-ITEM attributes mapping\r\n    static options = {\r\n        name: {},\r\n        title: {},\r\n        header: {},\r\n        color: {},\r\n        icon: {},\r\n        url: { default: '#' }\r\n    }\r\n\r\n    #menuRef = createRef();\r\n    #styleID = GSID.id;\r\n    #controller = null;\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;\r\n        me.offset = 0;\r\n        me.dynamicStyle(me.#styleID);\r\n        me.data = me.#proxify(me);\r\n        me.#controller = new GroupController(this);\r\n    }\r\n\r\n    onBusEvent(e) {\r\n       if (e.detail.owner != this) {\r\n            this.opened = false;\r\n       }\r\n     }\r\n\r\n    willUpdate(changed) {\r\n        super.willUpdate(changed);\r\n        if (changed.has('opened') && !this.opened) {\r\n            this.#closeSubmenus();\r\n        }\r\n    }\r\n\r\n    updated() {\r\n        this.#updatePosition();\r\n        if (this.opened) {\r\n            this.#controller.notify();\r\n        }\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<ul \r\n            ${ref(me.#menuRef)}\r\n            dir=\"${ifDefined(me.direction)}\"\r\n            class=\"dropdown-menu ${classMap(me.renderClass())}\"\r\n            data-gs-class=\"${me.#styleID}\"\r\n            data-menu=\"true\"\r\n            @mouseover=\"${me.#onMouseOver}\"\r\n            @mouseleave=\"${me.#onMouseLeave}\"\r\n            @keydown=\"${me.#onKeyDown}\"\r\n            @click=\"${me.#onClick}\">\r\n            ${me.#items(me.data)}\r\n        </ul>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            'submenu': me.dataset.submenu,\r\n            'dropdown-menu-dark': me.dark,\r\n            [me.#styleID]: true,\r\n            'show': me.opened,\r\n            'dropend': !me.reverse,\r\n            'dropstart': me.reverse,\r\n        }\r\n        return css;\r\n    }\r\n\r\n    close() {\r\n        this.opened = false;\r\n    }\r\n\r\n    open() {\r\n        this.opened = true;\r\n    }\r\n\r\n    toggle() {\r\n        this.opened = !this.opened;\r\n    }\r\n\r\n    /**\r\n     * Show at x/y position on the screen\r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @param {HTMLElement} caller\r\n     * @returns {void}\r\n     */\r\n    popup(x = 0, y = 0, caller) {\r\n\r\n        const me = this;\r\n        // offset to render under the mouse,\r\n        // important for GSGrid for better UI experience\r\n        const offset = GSUtil.asNum(me.offset, 0);\r\n        let target = caller;\r\n\r\n        if (GSEvents.isMouseOrPointerEvent(x)) {\r\n            const e = x;\r\n            target = e.target;\r\n            y = e.clientY;\r\n            x = e.clientX;\r\n            let offset = GSDOM.offsetParent(me);\r\n            offset = offset ? offset.getBoundingClientRect() : null;\r\n            x = x - (offset?.left || 0);\r\n            y = y - (offset?.top || 0);\r\n        }\r\n\r\n        const cfg = { clientX: x - offset, clientY: y - offset, target: target };\r\n\r\n        requestAnimationFrame(() => {\r\n            const style = {\r\n                position: 'fixed',\r\n                top: '0px',\r\n                left: '0px',\r\n                translate: `${cfg.clientX}px ${cfg.clientY}px`\r\n            };\r\n            const rule = me.dynamicStyle(me.#styleID);\r\n            Object.assign(rule.style, style);\r\n        });\r\n        me.open();\r\n\r\n    }\r\n\r\n    onDataRead(data) {\r\n        this.data = data;\r\n    }\r\n\r\n    #items(root) {\r\n        const me = this;\r\n        return root.map(el => me.#item(el));\r\n    }\r\n\r\n    #item(el) {\r\n        const me = this;\r\n        const isSub = el.items?.length > 0;\r\n        if (isSub) return me.#renderSubmenu(el);\r\n        if (!(el.header || el.name)) return me.#renderDivider();\r\n        return el.header ? me.#renderHeader(el) : me.#renderMenu(el);\r\n    }\r\n\r\n    #renderHeader(el) {\r\n        return html`<li data-inert=\"true\"><h6 class=\"dropdown-header\">${this.#renderIcon(el)}${el.header}</h6></li>`;\r\n    }\r\n\r\n    #renderDivider() {\r\n        return html`<li data-inert=\"true\"><hr class=\"dropdown-divider\"></li>`;\r\n    }\r\n\r\n    #renderSubmenu(el) {\r\n        const me = this;\r\n        return html`<li>\r\n            <a class=\"dropdown-item dropdown-toggle\" data-toggle=\"true\" href=\"#\">\r\n                <div class=\"d-inline-block w-100\">${me.#renderIcon(el)}${el.name}</div>\r\n            </a>\r\n            <gs-menu auto \r\n                .data=${el.items} \r\n                ?dark=${me.dark} \r\n                ?reverse=\"${me.reverse}\" \r\n                language=\"${ifDefined(me.language)}\" \r\n                data-submenu=\"true\">\r\n            </gs-menu>\r\n        </li>`;\r\n    }\r\n\r\n    #renderIcon(el) {\r\n        return el.icon ? html`<gs-icon css=\"mx-1\" name=\"${el.icon}\"></gs-icon>` : '';\r\n    }\r\n\r\n    #renderMenu(el) {\r\n        return html`<li>\r\n                <gs-button css=\"dropdown-item shadow-none\" \r\n                    ${dataset(el, false)}\r\n                    url=\"${el.url}\"\r\n                    title=\"${el.name}\" \r\n                    language=\"${ifDefined(this.language)}\" \r\n                    icon=\"${ifDefined(el.icon)}\" \r\n                    text=\"${ifDefined(el.color)}\"\r\n                    data-gs-target=\"${ifDefined(el.target || 'self')}\"\r\n                    data-gs-action=\"${ifDefined(el.action)}\">\r\n                </gs-button></li>`;\r\n    }\r\n\r\n    /**\r\n     * Proxify GS-ITEM elements to easily read attributes\r\n     */\r\n    #proxify(root) {\r\n        return GSItem.collect(root).map(el => GSAttr.proxify(el, GSMenuElement.options));\r\n    }\r\n\r\n    #closeSubmenus(menu) {\r\n        GSDOM.queryAll(this.renderRoot, 'gs-menu', false, false)\r\n            .filter(el => el != menu)\r\n            .forEach(el => el.close());\r\n    }\r\n\r\n    #onKeyDown(e) {\r\n        const me = this;\r\n        switch (e.key) {\r\n            case 'Escape':\r\n                me.close();\r\n                break;\r\n        }\r\n    }\r\n\r\n    #onClick(e) {\r\n        GSEvents.prevent(e);\r\n        const me = this;\r\n        const submenu = me.#toSubmenu(e);\r\n        submenu?.close();\r\n        if (me.auto) me.close();\r\n    }\r\n\r\n    #onMouseLeave(e) {\r\n        GSEvents.prevent(e);\r\n        if (this.auto) this.close();\r\n    }\r\n\r\n    #onMouseOver(e) {\r\n        GSEvents.prevent(e);\r\n        const me = this;\r\n        const submenu = me.#toSubmenu(e);\r\n        me.#closeSubmenus(submenu);\r\n        submenu?.open();\r\n    }\r\n\r\n    #toSubmenu(e) {\r\n        const menuItem = e.target.closest('li');\r\n        return menuItem?.querySelector('gs-menu');\r\n    }\r\n\r\n    #updatePosition() {\r\n        const me = this;\r\n        if (!me.opened) return;\r\n        const rule = me.dynamicStyle(me.#styleID);\r\n        if (me.isSubmenu) {\r\n            const opt = { translate: `0px -25px` };\r\n            if (me.reverse) {\r\n                opt.left = 'inherited';\r\n                opt.right = '100%';\r\n            } else {\r\n                opt.right = 'inherited';\r\n                opt.left = '100%';\r\n            }\r\n            Object.assign(rule.style, opt);\r\n        } else {\r\n            rule.style.translate = null;\r\n            const rect = me.#menu.getBoundingClientRect();\r\n            const offset = window.innerWidth - rect.right;\r\n            me.reverse = offset - 5 < 0;\r\n            if (me.reverse) rule.style.translate = `${offset - 2}px`;\r\n        }\r\n    }\r\n\r\n    get isSubmenu() {\r\n        return this.dataset.submenu;\r\n    }\r\n\r\n    get #menu() {\r\n        return this.#menuRef.value;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-menu');\r\n    }\r\n}\r\n","/*GSContextElement\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSContextElement class\r\n * @module components/GSContextElement\r\n */\r\n\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSMenuElement } from './Menu.mjs';\r\n\r\n/**\r\n * Renderer for context menu\r\n * @class\r\n * @extends {GSMenuElement}\r\n */\r\nexport class GSContextElement extends GSMenuElement {\r\n\r\n    static properties = {\r\n        target: {},\r\n        filter: {},\r\n        altContext: { type: Boolean, attribute: 'altcontext' },\r\n        disabled: { type: Boolean },\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;        \r\n        me.auto = true;\r\n        if (me.#isInTable) {\r\n            me.slot = \"extra\";\r\n            me.target = \"tbody\";\r\n            me.filter = \"[selected]\";\r\n            me.offset =\"4\";\r\n        }\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        const me = this;\r\n        me.attachEvent(window, 'resize', me.close.bind(me));        \r\n        if (!me.slot) me.#attachTarget();\r\n    }\r\n    \r\n    onSlotInjected(slot) {\r\n        this.#attachTarget();\r\n    }\r\n\r\n    #attachTarget() {\r\n        const me = this;        \r\n        const owner = GSDOM.parent(me.assignedSlot || me);\r\n        let targets = me.target ? GSDOM.queryAll(owner, me.target) : [owner];\r\n        if (!targets.length) targets = GSDOM.queryAll(document.documentElement, me.target);\r\n        targets.forEach(target => me.attachEvent(target, 'contextmenu', me.#onPopup.bind(me)));\r\n    }\r\n\r\n    #match(e) {\r\n        const me = this;\r\n        return e.composedPath().filter(el => el.matches)\r\n            .filter(el => el.matches(me.filter ? me.filter : me.target));\r\n    }\r\n\r\n    #onPopup(e) {\r\n        const me = this;\r\n        if (e.shiftKey && me.altContext) return;\r\n        const list = me.#match(e);\r\n        if (list.length === 0) return;\r\n        GSEvents.prevent(e);\r\n        me.popup(e);\r\n        return true;\r\n    }\r\n\r\n    get #isInTable() {\r\n        return this.parentComponent?.tagName === 'GS-TABLE';\r\n    }\r\n\r\n    /**\r\n     * Show submenu at x/y position on the screen\r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @returns {void}\r\n     */\r\n    popup(x = 0, y = 0, caller) {\r\n        return this.disabled ? false : super.popup(x, y, caller);\r\n    }\r\n\r\n    static {\r\n        this.define('gs-context');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, css, html, ifDefined, ref } from '../lib.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color, notEmpty } from '../properties/index.mjs';\r\nimport { ElementMoveController } from '../controllers/ElementMoveController.mjs';\r\n\r\nexport class GSCompareElement extends GSElement {\r\n\r\n  static styles = css`.slider {\r\n         --gs-position : 50%;\r\n          left : var(--gs-position);\r\n          width: 8px;\r\n          height: 100%;\r\n          border-width: 1px;\r\n          cursor: w-resize;\r\n          border-color: darkgray;\r\n          border-style: solid;\r\n          background-color: lightgray;\r\n      }\r\n      .clipper {\r\n        --gs-position : 50%;\r\n        clip-path: inset(0px var(--gs-position) 0px 0px);\r\n      }\r\n    `;\r\n\r\n  static properties = {\r\n    background: { ...color },\r\n    width: { type: Number },\r\n    height: { type: Number },\r\n    before: { hasChanged: notEmpty },\r\n    after: { hasChanged: notEmpty },\r\n  }\r\n\r\n  #styleID = GSID.id;\r\n\r\n  #elRef = createRef();\r\n  #clipRef = createRef();\r\n  #slideRef = createRef();\r\n\r\n  #mouseController;\r\n  #elPosition;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.width = 0;\r\n    me.height = 0;\r\n    me.dynamicStyle(me.#styleID);\r\n    me.#mouseController = new ElementMoveController(me);\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    this.#mouseController.attach(this.#splitter);\r\n    super.firstUpdated(changed);\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    const me = this;\r\n    const dynamic = me.#dynamic;\r\n    dynamic.width = me.width > 0 ? `${me.width}px` : '';\r\n    dynamic.height = me.height > 0 ? `${me.height}px` : '';\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div ${ref(me.#elRef)} \r\n         dir=\"${ifDefined(me.direction)}\"\r\n         @loaded=\"${me.#onLoad}\" \r\n         @dblclick=\"${me.#onDoubleClick}\"\r\n         data-gs-class=\"${me.#styleID}\"\r\n         class=\"${classMap(me.renderClass())}\">\r\n      <div class=\"overflow-hidden position-absolute top-0 start-0 overflow-hidden\"><slot name=\"before\">${me.#before}</slot></div>\r\n      <div ${ref(me.#clipRef)} class=\"overflow-hidden position-absolute top-0 start-0 overflow-hidden clipper\"><slot name=\"after\">${me.#after}</slot></div>\r\n      <div ${ref(me.#slideRef)} class=\"slider position-absolute top-0><slot name=\"control\"></slot></div>\r\n    </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      \"position-relative\": true,\r\n      \"user-select-none\": true,\r\n      \"d-contents\": me.isAuto,\r\n      \"h-100\": me.isAuto,\r\n      \"w-100\": me.isAuto,\r\n      \"overflow-hidden\": true,\r\n      [`bg-${me.background}`]: me.background,\r\n      [`${me.#styleID}`]: true\r\n    }\r\n    return css;\r\n  }\r\n\r\n  /**\r\n   * Handles resizing based on mouse move event\r\n   * @param {MouseEvent} e \r\n   */\r\n  onStartMove(e) {\r\n    this.#elPosition = this.#splitter.getBoundingClientRect();\r\n  }\r\n\r\n  onMouseMove(e) {\r\n    const me = this;\r\n    const offset = me.#elPosition.left;\r\n    const width = me.#elPosition.width;\r\n    const pos = GSUtil.range(e.clientX - offset, 0, width);\r\n    const pct = (pos / width) * 100;\r\n    me.#update(pct);\r\n  }\r\n\r\n  get isAuto() {\r\n    return this.width == 0 || this.height == 0;\r\n  }\r\n\r\n  get isFixed() {\r\n    return !this.isAuto;\r\n  }\r\n\r\n  get #dynamic() {\r\n    return this.dynamicStyle(this.#styleID).style;\r\n  }\r\n\r\n  get #before() {\r\n    return this.before ? html`<img @load=\"${this.#onLoad}\" src=\"${me.before}\"></img>` : '';\r\n  }\r\n\r\n  get #after() {\r\n    return this.after ? html`<img @load=\"${this.#onLoad}\" src=\"${me.after}\"></img>` : '';\r\n  }\r\n\r\n  get #isAuto() {\r\n    return this.width === 0 || this.height === 0;\r\n  }\r\n\r\n  get #splitter() {\r\n    return this.#elRef.value;\r\n  }\r\n\r\n  get #slider() {\r\n    return this.#slideRef.value;\r\n  }\r\n\r\n  get #clip() {\r\n    return this.#clipRef.value;\r\n  }\r\n\r\n  #onLoad(e) {\r\n    const me = this;\r\n    if (me.#isAuto) {\r\n      const el = e.target;\r\n      me.height = me.height || el.height;\r\n      me.width = me.width || el.width;\r\n    }\r\n  }\r\n\r\n  #onDoubleClick(e) {\r\n    const me = this;\r\n    me.prevent(e);\r\n    me.#update();\r\n    me.#mouseController.reset();\r\n  }\r\n\r\n  #update(pct = 50) {\r\n    const me = this;\r\n    me.#clip.style.setProperty('--gs-position', `${100 - pct}%`);\r\n    me.#slider.style.setProperty('--gs-position', `${pct}%`);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-compare');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\n\r\n/**\r\n * Helper component to enable controller attachment to the GS WebComponent.\r\n * It is used to simplify and separate templates from logic.\r\n */\r\nexport class GSControllerElement extends GSElement {\r\n\r\n  static properties = {\r\n    module: {},\r\n    controller: {},\r\n  }\r\n\r\n  #clazz = false;\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  updated(changes) {\r\n    super.updated(changes);\r\n    const me = this;\r\n    if (me.isConnected && me.isValid) {\r\n      me.#initialize();\r\n    }\r\n  }\r\n\r\n  get isValid() {\r\n    return this.parentElement instanceof GSElement;\r\n  }\r\n\r\n  async #initialize() {\r\n\r\n    const me = this;\r\n    const host = me.parentElement;\r\n\r\n    if (me.#clazz) return;\r\n\r\n    let clazz = globalThis[me.controller];\r\n    if (!clazz && me.module) {\r\n      const url = GSLoader.normalizeURL(me.module);\r\n      const module = await import(url);\r\n      clazz = module[me.controller];\r\n    }\r\n\r\n    if (clazz) {\r\n      new clazz(host);\r\n      me.#clazz = clazz;\r\n      globalThis[me.controller] = clazz;\r\n    }\r\n\r\n  }\r\n\r\n  static {\r\n    this.define('gs-controller');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\nexport class GSCopyrightElement extends GSElement {\r\n\r\n  static properties = {\r\n    year: { reflect: true, type: Number },\r\n    company: { reflect: true },\r\n    url: { reflect: true },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.flat = true;\r\n    this.css = 'fixed-bottom d-flex justify-content-center align-items-center mt-1 p-2 text-muted';\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    if (!(me.isCompany && me.isYear)) return '';\r\n    const year = new Date().getFullYear();\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\" class=\"${classMap(me.renderClass())}\"><a target=\"_blank\" href=\"${me.url ? me.url : '#'}\"><small>&copy; ${me.company} ${me.year}. - ${year}.</small></a></div>`;\r\n  }\r\n\r\n  get isCompany() {\r\n    return GSUtil.isStringNonEmpty(this.company);\r\n  }\r\n\r\n  get isYear() {\r\n    return GSUtil.isStringNonEmpty(this.year);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-copyright');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSLog } from '../base/GSLog.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSFunction } from '../base/GSFunction.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { numGT0 } from '../properties/verificator.mjs';\r\nimport { GSReadWriteRegistry } from '../data/ReadWriteRegistry.mjs';\r\nimport { GSData } from '../base/GSData.mjs';\r\n\r\n/**\r\n * A module loading GSDataHandler class\r\n * @module components/GSDataHandler\r\n */\r\n\r\n/**\r\n * GUI element for easier access to the GSReadWrite/GSTreeReader\r\n * @class\r\n * @extends {GSElement}\r\n */\r\nexport class GSDataHandler extends GSElement {\r\n\r\n    static properties = {\r\n        storage: { state: true },\r\n        src: { reflect: true },\r\n        action: { reflect: true },\r\n        mode: { reflect: true },\r\n        reader: { reflect: true },\r\n        writer: { reflect: true },\r\n        limit: { type: Number, reflect: true },\r\n        skip: { type: Number, reflect: true },\r\n        filter: { type: Array, reflect: true },\r\n        sort: { type: Array, reflect: true },\r\n        type: {},\r\n        autoload: { type: Boolean },\r\n        autorefresh: { type: Number, reflect: true, hasChanged: numGT0 },\r\n    }\r\n\r\n    #iid = 0;\r\n    #config = null;\r\n    #handler = null;\r\n    #lifoReadRef = null;\r\n    #lifoWriteRef = null;\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;\r\n        me.storage = me.storage || me.id;\r\n        me.autorefresh = 0;\r\n        me.autoload = false;\r\n        me.flat = true;\r\n        me.filter = [];\r\n        me.sort = [];\r\n        me.limit = 0;\r\n        me.skip = 0;\r\n        me.src = '';\r\n        me.type = 'remote';\r\n        me.mode = 'query';\r\n        me.reader = 'GET';\r\n        me.writer = 'POST';\r\n        if (me.#isInTable) {\r\n            me.slot = \"extra\";\r\n          }\r\n        if (!me.isGenerated && !me.id) throw new Error('Element ID is required attribute!');\r\n        GSItem.validate(me, me.tagName);\r\n    }\r\n    \r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        const me = this;\r\n        me.storage = me.storage || me.id;\r\n        const itemHolder = me.isGenerated && me.childElementCount === 0 ? me.parentComponent : me;\r\n        me.#config = GSItem.proxify(itemHolder, GSData.PROPERTIES);\r\n        me.#initLIFO(true);\r\n        me.#initLIFO(false);\r\n    }\r\n    \r\n    disconnectedCallback() {\r\n        super.disconnectedCallback();\r\n        const me = this;\r\n        me.#handler?.disable();\r\n        me.#handler?.removeProcessor(me);\r\n        me.#lifoReadRef = null;\r\n        me.#lifoWriteRef = null;\r\n        clearTimeout(me.#iid);\r\n    }\r\n    \r\n    firstUpdated() {\r\n        const me = this;\r\n        me.#handler = GSReadWriteRegistry.newHandler(me.type, me.storage, false);\r\n        if (me.#config?.length > 0) me.#handler?.addProcessor(me);\r\n        me.#updateHandler(true);                \r\n    }\r\n\r\n    willUpdate(changed) {\r\n        super.willUpdate(changed);\r\n        const me = this;\r\n        me.#updateHandler();\r\n        if (changed.has('autorefresh')) me.schedule(me.autorefresh);\r\n    }\r\n\r\n    #updateHandler(first = false) {\r\n        const me = this;\r\n        if (!me.#handler) return;\r\n\r\n        me.#handler.src = me.src;\r\n        me.#handler.key = me.key;\r\n        me.#handler.mode = me.mode;\r\n        me.#handler.action = me.action;\r\n        me.#handler.reader = me.reader;\r\n        me.#handler.writer = me.writer;\r\n\r\n        me.#handler.limit = me.limit;\r\n        me.#handler.skip = me.skip;\r\n        me.#handler.sort = me.formatSort(me.sort);\r\n        me.#handler.filter = me.formatFilter(me.filter);\r\n        if (me.autoload) me.read();\r\n        if (first) {\r\n            me.#handler.enable();\r\n            // to prevent double read by this component and table\r\n            if (me.autoload) {\r\n                me.dataController?.read();\r\n            } \r\n        }\r\n    }\r\n\r\n    get isDebug() {\r\n        return this.dataset.gsDebug;\r\n    }\r\n\r\n    get handler() {\r\n        return this.#handler;\r\n    }\r\n\r\n    get isRegistered() {\r\n        return this.#handler?.isRegistered === true;\r\n    }\r\n\r\n    get isOffline() {\r\n        return this.#handler?.isOffline;\r\n    }\r\n\r\n    get isCached() {\r\n        return this.#handler?.type == 'cached';\r\n    }\r\n\r\n    set search(val) {\r\n        if (this.#handler) this.#handler.search = val;\r\n    }\r\n\r\n    get key() {\r\n        return this.#config.filter(o => o.key).map(o => o.name).pop() || null;\r\n    }\r\n\r\n    /**\r\n     * Filter data in format \r\n     * [{name: idx[num] || name[string], value: ''  , op:'eq'}]\r\n     */\r\n    formatFilter(val) {\r\n        val = this.#formated(val);\r\n        return Array.isArray(val) ? val : [];\r\n    }\r\n\r\n    /**\r\n     * Sort data in format\r\n     * [{col: idx[num] || name[string]  , op: -1 | 1 }]\r\n     */\r\n    formatSort(val) {\r\n        val = this.#formated(val);\r\n        let sort = undefined;\r\n        if (typeof val === 'string') {\r\n            sort = [{ col: val }];\r\n        } else if (Array.isArray(val)) {\r\n            sort = val;\r\n        } else if (GSUtil.isNumber(val)) {\r\n            const idx = Math.abs(val);\r\n            sort = new Array(idx);\r\n            sort[idx - 1] = { ord: val };\r\n        }\r\n        return sort || [];\r\n    }\r\n\r\n    schedule(time = 0) {\r\n        const me = this;\r\n        time = GSUtil.asNum(time) * 1000;\r\n        clearInterval(me.#iid);\r\n        if (time > 0) me.#iid = setInterval(() => {\r\n            me.read(me);\r\n        }, time);\r\n    }\r\n\r\n    read() {\r\n        return this.#lifoReadRef();\r\n    }\r\n\r\n    write(data, append = false) {\r\n        return this.#lifoWriteRef(data, append);\r\n    }\r\n\r\n    load() {\r\n        return this.read();\r\n    }\r\n\r\n    save(data) {\r\n        return this.write(data);\r\n    }\r\n\r\n    /**\r\n     * Return list of all selected record id's\r\n     */\r\n    get selected() {\r\n        return this.#handler?.selected;\r\n    }\r\n\r\n    /**\r\n     * Store selected record ID\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    addSelected(val) {\r\n        return this.#handler?.addSelected(val);\r\n    }\r\n\r\n    /**\r\n     * Remove selected record ID\r\n     * @param {*} val \r\n     */\r\n    removeSelected(val) {\r\n        return this.#handler?.removeSelected(val);\r\n    }\r\n\r\n    /**\r\n     * Remove all selections\r\n     */\r\n    clearSelected(data) {\r\n        return this.#handler?.clearSelected();\r\n    }\r\n\r\n    /**\r\n     * Callback for data read result\r\n     */\r\n    onDataRead(obj) {\r\n        if (this.isDebug) GSLog.log(this, 'Data Read: ' + JSON.stringify(obj));\r\n    }\r\n\r\n    /**\r\n     * Callback for data write result\r\n     * @param {*} obj \r\n     */\r\n    onDataWrite(obj) {\r\n        if (this.isDebug) GSLog.log(this, 'Data write: ' + JSON.stringify(obj));\r\n    }\r\n\r\n    /**\r\n     * Process data after receive, before notifying \r\n     * @param {*} data \r\n     */\r\n    postRead(data) {\r\n        const me = this;\r\n        if (!Array.isArray(data)) data = [data];\r\n        data.forEach(r => {\r\n            me.#config.forEach(c => {\r\n                let val = r[c.name];\r\n                if (!GSUtil.isNull(val)) {\r\n                    val = GSData.format(c, val);\r\n                    r[c.name] = val;\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Callback on data red/write error\r\n     * @param {*} obj \r\n     */\r\n    onDataError(obj) {\r\n        if (this.isDebug) GSLog.log(this, 'Data error: ' + JSON.stringify(obj));\r\n    }\r\n\r\n    #verifyHandler() {\r\n        const me = this;\r\n        if (me.isOffline || me.isRegistered) return;\r\n        throw new Error('Data handler not initialized!');\r\n    }\r\n\r\n    #initLIFO(read = true) {\r\n        const me = this;\r\n        if (read) {\r\n            me.#lifoReadRef = GSFunction.callOnceLifo(me.#lifoReadRefCallback, me);\r\n        } else {\r\n            me.#lifoWriteRef = GSFunction.callOnceLifo(me.#lifoWriteRefCallback, me);\r\n        }\r\n    }\r\n\r\n    #lifoReadRefCallback() {\r\n        const me = this;\r\n        me.#initLIFO(true);\r\n        return me.#lifoCall(true);\r\n    }\r\n\r\n    #lifoWriteRefCallback(data, append) {\r\n        const me = this;\r\n        me.#initLIFO(false);\r\n        return me.#lifoCall(false, data, append);\r\n    }\r\n    \r\n    #lifoCall(read = true, data, append) {\r\n        const me = this;\r\n        me.#verifyHandler();        \r\n        if (read) return me.#handler?.read(me);        \r\n        if (!append) me.#handler.clear();\r\n        return me.#handler?.write(me, data);\r\n    }\r\n\r\n    #formated(val) {\r\n        return GSUtil.isJsonString(val) ? JSON.parse(val) : val;\r\n    }\r\n\r\n    get #isInTable() {\r\n        return this.parentComponent?.tagName === 'GS-TABLE';\r\n    }\r\n\r\n    static {\r\n        this.define('gs-data-handler');\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, css, html, ifDefined, ref } from '../lib.mjs';\r\nimport { HANDLER } from '../base/GSConst.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { size, SizeTypes } from '../properties/size.mjs';\r\n\r\nexport class GSDialogElement extends GSElement {\r\n\r\n  static CSS = 'rounded shadow-sm';\r\n  static HEADER_CSS = 'p-3';\r\n  static TITLE_CSS = 'fs-5 fw-bold text-muted';\r\n  static ALIGN = 'end';\r\n  static CANCEL = 'Cancel';\r\n  static CONFIRM = 'Ok';\r\n\r\n  static #STACK = [];\r\n\r\n  static styles = css`dialog {\r\n      --bs-modal-width: 500px;\r\n      width:var(--bs-modal-width);\r\n      outline:none;\r\n    }\r\n    dialog::backdrop {\r\n      backdrop-filter: blur(4px);\r\n      backdrop-filter: blur(var(--gs-backdrop-blur));      \r\n      background-color: var(--gs-backdrop-color);\r\n      display: var(--gs-backdrop-display);\r\n    }`;\r\n\r\n  static properties = {\r\n\r\n    standard: { reflect: true, type: Boolean },\r\n    opened: { reflect: true, type: Boolean },\r\n    cancelable: { reflect: true, type: Boolean },\r\n    closable: { reflect: true, type: Boolean },\r\n    escapable: { reflect: true, type: Boolean },\r\n    disabled: { reflect: true, type: Boolean },\r\n\r\n    size: size,\r\n\r\n    title: { reflect: true },\r\n    message: { reflect: true },\r\n    cancelText: { reflect: true, attribute: 'text-cancel' },\r\n    confirmText: { reflect: true, attribute: 'text-confirm' },\r\n\r\n    minWidth: { reflect: true, type: Number, attribute: 'min-width' },\r\n    buttonAlign: { reflect: true, attribute: 'button-align' },\r\n\r\n    iconCancel: { reflect: true, attribute: 'icon-cancel' },\r\n    iconConfirm: { reflect: true, attribute: 'icon-confirm' },\r\n\r\n    colorCancel: { attribute: 'color-cancel' },\r\n    colorConfirm: { attribute: 'color-confirm' },\r\n\r\n    cssCancel: { attribute: 'css-cancel' },\r\n    cssConfirm: { attribute: 'css-confirm' },\r\n\r\n    cssTitle: { attribute: 'css-title' },\r\n    cssHeader: { attribute: 'css-header' },\r\n    cssFooter: { attribute: 'css-footer' },\r\n    cssBody: { attribute: 'css-body' },\r\n    cssContent: { attribute: 'css-content' },\r\n\r\n  }\r\n\r\n  #pass = false;\r\n  #styleID = GSID.id;\r\n  #dialogRef = createRef();\r\n  #btnConfirmRef = createRef();\r\n  #btnCancelRef = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    const clazz = GSDialogElement;\r\n    me.opened = false;\r\n    me.standard = false;\r\n    me.cancelable = false;\r\n    me.closable = false;\r\n    me.escapable = false;\r\n    me.disabled = false;\r\n    me.shadow = false;\r\n    me.rounded = false;\r\n\r\n    me.minWidth = 0;\r\n    me.css = clazz.CSS;\r\n    me.cssTitle = clazz.TITLE_CSS;\r\n    me.cssHeader = clazz.HEADER_CSS;\r\n    me.buttonAlign = clazz.ALIGN;\r\n    me.cancelText = clazz.CANCEL;\r\n    me.confirmText = clazz.CONFIRM;\r\n    me.colorCancel = 'secondary';\r\n    me.colorConfirm = 'primary';\r\n    me.dynamicStyle(me.#styleID);\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    super.disconnectedCallback();\r\n    GSDialogElement.#updateStack();\r\n  }\r\n\r\n  firstUpdated() {\r\n    super.firstUpdated();\r\n    this.#pass = true;\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    const me = this;\r\n    const allowed = me.opened === true || me.#pass;\r\n    // initially hidden dialogs rendering are postponed\r\n    if (!allowed) {\r\n      GSUtil.timeout(1000).then(() => {\r\n        queueMicrotask(() => { \r\n          const allowed = me.opened === true || me.#pass;\r\n          if (!allowed) {\r\n            me.#pass = true;\r\n            if (me.isConnected) me.requestUpdate();\r\n          }\r\n        });          \r\n      });\r\n    }\r\n    return allowed;\r\n  }\r\n\r\n  updated(changed) {\r\n    super.updated(changed);\r\n    if (changed.has('opened')) {\r\n      this.#onOpenChanged();\r\n    }\r\n  }\r\n\r\n  #onOpenChanged() {\r\n    const me = this;\r\n    let state = null;\r\n    if (me.opened) {\r\n      GSDialogElement.#STACK.push(me);\r\n      state = 'opening';\r\n      if (me.standard) {\r\n        me.#dialog?.open();\r\n      } else {\r\n        me.#dialog?.showModal();\r\n      }\r\n      me.#focusable()?.focus();\r\n    } else {\r\n      state = 'closing';\r\n      if (me.isHashed) location.hash = '';\r\n      GSDialogElement.#STACK.pop();\r\n      me.#dialog?.close();\r\n    }\r\n    const sts = me.opened ? me.afterOpen() : me.afterClose();\r\n    if (sts !== false) me.notify(true, false, state);\r\n  }\r\n\r\n  addController(controller) {\r\n    if (controller.isDialog) {\r\n      this[HANDLER]?.add(controller);\r\n    }\r\n    super.addController?.(controller);\r\n  }\r\n\r\n  afterOpen() {\r\n    const me = this;\r\n    me[HANDLER]?.forEach((c) => c.afterOpen?.(me));\r\n    return me.emit('open', null, false, false, true);\r\n  }\r\n\r\n  afterClose() {\r\n    const me = this;\r\n    me[HANDLER]?.forEach((c) => c.afterClose?.(me));\r\n    return me.emit('close', null, false, false, true);\r\n  }\r\n\r\n  #renderConfirm() {\r\n    const me = this;\r\n    if (!me.closable) return '';\r\n    return html`<gs-button type=\"button\"\r\n      ${ref(me.#btnConfirmRef)} \r\n      @click=\"${me.#onBtnConfirm.bind(me)}\" \r\n      icon=\"${ifDefined(me.iconConfirm)}\"\r\n      language=\"${ifDefined(me.language)}\"\r\n      .disabled=\"${me.disabled}\"  \r\n      css=\"${ifDefined(me.cssConfirm)}\" \r\n      color=\"${ifDefined(me.colorConfirm)}\" \r\n      title=\"${me.confirmText}\">\r\n      </gs-button>`;\r\n  }\r\n\r\n  #renderCancel() {\r\n    const me = this;\r\n    if (!me.cancelable) return '';\r\n    return html`<gs-button type=\"button\"\r\n      ${ref(me.#btnCancelRef)}      \r\n      @click=\"${me.#onBtnCancel.bind(me)}\" \r\n      icon=\"${ifDefined(me.iconCancel)}\"\r\n      language=\"${ifDefined(me.language)}\"\r\n      css=\"${ifDefined(me.cssCancel)}\" \r\n      color=\"${ifDefined(me.colorCancel)}\" \r\n      title=\"${me.cancelText}\">\r\n      </gs-button>`;\r\n  }\r\n\r\n  #renderFooter() {\r\n    const me = this;\r\n    const isFooter = me.cancelable || me.closable;\r\n    if (!isFooter) return '';\r\n    return html`<div class=\"card-footer d-flex user-select-none justify-content-${me.buttonAlign} ${me.cssFooter}\">\r\n       <slot name=\"actions\"></slot>\r\n      ${me.#renderCancel()} &nbsp;${me.#renderConfirm()}\r\n      </div>`;\r\n  }\r\n\r\n  #renderContent() {\r\n    const me = this;\r\n    const css = {\r\n      card : true,\r\n      [`p-${me.padding}`]: me.padding >= 0,\r\n      [`m-${me.margin}`]: me.margin >= 0      \r\n    }\r\n    me.cssContent?.match(/[^ ]+/g).forEach(v => css[v]=true);\r\n    return css;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const size = SizeTypes[me.size];\r\n    //...super.renderClass(),\r\n    const css = {\r\n      'dialog': true,\r\n      'p-0': true,\r\n      'border': me.bordered,\r\n      'border-0': !me.bordered,\r\n      'shadow-sm': me.shadow,\r\n      'rounded': me.rounded,      \r\n      [me.#styleID]: true,\r\n      [`modal-${size}`]: size ? true : false\r\n    }\r\n    return css;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const styles = {\r\n      'min-width': me.minWidth > 0 ? `${me.minWidth}px` : undefined\r\n    };\r\n    me.dynamicStyle(me.#styleID, styles);\r\n    return html`\r\n        <dialog closedby=\"none\" tabindex=\"-1\" ${ref(me.#dialogRef)} \r\n            dir=\"${ifDefined(me.direction)}\"\r\n            @close=\"${me.#onDlgClose.bind(me)}\"\r\n            @cancel=\"${me.#onDlgCancel.bind(me)}\"\r\n            @keydown=\"${me.#onKeyDown.bind(me)}\"\r\n            @formsubmit=\"${me.#onBtnConfirm.bind(me)}\"\r\n            @submit=\"${me.#onBtnConfirm.bind(me)}\"\r\n            @validation=\"${me.#onFormValidation.bind(me)}\"\r\n            class=\"${classMap(me.renderClass())}\">\r\n            <div class=\"${classMap(me.#renderContent())}\">\r\n                <div class=\"card-header user-select-none ${me.cssHeader}\">\r\n                  <div class=\"card-title ${me.cssTitle}\">\r\n                    <slot name=\"title\">${me.translate(me.title)}</slot>\r\n                  </div>\r\n                </div>\r\n                <div class=\"card-body ${me.cssBody}\">\r\n                  <slot name=\"body\">\r\n                  ${me.translate(me.message)}\r\n                  ${me.renderTemplate()}\r\n                  </slot>\r\n                  </div>\r\n                  ${me.#renderFooter()}\r\n                  </div>\r\n                  <slot name=\"extra\"></slot>\r\n                  <div class=\"toast-container position-fixed\"></slot></div>\r\n                  </dialog>\r\n                  `;\r\n  }\r\n\r\n  /**\r\n   * Generic modal popup function\r\n   * @param {string} title Modal title\r\n   * @param {string} message Modal message \r\n   * @param {boolean} closable Can user close it (close button)\r\n   * @param {boolean} cancelable Is cancel button available\r\n   * @returns {Promise}\r\n   */\r\n  info(title = '', message = '', closable = false, cancelable = false) {\r\n    const me = this;\r\n    me.title = title;\r\n    me.message = message;\r\n    me.closable = closable;\r\n    me.cancelable = cancelable;\r\n    me.escapable = cancelable;\r\n    me.open();\r\n    if (closable || cancelable) return me.waitEvent('close');\r\n  }\r\n\r\n  confirm(title = '', message = '') {\r\n    return this.info(title, message, true, false);\r\n  }\r\n\r\n  prompt(title = '', message = '') {\r\n    return this.info(title, message, true, true);\r\n  }\r\n\r\n  reset(data, index = 0) {\r\n    index = GSUtil.asNum(index, 0);\r\n    const me = this;\r\n    //me.forms?.forEach?.(f => { f.reset(); f.data = data; });\r\n    me.forms?.forEach?.(f => { f.data = data; });\r\n    const tab = me.tab;\r\n    if (tab && index > -1) tab.index = index;\r\n  }\r\n\r\n  open() {\r\n    this.opened = true;\r\n  }\r\n\r\n  close() {\r\n    this.opened = false;\r\n  }\r\n\r\n  toggle() {\r\n    this.opened = !this.opened;\r\n  }\r\n\r\n  async waitClose() {\r\n    return this.waitEvent('close');\r\n  }\r\n\r\n  /**\r\n   * Retrun true if dialog is opened by hashbang.\r\n   * Used to clear the hashbang on close\r\n   */\r\n  get isHashed() {\r\n    return GSUtil.asBool(this.dataset.gsHashed);\r\n  }\r\n\r\n  get form() {\r\n    return this.query('gs-form', true, true);\r\n  }\r\n\r\n  get forms() {\r\n    return this.queryAll('gs-form', true, true);\r\n  }\r\n\r\n  get tab() {\r\n    return this.query('gs-tab-group', true, true);\r\n  }\r\n\r\n  get #dialog() {\r\n    return this.#dialogRef.value;\r\n  }\r\n\r\n  get #btnConfirm() {\r\n    return this.#btnConfirmRef.value;\r\n  }\r\n\r\n  get #btnCancel() {\r\n    return this.#btnCancelRef.value;\r\n  }\r\n\r\n  /**\r\n   * Return active button\r\n   * @returns {HTMLButtonElement|GSButton}\r\n   */\r\n  #focusable() {\r\n    const me = this;\r\n    const form = me.queryAll(GSDOM.QUERY_INPUT, true).filter(el => GSDOM.isVisible(el)).shift();\r\n    if (form) return form;\r\n    if (me.cancelable) return me.#btnCancel;\r\n    if (me.closable) return me.#btnConfirm;\r\n    return me;\r\n  }\r\n\r\n  #onDlgClose(e) {\r\n    this.close();\r\n  }\r\n\r\n  #onDlgCancel(e) {\r\n    const me = this;\r\n    const forms = me.forms;\r\n    if (forms) {\r\n      const isInvalid = forms.map(form => form.isValid).filter(v => v === false).length > 0;\r\n      if (isInvalid) return GSEvents.prevent(e);\r\n    }\r\n    me.close();\r\n  }\r\n\r\n  #onBtnConfirm(e) {\r\n    const me = this;\r\n    if (me.disabled) return;\r\n    me.#dialog?.requestClose();\r\n  }\r\n\r\n  #onBtnCancel(e) {\r\n    this.close();\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n    const me = this;\r\n    if (e.key === 'Escape') {\r\n      GSEvents.prevent(e);\r\n      if (me.cancelable || me.escapable) {\r\n        me.close();\r\n      }\r\n    }\r\n  }\r\n\r\n  #onFormValidation(e) {\r\n    const me = this;\r\n    me.#btnConfirm.disabled = e.detail.valid === false;\r\n  }\r\n\r\n  static #updateStack() {\r\n    GSDialogElement.#STACK = GSDialogElement.#STACK.filter(v => v.isConnected);\r\n  }\r\n\r\n  /**\r\n   * Return number of dialogs in a stack\r\n   */\r\n  static get size() {\r\n    return GSDialogElement.#STACK.length;\r\n  }\r\n\r\n  static get top() {\r\n    GSDialogElement.#updateStack();\r\n    const size = GSDialogElement.size;\r\n    return size === 0 ? null : GSDialogElement.#STACK[size - 1];\r\n  }\r\n\r\n  static get opened() {\r\n    GSDialogElement.#updateStack();\r\n    return Array.from(GSDialogElement.#STACK);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-dialog');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, unsafeHTML, html, ifDefined } from '../lib.mjs';\r\nimport { placement, PlacementTypes } from '../properties/placement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSDrawerElement extends GSElement {\r\n\r\n  static properties = {\r\n    autoclose: { reflect: true, type: Boolean },\r\n    closable: { reflect: true, type: Boolean },\r\n    backdrop: { reflect: true, type: Boolean },\r\n    expanded: { reflect: true, type: Boolean },\r\n    scroll: { reflect: true, type: Boolean },\r\n\r\n    min: { reflect: true, type: Number},\r\n    max: { reflect: true},\r\n    fingers: { reflect: true, type: Number},\r\n    placement: {...placement},\r\n    \r\n    transition: { reflect: true },\r\n    duration: { reflect: true, type: Number },\r\n\r\n    title: { reflect: true},\r\n\r\n    cssTitle: { reflect: true, attribute: \"css-title\"},\r\n    cssHead: { reflect: true, attribute: \"css-head\" },\r\n    cssBody: { reflect: true, attribute: \"css-body\" },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.placement = 'start';\r\n    me.cssTitle = 'fs-5';\r\n    me.transition = 'linear';\r\n    me.duration = 0.2;\r\n    me.min = 0;\r\n    me.max = 'auto';\r\n    me.fingers = 2;\r\n    me.on('mouseleave', me.#onLeave.bind(me));\r\n    me.on('mouseenter', me.#onEnter.bind(me));\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`${unsafeHTML(me.#style)}\r\n    <div tabindex=\"-1\" dir=\"${ifDefined(me.direction)}\"\r\n     class=\"offcanvas overflow-hidden anime ${classMap(me.renderClass())}\">\r\n      ${me.#header}\r\n      <div class=\"offcanvas-body  ${me.cssBody}\">\r\n        ${me.renderTemplate()}\r\n        <slot name=\"body\"></slot>\r\n      </div>\r\n    </div>${me.#backdrop}`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'show': true,\r\n      'anime-open' : me.expanded,\r\n      'anime-close' : !me.expanded,\r\n      [`offcanvas-${me.placement}`]: me.placement,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  get #style() {\r\n    const me = this;\r\n    const pos = me.isHorizontal ? 'width' : 'height';\r\n    return `<style>\r\n    .anime {\r\n      transition-property: ${pos} !important;\r\n      transition-duration: ${me.duration}s  !important;\r\n      transition-timing-function: ${me.transition} !important;\r\n    }\r\n    .anime-open {\r\n        ${pos} : ${me.max}${GSUtil.isNumber(me.max) ? 'px':''} !important;\r\n    }\r\n    .anime-close {\r\n      ${pos} : ${me.min}${GSUtil.isNumber(me.min) ? 'px':''} !important;\r\n    }    \r\n    </style>`;\r\n  }\r\n\r\n  get #backdrop() {\r\n    const me = this;\r\n    if (!me.backdrop) return '';\r\n    return html`<div class=\"offcanvas-backdrop fade ${me.expanded ? 'show' : 'invisible'}\" @click=\"${me.close}\"></div>`;\r\n  }\r\n\r\n  get #button() {\r\n    const me = this;\r\n    return me.closable ? html`<button type=\"button\" class=\"btn-close text-reset\" @click=\"${me.close}\"></button>` : '';\r\n  }\r\n\r\n  get #title() {\r\n    const me = this;\r\n    return me.title ? html`<div class=\"offcanvas-title ${me.cssTitle}\">${me.translate(me.title)}</div>` : '';\r\n  }\r\n\r\n  get #header() {\r\n    const me = this;\r\n    return me.#hasHeader ? html`<div class=\"offcanvas-header ${me.cssHead}\"><slot name=\"header\">${me.#title}${me.#button}</slot></div>` : '';\r\n  }\r\n\r\n  get #headSlot() {\r\n    return this.querySelector('[slot=\"header\"]', false, true);\r\n  }\r\n\r\n  get #hasHeader() {\r\n    return this.title || this.closable || this.#headSlot;\r\n  }\r\n\r\n  #notify(val) {\r\n    const me = this;\r\n    me.expanded = val == true;\r\n    me.notify();\r\n  }\r\n\r\n  #onLeave() {\r\n    const me = this;\r\n    if (me.autoclose) me.close();\r\n  }\r\n\r\n  #onEnter() {\r\n    const me = this;\r\n    if (me.min > 0) me.open();\r\n  }\r\n\r\n  open() {\r\n    this.#notify(true);\r\n  }\r\n\r\n  close() {\r\n    this.#notify(false);\r\n  }\r\n\r\n  toggle() {\r\n    this.#notify(!this.expanded);\r\n  }\r\n\r\n  get isHorizontal() {\r\n    return !this.isVertical;\r\n  }\r\n\r\n  get isVertical() {\r\n    return PlacementTypes.isVertical(this.placement);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-drawer');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDropdownElement class\r\n * @module components/GSDropdownElement\r\n */\r\n\r\nimport { html, ifDefined } from '../lib.mjs';\r\nimport { cssMap } from '../directives/css-map.mjs';\r\nimport { color } from '../properties/color.mjs';\r\nimport { GSMenuElement } from './Menu.mjs';\r\n\r\n/**\r\n * Renderer for panel layout \r\n * @class\r\n * @extends {GSMenuElement}\r\n */\r\nexport class GSDropdownElement extends GSMenuElement {\r\n\r\n    static properties = {\r\n        icon: {},\r\n        text: {...color},\r\n        color: {...color},\r\n        size: {},\r\n        title: {},\r\n        tooltip: {},\r\n        group: {},\r\n        simple: {type:Boolean}\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.auto = true;\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div class=\"dropdown\"  dir=\"${ifDefined(me.direction)}\">\r\n                ${me.#renderButton()}\r\n                ${super.renderUI()}\r\n            </div>`;\r\n    }\r\n\r\n    #buttonClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            'btn': true,\r\n            [`btn-${me.color}`] : me.color ? true : false,\r\n            'dropdown-toggle': !me.simple,\r\n            'shadow-none' : true,\r\n        }\r\n        return css;\r\n    }\r\n\r\n    #renderButton() {\r\n        const me = this;\r\n        return html`<gs-link css=\"${cssMap(me.#buttonClass())}\"\r\n            url=\"#\"         \r\n            icon=\"${ifDefined(me.icon)}\"\r\n            text=\"${ifDefined(me.text)}\"\r\n            size=\"${ifDefined(me.size)}\"\r\n            title=\"${ifDefined(me.title)}\"\r\n            tooltip=\"${ifDefined(me.tooltip)}\"\r\n            @notify=\"${me.toggle}\">\r\n            </gs-link>`;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-dropdown');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { css, html, unsafeHTML } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\n/**\r\n * Safe email rendering to protect from spam bots.\r\n */\r\nexport class GSEmailElement extends GSElement {\r\n\r\n  static shadowRootOptions = { mode: 'closed' }\r\n\r\n  static style = css`.e-mail:before {\r\n    content: attr(data-website) \"\\0040\" attr(data-user);\r\n    unicode-bidi: bidi-override;\r\n    direction: rtl;\r\n    }`;\r\n\r\n  static properties = {\r\n    user: { reflect: true },\r\n    domain: { reflect: true },\r\n    dev: { type: Boolean }\r\n  }\r\n\r\n  #user;\r\n  #domain;\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  willUpdate(changes) {\r\n    super.willUpdate(changes);\r\n    this.#updateUser();\r\n    this.#updateDomain()\r\n  }\r\n\r\n  renderUI() {\r\n    return html`${unsafeHTML(this.#style)}<a @click=\"${this.#onClick}\" class=\"e-mail\" data-user=\"${this.#user}\" data-website=\"${this.#domain}\"  href=\"mailto://\"></a>`;\r\n  }\r\n\r\n  get #style() {\r\n    return '<style>.e-mail:before { content: attr(data-website) \"\\u0040\" attr(data-user); unicode-bidi: bidi-override; direction: rtl; }</style>';\r\n  }\r\n\r\n  get #url() {\r\n    return `mailto://${GSUtil.reverse(this.dataset.user)}@${GSUtil.reverse(this.dataset.domain)}`;\r\n  }\r\n\r\n  #updateUser() {\r\n    const me = this;\r\n    const dataset = me.dataset;\r\n    if (me.user) {\r\n      me.#user = dataset.user || GSUtil.reverse(me.user);\r\n      if (me.dev) dataset.user = me.#user;\r\n      me.user = '';\r\n    }\r\n  }\r\n\r\n  #updateDomain() {\r\n    const me = this;\r\n    const dataset = me.dataset;\r\n    if (me.domain) {\r\n      me.#domain = dataset.domain || GSUtil.reverse(me.domain);\r\n      if (me.dev) dataset.domain = me.#domain;\r\n      me.domain = '';\r\n    }\r\n  }\r\n\r\n  #onClick(e) {\r\n    const me = this;\r\n    me.prevent(e);\r\n    window.location.href = me.#url;\r\n    //window.open(me.#url, '_blank');  \r\n  }\r\n\r\n  static {\r\n    this.define('gs-email');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, html, ifDefined, ref, templateContent } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { HANDLER } from '../base/GSConst.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSLog } from '../base/GSLog.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\nexport class GSFormElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    data: { type: Object },\r\n    disabled: { reflect: true, type: Boolean },\r\n\r\n    url: { reflect: true },\r\n    name: { reflect: true },\r\n    rel: { reflect: true },\r\n    acceptCharset: { reflect: true, attribute: 'accept-charset' },\r\n    autocapitalize: { reflect: true },\r\n    autocomplete: { reflect: true },\r\n\r\n    // default settings for FormGroup or gs-ext-* form elements\r\n    autocopy: { reflect: true, type: Boolean },\r\n    autoselect: { reflect: true, type: Boolean },\r\n    autovalidate: { reflect: true, type: Boolean },\r\n    autoreport: { reflect: true, type: Boolean },\r\n    autosubmit: { reflect: true, type: Boolean },\r\n\r\n    action: { reflect: true },\r\n    enctype: { reflect: true },\r\n    method: { reflect: true },\r\n    novalidate: { reflect: true, type: Boolean },\r\n    target: { reflect: true },\r\n\r\n    block: { reflect: true, type: Boolean },\r\n    beep: { reflect: true, type: Boolean },\r\n    timeout: { reflect: true, type: Number }\r\n  }\r\n\r\n  #formRef = createRef();\r\n  #lastState = undefined;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.data = {};\r\n    me.disabled = false;\r\n    me.autocopy = false;\r\n    me.autoselect = false;\r\n    me.autovalidate = false;\r\n    me.autoreport = false;\r\n    me.autosubmit = false;\r\n    me.block = false;\r\n    me.beep = false;\r\n    me.timeout = 0;\r\n    me.method = \"dialog\";\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<form is=\"gs-ext-form\"\r\n      ${ref(me.#formRef)}\r\n      id=\"${ifDefined(me.name)}\"\r\n      name=\"${ifDefined(me.name)}\"\r\n      dir=\"${ifDefined(me.direction)}\"\r\n      class=\"${classMap(me.renderClass())}\"\r\n      \r\n      @submit=\"${me.submit}\"\r\n      @reset=\"${me.reset}\"\r\n      @change=\"${me.formChange}\"\r\n      @validation=\"${me.formValidation}\"\r\n      @enabled=\"${me.formEnabled}\"\r\n      @disabled=\"${me.formDisabled}\"\r\n      \r\n      method=\"${me.method}\"      \r\n      url=\"${ifDefined(me.url)}\"\r\n      \r\n      rel=\"${ifDefined(me.rel)}\"\r\n      acceptCharset=\"${ifDefined(me.acceptCharset)}\"\r\n      autocapitalize=\"${ifDefined(me.autocapitalize)}\"\r\n      autocomplete=\"${ifDefined(me.autocomplete)}\"\r\n      action=\"${ifDefined(me.action)}\"\r\n      enctype=\"${ifDefined(me.enctype)}\"\r\n      target=\"${ifDefined(me.target)}\"\r\n\r\n      .beep=\"${me.beep}\"\r\n      .block=\"${me.block}\"\r\n      .disabled=\"${me.disabled}\"\r\n      .autocopy=\"${me.autocopy}\"\r\n      .autoselect=\"${me.autoselect}\"\r\n      .autovalidate=\"${me.autovalidate}\"\r\n      .autoreport=\"${me.autoreport}\"\r\n      .autosubmit=\"${me.autosubmit}\"\r\n\r\n      ?novalidate=\"${me.novalidate}\">\r\n      ${templateContent(me.#elementTemplate)}\r\n      <slot></slot>\r\n    </form>`;\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    const me = this;\r\n    me.dataController?.read();\r\n  }\r\n\r\n  updated(changed) {\r\n    const me = this;\r\n    if (changed.has('data')) {\r\n      if (GSUtil.isNull(me.data)) {\r\n        //me.reset();\r\n        me.form?.reset();\r\n      } else {\r\n        me.asJSON = Object.assign(me.asJSON, me.data);\r\n      }\r\n    }\r\n  }\r\n\r\n  templateInjected() {\r\n    const me = this;\r\n  }\r\n\r\n  async reset(e) {\r\n    const me = this;\r\n    me.data = {};\r\n    await me.dataController?.read(me.asJSON);\r\n    return me.formReset(e);\r\n  }\r\n\r\n  async submit(e) {\r\n    GSEvents.prevent(e, true, false, false);\r\n    const me = this;\r\n    if (me.disabled ||!me.isValid) return;\r\n    await me.dataController?.write(me.asJSON);\r\n    return me.formSubmit(e);\r\n  }\r\n\r\n  formValidation(e) {\r\n    const me = this;\r\n    me[HANDLER]?.forEach((c) => c.formValidation?.(me));\r\n    me.emit('validation', e?.detail, true, true);\r\n  }\r\n\r\n  formEnabled(e) {\r\n    const me = this;\r\n    me[HANDLER]?.forEach((c) => c.formEnabled?.(me));\r\n    me.emit('enabled', e?.detail, true, true);    \r\n  }\r\n  \r\n  formDisabled(e) {\r\n    const me = this;\r\n    me[HANDLER]?.forEach((c) => c.formDisabled?.(me));\r\n    me.emit('disabled', e?.detail, true, true);    \r\n  }\r\n\r\n  formChange(e) {\r\n    const me = this;\r\n    me[HANDLER]?.forEach((c) => c.formChange?.(me));\r\n    me.emit('formchange', e?.detail, true, true);\r\n  }\r\n\r\n  formSubmit(e) {\r\n    const me = this;\r\n    me[HANDLER]?.forEach((c) => c.formSubmit?.(me));\r\n    return me.emit('formsubmit', e?.detail, true, true, true);\r\n  }\r\n\r\n  formReset(e) {\r\n    const me = this;\r\n    me[HANDLER]?.forEach((c) => c.formReset?.(me));\r\n    me.emit('formreset', e?.detail, true, true);\r\n  }\r\n\r\n  addController(controller) {\r\n    if (controller.isForm) {\r\n      this[HANDLER]?.add(controller);\r\n    }\r\n    super.addController?.(controller);\r\n  }\r\n\r\n  removeController(controller) {\r\n    this[HANDLER]?.delete(controller);\r\n    super.removeController?.(controller);\r\n  }\r\n\r\n  get submitButton() {\r\n    return this.form?.submitButton;\r\n  }\r\n\r\n  get resetButton() {\r\n    return this.form?.resetButton;\r\n  }\r\n\r\n  get form() {\r\n    return this.#formRef.value;\r\n  }\r\n\r\n  /**\r\n  * Overide native to pickup all form elements, including ones in shadow dom\r\n  */\r\n  get elements() {\r\n    return this.form?.elements || [];\r\n  }\r\n\r\n  /**\r\n   * Get all form attached native fields unwrapepd from GSWebComponents\r\n   */\r\n  get fields() {\r\n    return this.form?.fields || [];\r\n  }\r\n\r\n  /**\r\n   * Find all inputs by querying across inner shadow \r\n   */\r\n  get inputs() {\r\n    return this.form?.inputs || [];\r\n  }\r\n\r\n  get invalid() {\r\n    return this.form?.invalid;\r\n  }\r\n\r\n  get isValid() {\r\n    return this.form?.isValid;\r\n  }\r\n\r\n  get asJSON() {\r\n    return this.form?.asJSON || {};\r\n  }\r\n\r\n  set asJSON(data) {\r\n    const me = this;\r\n    if (me.form) {\r\n      me.form.asJSON = data;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Find field by name\r\n   * @param {*} name \r\n   * @returns \r\n   */\r\n  field(name) {\r\n    return this.form?.field(name);\r\n  }\r\n\r\n  checkValidity() {\r\n    return this.form?.checkValidity();\r\n  }\r\n\r\n  reportValidity() {\r\n    return this.form?.reportValidity();\r\n  }\r\n\r\n  /**\r\n   * For DataController read callback\r\n   * \r\n   * @param {Array} data \r\n   */\r\n  onDataRead(data) {\r\n    const me = this;\r\n    if (Array.isArray(data)) {\r\n      data.forEach(o => me.asJSON = o);\r\n    } else {\r\n      me.asJSON = data;\r\n    }\r\n  }\r\n\r\n  onDataWrite(data) {\r\n\r\n  }\r\n\r\n  onDataError(e) {\r\n    GSLog.error(this, e);\r\n  }\r\n\r\n  get #elementTemplate() {\r\n    const tplEl = this.firstElementChild;\r\n    return GSDOM.isTemplateElement(tplEl) ? tplEl : this.templateRef;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-form');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, ref, html, unsafeHTML, ifDefined } from '../lib.mjs';\r\nimport { inputType, numGT0, numGE0, autocapitalize, autocorrect } from '../properties/index.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { dataset } from '../directives/dataset.mjs';\r\n\r\nexport class GSFormGroupElement extends GSElement {\r\n\r\n  static CSS_LABEL_CELL = 'col-md-4 col-sm-4 col-xs-2';\r\n  static CSS_LABEL = 'user-select-none fw-small fw-light text-secondary';\r\n  static CSS_ICON = 'text-primary me-2 fs-5';\r\n  static ICON = 'info-circle-fill';\r\n\r\n  static formAssociated = true;\r\n\r\n  static #SELECTOPT = {\r\n    name: {},\r\n    value: {},\r\n    selected: { type: Boolean }\r\n  }\r\n\r\n  static properties = {\r\n    icon: { reflect: true },\r\n    layout: { reflect: true },\r\n    placement: { reflect: true },\r\n\r\n    label: { reflect: true },\r\n    description: { reflect: true },\r\n    placeholder: { reflect: true },\r\n\r\n    pattern: { reflect: true },\r\n    mask: { reflect: true },\r\n\r\n    form: { reflect: true },\r\n    wrap: { reflect: true },\r\n    spellcheck: { reflect: true },\r\n\r\n    type: { reflect: true, ...inputType },\r\n    name: { reflect: true },\r\n    list: { reflect: true },\r\n    accept: { reflect: true },\r\n    value: { noAccessor: true },\r\n\r\n    values: {},\r\n\r\n    lang: { reflect: true },\r\n    title: { reflect: true },\r\n    rows: { type: Number, reflect: true, hasChanged: numGT0 },\r\n    cols: { type: Number, reflect: true, hasChanged: numGT0 },\r\n    step: { type: Number, reflect: true, hasChanged: numGT0 },\r\n    min: { type: Number, reflect: true, hasChanged: numGE0 },\r\n    max: { type: Number, reflect: true, hasChanged: numGT0 },\r\n    minLength: { type: Number, reflect: true, hasChanged: numGE0 },\r\n    maxLength: { type: Number, reflect: true, hasChanged: numGT0 },\r\n\r\n    reverse: { reflect: true, type: Boolean },\r\n    selectable: { reflect: true, type: Boolean },\r\n    toggling: { reflect: true, type: Boolean },\r\n\r\n    autoid: { type: Boolean, reflect: true },\r\n    autocopy: { type: Boolean, reflect: true },\r\n    autoselect: { type: Boolean, reflect: true },\r\n\r\n    autocapitalize: { ...autocapitalize, reflect: true },\r\n    autocorrect: { ...autocorrect, reflect: true },\r\n    autocomplete: { reflect: true },\r\n    autofocus: { type: Boolean, reflect: true },\r\n    autoselect: { type: Boolean, reflect: true },\r\n    autovalidate: { type: Boolean, reflect: true },\r\n    autoreport: { type: Boolean, reflect: true },\r\n\r\n    disabled: { type: Boolean, reflect: true },\r\n    checked: { type: Boolean, reflect: true },\r\n    multiple: { type: Boolean, reflect: true },\r\n    reveal: { type: Boolean, reflect: true },\r\n    readonly: { type: Boolean, reflect: true },\r\n    required: { type: Boolean, reflect: true },\r\n\r\n    invalidMessage: { reflect: true, attribute: 'invalid-message' },\r\n\r\n    cellField: { reflect: true, attribute: 'cell-field' },\r\n    cellLabel: { reflect: true, attribute: 'cell-label' },\r\n    cssLabel: { reflect: true, attribute: 'css-label' },\r\n    cssField: { reflect: true, attribute: 'css-field' },\r\n\r\n    block: { reflect: true, type: Boolean },\r\n    beep: { reflect: true, type: Boolean },\r\n    timeout: { reflect: true, type: Number }\r\n  }\r\n\r\n  #styleID = GSID.id;\r\n  #inputRef = createRef();\r\n  #ouptutRef = createRef();\r\n  #patterns = [];\r\n  #options = [];\r\n  #internals = null;\r\n\r\n  constructor() {\r\n    super();\r\n    this.#internals = this.attachInternals();\r\n    this.#validateAllowed();\r\n    this.dynamicStyle(this.#styleID);\r\n    this.rows = 0;\r\n    this.cols = 0;\r\n    this.type = 'text';\r\n    this.placement = 'top';\r\n    this.layout = 'horizontal';\r\n    this.invalidMessage = 'Invalid input',\r\n    this.icon = GSFormGroupElement.ICON;\r\n    this.cssLabel = GSFormGroupElement.CSS_LABEL;\r\n    this.cellLabel = GSFormGroupElement.CSS_LABEL_CELL;\r\n  }\r\n\r\n  connectedCallback() {\r\n    const me = this;\r\n    const form = me.formComponent;\r\n    me.layout = GSAttr.get(form, 'layout', me.layout);\r\n\r\n    if (!me.form && form) me.form = form.name;\r\n\r\n    if (me.selectable) {\r\n      me.#options = GSItem.proxify(me, GSFormGroupElement.#SELECTOPT);\r\n    } else {\r\n      me.#patterns = GSItem.collect(me)\r\n        .filter(el => el.dataset.pattern)\r\n        .map(el => new RegExp(el.dataset.pattern));\r\n    }\r\n    super.connectedCallback();\r\n  }\r\n\r\n  updated(changed) {\r\n    const me = this;\r\n    //me.#onInput();\r\n    me.emit('input');\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    switch (me.layout) {\r\n      case 'floating': return me.#renderFloating();\r\n      case 'vertical': return me.#renderVertical();\r\n      default: return me.#renderHorizontal();\r\n    }\r\n  }\r\n\r\n\r\n  #renderFloating() {\r\n    const me = this;\r\n    return html`\r\n    <div  dir=\"${ifDefined(me.direction)}\" class=\"row ${classMap(me.renderClass())}\">\r\n       <div class=\"form-floating ${me.#cssCheck} ${me.#cellField}\">\r\n          ${me.#renderInput()}\r\n          ${me.#renderOutput()}\r\n          ${me.#renderLabel()}\r\n       </div>\r\n       ${me.#renderInfo()}\r\n    </div>\r\n    <slot></slot>`;\r\n  }\r\n\r\n  #renderVertical() {\r\n    const me = this;\r\n    return html`\r\n    <div  dir=\"${ifDefined(me.direction)}\" class=\"row ${classMap(me.renderClass())}\">\r\n      <div class=\"col-12 text-md-start ${me.cellLabel}\">\r\n          ${me.#renderLabel()}\r\n      </div>\r\n       <div class=\"${me.#cssCheck} ${me.#cellField}\">\r\n          ${me.#renderInput()}\r\n          ${me.#renderOutput()}\r\n       </div>\r\n       ${me.#renderInfo()}   \r\n    </div>      \r\n    <slot></slot>`;\r\n  }\r\n\r\n  #renderHorizontal() {\r\n    const me = this;\r\n    return html`\r\n    <div  dir=\"${ifDefined(me.direction)}\" class=\"row form-group ${classMap(me.renderClass())}\">    \r\n       <slot name=\"header\"></slot>\r\n       ${me.#renderLabelWrap()}\r\n       ${me.#renderField()}\r\n       ${me.#renderInfo()}\r\n       <slot name=\"footer\"></slot>\r\n    </div>\r\n    <slot></slot>`;\r\n  }\r\n\r\n  #renderLabel() {\r\n    const me = this;\r\n    return html`<label class=\"${me.#cssLabel} ${me.cssLabel} user-select-none\" for=\"${me.name}\">${me.translate(me.label)}</label>`;\r\n  }\r\n\r\n  #renderLabelWrap() {\r\n    const me = this;\r\n    return html`<div class=\" text-md-end ${me.cellLabel}\">${me.#renderLabel()}</div>`;\r\n  }\r\n\r\n  #renderIcon() {\r\n    const me = this;\r\n    return me.#isIcon ? html`<gs-icon size=\"5\" css=\"${GSFormGroupElement.CSS_ICON}}\" name=\"${me.icon}\"></gs-icon>` : html`<slot name=\"icon\"></slot>`;\r\n  }\r\n\r\n  #renderTooltip() {\r\n    const me = this;\r\n    const tgt = me.#isIcon ? '@parent' : `[name='${me.name}']`;\r\n    return me.description ? html`<gs-tooltip local language=\"${ifDefined(me.language)}\" placement=\"${me.placement}\" title=\"${me.description}\" target=${ifDefined(tgt)}></gs-tooltip>` : '';\r\n  }\r\n\r\n  #renderInfo() {\r\n    const me = this;\r\n    const tooltip = me.#renderTooltip();\r\n    if (tooltip && me.#isIcon) return html`\r\n    <div class=\"col-auto\">\r\n       ${tooltip}\r\n       ${me.#renderIcon()}\r\n    </div>`;\r\n    return tooltip;\r\n  }\r\n\r\n  #renderField() {\r\n    const me = this;\r\n    return html`\r\n    <div class=\"${me.#cssCheck} ${me.#cellField}\">\r\n       <slot name=\"body\">${me.#renderInput()}${me.#renderOutput()}</slot>\r\n    </div>`;\r\n  }\r\n\r\n  #renderOutput() {\r\n    const me = this;\r\n    if (!me.isRange) return \"\";\r\n    return html`<span ${ref(me.#ouptutRef)} class=\"position-absolute px-1\">${me.value}</span>`;\r\n  }\r\n\r\n  #renderInput() {\r\n\r\n    const me = this;\r\n\r\n    const idattr = me.autoid ? me.name : undefined;\r\n    const val = me.isFieldset ? me.values.split(',') : me.value;\r\n\r\n    if (Array.isArray(val)) {\r\n      const wrap = me.dataset.radioLayout === 'vertical';\r\n      return val.map((it, i) => { return { v: it, id: `${me.name}_${i}` } })\r\n        .map((o, i) => me.#fieldSet(me.name + i, o.v, me.#inputHTML(o.id, me.name, o.v), wrap));\r\n    }\r\n\r\n    if (me.selectable) return me.#selectHTML(idattr, me.name, me.value);\r\n\r\n    if (me.#isTextArea) return me.#textArea(idattr, me.name, me.value);\r\n\r\n    return me.#inputHTML(idattr, me.name, me.value);\r\n  }\r\n\r\n  #fieldSet(id, val, fld, vertical = false) {\r\n    const me = this;\r\n    return vertical ?\r\n      html`<div class=\"me-3\">${fld}<label for=\"${id}\" class=\"ms-1\">${me.translate(val)}</label></div>`\r\n      :\r\n      html`<span class=\"me-3\">${fld}<label for=\"${id}\" class=\"ms-1\">${me.translate(val)}</label></span>`;\r\n  }\r\n\r\n  #initStyle() {\r\n    const me = this;\r\n    const style = {\r\n      transform: me.reverse && me.isRange ? 'rotateY(180deg)' : ''\r\n    }\r\n    me.dynamicStyle(me.#styleID, style);\r\n  }\r\n\r\n  #renderOption(el) {\r\n    const title = el.name || el.innerText || el.value;\r\n    return html`<option ${dataset(el, false)} value=\"${el.value}\" ?selected=\"${el.selected}\">${title}</option>`;\r\n  }\r\n\r\n  #renderOptions() {\r\n    const me = this;\r\n    return me.#options.map(el => me.#renderOption(el));\r\n    /*\r\n    return repeat(me.#options, (el) => el.value, (el, index) => {\r\n      return html`<option value=\"${el.value}\">${el.name || el.innerText || el.value}</option>`\r\n    });\r\n    */\r\n  }\r\n\r\n  #selectHTML(id, name, value) {\r\n    const me = this;\r\n    me.#initStyle();\r\n\r\n    // not used \r\n    // id=${ifDefined(id)} \r\n    return html`<select is=\"gs-ext-select\"\r\n            ${ref(me.#inputRef)}\r\n            ${dataset(me, false)}\r\n\r\n            @change=\"${me.#onChange.bind(me)}\"\r\n            @blur=\"${me.#onBlur.bind(me)}\"\r\n        \r\n            name=\"${name}\"             \r\n            form=\"${ifDefined(me.form)}\"\r\n            class=\"${me.#cssField} ${me.cssField} ${me.#styleID}\" \r\n\r\n            ?autofocus=\"${me.autofocus || me.form?.autofocus}\"\r\n            ?autocopy=\"${me.autocopy || me.form?.autocopy}\"\r\n            ?autoselect=\"${me.autoselect || me.form?.autoselect}\"\r\n            ?autovalidate=\"${me.autovalidate || me.form?.autovalidate}\"\r\n            ?autoreport=\"${me.autoreport || me.form?.autoreport}\"\r\n\r\n            ?toggling=\"${me.toggling}\"\r\n            ?readonly=\"${me.readonly}\"\r\n            ?required=\"${me.required}\"\r\n            ?disabled=\"${me.disabled}\">\r\n              ${me.#renderOptions()}\r\n            </select>`;\r\n  }\r\n\r\n  get #isTextArea() {\r\n    const me = this;\r\n    return (me.rows > 0 || me.cols > 0) && me.type === 'text';\r\n  }\r\n\r\n  get #listHTML() {\r\n    const me = this;\r\n    let list = '';\r\n    if (me.list) {\r\n      const root = me.parentComponent || me.parentElement;\r\n      const el = GSDOM.query(root, `datalist[id=\"${me.list}\"]`, true, true);\r\n      if (el) list = html`${unsafeHTML(el.outerHTML)}`;\r\n    }\r\n    return list;\r\n  }\r\n\r\n  get #isBlock() {\r\n    return this.block || this.formComponent?.block || false;\r\n  }\r\n\r\n  get #isBeep() {\r\n    return this.beep || this.formComponent?.beep || false;\r\n  }\r\n\r\n  #timeout() {\r\n    return this.timeout || this.formComponent?.timeout || 0;\r\n  }\r\n\r\n  #textArea(id, name, value) {\r\n    const me = this;\r\n    me.#initStyle();\r\n    const placeholder = me.placeholder ? me.translate(me.placeholder, false) : null;\r\n    const title = me.title ? me.translate(me.title, false) : null;\r\n\r\n    // not used\r\n    // id=${ifDefined(id)}\r\n\r\n    return html`<textarea is=\"gs-ext-textarea\" \r\n            ${ref(me.#inputRef)}\r\n            ${dataset(me, false)}\r\n            @input=\"${me.#onInput.bind(me)}\"\r\n            @change=\"${me.#onChange.bind(me)}\"\r\n            @blur=\"${me.#onBlur.bind(me)}\"\r\n            @invalid=\"${me.#onInvalid.bind(me)}\"\r\n            lang=\"${ifDefined(me.lang)}\"\r\n            minlength=\"${ifDefined(me.minLength)}\"\r\n            maxlength=\"${ifDefined(me.maxLength)}\"\r\n            cols=\"${me.cols}\"\r\n            rows=\"${me.rows}\"\r\n\r\n            ?block=\"${me.#isBlock}\"\r\n            ?beep=\"${me.#isBeep}\"\r\n            timeout=\"${me.#timeout()}\"\r\n\r\n            spellcheck=\"${ifDefined(me.spellcheck)}\" \r\n            wrap=\"${ifDefined(me.wrap)}\" \r\n            form=\"${ifDefined(me.form)}\" \r\n            name=\"${name}\" \r\n            value=\"${ifDefined(value)}\"\r\n            placeholder=\"${ifDefined(placeholder)}\"\r\n            title=\"${ifDefined(title)}\"\r\n    \r\n            class=\"${me.#cssField} ${me.cssField} ${me.#styleID}\" \r\n\r\n            autocomplete=\"${ifDefined(me.autocomplete)}\"\r\n            autocorrect=\"${ifDefined(me.autocorrect)}\"\r\n            autocapitalize=\"${ifDefined(me.autocapitalize)}\"\r\n\r\n            ?autofocus=\"${me.autofocus || me.form?.autofocus}\"\r\n            ?autocopy=\"${me.autocopy || me.form?.autocopy}\"\r\n            ?autoselect=\"${me.autoselect || me.form?.autoselect}\"\r\n            ?autovalidate=\"${me.autovalidate || me.form?.autovalidate}\"\r\n            ?autoreport=\"${me.autoreport || me.form?.autoreport}\"\r\n\r\n            ?readonly=\"${me.readonly}\"\r\n            ?required=\"${me.required}\"\r\n            ?disabled=\"${me.disabled}\"      \r\n      ></textarea>`;\r\n  }\r\n\r\n  #inputHTML(id, name, value) {\r\n    const me = this;\r\n    const type = me.isSwitch ? 'checkbox' : me.type;\r\n    let title = me.isRange ? me.defaultValue : me.title;\r\n    title = title ? me.translate(me.title, false) : title;\r\n\r\n    const placeholder = me.placeholder ? me.translate(me.placeholder, false) : null;\r\n    const description = me.description ? me.translate(me.description, false) : null;\r\n\r\n    me.#initStyle();\r\n\r\n    // this does not work, \"is\" must be set explicitly, or it will not initialize element properly\r\n    // is=\"${ifDefined(me.isDate ? '' : 'gs-ext-input')}\"\r\n\r\n    // not used\r\n    // id=${ifDefined(id)} \r\n\r\n    return html`<input is=\"gs-ext-input\"\r\n            ${ref(me.#inputRef)}\r\n            ${dataset(me, false)}\r\n\r\n            @input=\"${me.#onInput.bind(me)}\"\r\n            @change=\"${me.#onChange.bind(me)}\"\r\n            @blur=\"${me.#onBlur.bind(me)}\"\r\n            @invalid=\"${me.#onInvalid.bind(me)}\"\r\n        \r\n            name=\"${name}\" \r\n            type=\"${type}\" \r\n            form=\"${ifDefined(me.form)}\"\r\n            value=\"${ifDefined(value)}\"\r\n            title=\"${ifDefined(title)}\"\r\n\r\n\r\n            ?block=\"${me.#isBlock}\"\r\n            ?beep=\"${me.#isBeep}\"\r\n            timeout=\"${me.#timeout()}\"\r\n\r\n            class=\"${me.#cssField} ${me.cssField} ${me.mask ? 'font-monospace' : ''} ${me.#styleID}\" \r\n\r\n            placeholder=\"${ifDefined(placeholder)}\"\r\n            description=\"${ifDefined(description)}\"\r\n\r\n            .multipattern=\"${ifDefined(me.#patterns)}\"\r\n            mask=\"${ifDefined(me.mask)}\"\r\n            pattern=\"${ifDefined(me.pattern)}\"\r\n            list=\"${ifDefined(me.list)}\"\r\n            accept=\"${ifDefined(me.accept)}\"\r\n             \r\n            step=\"${ifDefined(me.step)}\"\r\n            min=\"${ifDefined(me.min)}\"\r\n            max=\"${ifDefined(me.max)}\"\r\n            lang=\"${ifDefined(me.lang)}\"\r\n\r\n            minlength=\"${ifDefined(me.minLength)}\"\r\n            maxlength=\"${ifDefined(me.maxLength)}\"\r\n\r\n            autocomplete=\"${ifDefined(me.autocomplete)}\"\r\n            autocorrect=\"${ifDefined(me.autocorrect)}\"\r\n            autocapitalize=\"${ifDefined(me.autocapitalize)}\"\r\n\r\n            ?autofocus=\"${me.autofocus || me.form?.autofocus}\"\r\n            ?autocopy=\"${me.autocopy || me.form?.autocopy}\"\r\n            ?autoselect=\"${me.autoselect || me.form?.autoselect}\"\r\n            ?autovalidate=\"${me.autovalidate || me.form?.autovalidate}\"\r\n            ?autoreport=\"${me.autoreport || me.form?.autoreport}\"            \r\n\r\n            ?multiple=\"${me.multiple}\"\r\n            ?checked=\"${me.checked}\"\r\n            ?readonly=\"${me.readonly}\"\r\n            ?required=\"${me.required}\"\r\n            ?disabled=\"${me.disabled}\"\r\n            ?reveal=\"${me.reveal}\"\r\n            >${me.#listHTML}`;\r\n  }\r\n\r\n  get #cssField() {\r\n    const me = this;\r\n    if (me.selectable) return 'form-select ms-0';\r\n    if (me.isCheckable) return 'form-check-input ms-0';\r\n    if (me.isRange) return 'form-range';\r\n    return 'form-control';\r\n  }\r\n\r\n  get #cssLabel() {\r\n    const me = this;\r\n    if (me.isCheckable) return 'form-check-label';\r\n    if (me.isFloating) return 'ms-2';\r\n    return me.isVertical ? 'form-label' : '';\r\n  }\r\n\r\n  get #cssCheck() {\r\n    const me = this;\r\n    if (me.isCheckable) {\r\n      //return me.#isSwitch ? 'form-check form-switch ps-3 fs-5' : 'form-check';\r\n      if (me.isSwitch) return 'form-check form-switch ps-3 fs-5';\r\n      return me.isFieldset ? '' : 'form-check';\r\n    }\r\n    return '';\r\n  }\r\n\r\n  get #cellField() {\r\n    const me = this;\r\n    const val = (me.isHorizontal) ? '6' : '11';\r\n    return me.cellField || `col-md-${val} col-sm-${val} col-xs-11`;\r\n  }\r\n\r\n  get #isIcon() {\r\n    return GSUtil.isStringNonEmpty(this.icon);\r\n  }\r\n\r\n  #onInput(e) {\r\n    if (!e.composed) this.emit(e.type, e);\r\n  }\r\n\r\n  #onBlur(e) {\r\n    if (!e.composed) this.emit(e.type, e, true, true);\r\n  }\r\n\r\n  #onChange(e) {\r\n    const me = this;\r\n    const field = me.field;\r\n    me.#internals?.setFormValue(field.value);\r\n    me.#internals?.setValidity(field.validity, field.validationMessage, field);\r\n    if (!e.composed) me.emit(e.type, e, true, true);\r\n    me.requestUpdate();\r\n  }\r\n\r\n  #onInvalid(e) {\r\n    if (!e.composed) this.emit('invalid', e, true, true);\r\n  }\r\n\r\n  #validateAllowed() {\r\n    const me = this;\r\n    const slots = ['header', 'body', 'footer'];\r\n    let list = Array.from(me.children).filter(el => el.slot && !slots.includes(el.slot));\r\n    if (list.length > 0) throw new Error(`Custom element injection must contain slot=\"header|body|footer\" attribute! Element: ${me.tagName}, ID: ${me.id}`);\r\n    list = Array.from(me.children).filter(el => !el.slot);\r\n    const tagList = ['GS-ITEM', 'DATALIST'];\r\n    const allowed = GSDOM.isAllowed(list, tagList);\r\n    if (!allowed) throw new Error(GSDOM.toValidationError(me, tagList));\r\n  }\r\n\r\n  translate(value = '', sanitize) {\r\n    value = super.translate(value);\r\n    return sanitize ? GSUtil.sanitize(value) : value;\r\n  }\r\n\r\n  reset() {\r\n    this.field?.reset?.();\r\n  }\r\n\r\n  get isFloating() {\r\n    return this.layout === 'floating';\r\n  }\r\n\r\n  get isHorizontal() {\r\n    return this.layout === 'horizontal';\r\n  }\r\n\r\n  get isVertical() {\r\n    return this.layout === 'vertical';\r\n  }\r\n\r\n  get isFieldset() {\r\n    const me = this;\r\n    return me.type === 'radio' && me.values?.includes(',');\r\n  }\r\n\r\n  get isCheckable() {\r\n    const me = this;\r\n    return me.isCheck || me.isRadio || me.isSwitch;\r\n  }\r\n\r\n  get isChecked() {\r\n    return this.field?.checked;\r\n  }\r\n\r\n  get isCheck() {\r\n    return this.type === 'checkbox';\r\n  }\r\n\r\n  get isRadio() {\r\n    return this.type === 'radio';\r\n  }\r\n\r\n  get isSwitch() {\r\n    return this.type === 'switch';\r\n  }\r\n\r\n  get isNumber() {\r\n    return this.type === 'number';\r\n  }\r\n\r\n  get isRange() {\r\n    return this.type === 'range';\r\n  }\r\n\r\n  get isText() {\r\n    return this.type === 'text';\r\n  }\r\n\r\n  get isPassword() {\r\n    return this.type === 'passsword';\r\n  }\r\n\r\n  get isEmail() {\r\n    return this.type === 'email';\r\n  }\r\n\r\n  get isURL() {\r\n    return this.type === 'url';\r\n  }\r\n\r\n  get isFile() {\r\n    return this.type === 'file';\r\n  }\r\n\r\n  get isDate() {\r\n    return this.type === 'date';\r\n  }\r\n\r\n  get field() {\r\n    return this.#inputRef.value;\r\n  }\r\n\r\n  get value() {\r\n    const me = this;\r\n    return me.field ? me.field?.value : me.defaultValue;\r\n  }\r\n\r\n  set value(val) {\r\n    const me = this;\r\n    if (me.field) me.field.value = val;\r\n  }\r\n\r\n  get defaultValue() {\r\n    const me = this;\r\n    return me.field ? me.field.defaultValue : GSAttr.get(me, 'value', '');\r\n  }\r\n\r\n  set defaultValue(val) {\r\n    const me = this;\r\n    if (me.field) me.field.defaultValue = val;\r\n    GSAttr.set(me, 'value', val);\r\n\r\n  }\r\n\r\n  get validity() {\r\n    return this.#internals.validity;\r\n  }\r\n\r\n  get formComponent() {\r\n    return GSDOM.closest(this, 'gs-form');\r\n  }\r\n\r\n  static {\r\n    this.define('gs-form-group');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, html, render, ifDefined, ref, repeat } from '../lib.mjs';\r\nimport { GSLog } from '../base/GSLog.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSFormGroupElement } from './FormGroup.mjs';\r\n\r\n// TODO: Make generic JSON to template generator, \r\n// then create string template and apply it to the lit html function.\r\n// Use all properties exstractor from super components and use type definition for bool proeprties.\r\n// Use xtype(#tagName) to define component type and use it to create component instance.\r\n\r\n/**\r\n * Component is responsible for auto-building gs-form and gs-form-group elements\r\n * from either JSON data or GS-ITEM elements.\r\n */\r\nexport class GSFormPanelElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    data: { type: Array },\r\n  }\r\n\r\n  #formRef = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    this.data = this.#proxify;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const data = me.data || {};\r\n    // const tpl = me.#renderContent(); \r\n    const tpl = me.#renderTemplate();\r\n    return html`<gs-form ${ref(me.#formRef)}\r\n\r\n      storage=\"${ifDefined(data.storage)}\" \r\n      disabled=${ifDefined(data.disabled)}.\r\n      data=\"${ifDefined(data.data)}\"\r\n      \r\n      name=\"${ifDefined(data.name)}\"\r\n      rel=\"${ifDefined(data.rel)}\"\r\n      acceptCharset=\"${ifDefined(data.acceptCharset)}\"\r\n      autocapitalize=\"${ifDefined(data.autocapitalize)}\"\r\n      autocomplete=\"${ifDefined(data.autocomplete)}\"\r\n\r\n      action=\"${ifDefined(data.action)}\"\r\n      enctype=\"${ifDefined(data.enctype)}\"\r\n      method=\"${ifDefined(data.method)}\"\r\n      novalidate=\"${ifDefined(data.novalidate)}\"\r\n      target=\"${ifDefined(data.target)}\"\r\n\r\n      block=\"${ifDefined(data.block)}\"\r\n      beep=\"${ifDefined(data.beep)}\"\r\n      timeout=\"${ifDefined(data.timeout)}\"\r\n\r\n      flat=\"${ifDefined(data.flat)}\"\r\n      rtl=\"${ifDefined(data.rtl)}\"\r\n      hide=\"${ifDefined(data.hide)}\"\r\n      padding=\"${ifDefined(data.padding)}\"\r\n      margin=\"${ifDefined(data.margin)}\"\r\n      rounded=\"${ifDefined(data.rounded)}\"\r\n      bordered=\"${ifDefined(data.bordered)}\"\r\n      shadow=\"${ifDefined(data.shadow)}\"\r\n      keep=\"${ifDefined(data.keep)}\"\r\n      css=\"${ifDefined(data.css)}\"\r\n      theme=\"${ifDefined(data.theme)}\"\r\n      os=\"${ifDefined(data.os)}\"\r\n      browser=\"${ifDefined(data.browser)}\"\r\n      language=\"${ifDefined(data.language)}\"\r\n      environment=\"${ifDefined(data.environment)}\"\r\n      orientation=\"${ifDefined(data.orientation)}\"\r\n      protocol=\"${ifDefined(data.protocol)}\"\r\n      template=\"${ifDefined(data.template)}\"      \r\n      >${tpl}</gs-form>`;\r\n    //${templateContent(tpl)}\r\n    //${unsafeHTML(tpl.outerHTML)}\r\n  }\r\n\r\n  #renderTemplate() {\r\n    const tpl = document.createElement('template');\r\n    const content = this.#renderContent();\r\n    render(content, tpl.content);\r\n    return tpl;\r\n  }\r\n\r\n  #renderContent() {\r\n    const me = this;\r\n    const items = me.data?.items || [];\r\n    return html`${repeat(items, (item) => me.#renderFormGroup(me.data, item))}`;\r\n  }\r\n\r\n  // to generate into a template, all properties must be attributes, \r\n  // as properties are not transferable outside of template\r\n  #renderFormGroup(definition, item) {\r\n    return html`<gs-form-group \r\n      icon=\"${ifDefined(item.icon)}\"\r\n      layout=\"${ifDefined(item.layout)}\"\r\n      placement=\"${ifDefined(item.placement)}\"\r\n\r\n      label=\"${ifDefined(item.label)}\"\r\n      description=\"${ifDefined(item.description)}\"\r\n      placeholder=\"${ifDefined(item.placeholder)}\"\r\n      \r\n      pattern=\"${ifDefined(item.pattern)}\"\r\n      mask=\"${ifDefined(item.mask)}\"\r\n\r\n      form=\"${ifDefined(item.form)}\"\r\n      formaction=\"${ifDefined(item.formaction)}\"\r\n      formenctype=\"${ifDefined(item.formenctype)}\"\r\n      formmethod=\"${ifDefined(item.formmethod)}\"\r\n      formnovalidate=\"${ifDefined(item.formnovalidate)}\"\r\n      formtarget=\"${ifDefined(item.formtarget)}\"\r\n      wrap=\"${ifDefined(item.wrap)}\"\r\n      spellcheck=\"${ifDefined(item.spellcheck)}\"\r\n\r\n      type=\"${ifDefined(item.type)}\"\r\n      name=\"${ifDefined(item.name)}\"\r\n      list=\"${ifDefined(item.list)}\"\r\n      accept=\"${ifDefined(item.accept)}\"\r\n      value=\"${ifDefined(item.value)}\"\r\n      \r\n      lang=\"${ifDefined(item.lang)}\"\r\n      title=\"${ifDefined(item.title)}\"\r\n      cols=\"${ifDefined(item.cols)}\"\r\n      rows=\"${ifDefined(item.rows)}\"\r\n      step=\"${ifDefined(item.step)}\"\r\n      min=\"${ifDefined(item.min)}\"\r\n      max=\"${ifDefined(item.max)}\"\r\n      maxlength=\"${ifDefined(item.maxlength)}\"\r\n      minlength=\"${ifDefined(item.minlength)}\"\r\n\r\n      reverse=\"${ifDefined(item.reverse)}\"\r\n      selectable=\"${ifDefined(item.selectable)}\"\r\n\r\n      autoid=\"${ifDefined(item.autoid)}\"\r\n      autocopy=\"${ifDefined(item.autocopy)}\"\r\n      autoselect=\"${ifDefined(item.autoselect)}\"\r\n\r\n      autocapitalize=\"${ifDefined(item.autocapitalize)}\"\r\n      autocorrect=\"${ifDefined(item.autocorrect)}\"\r\n      autocomplete=\"${ifDefined(item.autocomplete)}\"\r\n\r\n      autofocus=\"${ifDefined(item.autofocus)}\"\r\n      autoselect=\"${ifDefined(item.autoselect)}\"\r\n\r\n      disabled=\"${ifDefined(item.disabled)}\"\r\n      checked=\"${ifDefined(item.checked)}\"\r\n      multiple=\"${ifDefined(item.multiple)}\"\r\n      reveal=\"${ifDefined(item.reveal)}\"\r\n      readonly=\"${ifDefined(item.readonly)}\"\r\n      required=\"${ifDefined(item.required)}\"\r\n\r\n      invalidMessage=\"${ifDefined(item.invalidMessage)}\"  \r\n      \r\n      block=\"${ifDefined(item.block || definition.block)}\"\r\n      beep=\"${ifDefined(item.beep || definition.beep)}\"\r\n      timeout=\"${ifDefined(item.timeout || definition.timeout)}\"\r\n\r\n      flat=\"${ifDefined(item.flat)}\"\r\n      rtl=\"${ifDefined(item.rtl)}\"\r\n      hide=\"${ifDefined(item.hide)}\"\r\n      padding=\"${ifDefined(item.padding)}\"\r\n      margin=\"${ifDefined(item.margin)}\"\r\n      rounded=\"${ifDefined(item.rounded)}\"\r\n      bordered=\"${ifDefined(item.bordered)}\"\r\n      shadow=\"${ifDefined(item.shadow)}\"\r\n      keep=\"${ifDefined(item.keep)}\"\r\n      css=\"${ifDefined(item.css)}\"\r\n      theme=\"${ifDefined(item.theme)}\"\r\n      os=\"${ifDefined(item.os)}\"\r\n      browser=\"${ifDefined(item.browser)}\"\r\n      language=\"${ifDefined(item.language || definition.language)}\"\r\n      environment=\"${ifDefined(item.environment)}\"\r\n      orientation=\"${ifDefined(item.orientation)}\"\r\n      protocol=\"${ifDefined(item.protocol)}\"\r\n      template=\"${ifDefined(item.template)}\">\r\n      </gs-form-group>`;\r\n  }\r\n\r\n  get form() {\r\n    return this.#formRef.value;\r\n  }\r\n\r\n  onDataRead(data) {\r\n    this.data = data;\r\n  }\r\n\r\n  onDataError(e) {\r\n    GSLog.error(this, e);\r\n  }\r\n\r\n  get #proxify() {\r\n    return GSItem.collect(this).map(el => GSAttr.proxify(el, GSFormGroupElement.properties));\r\n  }\r\n\r\n  static {\r\n    this.define('gs-form-panel');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSGroupElement class\r\n * @module components/GSGroupElement\r\n */\r\n\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSAttributeHandler } from '../base/GSAttributeHandler.mjs';\r\nimport { DEF } from '../base/GSConst.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { ElementNavigationController } from '../controllers/ElementNavigationController.mjs';\r\nimport { GroupController } from '../controllers/GroupController.mjs';\r\nimport { classMap, createRef, html, render, ifDefined, ref } from '../lib.mjs';\r\n\r\n/**\r\n * Renderer for grouped elements such as Buttons, Navs, Tabs and lists.\r\n * Components handles grouped elements navigation, selection and focus.\r\n * \r\n * @class\r\n * @extends { GSElement }\r\n */\r\nexport class GSGroupElement extends GSElement {\r\n\r\n  static properties = {\r\n    // multiple lists with single select across \r\n    group: {},\r\n    storage: {},\r\n    circular: { type: Boolean },\r\n    multiple: { type: Boolean },\r\n    data: { type: Array },\r\n  }\r\n\r\n  #elRef = createRef();\r\n  #controller;\r\n  #controllerGroup;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.data = me.initData();\r\n    me.#controller = new ElementNavigationController(me);\r\n    me.#controllerGroup = new GroupController(me);\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    const me = this;\r\n    // allow single setting at the container component to apply to the child\r\n    Array.from(me.children).forEach(it => {\r\n      GSAttributeHandler.clone(me, it, false);\r\n    });\r\n  }\r\n\r\n  #prerender() {\r\n    const me = this;\r\n    me.queryAll('[generated]').forEach(el => el.remove());\r\n    if (me.data.length > 0) {\r\n      const items = me.renderItems();\r\n      const tpl = document.createElement('template');\r\n      render(items, tpl);\r\n      Array.of(...tpl.children).forEach(el => GSDOM.appendChild(me, el));\r\n    }\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    const me = this;\r\n    if (changed.has('data')) {\r\n      me.#prerender();\r\n    }\r\n    super.willUpdate(changed);\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div ${ref(me.#elRef)} \r\n      dir=\"${ifDefined(me.direction)}\"\r\n      class=\"${classMap(me.renderClass())}\">\r\n      ${me.renderWrappedUI()}\r\n      </div>`;\r\n  }\r\n\r\n  renderWrappedUI(name) {\r\n    const me = this;\r\n    return html`<div \r\n      class=\"${classMap(me.renderWrappedClass())}\">\r\n      <slot name=\"${ifDefined(name)}\"></slot>\r\n      </div>`;\r\n  }\r\n\r\n  renderWrappedClass() {\r\n    return {};\r\n  }\r\n\r\n  renderItems() {\r\n    return '';\r\n  }\r\n\r\n  initData() {\r\n    return this.settings(GSItem);\r\n  }\r\n\r\n  previous() {\r\n    this.#controller.previous();\r\n  }\r\n\r\n  next() {\r\n    this.#controller.next();\r\n  }\r\n\r\n  get [DEF]() {\r\n    return this.#elRef.value;\r\n  }\r\n\r\n  get first() {\r\n    return this.#controller.first;\r\n  }\r\n\r\n  get last() {\r\n    return this.#controller.last;\r\n  }\r\n\r\n  get index() {\r\n    return this.items.indexOf(this.selected);\r\n  }\r\n\r\n  set index(val = 0) {\r\n    const me = this;\r\n    const items = me.items;\r\n    if (val >= 0 && val < items.length) {\r\n      me.reset();\r\n      items[val].click();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Reset focus / selection\r\n   */\r\n  reset() {\r\n    this.#controller.reset();\r\n  }\r\n\r\n  onDataRead(data) {\r\n    this.data = data;\r\n  }\r\n\r\n  onBusEvent(e) {\r\n    const { owner, item } = e.detail;\r\n    if (owner != this) {\r\n      if (!item?.disabled || owner?.selectable) {\r\n        this.reset();\r\n      }\r\n    }\r\n  }\r\n\r\n  onSelected(el) {\r\n    this.#controllerGroup.notify(el);\r\n  }\r\n\r\n  get focused() {\r\n    return this.#controller.focused;\r\n  }\r\n\r\n  get selected() {\r\n    return this.#controller.selected;\r\n  }\r\n\r\n  get items() {\r\n    return this.#controller.items;\r\n  }\r\n\r\n  get generated() {\r\n    return this.items.filter(el => el.hasAttribute('generated'));\r\n  }\r\n\r\n  get active() {\r\n    return this.#controller.selected;\r\n  }\r\n\r\n  settings(el) {\r\n    const tagName = customElements.getName(el)?.toUpperCase() || 'GS-ITEM';\r\n    const cfg = GSElement.allProperties(el);\r\n    const items = Array.from(this.children).filter(e => e.tagName === tagName).map(el => GSAttr.proxify(el, cfg));\r\n    const active = items.filter(el => el.active);\r\n    active.forEach((el, idx) => el.active = idx === 0);\r\n    return items;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-group');\r\n  }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, css, html, ifDefined, createRef, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { notEmpty, numGT0 } from '../properties/index.mjs';\r\nimport { color } from '../properties/color.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\nexport class GSIconElement extends GSElement {\r\n\r\n  static styles = css`\r\n    :host {\r\n      --gs-icon-super-color : cornflowerblue;\r\n      --gs-icon-content : '';\r\n    }\r\n    i::after {\r\n      top: -8px;\r\n      font-size: 0.7em;\r\n      position: relative;\r\n      content: var(--gs-icon-content);\r\n      content: attr(data-super);\r\n      color: var(--gs-icon-super-color);\r\n    }`;\r\n\r\n  static properties = {\r\n    name: { reflect: true, hasChanged: notEmpty },\r\n    size: { reflect: true, type: Number, hasChanged: numGT0 },\r\n    color: { reflect: true, ...color },\r\n    superColor: { attribute : 'super-color'},\r\n    super: { reflect: true },\r\n    clickCss: { attribute : 'click-css'},\r\n    hoverCss: { attribute : 'hover-css'},\r\n    _clicked: { attribute:false},\r\n    _hovered: { attribute:false},\r\n  }\r\n\r\n  #ref = createRef();\r\n  \r\n  constructor() {\r\n    super();\r\n    //this.flat = true;\r\n  }\r\n\r\n  /*\r\n  firstUpdated() {\r\n    super.firstUpdated();\r\n    this.#embdeded = GSDOM.matches(this.parentComponent, '[icon]');\r\n  }\r\n  */\r\n\r\n  updated(changed) {\r\n    if (changed.has('_clicked')) {\r\n      if (this._clicked) this.#postAnimate();\r\n    } \r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    me.setCSSProperty(':host', '--gs-icon-super-color', me.superColor);\r\n    return html`<i  ${ref(me.#ref)}\r\n       class=\"bi ${classMap(me.renderClass())}\"\r\n       data-super=\"${ifDefined(me.super)}\"\r\n       @click=\"${me.animate}\"\r\n       @mouseover=\"${me.#onMouseOver}\"\r\n       @mouseout=\"${me.#onMouseOut}\"></i>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      [`text-${me.color}`]: me.color,\r\n      [`bi-${me.name}`]: me.name,\r\n      'fs': me.size > 0,\r\n      [`fs-${me.size}`]: me.size > 0,\r\n      [me.clickCss]: me._clicked,\r\n      [me.hoverCss]: me._hovered,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  async #postAnimate() {\r\n    const me = this;\r\n    const delay = GSUtil.asNum(me.dataset.delay, 1);\r\n    if (delay > 0) {\r\n      await GSUtil.timeout(delay * 1000);\r\n      me._clicked = false;\r\n    }    \r\n  }\r\n\r\n  #onMouseOver(e) {\r\n    this.hover(true);\r\n  }\r\n\r\n  #onMouseOut(e) {\r\n    this.hover(false);\r\n  }\r\n\r\n  animate() {\r\n    const me = this;\r\n    me._hovered = false;\r\n    me._clicked = true;\r\n  }\r\n\r\n  hover(sts = false) {\r\n    const me = this;\r\n    if (sts) {\r\n      me._clicked = false;\r\n    }\r\n    me._hovered = sts;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-icon');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { css, html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { numGT0 } from '../properties/index.mjs';\r\n\r\nexport class GSIndentElement extends GSElement {\r\n\r\n  static styles = css`.indent {\r\n      --gs-indent : 10px;\r\n      margin-left: var(--gs-indent);\r\n      margin-right: var(--gs-indent);\r\n    }`;\r\n\r\n  static properties = {\r\n    flat: { type: Boolean },\r\n    size: { type: Number, hasChanged: numGT0 },\r\n    multiplier: { type: Number, hasChanged: numGT0 }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.size = 1;\r\n    me.multiplier = 10;\r\n  }\r\n\r\n  renderUI() {\r\n    const size = this.size * this.multiplier;\r\n    return html`<span class=\"indent\" style=\"--gs-indent: ${size}px;\"></span>`;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-indent');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, html, ifDefined, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { notEmpty, numGE0 } from '../properties/index.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\nconst numdef = { reflect: true, type: Number, hasChanged: numGE0 };\r\n\r\nexport class GSImageElement extends GSElement {\r\n\r\n  static properties = {\r\n    src: { hasChanged: notEmpty },\r\n    width: numdef,\r\n    height: numdef,\r\n    opacity: numdef,\r\n    invert: numdef,\r\n    grayscale: numdef,\r\n    brightness: numdef,\r\n    blur: numdef,\r\n    contrast: numdef,\r\n    saturate: numdef,\r\n    hue: numdef,\r\n    sepia: numdef,\r\n\r\n    alt: {},\r\n    loading: {}\r\n\r\n  }\r\n\r\n  #imageRef = createRef();\r\n  #styleID = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    this.dynamicStyle(this.#styleID);\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    this.#update();\r\n    return this.src;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<img ${ref(me.#imageRef)} \r\n            @load=\"${me.#onLoad}\"\r\n            src=\"${me.src}\" \r\n            alt=\"${me.alt}\" \r\n            loading=\"${ifDefined(me.loading)}\" \r\n            class=\"${me.#styleID}\" \r\n            data-gs-class=\"${me.#styleID}\">\r\n          </img>`;\r\n  }\r\n\r\n  get complete() {\r\n    return this.#imageRef.value?.complete || false;\r\n  }\r\n\r\n  get #dynamic() {\r\n    return this.dynamicStyle(this.#styleID).style;\r\n  }\r\n\r\n  #renderStyle() {\r\n    const me = this;\r\n    const filter = me.#buildFilter();\r\n    const css = {\r\n      width: me.width > 0 ? me.width : undefined,\r\n      height: me.height > 0 ? me.height : undefined,\r\n      filter: filter.length > 0 ? filter.join(' ') : ''\r\n    }\r\n    return css;\r\n  }\r\n\r\n  #buildFilter() {\r\n    const me = this;\r\n    const o = [];\r\n\r\n    if (me.blur > 0) o.push(`blur(${me.blur}px)`);\r\n    if (me.invert > 0) o.push(`invert(${me.invert})`);\r\n    if (me.opacity > 0) o.push(`opacity(${me.opacity})`);\r\n    if (me.contrast > 0) o.push(`contrast(${me.contrast})`);\r\n    if (me.grayscale > 0) o.push(`grayscale(${me.grayscale})`);\r\n    if (me.brightness > 0) o.push(`brightness(${me.brightness})`);\r\n\r\n    if (me.hue > 0) o.push(`hue-rotate(${me.hue}deg)`);\r\n    if (me.sepia > 0) o.push(`sepia(${me.sepia}%)`);\r\n    if (me.saturate > 0) o.push(`saturate(${me.saturate}%)`);\r\n\r\n    return o;\r\n  }\r\n\r\n  #update() {\r\n    const me = this;\r\n    const dynamic = me.#dynamic;\r\n    dynamic.filter = me.#buildFilter().join(' ').trim();\r\n    dynamic.width = me.width > 0 ? `${me.width}px` : '';\r\n    dynamic.height = me.height > 0 ? `${me.height}px` : '';\r\n  }\r\n\r\n  #onLoad(e) {\r\n    const el = e.target;\r\n    const me = this;\r\n    if (el) {\r\n      me.height = me.height || el.height;\r\n      me.width = me.width || el.width;\r\n      me.emit('loaded', { width: el.width, height: el.height, element: el }, true);\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-image');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSLayout class\r\n * @module components/GSLayoutElement\r\n */\r\n\r\nimport { classMap, html, ifDefined, templateContent } from '../lib.mjs';\r\nimport { orientation, OrientationTypes } from '../properties/orientation.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\n\r\n/**\r\n * Renderer for panel layout \r\n * @class\r\n * @extends {Component}\r\n */\r\nexport class GSLayoutElement extends GSElement {\r\n\r\n    static properties = {\r\n        type: { ...orientation }\r\n    }\r\n\r\n    // GS-ITEM attributes mapping\r\n    static options = {\r\n        id : {},\r\n        type: {},\r\n        min: { type: Number },\r\n        max: { type: Number },\r\n        size: { type: Number },\r\n        resizable: { type: Boolean },\r\n        autofit: { type: Boolean },\r\n        vPos: { attribute: 'h-pos' },\r\n        hPos: { attribute: 'v-pos' },\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;\r\n        me.autofit = true;  \r\n        me.#items(me).map((el, idx, els) => me.#dyncss(el, idx, els, 0));\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        if ( this.autofit && GSDOM.root(this) === document.body) document.body.classList.add('vh-100');\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        const list = me.#items(me).map((el, idx, els) => me.#build(el, idx, els));\r\n        return html`<div  dir=\"${ifDefined(me.direction)}\" class=\"d-flex flex-fill w-100 h-100 ${classMap(me.renderClass())}\">${list}</div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const horizontal = OrientationTypes.isHorizontal(me.type);\r\n        return {\r\n            ...super.renderClass(),\r\n            'flex-column': horizontal\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Proxify GS-ITEM elements to easily read attributes\r\n     */\r\n    #items(root) {\r\n        return GSItem.collect(root).map(el => GSAttr.proxify(el, GSLayoutElement.options));\r\n    }\r\n\r\n    #resizable(el) {\r\n        return el.size > 0 || el.min > 0 || el.max > 0 || el.resizable;\r\n    }\r\n\r\n    #dyncss(el, idx, els, lev = 0) {\r\n        const me = this;\r\n        me.#items(el.self).map((it, idx, items) => me.#dyncss(it, idx, items, lev+1));\r\n        if(me.#resizable(el)) me.dynamicStyle(`gsd-${lev}-${idx}`);\r\n    }\r\n\r\n    #build(el, idx, els, lev = 0) {\r\n\r\n        const me = this;\r\n        const type = el.self.parentElement.type || 'vertical';\r\n\r\n        const list = me.#items(el.self).map((it, idx, items) => me.#build(it, idx, items, lev+1));\r\n        \r\n        const min = el.min;\r\n        const max = el.max;\r\n        const template = el.template;\r\n        const tplEl = me.#elementTemplate(el);\r\n\r\n        const tc = `#${tplEl?.id}` !== template;\r\n\r\n        const dir = el.type || type || 'vertical';\r\n        const horizontal = OrientationTypes.isHorizontal(dir);\r\n        \r\n        const col = list.length > 0 && horizontal ? 'flex-column' : '';\r\n\r\n        const did = `gsd-${lev}-${idx}`;\r\n        const css = me.#panelCSS(el, col, did);\r\n        const style = me.#panelStyle(el, horizontal);\r\n        me.dynamicStyle(did, style);\r\n\r\n        const slot = el.name ? html`<slot name=\"${el.name}\"></slot>` : '';\r\n        const src = html`<div id=\"${ifDefined(el.id)}\" class=\"d-flex ${classMap(css)}\">\r\n            ${list}\r\n            ${templateContent(tplEl)}\r\n            ${template && tc ? html`<gs-template flat src=\"${template}\"></gs-template>` : ''}\r\n            ${slot}\r\n            </div>`;\r\n            // ${tc ? me.renderTemplate() : ''}\r\n            \r\n\r\n        if (!el.resizable) return src;\r\n\r\n        const resize = (idx === els.length - 1) ? 'end' : 'start';\r\n        const splitter = me.#splitter(min, max, type, resize);\r\n\r\n        if (idx === els.length - 1) return [splitter , src];\r\n        return [src, splitter];\r\n    }\r\n    \r\n    #elementTemplate(el) {\r\n        const tplEl = el.self.firstElementChild;\r\n        return  GSDOM.isTemplateElement(tplEl) ? tplEl : undefined;\r\n    }\r\n\r\n    #panelCSS(el, col, did) {\r\n\r\n        const me = this;\r\n        const resizable = me.#resizable(el);\r\n        const grow = resizable ? '' : 'flex-grow-1';\r\n\r\n        let vpos = el.vPos;\r\n        let hpos = el.hPos;\r\n\r\n        hpos = hpos ? `align-items-${hpos}` : '';\r\n        vpos = vpos ? `justify-content-${vpos}` : '';\r\n\r\n        const css = me.mapCSS(el.css, {\r\n            [did] : resizable,\r\n            [col] : col,\r\n            [grow] : grow,\r\n            [hpos] : hpos,\r\n            [vpos] : vpos\r\n        });\r\n    \r\n        return css;        \r\n    }\r\n\r\n    #panelStyle(el, horizontal) {\r\n        const min = el.size || el.min;\r\n        const max = el.max || el.size;\r\n        const style = {};\r\n        if (horizontal) {\r\n            style['min-height'] = min > 0 ? `${min}px` : undefined;\r\n            style['max-height'] = max > 0 ? `${max}px` : undefined;\r\n        } else {\r\n            style['min-width'] = min > 0 ? `${min}px` : undefined;\r\n            style['max-width'] = max > 0 ? `${max}px` : undefined;\r\n        }\r\n        return style;        \r\n    }\r\n\r\n    #splitter(min, max, dir, resize) {\r\n        return html`<gs-splitter split=\"${dir}\" resize=\"${resize}\" min=\"${min}\" max=\"${max}\"></gs-splitter>`;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-layout');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, ifDefined, html, createRef, ref } from '../lib.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color } from '../properties/index.mjs';\r\nimport { dataset } from '../directives/dataset.mjs';\r\n\r\nexport class GSLinklement extends GSElement {\r\n\r\n  static properties = {\r\n    clickCss: { attribute : 'click-css'},\r\n    hoverCss: { attribute : 'hover-css'},\r\n    autofocus: { type: Boolean },\r\n    disabled: { type: Boolean, reflect: true },\r\n    size: { type: Number },\r\n    text: { ...color },\r\n    color: { ...color },\r\n    url: {},\r\n    ping: {},\r\n    icon: {},\r\n    title: {},\r\n    tooltip: {},\r\n    target: {}\r\n  };\r\n\r\n  #refEl = createRef();\r\n  #refIco = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    this.url = '#';\r\n    // this.text = 'primary'; // do not set as default -> gs-dropdown\r\n    // this.target = '_blank'; // not used \r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    if (this.autofocus && !this.disabled) this.focus();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`\r\n      <a ${ref(me.#refEl)}  \r\n        dir=\"${ifDefined(me.direction)}\"\r\n        title=\"${ifDefined(me.translate(me.tooltip))}\" \r\n        href=\"${ifDefined(me.url)}\" \r\n        ping=\"${ifDefined(me.ping)}\" \r\n        target=\"${ifDefined(me.target)}\"\r\n        class=\"${classMap(me.renderClass())}\" \r\n        ?disabled=${me.disabled} \r\n        @mouseover=\"${me.#onMouseOver}\"\r\n        @mouseout=\"${me.#onMouseOut}\"        \r\n        @click=\"${me.#onClick}\">\r\n        ${me.#first}${me.#second}\r\n        </a>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'active': me.active,      \r\n      [`fs-${me.size}`]: me.size > 0,\r\n      [`text-${me.text}`]: me.text,\r\n      [`bg-${me.color}`]: me.color\r\n    }\r\n    return css;\r\n  }\r\n\r\n  click() {\r\n    this.#refEl.value?.click();\r\n  }\r\n\r\n  focus() {\r\n    requestAnimationFrame(() => this.#refEl.value?.focus());\r\n  }\r\n\r\n  get iconEl() {\r\n    return this.#refIco.value;\r\n  }\r\n\r\n  #onClick(e) {\r\n    const me = this;\r\n    me.iconEl?.animate();\r\n    me.notify();\r\n    if (me.url === '#' || GSUtil.isStringEmpty(me.url)) {\r\n      GSEvents.prevent(e);\r\n      me.handle(e);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  #onMouseOver() {\r\n    this.iconEl?.hover(true);\r\n  }\r\n\r\n  #onMouseOut() {\r\n    this.iconEl?.hover(false);\r\n  }\r\n\r\n  get #title() {\r\n    return this.translate(this.title);\r\n  }\r\n\r\n  get #first() { return this.rtl ? this.#title : this.#iconHtml; };\r\n\r\n  get #second() { return this.rtl ? this.#iconHtml : this.#title; };\r\n\r\n  get #iconHtml() { return this.icon ? this.#renderIcon : html`<slot name=\"icon\"></slot>`; }\r\n\r\n  get #renderIcon() {\r\n    return  html`\r\n    <gs-icon css=\"mx-1\" ${ref(this.#refIco)} \r\n    name=\"${this.icon}\" \r\n    size=\"${this.size}\" \r\n    click-css=\"${ifDefined(this.clickCss)}\" \r\n    hover-css=\"${ifDefined(this.hoverCss)}\" \r\n    data-delay=\"1\"></gs-icon>`;\r\n  }\r\n\r\n  /**\r\n   * Generate clickable link\r\n   * @param {*} options \r\n   * @param {*} css \r\n   * @param {*} before \r\n   * @param {*} after \r\n   * @returns \r\n   */\r\n  static generate(options, css, before, after) {\r\n    const opt = options;\r\n    return html`<a class=\"${classMap(css)}\"\r\n        tabindex=\"0\"    \r\n        ${dataset(opt, true)}\r\n        part=\"${ifDefined(opt.part)}\"\r\n        tooltip=\"${ifDefined(opt.tooltip)}\"\r\n        href=\"${ifDefined(opt.url)}\">        \r\n        ${before || ''}\r\n        ${ifDefined(opt.title)}\r\n        <slot></slot> \r\n        ${after || ''}\r\n    </a>`;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-link');\r\n  }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GROUP } from '../base/GSConst.mjs';\r\nimport { html, ifDefined } from '../lib.mjs';\r\nimport { GSGroupElement } from './Group.mjs';\r\n\r\nexport class GSListElement extends GSGroupElement {\r\n\r\n  static properties = {\r\n    selectable: { reflect: true, type: Boolean }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.circular = false;\r\n    this.multiple = false;\r\n    this.selectable = false;\r\n    this[GROUP] = 'GS-LIST-ITEM';\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    return this.data.length > 0 || this.items.length > 0;\r\n  }\r\n\r\n  renderClass() {\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'list-group': true,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  renderWrappedUI() {\r\n    return html`<slot></slot>`;\r\n  }\r\n\r\n  reset() {\r\n    super.reset();\r\n    this.items.forEach(el => el.reset());\r\n    this.notify();\r\n  }\r\n\r\n  renderItems() {    \r\n    return this.data.map(o => {\r\n      return html`<gs-list-item generated\r\n        .active=\"${ifDefined(o.active === true)}\"\r\n        .autofocus=\"${ifDefined(o.autofocus === true)}\"\r\n        .disabled=\"${ifDefined(o.disabled === true)}\" \r\n        icon=\"${ifDefined(o.icon)}\" \r\n        href=\"${ifDefined(o.href)}\" \r\n        target=\"${ifDefined(o.target)}\" \r\n        title=\"${ifDefined(o.title)}\"></gs-list-item>`;\r\n    });\r\n  }\r\n\r\n  isNavigable(el) {\r\n    return super.isNavigable(el) && this.selectable;\r\n  }\r\n \r\n  static {\r\n    this.define('gs-list');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, ifDefined, html, createRef, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\nexport class GSListItemElement extends GSElement {\r\n\r\n  static properties = {\r\n    url: {},\r\n    target: {},\r\n    title: {},\r\n    icon: {},\r\n    size: { type: Number },\r\n    autofocus: { type: Boolean, reflect: true },\r\n    disabled: { type: Boolean, reflect: true },\r\n    active: { type: Boolean, reflect: true }\r\n  }\r\n\r\n  #initial;\r\n  #refEl = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    this.binded();\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    this.#initial = this.active;\r\n  }\r\n\r\n  shouldUpdate(changedProperties) {\r\n    return this.parentComponent?.tagName === 'GS-LIST';\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n        // allow single setting at the gs-list to apply to the child\r\n        // GSAttributeHandler.clone(this.parentComponent, this, false);\r\n        const me = this;\r\n        if (me.isMatchHashBang) me.active = true;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<a  tabindex=\"0\" ${ref(me.#refEl)}\r\n       href=\"${ifDefined(me.href)}\" \r\n       target=\"${ifDefined(me.target)}\" \r\n       class=\"${classMap(me.renderClass())}\">\r\n        ${me.#renderFirst()} \r\n        ${me.#renderSecond()}\r\n        <slot>${me.renderTemplate()}</slot>\r\n      </a>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'list-group-item': true,\r\n      'list-group-item-action': true,\r\n      [`fs-${me.size}`]: me.size > 0,\r\n      [me.#itemCSS] : true,\r\n      'active': me.isActive\r\n    }\r\n    return me.mapCSS(me.#itemStatusCSS, css);\r\n  }\r\n\r\n  get isActive() {\r\n    return this.active && this.isSelectable;\r\n  }\r\n\r\n  get isSelectable() {\r\n    return !GSUtil.asBool(this.disabled) || GSUtil.asBool(this.parentComponent.selectable);\r\n  }\r\n\r\n  get isMatchHashBang() {\r\n    return GSUtil.isStringNonEmpty(this.url) && this.url === location.hash;\r\n  }\r\n\r\n  #renderIcon() {\r\n    const me = this;\r\n    return me.icon ? html`<gs-icon name=\"${me.icon}\" size=\"${me.size}\"></gs-icon>` : html`<slot name=\"icon\"></slot>`;\r\n  }\r\n\r\n  #renderText() {\r\n    return this.title ? html`<span>${this.translate(this.title)}</span>` : html`<slot name=\"title\"></slot>`;\r\n  }\r\n\r\n  #renderFirst() {\r\n    return this.rtl ? this.#renderText() : this.#renderIcon();\r\n  }\r\n\r\n  #renderSecond() {\r\n    return this.rtl ? this.#renderIcon() : this.#renderText();\r\n  }\r\n\r\n  toggle() {\r\n    this.active = !this.active;\r\n  }\r\n\r\n  reset() {\r\n    this.active = this.autofocus || this.#initial || false;\r\n  }\r\n\r\n  click() {\r\n    this.#refEl.value?.click();\r\n  }\r\n\r\n  focus() {\r\n    requestAnimationFrame(() => this.#refEl.value?.focus());\r\n  }\r\n\r\n  get href() {\r\n    return this.url ? this.url : '#';\r\n  }\r\n\r\n  get #activeCSS() {\r\n    return this.parentComponent.dataset?.cssActive || '';\r\n  }\r\n\r\n  get #inactiveCSS() {\r\n    return this.parentComponent.dataset?.cssInactive || '';\r\n  }\r\n\r\n  get #itemCSS() {\r\n    return this.parentComponent.dataset?.cssItem || '';\r\n  }\r\n\r\n  get #itemStatusCSS() {\r\n    return this.isActive ? this.#activeCSS : this.#inactiveCSS;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-list-item');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\n/**\r\n * For debugging purposes for floating element such as popup, popover, menus... \r\n * https://developer.mozilla.org/en-US/docs/Web/CSS/CSSOM_view/Coordinate_systems\r\n */\r\nexport class GSMouseElement extends GSElement {\r\n\r\n  static properties = {\r\n    pageX: { type: Number },\r\n    pageY: { type: Number },\r\n    screenX: { type: Number },\r\n    screenY: { type: Number },\r\n    clientX: { type: Number },\r\n    clientY: { type: Number },       \r\n    offsetX: { type: Number },       \r\n    offsetY : { type: Number }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    this.attachEvent(window, 'mousemove', this.#onMouse.bind(this));\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`\r\n    Offset(${me.offsetX}, ${me.offsetY}) \r\n    Viewport(${me.clientX}, ${me.clientY}) \r\n    Page(${me.pageX}, ${me.pageY}) \r\n    Screen(${me.screenX}, ${me.screenY})`;\r\n  }\r\n\r\n  #onMouse(e) {\r\n    const me = this;\r\n    me.offsetX = e.offsetX;\r\n    me.offsetY = e.offsetY;\r\n    me.clientX = e.clientX;\r\n    me.clientY = e.clientY;\r\n    me.pageX = e.pageX;\r\n    me.pageY = e.pageY;\r\n    me.screenX = e.screenX;\r\n    me.screenY = e.screenY;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-mouse');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, css, html, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color } from '../properties/color.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\n/**\r\n * This component allow moving contained elements acroos UI\r\n */\r\nexport class GSMovableElement extends GSElement {\r\n\r\n  static styles = css`\r\n  :host {\r\n      --gs-width : inherited;\r\n      --gs-height : inherited;\r\n      --gs-min-width: inherited;\r\n      --gs-max-width: inherited;\r\n      --gs-min-height: inherited;\r\n      --gs-max-height: inherited;\r\n  }\r\n  .gs-movable {\r\n    left: var(--mouse-x) !important;\r\n    top: var(--mouse-y) !important;\r\n   }`;\r\n\r\n  static properties = {\r\n    shadow: { type: Boolean},\r\n    border: { type: Boolean},\r\n    color: { reflect: true, ...color }\r\n  }\r\n\r\n  #styleID = GSID.id;\r\n  #refEl = createRef();\r\n  #enabled = false;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.dynamicStyle(me.#styleID);\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    const me = this;\r\n    const root = document.documentElement;\r\n    me.attachEvent(root, 'mousemove', me.#onMove.bind(me));\r\n    me.attachEvent(root, 'mousedown', me.#onMouseDown.bind(me));\r\n    me.attachEvent(root, 'mouseup', me.#onMouseUp.bind(me));\r\n  }\r\n\r\n  firstUpdated() {\r\n    super.firstUpdated();\r\n    const me = this;\r\n    const rule = me.dynamicStyle(me.#styleID);\r\n    Object.assign(rule.style, {cursor: 'move'});\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div ${ref(me.#refEl)} \r\n      data-gs-class=\"${me.#styleID}\"\r\n      class=\"${classMap(me.renderClass())}\"\r\n      @mousedown=\"${() => me.#enabled = true}\"\r\n      @mouseup=\"${() => me.#enabled = false}\">\r\n      <slot></slot>\r\n      </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'gs-movable' : true,\r\n      [me.#styleID]: true,\r\n      'position-absolute' : true,\r\n      'border' : me.border,\r\n      'shadow-sm' : me.shadow,\r\n      [`text-${me.color}`]: me.color,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  #updateCursor(move) {\r\n    const me = this;\r\n    const rule = me.dynamicStyle(me.#styleID);\r\n    Object.assign(rule.style, {'user-select': move ? 'none' : ''});\r\n  }\r\n\r\n  #onMove(e) {\r\n    if (this.#enabled) {\r\n      const style = this.#refEl.value.style;\r\n      style?.setProperty('--mouse-x', e.clientX + \"px\");\r\n      style?.setProperty('--mouse-y', e.clientY + \"px\");\r\n    }\r\n  }\r\n\r\n  #onMouseDown(e) {\r\n    this.#updateCursor(true);\r\n  }\r\n\r\n  #onMouseUp(e) {\r\n    this.#updateCursor(false);\r\n  }\r\n\r\n\r\n  static {\r\n    this.define('gs-movable');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { html, ifDefined } from '../lib.mjs';\r\nimport { GROUP } from '../base/GSConst.mjs';\r\nimport { GSGroupElement } from './Group.mjs';\r\nimport { PlacementTypes, nav, placement } from '../properties/index.mjs';\r\n\r\nexport class GSNavElement extends GSGroupElement {\r\n\r\n  static properties = {\r\n    type: nav,\r\n    placement: placement,\r\n    vertical: { type: Boolean }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.circular = true;\r\n    this.multiple = false;\r\n    this.type = 'pills';\r\n    this.placement = 'start';\r\n    this[GROUP] = 'GS-NAV-ITEM';\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    return this.data.length > 0 || this.items.length > 0;\r\n  }\r\n  \r\n  renderWrappedClass() {\r\n    const me = this;\r\n    const isBefore = PlacementTypes.isBefore(me.placement);\r\n    const isTab = me.type === 'tabs';\r\n    const css = {\r\n      'nav': true,\r\n      [`nav-${me.type}`]: me.type,\r\n      'flex-column': me.vertical,\r\n      'border-bottom-0': me.vertical,\r\n      'border-end': isTab && isBefore && me.vertical,\r\n      'border-start': isTab && !isBefore && me.vertical,\r\n      [`justify-content-${me.placement}`]: !me.vertical\r\n    }\r\n    return css;\r\n  }\r\n\r\n  /**\r\n   * Render items based on data propprty (might be from gs-item)\r\n   * @returns \r\n   */\r\n  renderItems() {\r\n    return this.data.map(o => {\r\n      return html`<gs-nav-item generated\r\n        .active=\"${o.active === true}\"\r\n        .autofocus=\"${o.autofocus === true}\"\r\n        .disabled=\"${ifDefined(o.disabled === true)}\" \r\n        icon=\"${ifDefined(o.icon)}\" \r\n        href=\"${ifDefined(o.href)}\" \r\n        target=\"${ifDefined(o.target)}\" \r\n        title=\"${ifDefined(o.title)}\">\r\n        </gs-nav-item>`;\r\n    });\r\n  }\r\n\r\n  static {\r\n    this.define('gs-nav');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, ifDefined, html, createRef, ref } from '../lib.mjs';\r\nimport { NavTypes, PlacementTypes, color } from '../properties/index.mjs';\r\nimport { KEY } from '../base/GSConst.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSNavItemElement extends GSElement {\r\n\r\n  static properties = {\r\n    href: {},\r\n    target: {},\r\n    title: {},\r\n    icon: {},\r\n    disabled: { type: Boolean },\r\n    autofocus: { type: Boolean },\r\n    active: { type: Boolean, reflect: true },\r\n    tooltip: {}, // Add tooltip property\r\n    badge: { type: Boolean },\r\n    badgeColor: {...color},\r\n    badgeValue: { }\r\n  }\r\n\r\n  #refEl = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    this.badgeColor = 'danger';\r\n    this.badgeValue = '!';\r\n    this.badge = false;\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    delete this[KEY];\r\n    super.disconnectedCallback();\r\n  }\r\n  \r\n  shouldUpdate(changedProperties) {\r\n    return this.parentComponent?.tagName === this.parentType;\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    if (this.autofocus && !this.disabled) this.focus();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div class=\"nav-item position-relative ${classMap(me.renderClass())}\">${me.#button}${me.#badgeUI}</div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    return this.mapCSS(this.#itemsCSS, super.renderClass());\r\n  }\r\n\r\n  reset() {\r\n    this.active = this.autofocus || false;\r\n  }\r\n\r\n  click() {\r\n    this.#refEl.value?.click();\r\n  }\r\n\r\n  focus() {\r\n    requestAnimationFrame(() => this.#refEl.value?.focus());\r\n  }\r\n\r\n  get parentType() {\r\n    return 'GS-NAV';\r\n  }\r\n\r\n  get isNav() {\r\n    return true;\r\n  }\r\n\r\n  get vertical() {\r\n    return this.parentComponent.vertical || false;\r\n  }\r\n\r\n  get placement() {\r\n    return this.parentComponent.placement;\r\n  }\r\n\r\n  get url() {\r\n    return this.href && this.target ? this.href : '#';\r\n  }\r\n\r\n  get #title() {\r\n    return html`<slot>${this.translate(this.title)}</slot>`;\r\n  }\r\n\r\n  get #icon() {\r\n    return this.icon ? html`<gs-icon name=\"${this.icon}\"></gs-icon>` : html`<slot name=\"icon\"></slot>`;\r\n  }\r\n\r\n  get #first() {\r\n    return this.rtl ? this.#title : this.#icon;\r\n  }\r\n\r\n  get #second() {\r\n    return this.rtl ? this.#icon : this.#title;\r\n  }\r\n\r\n  get #button() {\r\n    const me = this;\r\n    let obj = me.mapCSS(me.#buttonCSS, {});\r\n    if (me.active) obj = me.mapCSS(me.#buildCSS + ' ' + me.#activeCSS, obj);\r\n    return html`<a tabindex=\"0\" type=\"button\" role=\"nav\" \r\n     ${ref(me.#refEl)}\r\n     class=\"nav-link ${classMap(obj)}\"\r\n     href=\"${ifDefined(me.url)}\" \r\n     target=\"${ifDefined(me.target)}\"\r\n     title=\"${ifDefined(me.tooltip)}\"> \r\n        ${me.#first} \r\n        ${me.#second}\r\n      </a>`;\r\n  }\r\n\r\n  get #badgeUI() {\r\n    const me = this;\r\n    if (!me.badge) return '';\r\n    const css = {\r\n      'top-0' : true,\r\n      'end-0' : true,\r\n      'translate-middle-y' : true,\r\n      [`text-bg-${me.badgeColor}`]: me.badgeColor,\r\n    };\r\n    return html`<span class=\"badge rounded-pill position-absolute ${classMap(css)}\">${me.badgeValue}</span>`;\r\n  }\r\n\r\n  get #itemsCSS() {\r\n    return this.parentComponent.dataset?.cssItem || '';\r\n  }\r\n\r\n  get #buttonCSS() {\r\n    return this.parentComponent.dataset?.cssButton || '';\r\n  }\r\n\r\n  get #activeCSS() {\r\n    return this.parentComponent.dataset?.cssActive || '';\r\n  }\r\n\r\n  get #navType() {\r\n    return NavTypes.indexOf(this.parentComponent.type);\r\n  }\r\n\r\n  // fiix for shadowed DOM, parent class=\"nav nav-pills..\" \r\n  // do not cross shadow dom, so item elements does not see CSS\r\n  // we have to simulate\r\n  get #buildCSS() {\r\n    const isVertical = this.vertical;\r\n    const isBefore = PlacementTypes.isBefore(this.placement);\r\n    switch (this.#navType) {\r\n      // pills\r\n      case 1: return 'rounded text-bg-primary';\r\n      // tabs\r\n      case 2:\r\n        if (isVertical) {\r\n          if (isBefore) {\r\n            return 'shadow-none border border-end-0';\r\n          } else {\r\n            return 'shadow-none border border-start-0';\r\n          }\r\n        }\r\n        return 'shadow-none border border-bottom-0';\r\n      // underline\r\n      case 3: return 'shadow-none border-bottom border-3 fw-medium';\r\n      default:\r\n        return '';\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-nav-item');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { svg, html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\n\r\nexport class GSOverlayElement extends GSElement {\r\n\r\n    static properties = {\r\n        color: {},\r\n        target: {},\r\n        autoremove: { type: Boolean },\r\n        opened: { type: Boolean },\r\n        opacity: { type: Number },\r\n        padding: { type: Number },\r\n        radius: { type: Number },\r\n    }\r\n\r\n    #styleID = GSID.id;\r\n    #styleID2 = GSID.id;\r\n\r\n    constructor() {\r\n        super();\r\n        //this.color = 'rgb(0,0,0)';\r\n        this.color = '#000';\r\n        this.opacity = 0.7;\r\n        this.padding = 1;\r\n        this.radius = 6;\r\n        this.dynamicStyle(this.#styleID);\r\n        this.dynamicStyle(this.#styleID2);\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        const me = this;\r\n        me.attachEvent(window, 'resize', () => me.requestUpdate());\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        if (!me.opened) return '';\r\n        const path = me.#path;\r\n        return path ? html`<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:space=\"preserve\"\r\n            xmlnsXlink=\"http://www.w3.org/1999/xlink\"\r\n            version=\"1.1\" preserveAspectRatio=\"xMinYMin slice\"\r\n            viewBox=\"0 0 ${window.innerWidth} ${window.innerHeight}\"\r\n            class=\"gs-overlay gs-overlay-animated ${me.#styleID}\"\r\n            @click=\"${me.reset.bind(me)}\">\r\n            ${path}\r\n        </svg>` : '';\r\n    }\r\n\r\n    async firstUpdated(changed) {\r\n        const me = this;\r\n        const opt = {\r\n            fillRule: \"evenodd\",\r\n            clipRule: \"evenodd\",\r\n            strokeLinejoin: \"round\",\r\n            strokeMiterlimit: \"2\",\r\n            zIndex: \"10000\",\r\n            position: \"fixed\",\r\n            top: \"0\",\r\n            left: \"0\",\r\n            width: \"100%\",\r\n            height: \"100%\"\r\n        };\r\n        me.dynamicStyle(me.#styleID, opt);\r\n        super.firstUpdated(changed);\r\n    }\r\n\r\n    open() {\r\n        this.opened = true;\r\n    }\r\n\r\n    close() {\r\n        this.opened = false;\r\n    }\r\n\r\n    toggle() {\r\n        this.opened = !this.opened;\r\n    }\r\n\r\n    reset() {\r\n        const me = this;\r\n        if (me.autoremove) me.close();\r\n    }\r\n\r\n    get #path() {\r\n        const me = this;\r\n        const el = GSDOM.query(me.target);\r\n        if (!me.target) return '';\r\n        const pathStr = me.#createSVGPathString(el);\r\n        const opt = { fill: me.color, opacity: me.opacity, pointerEvents: 'auto', cursor: 'auto' };\r\n        me.dynamicStyle(me.#styleID2, opt);\r\n        return svg`<path class=\"${me.#styleID2}\"  d=\"${pathStr}\"></path>`;\r\n    }\r\n\r\n    #createSVGPathString(target) {\r\n\r\n        const me = this;\r\n        const windowX = window.innerWidth;\r\n        const windowY = window.innerHeight;\r\n\r\n        const rect = target.getBoundingClientRect();\r\n\r\n        const padding = me.padding;\r\n        const radius = me.radius;\r\n\r\n        const width = rect.width + padding * 2;\r\n        const height = rect.height + padding * 2;\r\n\r\n        // prevent glitches when stage is too small for radius\r\n        const limitedRadius = Math.min(radius, width / 2, height / 2);\r\n\r\n        // no value below 0 allowed + round down\r\n        const normalizedRadius = Math.floor(Math.max(limitedRadius, 0));\r\n\r\n        const highlightBoxX = rect.x - padding + normalizedRadius;\r\n        const highlightBoxY = rect.y - padding;\r\n        const highlightBoxWidth = width - normalizedRadius * 2;\r\n        const highlightBoxHeight = height - normalizedRadius * 2;\r\n\r\n        const val = `M${windowX},0L0,0L0,${windowY}L${windowX},${windowY}L${windowX},0Z\r\n            M${highlightBoxX},${highlightBoxY} \r\n            h${highlightBoxWidth} \r\n            a${normalizedRadius},${normalizedRadius} 0 0 1 ${normalizedRadius},${normalizedRadius} \r\n            v${highlightBoxHeight} \r\n            a${normalizedRadius},${normalizedRadius} 0 0 1 -${normalizedRadius},${normalizedRadius} \r\n            h-${highlightBoxWidth} \r\n            a${normalizedRadius},${normalizedRadius} 0 0 1 -${normalizedRadius},-${normalizedRadius} \r\n            v-${highlightBoxHeight} \r\n            a${normalizedRadius},${normalizedRadius} 0 0 1 ${normalizedRadius},-${normalizedRadius} z`;\r\n        return val.replace(/[\\t\\n]/g, ' ');\r\n    }\r\n\r\n    static {\r\n        this.define('gs-overlay');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, html, ifDefined, map, range, ref } from '../lib.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { size, SizeTypes } from '../properties/index.mjs';\r\n\r\nexport class GSPagerElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    size: { ...size },\r\n    first: { type: Boolean },\r\n    last: { type: Boolean },\r\n    next: { type: Boolean },\r\n    previous: { type: Boolean },\r\n    pages: { type: Number },\r\n\r\n    labelFirst: { attribute: 'label-first' },\r\n    labelLast: { attribute: 'label-last' },\r\n    labelNext: { attribute: 'label-next' },\r\n    labelPrevious: { attribute: 'label-previous' },\r\n\r\n    cssItem: { attribute: 'css-item' },\r\n\r\n  }\r\n\r\n  #ref = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.pages = 5;\r\n    me.labelFirst = '&laquo;';\r\n    me.labelLast = '&raquo;';\r\n    me.labelNext = '&rsaquo;';\r\n    me.labelPrevious = '&lsaquo;';\r\n    if (me.#isInTable) {\r\n      me.slot = \"extra\";\r\n    }\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const half = Math.floor((me.pages - 1) / 2);\r\n    const page = me.dataController?.page || 0;\r\n    const start = page - half < 1 ? 1 : page - half;\r\n    const end = page > 0 ? page + half : me.pages;\r\n\r\n    return html`<nav \r\n        dir=\"${ifDefined(me.direction)}\"\r\n        @click=\"${me.#onClick}\"\r\n        @keyup=\"${me.#onKeyUp}\"\r\n        @keydown=\"${me.#onKeyDown}\">\r\n        <ul ${ref(me.#ref)} class=\"${classMap(me.renderClass())}\">\r\n        ${me.#renderFirst()}\r\n        ${me.#renderPrevious()}\r\n        ${map(range(start, end + 1), (i) => me.#renderItem(i, '', '', i  === page))}\r\n        ${me.#renderNext()}\r\n        ${me.#renderLast()}\r\n        </ul></nav>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const size = me.size ? SizeTypes[me.size] || me.size : '';\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'pagination': true,\r\n      'user-select-none': true,\r\n      [`pagination-${size}`]: size,\r\n\r\n    }\r\n    return css;\r\n  }\r\n\r\n  updated() {\r\n    const target = this.#ref.value;\r\n    if (target && this.isFocused) {\r\n      target.querySelector('.active > a')?.focus();\r\n    }\r\n  }\r\n\r\n  onDataRead() {\r\n    this.requestUpdate();\r\n  }\r\n\r\n  #renderFirst() {\r\n    return this.first ? this.#renderItem(this.labelFirst, 'first', 'First page') : '';\r\n  }\r\n\r\n  #renderLast() {\r\n    return this.last ? this.#renderItem(this.labelLast, 'last', 'Last page') : '';\r\n  }\r\n\r\n  #renderPrevious() {\r\n    return this.previous ? this.#renderItem(this.labelPrevious, 'previous', 'Previous page') : '';\r\n  }\r\n\r\n  #renderNext() {\r\n    return this.next ? this.#renderItem(this.labelNext, 'next', 'Next page') : '';\r\n  }\r\n\r\n  #renderItem(text = '', name = '', title = '', active = false) {\r\n    const me = this;\r\n    text = GSUtil.decodeHTMLEntities(text);\r\n    return html`<li class=\"page-item ${active ? 'active' : ''}\">\r\n              <a class=\"page-link ${this.cssItem}\" \r\n                 name=\"${name}\" \r\n                 title=\"${me.translate(title)}\" \r\n                 href=\"#\">${me.translate(text)}</a>\r\n            </li>`;\r\n  }\r\n\r\n  #onClick(e) {\r\n\r\n    const me = this;\r\n    const el = this.#toTarget(e, 'a');\r\n    if (!el) return;\r\n\r\n    const ctrl = me.dataController;\r\n    if (!ctrl) return;\r\n\r\n    const val = el.name || el.text;\r\n    me.emit(val, el);\r\n    \r\n    switch (val) {\r\n      case 'first':\r\n        return ctrl.firstPage();\r\n      case 'last':\r\n        return ctrl.lastPage();\r\n      case 'next':\r\n        return ctrl.nextPage();\r\n      case 'previous':\r\n        return ctrl.prevPage();\r\n    }\r\n\r\n    ctrl.page = val;\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n    const current = this.#toTarget(e, 'li');\r\n    let el = null;\r\n    switch (e.code) {\r\n      case 'ArrowLeft':\r\n        el = current?.previousElementSibling;\r\n        break;\r\n      case 'ArrowRight':\r\n        el = current?.nextElementSibling;\r\n        break;\r\n    }\r\n    el = el?.querySelector('a');\r\n    el?.focus();\r\n  }\r\n\r\n  #onKeyUp(e) {\r\n    if (e.code === 'Space') {\r\n      this.#toTarget(e, 'a')?.click();\r\n    }\r\n  }\r\n\r\n  #toTarget(e, name) {\r\n    const el = e.target.closest(name) || e.target;\r\n    return el.tagName === name.toUpperCase() ? el : undefined;\r\n  }\r\n\r\n  get #isInTable() {\r\n    return this.parentComponent?.tagName === 'GS-TABLE';\r\n  }\r\n  \r\n  static {\r\n    this.define('gs-pagination');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, ref, classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { placement, position } from '../properties/index.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSPopper } from \"../base/GSPopper.mjs\";\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\n\r\nexport class GSPopupElement extends GSElement {\r\n\r\n  static properties = {\r\n    placement: { ...placement },\r\n    position: { ...position },\r\n    trigger: {},\r\n    target: {},\r\n    autoclose: { type: Boolean },\r\n    autofocus: { type: Boolean },\r\n    opened: { type: Boolean },\r\n    hPos: { type: Number, attribute: 'h-pos' },\r\n    vPos: { type: Number, attribute: 'v-pos' },\r\n    wMin: { type: Number, attribute: 'w-min' },\r\n    wMax: { type: Number, attribute: 'w-max' },\r\n    hMin: { type: Number, attribute: 'h-min' },\r\n    hMax: { type: Number, attribute: 'h-max' },\r\n\r\n  }\r\n\r\n  #caller = null;\r\n  #panelRef = createRef();\r\n  #styleID = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    this.autofocus = true;\r\n    this.autoclose = true;\r\n    this.trigger = 'click';\r\n    this.position = 'absolute';\r\n    this.placement = 'bottom';\r\n    this.dynamicStyle(this.#styleID);\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    const me = this;\r\n    me.#attachTarget(); // Fixed typo: #attachTaraget -> #attachTarget\r\n    me.attachEvent(window, 'resize', me.close.bind(me));\r\n    me.on('mouseleave', me.#onAuto.bind(me));\r\n  }\r\n\r\n  firstUpdated(changedProperties) {\r\n    const me = this;\r\n    requestAnimationFrame(() => {\r\n      me.#resize();\r\n      me.#reposition();\r\n    });\r\n    super.firstUpdated();\r\n  }\r\n\r\n  updated() {\r\n    const me = this;\r\n    me.#reposition();\r\n    if (me.autofocus) me.focus();\r\n    me.notify();\r\n    me.#postPopup();\r\n  }\r\n\r\n  willUpdate(changedProperties) {\r\n    if (changedProperties.has('opened')) {\r\n      this.#postPopup();\r\n    }\r\n    return super.willUpdate(changedProperties); \r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div \r\n      ${ref(me.#panelRef)}\r\n      dir=\"${ifDefined(me.direction)}\"\r\n      class=\"fade ${classMap(me.renderClass())}\"\r\n      data-gs-class=\"${me.#styleID}\"\r\n      @keydown=\"${me.#onKeyDown}\">\r\n      ${me.renderTemplate()}\r\n      <slot></slot>\r\n    </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'show': me.opened,\r\n      //'d-none' : !me.opened,\r\n      [me.#styleID]: true,\r\n      [`position-${me.position}`]: me.position,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  focus() {\r\n    this.query('[tabindex], input, select, textarea, button, a', true)?.focus();\r\n  }\r\n\r\n  open() {\r\n    this.opened = true;\r\n  }\r\n\r\n  close() {\r\n    this.opened = false;\r\n  }\r\n\r\n  toggle() {\r\n    this.opened = !this.opened;\r\n  }\r\n\r\n  /**\r\n   * Show popup at x/y position on the screen\r\n   * @param {Number} x \r\n   * @param {Number} y \r\n   * @returns {void}\r\n   */\r\n  popup(x = 0, y = 0) {\r\n    const me = this;\r\n    const obj = {\r\n      top: '0px',\r\n      left: '0px',\r\n      translate: `${x}px ${y}px`\r\n    };\r\n    me.#resize(obj);\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n    const me = this;\r\n    switch (e.key) {\r\n      case 'Escape':\r\n        me.close();\r\n        break;\r\n    }\r\n  }\r\n\r\n  #reposition() {\r\n    const me = this;\r\n    //if (!me.opened) return;\r\n    if (me.vPos || me.hPos) {\r\n      const opt = {\r\n        top: '0px',\r\n        left: '0px',\r\n        translate: `${me.hPos}px ${me.vPos}px`\r\n      };\r\n      const rule = me.dynamicStyle(me.#styleID);\r\n      Object.assign(rule.style, opt);\r\n    } else if (me.target) {\r\n      let target = GSDOM.query(document.documentElement, me.target);\r\n      target = target.renderRoot?.firstElementChild || target;\r\n      GSPopper.popupFixed(me.placement, me.#panel, target);\r\n    }\r\n\r\n  }\r\n\r\n  #resize(obj = {}) {\r\n    const me = this;\r\n    const rule = me.dynamicStyle(me.#styleID);\r\n    if (me.wMax) obj['max-width'] = `${me.wMax}px`;\r\n    if (me.wMin) obj['min-width'] = `${me.wMin}px`;\r\n    if (me.hMax) obj['max-height'] = `${me.hMax}px`;\r\n    if (me.hMin) obj['min-height'] = `${me.hMin}px`;\r\n    Object.assign(rule.style, obj);\r\n  }\r\n\r\n  #onPopup(e) {\r\n    const me = this;\r\n    me.#caller = e;\r\n    if (e instanceof Event) {\r\n      GSEvents.prevent(e);\r\n      me.#caller = e.composedPath().filter(e => (!(e instanceof HTMLSlotElement))).shift();\r\n    }\r\n\r\n    if (me.placement) {\r\n      GSPopper.popupFixed(me.placement, me.#panel, me.#caller);\r\n      me.opened = true;\r\n      return;\r\n    }\r\n\r\n    let x = e.clientX, y = e.clientY;\r\n    const rect = me.#panel.getBoundingClientRect();\r\n    const overflowH = x + rect.width > window.innerWidth;\r\n    const overflowV = y + rect.height > window.innerHeight;\r\n\r\n    if (overflowH) x = window.innerWidth - rect.width;\r\n    if (overflowV) y = window.innerHeight - rect.height;\r\n\r\n    me.popup(x, y);\r\n    return true;\r\n  }\r\n\r\n  #postPopup() {\r\n    const me = this;\r\n    const rule = me.dynamicStyle(me.#styleID);\r\n    Object.assign(rule.style, {display: me.opened ? '' : 'none'}); \r\n  }\r\n\r\n  #attachTarget() { // Fixed typo: #attachTaraget -> #attachTarget\r\n    const me = this;\r\n    const targets = GSDOM.queryAll(document.documentElement, me.target);\r\n    me.trigger.split(' ').forEach(evt => {\r\n      targets.forEach(target => me.attachEvent(target, evt, me.#onPopup.bind(me)));\r\n    });\r\n  }\r\n\r\n  #onAuto(e) {\r\n    if (this.autoclose) this.close();\r\n  }\r\n\r\n  get #panel() {\r\n    return this.#panelRef.value;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-popup');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, ref, classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { placement } from '../properties/index.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSPopper } from '../base/GSPopper.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\n\r\nexport class GSPopoverElement extends GSElement { // Fixed typo: GSPopoverlement -> GSPopoverElement\r\n\r\n  static properties = {\r\n    placement: { ...placement },\r\n    target: {},\r\n    trigger: {},\r\n    title: {},\r\n    content: {},\r\n    opened: { type: Boolean },\r\n  }\r\n\r\n  #arrowRef = createRef();\r\n  #panelRef = createRef();\r\n  #styleID = GSID.id;\r\n  #arrowID = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    // added to the GSCacheStyle\r\n    //me.style.position = 'fixed';\r\n    me.placement = 'top';\r\n    me.trigger = 'hover';\r\n    me.content = '';\r\n    me.dynamicStyle(me.#styleID);\r\n    me.dynamicStyle(me.#arrowID);\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.connectedCallback();\r\n    const me = this;\r\n    me.#attachEvents();\r\n    me.#reposition();\r\n    super.firstUpdated(changed);\r\n  }\r\n  \r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    this.#reposition();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const head = me.title ? html`<div class=\"popover-header ${me.cssHead}\">${me.translate(me.title)}</div>` : '';\r\n    return html`\r\n    <div ${ref(me.#panelRef)} \r\n        dir=\"${ifDefined(me.direction)}\"\r\n        data-popper-placement=\"${me.placement}\"\r\n        class=\"${classMap(me.renderClass())}\" \r\n        data-gs-class=\"${me.#styleID}\" \r\n        role=\"tooltip\">\r\n        <div ${ref(me.#arrowRef)} \r\n          class=\"popover-arrow ${me.#arrowID}\" \r\n          data-gs-class=\"${me.#arrowID}\">\r\n        </div>\r\n        ${head}\r\n        <div class=\"popover-body\">\r\n          ${me.renderTemplate()}\r\n          ${me.content}\r\n          <slot></slot>\r\n        </div>\r\n    </div>            \r\n    `;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'popover': true,\r\n      'bs-popover-auto': true,\r\n      'fade': true,\r\n      'show': me.opened,\r\n      [me.#styleID]: true\r\n    }\r\n    return css;\r\n  }\r\n\r\n  open() {\r\n    this.opened = true;\r\n  }\r\n\r\n  close() {\r\n    this.opened = false;\r\n  }\r\n\r\n  toggle() {\r\n    this.opened = !this.opened;\r\n  }\r\n\r\n  get isFocusTrigger() {\r\n    return this.trigger.includes('focus');\r\n  }\r\n\r\n  get isHoverTrigger() {\r\n    return this.trigger.includes('hover');\r\n  }\r\n\r\n  get #ref() {\r\n    const me = this;\r\n    switch (me.target) {\r\n      case '@parent':\r\n        return this.parentElement;\r\n      case '@previous':\r\n        return this.previousElementSibling;\r\n      case '@next':\r\n        return this.nextElementSibling;\r\n      default:\r\n        return GSDOM.query(document.body, me.target);\r\n    }\r\n  }\r\n\r\n  #reposition() {\r\n    const me = this;\r\n    const source = me.#panel;\r\n    if (!source) return;\r\n    if (me.opened) {\r\n      GSPopper.popupAbsolute(me.placement, source, me.#ref, me.#arrow);\r\n    } else {\r\n      me.dynamicStyle(me.#styleID, {top:'-1000px', left:'-1000px'});\r\n    }\r\n  }\r\n\r\n  // https://javascript.info/mousemove-mouseover-mouseout-mouseenter-mouseleave\r\n  #attachEvents() {\r\n\r\n    const me = this;\r\n    const el = me.#ref;\r\n\r\n    if (me.isHoverTrigger) {\r\n      GSEvents.attach(me, el, 'mouseover', me.open.bind(me));\r\n      GSEvents.attach(me, el, 'mouseleave', me.close.bind(me));\r\n    }\r\n\r\n    if (me.isFocusTrigger) {\r\n      GSEvents.attach(me, el, 'click', me.#onFocus.bind(me));\r\n      GSEvents.attach(me, me.#panel, 'mouseleave', me.close.bind(me));\r\n      GSEvents.attach(me, window, 'click', me.close.bind(me));\r\n    }\r\n\r\n  }\r\n\r\n  #onFocus(e) {\r\n    GSEvents.prevent(e);\r\n    this.toggle();\r\n  }\r\n  \r\n  get #arrow() { return this.#arrowRef.value; }\r\n  get #panel() { return this.#panelRef.value; }\r\n\r\n  static {\r\n    this.define('gs-popover');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { html, classMap, ifDefined } from '../lib.mjs';\r\nimport { literalTemplate } from '../directives/literal.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\nexport class GSProgressElement extends GSElement {\r\n\r\n  static properties = {\r\n    min: { reflect: true, type: Number },\r\n    max: { reflect: true, type: Number },\r\n    step: { reflect: true, type: Number },\r\n    value: { reflect: true, type: Number },\r\n    label: { reflect: true }\r\n  }\r\n\r\n  #styleID = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    this.min = 0;\r\n    this.step = 1;\r\n    this.max = 100;\r\n    this.value = 0;\r\n    this.styles = { width: '0%' };\r\n    this.dynamicStyle(this.#styleID);\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'progress-bar' : true,\r\n      [me.#styleID] : true\r\n    }\r\n    return css;\r\n  }  \r\n\r\n  renderUI() {\r\n    const me = this;\r\n    me.#updateStyle();\r\n    const obj = {min :me.min, max:me.max, step:me.step, value:me.value, percentage:me.percentage};\r\n    return html`\r\n    <div class=\"progress\" @keydown=\"${me.#onKeySelect}\" dir=\"${ifDefined(me.direction)}\">\r\n        <div class=\"${classMap(me.renderClass())}\" \r\n             \r\n             role=\"progressbar\"\r\n             tabindex=\"0\">\r\n             ${literalTemplate(me.label, obj)}\r\n        </div>\r\n    </div>    \r\n    `;\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    const me = this;\r\n    if (changed.has('value')) {\r\n      let val = me.step + changed.get('value');\r\n      val = me.#update(val, val);\r\n      changed.set('value', val);\r\n    }\r\n  }\r\n\r\n  updated(changed) {\r\n    if (changed.has('value')) {\r\n      this.notify();\r\n    }\r\n  }\r\n\r\n  increase(val) {\r\n    const me = this;\r\n    val = GSUtil.isNumber(val) ? val : me.step;\r\n    me.value = me.#update(me.value + val, me.value);\r\n    return true;\r\n  }\r\n\r\n  decrease(val) {\r\n    const me = this;\r\n    val = GSUtil.isNumber(val) ? val : me.step;\r\n    me.value = me.#update(me.value - val, me.value);\r\n    return true;\r\n  }\r\n\r\n  get percentage() {\r\n    const me = this;\r\n    return Math.trunc((me.value / me.max) * 100);\r\n  }\r\n\r\n  #updateStyle() {\r\n    const me = this;\r\n    me.styles.width = `${me.percentage}%`;\r\n    me.dynamicStyle(me.#styleID, me.styles);\r\n  }\r\n\r\n  #update(val, old = 0) {\r\n    val = GSUtil.asNum(val, GSUtil.asNum(old));\r\n    const me = this;\r\n    if (val > me.max) val = me.max;\r\n    if (val < me.min) val = me.min;\r\n    return val;\r\n  }\r\n\r\n  #onKeySelect(e) {\r\n    const me = this;\r\n    switch (e.code) {\r\n      case 'ArrowUp' :\r\n      case 'ArrowRight' :\r\n          return me.increase();\r\n      case 'ArrowLeft' :\r\n      case 'ArrowDown' :\r\n         return me.decrease();\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-progress');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, css, html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color } from '../properties/index.mjs';\r\n\r\nexport class GSSpinnerElement extends GSElement {\r\n\r\n    static styles = css`.spinner-border { border: var(--bs-spinner-border-width) solid currentcolor; border-right-color: transparent; }`;\r\n\r\n    static properties = {\r\n        color: { ...color, reflect: true },\r\n        small: { type: Boolean, reflect: true },\r\n        pulsar: { type: Boolean }\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div class=\"${classMap(me.renderClass())}\" role=\"status\"></div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            \"spinner-border\": !me.pulsar,\r\n            \"spinner-grow\": me.pulsar,\r\n            [`text-${me.color}`]: me.color,\r\n            [`spinner-border-sm`]: !me.pulsar && me.small,\r\n            [`spinner-grow-sm`]: me.pulsar && me.small,\r\n        }\r\n        return css;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-spinner');\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSSplitterElement class\r\n * @module components/GSSplitterElement\r\n */\r\n\r\nimport { classMap, createRef, ref, html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSCSSMap } from '../base/GSCSSMap.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { notEmpty, numGT0, placement } from '../properties/index.mjs';\r\nimport { ElementMoveController } from '../controllers/ElementMoveController.mjs';\r\n\r\n/**\r\n * Renderer for element splitter\r\n * @class\r\n * @extends {Component}\r\n */\r\nexport class GSSplitterElement extends GSElement {\r\n\r\n    static properties = {\r\n        // Check if splitter use vertical or horizontal splitting\r\n        split: { reflect: true },\r\n        // start|end|top|bottom\r\n        resize: { ...placement, hasChanged: notEmpty },\r\n        size: { type: Number, hasChanged: numGT0 }\r\n    }\r\n\r\n    #cursor = 0;\r\n    #styleID = GSID.id;\r\n    #styleTGT = GSID.id;\r\n    #elRef = createRef();\r\n    #mouseController;\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;\r\n        me.size = 8;\r\n        me.resize = 'start';\r\n        me.dynamicStyle(me.#styleID);\r\n        me.#load();\r\n        me.#mouseController = new ElementMoveController(me);\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        super.disconnectedCallback();\r\n        //this.dynamicStyle(this.#styleTGT, null, true);\r\n    }\r\n\r\n    firstUpdated(changed) {\r\n        super.firstUpdated(changed);\r\n        const me = this;\r\n        me.#mouseController.attach(me.#splitter);\r\n        //const shadow = GSDOM.root(me.target) instanceof ShadowRoot;\r\n        //me.dynamicStyle(me.#styleTGT, {}, !shadow);\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div ${ref(me.#elRef)} \r\n            @dblclick=\"${me.#onDoubleClick}\"\r\n            data-gs-class=\"${me.#styleID}\" \r\n            class=\"${classMap(me.renderClass())}\">\r\n            <slot></slot>\r\n        </div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            'splitter': true,\r\n            [me.#styleID]: true\r\n        }\r\n        return css;\r\n    }\r\n\r\n    updated(changedProperties) {\r\n        const me = this;\r\n        me.#cssUpdate();\r\n    }\r\n\r\n    /**\r\n    * Lock UI for mouse events to enable resizing over embedded iframes\r\n    * @param {MouseEvent} e \r\n    */\r\n    onStartMove(e) {\r\n        const me = this;\r\n        me.#cursor = me.isVertical ? e.clientX : e.clientY;\r\n        me.#lock(true);\r\n        GSEvents.send(globalThis, 'gs-split', { start: true });\r\n    }\r\n\r\n    /**\r\n     * Handles resizing based on mouse move event\r\n     * @param {MouseEvent} e \r\n     */\r\n    onMouseMove(e) {\r\n        const me = this;\r\n        const pos = me.isVertical ? e.clientX : e.clientY;\r\n        me.#updateMouse(pos);\r\n    }\r\n\r\n    /**\r\n     * Save last position and unlock mouse UI events when resizing finished\r\n     * @param {*} e \r\n     */\r\n    onEndMove(e) {\r\n        const me = this;\r\n        me.#save();\r\n        me.#lock(false);\r\n        GSEvents.send(globalThis, 'gs-split', { stop: true });\r\n    }\r\n\r\n    /**\r\n    * Check if splitter use vertical or hotizontal splitting\r\n    * @returns {Boolean}\r\n    */\r\n    get isVertical() {\r\n        return this.split === 'vertical';\r\n    }\r\n\r\n    get isHorizontal() {\r\n        return !this.isVertical;\r\n    }\r\n\r\n    /**\r\n     * Return preceding element\r\n     * @returns {HTMLElement}\r\n     */\r\n    get start() {\r\n        return this.previousElementSibling;\r\n    }\r\n\r\n    /**\r\n    * Return following element\r\n    * @returns {HTMLElement}\r\n    */\r\n    get end() {\r\n        return this.nextElementSibling;\r\n    }\r\n\r\n    /**\r\n     * Return closest element found\r\n     * @returns {HTMLElement}\r\n     */\r\n    get target() {\r\n        const me = this;\r\n        let el = me.#isPreceeding ? me.start : me.end;\r\n        el = el || me.parentElement;\r\n        el = GSDOM.isGSElement(el) ? el.self : el;\r\n        if (el instanceof ShadowRoot) {\r\n            // no firefox support\r\n            el = Array.from(el.children).filter(o => !GSDOM.isStyleValue(o, 'display', 'none')).pop();\r\n        }\r\n        el.classList?.add(me.#styleTGT);\r\n        return el;\r\n    }\r\n\r\n    get #isPreceeding() {\r\n        const me = this;\r\n        const resize = me.resize;\r\n        return resize === 'start' || resize === 'top';\r\n    }\r\n\r\n    get #splitter() {\r\n        return this.#elRef.value;\r\n    }\r\n\r\n    get #styleDynamic() {\r\n        return this.target.style;\r\n    }\r\n\r\n    /**\r\n     * Get elements which must be protected to allow mouse move over \r\n     */\r\n    get #lockable() {\r\n        const me = this;\r\n        const qry = 'iframe,embed,portal';\r\n        const p = GSDOM.queryAll(me.previousElementSibling, qry);\r\n        const n = GSDOM.queryAll(me.nextElementSibling, qry);\r\n        return [...p, ...n];\r\n    }\r\n\r\n    #load() {\r\n        const me = this;\r\n        if (!me.id) return;\r\n        const key = GSID.hashCode(location.origin + location.pathname);\r\n        let val = localStorage.getItem(`gs-splitter-${key}-${me.id}`);\r\n        val = GSUtil.asNum(val);\r\n        me.#update(val);\r\n    }\r\n\r\n    #save() {\r\n        const me = this;\r\n        if (!me.id) return;\r\n        const css = GSCSSMap.getComputedStyledMap(me.target);\r\n        const val = me.isVertical ? css.get('width') : css.get('height');\r\n        if (!val) return;\r\n        const key = GSID.hashCode(location.origin + location.pathname);\r\n        localStorage.setItem(`gs-splitter-${key}-${me.id}`, val);\r\n    }\r\n\r\n    #onDoubleClick(e) {\r\n\r\n        const me = this;\r\n        let csize = 0;\r\n        let key = '';\r\n\r\n        if (me.isVertical) {\r\n            key = 'width';\r\n            csize = me.target.clientWidth;\r\n        } else {\r\n            key = 'height';\r\n            csize = me.target.clientHeight;\r\n        }\r\n\r\n        let min = GSCSSMap.styleValue(me.target, `min-${key}`);\r\n        let max = GSCSSMap.styleValue(me.target, `max-${key}`);\r\n\r\n        min = GSUtil.asNum(min.value);\r\n        max = GSUtil.asNum(max.value);\r\n\r\n        if ((max - min) / 2 > csize) {\r\n            csize = max;\r\n        } else {\r\n            csize = min;\r\n        }\r\n        me.#update(csize);\r\n\r\n    }\r\n\r\n    /**\r\n     * Lock IFRAME,EMBED,PORTAL elements for mouse move events\r\n     * @param {*} lock \r\n     */\r\n    #lock(lock = true) {\r\n        const me = this;\r\n        const cls = 'pe-none';\r\n        if (lock) {\r\n            me.#lockable\r\n                .filter(el => !GSDOM.hasClass(el, 'pe-none'))\r\n                .forEach(el => {\r\n                    GSDOM.toggleClass(el, cls, true);\r\n                    el.dataset.gsSplitter = true;\r\n                });\r\n        } else {\r\n            me.#lockable\r\n                .filter(el => el.dataset.gsSplitter)\r\n                .forEach(el => {\r\n                    GSDOM.toggleClass(el, cls, false);\r\n                    delete el.dataset.gsSplitter;\r\n                });\r\n        }\r\n    }\r\n\r\n    #updateMouse(pos) {\r\n        const me = this;\r\n        requestAnimationFrame(() => {\r\n            if (me.isVertical) {\r\n                me.#updateX(pos);\r\n            } else {\r\n                me.#updateY(pos);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Calculate width based on mouse position\r\n     * @param {Number} pos \r\n     */\r\n    #updateX(pos) {\r\n        const me = this;\r\n        const target = me.target;\r\n        const dir = me.#isPreceeding ? 1 : -1;\r\n        let dx = (pos - me.#cursor) * dir;\r\n        dx = dx + target.clientWidth;\r\n        dx = dx < 0 ? 0 : dx;\r\n        me.#styleDynamic.width = dx + \"px\";\r\n        //me.dynamicStyle(me.#styleTGT, { width: dx + \"px\" }, true);\r\n        me.#cursor = pos;\r\n    }\r\n\r\n    /**\r\n     * Calculate height based on mouse position\r\n     * @param {Number} pos \r\n     */\r\n    #updateY(pos) {\r\n        const me = this;\r\n        const target = me.target;\r\n        const dir = me.#isPreceeding ? 1 : -1;\r\n        let dx = (pos - me.#cursor) * dir;\r\n        dx = dx + target.clientHeight;\r\n        dx = dx < 0 ? 0 : dx;\r\n        me.#styleDynamic.height = dx + \"px\";\r\n        //me.dynamicStyle(me.#styleTGT, { height: dx + \"px\" }, true);\r\n        me.#cursor = pos;\r\n    }\r\n\r\n    #update(val = 0) {\r\n        if (val <= 0) return\r\n        const me = this;\r\n        me.#cursor = val;\r\n        const key = me.isVertical ? 'width' : 'height';\r\n        me.#styleDynamic[key] = val + \"px\";\r\n        //me.dynamicStyle(me.#styleTGT, { [key]: val + \"px\" }, true);\r\n    }\r\n\r\n    #cssUpdate() {\r\n        const me = this;\r\n        const size = me.isVertical ? 'width' : 'height';\r\n        const full = me.isVertical ? 'height' : 'width';\r\n        const cursor = me.isVertical ? 'w-resize' : 'n-resize';\r\n        const opt = {\r\n            [size]: `${me.size}px`,\r\n            [full]: '100%',\r\n            'border-width': '1px',\r\n            cursor: cursor,\r\n            'border-color': 'darkgray',\r\n            'border-style': 'solid',\r\n            'background-color': 'lightgray',\r\n        };\r\n        me.dynamicStyle(me.#styleID, opt);\r\n    }\r\n\r\n    static {\r\n        this.define('gs-splitter');\r\n    }\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { KEY } from '../../base/GSConst.mjs';\r\nimport { GSUtil } from '../../base/GSUtil.mjs';\r\nimport { GSNavItemElement } from '../NavItem.mjs';\r\n\r\n/**\r\n * Tab component (gs-tab-header), generate selectable/switchable tabs on a panel\r\n */\r\nexport class GSTabItemElement extends GSNavItemElement {\r\n\r\n  static properties = {\r\n    name: {}\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.css = this.#updateCSS + this.css;\r\n  }\r\n\r\n  get #updateCSS() {\r\n    const me = this;\r\n    return me.shouldUpdate() ? GSUtil.normalize(me.parentComponent?.tabCSS) : '';\r\n  }\r\n\r\n  get parentType() {\r\n    return 'GS-TAB-GROUP';\r\n  }\r\n\r\n  get panel() {\r\n    const me = this;\r\n    return me[KEY] || me.owner.panelByName(me.name);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-tab-header');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../../lib.mjs';\r\nimport { KEY } from '../../base/GSConst.mjs';\r\nimport { GSDOM } from '../../base/GSDOM.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\n\r\n/**\r\n * Container for individual tab; part of tabed panel\r\n */\r\nexport class GSTabPanelElement extends GSElement {\r\n\r\n  static properties = {\r\n    name: {},\r\n    template: {},\r\n    active: { type: Boolean, reflect : true }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.active = false;\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    delete this[KEY];\r\n    super.disconnectedCallback();\r\n  }\r\n\r\n  shouldUpdate(changedProperties) {\r\n    return this.parentComponent?.tagName === this.parentType;\r\n  }\r\n\r\n  /*\r\n  @invalid=\"${me.#onInvalid}\"\r\n  @change=\"${me.#onChange}\"\r\n  */\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div  \r\n      dir=\"${ifDefined(me.direction)}\" \r\n      class=\"${classMap(this.renderClass())}\">\r\n      <slot>\r\n      ${me.renderTemplate()}\r\n      </slot></div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'tab-pane': true,\r\n      'd-none' : !me.active,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  get parentType() {\r\n    return 'GS-TAB-GROUP';\r\n  }\r\n\r\n  get owner() {\r\n    return this.closest(this.parentType.toLowerCase(), -1, true) || GSDOM.component(this);\r\n  }\r\n\r\n  get form() {\r\n    return this.closest('form', -1, true);\r\n  }\r\n\r\n  get tab() {\r\n    const me = this;\r\n    return me[KEY] || me.owner.tabByName(me.name);\r\n  }\r\n\r\n  get tabs() {\r\n    return this.owner.tabs;\r\n  }\r\n\r\n  clear() {\r\n    this.tab.badge = false;\r\n  }\r\n\r\n  /*\r\n  #onChange(e) {\r\n    const me = this;\r\n    if (me.form) {\r\n      const isValid = me.form.isValid;\r\n      me.tabs?.forEach(el => el.badge = !isValid);\r\n    }\r\n  }\r\n\r\n  #onInvalid(e) {\r\n    const me = this;\r\n    if (me.form) me.badge = false;\r\n  }\r\n  */\r\n\r\n  static {\r\n    this.define('gs-tab-panel');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { html, ifDefined } from '../../lib.mjs';\r\nimport { GSID } from '../../base/GSID.mjs';\r\nimport { KEY, GROUP } from '../../base/GSConst.mjs';\r\nimport { PlacementTypes } from '../../properties/placement.mjs';\r\nimport { GSNavElement } from '../Nav.mjs';\r\n\r\n/**\r\n * Panel with tabs component (gs-tab-group), generate childrens gs-tab-header and gs-tab-panel \r\n */\r\nexport class GSTabGroupElement extends GSNavElement {\r\n\r\n  static properties = {\r\n    panelCSS: { attribute: 'css-panel' },\r\n    tabCSS: { attribute: 'css-tab' },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this[GROUP] = 'GS-TAB-HEADER';\r\n  }\r\n   \r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    const me = this;\r\n    // link tabs and panels\r\n    me.items.forEach(el => me.#findPanel(el));\r\n    me.onSelected(me.active);\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    return this.data.length > 0 || this.items.length > 0;\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    const me = this;\r\n    if (changed.has('data')) {      \r\n      me.items.forEach(el => me.#findPanel(el));\r\n    }\r\n    super.willUpdate(changed);\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'd-flex': me.vertical\r\n    }\r\n    return css;\r\n  }\r\n\r\n  renderWrappedUI() {\r\n    const me = this;\r\n    const reverse = PlacementTypes.isAfter(me.placement);\r\n    const list = [super.renderWrappedUI('tabs'),\r\n    html`<div class=\"tab-content flex-fill ${me.panelCSS}\"  dir=\"${ifDefined(me.direction)}\">\r\n        <slot name=\"panels\"></slot>\r\n      </div>\r\n      <slot class=\"d-none\"></slot>`];\r\n    return reverse ? list.reverse() : list;\r\n  }\r\n\r\n  renderWrappedClass() {\r\n    const me = this;\r\n    const css = super.renderWrappedClass();\r\n    return me.mapCSS(me.tabCSS, css);\r\n  }\r\n\r\n  /**\r\n   * Render items based on data property (might be from gs-item)\r\n   * @returns \r\n   */\r\n  renderItems() {\r\n    const me = this;\r\n    const tabs =  me.#renderTabs();\r\n    const panels = me.#renderPanels();\r\n    return tabs.concat(...panels);\r\n  }\r\n\r\n  #renderTabs() {    \r\n    return this.data.map(o => {\r\n      if (!o.name) o.name = GSID.id;\r\n      return html`<gs-tab-header generated slot=\"tabs\"\r\n        .active=\"${ifDefined(o.active === true)}\"\r\n        .autofocus=\"${ifDefined(o.autofocus === true)}\"\r\n        .disabled=\"${ifDefined(o.disabled === true)}\" \r\n        icon=\"${ifDefined(o.icon)}\"\r\n        title=\"${ifDefined(o.title)}\"\r\n        name=\"${o.name}\"></gs-tab-header>`;\r\n    });    \r\n  }\r\n\r\n  /**\r\n   * Render items based on data property (might be from gs-item)\r\n   * @returns \r\n   */\r\n  #renderPanels() {\r\n    return this.data.map(o => {\r\n      if (!o.name) o.name = GSID.id;\r\n      return html`<gs-tab-panel generated  \r\n        slot=\"panels\" name=\"${o.name}\" \r\n        .active=\"${ifDefined(o.active)}\"\r\n        template=\"${ifDefined(o.template)}\"></gs-tab-panel>`;\r\n    });\r\n  }\r\n\r\n  #updatePanelState(el, state = false) {\r\n    const panel = this.#findPanel(el);\r\n    if (panel) panel.active = state;    \r\n  }\r\n\r\n\r\n  /**\r\n   * Callback when tab selected\r\n   * @param {GSTabElement} el \r\n   */\r\n  onSelected(el) {\r\n    this.#updatePanelState(el, true);\r\n  }\r\n\r\n  /**\r\n   * Callback when tab deselected\r\n   * @param {GSTabElement} el \r\n   */\r\n  onDeselected(el) {\r\n    this.#updatePanelState(el, false);\r\n  }\r\n\r\n  get tabs() {\r\n    return this.items;\r\n  }\r\n\r\n  get panels() {\r\n    return this.queryAll('gs-tab-panel', false, true);\r\n  }\r\n\r\n  reset() {\r\n    const me = this;\r\n    me.panels.forEach((el, idx) => el.active = idx === 0 ? true : false);\r\n    me.tabs.forEach((el, idx) => el.active = idx === 0 ? true : false);\r\n    super.reset();\r\n  }\r\n\r\n  clear() {\r\n    this.tabs.forEach(t => t.badge = false);\r\n  }\r\n\r\n  tabByName(name = '', shadow = false) {\r\n    return this.query(`gs-tab-header[name=\"${name}\"]`, shadow, true);\r\n  }\r\n\r\n  panelByName(name = '', shadow = false) {\r\n    return this.query(`gs-tab-panel[name=\"${name}\"]`, shadow, true);\r\n  }\r\n\r\n  /**\r\n   * Selected Tab node name is used to find the panel.\r\n   * If panel found, auto-link it with node element\r\n   * @param {GSTabElement} el \r\n   */\r\n  #findPanel(el) {\r\n    if (!el) return null;\r\n    const me = this;\r\n    const generated = me.data?.length > 0;\r\n     let panel = el[KEY] || me.panelByName(el.name, generated);\r\n    if (panel && !el[KEY]) {\r\n      el[KEY] = panel;\r\n      panel[KEY] = el;\r\n    }\r\n    return panel;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-tab-group');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, css, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color } from '../properties/color.mjs';\r\nimport { GSData } from '../base/GSData.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { DataSelector } from '../data/DataSelector.mjs';\r\n\r\n/**\r\n * A HTML Table renderer for tabular data representation.\r\n * Either use \"storage\" property to point to data handler\r\n * or use simpler form by using \"data\" property.\r\n * \r\n * NOTE: Simpler form currently does not suport data filter.\r\n * Simpler form is only for read-ony static data representation.\r\n */\r\nexport class GSTableElement extends GSElement {\r\n\r\n  static #icons = ['sort-up', 'arrow-down-up', 'sort-down-alt'];\r\n\r\n  static styles = css`th:hover { opacity: 50% !important; }`;\r\n\r\n  static CELLS = {\r\n    align: {},\r\n    width: {},\r\n    width: {},\r\n    css: {},\r\n    title: {},\r\n    colspan: {},\r\n    storage: {},\r\n    ref: {}, // if set; use storage or gs-items to map ref value to virtual field\r\n    list : { type: Boolean }, // if set, use storage record column as a filter\r\n    filter: { type: Boolean },\r\n    hidden: { type: Boolean },\r\n    fixed: { type: Boolean },\r\n    filterType: { attribute: 'filter-type' },\r\n    cssFilter: { attribute: 'css-filter' },\r\n    cssHeader: { attribute: 'css-header' },\r\n    color: { ...color},\r\n    ...GSData.PROPERTIES\r\n  }\r\n\r\n  static properties = {\r\n    storage: {},\r\n    color: { ...color },\r\n    colorFilter: { ...color, attribute: 'filter-color' },\r\n    colorHead: { ...color, attribute: 'head-color' },\r\n    colorSelect: { ...color, attribute: 'select-color' },\r\n    colorSort: { ...color, attribute: 'sort-color' },\r\n    stripedColumn: { type: Boolean, attribute: 'striped-column' },\r\n    cssFilter: { attribute: 'css-filter' },\r\n    cssHeader: { attribute: 'css-header' },\r\n    divider: { type: Boolean },\r\n    striped: { type: Boolean },\r\n    hover: { type: Boolean },\r\n    small: { type: Boolean },\r\n    grid: { type: Boolean },\r\n    borderless: { type: Boolean },\r\n\r\n    sort: { type: Array, state: true },\r\n    columns: { type: Array, state: true },\r\n    key: { type: Number, state: true },\r\n    data: { type: Array },\r\n    \r\n    datacolumn: { type: Boolean },\r\n    multisort: { type: Boolean },\r\n    multiselect: { type: Boolean },\r\n    protected: { type: Boolean },\r\n    selectable: { type: Boolean },\r\n    toggle: { type: Boolean },\r\n    sortable: { type: Boolean },\r\n  }\r\n\r\n  #config = [];\r\n  #sortOrder = [];\r\n  #auto = false;\r\n\r\n  constructor() {\r\n    super();\r\n    this.headColor = 'secondary';\r\n    this.colorSelect = 'info';\r\n    this.columns = [];    \r\n    this.data = [];\r\n    this.sort = [];\r\n    this.key = 0;\r\n  }\r\n\r\n  get selected() {\r\n    return this.dataController?.selected;\r\n  }\r\n\r\n  set search(val) {\r\n    const me = this;\r\n    if (me.storage && me.dataController) {\r\n      return me.dataController.search = val;\r\n    }\r\n  }\r\n\r\n  connectedCallback() {\r\n    const me = this;\r\n    me.#config = GSItem.proxify(me, GSTableElement.CELLS);\r\n    if (me.columns.length === 0) me.columns = me.#config.map(v => v.name);\r\n    /* TODO - auto storage prevents using plain table with \r\n       columns, data properties programmatically\r\n    if (!me.storage) {      \r\n      me.storage = me.#auto = GSID.next('table-');\r\n    }\r\n    */\r\n    super.connectedCallback();\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    super.disconnectedCallback();\r\n    this.dataController?.clearSelected(this.data);\r\n    this.data = [];\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'user-select-none': me.protected,\r\n      'table': true,\r\n      'table-sm': me.small,\r\n      'table-hover': me.hover,\r\n      'table-striped': me.striped,\r\n      'table-bordered': me.grid,\r\n      'table-borderless': me.borderless,\r\n      'table-striped-columns': me.stripedColumns,\r\n      [`table-${me.color}`]: me.color,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  firstUpdated() {\r\n    this.dataController?.read();\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    const me = this;\r\n    if (me.columns.length != me.sort.length) me.sort = Array(me.columns.length).fill(0);\r\n    if (me.datacolumn && me.data.length > 0) {\r\n      me.columns = me.data[0];\r\n      me.data = me.data.slice(1);\r\n    }\r\n    if (changed.has('multiselect') && !me.multiselect) me.dataController?.clearSelected();\r\n    if (changed.has('selectable') && !me.selectable) me.dataController?.clearSelected();\r\n    if (changed.has('sortable') || changed.has('multisort')) {\r\n      me.sort = Array(me.columns.length).fill(0);\r\n      me.#sortOrder = [];\r\n    }\r\n\r\n    super.willUpdate(changed);\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const headColor = me.colorHead ? `table-${me.colorHead}` : '';\r\n    return html`\r\n      <table  \r\n       dir=\"${ifDefined(me.direction)}\"\r\n       @keyup=\"${me.#onKeyUp}\"\r\n       @keydown=\"${me.#onKeyDown}\"\r\n       class=\"${classMap(me.renderClass())}\">\r\n        <thead class=\"${ifDefined(headColor)}\">\r\n          ${me.#renderFilters()}\r\n          <tr @click=${me.#onSort}>\r\n            ${me.columns.map((entry, index) => me.#renderColumn(entry, index))}\r\n          </tr>\r\n        </thead>\r\n        <tbody @click=${me.#onSelect} @contextmenu=${me.#onSelect} class=\"${me.divider ? 'table-group-divider' : ''}\" role=\"button\">\r\n          ${me.data.map((entry, index) => me.#renderRecord(entry, index))}\r\n          ${me.#renderEmpty()}\r\n        </tbody>\r\n      </table>\r\n      <slot name=\"extra\">${me.#renderHandler()}</slot>\r\n    `;\r\n  }\r\n\r\n  #renderHandler() {\r\n    const me = this;\r\n    return me.#auto ? html`<gs-data-handler type=\"cached\" mode=\"\" id=${me.#auto} generated></gs-data-handler>` : '';\r\n  }\r\n\r\n  onDataRead(data) {\r\n    const me = this;\r\n    me.data = data;\r\n    //me.dataController?.clearSelected();\r\n\r\n    // update filtering\r\n    if (data.length > 0 && me.#hasFilters) {\r\n      me.#config.forEach((entry, index) => {\r\n        entry.columnType = me.#columType(index);\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear table filters\r\n   */\r\n  clear() {\r\n    this.#input.forEach(el => el.value = '');\r\n    this.dataController?.filter([]);\r\n  }\r\n\r\n  valueAt(row, cell) {\r\n    return this.data.length > row ? this.data[row][cell] : undefined;\r\n  }\r\n\r\n  get #input() {\r\n    return this.queryAll('th > input, th > select', true, true);\r\n  }\r\n\r\n  get #hasFilters() {\r\n    return this.#config.filter(o => o.filter).length > 0;\r\n  }\r\n\r\n  #columType(index) {\r\n    const me = this;\r\n    const cfg = me.#config[index];\r\n    const cell = me.valueAt(0, me.columns[index]);\r\n    cfg.type = cfg.type || 'text';\r\n    const cfgType = { 'string': 'text', 'currency': 'number', 'timestamp': 'datetime-local' }[cfg.type]\r\n    const dataType = cell instanceof Date ? 'date' : typeof cell;\r\n    return cell ? dataType : cfgType || cfg.type;\r\n  }\r\n\r\n  #renderFilters() {\r\n    const me = this;\r\n    return me.#hasFilters ? html`<tr>${me.columns.map((entry, index) => me.#renderFilter(entry, index))}</tr>` : '';\r\n  }\r\n\r\n  #renderFilter(cell, index) {\r\n    const me = this;\r\n    const cfg = me.#config[index];\r\n    if (!cfg?.filter) return html`<th></th>`;\r\n\r\n    let mask = undefined;\r\n    const hasSub = cfg.childElementCount > 0;\r\n    const isDate = cfg.columnType === 'date';\r\n    if (isDate) mask = cfg.format || GSUtil.getDateFormat(cfg.language || GSUtil.language);\r\n    const css = `${GSUtil.normalize(me.cssFilter)} ${GSUtil.normalize(cell.cssFilter)}`; \r\n    const color = `text-bg-${GSUtil.normalize(cell.color || me.colorFilter)}`; \r\n    \r\n\r\n    if ((hasSub || cfg.list) && cfg.fixed) {\r\n      return html`<th .index=${index} @change=\"${me.#onFilter}\">\r\n          <select is=\"gs-ext-select\" .index=${index}\r\n              class=\"form-select ${css} ${color}\" \r\n              name=\"${cell}\"\r\n              storage=\"${ifDefined(cfg.list ? me.storage : null)}\"\r\n              key=\"${ifDefined(cfg.list ? cfg.name : null)}\"> \r\n              ${me.#renderOption(cfg)}\r\n              </select>\r\n          </th>`;\r\n    }\r\n\r\n    let listid = '';\r\n    let list = undefined;\r\n    if (hasSub || cfg.list) {\r\n      listid = `${me.id}-list-${index}`;\r\n      list = html`<datalist id=\"${listid}\" is=\"gs-ext-datalist\"\r\n              storage=\"${ifDefined(cfg.list ? me.storage : null)}\"\r\n              key=\"${ifDefined(cfg.list ? cfg.name : null)}\"> \r\n              ${me.#renderOption(cfg)}</datalist>`;\r\n    } \r\n\r\n    return html`<th .index=${index} @change=\"${me.#onFilter}\">\r\n    <input is=\"gs-ext-input\" .index=${index}\r\n      class=\"form-control ${css} ${color}\" \r\n      mask=\"${ifDefined(mask)}\"\r\n      list=\"${ifDefined(listid)}\"\r\n      name=\"${cell}\" \r\n      placeholder=\"${ifDefined(cfg.title)}\" \r\n      type=\"${cfg.filterType || cfg.columnType}\"\r\n      data-slots=\"${ifDefined(isDate ? 'DMY' : undefined)}\"/>\r\n    ${list}\r\n    </th>`;\r\n  }\r\n\r\n  #renderOption(cfg) {\r\n    if (cfg.childElementCount == 0) return '';\r\n    const sub = GSItem.proxify(cfg);\r\n    return sub.map(el => html`<option value=\"${el.value}\">${cfg.fixed ? el.map : ''}</option>`);\r\n  }\r\n\r\n  #renderColumn(cell, index) {\r\n    const me = this;\r\n    const cfg = me.#config[index];\r\n    if (cfg?.hidden) return '';\r\n    const css = `${GSUtil.normalize(me.cssHeader)} ${GSUtil.normalize(cell.cssHeader)}`; \r\n    return html`\r\n      <th .index=${index} class=\"${css}\" \r\n        colspan=\"${ifDefined(cfg?.colspan)}\"\r\n        width=\"${ifDefined(cfg?.width)}\">\r\n        <div class=\"d-flex justify-content-between\"> \r\n          <span>${cfg?.title || cell}</span>\r\n          ${me.#renderIcon(index)}\r\n        </div>\r\n      </th>\r\n    `\r\n  }\r\n\r\n  #renderIcon(index) {\r\n    const me = this;\r\n    if (!me.sortable) return '';\r\n    const icons = GSTableElement.#icons;\r\n    const sortType = me.sort[index];\r\n    const order = me.multisort ? me.#sortOrder.indexOf(index) + 1 : '';\r\n    return html`<gs-icon name=\"${icons[sortType + 1]}\" super=\"${order > 0 ? order : ''}\" color=\"${ifDefined(me.colorSort)}\"></gs-icon>`;\r\n  }\r\n\r\n  #renderRecord(entry, index) {\r\n    const me = this;\r\n    const controller = me.dataController || DataSelector;\r\n    const selected = controller?.isSelected(entry);\r\n    const color = me.colorSelect && selected ? `table-${me.colorSelect}` : '';\r\n    const cells = me.#remapRecord(entry);\r\n    return html`\r\n        <tr .index=${index} class=\"${color}\" tabindex=\"0\" ?selected=${selected}>\r\n          ${cells.map((cell, i) => me.#renderCell(cell, i))}\r\n        </tr>\r\n      `;\r\n  }\r\n\r\n  #renderCell(cell, index) {\r\n    const cfg = this.#config[index];\r\n    if (cfg?.hidden) return '';\r\n    return html`<td class=\"text-${cfg?.align}\" colspan=\"${ifDefined(cfg?.colspan)}\" ><span>${cell}</span></td>`;\r\n  }\r\n\r\n  #remapRecord(record) {\r\n    const me = this;\r\n    if (!Array.isArray(record)) record = me.columns.map(v => record[v]);\r\n    return record.map((val, i) => me.#config[i] ? GSData.format(me.#config[i], val) : val);\r\n  }\r\n\r\n  #renderEmpty() {\r\n    const me = this;\r\n    return me.data.length > 0 ?  '' :\r\n    html`<tr data-ignore=\"true\"><td colspan=\"${me.columns.length}\" class=\"text-center fw-bold text-muted\">${me.translate('No Data')}</td></tr>`;\r\n  }\r\n\r\n  #elementTofilter(el) {\r\n    if (!el.value) return undefined;\r\n    const isDate = el.type === 'date';\r\n    const val = isDate ? el.valueAsDate : el.value;\r\n    const cfg = this.#config[el.index];\r\n    return { name: el.name, value: val, language : cfg?.language };\r\n  }\r\n\r\n  #onFilter(e) {\r\n    \r\n    const me = this;\r\n    \r\n    const filter = me.#input\r\n      .map(el => me.#elementTofilter(el))\r\n      .filter(el => el?.value);\r\n\r\n    if (me.storage) {\r\n      me.dataController?.filter(filter);\r\n    } else {\r\n      // TODO keep full data, use sorted\r\n      // GSData.filter(me.data, filter);\r\n    }\r\n  }  \r\n\r\n  #onSort(e) {\r\n    \r\n    const me = this;\r\n    \r\n    if (!me.sortable) return;\r\n    \r\n    const icon = e.target.tagName === 'GS-ICON' ? e.target : e.target.closest('gs-icon');\r\n    const column = e.target.closest('th');\r\n    if (!icon || !column) return;\r\n\r\n    const idx = column.index !== undefined ? column.index : GSDOM.getElementIndex(column);\r\n    const current = me.sort[idx];\r\n    const sortType = current === 1 ? -1 : current + 1;\r\n\r\n    if (me.multisort) {\r\n      if (sortType == 0) {\r\n        me.#sortOrder = me.#sortOrder.filter(v => v != idx);\r\n      } else if (!me.#sortOrder.includes(idx)) {\r\n        me.#sortOrder.push(idx);\r\n      }\r\n    } else {\r\n      me.sort = Array(me.columns.length).fill(0);\r\n      me.#sortOrder = [idx];\r\n    }\r\n\r\n    me.sort[idx] = sortType;\r\n\r\n    const sort = me.#prepareSorter(me.sort, me.#sortOrder);\r\n\r\n    if (me.storage) {\r\n      me.dataController?.sort(sort);\r\n    } else {\r\n      me.data = GSData.sortData(me.data, sort);\r\n    }\r\n\r\n    me.emit('sort');\r\n  }\r\n\r\n  #prepareSorter(sort, sortOrder) {\r\n    \r\n    const me = this;\r\n\r\n    if (sort.filter(v => v).length === 0) {\r\n      sort = Array(me.columns.length).fill(0);\r\n      sort[me.key] = 1;\r\n    }\r\n\r\n    // if data record is object (not simple array)\r\n    const isComplex = me.data[0] && !Array.isArray(me.data[0]);\r\n\r\n    // sort list \r\n    const list = sort.map((v, i) => v ? { name: isComplex ? me.columns[i] : undefined, col: i, ord: v, idx: sortOrder.indexOf(i) } : null).filter(v => v);\r\n\r\n    // order sort list by idx\r\n    sort = GSData.sortData(list, [{ name: 'idx', ord: 1 }]);\r\n\r\n    return sort;\r\n  }\r\n\r\n  #onSelect(e) {\r\n    \r\n    const me = this;\r\n    \r\n    if (!me.selectable) return;\r\n    \r\n    const tr = e.target.tagName === 'TR' ? e.target : e.target.closest('tr');\r\n    if (!tr) return;\r\n    \r\n    // if context menu is attached and right click made\r\n    if (e.button === 2 && !me.query('gs-context', false, true)) return;\r\n    \r\n    const controller = me.dataController || DataSelector;\r\n    if (!controller) return;\r\n\r\n    const record = me.data[tr.index];\r\n    const isSelected = controller.isSelected(record);\r\n    if (me.multiselect) {\r\n      if (isSelected) {\r\n        controller.removeSelected(record);\r\n      } else {\r\n        controller.addSelected(record);\r\n      }\r\n    } else if (me.toggle) {\r\n      controller.clearSelected(me.data);\r\n      if (!isSelected) {\r\n        controller.addSelected(record);\r\n      }\r\n    } else {\r\n      controller.clearSelected(me.data);\r\n      controller.addSelected(record);\r\n    }\r\n    me.requestUpdate();\r\n    me.emit('select');\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n\r\n    if (!e.target.matches('tbody tr')) return;\r\n    let el = null;\r\n\r\n    switch (e.code) {\r\n      case 'ArrowUp':\r\n        el = e.target.previousElementSibling;\r\n        break;\r\n      case 'ArrowDown':\r\n        el = e.target.nextElementSibling;\r\n        break;\r\n    }\r\n\r\n    if (el) {\r\n      el.focus();\r\n      this.emit('focus', el);\r\n    }\r\n  }\r\n\r\n  #onKeyUp(e) {\r\n    if (e.code === 'Space') this.#onSelect(e);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-table');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSTag class\r\n * @module components/GSTag\r\n */\r\n\r\nimport { createRef, ref, classMap, css, html, ifDefined } from '../lib.mjs';\r\nimport { stringArrayConverter, color } from '../properties/index.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\n\r\n/**\r\n * Tag list element\r\n * \r\n * @class\r\n * @extends {GSTagElement}\r\n */\r\nexport default class GSTagElement extends GSElement {\r\n\r\n    static #KEYS = ['Enter', 'NumpadEnter', 'Comma', 'Space'];\r\n\r\n    static styles = css`\r\n        .tag-input:focus-visible {\r\n            outline:none;\r\n        }\r\n        .tag .btn-close {\r\n            background: none;\r\n        }            \r\n        .tag .btn-close::after {\r\n            content: 'x';\r\n        }`;\r\n\r\n    static properties = {\r\n        placeholder: {},\r\n        max: { type: Number },\r\n        size: { type: Number },\r\n        name: {},\r\n        data: { type: Array },\r\n        values: { type: Array, reflect: true, converter: stringArrayConverter },\r\n        appendable: { type: Boolean },\r\n        color: { ...color },\r\n        closeColor: { ...color, attribute: 'close-color' },\r\n        cssClose: { attribute: 'css-close' },\r\n        cssTag: { attribute: 'css-tag' },\r\n    }\r\n\r\n    // GS-ITEM attributes mapping\r\n    static options = {\r\n        name: {}\r\n    }\r\n\r\n    #dataListRef = createRef();\r\n    #inputRef = createRef();\r\n\r\n    constructor() {\r\n        super();\r\n        this.name = '';\r\n        this.data = this.#items;\r\n        this.closeColor = 'light';\r\n        this.color = 'primary';\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        const tags = me.#renderTags();\r\n        return html`\r\n        <div  dir=\"${ifDefined(me.direction)}\" \r\n            class=\"${classMap(me.renderClass())}\"\r\n            @click=\"${me.#onClick.bind(me)}\">\r\n            ${tags}\r\n            <input type=\"text\" \r\n            @keydown=\"${me.#onKeyDown.bind(me)}\"\r\n            @input=\"${me.#onInput.bind(me)}\"\r\n            ${ref(me.#inputRef)}\r\n            name=\"${me.name}\" \r\n            list=\"${me.name}_list\"\r\n            class=\"form-control d-flex w-auto flex-grow-1\" \r\n            placeholder=\"${me.#info}\">\r\n            <datalist ${ref(me.#dataListRef)} id=\"${me.name}_list\">${me.#renderList()}</datalist>\r\n        </div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            \"d-flex\": true,\r\n            \"flex-wrap\": true,\r\n            \"align-items-center\": true,\r\n            \"gap-1 \": true,\r\n        }\r\n        return css;\r\n    }\r\n\r\n    get #info() {\r\n        const me = this;\r\n        const alt = me.max > 0 ? `Add max ${me.max} tags...` : '';\r\n        return me.placeholder ? me.placeholder : alt;\r\n    }\r\n\r\n    #onInput(e) {\r\n        if (!e.inputType) this.#updateTag(e);\r\n    }\r\n\r\n    #onKeyDown(e) {\r\n        if (GSTagElement.#KEYS.includes(e.code)) this.#updateTag(e);\r\n    }\r\n\r\n    #onClick(e) {\r\n        const isClose = e.srcElement === e.target && e.target instanceof HTMLButtonElement;\r\n        if (isClose) this.#removeTag(e.target.parentElement);\r\n    }\r\n\r\n    #updateTag(e) {\r\n        GSEvents.prevent(e);\r\n        const me = this;\r\n        me.#addTag(me.#selected);\r\n    }\r\n\r\n    get #isMax() {\r\n        const me = this;\r\n        return me.max > 0 && me.data.length >= me.max;\r\n    }\r\n\r\n    get #options() {\r\n        return Array.from(this.#datalist.children);\r\n    }\r\n\r\n    get #selected() {\r\n        const me = this;\r\n        return me.#options.filter(el => el.value.toLowerCase() === me.#input.value.toLowerCase()).pop();\r\n    }\r\n\r\n    #addTag(optEl) {\r\n        const me = this;\r\n        const fld = me.#input;\r\n        if (me.#isMax || (!optEl && me.appendable == false)) {\r\n            fld.value = '';\r\n            return;\r\n        }\r\n        if (!me.values.includes(fld.value)) {\r\n            me.values.push(fld.value);\r\n            fld.value = '';\r\n            me.requestUpdate();\r\n        }\r\n    }\r\n\r\n    #removeTag(tagEl) {\r\n        if (!tagEl) return;\r\n        const me = this;\r\n        const value = tagEl.dataset.value;\r\n        me.values = me.values.filter(v => v != value);\r\n    }\r\n\r\n    #renderTags() {\r\n        const me = this;\r\n        return me.values.map(v => me.#renderTag(v));\r\n    }\r\n\r\n    #renderTag(val = '') {\r\n        if (!val) return '';\r\n        const me = this;\r\n        const size = me.size > 0 ? `fs-${me.size}` : '';\r\n        return html`<div class=\"${classMap(me.#tagClass)}\" data-value=\"${val}\">${val}<button type=\"button\" class=\"${classMap(me.#btnClass)}\"></button></div>`;\r\n    }\r\n\r\n    get #tagClass() {\r\n        const me = this;\r\n        const opt = {\r\n            badge: true,\r\n            tag: true,\r\n            [`fs-${me.size}`]: me.size > 0,\r\n            [`text-bg-${me.color}`]: me.color ? true : false\r\n        }\r\n        return me.mapCSS(me.cssTag, opt);\r\n    }\r\n\r\n    get #btnClass() {\r\n        const me = this;\r\n        const opt = {\r\n            'btn-close': true,\r\n            'ms-1': true,\r\n            [`text-bg-${me.closeColor}`]: me.closeColor ? true : false\r\n        }\r\n        return me.mapCSS(me.cssClose, opt);\r\n    }\r\n\r\n    #renderList() {\r\n        const me = this;\r\n        return me.data.map(v => html`<option value=\"${v}\">`);\r\n    }\r\n\r\n    /**\r\n     * Proxify GS-ITEM elements to easily read attributes\r\n     */\r\n    #proxify(root) {\r\n        return GSItem.collect(root).map(el => GSAttr.proxify(el));\r\n    }\r\n\r\n    get #items() {\r\n        return this.#proxify(this).map(el => el.name).filter(v => v ? true : false);\r\n    }\r\n\r\n    get #input() {\r\n        return this.#inputRef.value;\r\n    }\r\n\r\n    get #datalist() {\r\n        return this.#dataListRef.value;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-tag');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSTextElement extends GSElement {\r\n\r\n  #text = \"\";\r\n\r\n  constructor() {\r\n    super();\r\n    this.flat = true;\r\n    this.#text = this.innerText;\r\n    this.innerText = \"\";\r\n  }\r\n\r\n  renderUI() {\r\n    return this.translate(this.#text);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-text');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, ref, classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { placement } from '../properties/index.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSPopper } from '../base/GSPopper.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\n\r\nexport class GSTooltipElement extends GSElement {\r\n\r\n  static properties = {\r\n    placement: { ...placement },\r\n    title: {},\r\n    target: {},\r\n    opened: { type: Boolean },\r\n    local: { type: Boolean },\r\n  }\r\n\r\n  #arrowRef = createRef();\r\n  #panelRef = createRef();\r\n  #styleID = GSID.id;\r\n  #arrowStyle = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    this.placement = 'top';\r\n    this.dynamicStyle(this.#styleID);\r\n    this.dynamicStyle(this.#arrowStyle);\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.connectedCallback();\r\n    const me = this;\r\n    me.#attachEvents();\r\n    me.#reposition();\r\n    super.firstUpdated(changed);\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    this.#reposition();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`\r\n    <div ${ref(me.#panelRef)} \r\n      dir=\"${ifDefined(me.direction)}\"\r\n      role=\"tooltip\"\r\n      data-popper-placement=\"${me.placement}\"\r\n      data-gs-class=\"${me.#styleID}\"\r\n      class=\"${classMap(me.renderClass())}\">\r\n      <div ${ref(me.#arrowRef)} \r\n          class=\"tooltip-arrow ${me.#arrowStyle}\" \r\n          data-gs-class=\"${me.#arrowStyle}\">\r\n      </div>\r\n      <div class=\"tooltip-inner\">${me.translate(me.title)}</div>\r\n    </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'tooltip': true,\r\n      'bs-tooltip-auto': true,\r\n      'fade': true,\r\n      'show': me.opened,\r\n      [me.#styleID]: true\r\n    }\r\n    return css;\r\n  }\r\n\r\n  open() {\r\n    this.opened = true;\r\n  }\r\n\r\n  close() {\r\n    this.opened = false;\r\n  }\r\n\r\n  toggle() {\r\n    this.opened = !this.opened;\r\n  }\r\n\r\n  #attachEvents() {\r\n    const me = this;\r\n    me.attachEvent(me.#ref, 'mouseenter', me.open.bind(me));\r\n    me.attachEvent(me.#ref, 'mouseleave', me.close.bind(me));\r\n  }\r\n\r\n  #reposition() {\r\n    const me = this;\r\n    const arrowEl = me.#arrow;\r\n    const panelEl = me.#panel;\r\n    if (!panelEl) return;\r\n    if (me.opened) {\r\n      GSPopper.popupFixed(me.placement, panelEl, me.#ref, arrowEl);\r\n    } else {\r\n      me.dynamicStyle(me.#styleID, { top: '-1000px', left: '-1000px' });\r\n    }\r\n  }\r\n\r\n  get #ref() {\r\n    const me = this;\r\n    switch (me.target) {\r\n      case '@parent':\r\n        return this.parentElement;\r\n      case '@previous':\r\n        return this.previousElementSibling;\r\n      case '@next':\r\n        return this.nextElementSibling;\r\n      default:\r\n        return me.local ? me.#refLocal : me.#refGlobal;\r\n    }\r\n  }\r\n\r\n  get #refLocal() {\r\n    const root = GSDOM.root(this);\r\n    return GSDOM.query(root, this.target);\r\n  }\r\n  \r\n  get #refGlobal() {\r\n    return GSDOM.query(document.body, this.target);\r\n  }\r\n\r\n  get #arrow() { return this.#arrowRef.value; }\r\n  get #panel() { return this.#panelRef.value; }\r\n\r\n  static {\r\n    this.define('gs-tooltip');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { notEmpty } from '../properties/index.mjs';\r\n\r\nexport class GSTemplateElement extends GSElement {\r\n\r\n  static properties = {\r\n    src: { reflect: true, hasChanged: notEmpty }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  createRenderRoot() {\r\n    const me = this;\r\n    if (me.flat) {\r\n      me.renderOptions.renderBefore = me;\r\n      return me.parentElement;\r\n    }\r\n    return super.createRenderRoot();\r\n  }\r\n\r\n  renderUI() {\r\n    return html`${this.renderTemplate()}`;\r\n  }\r\n\r\n\ttemplateInjected() {\r\n\t\tthis.emit('template-injected', null, true, true);\r\n\t}\r\n\r\n  static {\r\n    this.define('gs-template');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../../../base/GSUtil.mjs\";\r\n\r\n/**\r\n * Handle automatic field value copy and select\r\n */\r\nexport class CopySelectController {\r\n\r\n  #host;\r\n\r\n  #clickCallback;\r\n  #copyCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#clickCallback = me.onClick.bind(me);\r\n    me.#copyCallback = me.onCopy.bind(me);\r\n    host.addController?.(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.#host.on?.('click', me.#clickCallback);\r\n    me.#host.on?.('copy', me.#copyCallback);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController?.(me);\r\n    me.#host.off?.('click', me.#clickCallback);\r\n    me.#host.off?.('copy', me.#copyCallback);\r\n  }\r\n\r\n  onCopy(e) {\r\n    GSUtil.writeToClipboard(this.#host.value);\r\n  }\r\n\r\n  onClick(e) {\r\n      const me = this;\r\n      if (me.#host.isAutocopy) me.onCopy(e);\r\n      if (me.#host.isAutoselect) me.#host.select();\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../../../base/GSUtil.mjs\";\r\n\r\n\r\n/**\r\n * Handle field mask \r\n */\r\nexport class MaskController {\r\n\r\n  static #special = '.^$*+?()[]{}\\|';\r\n\r\n  static #maskType = {\r\n    x: /[0-9a-fA-F]/g,\r\n    n: /[0-9]/g,\r\n    y: /[0-9]/g,\r\n    m: /[0-9]/g,\r\n    d: /[0-9]/g,\r\n    h: /[0-9]/g,\r\n    s: /[0-9]/g,\r\n    '.': /[0-9]/g,\r\n    '#': /[a-zA-Z]/g,\r\n    '*': /[0-9a-zA-Z]/g,\r\n    '_': /./g\r\n  };\r\n\r\n  #back = false;\r\n  #slots;\r\n  #prev;\r\n  #first;\r\n  #accept;\r\n  #pattern;\r\n\r\n  #host;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.initRules();\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n  }\r\n\r\n  initRules() {\r\n    const me = this;\r\n    if (!me.pattern) return;\r\n    me.#slots = me.#buildSlots();\r\n    me.#prev = (j => Array.from(me.pattern, (c, i) => me.#slots.has(c) ? j = i + 1 : j))(0);\r\n    me.#first = [...me.pattern].findIndex(c => me.#slots.has(c));\r\n    me.#accept = me.#buildAccept();\r\n    me.#toPattern();\r\n  }\r\n\r\n  validate() {  \r\n    const me = this;  \r\n    const isMatch = me.isEmpty ? true :me.isMatch;\r\n    me.setCustomValidity(isMatch ? '' : 'Mask not matched!');\r\n    return isMatch;\r\n  }\r\n\r\n  setCustomValidity(val) {\r\n    return this.#host.setCustomValidity(val);\r\n  }\r\n    \r\n  setSelectionRange(i, j) {\r\n    this.#host.setSelectionRange(i, j);\r\n  }\r\n\r\n  select() {\r\n    this.#host.select();\r\n  }\r\n\r\n  get isEmpty() {\r\n    return GSUtil.isStringEmpty(this.raw);\r\n  }\r\n\r\n  get isValid() {\r\n    return this.#host.validity.valid;\r\n  }\r\n\r\n  get disabled() {\r\n    return this.#host.disabled;\r\n  }\r\n\r\n  get required() {\r\n    return this.#host.required;\r\n  }    \r\n\r\n  get value() {\r\n    const [i, j] = this.#range();\r\n    return this.raw.substring(0, j);\r\n  }\r\n\r\n  set value(val) {\r\n    this.#host.value = val;\r\n  }\r\n\r\n  get raw() {\r\n    return this.#host.raw;\r\n  }\r\n\r\n  get required() {\r\n    return this.#host.required;\r\n  }\r\n\r\n  get pattern() {\r\n    return this.#host.mask;\r\n  }\r\n\r\n  get dataset() {\r\n    return this.#host.dataset;\r\n  }\r\n\r\n  get selectionStart() {\r\n    return this.#host.selectionStart;\r\n  }\r\n\r\n  get selectionEnd() {\r\n    return this.#host.selectionEnd;\r\n  }\r\n\r\n  get autoselect() {\r\n    return this.#host.autoselect;\r\n  }\r\n\r\n  get isMatch() {\r\n    const me = this;\r\n\r\n    let isMatch = true;\r\n    if (me.#pattern) {\r\n      me.#pattern.lastIndex = 0;\r\n      isMatch = me.#pattern.test(me.raw);\r\n    }\r\n\r\n    return isMatch;\r\n  }\r\n\r\n  onInput(e) {\r\n    this.#format();\r\n  }\r\n\r\n  onKeyDown(e) {\r\n    const me = this;\r\n    me.#back = e.key === \"Backspace\";\r\n    const isTab = e.key === \"Tab\";\r\n    if (isTab) {\r\n      me.#format();\r\n      me.validate();\r\n    }\r\n  }\r\n\r\n  onFocus(e) {\r\n    const me = this;\r\n    me.#format();\r\n    if (me.autoselect) me.select();\r\n  }\r\n\r\n  onChange(e) {\r\n    const me = this;\r\n    me.#format();\r\n  }\r\n\r\n  onBlur(e) {\r\n    this.validate();\r\n  }\r\n\r\n  /**\r\n   * If data-slots not defined, try to detect automatically\r\n   * @returns \r\n   */\r\n  #buildSlots() {\r\n    const me = this;\r\n    let slots = me.dataset.slots;\r\n    if (!slots) {\r\n      const maskType = MaskController.#maskType;\r\n      slots = [...new Set(me.pattern)]\r\n        .filter(v => maskType[v.toLowerCase()])\r\n        .join('');\r\n    }\r\n    return new Set(slots || \"_\");\r\n  }\r\n\r\n  /**\r\n   * If data-accept not defined, try to detect automatically\r\n   * @returns \r\n   */\r\n  #buildAccept() {\r\n    const me = this;\r\n    let accept = me.dataset.accept;\r\n    if (!accept) {\r\n      const maskType = MaskController.#maskType;\r\n      accept = [...new Set(me.pattern)]\r\n        .map(v => maskType[v.toLowerCase()])\r\n        .filter(v => v);\r\n      if (accept.length > 0) {\r\n        const tmp = {};\r\n        accept.forEach(v => tmp[v.src] = v);\r\n        accept = Object.values(tmp);\r\n        return accept.length === 1 ? accept.pop() : accept;\r\n      }\r\n\r\n    }\r\n    return new RegExp(accept || \"\\\\d\", \"g\");\r\n  }\r\n\r\n  #range() {\r\n    const me = this;\r\n    const value = me.raw;\r\n    return [me.selectionStart, me.selectionEnd].map(i => {\r\n      i = me.#clean(value.slice(0, i)).findIndex(c => me.#slots.has(c));\r\n      return i < 0 ? me.#prev[me.#prev.length - 1] : me.#back ? me.#prev[i - 1] || me.#first : i;\r\n    });\r\n  }\r\n\r\n  #format() {\r\n    const me = this;\r\n    const [i, j] = me.#range();\r\n    const val = me.#clean(me.#host.raw);\r\n    me.value = val.join``;\r\n    me.setSelectionRange(i, j);\r\n    me.#back = false;\r\n  }\r\n\r\n  #clean(input) {\r\n    const me = this;\r\n    input = input.match(me.#accept) || [];\r\n    return Array.from(me.pattern, (c, i) => input[i] === c || me.#slots.has(c) ? input.shift() || c : c);\r\n  }\r\n\r\n  #toPattern() {\r\n\r\n    const me = this;\r\n\r\n    if (me.pattern.length === 0) return;\r\n\r\n    const chars = me.pattern.split('');\r\n    const masks = ['^'];\r\n\r\n    const maskType = MaskController.#maskType;\r\n    const special = MaskController.#special;\r\n\r\n    let cnt = 0;\r\n    chars.forEach((v, i) => {\r\n      const m = me.#slots.has(v) ? maskType[v.toLowerCase()] : null;\r\n      if (!m) {\r\n        if (cnt > 0) masks.push(`{${++cnt}}`);\r\n        cnt = 0;\r\n        if (special.includes(v)) masks.push('\\\\');\r\n        return masks.push(v);\r\n      }\r\n\r\n      chars[i] = new RegExp(m, 'g');\r\n\r\n      if (masks.length === 0) return masks.push(m.source);\r\n\r\n      if (masks[masks.length - 1] === m.source) return cnt++;\r\n\r\n      if (cnt > 0) masks.push(`{${++cnt}}`);\r\n      cnt = 0;\r\n      masks.push(m.source);\r\n    });\r\n\r\n    if (cnt > 0) masks.push(`{${++cnt}}`);\r\n    masks.push('$');\r\n\r\n    me.#pattern = new RegExp(masks.join(''), 'g');\r\n    // me.#max = me.pattern.length;\r\n    // me.#masks = chars;\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../../../base/GSUtil.mjs\";\r\n\r\n/**\r\n * Handle multiple patterns\r\n */\r\nexport class MultipatternController {\r\n\r\n  #host;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n  }\r\n  \r\n  validate() {    \r\n    const me = this;  \r\n    const isMatch = me.isEmpty ? true :me.isMatch;\r\n    me.setCustomValidity(isMatch ? '' : 'Pattern not matched!');\r\n    return isMatch;\r\n  }\r\n\r\n  setCustomValidity(val) {\r\n    return this.#host.setCustomValidity(val);\r\n  }\r\n\r\n  get isEmpty() {\r\n    return GSUtil.isStringEmpty(this.raw);\r\n  }\r\n    \r\n  get isValid() {\r\n    return this.#host.validity.valid;\r\n  }\r\n\r\n  get value() {\r\n    return this.#host.value;\r\n  }\r\n\r\n  set value(val) {\r\n    this.#host.value = val;\r\n  }\r\n\r\n  get raw() {\r\n    return this.#host.raw;\r\n  }\r\n\r\n  get required() {\r\n    return this.#host.required;\r\n  }\r\n\r\n  get disabled() {\r\n    return this.#host.disabled;\r\n  }    \r\n\r\n  get dataset() {\r\n    return this.#host.dataset;\r\n  }\r\n\r\n  get patterns() {\r\n    const obj = this.#host.multipattern;\r\n    if (obj instanceof RegExp) return [obj];\r\n    if (Array.isArray(obj)) return obj.filter(o => o instanceof RegExp);\r\n    throw new Error('Invalid multipattern value. Expected RegExp object or array.');\r\n  }\r\n\r\n  get isMatch() {\r\n    const me = this;\r\n    let isMatch = true;\r\n    for (const r of me.patterns) {\r\n      isMatch = r.test(me.value);\r\n      if (isMatch) break;\r\n    }\r\n   \r\n    return isMatch;\r\n  }\r\n\r\n  onKeyDown(e) {\r\n    const isTab = e.key === 'Tab';\r\n    if (isTab) {\r\n      this.validate();\r\n    } \r\n  }\r\n\r\n  onBlur(e) {\r\n    this.validate();\r\n  }\r\n\r\n  onChange(e) {\r\n    this.validate();\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../../../base/GSUtil.mjs\";\r\n\r\n/**\r\n * Handle for input type number to support max length entry\r\n */\r\nexport class NumberController {\r\n\r\n  #host;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n  }\r\n\r\n  get maxLength() {\r\n    return GSUtil.asNum(this.#host.maxLength, 0);\r\n  }\r\n\r\n  get value() {\r\n    return this.#host.value;\r\n  }\r\n\r\n  set value(val) {\r\n    this.#host.value = val;\r\n  }\r\n\r\n  get type() {\r\n    return this.#host?.type;\r\n  }\r\n    \r\n  onInput(e) {\r\n    const me = this;\r\n    if (me.type === 'number') {\r\n      if (me.maxLength > 0 && me.value.length > me.maxLength) {\r\n          me.value = me.value.substring(0, me.maxLength);\r\n      }\r\n    }\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Handle for input tpye password to support keyboard shortcut for password reveal.\r\n */\r\nexport class PasswordController {\r\n\r\n  #host;\r\n\r\n  #revealing = false;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n  }\r\n\r\n  get reveal() {\r\n    return this.#host.reveal;\r\n  }\r\n\r\n  get type() {\r\n    return this.#host?.type;\r\n  }\r\n\r\n  set type(val) {\r\n    if (this.#host) this.#host.type = val;\r\n  }\r\n\r\n  #isReveal(e) {\r\n    return this.reveal && e.key === 'Shift' && e.altKey && e.ctrlKey && e.shiftKey && this.type === 'password';\r\n  }\r\n\r\n  onKeyUp(e) {\r\n    const me = this;\r\n    if (e.key === 'Shift' && me.#revealing) {\r\n      me.type = 'password';\r\n    }\r\n  }\r\n\r\n  onKeyDown(e) {\r\n    const me = this;\r\n    if (me.#isReveal(e)) {\r\n      me.#revealing = true;\r\n      me.type = 'text';\r\n    }\r\n  }\r\n}  ","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSCSSMap } from \"../../../base/GSCSSMap.mjs\";\r\nimport { GSUtil } from \"../../../base/GSUtil.mjs\";\r\n\r\n/**\r\n * Handle for input type text to support text value changes based on CSS\r\n */\r\nexport class TextController {\r\n\r\n  #host;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n  }\r\n\r\n  get raw() {\r\n    return this.#host.raw;\r\n  }\r\n\r\n  get value() {\r\n    return this.#host.value;\r\n  }\r\n\r\n  set value(val) {\r\n    this.#host.value = val;\r\n  }\r\n\r\n  get type() {\r\n    return this.#host?.type;\r\n  }\r\n\r\n  onInput(e) {\r\n    const input = e.target;\r\n    const start = input.selectionStart;\r\n    const end = input.selectionEnd;\r\n    input.value = this.#transform();\r\n    input.setSelectionRange(start, end);\r\n  }\r\n\r\n  onChange(e) {\r\n    this.value = this.#transform();\r\n  }\r\n\r\n  onBlur(e) {\r\n    this.value = this.#transform();\r\n  }\r\n\r\n  #transform() {\r\n    const me = this;\r\n    if (me.type === 'text') {\r\n      const map = GSCSSMap.styleValue(this.#host, 'text-transform');\r\n      if (map) return GSUtil.textTransform(map.value, me.raw);\r\n    }\r\n    return me.value;\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSAttr } from \"../../../base/GSAttr.mjs\";\r\nimport { GSDOM } from \"../../../base/GSDOM.mjs\";\r\nimport { GSEvents } from \"../../../base/GSEvents.mjs\";\r\n\r\n/**\r\n * Handle data filtering for options atribute (combo and data lists)\r\n * Changes in one field list, updates available selections in another field selections.\r\n * \r\n * Options element data-* attributes matching other elements changes \r\n * \"disabled\" attribute for fields, and visibility for non field elements.\r\n * \r\n * NOTE: This applies only for \"gs-form\" or \"form\" child elements.\r\n */\r\nexport class InteractiveController {\r\n\r\n  #host;\r\n\r\n  #monitorCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#monitorCallback = me.#onMonitor.bind(me);\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    const list = me.list;\r\n    if (list) {\r\n      me.#host.attachEvent(me.filter, 'change', me.#monitorCallback);\r\n    }\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host.removeEvent(me.filter, 'change', me.#monitorCallback);\r\n    me.#host = undefined;\r\n  }\r\n\r\n  hostUpdated() {\r\n    // trigger only first time\r\n    if (!this.#host.hasUpdated) {\r\n      this.onChange();\r\n    }\r\n  }\r\n\r\n  get component() {\r\n    return this.#host\r\n  }\r\n\r\n  get value() {\r\n    return this.#host.value;\r\n  }\r\n\r\n  set value(val) {\r\n    this.#host.value = val;\r\n  }\r\n\r\n  get list() {\r\n    return this.#host;\r\n  }\r\n\r\n  get filter() {\r\n    const me = this;\r\n    const filter = GSAttr.get(me.#host, 'data-filter');\r\n    return GSDOM.getByID(me.owner, filter);\r\n  }\r\n\r\n  get owner() {\r\n    //return this.#host.owner;\r\n    return this.#host.form || GSDOM.closest(this.#host, 'form');\r\n  }\r\n\r\n  get formElements() {\r\n    return GSDOM.formElements(this.owner, true);\r\n  }\r\n\r\n  get strict() {\r\n    return GSAttr.get(this.#host, 'strict', '');\r\n  }\r\n\r\n  onBlur(e) {\r\n    if (!this.#isInList()) GSEvents.send(this.#host, 'strict', { ok: false, source: e });\r\n  }\r\n\r\n  onChange(e) {\r\n\r\n    const me = this;\r\n    const own = me.owner;\r\n    let clean = false;\r\n    let opt = GSDOM.query(me.list, `option[value=\"${me.value}\"]`);\r\n    if (!opt) {\r\n        opt = me.list?.querySelector('option');\r\n        clean = true;\r\n    }\r\n\r\n    const obj = opt?.dataset || {};\r\n    Object.entries(obj).forEach(p => {\r\n        const val = clean ? '' : p[1];\r\n        const key = p[0];\r\n        if (key === 'id' || key === 'group') {\r\n          GSAttr.set(me.#host, `data-${key}`, p[1]);\r\n          return;\r\n        } \r\n\r\n        const filter = `[data-${key}]:not([data-${key}=\"\"]`;\r\n        const els = Array.from(GSDOM.queryAll(own, filter));\r\n        els.filter(el => el.tagName !== 'OPTION')\r\n            .filter(el => el.tagName !== 'GS-ITEM')\r\n            .filter(el => el !== me.#host)\r\n            .filter(el => el !== me.filter) \r\n            .filter(v => GSDOM.closest(v, 'gs-form-group') ? false: true ) \r\n            //.filter(el => GSAttr.get(el, 'list').length === 0)\r\n            .forEach(el => me.#togleEl(el, key, val))\r\n    });\r\n  }\r\n\r\n  #onMonitor(e) {\r\n    const me = this;\r\n    const list = me.list;\r\n    me.value = '';\r\n    me.#host.disabled = false;\r\n    const dataGroup = GSAttr.get(me.filter, 'data-group');\r\n    const filter = dataGroup ? `option[data-group=\"${dataGroup}\"]` : `option[data-id=\"${e.target.value}\"]`;\r\n    GSDOM.queryAll(list, 'option').forEach(el => me.#togleOption(el, true));\r\n    GSDOM.queryAll(list, filter).forEach(el => me.#togleOption(el, false));\r\n\r\n  }\r\n\r\n  #togleOption(el, value) {\r\n      GSAttr.toggle(el, 'disabled', value);\r\n      GSDOM.toggleClass(el, 'd-none', value);\r\n  }\r\n\r\n  #togleEl(el, key = '', value = '') {\r\n\r\n    const data = GSAttr.get(el, `data-${key}`, '').split(/[,;;]/);\r\n    const isMatch = value.length > 0 && data.includes(value);\r\n    const frmel = GSDOM.isFormElement(el) || GSDOM.isButtonElement(el) || el.tagName === \"GS-FORM-GROUP\";\r\n\r\n    if (frmel) {\r\n      GSAttr.toggle(el, 'disabled', !isMatch);\r\n    } else {\r\n      isMatch ? GSDOM.show(el) : GSDOM.hide(el);\r\n    }\r\n\r\n    //this.formElements.forEach(el => GSAttr.set(el, 'data-ignore', isMatch ? null : true));\r\n    GSAttr.set(el, 'data-ignore', isMatch ? null : true);\r\n    GSDOM.queryAll(el, 'input,textarea,select').forEach(el => GSAttr.set(el, 'data-ignore', isMatch ? null : true));\r\n  }\r\n\r\n  #isInList() {\r\n    const me = this;\r\n    const list = me.list;\r\n    if (!list) return true;\r\n    if (!me.strict) return true;\r\n    if (!list.querySelector('option')) return true;\r\n    const opt = list.querySelector(`option[value=\"${me.value}\"]`);\r\n    return opt != null;\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSAttr } from \"../../../base/GSAttr.mjs\";\r\nimport { InteractiveController } from \"./InteractiveController.mjs\";\r\n\r\n\r\n/**\r\n * Handle data filtering for list atribute, and linked fields.\r\n * Changes in one field list, update available selections in another field selections.\r\n */\r\nexport class ComboController extends InteractiveController {\r\n\r\n  constructor(host) {\r\n    super(host);\r\n  }\r\n\r\n  get list() {\r\n    return this.component;\r\n  }\r\n\r\n  onChange(e) {  \r\n    super.onChange?.(e);\r\n    this.#onAttributeHandler(e);\r\n  }\r\n\r\n  onBlur(e) {\r\n    super.onBlur?.(e);\r\n    this.#onAttributeHandler(e);\r\n  }\r\n\r\n  #onAttributeHandler(e) {\r\n    const me = this;\r\n    if (!me.component.toggling) return;\r\n    const target = me.component.dataset.gsfTarget;\r\n    const value = me.component.dataset.gsfValue;\r\n    const attr = me.component.dataset.gsfAttribute;\r\n    const flag = me.component.value === value;\r\n    me.formElements\r\n      .filter(el => el != me.component)\r\n      .filter(el => target ? el.matches(target) : true)\r\n      .forEach(el => GSAttr.toggle(el, attr, flag));\r\n  }\r\n}  ","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSAttr } from \"../../../base/GSAttr.mjs\";\r\nimport { GSDOM } from \"../../../base/GSDOM.mjs\";\r\nimport { InteractiveController } from \"./InteractiveController.mjs\";\r\n\r\n/**\r\n * Handle data filtering for list atribute, and linked fields.\r\n * Changes in one field list, update available selections in another field selections.\r\n */\r\nexport class ListController extends InteractiveController {\r\n\r\n  constructor(host) {\r\n    super(host);\r\n  }\r\n\r\n  get list() {\r\n    const me = this;\r\n    if (me.component.list) return me.component.list;\r\n    const list = GSAttr.get(me.component, 'list');\r\n    return GSDOM.getByID(me.owner, list);\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSBeep } from \"../../../base/GSBeep.mjs\";\r\nimport { GSDOM } from \"../../../base/GSDOM.mjs\";\r\nimport { GSEvents } from \"../../../base/GSEvents.mjs\";\r\nimport { GSUtil } from \"../../../base/GSUtil.mjs\";\r\n\r\n\r\n/**\r\n * Handle for input/textarea to support validity checkups\r\n */\r\nexport class ValidityController {\r\n\r\n  #host = undefined;\r\n  #processing = false;  \r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#processing = false;\r\n    me.#host = host;\r\n    host.addController?.(me);\r\n  }\r\n\r\n  hostConnected() {\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController?.(me);\r\n    me.#host = undefined;\r\n    me.#processing = false;\r\n  }\r\n\r\n  get isAutoreport() {\r\n    return this.#host.isAutoreport;\r\n  }\r\n\r\n  get isAutovalidate() {\r\n    return this.#host.isAutovalidate;\r\n  }\r\n\r\n  get isValid() {\r\n    return this.#host.validity.valid;\r\n  }\r\n\r\n  get disabled() {\r\n    return this.#host.disabled;\r\n  }\r\n\r\n  get required() {\r\n    return this.#host.required;\r\n  }  \r\n\r\n  get value() {\r\n    return this.#host.value;\r\n  }\r\n\r\n  get beep() {\r\n    return this.#host.beep;\r\n  }\r\n\r\n  get block() {\r\n    return this.#host.block;\r\n  }\r\n\r\n  get timeout() {\r\n    return this.#host.timeout;\r\n  }\r\n\r\n  get isVisible() {\r\n    return GSDOM.isVisible(this.#host);\r\n  }\r\n\r\n  get form() {\r\n    return this.#host.form;\r\n  }\r\n\r\n  validate() {\r\n    const me = this;    \r\n    const sts = me.isValid || me.disabled;\r\n    me.#togglUI(sts);\r\n    return sts;\r\n  }  \r\n    \r\n  onFocus(e) {\r\n    this.validate();\r\n  }\r\n\r\n  onKeyDown(e) {\r\n    const me = this;\r\n    const isTab = e.key === 'Tab';\r\n    const isEnter = e.key === 'Enter';\r\n    if (isTab && !me.validate()) {\r\n        me.#onBlock(e);\r\n        me.#report();\r\n    }\r\n\r\n    if (isEnter) {\r\n      const form = me.#host.form;\r\n      if (form?.autosubmit) form.requestSubmit();\r\n    }    \r\n  }\r\n\r\n  onInvalid(e) {\r\n    const me = this;\r\n    me.validate();\r\n    // if (!e.composed) me.#host.emit('invalid', e, true, true);\r\n  }\r\n\r\n  onChange(e) {\r\n    const me = this;\r\n    me.#onAutoValidity(e);\r\n    // if (!e.composed) me.#host.emit('change', e, true, true);\r\n  }\r\n\r\n  onBlur(e) {\r\n    const me = this;\r\n    me.#onBlock(e);\r\n    me.#onAutoValidity(e);\r\n    // if (!e.composed) me.#host.emit('blur', e, true, true);\r\n  }\r\n\r\n  #onBlock(e) {    \r\n    const me = this;\r\n    if (me.isValid) return;\r\n    if (me.isVisible && me.block) {\r\n      GSEvents.prevent(e, false, true, false);\r\n      me.#focus();\r\n    }        \r\n  }\r\n\r\n  #onAutoValidity(e) {\r\n    return this.isAutoreport ? this.#reportValidity() : this.isAutovalidate ? this.#checkValidity() : this.validate();\r\n  }  \r\n\r\n  #focus() {\r\n    return this.#host.focus();\r\n  }\r\n\r\n  #checkValidity() {\r\n    const me = this;  \r\n    me.validate();\r\n    return me.#host.checkValidity();\r\n  }\r\n\r\n  #reportValidity() {\r\n    const me = this;  \r\n    me.validate();\r\n    return me.#host.reportValidity();\r\n  }  \r\n\r\n  async #report() {    \r\n    const me = this;\r\n    if (me.#processing || me.isValid || !me.isVisible) return;\r\n    me.#processing = true;\r\n    if (me.beep) {\r\n      try {\r\n        await me.#beep();\r\n        await GSUtil.timeout(me.timeout);\r\n      } catch (e) {\r\n        console.error(e);\r\n      }\r\n    }\r\n    me.#processing = false;\r\n  }\r\n\r\n  #togglUI(isValid) {\r\n    const me = this;\r\n    requestAnimationFrame(() => {\r\n      GSDOM.toggleClass(me.#host, 'is-invalid', !isValid);\r\n    });\r\n  }\r\n\r\n  #beep() {\r\n    return GSBeep.beep(100, 1200, 150, 'triangle');\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { HANDLER } from \"../../../base/GSConst.mjs\";\r\n\r\n/**\r\n * Propagate event to a parent form controller\r\n */\r\nexport class PropagateController {\r\n\r\n  #host = undefined;\r\n  #handler = undefined;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.#handler = me.#host.closest('form')?.handler;\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host?.removeController(me);\r\n    me.#host = undefined;\r\n    me.#handler = undefined;\r\n  }\r\n\r\n  // trigger only first time\r\n  hostUpdated() {\r\n\r\n  }\r\n\r\n  /**\r\n   * Field event propagated to the form\r\n   * @param {Event} e \r\n   */\r\n  onInvalid(e) {\r\n    this.handler.onInvalid?.(e);\r\n  }\r\n\r\n  /**\r\n   * Field event propagated to the form\r\n   * @param {Event} e \r\n   */\r\n  onChange(e) {\r\n    this.handler.onChange?.(e);\r\n  }\r\n\r\n  /**\r\n   * Field event propagated to the form\r\n   * @param {Event} e \r\n   */\r\n  onBlur(e) {\r\n    this.handler.onBlur?.(e);\r\n  }\r\n\r\n  /**\r\n   * Field event propagated to the form\r\n   * @param {Event} e \r\n   */\r\n  onFocus(e) {\r\n    this.handler.onFocus?.(e);\r\n  }\r\n\r\n  get handler() {\r\n    const me = this;\r\n    me.#handler ??= me.#host?.closest('form')?.[HANDLER];\r\n    return me.#handler;\r\n  }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { OWNER, PARENT } from \"../../base/GSConst.mjs\";\r\nimport { GSDOM } from \"../../base/GSDOM.mjs\";\r\nimport { GSEvents } from \"../../base/GSEvents.mjs\";\r\nimport { GSElement } from \"../../GSElement.mjs\";\r\n\r\n/*\r\n* Shared event handling extensions\r\n*/\r\nconst EventsMixin = {\r\n\r\n  /**\r\n   * Get shadow dom owner\r\n   * @returns \r\n   */\r\n  [OWNER]() {\r\n    const own = GSDOM.root(this);\r\n    return GSDOM.unwrap(own);\r\n  },\r\n\r\n  /**\r\n   * Get parent GS-* component\r\n   */\r\n  [PARENT]() {\r\n    return GSDOM.parentAll(this).filter(x => x instanceof GSElement).next()?.value;\r\n  },\r\n\r\n  ////////////////////////////////////////////////////////////////////////\r\n  // cross shadow query\r\n\r\n  /**\r\n   * Find closest top element by CSS selector\r\n   * @param {String} query \r\n   * @returns {HTMLElement}\r\n   */\r\n  closest(query = '') {\r\n    return GSDOM.closest(this, query);\r\n  },\r\n\r\n  /**\r\n   * Find element by CSS selector (top level is this element)\r\n   * @param {String} name \r\n   * @returns {HTMLElement}\r\n   */\r\n  query(query = '', shadow = false) {\r\n    return GSDOM.query(this, query, false, shadow);\r\n  },\r\n\r\n  /**\r\n   * Find multiple elements by CSS selector (top level is this element)\r\n   * @param {String} query \r\n   * @returns {Array<HTMLElement>}\r\n   */\r\n  queryAll(query = '', shadow = false) {\r\n    return GSDOM.queryAll(this, query, false, shadow);\r\n  },\r\n\r\n\r\n  ////////////////////////////////////////////////////////////////////////\r\n  // event handling helpers\r\n\r\n  /**\r\n   * Generic component signal\r\n   * @param {Boolean} bubbles  Does buuble to upper nodes\r\n   * @param {Boolean} composed Does traverse from shadow DOM \r\n   */\r\n  notify(bubbles = true, composed = false, data) {\r\n    this.emit('notify', data, bubbles, composed, true);\r\n  },\r\n\r\n  /**\r\n   * Send event\r\n   * @param {String} name \r\n   * @param {Object} obj \r\n   * @param {Boolean} bubbles \r\n   * @param {Boolean} composed \r\n   * @param {Boolean} cancelable \r\n   */\r\n  emit(name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n    return GSEvents.send(this, name, obj, bubbles, composed, cancelable);\r\n  },\r\n\r\n  /**\r\n   * Wait for event to happen\r\n   * @async\r\n   * @param {String} name \r\n   * @returns {Promise}\r\n   */\r\n  waitEvent(name = '', timeout = 0) {\r\n    return GSEvents.wait(this, name, timeout);\r\n  },\r\n\r\n  /**\r\n   * Listen once for triggered event\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @param {Boolean} capture Allow event capture\r\n   * @returns {Boolean}\r\n   */\r\n  once(name, func, capture = false) {\r\n    return this.listen(name, func, true, capture);\r\n  },\r\n\r\n  /**\r\n   * Alternative function for event listen\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @param {Boolean} once Listen only once\r\n   * @param {Boolean} capture Allow event capture\r\n   * @returns {Boolean}\r\n   */\r\n  on(name, func, once = false, capture = false) {\r\n    return this.listen(name, func, once, capture);\r\n  },\r\n\r\n  /**\r\n   * Alternative function for event unlisten\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  off(name, func) {\r\n    return this.unlisten(name, func);\r\n  },\r\n\r\n  /**\r\n   * Prevent event firing up the DOM tree\r\n   * @param {Event} e \r\n   */\r\n  prevent(e, defaults = true, propagate = true, immediate = true) {\r\n    GSEvents.prevent(e, defaults, propagate, immediate);\r\n  },\r\n\r\n  /**\r\n   * Attach event to this element\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @param {Boolean} once Listen only once\r\n   * @param {Boolean} capture Allow event capture\r\n   * @returns {Boolean}\r\n   */\r\n  listen(name, func, once = false, capture = false) {\r\n    return this.attachEvent(this, name, func, once, capture);\r\n  },\r\n\r\n  /**\r\n   * Remove event from this element\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  unlisten(name, func) {\r\n    return this.removeEvent(this, name, func);\r\n  },\r\n\r\n  /**\r\n  * Generic event listener appender\r\n  * \r\n  * @param {HTMLElement} el Element on which to monitor for named events\r\n  * @param {String} name Event name to watch for\r\n  * @param {Function} fn Event trigger callback\r\n  * @param {Boolean} once Listen only once\r\n  * @param {Boolean} capture Allow event capture\r\n  * @returns {Boolean} State if attachment was successful\r\n  */\r\n  attachEvent(el, name = '', fn, once = false, capture = false) {\r\n    return GSEvents.attach(this, el, name, fn, once, capture);\r\n  },\r\n\r\n  /**\r\n  * Generic event listener remove\r\n  * @param {HTMLElement} el Element on which to monitor for named events\r\n  * @param {String} name Event name to watch for\r\n  * @param {Function} fn Event trigger callback\r\n  * @returns {Boolean} State if attachment was successful\t\r\n  */\r\n  removeEvent(el, name = '', fn) {\r\n    return GSEvents.remove(this, el, name, fn);\r\n  }\r\n\r\n  //////////////////////////////////////////////////////////////\r\n\r\n}\r\n\r\n/**\r\n * Function to apply mixin into defiend class\r\n * @param {*} clazz \r\n * @returns \r\n */\r\nexport const mixin = (clazz) => {\r\n  return Object.assign(clazz.prototype || clazz, EventsMixin);\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSDOM } from \"../../../base/GSDOM.mjs\";\r\n\r\nexport class FormController {\r\n\r\n  #host = undefined;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host = undefined;\r\n  }\r\n\r\n  // trigger only first time\r\n  hostUpdated() {\r\n\r\n  }\r\n\r\n  /**\r\n   * Form reset event\r\n   * @param {Event} e \r\n   */\r\n  onReset(e) {\r\n    const me = this;\r\n    me.#scheduleValidate(e);\r\n  }\r\n\r\n  /**\r\n   * Form submit event\r\n   * @param {Event} e \r\n   */\r\n  onSubmit(e) {\r\n    const me = this;\r\n\r\n  }\r\n\r\n  /**\r\n   * Event triggered on new FormData(form)\r\n   * @param {Event} e \r\n   */\r\n  onFormData(e) {\r\n    const me = this;\r\n\r\n  }\r\n\r\n  /**\r\n   * Event triggered after form validation.\r\n   * Triggers after burst of field events like 'change', 'blur', 'invalid'.\r\n   * @param {Event} e \r\n   */\r\n  onValidation(e) {\r\n    // console.debug('Form validation result: ', e.detail, e);\r\n  }\r\n\r\n  /**\r\n   * Field event propagated to the form\r\n   * @param {Event} e \r\n   */\r\n  onInvalid(e) {\r\n    this.#scheduleValidate(e);\r\n  }\r\n\r\n  /**\r\n   * Field event propagated to the form\r\n   * @param {Event} e \r\n   */\r\n  onChange(e) {\r\n    this.#scheduleValidate(e);\r\n  }\r\n\r\n  /**\r\n   * Field event propagated to the form\r\n   * @param {Event} e \r\n   */\r\n  onBlur(e) {\r\n    this.#scheduleValidate(e);\r\n  }\r\n\r\n  /**\r\n   * Field event propagated to the form\r\n   * @param {Event} e \r\n   */  \r\n  onFocus(e) {\r\n  \r\n  }\r\n\r\n  validate() {\r\n    this.#scheduleValidate();\r\n  }\r\n\r\n  get form() {\r\n    return this.#host;\r\n  }\r\n\r\n  get inputs() {\r\n    return this.form?.inputs;\r\n  }\r\n\r\n  #isScheduled = false;\r\n  #fields = new Set();\r\n\r\n  #scheduleValidate(e) {\r\n    const me = this;\r\n\r\n    const field = e?.detail?.target || e?.target;\r\n    const isFormField = GSDOM.isFormElement(field);\r\n    if (isFormField && !field.validity.valid) {\r\n      me.#fields.add(field);\r\n    }\r\n\r\n    if (me.#isScheduled) {\r\n      return;\r\n    }\r\n    me.#isScheduled = true;\r\n\r\n    requestAnimationFrame(() => {\r\n      if (!me.form) {\r\n        me.#isScheduled = false;\r\n        return;\r\n      }\r\n      try {\r\n        // valid might be incorrect if \r\n        // - gs-form content is not wrapped in template\r\n        // - fields are outside of gs-form / form, injected thrugh slots\r\n        // thus we need to check individual fields too\r\n        const valid = me.form.checkValidity();\r\n        me.form.onvalidation?.(valid);\r\n        const fields = Array.from(me.#fields).filter(f => !f.validity.valid);\r\n        me.#fields.clear();\r\n        const obj = { valid: valid && fields.length === 0, fields: fields };\r\n        me.form.emit('validation', obj);\r\n      } catch (error) {\r\n        console.error('Error during form validation scheduling:', error);\r\n      } finally {\r\n        me.#isScheduled = false;\r\n      }\r\n    });\r\n  }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSEvents } from '../../base/GSEvents.mjs';\r\n\r\nimport { ValidityController } from './controllers/ValidityController.mjs';\r\nimport { CopySelectController } from './controllers/CopySelectController.mjs';\r\nimport { PasswordController } from './controllers/PasswordController.mjs';\r\nimport { NumberController } from './controllers/NumberController.mjs';\r\nimport { TextController } from './controllers/TextController.mjs';\r\nimport { ComboController } from './controllers/ComboController.mjs';\r\nimport { FormController } from './controllers/FormController.mjs';\r\nimport { DataController } from \"../../controllers/DataController.mjs\";\r\nimport { PropagateController } from './controllers/PropagateController.mjs';\r\n\r\n/**\r\n * Helper class wizh shared code for form elements to process controllers.\r\n */\r\nexport class ControllerHandler {\r\n\r\n\r\n  #host = undefined;\r\n  #handlers = undefined;\r\n  #controllers = undefined;\r\n\r\n  #copyselect = undefined;\r\n  #typeController = undefined;\r\n  #validityController = undefined;\r\n  #comboController = undefined;\r\n  #buttonController = undefined;\r\n  #propagateController = undefined;\r\n\r\n  #formController = undefined;\r\n  #dataController = undefined;\r\n\r\n  constructor(host) {\r\n    this.#host = host;\r\n  }\r\n\r\n  connectedCallback() {\r\n    const me = this;\r\n    const host = me.#host;\r\n\r\n    if (me.isButton) {\r\n      return me.#invoke((c) => c.hostConnected?.());\r\n    }\r\n\r\n    if (me.isForm) {\r\n      host.on('reset', me.#onReset.bind(me));\r\n      host.on('submit', me.#onSubmit.bind(me));\r\n      host.on('formdata', me.#onFormData.bind(me));\r\n      host.on('validation', me.#onValidation.bind(me));\r\n      host.on('enabled', me.#onEnable.bind(me));\r\n      host.on('disabled', me.#onDisable.bind(me));\r\n    } else {\r\n      host.on('keydown', me.#onKeyDown.bind(me));\r\n      host.on('keyup', me.#onKeyUp.bind(me));\r\n      host.on('input', me.#onInput.bind(me));\r\n      // these events are also forwarded to form controller\r\n      host.on('change', me.onChange.bind(me));\r\n      host.on('focus', me.onFocus.bind(me));\r\n      host.on('blur', me.onBlur.bind(me));\r\n      host.on('invalid', me.onInvalid.bind(me));\r\n    }\r\n\r\n    me.#invoke((c) => c.hostConnected?.());\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    const me = this;\r\n    GSEvents.detachListeners(me.#host);\r\n    me.#invoke((c) => c.hostDisconnected?.());\r\n\r\n    me.#controllers?.clear();\r\n\r\n    me.#host = undefined;\r\n    me.#handlers = undefined;\r\n    me.#controllers = undefined;\r\n    me.#comboController = undefined;\r\n    me.#buttonController = undefined;\r\n    me.#formController = undefined;\r\n    me.#dataController = undefined;\r\n    me.#propagateController = undefined;\r\n\r\n    me.#copyselect = undefined;\r\n    me.#typeController = undefined;\r\n    me.#validityController = undefined;\r\n  }\r\n\r\n  hostUpdated(name) {\r\n    const me = this;\r\n    if (!me.#host.hostUpdated) {\r\n      if (!me.isButton) {\r\n        me.#initControllers();\r\n        me.#host.checkValidity?.();\r\n      }\r\n    }\r\n    me.#invoke((c) => c.hostUpdated?.(name));\r\n  }\r\n\r\n  addController(controller) {\r\n    if (!controller) return;\r\n    const me = this;\r\n    me.#controllers ??= new Set();\r\n    me.#controllers.add(controller);\r\n    me.#prepare();\r\n    if (me.#host.isConnected) {\r\n      controller.hostConnected?.();\r\n    }\r\n  }\r\n\r\n  removeController(controller) {\r\n    const me = this;\r\n    me.#controllers?.delete(controller);\r\n    me.#prepare();\r\n  }\r\n\r\n  #prepare() {\r\n    const me = this;\r\n    me.#handlers = me.#controllers ? Array.from(me.#controllers).reverse() : [];\r\n  }\r\n\r\n  #invoke(callback) {\r\n    if (typeof callback === 'function') {\r\n      this.#handlers?.forEach(callback);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Form disable callback\r\n   * @param {*} all \r\n   */\r\n  #onDisable(all = false) {\r\n    this.#invoke((c) => c.onDisable?.(all));\r\n  }\r\n\r\n  /**\r\n   * Form enable callback\r\n   * @param {*} all \r\n   */  \r\n  #onEnable(all = false) {\r\n    this.#invoke((c) => c.onEnable?.(all));\r\n  }\r\n\r\n  /**\r\n   * Used by input fields to update UI\r\n   *  field reset, check, report calls\r\n   */\r\n  validate() {\r\n    this.#invoke((c) => c.validate?.());\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n    this.#invoke(c => c.onKeyDown?.(e));\r\n  }\r\n\r\n  #onKeyUp(e) {\r\n    this.#invoke(c => c.onKeyUp?.(e));\r\n  }\r\n\r\n  #onInput(e) {\r\n    this.#invoke(c => c.onInput?.(e));\r\n  }\r\n\r\n  onFocus(e) {\r\n    this.#invoke(c => c.onFocus?.(e));\r\n  }\r\n\r\n  onInvalid(e) {\r\n    this.#invoke(c => c.onInvalid?.(e));\r\n  }\r\n\r\n  onChange(e) {\r\n    this.#invoke(c => c.onChange?.(e));\r\n  }\r\n\r\n  onBlur(e) {\r\n    this.#invoke(c => c.onBlur?.(e));\r\n  }\r\n\r\n  #onReset(e) {\r\n    this.#invoke(c => c.onReset?.(e));\r\n  }\r\n\r\n  #onSubmit(e) {\r\n    this.#invoke(c => c.onSubmit?.(e));\r\n  }\r\n\r\n  #onFormData(e) {\r\n    this.#invoke(c => c.onFormData?.(e));\r\n  }\r\n\r\n  #onValidation(e) {\r\n    this.#invoke(c => c.onValidation?.(e));\r\n  }\r\n\r\n  #initControllers() {\r\n\r\n    const me = this;\r\n    const host = me.#host;\r\n\r\n    if (me.isForm) {\r\n      me.#formController ??= new FormController(host);\r\n    } else {\r\n      me.#validityController ??= new ValidityController(host);\r\n      if (me.isInput) me.#initIinputControllers();\r\n      if (me.isTextArea) me.#initTextAreaControllers();\r\n      if (me.isSelect) me.#comboController ??= new ComboController(host);\r\n      me.#propagateController ??= new PropagateController(host);\r\n    }\r\n\r\n    if (host.storage) {\r\n      if (me.isSelect || me.isDataList) {\r\n        me.#dataController ??= new DataController(host);\r\n      }\r\n    }\r\n  }\r\n\r\n  #initTextAreaControllers() {\r\n    const me = this;\r\n    const host = me.#host;\r\n    me.#typeController ??= new TextController(host);\r\n    me.#copyselect ??= new CopySelectController(host);\r\n  }\r\n\r\n  #initIinputControllers() {\r\n    const me = this;\r\n    const host = me.#host;\r\n    let ok = false;\r\n    switch (host.type) {\r\n      case 'text':\r\n        ok = true;\r\n        me.#typeController ??= new TextController(host);\r\n        break;\r\n      case 'password':\r\n        ok = true;\r\n        me.#typeController ??= new PasswordController(host);\r\n        break;\r\n      case 'number':\r\n        ok = true;\r\n        me.#typeController ??= new NumberController(host);\r\n        break;\r\n    }\r\n    if (ok) {\r\n      me.#copyselect ??= new CopySelectController(host);\r\n    }\r\n  }\r\n\r\n  get tagName() {\r\n    return this.#host?.tagName;\r\n  }\r\n\r\n  get isForm() {\r\n    return (this.tagName === 'FORM');\r\n  }\r\n\r\n  get isTextArea() {\r\n    return (this.tagName === 'TEXTAREA');\r\n  }\r\n\r\n  get isInput() {\r\n    return (this.tagName === 'INPUT');\r\n  }\r\n\r\n  get isSelect() {\r\n    return (this.tagName === 'SELECT');\r\n  }\r\n\r\n  get isDataList() {\r\n    return (this.tagName === 'DATALIST');\r\n  }\r\n\r\n  get isButton() {\r\n    return (this.tagName === 'BUTTON');\r\n  }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSEvents } from \"../../../base/GSEvents.mjs\";\r\nimport { GSFunction } from \"../../../base/GSFunction.mjs\";\r\n\r\n/**\r\n * Handle form button submit / reset \r\n */\r\nexport class ButtonController {\r\n\r\n  #host = undefined;\r\n  #callback = undefined;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.form?.addController?.(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    const btn = me.button;\r\n    me.#callback = me.onClick.bind(me);\r\n    me.#callback = btn.rateLimit > 0 ? GSFunction.debounce(me.#callback, btn.rateLimit, true) : me.#callback;\r\n    btn.on('click', me.#callback);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    const btn = me.button;\r\n    btn?.off('click', me.#callback);\r\n    btn?.removeController(me);\r\n    me.#host = undefined;\r\n    me.#callback = undefined;\r\n  }\r\n\r\n  /**\r\n   * Field event propagated to the form\r\n   * @param {Event} e \r\n   */\r\n  onInvalid(e) {\r\n    this.updateState();\r\n  }\r\n\r\n  onValid(e) {\r\n    this.updateState();\r\n  }\r\n\r\n  /**\r\n   * Field event propagated to the form\r\n   * @param {Event} e \r\n   */\r\n  onChange(e) {\r\n    this.updateState();\r\n  }\r\n\r\n  /**\r\n   * Field event propagated to the form\r\n   * @param {Event} e \r\n   */\r\n  onBlur(e) {\r\n    this.updateState();\r\n  }\r\n\r\n  onClick(e) {\r\n    const btn = this.button;\r\n    const form = this.form;\r\n    if (form.disabled) {\r\n      return GSEvents.prevent(e);\r\n    }\r\n    if (btn.isReset) {\r\n      return form?.reset();\r\n    }\r\n    if (form && btn.isSubmit) {\r\n      GSEvents.prevent(e);\r\n      if (form.isValid) {\r\n        form.requestSubmit();\r\n      } else {\r\n        btn.disabled = true;\r\n      }\r\n      return;\r\n    }\r\n    if (form && btn.isManaged) {\r\n      if (!form.isValid) {\r\n        btn.disabled = true;\r\n        GSEvents.prevent(e);\r\n      }\r\n    }\r\n  }\r\n\r\n  updateState() {\r\n    const btn = this.button;\r\n    const form = this.form;\r\n    if ((btn.isSubmit || btn.isManaged) && form?.disabled === false) btn.disabled = form.isValid === false;\r\n  }\r\n\r\n  get button() {\r\n    return this.#host;\r\n  }\r\n\r\n  get form() {\r\n    return this.#host?.form;\r\n  }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDataListExt class\r\n * @module components/ext/GSDataListExt\r\n */\r\n\r\nimport { ButtonTypes } from '../../properties/index.mjs';\r\nimport { OWNER, PARENT } from \"../../base/GSConst.mjs\";\r\nimport { GSDOM } from \"../../base/GSDOM.mjs\";\r\nimport { GSEvents } from \"../../base/GSEvents.mjs\";\r\nimport { mixin } from \"./EventsMixin.mjs\";\r\nimport { GSAttr } from '../../base/GSAttr.mjs';\r\nimport { ControllerHandler } from './ControllerHandler.mjs';\r\nimport { ButtonController } from './controllers/ButtonController.mjs';\r\n\r\n/**\r\n * Add JSON loader to select element\r\n * <textarea is=\"gs-ext-textarea\"></textarea>\r\n * \r\n * [{text:'', value:'' selected:true}]\r\n * \r\n * @class\r\n * @extends { HTMLButtonElement }\r\n */\r\nexport class GSExtButtonElement extends HTMLButtonElement {\r\n\r\n    static {\r\n        mixin(GSExtButtonElement);\r\n        GSDOM.define('gs-ext-button', GSExtButtonElement, { extends: 'button' });\r\n        Object.seal(GSExtButtonElement);\r\n    }\r\n\r\n    static get observedAttributes() {\r\n        return ['disabled'];\r\n    }\r\n\r\n    #formEl = undefined;\r\n    #hasUpdated = false;\r\n    #controllerHandler = undefined;\r\n    #buttonController = undefined;\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    connectedCallback() {\r\n        const me = this;\r\n        if (me.isSubmit || me.isReset || me.isManaged) {\r\n            me.#buttonController = new ButtonController(me);\r\n        }        \r\n        me.#controllerHandler?.connectedCallback();        \r\n        me.#preupdate();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        const me = this;\r\n        GSEvents.detachListeners(me);\r\n        me.#controllerHandler?.disconnectedCallback();\r\n        me.#controllerHandler = undefined;\r\n        me.#formEl = undefined;\r\n    }\r\n\r\n    attributeChangedCallback(name, oldValue, newValue) {\r\n        const me = this;\r\n        me.#preupdate(name);\r\n        me.willUpdate(name, oldValue, newValue);\r\n        me.#controllerHandler?.hostUpdated(name);\r\n    }\r\n\r\n    #preupdate(name) {\r\n        const me = this;\r\n        if (!me.#hasUpdated) {            \r\n            me.firstUpdated(name);\r\n            me.#controllerHandler?.hostUpdated(name);\r\n            me.#hasUpdated = true;\r\n        }\r\n    }\r\n\r\n    firstUpdated(changed) {\r\n\r\n    }\r\n\r\n    willUpdate(changed, oldValue, newValue) {\r\n        if (changed === 'disabled') {\r\n            this.emit('disabled', this.disabled, true, true, true);\r\n        }\r\n    }\r\n\r\n    addController(controller) {\r\n        const me = this;\r\n        me.#controllerHandler ??= new ControllerHandler(me);\r\n        me.#controllerHandler?.addController(controller);\r\n    }\r\n\r\n    removeController(controller) {\r\n        this.#controllerHandler?.removeController(controller);\r\n    }\r\n\r\n    get owner() {\r\n        return this[OWNER]();\r\n    }\r\n\r\n    get parentComponent() {\r\n        return this[PARENT]();\r\n    }\r\n\r\n    get hasUpdated() {\r\n        return this.#hasUpdated;\r\n    }\r\n\r\n    get form() {\r\n        const me = this;\r\n        me.#formEl ??= super.form || me.owner?.form || me.closest?.('form');\r\n        return me.#formEl;\r\n    }\r\n    \r\n    get isValid() {\r\n        return this.form ? this.form.checkValidity() : true;\r\n    }\r\n\r\n    /**\r\n     * If attribute subtype is \"submit\", will manage \r\n     * disable / enable state as a submit button.\r\n     * Used for cusotm buttons to be disabled on form validation state.\r\n     */\r\n    get isManaged() {\r\n        return this.dataset.gsType==='submit';\r\n    }\r\n\r\n    get isSubmit() {\r\n        return ButtonTypes.isSubmit(this.type);\r\n    }\r\n\r\n    get isReset() {\r\n        return ButtonTypes.isReset(this.type);\r\n    }\r\n\r\n    /**\r\n     * Limit button click rate in milliseconds.\r\n     * If set to 0, no limit is applied.\r\n     */\r\n    get rateLimit() {\r\n        return GSAttr.getAsNum(this, 'rate-limit', 0);\r\n    }\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSDOM } from '../../base/GSDOM.mjs';\r\nimport { GSEvents } from '../../base/GSEvents.mjs';\r\nimport { OWNER, PARENT } from \"../../base/GSConst.mjs\";\r\nimport { MaskController } from './controllers/MaskController.mjs';\r\nimport { MultipatternController } from './controllers/MultipatternController.mjs';\r\nimport { ListController } from './controllers/ListController.mjs';\r\nimport { GSAttr } from '../../base/GSAttr.mjs';\r\nimport { GSUtil } from '../../base/GSUtil.mjs';\r\nimport { ControllerHandler } from './ControllerHandler.mjs';\r\nimport { mixin } from './EventsMixin.mjs';\r\n\r\n\r\n/**\r\n * Extended HTMLInputElement with controllers support\r\n * adding various features such as masked input support \r\n */\r\nexport class GSExtInputElement extends HTMLInputElement {\r\n\r\n  static {\r\n    mixin(GSExtInputElement);\r\n    GSDOM.define('gs-ext-input', GSExtInputElement, { extends: 'input' });\r\n    Object.seal(GSExtInputElement);\r\n  }\r\n\r\n  static get observedAttributes() {\r\n    // 'autocopy', 'autofocus', 'autoselect', 'autovalidate','autoreport', 'block', 'beep', 'timeout', \r\n    return ['multipattern', 'mask', 'required', 'disabled'];\r\n  }\r\n\r\n  #controllerHandler = undefined;\r\n  #maskController = undefined;\r\n  #patternController = undefined;\r\n  #listController = undefined;\r\n\r\n  #pattern = undefined;\r\n  #hasUpdated = false;\r\n\r\n  constructor() {\r\n    super();\r\n    this.#controllerHandler = new ControllerHandler(this);\r\n  }\r\n\r\n  connectedCallback() {\r\n    const me = this;\r\n    me.#controllerHandler?.connectedCallback();\r\n    me.#preupdate();\r\n    me.dataset.value = me.value;\r\n    me.on('change', e => me.dataset.value = me.value);\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    const me = this;\r\n    me.#controllerHandler?.disconnectedCallback();\r\n    me.#controllerHandler = undefined;\r\n\r\n    me.#maskController = undefined;\r\n    me.#patternController = undefined;\r\n    me.#listController = undefined;\r\n    me.#pattern = undefined;\r\n\r\n    GSEvents.detachListeners(me);\r\n  }\r\n\r\n  attributeChangedCallback(name, oldValue, newValue) {\r\n    const me = this;    \r\n    if (me.isCheckBox && name === 'required' && me.required) return me.required = false;\r\n    me.#preupdate(name);\r\n    me.willUpdate(name, oldValue, newValue);\r\n    me.#controllerHandler?.hostUpdated(name);\r\n  }\r\n\r\n  addController(controller) {\r\n    this.#controllerHandler?.addController(controller);\r\n  }\r\n\r\n  removeController(controller) {\r\n    this.#controllerHandler?.removeController(controller);\r\n  }\r\n\r\n  get owner() {\r\n    return this[OWNER]();\r\n  }\r\n\r\n  /**\r\n   * Get parent GS-* component\r\n   */\r\n  get parentComponent() {\r\n    return this[PARENT]();\r\n  }\r\n\r\n\r\n  get hasUpdated() {\r\n    return this.#hasUpdated;\r\n  }\r\n\r\n  get autocopy() {\r\n    return this.hasAttribute('autocopy');\r\n  }\r\n\r\n  get autofocus() {\r\n    return this.hasAttribute('autofocus');\r\n  }\r\n\r\n  get autoselect() {\r\n    return this.hasAttribute('autoselect');\r\n  }\r\n\r\n  /**\r\n   * If set, autoamtically calls reportValidity\r\n   */\r\n  get autoreport() {\r\n    return this.hasAttribute('autoreport');\r\n  }\r\n\r\n  /**\r\n   * If set, autoamtically calls checkValidity\r\n   */\r\n  get autovalidate() {\r\n    return this.hasAttribute('autovalidate');\r\n  }\r\n\r\n  get beep() {\r\n    return this.hasAttribute('beep');\r\n  }\r\n\r\n  get block() {\r\n    return this.hasAttribute('block');\r\n  }\r\n\r\n  get mask() {\r\n    return GSAttr.get(this, 'mask');\r\n  }\r\n\r\n  get multipattern() {\r\n    return this.#pattern;\r\n    //return GSDOM.getValue(this, 'multipattern');\r\n  }\r\n\r\n  // enable password reveal\r\n  get reveal() {\r\n    return this.hasAttribute('reveal');\r\n  }\r\n\r\n  get timeout() {\r\n    return GSAttr.getAsNum(this, 'timeout', 0);\r\n  }\r\n\r\n  set autocopy(value) {\r\n    GSAttr.toggle(this, 'autocopy', value);\r\n  }\r\n\r\n  set autofocus(value) {\r\n    GSAttr.toggle(this, 'autocopy', value);\r\n  }\r\n\r\n  set autoselect(value) {\r\n    GSAttr.toggle(this, 'autocopy', value);\r\n  }\r\n\r\n  set autoreport(value) {\r\n    GSAttr.toggle(this, 'autoreport', value);\r\n  }\r\n\r\n  set autovalidate(value) {\r\n    GSAttr.toggle(this, 'autovalidate', value);\r\n  }\r\n\r\n  set beep(value) {\r\n    GSAttr.toggle(this, 'beep', value);\r\n  }\r\n\r\n  set block(value) {\r\n    GSAttr.toggle(this, 'block', value);\r\n  }\r\n\r\n  set mask(value) {\r\n    GSAttr.set(this, 'mask', value);\r\n  }\r\n\r\n  set multipattern(value) {\r\n    let data = value;\r\n    // convert to array if not, and stringify if values are regex\r\n    if (GSUtil.isJsonType(value)) {\r\n      const tmp = (Array.isArray(value) ? value : [value]).map(v => v.source || v.toString?.() || v);\r\n      data = JSON.stringify(tmp);\r\n    }\r\n    GSAttr.set(this, 'multipattern', data);\r\n  }\r\n\r\n  /**\r\n   * Useds only on password type to reveal \r\n   * password with key shortcut ctrl-altt-shift\r\n   */\r\n  set reveal(value) {\r\n    if (this.type === 'password') GSAttr.toggle(this, 'reveal', value);\r\n  }\r\n\r\n  set timeout(value) {\r\n    GSAttr.setAsNum(this, 'timeout', value);\r\n  }\r\n\r\n  get required() {\r\n    return super.required;\r\n  }\r\n\r\n  set required(value) {\r\n    super.required = this.isCheckBox ? false : GSUtil.asBool(value);\r\n  }  \r\n\r\n  get raw() {\r\n    return super.value;\r\n  }\r\n\r\n  get value() {\r\n    return this.#maskController ? this.#maskController.value : super.value;\r\n  }\r\n\r\n  set value(val) {\r\n    super.value = this.mask === val ? '' : val;\r\n  }\r\n\r\n  get isAutocopy() {\r\n    return this.autocopy || this.form?.autocopy;\r\n  }\r\n\r\n  get isAutoselect() {\r\n    return this.autoselect || this.form?.autoselect;\r\n  }\r\n\r\n  get isAutovalidate() {\r\n    return this.autovalidate || this.form?.autovalidate;\r\n  }\r\n  \r\n  get isAutoreport() {\r\n    return this.autoreport || this.form?.autoreport;\r\n  }\r\n\r\n  /**\r\n   * Return true if current element or chadow dom child is focused\r\n   */\r\n  get isFocused() {\r\n    return this === document.activeElement;\r\n  }\r\n\r\n  get isCheckBox() {\r\n    return this.type === 'checkbox';\r\n  }\r\n\r\n  get form() {\r\n    const me = this;\r\n    return super.form || me.owner?.form || me.closest?.('form');\r\n  }\r\n\r\n  reset() {\r\n    const me = this;\r\n    me.setCustomValidity('');\r\n    GSDOM.reset(me);\r\n    me.#validate();\r\n  }\r\n\r\n  checkValidity() {\r\n    this.#validate();\r\n    return super.checkValidity();\r\n  }\r\n\r\n  reportValidity() {\r\n    this.#validate();\r\n    return super.reportValidity();\r\n  }\r\n\r\n  #validate(e) {\r\n    return this.#controllerHandler.validate(e);\r\n  }\r\n\r\n  /**\r\n   * Find closest top element by CSS selector\r\n   * @param {String} query \r\n   * @returns {HTMLElement}\r\n   */\r\n  closest(query = '') {\r\n    return GSDOM.closest(this, query);\r\n  }\r\n\r\n\r\n  firstUpdated(changed) {\r\n    const me = this;\r\n    if (me.autofocus) me.focus();\r\n    const data = me.formComponent?.data;\r\n    if (data) GSDOM.fromObject2Element(me, data);\r\n  }\r\n\r\n  willUpdate(changed, oldValue, newValue) {\r\n\r\n    const me = this;\r\n\r\n    if ('mask' === changed) {\r\n      me.#updateMask();\r\n    }\r\n\r\n    if ('multipattern' === changed) {\r\n      me.#updateMultipattern(newValue);\r\n    }\r\n\r\n    if ('list' === changed) {\r\n      me.#updateList();\r\n    }\r\n\r\n    if (changed === 'required' || changed === 'disabled') {\r\n      me.#validate();\r\n    }\r\n  }\r\n\r\n  #preupdate(name) {\r\n    const me = this;\r\n    if (!me.#hasUpdated) {\r\n      me.#updateMask();\r\n      me.#updateMultipattern(me.pattern);\r\n      me.#updateList();\r\n      me.firstUpdated(name);\r\n      me.#controllerHandler?.hostUpdated(name);\r\n      me.#hasUpdated = true;\r\n      me.#validate();\r\n    }\r\n  }\r\n\r\n  #updateMask() {\r\n    const me = this;\r\n    if (me.mask && me.type === 'text') {\r\n      me.placeholder = me.mask;\r\n      me.#maskController ??= new MaskController(me);\r\n    } else {\r\n      me.removeController(me.#maskController);\r\n      me.#maskController = null;\r\n    }\r\n  }\r\n\r\n  #updateMultipattern(newValue) {\r\n    const me = this;\r\n    if (GSUtil.isJsonString(newValue)) {\r\n      const tmp = GSUtil.toJson(newValue, []);\r\n      me.#pattern = (Array.isArray(tmp) ? tmp : []).map(v => new RegExp(v));\r\n    } else {\r\n      me.#pattern = undefined;\r\n    }\r\n\r\n    const isMulti = Array.isArray(me.#pattern) && me.#pattern.length > 0;\r\n    const isType = ['text', 'password'].includes(me.type);\r\n    if (isMulti && isType) {\r\n      me.#patternController ??= new MultipatternController(me);\r\n    } else {\r\n      me.removeController(me.#patternController);\r\n      me.#patternController = null;\r\n    }\r\n  }\r\n\r\n  #updateList() {\r\n    const me = this;\r\n    if (me.list) {\r\n      me.#listController ??= new ListController(me);\r\n    } else {\r\n      me.removeController(me.#listController);\r\n      me.#listController = null;\r\n    }\r\n  }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDataListExt class\r\n * @module components/ext/GSDataListExt\r\n */\r\nimport { OWNER, PARENT } from \"../../base/GSConst.mjs\";\r\nimport { GSDOM } from \"../../base/GSDOM.mjs\";\r\nimport { GSLoader } from \"../../base/GSLoader.mjs\";\r\nimport { GSEvents } from \"../../base/GSEvents.mjs\";\r\nimport { GSAttr } from \"../../base/GSAttr.mjs\";\r\nimport { ControllerHandler } from \"./ControllerHandler.mjs\";\r\nimport { mixin } from \"./EventsMixin.mjs\";\r\n\r\n/**\r\n * Add JSON loader to select element\r\n * <textarea is=\"gs-ext-textarea\"></textarea>\r\n * \r\n * [{text:'', value:'' selected:true}]\r\n * \r\n * @class\r\n * @extends { HTMLTextAreaElement }\r\n */\r\nexport class GSExtTextAreaElement extends HTMLTextAreaElement {\r\n\r\n    static {\r\n        mixin(GSExtTextAreaElement);\r\n        GSDOM.define('gs-ext-textarea', GSExtTextAreaElement, { extends: 'textarea' });\r\n        Object.seal(GSExtTextAreaElement);\r\n    }\r\n\r\n    static get observedAttributes() {\r\n        return ['required', 'disabled'];\r\n    }\r\n\r\n    #hasUpdated = false;\r\n    #controllerHandler = undefined;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#controllerHandler = new ControllerHandler(this);\r\n    }\r\n\r\n    connectedCallback() {\r\n        const me = this;\r\n        me.#controllerHandler?.connectedCallback();\r\n        me.#preupdate();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        const me = this;\r\n        me.#controllerHandler?.disconnectedCallback();\r\n        me.#controllerHandler = undefined;\r\n        GSEvents.detachListeners(me);\r\n    }\r\n\r\n    attributeChangedCallback(name, oldValue, newValue) {\r\n        const me = this;\r\n        me.#preupdate(name);\r\n        me.willUpdate(name, oldValue, newValue);\r\n        me.#controllerHandler?.hostUpdated(name);\r\n    }\r\n\r\n    #preupdate(name) {\r\n        const me = this;\r\n        if (!me.#hasUpdated) {\r\n            me.firstUpdated(name);\r\n            me.#controllerHandler?.hostUpdated(name);\r\n            me.#hasUpdated = true;\r\n            me.#validate();\r\n        }\r\n    }\r\n\r\n    firstUpdated(changed) {\r\n        const me = this;\r\n        const data = me.formComponent?.data;\r\n        if (data) GSDOM.fromObject2Element(me, data);\r\n        if (me.autofocus) me.focus();\r\n    }\r\n\r\n    willUpdate(changed, oldValue, newValue) {\r\n        if (changed === 'required' || changed === 'disabled') {\r\n            this.#validate();\r\n        }\r\n    }\r\n\r\n    addController(controller) {\r\n        this.#controllerHandler?.addController(controller);\r\n    }\r\n\r\n    removeController(controller) {\r\n        this.#controllerHandler?.removeController(controller);\r\n    }\r\n\r\n    reset() {\r\n        const me = this;\r\n        me.setCustomValidity('');\r\n        GSDOM.reset(me);\r\n        me.#validate();\r\n    }\r\n\r\n    checkValidity() {\r\n        this.#validate();\r\n        return super.checkValidity();\r\n    }\r\n\r\n    reportValidity() {\r\n        this.#validate();\r\n        return super.reportValidity();\r\n    }\r\n\r\n    #validate(e) {\r\n        return this.#controllerHandler.validate(e);\r\n    }\r\n\r\n    get owner() {\r\n        return this[OWNER]();\r\n    }\r\n\r\n    get parentComponent() {\r\n        return this[PARENT]();\r\n    }\r\n\r\n    get hasUpdated() {\r\n        return this.#hasUpdated;\r\n    }\r\n\r\n    /**\r\n     * If set, autoamtically calls reportValidity\r\n     */\r\n    get autoreport() {\r\n        return this.hasAttribute('autoreport');\r\n    }\r\n\r\n    /**\r\n     * If set, automatically calls checkValidity\r\n     */\r\n    get autovalidate() {\r\n        return this.hasAttribute('autovalidate');\r\n    }\r\n\r\n    get autoselect() {\r\n        return this.hasAttribute('autoselect');\r\n    }\r\n\r\n    get autocopy() {\r\n        return this.hasAttribute('autocopy');\r\n    }\r\n\r\n    get block() {\r\n        return this.hasAttribute('block');\r\n    }\r\n\r\n    get beep() {\r\n        return this.hasAttribute('beep');\r\n    }\r\n\r\n    get timeout() {\r\n        return GSAttr.getAsNum(this, 'timeout', 0);\r\n    }\r\n\r\n    set autoreport(value) {\r\n        GSAttr.toggle(this, 'autoreport', value);\r\n    }\r\n\r\n    set autovalidate(value) {\r\n        GSAttr.toggle(this, 'autovalidate', value);\r\n    }\r\n\r\n    set autoselect(value) {\r\n        GSAttr.toggle(this, 'autoselect', value);\r\n    }\r\n\r\n    set autocopy(value) {\r\n        GSAttr.toggle(this, 'autocopy', value);\r\n    }\r\n\r\n    set block(val = false) {\r\n        GSAttr.toggle(this, 'block', val);\r\n    }\r\n\r\n    set beep(val = false) {\r\n        GSAttr.toggle(this, 'beep', val);\r\n    }\r\n\r\n    set timeout(val = 0) {\r\n        return GSAttr.setAsNum(this, 'timeout', val);\r\n    }\r\n\r\n    get form() {\r\n        const me = this;\r\n        return super.form || me.owner?.form || me.closest?.('form');\r\n    }\r\n\r\n    get isAutocopy() {\r\n        return this.autocopy || this.form?.autocopy;\r\n    }\r\n\r\n    get isAutoselect() {\r\n        return this.autoselect || this.form?.autoselect;\r\n    }\r\n\r\n    get isAutovalidate() {\r\n        return this.autovalidate || this.form?.autovalidate;\r\n    }\r\n    \r\n    get isAutoreport() {\r\n        return this.autoreport || this.form?.autoreport;\r\n    }\r\n\r\n    async load(url = '') {\r\n        if (!url) return;\r\n        this.value = await GSLoader.loadSafe(url, 'GET', null, true);\r\n    }\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDataListExt class\r\n * @module components/ext/GSDataListExt\r\n */\r\n\r\nimport { OWNER, PARENT } from \"../../base/GSConst.mjs\";\r\nimport { GSDOM } from \"../../base/GSDOM.mjs\";\r\nimport { GSLoader } from \"../../base/GSLoader.mjs\";\r\nimport { GSEvents } from \"../../base/GSEvents.mjs\";\r\nimport { GSAttr } from \"../../base/GSAttr.mjs\";\r\nimport { GSUtil } from \"../../base/GSUtil.mjs\";\r\nimport { mixin } from \"./EventsMixin.mjs\";\r\nimport { GSLog } from \"../../base/GSLog.mjs\";\r\nimport { ControllerHandler } from \"./ControllerHandler.mjs\";\r\n\r\n/**\r\n * Add JSON loader to select element\r\n * <select is=\"gs-ext-select\" data=\"data.json\">\r\n * \r\n * [{text:'', value:'' selected:true}]\r\n * \r\n * @class\r\n * @extends {HTMLSelectElement}\r\n */\r\nexport class GSExtSelectElement extends HTMLSelectElement {\r\n\r\n    static {\r\n        mixin(GSExtSelectElement);\r\n        GSDOM.define('gs-ext-select', GSExtSelectElement, { extends: 'select' });\r\n        Object.seal(GSExtSelectElement);\r\n    }\r\n\r\n    #data = [];\r\n\r\n    #controllerHandler = undefined;\r\n    #hasUpdated = false;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#controllerHandler = new ControllerHandler(this);\r\n    }\r\n\r\n    static get observedAttributes() {\r\n        return ['url'];\r\n    }\r\n\r\n    connectedCallback() {\r\n        const me = this;\r\n        me.#controllerHandler?.connectedCallback();\r\n        me.#preupdate();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        const me = this;\r\n        me.#controllerHandler?.disconnectedCallback();\r\n        me.#controllerHandler = undefined;\r\n        GSEvents.detachListeners(me);\r\n    }\r\n\r\n    attributeChangedCallback(name, oldValue, newValue) {\r\n        const me = this;\r\n        me.#preupdate(name);\r\n        me.willUpdate(name, oldValue, newValue);\r\n        me.#controllerHandler?.hostUpdated(name);\r\n    }\r\n\r\n    #preupdate(name) {\r\n        const me = this;\r\n        if (!me.#hasUpdated) {\r\n            me.firstUpdated(name);\r\n            me.#controllerHandler?.hostUpdated(name);\r\n            me.#hasUpdated = true;\r\n        }\r\n    }\r\n\r\n    firstUpdated(changed) {\r\n        const me = this;\r\n        const data = me.form?.data;\r\n        if (data) GSDOM.fromObject2Element(me, data);\r\n        if (me.autofocus) me.focus();\r\n        me.on('reset', me.#onReset);\r\n    }\r\n\r\n    willUpdate(changed, oldValue, newValue) {\r\n\r\n        if (changed === 'url') this.load(newValue);\r\n        if (changed === 'required' || changed === 'disabled') {\r\n            this.#validate();\r\n        }\r\n    }\r\n\r\n    addController(controller) {\r\n        this.#controllerHandler?.addController(controller);\r\n    }\r\n\r\n    removeController(controller) {\r\n        this.#controllerHandler?.removeController(controller);\r\n    }\r\n\r\n    get owner() {\r\n        return this[OWNER]();\r\n    }\r\n\r\n    get parentComponent() {\r\n        return this[PARENT]();\r\n    }    \r\n\r\n    get asJSON() {\r\n        return this.query('option').forEach(el => GSDOM.fromElement2Object(el, {}));\r\n    }\r\n\r\n    set asJSON(data) {\r\n        this.apply(data);\r\n    }\r\n\r\n    get toggling() {\r\n        return this.hasAttribute('toggling');\r\n    }\r\n\r\n    set toggling(value) {\r\n        GSAttr.toggle(this, 'toggling', value);\r\n    }\r\n\r\n    /**\r\n     * Storage records key to use to generate unique list\r\n     */\r\n    get key() {\r\n        return GSAttr.get(this, 'key', 0);\r\n    }\r\n\r\n    get storage() {\r\n        return GSAttr.get(this, 'storage');\r\n    }\r\n\r\n    get form() {\r\n        const me = this;\r\n        return super.form || me.owner?.form || me.closest?.('form');\r\n    }\r\n\r\n    /**\r\n     * Support for multiple selections\r\n     */\r\n    get values() {\r\n        return Array.from(this.selectedOptions).map(el => el.value);\r\n    }\r\n\r\n    /**\r\n     * String array ov values to match for selection\r\n     */\r\n    set values(values) {\r\n        values ??= [];\r\n        if (GSUtil.isString(values)) values = values.split(',');\r\n        Array.from(el.options).forEach(el => el.selected = values.indexOf(el.value) > -1);\r\n    }\r\n\r\n    checkValidity() {\r\n        this.#validate();\r\n        return super.checkValidity();\r\n    }\r\n\r\n    reportValidity() {\r\n        this.#validate();\r\n        return super.reportValidity();\r\n    }\r\n\r\n    #validate(e) {\r\n        return this.#controllerHandler.validate(e);\r\n    }\r\n\r\n    reset() {\r\n        GSDOM.resetSelect(this);\r\n    }\r\n        \r\n    /**\r\n     * For DataController read callback\r\n     * Convert record data to html JSON format \r\n     * @param {Array} data \r\n     */\r\n    onDataRead(data = []) {\r\n        const me = this;\r\n        const key = me.key;\r\n        data = Array.isArray(data) ? data : [data];\r\n        data = data.map(o => GSUtil.isString(o) ? o : o[key])\r\n            .filter(v => v)\r\n            .map(v => {return {text: v, value: v}});\r\n        me.apply(data);\r\n    }\r\n\r\n    /**\r\n     * Load html definition in JSON format\r\n     * @param {string} url \r\n     * @returns \r\n     */\r\n    async load(url = '') {\r\n        if (!url) return;\r\n        try {\r\n            const data = await GSLoader.loadSafe(url, 'GET', null, true);\r\n            this.apply(data);\r\n        } catch (error) {\r\n            console.error('Failed to load data:', error);\r\n            GSLog.error(this, error);\r\n        }\r\n    }\r\n\r\n    apply(data) {\r\n\r\n        if (!Array.isArray(data)) return false;\r\n\r\n        const me = this;\r\n\r\n        queueMicrotask(() => {\r\n\r\n            const list = [];\r\n            data.forEach(o => {\r\n                list.push(me.#objToHTML(o));\r\n            });\r\n\r\n            GSDOM.setHTML(me, list.join('\\n'));\r\n        });\r\n        return true;\r\n    }\r\n\r\n    #objToHTML(o) {\r\n        const seg = ['<option'];\r\n\r\n        Object.entries(o).forEach(it => {\r\n            const key = it[0];\r\n            const val = it[1];\r\n            if ('text' === key) return;\r\n            if ('selected' === key) return seg.push(key);\r\n            seg.push(`${key}=\"${val}\"`);\r\n        });\r\n\r\n        seg.push('>')\r\n        seg.push(o.text);\r\n        seg.push('</option>')\r\n\r\n        return seg.join(' ');\r\n    }\r\n\r\n    #onReset(e) {\r\n        this.reset();\r\n    }\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDataListElement class\r\n * @module components/ext/GSDataListElement\r\n */\r\n\r\nimport { OWNER, PARENT } from \"../../base/GSConst.mjs\";\r\nimport { GSID } from \"../../base/GSID.mjs\";\r\nimport { GSDOM } from \"../../base/GSDOM.mjs\";\r\nimport { GSUtil } from \"../../base/GSUtil.mjs\";\r\nimport { GSLoader } from \"../../base/GSLoader.mjs\";\r\nimport { GSEvents } from \"../../base/GSEvents.mjs\";\r\nimport { GSLog } from \"../../base/GSLog.mjs\";\r\nimport { GSAttr } from \"../../base/GSAttr.mjs\";\r\nimport { mixin } from \"./EventsMixin.mjs\";\r\nimport { ControllerHandler } from \"./ControllerHandler.mjs\";\r\n\r\n/**\r\n * Add JSON loader to datalist element\r\n * \r\n * <datalist is=\"gs-datalist\" data=\"data.json\">\r\n * \r\n * [{text:'', value:'' selected:true}]\r\n * \r\n * @class\r\n * @extends {HTMLDataListElement}\r\n */\r\nexport class GSExtDataListElement extends HTMLDataListElement {\r\n\r\n    static {\r\n        mixin(GSExtDataListElement);\r\n        GSDOM.define('gs-ext-datalist', GSExtDataListElement, { extends: 'datalist' });\r\n        Object.seal(GSExtDataListElement);\r\n    }\r\n\r\n    #data = [];\r\n\r\n    #controllerHandler = undefined;\r\n    #hasUpdated = false;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#controllerHandler = new ControllerHandler(this);\r\n    }\r\n\r\n    static get observedAttributes() {\r\n        return ['url'];\r\n    }\r\n\r\n    connectedCallback() {\r\n        const me = this;\r\n        GSID.setIf(me);\r\n        me.#controllerHandler?.connectedCallback();\r\n        me.#preupdate();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        const me = this;\r\n        me.#controllerHandler?.disconnectedCallback();\r\n        me.#controllerHandler = undefined;\r\n        GSEvents.detachListeners(me);\r\n    }\r\n\r\n    attributeChangedCallback(name, oldValue, newValue) {\r\n        const me = this;\r\n        me.#preupdate(name);\r\n        me.willUpdate(name, oldValue, newValue);\r\n        me.#controllerHandler?.hostUpdated(name);\r\n    }\r\n\r\n    #preupdate(name) {\r\n        const me = this;\r\n        if (!me.#hasUpdated) {\r\n            me.firstUpdated(name);\r\n            me.#controllerHandler?.hostUpdated(name);\r\n            me.#hasUpdated = true;\r\n        }\r\n    }\r\n   \r\n    firstUpdated(changed) {\r\n        const me = this;\r\n        if (me.autofocus) me.focus();\r\n        const data = me.form?.data;\r\n        if (data) GSDOM.fromObject2Element(me, data);\r\n    }\r\n\r\n    willUpdate(changed, oldValue, newValue) {\r\n\r\n        if (changed === 'url') this.load(newValue);\r\n        if (changed === 'required' || changed === 'disabled') {\r\n            this.validate();\r\n        }\r\n    }\r\n\r\n    addController(controller) {\r\n        this.#controllerHandler?.addController(controller);\r\n    }\r\n\r\n    removeController(controller) {\r\n        this.#controllerHandler?.removeController(controller);\r\n    }\r\n    \r\n    get owner() {\r\n        return this[OWNER]();\r\n    }\r\n\r\n    get parentComponent() {\r\n        return this[PARENT]();\r\n    }    \r\n\r\n    get asJSON() {\r\n        return this.query('option').forEach(el => GSDOM.fromElement2Object(el, {}));\r\n    }\r\n\r\n    set asJSON(data) {\r\n        this.apply(data);\r\n    }\r\n\r\n    get storage() {\r\n        return GSAttr.get(this, 'storage');\r\n    }\r\n\r\n    /**\r\n     * Storage records key to use to generate unique list\r\n     */\r\n    get key() {\r\n        return GSAttr.get(this, 'key', 0);\r\n    }   \r\n\r\n    /**\r\n     * For DataController read callback\r\n     * Convert record data to html JSON format \r\n     * \r\n     * @param {Array} data \r\n     */\r\n    onDataRead(data = []) {\r\n        const me = this;\r\n        const key = me.key;\r\n        data = Array.isArray(data) ? data : [data];\r\n        data = data.map(o => GSUtil.isString(o) ? o : o[key])\r\n            .filter(v => v)\r\n            .map(v => {return {value: v}});\r\n        me.apply(data);\r\n    }   \r\n\r\n    /**\r\n     * Load html definition in JSON format\r\n     * @param {string} url \r\n     * @returns \r\n     */\r\n    async load(url = '') {\r\n        if (!url) return;\r\n        try {\r\n            const data = await GSLoader.loadSafe(url, 'GET', null, true);\r\n            this.apply(data);\r\n        } catch (error) {\r\n            console.error('Failed to load data:', error);\r\n            GSLog.error(this, error);\r\n        }\r\n    }\r\n\r\n    apply(data) {\r\n\r\n        if (!Array.isArray(data)) return false;\r\n\r\n        const me = this;\r\n\r\n        queueMicrotask(() => {\r\n\r\n            const list = [];\r\n            data.forEach(o => {\r\n                list.push(me.#objToHTML(o));\r\n            });\r\n\r\n            GSDOM.setHTML(me, list.join('\\n'));\r\n        });\r\n        return true;\r\n    }\r\n\r\n    #objToHTML(o) {\r\n        const seg = ['<option'];\r\n\r\n        if (GSUtil.isString(o)) o = { value: o };\r\n\r\n        Object.entries(o).forEach(it => {\r\n            const key = it[0];\r\n            const val = it[1];\r\n            if ('text' === key) return;\r\n            if ('selected' === key) return seg.push(key);\r\n            seg.push(`${key}=\"${val}\"`);\r\n        });\r\n\r\n        if (o.text) {\r\n            seg.push('>')\r\n            seg.push(o.text);\r\n            seg.push('</option>')\r\n        } else {\r\n            seg.push('>')\r\n        }\r\n\r\n        return seg.join(' ');\r\n    }\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDataListExt class\r\n * @module components/ext/GSDataListExt\r\n */\r\n\r\nimport { OWNER, PARENT, HANDLER } from \"../../base/GSConst.mjs\";\r\nimport { GSDOM } from \"../../base/GSDOM.mjs\";\r\nimport { GSEvents } from \"../../base/GSEvents.mjs\";\r\nimport { GSAttr } from \"../../base/GSAttr.mjs\";\r\nimport { ControllerHandler } from \"./ControllerHandler.mjs\";\r\nimport { mixin } from './EventsMixin.mjs';\r\nimport { GSLog } from \"../../base/GSLog.mjs\";\r\nimport { GSLoader } from \"../../base/GSLoader.mjs\";\r\nimport { GSUtil } from \"../../base/GSUtil.mjs\";\r\n\r\n/**\r\n * Extended native forn with additional functionality\r\n * \r\n * @class\r\n * @extends { HTMLFormElement }\r\n */\r\nexport class GSExtFormElement extends HTMLFormElement {\r\n\r\n    static {\r\n        mixin(GSExtFormElement);\r\n        GSDOM.define('gs-ext-form', GSExtFormElement, { extends: 'form' });\r\n        Object.seal(GSExtFormElement);\r\n    }\r\n\r\n    static get observedAttributes() {\r\n        return ['url', 'disabled'];\r\n    }\r\n\r\n    #hasUpdated = false;\r\n\r\n    onvalid = undefined;\r\n    \r\n    constructor() {\r\n        super();\r\n        this[HANDLER] = new ControllerHandler(this);\r\n    }\r\n\r\n    connectedCallback() {\r\n        const me = this;\r\n        me.#controllerHandler?.connectedCallback?.();\r\n        me.#preupdate();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        const me = this;\r\n        me.#controllerHandler?.disconnectedCallback?.();\r\n        me[HANDLER] = undefined;\r\n        GSEvents.detachListeners(me);\r\n    }\r\n\r\n    attributeChangedCallback(name, oldValue, newValue) {\r\n        const me = this;\r\n        me.#preupdate(name);\r\n        me.willUpdate(name, oldValue, newValue);\r\n        me.#controllerHandler?.hostUpdated?.(name);\r\n    }\r\n\r\n    #preupdate(name) {\r\n        const me = this;\r\n        if (!me.#hasUpdated) {\r\n            me.firstUpdated(name);\r\n            me.#controllerHandler?.hostUpdated?.(name);\r\n            me.#hasUpdated = true;\r\n        }\r\n    }\r\n\r\n    firstUpdated(changed) {\r\n        const me = this;\r\n        const data = me.formComponent?.data;\r\n        if (data) GSDOM.fromObject2Element(me, data);\r\n        if (me.autofocus) me.focus();\r\n    }\r\n\r\n    willUpdate(changed, oldValue, newValue) {\r\n        const me = this;\r\n        if (changed === 'url') me.load(newValue);\r\n        if (changed === 'disabled') {\r\n            me.disabled ? me.disable() : me.enable();\r\n        }\r\n    }\r\n\r\n    addController(controller) {\r\n        this.#controllerHandler?.addController(controller);\r\n    }\r\n\r\n    removeController(controller) {\r\n        this.#controllerHandler?.removeController(controller);\r\n    }\r\n\r\n    reset() {\r\n        const me = this;\r\n        // reset shadowed\r\n        me.inputs\r\n        .filter(el => GSDOM.isShadowed(el))\r\n        .forEach(el => GSDOM.reset(el));\r\n        // reset non shadowed\r\n        super.reset();        \r\n    }\r\n\r\n    /**\r\n     * Check validity of the form and each individual field, \r\n     * return true only if all valid.\r\n     * Trigger 'invalid' event on invalid fields.\r\n     * \r\n     * @returns {Boolean} Returns true if form is valid\r\n     */\r\n    checkValidity() {\r\n        return super.checkValidity() &&\r\n                this.inputs\r\n                .filter(el => !el.disabled)\r\n                .every(el => el.checkValidity());\r\n    }\r\n\r\n    /**\r\n     * The same as checkValidity, but also shows validation messages\r\n     * @returns {Boolean} Returns true if form is valid\r\n     */\r\n    reportValidity() {\r\n        return super.reportValidity() &&\r\n                this.inputs\r\n                .filter(el => !el.disabled)\r\n                .every(el => el.reportValidity());\r\n    }\r\n\r\n    /**\r\n     * Find field by name\r\n     * @param {*} name \r\n     * @returns \r\n     */\r\n    field(name) {\r\n        return name && this.inputs.filter(f => f.name === name);\r\n    }\r\n\r\n    disable() {\r\n        const me = this;\r\n        GSDOM.disableInput(me);\r\n        me.emit(\"disabled\");        \r\n    }\r\n\r\n    enable() {\r\n        const me = this;\r\n        GSDOM.enableInput(me);\r\n        me.emit(\"enabled\");\r\n    }\r\n\r\n    async load(url = '') {\r\n        if (!url) return;\r\n        try {\r\n            const data = await GSLoader.loadSafe(url, 'GET', null, true);\r\n            this.onDataRead(data);\r\n        } catch (error) {\r\n            console.error('Failed to load data:', error);\r\n            GSLog.error(this, error);\r\n        }\r\n    }\r\n\r\n    #button(type) {\r\n        return this.queryAll(`button[type=\"${type}\"]`, true);\r\n    }\r\n\r\n    #childrens(shadow = false) {\r\n        return this.queryAll('input,select,output,textarea', shadow);\r\n    }\r\n\r\n    get owner() {\r\n        return this[OWNER]();\r\n    }\r\n\r\n    get parentComponent() {\r\n        return this[PARENT]();\r\n    }    \r\n\r\n    get hasUpdated() {\r\n        return this.#hasUpdated;\r\n    }\r\n\r\n    get asJSON() {\r\n        const data = {};\r\n        this.inputs.forEach(field => GSDOM.fromElement2Object(field, data));\r\n        return data;\r\n    }\r\n\r\n    set asJSON(data) {\r\n        const me = this;\r\n        me.inputs.forEach(field => GSDOM.fromObject2Element(field, data));\r\n        me.#controllerHandler?.validate();\r\n    }\r\n\r\n    get autocopy() {\r\n        return this.hasAttribute('autocopy');\r\n    }\r\n    \r\n    get autoselect() {\r\n        return this.hasAttribute('autoselect');\r\n    }\r\n\r\n    /**\r\n     * If set, automatically calls reportValidity\r\n     */\r\n    get autoreport() {\r\n        return this.hasAttribute('autoreport');\r\n    }\r\n\r\n    /**\r\n     * If set, automatically calls checkValidity\r\n     */\r\n    get autovalidate() {\r\n        return this.hasAttribute('autovalidate');\r\n    }\r\n\r\n    /**\r\n     * If set, automatically submit form on field enter.\r\n     * Forms auto submit only if there is a input or a button of type=\"submit\"\r\n     */\r\n    get autosubmit() {\r\n        return this.hasAttribute('autosubmit');\r\n    }\r\n\r\n    get block() {\r\n        return this.hasAttribute('block');\r\n    }\r\n\r\n    get beep() {\r\n        return this.hasAttribute('beep');\r\n    }\r\n\r\n    get timeout() {\r\n        return GSAttr.getAsNum(this, 'timeout', 0);\r\n    }\r\n\r\n    get disabled() {\r\n        return this.hasAttribute('disabled');\r\n    }\r\n\r\n    set disabled(value) {\r\n        GSAttr.toggle(this, 'disabled', GSUtil.asBool(value));\r\n    }\r\n\r\n    set autocopy(value) {\r\n        GSAttr.toggle(this, 'autocopy', GSUtil.asBool(value));\r\n    }\r\n\r\n    set autoselect(value) {\r\n        GSAttr.toggle(this, 'autoselect', GSUtil.asBool(value));\r\n    }\r\n\r\n    set autoreport(value) {\r\n        GSAttr.toggle(this, 'autoreport', GSUtil.asBool(value));\r\n    }\r\n\r\n    set autovalidate(value) {\r\n        GSAttr.toggle(this, 'autovalidate', GSUtil.asBool(value));\r\n    }\r\n\r\n    set autosubmit(value) {\r\n        GSAttr.toggle(this, 'autosubmit', GSUtil.asBool(value));\r\n    }\r\n\r\n    set block(val = false) {\r\n        GSAttr.toggle(this, 'block', GSUtil.asBool(val));\r\n    }\r\n\r\n    set beep(val = false) {\r\n        GSAttr.toggle(this, 'beep', GSUtil.asBool(val));\r\n    }\r\n\r\n    set timeout(val = 0) {\r\n        return GSAttr.setAsNum(this, 'timeout', val);\r\n    }\r\n\r\n    get submitButton() {\r\n        return this.#button('submit');\r\n    }\r\n\r\n    get resetButton() {\r\n        return this.#button('reset');\r\n    }\r\n\r\n    /**\r\n     * Pickup all form elements, including custom ones\r\n     */\r\n    get elements() {\r\n        return super.elements;\r\n    }\r\n\r\n    /**\r\n     * Get all form attached native fields unwrapepd from GSWebComponents\r\n     */\r\n    get fields() {\r\n        return Array.from(this.elements).map(el => el.field || el);\r\n    }\r\n\r\n    /**\r\n     * Find all inputs by querying across inner shadow \r\n     */\r\n    get inputs() {\r\n        return this.#childrens(true);\r\n    }\r\n\r\n    get invalid() {\r\n        return this.inputs\r\n        .filter(el => !el.disabled)\r\n        .filter(el => !el.validity.valid);\r\n    }\r\n\r\n    get isValid() {\r\n        return this.invalid.length === 0;\r\n    }\r\n\r\n    get #controllerHandler() {\r\n        return this[HANDLER];\r\n    }\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { html, ifDefined, repeat } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { color } from '../../properties/color.mjs';\r\n\r\nexport class GSBreadcrumbElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    data: { type: Array },\r\n    color: { ...color },\r\n    divider: { reflect: true },\r\n    spacing: { reflect: true, type: Number },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.spacing = 1;\r\n    me.divider = 'chevron-right';\r\n    me.#updateChildren();\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    this.#updateChildren();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<nav part=\"base\" class=\"breadcrumb\" @click=\"${me.#onClick}\" dir=\"${ifDefined(me.direction)}\"><slot>\r\n      ${repeat(me.data || [], (item) => item, (item) => html`\r\n        <gs-breadcrumb-item  \r\n        href=\"${item.href}\"\r\n        color=\"${item.color}\"\r\n        .data=${item}     \r\n        .active=${item.active}\r\n        .divider=\"${item.divider || me.divider}\"\r\n        .spacing=\"${item.spacing || me.spacing}\">\r\n          ${item.$text}\r\n        </gs-breadcrumb-item>\r\n      `)}\r\n    </slot></nav>`;\r\n  }\r\n\r\n  onDataRead(data) {\r\n    this.data = data;\r\n  }\r\n\r\n  #updateChildren() {\r\n    const me = this;\r\n    me.queryAll('gs-breadcrumb-item').forEach(el => {\r\n      el.divider = me.divider;\r\n      el.spacing = me.spacing;\r\n      el.color = me.color;\r\n    });\r\n  }\r\n\r\n  #onClick(e) {\r\n    const el = e.target.closest('gs-bradcrumb-item');\r\n    el?.handle(e);\r\n  } \r\n\r\n  static {\r\n    this.define('gs-breadcrumb');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { color } from '../../properties/color.mjs';\r\nimport { GSLinklement } from '../Link.mjs';\r\nimport { GSAttributeHandler } from '../../base/GSAttributeHandler.mjs';\r\n\r\nexport class GSBreadcrumbItemElement extends GSElement {\r\n\r\n  static properties = {\r\n    href: {},\r\n    color: { ...color },\r\n    data: { state: true, type: Object },\r\n    active: { reflect: true, type: Boolean },\r\n    divider: { state: true, type: Boolean },\r\n    spacing: { state: true, type: Number },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.data = {};\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div part=\"base\" class=\"breadcrumb-item ${classMap(me.renderClass())}\"  dir=\"${ifDefined(me.direction)}\">\r\n        <span part=\"prefix\"><slot name=\"prefix\"></slot></span>        \r\n        ${me.#label}\r\n        <span part=\"suffix\"><slot name=\"suffix\"></slot></span>\r\n        <span part=\"separator\"><slot name=\"separator\">${me.#separator}</slot></span>\r\n      </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'active': me.active,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  get #label() {\r\n    const me = this;\r\n    if (me.active) return html`<slot></slot>`;\r\n    me.data.url = me.data.url || me.href;\r\n    me.data.part = 'label';\r\n    return GSLinklement.generate(me.data, {})\r\n  }\r\n\r\n  get #separator() {\r\n    const me = this;\r\n    return me.nextElementSibling && me.divider ? html`<gs-icon size=\"7\" color=\"${me.color}\" css=\"mx-${me.spacing}\" name=\"${me.divider}\"></gs-icon>` : '';\r\n  }\r\n\r\n  handle(e) {\r\n    GSAttributeHandler.process(this.query('a', true), e);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-breadcrumb-item');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from '../../base/GSUtil.mjs';\r\nimport { GSEvents } from '../../base/GSEvents.mjs';\r\n\r\n/**\r\n * A module loading GSAttachment class\r\n * @module components/filebox/GSAttachment\r\n */\r\n\r\n/**\r\n * Handles DataFileTransfer object\r\n * @class\r\n */\r\nexport class GSAttachment {\r\n\r\n    #directory = null;\r\n    #file = null;\r\n\r\n    constructor(file, directory) {\r\n        this.#file = file;\r\n        this.#directory = directory;\r\n    }\r\n\r\n    get file() {\r\n        return this.#file;\r\n    }\r\n\r\n    get directory() {\r\n        return this.#directory;\r\n    }\r\n\r\n    get fullPath() {\r\n        const me = this;\r\n        return me.directory ? `${me.directory}/${me.file.name}` : me.file.name;\r\n    }\r\n\r\n    get isImage() {\r\n        return GSAttachment.isImageType(this.file.type);\r\n    }\r\n\r\n    get isVideo() {\r\n        return GSAttachment.isVideoType(this.file.type);\r\n    }\r\n\r\n    get isText() {\r\n        return GSAttachment.isTextType(this.file.type);\r\n    }\r\n\r\n    static isImageType(type) {\r\n        return ['image/gif', 'image/png', 'image/jpg', 'image/jpeg', 'image/svg+xml'].includes(type);\r\n    }\r\n\r\n    static isVideoType(type) {\r\n        return ['video/mp4', 'video/quicktime'].includes(type);\r\n    }\r\n\r\n    static isTextType(type) {\r\n        return ['application/json', 'text/plain', 'text/html', 'image/svg+xml'].includes(type);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {DataTransfer} transfer \r\n     * @param {boolean} directory \r\n     * @returns \r\n     */\r\n    static traverse(transfer, directory) {\r\n        return GSAttachment.#transferredFiles(transfer, directory);\r\n    }\r\n\r\n    /**\r\n     * Create GSAttachment array from File array\r\n     * @param {File[]} files \r\n     * @returns {GSAttachment[]}\r\n     */\r\n    static from(files) {\r\n        return Array.from(files).filter(f => f instanceof File).map(f => new GSAttachment(f));\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {DataTransfer} transfer \r\n     * @param {boolean} directory \r\n     * @returns \r\n     */    \r\n    static #transferredFiles(transfer, directory) {\r\n        if (directory && GSAttachment.#isDirectory(transfer)) {\r\n            return GSAttachment.#traverse('', GSAttachment.#roots(transfer));\r\n        }\r\n        return Promise.resolve(GSAttachment.#visible(Array.from(transfer.files || [])).map(f => new GSAttachment(f)));\r\n    }\r\n\r\n    /**\r\n     * Check if file is hidden (Unix-like hidden file)\r\n     * @param {File} file \r\n     * @returns {boolean}\r\n     */\r\n    static #hidden(file) {\r\n        return file.name.startsWith('.');\r\n    }\r\n\r\n    /**\r\n     * Filter out hidden files\r\n     * @param {File} files \r\n     * @returns {File[]}\r\n     */\r\n    static #visible(files) {\r\n        return Array.from(files).filter(file => !GSAttachment.#hidden(file));\r\n    }\r\n\r\n    /**\r\n     * Get File from FileSystemEntry\r\n     * @param {FileSystemEntry} entry \r\n     * @returns {Promise<File>}\r\n     */\r\n    static #getFile(entry) {\r\n        return new Promise((resolve, reject) => {\r\n            entry.file(resolve, reject);\r\n        });\r\n    }\r\n\r\n    static #getEntries(entry) {\r\n        return new Promise((resolve, reject) => {\r\n            const result = [];\r\n            const reader = entry.createReader();\r\n            const read = () => {\r\n                reader.readEntries(entries => {\r\n                    if (entries.length > 0) {\r\n                        result.push(...entries);\r\n                        read();\r\n                    } else {\r\n                        resolve(result);\r\n                    }\r\n                }, reject);\r\n            };\r\n            read();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Recursively traverse directory entries\r\n     * @param {string} path \r\n     * @param {FileSystemEntry[]} entries \r\n     * @returns {Promise<GSAttachment[]>}\r\n     */\r\n    static async #traverse(path, entries) {\r\n        const results = [];\r\n        for (const entry of GSAttachment.#visible(entries)) {\r\n            if (entry.isDirectory) {\r\n                const entries = await GSAttachment.#getEntries(entry);\r\n                const list = await GSAttachment.#traverse(entry.fullPath, entries);\r\n                results.push(...(list));\r\n            } else {\r\n                const file = await GSAttachment.#getFile(entry);\r\n                results.push(new GSAttachment(file, path));\r\n            }\r\n        }\r\n        return results;\r\n    }\r\n\r\n    /**\r\n     * Check if DataTransfer contains directory\r\n     * @param {DataTransfer} transfer \r\n     * @returns {boolean}\r\n     */\r\n    static #isDirectory(transfer) {\r\n        return Array.from(transfer.items).some((item) => {\r\n            const entry = item.webkitGetAsEntry?.();\r\n            return entry?.isDirectory;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Destructure DataTransfer items into FileSystemEntries\r\n     * @param {DataTransfer} transfer \r\n     * @returns {FileSystemEntry[]}\r\n     */\r\n    static #roots(transfer) {\r\n        return Array.from(transfer.items)\r\n            .map((item) => item.webkitGetAsEntry?.())\r\n            .filter(entry => entry != null);\r\n    }\r\n\r\n\r\n    /**\r\n     * Upload a file using file input dialog\r\n     * @param {String} mime - optional mime type filter\r\n     * @param {Boolean} forceBinary - if true, read file as binary (Uint8Array); otherwise autodetect text/binary\r\n     * @returns {String|Uint8Array|null} file content as string or binary; null if no file selected\r\n     */\r\n    static async upload(mime = '*/*', forceBinary = false) {\r\n        const input = document.createElement('input');\r\n        input.type='file';\r\n        input.accept= mime;\r\n        input.style.display='none';\r\n        document.body.appendChild(input);\r\n        input.click();\r\n\r\n        await GSEvents.wait(input, 'change', 0, false);\r\n\r\n        try {\r\n            if (input.files.length === 0) return null;\r\n\r\n            const file = input.files.item(0);\r\n            const isText = forceBinary ? false : GSAttachment.isTextType(file.type);\r\n\r\n            const reader = new FileReader();\r\n            isText ? reader.readAsText(file) : reader.readAsArrayBuffer(file)\r\n            await GSEvents.wait(reader, 'loadend', 0, false);\r\n\r\n            if (reader.readyState === FileReader.DONE) {\r\n                return isText ? reader.result : new Uint8Array(reader.result);\r\n            }\r\n        } finally {\r\n            document.body.removeChild(input);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Download a file using blob link\r\n     * @param {string} filename \r\n     * @param {string|Uint8Array} content Supporting string/json or binary content\r\n     * @param {string} mime - optional mime type; if not defined, selfdetect from content\r\n     */\r\n    static download(filename, content, mime) {\r\n        if (!content) throw new Error('No content to download');\r\n        mime = mime || GSAttachment.toMime(content) || 'application/octet-stream';\r\n        filename = filename || `file-${Date.now()}.${GSAttachment.mimeToExt(mime)}`;\r\n        const opt = GSUtil.isString(content) ? { type: mime, encoding: \"UTF-8\" } : { type: mime };\r\n        const blob = new Blob([content], opt);\r\n        const ourl = globalThis.URL.createObjectURL(blob);\r\n        const link = document.createElement('a');\r\n        try {\r\n            link.href = ourl;\r\n            link.download = filename;\r\n            document.body.appendChild(link);\r\n            link.click();\r\n        } finally {\r\n            document.body.removeChild(link);\r\n            globalThis.URL.revokeObjectURL(ourl);\r\n        }   \r\n    }\r\n\r\n    /**\r\n     * Get file extension from mime type\r\n     * @param {string} mime \r\n     * @returns {string} file extension without dot\r\n     */\r\n    static mimeToExt(mime) {\r\n        return {\r\n            'application/octet-stream' : 'bin',\r\n            'application/json' : 'json',\r\n            'text/plain' : 'txt',\r\n            'text/html' : 'html',\r\n            'image/png' : 'png',\r\n            'image/jpeg' : 'jpg',\r\n            'image/gif' : 'gif',\r\n            'image/webp' : 'webp',\r\n            'image/svg+xml' : 'svg',\r\n            'application/pdf' : 'pdf',\r\n            'video/mp4' : 'mp4'\r\n        }[mime] || 'bin';\r\n    }\r\n    /**\r\n     * Detect mime type from content\r\n     * @param {string|Uint8Array} content Supporting string/json or binary content\r\n     */\r\n    static toMime(content) {\r\n        if (GSUtil.isString(content)) {\r\n            content = content.trim();\r\n            if (GSUtil.isJsonString(content)) return 'application/json';\r\n            if (content.startsWith('<svg') || content.startsWith('<?xml') || content.startsWith('<!DOCTYPE svg')) return 'image/svg+xml';\r\n            if ( content.startsWith('<!DOCTYPE html') || content.startsWith('<html')) return 'text/html';\r\n            return 'text/plain';\r\n        } else if (content instanceof Uint8Array) {\r\n            // very basic binary file type detection\r\n            if (content.length > 4) {\r\n                // PNG\r\n                if (content[0] === 0x89 && content[1] === 0x50 && content[2] === 0x4E && content[3] === 0x47) return 'image/png';\r\n                // JPG\r\n                if (content[0] === 0xFF && content[1] === 0xD8 && content[2] === 0xFF) return 'image/jpeg';\r\n                // GIF\r\n                if (content[0] === 0x47 && content[1] === 0x49 && content[2] === 0x46) return 'image/gif';\r\n                // webp\r\n                if (content[0] === 0x52 && content[1] === 0x49 && content[2] === 0x46 && content[3] === 0x46) return 'image/webp';\r\n                // PDF\r\n                if (content[0] === 0x25 && content[1] === 0x50 && content[2] === 0x44 && content[3] === 0x46) return 'application/pdf';\r\n                // MP4\r\n                if (content[0] === 0x00 && content[1] === 0x00 && content[2] === 0x00 && content[3] === 0x18) return 'video/mp4';\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSFileBox class\r\n * @module components/filebox/GSFileBox\r\n */\r\n\r\nimport { classMap, createRef, ref, css, html, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSAttachment } from './Attachment.mjs';\r\nimport { GSEvents } from '../../base/GSEvents.mjs';\r\n\r\n/**\r\n * File box allows drag-n-drop fiels for upload\r\n * <gs-filebox id=\"other\" multiple=\"true\" directory=\"true\" elid=\"test\"></gs-filebox>\r\n * Use event listener to return false for file access filtering\r\n * @class\r\n * @extends {GSElement}\r\n */\r\nexport class GSFileBoxElement extends GSElement {\r\n\r\n    static TITLE = 'Drop file/s here or click to select';\r\n    static CSS = 'border-2 p-4 d-block text-center dash';\r\n\r\n    static properties = {\r\n        cssList: { attribute: 'css-list' },\r\n        cssLabel: { attribute: 'css-label' },\r\n        cssInput: { attribute: 'css-input' },\r\n\r\n        multiple: { reflect: true, type: Boolean },\r\n        directory: { reflect: true, type: Boolean },\r\n        name: {},\r\n        title: {},\r\n        accept: {},\r\n        filter: {},\r\n        maxFileSize: { reflect: true, attribute: 'max-file-size', type: Number }, // New property\r\n    }\r\n\r\n    #listEl = createRef();\r\n    #fileEl = createRef();\r\n    #dragging = null;\r\n\r\n    constructor() {\r\n        super();\r\n        this.css = GSFileBoxElement.CSS;\r\n        this.cssInput = 'd-none';\r\n        this.multiple = true;\r\n        this.title = GSFileBoxElement.TITLE;\r\n        this.filter = '^image\\/(gif|png|jpeg)$'\r\n        this.directory = false;\r\n        this.maxFileSize = 0; // Default to 0, meaning no limit\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`\r\n        <div part=\"border\" class=\"${classMap(me.renderClass())}\"\r\n            dir=\"${ifDefined(me.direction)}\"\r\n            @click=\"${me.#onClick}\"\r\n            @dragenter=\"${me.#onDragenter}\"\r\n            @dragover=\"${me.#onDragenter}\"\r\n            @dragleave=\"${me.#onDragleave}\"\r\n            @drop=\"${me.#onDrop}\"\r\n            @paste=\"${me.#onPaste}\"\r\n            @change=\"${me.#onChange}\">\r\n            <label part=\"label\" class=\"${me.cssLabel}\" for=\"${me.name}\">${me.translate(me.title)}</label>\r\n            <input ${ref(me.#fileEl)}  part=\"input\" \r\n                type=\"file\" accept=\"${me.accept}\" \r\n                class=\"${me.cssInput}\" \r\n                name=\"${me.name}\" \r\n                id=\"${me.name}\" \r\n                ${me.multiple ? \"multiple\" : \"\"} \r\n                ${me.directory ? \"directory webkitdirectory\" : \"\"}>\r\n            <pre ${ref(me.#listEl)} part=\"list\" class=\"${me.cssList}\"></pre>\r\n        </div>\r\n        `\r\n    }\r\n\r\n    get listEl() {\r\n        return this.#listEl.value;\r\n    }\r\n\r\n    get fileEl() {\r\n        return this.#fileEl.value;\r\n    }\r\n\r\n    #onClick(e) {\r\n        this.fileEl.click();\r\n    }\r\n\r\n    #onDragenter(e) {\r\n        const me = this;\r\n        if (me.#dragging) clearTimeout(me.#dragging);\r\n        me.#dragging = setTimeout(() => me.removeAttribute('hover'), 200);\r\n        const transfer = e.dataTransfer;\r\n        if (!transfer || !me.#hasFile(transfer)) return;\r\n        transfer.dropEffect = 'copy';\r\n        me.setAttribute('hover', '');\r\n        e.preventDefault();\r\n    }\r\n\r\n    #onDragleave(e) {\r\n        const me = this;\r\n        if (e.dataTransfer) e.dataTransfer.dropEffect = 'none';\r\n        me.removeAttribute('hover');\r\n        GSEvents.prevent(e);\r\n    }\r\n\r\n    #onDrop(e) {\r\n        const me = this;\r\n        me.removeAttribute('hover');\r\n        const transfer = e.dataTransfer;\r\n        if (!transfer || !me.#hasFile(transfer)) return;\r\n        me.#attach(transfer);\r\n        GSEvents.prevent(e);\r\n    }\r\n\r\n    #onPaste(e) {\r\n        const me = this;\r\n        if (!e.clipboardData) return;\r\n        if (!e.clipboardData.items) return;\r\n        const file = me.#pastedFile(e.clipboardData.items);\r\n        if (!file) return;\r\n        const files = [file];\r\n        me.#attach(files);\r\n        GSEvents.prevent(e);\r\n    }\r\n\r\n    #onChange(e) {\r\n        const me = this;\r\n        const input = me.fileEl;\r\n        const files = input.files;\r\n        if (!files || files.length === 0) return;\r\n        me.#attach(files);\r\n        // input.value = '';\r\n    }\r\n\r\n    #hasFile(transfer) {\r\n        return Array.from(transfer.types).includes('Files');\r\n    }\r\n\r\n    #pastedFile(items) {\r\n        const me = this;\r\n        const rgx = me.filter ? new RegExp(me.filter) : null;\r\n        for (const item of items) {\r\n            if (item.kind === 'file') {\r\n                if (!rgx) return item.getAsFile();\r\n                if (rgx.test(item.type)) return item.getAsFile();\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    #accept(attachments) {\r\n        const me = this;\r\n        const dataTransfer = new DataTransfer();\r\n        attachments.forEach(a => dataTransfer.items.add(a.file))\r\n        me.fileEl.files = dataTransfer.files;\r\n        me.listEl.textContent = attachments.map(a => a.file.name).join('\\n');\r\n    }\r\n\r\n    async #attach(transferred) {\r\n        const me = this;\r\n        const isDataTfr = transferred instanceof DataTransfer;\r\n        const attachments = isDataTfr\r\n            ? await GSAttachment.traverse(transferred, me.directory)\r\n            : GSAttachment.from(transferred);\r\n\r\n        // Filter out files that exceed the maxFileSize\r\n        const validAttachments = me.maxFileSize > 0 \r\n            ? attachments.filter(a => a.file.size <= me.maxFileSize)\r\n            : attachments;\r\n\r\n        const accepted = me.emit('accept', { attachments: validAttachments }, true, false, true);\r\n        if (accepted && validAttachments.length) {\r\n            me.#accept(validAttachments);\r\n            me.emit('accepted', { attachments: validAttachments }, true);\r\n        }\r\n    }\r\n\r\n    static styles = css`\r\n        .dash {\r\n            border-style: var(--gs-fieldbox-border, dashed) !important;\r\n            border-color: var(--gs-fieldbox-border-color, lightgrey);\r\n        }\r\n        input[type=file] {\r\n            color : var(--gs-fieldbox-color, transparent);\r\n        } \r\n        input[type=file]::file-selector-button {}             \r\n        input[type=file]::file-selector-button:hover {}`;\r\n\r\n    static {\r\n        this.define('gs-filebox');\r\n    }\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSUtil } from '../../base/GSUtil.mjs';\r\n\r\n/**\r\n * A module rendering current time on a page\r\n * @module components/TimeFormat\r\n */\r\n\r\n/**\r\n * Render Time value\r\n * \r\n * @class\r\n * @extends {HTMLElement}\r\n */\r\nexport class GSTimeFormat extends GSElement {\r\n\r\n    static properties = {\r\n        interval: {reflect:true, type:Number},\r\n        language: {reflect:true},\r\n    }\r\n\r\n    #id = 0;\r\n\r\n    constructor() {\r\n        super();\r\n        this.interval = 1;\r\n        this.language = GSUtil.language;\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        this.start();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        this.stop();\r\n        super.disconnectedCallback();\r\n    }\r\n\r\n    renderUI() {\r\n        const date = new Date();\r\n        return date.toLocaleTimeString(this.language);\r\n    }    \r\n\r\n    start() {\r\n        const me = this;\r\n        if (me.interval >0 && me.#id === 0) {\r\n            me.#id = setInterval(me.#update.bind(me), me.interval * 1000);\r\n        } else {\r\n            me.requestUpdate();\r\n        }\r\n    }\r\n\r\n    stop() {\r\n        clearInterval(this.#id);\r\n        this.#id = 0;\r\n    }\r\n    \r\n    #update() {\r\n       requestAnimationFrame(() => this.requestUpdate());\r\n    }\r\n\r\n    static {\r\n        this.define('gs-time-format');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module rendering date with specific langauge support\r\n * @module components/DateFormat\r\n */\r\n\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSDate } from '../../base/GSDate.mjs';\r\n\r\n/**\r\n * Render Date value with international language support\r\n * \r\n * All options - set dasta-[name]; data-weekday etc...\r\n       {\r\n       weekday: 'narrow' | 'short' | 'long',\r\n       era: 'narrow' | 'short' | 'long',\r\n       year: 'numeric' | '2-digit',\r\n       month: 'numeric' | '2-digit' | 'narrow' | 'short' | 'long',\r\n       day: 'numeric' | '2-digit',\r\n       hour: 'numeric' | '2-digit',\r\n       minute: 'numeric' | '2-digit',\r\n       second: 'numeric' | '2-digit',\r\n       timeZoneName: 'short' | 'long',\r\n\r\n       // Time zone to express it in\r\n       timeZone: 'Asia/Shanghai',\r\n       // Force 12-hour or 24-hour\r\n       hour12: true | false,\r\n\r\n       dateStyle: full | long | medium | short\r\n       timeStyle: full | long | medium | short\r\n\r\n       // Rarely-used options\r\n       hourCycle: 'h11' | 'h12' | 'h23' | 'h24',\r\n       formatMatcher: 'basic' | 'best fit'\r\n       }\r\n * @class\r\n * @extends {HTMLElement}\r\n */\r\nexport class GSDateFormat extends GSElement {\r\n\r\n    static properties = {\r\n        value: {},\r\n        format: {},\r\n        language: {},\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.language = navigator.language;\r\n        this.value = new Date();\r\n    }\r\n\r\n    renderUI() {\r\n        return this.result;\r\n    }    \r\n\r\n    get result() {\r\n        const me = this;\r\n        const val = me.date;\r\n        if (me.format) return val.format(me.format);\r\n        return new Intl.DateTimeFormat(me.language, me.dataset).format(val);\r\n    }\r\n\r\n    get date() {\r\n        const me = this;\r\n        const o = Date.parse(me.value || new Date());\r\n        const date = new GSDate(o);\r\n        date.language = me.language;\r\n        return date;\r\n    }\r\n\r\n\r\n    static {\r\n        this.define('gs-date-format');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module rendering current year on a page\r\n * @module components/YearFormat\r\n */\r\nimport { GSElement } from '../../GSElement.mjs';\r\n\r\n/**\r\n * Render Year value\r\n * \r\n * @class\r\n * @extends {HTMLElement}\r\n */\r\nexport class GSYearFormat extends GSElement {\r\n\r\n    static properties = {\r\n        offset: {type :Number},\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.offset = 0;\r\n    }\r\n\r\n    renderUI() {\r\n        return this.value;\r\n    }\r\n\r\n    get value() {\r\n        return this.current + this.offset;\r\n    }\r\n\r\n    get current() {\r\n        return new Date().getFullYear();\r\n    }\r\n\r\n    static {\r\n        this.define('gs-year-format');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/NumberFormat/NumberFormat#options\r\n\r\n\r\n/**\r\n * A module rendering numeric value as curency format with specific langauge support\r\n * @module components/CurrencyFormat\r\n */\r\nimport { GSElement } from '../../GSElement.mjs';\r\n\r\n/**\r\n * Render Year value\r\n * \r\n * @class\r\n * @extends {HTMLElement}\r\n */\r\nexport class GSCurrencyFormat extends GSElement {\r\n\r\n    static properties = {\r\n        value: {},\r\n        currency: {},\r\n        language: {},\r\n    }\r\n\r\n    renderUI() {\r\n        return this.format;\r\n    }\r\n\r\n    get #options() {\r\n        const me = this;\r\n        return Object.apply(me.dataset, { style: 'currency', currency: me.currency });\r\n    }\r\n\r\n    get format() {\r\n        const me = this;\r\n        return new Intl.NumberFormat(me.language, me.#options).format(me.value);\r\n    }\r\n\r\n    static {\r\n        this.define('gs-currency-format');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { GSCacheStyles } from \"../../base/GSCacheStyles.mjs\";\r\n\r\n/**\r\n * A module loading GSStepStyle class\r\n * @module components/steps/GSStepStyle\r\n */\r\nexport class GSStepStyle {\r\n\r\n    static {\r\n        GSCacheStyles.adopt(GSStepStyle.style);\r\n    }\r\n\r\n    static get style() {\r\n        return `\r\n        .step .step-icon-wrap {\r\n            height: 80px;\r\n        }\r\n        \r\n        .step .step-icon-wrap::before,\r\n        .step .step-icon-wrap::after {\r\n            display: block;\r\n            position: absolute;\r\n            top: 50%;\r\n            width: 50%;\r\n            height: 3px;\r\n            margin-top: -1px;\r\n            background-color: var(--bs-gray-200);\r\n            content: '';\r\n            z-index: 1\r\n        }\r\n        \r\n        .step .step-icon-wrap::before {\r\n            left: 0\r\n        }\r\n        \r\n        .step .step-icon-wrap::after {\r\n            right: 0\r\n        }\r\n        \r\n        .step .step-icon {\r\n            width: 80px;\r\n            height: 80px;\r\n            line-height: 81px;\r\n            z-index: 5\r\n        }\r\n                \r\n        .step:first-child .step-icon-wrap::before {\r\n            display: none\r\n        }\r\n        \r\n        .step:last-child .step-icon-wrap::after {\r\n            display: none\r\n        }\r\n                \r\n        @media (max-width: 576px) {\r\n            .flex-sm-nowrap .step .step-icon-wrap::before,\r\n            .flex-sm-nowrap .step .step-icon-wrap::after {\r\n                display: none\r\n            }\r\n        }\r\n        \r\n        @media (max-width: 768px) {\r\n            .flex-md-nowrap .step .step-icon-wrap::before,\r\n            .flex-md-nowrap .step .step-icon-wrap::after {\r\n                display: none\r\n            }\r\n        }\r\n        \r\n        @media (max-width: 991px) {\r\n            .flex-lg-nowrap .step .step-icon-wrap::before,\r\n            .flex-lg-nowrap .step .step-icon-wrap::after {\r\n                display: none\r\n            }\r\n        }\r\n        \r\n        @media (max-width: 1200px) {\r\n            .flex-xl-nowrap .step .step-icon-wrap::before,\r\n            .flex-xl-nowrap .step .step-icon-wrap::after {\r\n                display: none\r\n            }\r\n        }        \r\n        `;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSStepElement class\r\n * @module components/steps/GSStepElement\r\n */\r\n\r\nimport { html, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\n\r\n/**\r\n * GSStep a signle element\r\n * @class\r\n * @extends {Component}\r\n */\r\nexport default class GSStepElement extends GSElement {\r\n\r\n    static INACTIVE = 'text-bg-light';\r\n    static SELECTED = 'text-bg-primary';\r\n    static COMPLETED = 'text-bg-secondary';\r\n\r\n    static ICON_CSS = 'border rounded-circle fs-1';\r\n    static TITLE_CSS = 'mb-0 fs-6 mt-3 fw-bold';\r\n\r\n    static properties = {\r\n        title: {},\r\n        icon: {},\r\n        color: {},\r\n        iconCSS: { attribute: 'icon-css' },\r\n        titleCSS: { attribute: 'title-css' },\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const clazz = GSStepElement;\r\n        this.icon = clazz.INACTIVE;\r\n        this.iconCSS = clazz.ICON_CSS;\r\n        this.titleCSS = clazz.TITLE_CSS;\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`\r\n        <div class=\"step d-block w-100 text-center mb-4\"  dir=\"${ifDefined(me.direction)}\">\r\n            <div class=\"step-icon-wrap d-block w-100 text-center position-relative\">\r\n                <div class=\"step-icon position-relative d-inline-block ${me.iconCSS} ${me.color || GSStepElement.INACTIVE}\">\r\n                    ${me.#renderIcon()}\r\n                </div>\r\n            </div>\r\n            <div class=\"step-title ${me.titleCSS}\">${me.translate(me.title)}</div>\r\n        </div>        \r\n        `;\r\n    }\r\n\r\n    #renderIcon() {\r\n        return this.icon ? html`<gs-icon name=\"${this.icon}\"></gs-icon>` : html`<slot name=\"icon\"></slot>`;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-step');\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSStepsElement class\r\n * @module components/steps/GSStepsElement\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSStepStyle } from \"./StepStyle.mjs\";\r\nimport GSStepElement from './Step.mjs';\r\n\r\n/**\r\n * Steps walker prev/next track current step and update step status\r\n * \r\n * @class\r\n * @extends {Component}\r\n */\r\nexport default class GSStepsElement extends GSElement {\r\n\r\n    static CSS = 'steps d-flex flex-wrap flex-sm-nowrap justify-content-between padding-top-2x padding-bottom-1x';\r\n\r\n    #index = -1;\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    shouldUpdate(changedProperties) { \r\n        return this.steps.length > 0;\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div class=\"${classMap(me.renderClass())}\"  dir=\"${ifDefined(me.direction)}\"><slot></slot></div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        return this.mapCSS(GSStepsElement.CSS, super.renderClass());\r\n    }\r\n\r\n    get steps() {\r\n        return this.queryAll('gs-step', false, true);\r\n    }\r\n\r\n    get length() {\r\n        return this.steps.length;\r\n    }\r\n\r\n    get index() {\r\n        return this.#index;\r\n    }\r\n\r\n    set index(val = 0) {\r\n        const me = this;\r\n        if (val < 0 || val >= me.length) return;\r\n        me.#index = val;\r\n    }\r\n\r\n    get current() {\r\n        const me = this;\r\n        return me.steps[me.#index];\r\n    }\r\n\r\n    get isFirst() {\r\n        return this.#index === 0;\r\n    }\r\n\r\n    get isLast() {\r\n        return this.#index === this.length - 1;\r\n    }\r\n\r\n    next() {\r\n        const me = this;\r\n        if (me.steps.length === 0) return;\r\n        if (me.isLast) return false;\r\n        if (me.#index > - 1) me.current.color = GSStepElement.COMPLETED;\r\n        me.index++;\r\n        me.current.color = GSStepElement.SELECTED;\r\n        return me.current;\r\n    }\r\n\r\n    previous() {\r\n        const me = this;\r\n        if (me.steps.length === 0) return;\r\n        if (me.isFirst) return false;\r\n        me.current.color = GSStepElement.INACTIVE;\r\n        me.index--;\r\n        me.current.color = GSStepElement.SELECTED;\r\n        return me.current;\r\n    }\r\n\r\n    reset() {\r\n        const me = this;\r\n        me.steps.forEach(it => it.color = GSStepElement.INACTIVE);\r\n        requestAnimationFrame(() => {\r\n            me.#index = 0;\r\n            me.current.color = GSStepElement.SELECTED;\r\n        });\r\n    }\r\n\r\n    static {\r\n        GSStepStyle.style;\r\n        this.define('gs-steps', GSStepsElement);\r\n    }\r\n\r\n}","\r\nimport { classMap, html, ifDefined } from '../../lib.mjs';\r\nimport { GSAttr } from '../../base/GSAttr.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSDOM } from '../../base/GSDOM.mjs';\r\n\r\nexport class GSNotificationElement extends GSElement {\r\n\r\n    static TOP_START = \"position-fixed top-0 start-0\";\r\n    static TOP_CENTER = \"position-fixed top-0 start-50 translate-middle-x\";\r\n    static TOP_END = \"position-fixed top-0 end-0\";\r\n\r\n    static MIDDLE_START = \"position-fixed top-50 start-0 translate-middle-y\";\r\n    static MIDDLE_CENTER = \"position-fixed top-50 start-50 translate-middle\";\r\n    static MIDDLE_END = \"position-fixed top-50 end-0 translate-middle-y\";\r\n    \r\n    static BOTTOM_START = \"position-fixed bottom-0 start-0\";\r\n    static BOTTOM_CENTER = \"position-fixed bottom-0 start-50 translate-middle-x\";\r\n    static BOTTOM_END = \"position-fixed bottom-0 end-0\";\r\n\r\n    static DEFAULT = GSNotificationElement.BOTTOM_END;\r\n\r\n    static properties = {\r\n        position: { reflect: true },\r\n        native: { reflect: true, type: Boolean }\r\n    };\r\n\r\n    #list = new Set();\r\n\r\n    constructor() {\r\n        super();\r\n        this.css = 'p-3';\r\n        this.position = GSNotificationElement.DEFAULT;\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div  dir=\"${ifDefined(me.direction)}\"\r\n            class=\"toast-container z-10k ${classMap(me.renderClass())}\">\r\n            <slot></slot>\r\n        </div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        return me.mapCSS(me.#positionCSS, super.renderClass());\r\n    }    \r\n\r\n    get #positionCSS() {\r\n        const clazz = GSNotificationElement;\r\n        const val = this.position || clazz.DEFAULT;\r\n        return val.indexOf('_') > 0 && clazz[val] ? clazz[val] : val;\r\n    }\r\n\r\n    clear() {\r\n        this.queryAll('gs-toast').forEach(el => el.dismiss());\r\n    }\r\n\r\n    info(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-info', closable, timeout, delay, options);\r\n    }\r\n\r\n    success(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-success', closable, timeout, delay, options);\r\n    }\r\n\r\n    warn(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-warning', closable, timeout, delay, options);\r\n    }\r\n\r\n    danger(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-danger', closable, timeout, delay, options);\r\n    }\r\n\r\n    primary(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-primary', closable, timeout, delay, options);\r\n    }\r\n\r\n    secondary(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-secondary', closable, timeout, delay, options);\r\n    }\r\n\r\n    dark(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-dark', closable, timeout, delay, options);\r\n    }\r\n\r\n    light(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-light', closable, timeout, delay, options);\r\n    }\r\n\r\n    /**\r\n     * Main function to show notification. \r\n     * It has support for Bootstrap based and web based notifications.\r\n     * \r\n     * @async\r\n     * @param {String} title Notification title\r\n     * @param {String} message Notification message\r\n     * @param {String} css CSS styling (web only)\r\n     * @param {Boolean} closable Can user close it (web only)\r\n     * @param {Number} timeout Timeout after which to close notification  (default 2 sec)\r\n     * @param {Number} delay Timeout after which to show notification (default 1 sec)\r\n     * @param {Object} options Options for native Notification\r\n     * @returns {Promise<Notification|GSToast>}\r\n     */\r\n    async display(title = '', message = '', css = '', closable = false, timeout = 2, delay = 0.5, options) {\r\n        if (!message) return;\r\n        const me = this;\r\n        if (me.native) {\r\n            let sts = await GSNotificationElement.requestPermission();\r\n            if (sts) sts = me.#showNative(title, message, timeout, delay, options);\r\n            if (sts) return sts;\r\n        }\r\n        return me.#showWeb(title, message, css, closable, timeout, delay);\r\n    }\r\n\r\n    #showWeb(title, message, css, closable, timeout, delay) {\r\n        const me = this;\r\n        const tpl = `<gs-toast css=\"${css}\"  opened ${closable ? 'closable' : ''} timeout=\"${timeout}\"  delay=\"${delay}\" message=\"${message}\" title=\"${title}\" language=\"${me.language}\" ></gs-toast>`;\r\n        const el = GSDOM.parse(tpl, true);\r\n        requestAnimationFrame(async () => {\r\n            await me.#delay(delay);\r\n            const toast = me.#dialogToast;\r\n            if (toast !== me) GSAttr.set(toast, 'class', `toast-container ${me.css} ${me.position}`);\r\n            toast.appendChild(el);\r\n        });\r\n        return el;\r\n    }\r\n\r\n    async #showNative(title, message, timeout, delay, options = {}) {\r\n        const me = this;\r\n        await me.#delay(delay);\r\n        options.body = options.body || message;\r\n        const notification = new Notification(title, options);\r\n        me.#list.add(notification);\r\n        const callback = me.#clearNative.bind({ notification: notification, owner: me });\r\n        notification.addEventListener('close', callback);\r\n        if (timeout > 0) notification.iid = setTimeout(callback, timeout * 1000);\r\n        return notification;\r\n    }\r\n\r\n    get #dialogToast() {\r\n        const dlg = customElements.get('gs-dialog')?.top;\r\n        return dlg && dlg.isConnected ? (GSDOM.query(dlg, '.toast-container') || this) : this;\r\n    }\r\n\r\n    async #delay(delay = 0) {\r\n        if (GSUtil.isNumber(delay) && delay > 0) await GSUtil.timeout(delay * 1000);\r\n    }\r\n\r\n    #clearNative() {\r\n        const me = this;\r\n        me.notification.close();\r\n        me.owner.#list.delete(me.notification);\r\n        if (me.notification.iid) clearTimeout(me.notification.iid);\r\n    }\r\n\r\n    /**\r\n     * Clear all triggered notifications\r\n     */\r\n    clear() {\r\n        const me = this;\r\n        Array.from(me.querySelectorAll('gs-toast')).forEach(el => el.remove());\r\n        me.#list.forEach(nn => nn.close());\r\n        me.#list.clear();\r\n    }\r\n\r\n    /**\r\n     * Check if native notification is supported\r\n     * @returns {Boolean} \r\n     */\r\n    static get isNativeSupported() {\r\n        return \"Notification\" in self;\r\n    }\r\n\r\n    /**\r\n     * Check if native notification is allowed\r\n     * @returns {Boolean} \r\n     */\r\n    static get isGranted() {\r\n        return Notification.permission === \"granted\";\r\n    }\r\n\r\n    /**\r\n     * Request useage for browser native notification\r\n     * \r\n     * @async\r\n     * @returns {Promise<boolean>} Return granted status\r\n     */\r\n    static async requestPermission() {\r\n        const clazz = GSNotificationElement;\r\n        if (!clazz.isNativeSupported) return false;\r\n        if (!clazz.isGranted) await Notification.requestPermission();\r\n        return clazz.isGranted;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-notification');\r\n    }\r\n}","\r\nimport { classMap, html, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSDOM } from '../../base/GSDOM.mjs';\r\nimport { GSUtil } from '../../base/GSUtil.mjs';\r\nimport { GSNotificationElement } from './Notification.mjs';\r\n\r\nexport class GSToastElement extends GSElement {\r\n\r\n    static properties = {\r\n        closable: { reflect: true, type: Boolean },\r\n        opened: { reflect: true, type: Boolean },\r\n        message: { reflect: true },\r\n        title: { reflect: true },\r\n        delay: { reflect: true, type: Number },\r\n        timeout: { reflect: true, type: Number }\r\n    }\r\n\r\n    #pending = false;\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;\r\n        me.timeout = 2;\r\n        me.delay = 2;\r\n        me.auto = true; \r\n    }\r\n\r\n    shouldUpdate(changedProperties) {\r\n        const me = this;\r\n        const visibilityChange = me.#isVisibilityChanged(changedProperties);\r\n        if (me.delay > 0 && me.opened && visibilityChange) {\r\n            me.#pending = true;\r\n            me.#pendingUpdate();\r\n        }\r\n        return me.#validParent && (!me.#pending);\r\n    }\r\n\r\n    #isVisibilityChanged(changedProperties) {\r\n        return changedProperties.has('opened');\r\n    }\r\n\r\n    async #pendingUpdate() {\r\n        const me = this;\r\n        await GSUtil.timeout(me.delay * 1000);\r\n        me.#pending = false;\r\n        me.requestUpdate();\r\n    }\r\n\r\n    async updated(changedProperties) {\r\n        const me = this;\r\n        const visibilityChange = me.#isVisibilityChanged(changedProperties);\r\n        if (me.timeout > 0 && me.opened) {\r\n            await GSUtil.timeout(me.timeout * 1000);\r\n            me.opened = false;\r\n        } else if (visibilityChange && !me.opened) { \r\n            me.remove();\r\n        };\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return me.title ? me.#renderWithHeader() : me.#renderSimple();\r\n    }\r\n\r\n    #renderWithHeader() {\r\n        const me = this;\r\n        return html`\r\n        <div dir=\"${ifDefined(me.direction)}\"\r\n            class=\"mt-1 mb-1 toast fade ${classMap(me.renderClass())}\">\r\n            <div class=\"toast-header\">\r\n                ${me.translate(me.title)}\r\n                <slot name=\"header\"></slot>\r\n                ${me.closable ? me.#button : ''}\r\n            </div>\r\n            <div class=\"toast-body\">\r\n                ${me.translate(me.message)}\r\n                <slot name=\"body\"></slot>\r\n            </div>\r\n        </div>            \r\n        `;\r\n    }\r\n\r\n    #renderSimple() {\r\n        const me = this;\r\n        return html`\r\n        <div class=\"mt-1 mb-1 toast fade ${classMap(me.renderClass())}\">\r\n          <div class=\"d-flex\">\r\n              <div class=\"toast-body\">\r\n              ${me.translate(me.message)}\r\n              <slot name=\"body\"></slot>\r\n              </div>\r\n              ${me.closable ? me.#button : ''}\r\n          </div>\r\n        </div>            \r\n        `;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            'show': me.opened,\r\n        }\r\n        return css;\r\n    }\r\n\r\n    dismiss() {\r\n        this.opened = false;\r\n    }\r\n\r\n    get #button() {\r\n        const me = this;\r\n        return html`<button type=\"button\" class=\"btn-close me-2 m-auto\" @click=\"${me.dismiss}\"></button>`;\r\n    }\r\n\r\n    get #validParent() {\r\n        const isToast = GSDOM.hasClass(this.parentElement, 'toast-container');\r\n        const isNotify = this.parentElement instanceof GSNotificationElement;\r\n        return isToast || isNotify;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-toast');\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { KEY } from '../../../base/GSConst.mjs';\r\n\r\n/**\r\n * Controller managing data tree navigation.\r\n * Controller is added to every gs-tree-node and \r\n * reacts on Tree node changes to update UI\r\n */\r\nexport class AbstractTreeController {\r\n\r\n    #host;\r\n    #node;\r\n\r\n    constructor(host) {\r\n        const me = this;\r\n        me.#host = host;\r\n        host.addController(me);\r\n    }\r\n    \r\n    hostConnected() {\r\n        const me = this;\r\n        me.#node = me.#host.node;\r\n        me.#addNodeController(me);\r\n    }\r\n\r\n    hostDisconnected() {\r\n        const me = this;\r\n        me.#removeNodeController(me);\r\n        me.#host.removeController(me);\r\n    }\r\n\r\n    // before rendering\r\n    hostUpdate() {\r\n        const me = this;\r\n        const oldNode = me.#node;\r\n        me.#node = me.#host.node;\r\n        if (oldNode != me.#node) {\r\n            me.#removeNodeController(me);\r\n            me.#addNodeController(me);\r\n        }\r\n    }\r\n\r\n    // link Tree node callbacks with controller and component\r\n    #addNodeController(controller) {\r\n        this.#host.node?.addController?.(controller);\r\n    }\r\n\r\n    // unlink Tree node callbacks with controller and component\r\n    #removeNodeController(controller) {\r\n        this.#node?.removeController?.(controller);\r\n    }\r\n\r\n    host(node) {\r\n        return node[KEY] || this.#host;\r\n    }\r\n\r\n    match(node) {\r\n        const host = this.host(node);\r\n        return host?.node === node;\r\n    }\r\n\r\n    get store() {\r\n        return this.#host.dataController?.store;\r\n    }\r\n\r\n    requestUpdate(node) {\r\n        if (this.match(node)) this.host(node).requestUpdate();\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { AbstractTreeController } from './AbstractTreeController.mjs';\r\n\r\n/**\r\n * Controller managing data TreeNode callbacks to reflect UI.\r\n */\r\nexport class TreeController extends AbstractTreeController {\r\n\r\n    constructor(host) {\r\n        super(host);\r\n    }\r\n\r\n    #toggleState(node, state = false) {\r\n        const el = this.host(node);\r\n        if (el) el.loading = state;\r\n    }\r\n\r\n    // Tree controller callbacks\r\n    onLoad(node) {\r\n        this.#toggleState(node, true);\r\n    }\r\n\r\n    onRefresh(node) {\r\n        this.requestUpdate(node);\r\n    }\r\n\r\n    onAppend(node, addedNode) {\r\n        this.#toggleState(node);\r\n        this.requestUpdate(node.root);\r\n    }\r\n\r\n    onInsert(node, insertedNode) {\r\n        this.#toggleState(node);\r\n        this.requestUpdate(node.root);\r\n    }\r\n\r\n    onExpand(node) {\r\n        const store = this.store;\r\n        if (store) {\r\n            store.onExpand(node);\r\n        } else {\r\n            this.requestUpdate(node);\r\n        }\r\n    }\r\n\r\n    onCollapse(node) {\r\n        this.requestUpdate(node);\r\n    }\r\n\r\n    onFocusChanged(node) {\r\n        this.requestUpdate(node);\r\n    }\r\n\r\n    onSelectionChanged(node, selectedNode) {\r\n        this.requestUpdate(node);\r\n    }\r\n\r\n    onRemove(node) {\r\n        if (this.match(node)) this.host(node).remove();\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { html } from '../../lib.mjs';\r\nimport { KEY } from '../../base/GSConst.mjs';\r\nimport { TreeNode } from '../../data/TreeNode.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSLinklement } from '../Link.mjs';\r\nimport { GSAttributeHandler } from '../../base/GSAttributeHandler.mjs';\r\n\r\nexport class GSTreeItemElement extends GSElement {\r\n\r\n  /*\r\n  static styles = css`            \r\n    :focus-visible {\r\n      outline: none !important;\r\n    }  \r\n    .list-group-item {\r\n      cursor: pointer;\r\n    }`;\r\n    */\r\n\r\n  static properties = {\r\n    loading: { state: true },\r\n    node: { type: Object, hasChanged: (newVal) => newVal instanceof TreeNode }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.flat = true;\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    return this.node ? true : false;\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    if (changed.has('node')) this.node[KEY] = this;\r\n  }\r\n\r\n  updated() {\r\n    if (this.focused) this.#link?.focus();\r\n    this.dataset.visible = this.visible;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const node = me.node;\r\n    const opt = me.value || {};\r\n    opt.tooltip = me.translate(opt.tooltip)\r\n    opt.title = me.translate(opt.title)\r\n    const before = me.loading ? me.#renderSpinner(node.level) : me.#renderIcon(node.level);\r\n    return GSLinklement.generate(opt, me.renderClass(), before);\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const opt = {\r\n      'list-group-item': true,\r\n      'list-group-item-action': true,\r\n      'user-select-none  ': true,\r\n      'border-0': me.#border ? false : true,\r\n      'gs-hide': !me.visible\r\n    };\r\n    return me.mapCSS(me.#cssFocus, me.mapCSS(me.#cssSelected, opt, me.selected && !me.multiselect), me.focused);\r\n  }\r\n\r\n  /**\r\n   * Toggle folder\r\n   */\r\n  toggle() {\r\n    this.opened ? this.close() : this.open();\r\n  }\r\n\r\n  /**\r\n   * Open folder\r\n   */\r\n  open() {\r\n    this.#status(true);\r\n    this.focus();\r\n  }\r\n\r\n  /**\r\n   * Close folder\r\n   */\r\n  close() {\r\n    this.#status(false);\r\n  }\r\n\r\n  /**\r\n   * Toggle selection state\r\n   */\r\n  toggleSelection() {\r\n    this.select(!this.selected);\r\n  }\r\n\r\n  focus(val = true) {\r\n    if (val) super.focus();\r\n    this.focused = val == true;\r\n  }\r\n\r\n  select(val = true) {\r\n    this.selected = val == true;\r\n  }\r\n\r\n  handle(e) {\r\n    GSAttributeHandler.process(this.#link, e);\r\n  }\r\n\r\n  get #link() {\r\n    return this.query('a');\r\n  }\r\n\r\n  get isLeaf() {\r\n    return this.node?.isLeaf;\r\n  }\r\n\r\n  get isFolder() {\r\n    return !this.isLeaf;\r\n  }\r\n\r\n  get key() {\r\n    return this.node?.key;\r\n  }\r\n\r\n  get value() {\r\n    return this.node?.value || {};\r\n  }\r\n\r\n  get level() {\r\n    return this.node?.level || -1;\r\n  }\r\n\r\n  get focused() {\r\n    return this.node?.focused;\r\n  }\r\n\r\n  get visible() {\r\n    const parent = this.parent;\r\n    return parent?.opened || parent?.level === -1;\r\n  }\r\n\r\n  get parent() {\r\n    return this.node?.parent;\r\n  }\r\n\r\n  get parentItem() {\r\n    const item = this.parent?.[KEY];\r\n    return item instanceof GSTreeItemElement ? item : undefined;\r\n  }\r\n\r\n  set focused(val) {\r\n    val = val === true;\r\n    this.node.focused = val;\r\n  }\r\n\r\n  get selected() {\r\n    return this.node?.selected;\r\n  }\r\n\r\n  set selected(val) {\r\n    val = val === true;\r\n    const me = this;\r\n    if (me.isFolder && me.owner.leaf) val = false;\r\n\r\n    if (me.multiselect) {\r\n      if (val) {\r\n        me.node.selectAll();\r\n      } else {\r\n        me.node.deselectAll();\r\n      }\r\n    } else {\r\n      me.node.selected = val;\r\n    }\r\n  }\r\n\r\n  get opened() {\r\n    return this.node?.opened;\r\n  }\r\n\r\n  set opened(val) {\r\n    this.#status(val === true);\r\n  }\r\n\r\n  get owner() {\r\n    return this.closest('gs-tree');\r\n  }\r\n\r\n  get multiselect() {\r\n    return this.owner.multiselect;\r\n  }\r\n\r\n  get #cssFocus() { return this.owner.cssFocus || 'focus-ring'; }\r\n  get #cssSelected() { return this.owner.cssSelected || 'active'; }\r\n  get #cssCheck() { return this.owner.cssCheck || ''; }\r\n  get #checkColor() { return this.owner.checkColor || 'secondary'; }\r\n  get #checkColorSelected() { return this.owner.checkColorSelected || 'primary'; }\r\n  get #border() { return this.value?.border === true || this.owner.border === true;}\r\n\r\n  get #icon() {\r\n    const me = this;\r\n    const node = me.node;\r\n    const data = me.value;\r\n    const ui = me.owner;\r\n    let itemIco = data.icon || ui.itemIcon;\r\n    if (node.isFolder) itemIco = node.opened ? (data.openIcon || ui.openIcon) : (data.closeIcon || ui.closeIcon);\r\n    return itemIco;\r\n  }\r\n\r\n  #renderIndent(level) {\r\n    return html`<gs-indent size=\"${level}\"></gs-indent>`;\r\n  }\r\n\r\n  #renderSpinner(level) {\r\n    return html`${this.#renderIndent(level)}<gs-spinner small></gs-spinner>`;\r\n  }\r\n\r\n  #renderIcon(level) {\r\n    return html`${this.#renderIndent(level)}${this.#renderMulti()}<gs-icon size=\"5\" name=\"${this.#icon}\"></gs-icon>`;\r\n  }\r\n\r\n  #renderMulti() {\r\n    const me = this;\r\n    if (!me.multiselect) return '';\r\n    const color = me.selected ? me.#checkColorSelected : me.#checkColor;\r\n    const icon = me.node.isPartialySelected ? 'dash-square-fill' : me.selected ? 'check-square-fill' : 'square';\r\n    return html`<gs-icon size=\"6\" data-type=\"state\" \r\n                css=\"me-1 text-${color} ${me.#cssCheck}\"\r\n                name=\"${icon}\"></gs-icon>`;\r\n  }\r\n\r\n  #status(val = false) {\r\n    const me = this;\r\n    if (me.node?.isFolder) {\r\n      me.node.opened = val;\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-tree-item');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, css, createRef, ref, repeat, ifDefined } from '../../lib.mjs';\r\nimport { KEY } from '../../base/GSConst.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSDOM } from '../../base/GSDOM.mjs';\r\nimport { TreeNode } from '../../data/TreeNode.mjs';\r\nimport { TreeController } from './controllers/TreeController.mjs';\r\nimport { color } from '../../properties/color.mjs';\r\n\r\nexport class GSTreeElement extends GSElement {\r\n\r\n  static styles = css`            \r\n    :focus-visible {\r\n      outline: none !important;\r\n    }  \r\n    .list-group-item {\r\n      cursor: pointer;\r\n    }`;\r\n\r\n  static shared = {\r\n    itemIcon: { attribute: 'icon-item' },\r\n    closeIcon: { attribute: 'icon-close' },\r\n    openIcon: { attribute: 'icon-open' },\r\n    cssCheck: { attribute: 'css-check' },\r\n    cssFocus: { attribute: 'css-focus' },\r\n    cssSelected: { attribute: 'css-selected' },\r\n    checkColor: { attribute: 'check-color', ...color },\r\n    checkColorSelected: { attribute: 'check-color-selected', ...color },\r\n  }\r\n\r\n  static properties = {\r\n    storage: {},\r\n    data: { type: Object },\r\n    node: { type: Object, hasChanged: (newVal) => newVal instanceof TreeNode },\r\n    border: { type: Boolean, reflect: true },\r\n    guide: { type: Boolean, reflect: true },\r\n    leaf: { type: Boolean, reflect: true },\r\n    multiselect: { type: Boolean, reflect: true },\r\n    circular: { type: Boolean, reflect: true },\r\n    ...GSTreeElement.shared\r\n  }\r\n\r\n  // GS-ITEM attributes mapping\r\n  static options = {\r\n    ...GSTreeElement.shared,\r\n    css: {},\r\n    icon: {},\r\n    color: {},\r\n    title: {},\r\n    tooltip: {},\r\n    opened: { type: Boolean },\r\n    selected: { type: Boolean }\r\n  }\r\n\r\n  #queued = false;\r\n  #listRef = createRef();\r\n\r\n  #controller = null;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.leaf = false;\r\n    me.multiselect = false;\r\n    me.data = GSDOM.toJson(me, true, true).items;\r\n    me.node = new TreeNode(null, { '#tagName': this.tagName }, null, -1);\r\n    me.itemIcon = 'file-earmark';\r\n    me.closeIcon = 'folder'; // caret-right; chevron-right\r\n    me.openIcon = 'folder2-open'; // caret-down; chevron-down\r\n    me.cssSelected = 'active'; // fw-bold\r\n    me.cssFocus = 'focus-ring';\r\n    me.node[KEY] = me;\r\n    me.#controller = new TreeController(me);\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\"\r\n          class=\"treeview ${classMap(me.renderClass())}\"          \r\n          @click=\"${me.#onClick}\"\r\n          @keydown=\"${me.#onKeyDown}\"\r\n          @keyup=\"${me.#onKeyUp}\">\r\n          <div class=\"list-group\" ${ref(me.#listRef)}>\r\n          ${repeat(me.node.walk(me.node, false, false), (node) => node.key, (node) => html`\r\n            <gs-tree-item .node=\"${node}\"></gs-tree-item>\r\n          `)}\r\n          </div>    \r\n        </div>`;\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    const me = this;\r\n    if (changed.has('data') && me.data && !me.#queued) {\r\n      me.#queued = true;\r\n      queueMicrotask(() => {\r\n        me.node.clear();\r\n        me.node.fromJSON(me.data);\r\n        me.#queued = false;\r\n        me.requestUpdate();\r\n      });\r\n    }\r\n    return this.node ? true : false;\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    if (changed.has('multiselect') && !this.multiselect) this.node?.deselectAll();\r\n    this.node.multi = this.multiselect;\r\n  }\r\n\r\n  onDataRead(data) {\r\n    if (data instanceof TreeNode) {\r\n      if (data.root !== this.node) this.node = data;\r\n    } else {\r\n      this.data = data;\r\n    }\r\n  }\r\n\r\n  next(expand = false) {\r\n    const me = this;\r\n    let item = me.nextItem;\r\n    if (!item & me.circular) item = me.#first;\r\n    if (item?.visible) {\r\n      item.focus();\r\n      if (expand && me.focused?.isFolder) me.focused.open();\r\n    }\r\n    return me.focused;\r\n  }\r\n\r\n  previous(collapse = false) {\r\n    const me = this;\r\n    let item = me.previousItem;\r\n    if (!item & me.circular) item = me.#last;\r\n    if (item?.visible) {\r\n      item.focus();\r\n      if (item.isFolder && collapse) item.close();\r\n    }\r\n    return me.focused;\r\n\r\n  }\r\n\r\n  expandAll() {\r\n    this.node?.expandAll();\r\n  }\r\n\r\n  collapseAll() {\r\n    this.node?.collapseAll();\r\n  }\r\n\r\n  /**\r\n   * Open folder\r\n   */\r\n  open(path) {\r\n    const me = this;\r\n    me.focused?.open();\r\n  }\r\n\r\n  /**\r\n   * Close folder\r\n   * TODO - path navigation\r\n   */\r\n  close(path) {\r\n    const me = this;\r\n    me.focused?.close();\r\n  }\r\n\r\n  clear() {\r\n    this.node?.clear();\r\n    this.requestUpdate();\r\n  }\r\n\r\n  reload() {\r\n    this.clear();\r\n    this.dataController?.read();\r\n  }\r\n\r\n  get selected() {\r\n    return this.#host(this.node.selectedNodes());\r\n  }\r\n\r\n  get focused() {\r\n    return this.#host(this.node.focusedNode());\r\n  }\r\n\r\n  /**\r\n   * Previous visible ge-node-item\r\n   */\r\n  get previousItem() {\r\n    return this.focused?.node.find(n => n?.visible, true, true)?.[KEY];\r\n  }\r\n\r\n  /**\r\n   * Next visible ge-node-item\r\n   */\r\n  get nextItem() {\r\n    return this.focused?.node.find(n => n?.visible, true)?.[KEY];\r\n  }\r\n\r\n  get #list() {\r\n    return this.#listRef.value;\r\n  }\r\n\r\n  get #first() {\r\n    return this.#list.firstElementChild;\r\n  }\r\n\r\n  get #last() {\r\n    return this.#list.lastElementChild;\r\n  }\r\n\r\n  #host(node) {\r\n    return Array.isArray(node) ? node.map(n =>n[KEY]).filter(n => n) : node?.[KEY];\r\n  }\r\n\r\n  #onClick(e) {\r\n    const icon = e.target.tagName === 'GS-ICON' ? e.target : e.target.closest('gs-icon');\r\n    const isIcon = icon?.dataset.type === 'state';\r\n    const el = e.target.closest('gs-tree-item');\r\n    if (!el.node) return;\r\n\r\n    const me = this;\r\n\r\n    if (me.multiselect) {\r\n      if (isIcon) el.toggleSelection();\r\n    } else {\r\n      el.select(true);\r\n    }\r\n\r\n    const expandable = (me.multiselect && !isIcon) || (!me.multiselect);\r\n    if (el.isFolder && expandable) el.toggle();\r\n\r\n    el.focus();\r\n    el.handle(e);\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n\r\n    const me = this;\r\n    const el = me.focused;\r\n    if (!el) return;\r\n\r\n    switch (e.code) {\r\n      case 'ArrowUp':\r\n        me.previous();\r\n        break;\r\n      case 'ArrowDown':\r\n        me.next();\r\n        break;\r\n      case 'ArrowLeft':\r\n        if (el.isFolder) {\r\n          if (el.opened) {\r\n            me.close();\r\n          } else {\r\n            (el.parentItem || el)?.focus();\r\n          }\r\n        } else {\r\n          me.previous();\r\n        }\r\n        break;\r\n      case 'ArrowRight':\r\n        if (el.isFolder && !el.opened) {\r\n          me.open();\r\n        } else {\r\n          me.next();\r\n        }\r\n        break;\r\n      case 'Enter':\r\n          if (el.isFolder) {\r\n            el.toggle();\r\n          }        \r\n    }\r\n  }\r\n\r\n  #onKeyUp(e) {\r\n\r\n    const el = e.target.closest('gs-tree-item');\r\n    if (!(el?.node)) return;\r\n\r\n    switch (e.code) {\r\n      case 'Enter':\r\n        el.handle(e);\r\n        break;\r\n      case 'Tab':\r\n        el.focus();\r\n        break;\r\n      case 'Space':\r\n        el.select(this.multiselect ? !el.selected : true);\r\n        el.focus();\r\n        break;\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-tree');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading ServiceWorkkerElement class\r\n * @module components/ServiceWorkkerElement\r\n */\r\n\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\n/**\r\n * An easy way to register a service worker in the browser.\r\n * @class\r\n * @extends { GSlement }\r\n */\r\nexport class ServiceWorkkerElement extends GSElement {\r\n\r\n    static properties = {\r\n        src: {},\r\n        scope: {},\r\n        module: { type: Boolean, default: false },\r\n        trace: { type: Boolean, reflect: true, default: false },\r\n        disabled: { type: Boolean, reflect: true, default: false }\r\n    }\r\n\r\n    #registration = false\r\n    #workerMessage = null;\r\n    #messageChannel = null;\r\n\r\n    #nocache = false;\r\n\r\n    constructor() {\r\n        super();\r\n        this.flat = true;\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        const me = this;\r\n        me.#workerMessage = me.#onWorkerMessage.bind(me);\r\n        me.#load();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        super.disconnectedCallback();\r\n        this.#unload();\r\n    }\r\n\r\n    willUpdate(changed) {\r\n        const me = this;\r\n        if (changed.has('trace')) {\r\n            me.#ServiceWorkerTraceUpdate();\r\n        }\r\n        if (changed.has('disabled')) {\r\n            me.disabled ? me.#unload() : me.#load();\r\n        }\r\n        super.willUpdate(changed);\r\n    }\r\n\r\n    /**\r\n     * Returns true if the service worker is available in the browser and the src is a valid URL.\r\n     */\r\n    get available() {\r\n        const me = this;\r\n        return 'serviceWorker' in navigator && me.src && GSUtil.isURL(me.src);\r\n    }\r\n\r\n    /**\r\n     * Returns the service worker registration object.\r\n     */\r\n    get registration() {\r\n        return this.#registration;\r\n    }\r\n\r\n    /**\r\n     * Request the service worker to clear its cache.\r\n     * @returns \r\n     */\r\n    clearCache() {\r\n        return this.postMessage(\"CLEAR_CACHE\");\r\n    }\r\n\r\n    /**\r\n     * Request the service worker to pupdate preloads\r\n     * @returns \r\n     */\r\n    refresh() {\r\n        return this.postMessage(\"REFRESH_CACHE\");\r\n    }\r\n\r\n    /**\r\n     * Send a message to the service worker.\r\n     * @param {*} message The message to send to the service worker.\r\n     * @returns {boolean} Returns true if the message was sent, false if the service worker is not active or not registered.\r\n     */\r\n    postMessage(message) {\r\n        const me = this;\r\n        const sts = GSUtil.nonNull(message) && me.isLoaded;\r\n        if (sts) {\r\n            if (me.#messageChannel) {\r\n                me.#messageChannel.port1.postMessage(message);\r\n            } else {\r\n                me.#registration?.active?.postMessage(message);\r\n            }\r\n        }\r\n        return sts;\r\n    }\r\n\r\n    /**\r\n     * Method to handle messages from the service worker.\r\n     * Override this method to handle messages from the service worker.\r\n     * The default implementation does nothing.\r\n     * @param {Event} event \r\n     * @returns {boolean} Return false to stop the event propagation, true to continue.\r\n     */\r\n    onMessage(event) {\r\n        me.#trace('ServiceWorker message received:', event);\r\n        return true;\r\n    }\r\n\r\n    #onWorkerMessage = (event) => {\r\n        const me = this;\r\n        if (event.data) {\r\n            if (me.onMessage(event)) {\r\n                me.emit('message', event.data, true, true, true);\r\n            }\r\n        } else {\r\n            me.#trace('ServiceWorker message is empty:', event);\r\n        }\r\n    }\r\n\r\n    #initChannel() {\r\n        const me = this;\r\n        if (me.#registration?.active) {\r\n            me.#messageChannel = new MessageChannel();\r\n            me.#messageChannel.port1.onmessage = me.#workerMessage;\r\n            me.#ServiceWorkerTraceUpdate();\r\n            me.#registration.active.postMessage('INIT_PORT', [me.#messageChannel.port2]);\r\n            //me.emit('activated', isActive, true, true, true);\r\n        }\r\n    }\r\n\r\n    #ServiceWorkerTraceUpdate() {\r\n        const me = this;\r\n        me.#registration?.active?.postMessage(me.trace ? 'TRACE_ON' : 'TRACE_OFF');\r\n    }\r\n\r\n    // Show a notification to the user that a new version of the app is available\r\n    async #invokeServiceWorkerUpdateFlow(registration) {\r\n        return registration?.waiting?.postMessage('NOTIFICATION_WAITING');\r\n    }\r\n\r\n    // detect Service Worker update available and wait for it to become installed\r\n    #monitorServiceWorkerUpdate(registration) {\r\n        const me = this;\r\n        registration.addEventListener('updatefound', () => {\r\n            // wait until the new Service worker is actually installed (ready to take over)\r\n            registration.installing?.addEventListener('statechange', () => {\r\n                if (registration.waiting) {\r\n                    // if there's an existing controller (previous Service Worker), show the prompt\r\n                    if (navigator.serviceWorker.controller) {\r\n                        me.#invokeServiceWorkerUpdateFlow(registration);\r\n                    } else {\r\n                        // otherwise it's the first install, nothing to do\r\n                        me.#trace('Service Worker initialized for the first time');\r\n                    }\r\n                }\r\n            });\r\n        })\r\n    }\r\n\r\n    // detect controller change and refresh the page\r\n    #monitorController() {\r\n        let refreshing = false;\r\n        navigator.serviceWorker.addEventListener('controllerchange', () => {\r\n            if (!refreshing) {\r\n                window.location.reload();\r\n                refreshing = true;\r\n            }\r\n        });\r\n    }\r\n\r\n    async #unload() {\r\n        const me = this;\r\n        GSLoader.NO_CACHE = me.#nocache;\r\n        if (me.disabled) {\r\n            await me.#registration?.unregister();\r\n        }\r\n        me.#messageChannel?.port1.close();\r\n        me.#messageChannel?.port2.close();\r\n        me.#messageChannel = null;\r\n        me.#registration = null;\r\n    }\r\n\r\n    // Load the service worker\r\n    async #load() {\r\n        const me = this;\r\n        if (me.disabled) return;\r\n        me.#nocache = GSLoader.NO_CACHE;\r\n        GSLoader.NO_CACHE = false;\r\n\r\n        if (!me.available) {\r\n            console.warn('Service Worker is not available in this browser or src is not valid.');\r\n            return;\r\n        }        \r\n        try {\r\n            const opt = me.scope ? { scope: me.scope } : {};\r\n            if (me.module) opt.type = 'module';\r\n            me.#registration = await navigator.serviceWorker.register(me.src, opt);\r\n            me.#trace('ServiceWorker registration started:', me.#registration);\r\n\r\n            me.#monitorController();\r\n            me.#invokeServiceWorkerUpdateFlow(me.#registration);\r\n            me.#monitorServiceWorkerUpdate(me.#registration);\r\n            me.#initChannel(me.#registration);\r\n\r\n            me.#trace('ServiceWorker registration successful with scope: ', me.#registration.scope);\r\n\r\n        } catch (error) {\r\n            me.#registration = false;\r\n            console.error('Service Worker registration failed:', error);\r\n        }\r\n        me.emit('loaded', me.isLoaded, true, true, true);\r\n    }\r\n\r\n    #trace(message, data = '') {\r\n        if (this.trace) {\r\n            console.log(message, data);\r\n        }\r\n    }\r\n\r\n    static {\r\n        this.define('gs-service-worker');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, html, ifDefined, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSLog } from '../base/GSLog.mjs';\r\n\r\nexport class GSChartElement extends GSElement {\r\n\r\n    static get URL_LIB() {\r\n        return globalThis.GS_URL_CHART || globalThis.location?.origin || '/bootstrap-lit';\r\n    }\r\n\r\n    static properties = {\r\n        url: {},\r\n        config: {},\r\n        storage: {},\r\n        height: { type: Number },\r\n        width: { type: Number },\r\n        data: { type: Array },\r\n        options: { type: Object },\r\n    }\r\n\r\n    #canvasRef = createRef();\r\n    #chart = null;\r\n\r\n    constructor() {\r\n        super();\r\n        this.height = 0;\r\n        this.width = 0;\r\n        GSChartElement.#init();\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        this.#waitInit();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        super.disconnectedCallback();\r\n        const me = this;\r\n        if (me.#chart) me.#chart.destroy();\r\n        me.#chart = null;\r\n    }\r\n\r\n    shouldUpdate(changed) {\r\n        return GSChartElement.#isChart;\r\n    }\r\n\r\n    firstUpdated(changed) {\r\n        this.#render();\r\n        super.firstUpdated(changed);\r\n    }\r\n\r\n    updated(changed) {\r\n        const me = this;\r\n        if (changed.has('url') || changed.has('config')) me.#render();\r\n        if (changed.has('data') || changed.has('options')) me.#renderData(me.data, me.options);\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<canvas ${ref(me.#canvasRef)} \r\n                class=\"${classMap(me.renderClass())}\"\r\n                width=\"${ifDefined(me.width > 0 ? me.width : false)}\" \r\n                height=\"${ifDefined(me.height > 0 ? me.height : false)}\" >\r\n            </canvas>`;\r\n    }\r\n\r\n    onDataRead(data) {\r\n        this.data = data;\r\n    }\r\n\r\n    get canvas() {\r\n        return this.#canvasRef.value;\r\n    }\r\n\r\n    // https://www.chartjs.org/docs/latest/developers/api.html\r\n\r\n    reset() {\r\n        this.#chart?.reset();\r\n    }\r\n\r\n    refresh() {\r\n        this.#chart?.render();\r\n    }\r\n\r\n    updateChart(val) {\r\n        this.#chart?.update(val);\r\n    }\r\n\r\n    stop() {\r\n        this.#chart?.stop();\r\n    }\r\n\r\n    clear() {\r\n        this.#chart?.clear();\r\n    }\r\n\r\n    resize(x, y) {\r\n        const me = this;\r\n        if (!me.#chart) return;\r\n        requestAnimationFrame(() => {\r\n            const div = me.query('div');\r\n            if (div) {\r\n                div.style.width = `${x}px`;\r\n                div.style.height = `${y}px`;\r\n            }\r\n            me.#chart.resize(x, y);\r\n        });\r\n    }\r\n\r\n    toBase64Image(type = \"image/png\", quality = 1) {\r\n        return this.#chart?.toBase64Image(type, quality);\r\n    }\r\n\r\n    // internal functions to render JSON from gs-items elements\r\n\r\n    async #render() {\r\n        const me = this;\r\n        try {\r\n            const options = await GSLoader.loadSafe(me.config, 'GET', null, true, {});\r\n            const data = await GSLoader.loadSafe(me.url, 'GET', null, true, []);\r\n            me.data = data;\r\n            me.options = options;\r\n        } catch (error) {\r\n            GSLog.error(null, error);\r\n        }\r\n    }\r\n\r\n    #renderData(data, options) {\r\n        const me = this;\r\n        const el = me.querySelector('gs-item[group=\"options\"]');\r\n        const opt = Object.assign(options, GSChartElement.toJson(el));\r\n\r\n        const sets = opt.data.datasets;\r\n        sets.forEach((o, i) => o.data = sets.length === 1 ? data : data[i] || []);\r\n\r\n        if (me.#chart) return me.updateChart(opt);\r\n\r\n        const ctx = me.canvas?.getContext('2d');\r\n        if (ctx) {\r\n            me.#chart = new GSChartElement.#Chart(ctx, opt);\r\n        } else {\r\n            GSLog.error(null, 'Failed to get canvas context');\r\n        }\r\n    }\r\n\r\n    async #waitInit() {\r\n        if (!GSChartElement.#isChart) await GSEvents.wait(document, 'gs-chart', 0, false);\r\n        this.requestUpdate();\r\n    }\r\n\r\n    static #isChart = false;\r\n    static #initializing = false;\r\n    static #Chart = null;\r\n\r\n    static async #init() {\r\n        const me = GSChartElement;\r\n        if (me.URL_LIB === false) return;\r\n        if (me.#isChart || me.#initializing) return;\r\n        me.#initializing = true;\r\n        try {\r\n            const origin = GSChartElement.URL_LIB;\r\n            const url = `${origin}/assets/chart/chart.mjs`;\r\n            const { Chart, registerables } = await import(url);\r\n            Chart.register(...registerables);\r\n            me.#Chart = Chart;\r\n            me.#isChart = true;\r\n            GSEvents.send(document, 'gs-chart');\r\n        } catch (e) {\r\n            GSLog.error(null, e);\r\n        } finally {\r\n            me.#initializing = false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Convert DOM tree into a JSON structure\r\n     * \r\n     * @param {HTMLElement} obj HTML element instance to convert\r\n     * @param {string} name DOM attribute name for object key\r\n     * @param {string} value DOM attribute name for object value\r\n     * @param {string} type DOM attribute name for object type\r\n     * @returns {object}\r\n     */\r\n    static toJson(el, name = 'name', value = 'value', type = 'type') {\r\n\r\n\r\n        if (!(el instanceof HTMLElement)) return {};\r\n\r\n        const nameV = el.getAttribute(name);\r\n        const valV = el.getAttribute(value);\r\n        const typeV = el.getAttribute(type);\r\n\r\n        let obj = null;\r\n\r\n        switch (typeV) {\r\n            case 'array':\r\n                obj = [];\r\n                break;\r\n            case 'object':\r\n                obj = {};\r\n                break;\r\n            default:\r\n                return GSChartElement.#toType(valV, typeV);\r\n        }\r\n\r\n        const childs = Array.from(el.children);\r\n        const isArray = typeV === 'array';\r\n        const isObject = typeV === 'object';\r\n\r\n        childs.forEach(el => {\r\n            const _nam = el.getAttribute(name);\r\n            if (isArray) {\r\n                obj.push(GSChart.toJson(el, name, value, type));\r\n            } else if (isObject) {\r\n                const tmp = GSChartElement.toJson(el, name, value, type);\r\n                obj[_nam] = tmp;\r\n            } else {\r\n                const _val = el.getAttribute(value);\r\n                const _typ = el.getAttribute(type);\r\n                obj[nameV][_nam] = GSChart.#toType(_val, _typ);\r\n            }\r\n        });\r\n\r\n        return obj;\r\n    }\r\n\r\n    static #toType(val, type) {\r\n        switch (type) {\r\n            case 'boolean': return val === 'true';\r\n            case 'number': return parseFloat(val);\r\n            default: return val\r\n        }\r\n    }\r\n\r\n    static {\r\n        this.define('gs-chart');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, ref, classMap, html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\nexport class GSHighlightElement extends GSElement {\r\n\r\n    static get URL_LIB() {\r\n        return globalThis.GS_URL_HLJS || 'https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0';\r\n    }\r\n\r\n    static properties = {\r\n        url: {},\r\n        theme: {},\r\n        target: {},\r\n        language: {},\r\n    }\r\n\r\n    #codeRef = createRef();\r\n    #data;\r\n\r\n    constructor() {\r\n        super();\r\n        this.theme = 'default';\r\n    }\r\n\r\n    willUpdate(changed) {\r\n        const me = this;\r\n        if (changed.has('theme')) me.#onTheme();\r\n        if (changed.has('target')) me.#onTarget();\r\n        if (changed.has('url')) me.#onURL();\r\n        if (changed.has('language')) me.#onHighlight(me.#data);\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<pre><code ${ref(me.#codeRef)} class=\"${classMap(me.renderClass())}\"><code/><pre/>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const hasLangauge = GSUtil.isStringNonEmpty(me.language);\r\n        const css = {\r\n            [`language-${me.language}`]: hasLangauge\r\n        }\r\n        return css;\r\n    }\r\n\r\n    /**\r\n     * Highligh some code in programmatic way\r\n     * \r\n     * @param {string} data \r\n     */\r\n    highlight(data = '', append = false) {\r\n        this.#data = data;\r\n        this.#onHighlight(data, append);\r\n    }\r\n\r\n    set content(val ='') {\r\n        this.#data = val;\r\n        this.#onHighlight(val);\r\n    }\r\n\r\n    get content() {\r\n        return this.#data;\r\n    }\r\n\r\n    async #onTheme() {\r\n        const url = `${GSHighlightElement.URL_LIB}/styles/${this.theme}.min.css`;\r\n        GSDOM.injectCSS(this, url);\r\n    }\r\n\r\n    /**\r\n     * Search with CSS query for element, if found, \r\n     * get innerHTML, and send to highlighting\r\n     */\r\n    #onTarget() {\r\n        const me = this;\r\n        const el = me.target ? GSDOM.query(me.target) : null;\r\n        if (!el) return GSDOM.setHTML(me.#code, `Element with id ${me.target} not found!`);\r\n        me.#data = el.innerHTML;\r\n        me.#onHighlight(el.innerHTML);\r\n    }\r\n\r\n    /**\r\n     * Download source from URL, then send to highlighting\r\n     */\r\n    async #onURL() {\r\n        const me = this;\r\n        try {\r\n            const data = await GSLoader.load(me.url);\r\n            if (!data) throw new Error(`Code URL ${me.url} unreachable!`);\r\n            me.#data = data;\r\n            me.#onHighlight(data);\r\n        } catch (error) {\r\n            GSDOM.setHTML(me.#code, error.message);\r\n        }\r\n    }\r\n\r\n    get #code() {\r\n        return this.#codeRef.value;\r\n    }\r\n\r\n    #onMessage(e) {\r\n        const me = this;\r\n        const content = e.data.data;\r\n        URL.revokeObjectURL(e.data.url);\r\n        GSDOM.setHTML(me.#code, e.data.append ? me.#code.innerHTML + content : content);\r\n        e.target.terminate();\r\n    }\r\n\r\n    #onHighlight(data = '', append = false) {\r\n        const me = this;\r\n        if (!data) return GSDOM.setHTML(me.#code, 'No data!');\r\n        try {\r\n            const response = me.#worker;\r\n            const blob = new Blob([response], { type: 'application/javascript' });\r\n            const blobURL = URL.createObjectURL(blob);\r\n            const worker = new Worker(blobURL);\r\n            worker.onmessage = me.#onMessage.bind(me);\r\n            worker.postMessage({ data: data, url: blobURL, append: append });\r\n        } catch (error) {\r\n            GSDOM.setHTML(me.#code, error.message);\r\n        }\r\n    }\r\n\r\n    get #worker() {\r\n        const me = this;\r\n        const langs = me.language ? me.language.split(',').map(v => `importScripts('${GSHighlightElement.URL_LIB}/languages/${v.trim()}.min.js');`).join('') : '';\r\n        return `globalThis.onmessage = (event) => {\r\n                importScripts('${GSHighlightElement.URL_LIB}/highlight.min.js');\r\n                ${langs}\r\n                const result = globalThis.hljs.highlightAuto(event.data.data);\r\n                postMessage({data:result.value, url:event.data.url, append: event.data.append});};`\r\n    }\r\n\r\n    static {\r\n        this.define('gs-highlight');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, html, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\nexport class GSMarkdownElement extends GSElement {\r\n\r\n    static get URL_LIB() {\r\n        return globalThis.GS_URL_MARKDOWN || 'https://unpkg.com/showdown/dist/showdown.min.js';\r\n    }\r\n\r\n    static properties = {\r\n        url: {},\r\n        history: { type: Number },\r\n        maxHeight: { type: Number, attribute: 'max-height' },\r\n    }\r\n\r\n    #containerRef = createRef();\r\n    #converter = null;\r\n    #last = null;\r\n    #first = null;\r\n    #root = null;\r\n    #path = null;\r\n    #cache = [];\r\n\r\n    #styleID = GSID.id;\r\n\r\n    constructor() {\r\n        super();\r\n        this.history = 10;\r\n        this.dynamicStyle(this.#styleID);\r\n    }\r\n\r\n    async connectedCallback() {\r\n        const me = this;\r\n        await me.#initLib();\r\n        if (globalThis.showdown) {\r\n            const opt = { tasklists: true, tables: true };\r\n            me.#converter = new globalThis.showdown.Converter(opt);\r\n            super.connectedCallback();\r\n        }\r\n    }\r\n\r\n    willUpdate(changed) {\r\n        const me = this;\r\n        if (changed.has('url')) {\r\n            me.#toCache(me.url);\r\n            me.#onURL(me.url);\r\n        }\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        const height = me.maxHeight > 0 ? `${me.maxHeight}px;` : false;\r\n        const opt = { 'max-height': height }\r\n        me.dynamicStyle(me.#styleID, opt);\r\n        return html`<div ${ref(me.#containerRef)} class=\"overflow-auto ${classMap(me.renderClass())}\"><div/>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const hasLangauge = GSUtil.isStringNonEmpty(me.language);\r\n        const css = {\r\n            [me.#styleID] : true,\r\n            [`language-${me.language}`]: hasLangauge\r\n        }\r\n        return css;\r\n    }\r\n\r\n    back() {\r\n        const me = this;\r\n        const url = me.#fromCache();\r\n        me.#onURL(url);\r\n    }\r\n\r\n    get root() {\r\n        return this.#root || '';\r\n    }\r\n\r\n    /**\r\n     * Return injection point for rendered markdown\r\n     */\r\n    get #container() {\r\n        return this.#containerRef.value;\r\n    }\r\n\r\n    /**\r\n     * Download source from URL, then send to rendering\r\n     */\r\n    async #onURL(url = '') {\r\n        const me = this;\r\n\r\n        url = me.#normalize(url);\r\n        if (!url) return;\r\n\r\n        let data = await GSLoader.load(url);\r\n        if (!data) return;\r\n\r\n        me.#path = me.#parent(url);\r\n        if (!me.#root) me.#root = me.#path;\r\n\r\n        // MD library error fix\r\n        data = data.replace(/^[-_\\*]{3}$/gm, '<hr>');\r\n\r\n        me.#container.innerHTML = me.#makeHtml(data);\r\n\r\n        GSEvents.send(me, 'data', url);\r\n        requestAnimationFrame(() => {\r\n            me.#handleLinks();\r\n            me.#handleTables();\r\n            me.#handleCode();\r\n        });\r\n    }\r\n\r\n    #normalize(url = '') {\r\n        const me = this;\r\n        if (!url || url.startsWith('http')) return url;\r\n        return me.#path ? new URL(url, me.#path).toString() :\r\n            GSLoader.normalizeURL(url, true);\r\n    }\r\n\r\n    #parent(url = '') {\r\n        return url.endsWith('/') ? url : GSLoader.parentPath(url);\r\n    }\r\n\r\n    #handleCode() {\r\n        this.#handleStyles('pre:has(code)', 'text-white bg-dark p-1');\r\n    }\r\n\r\n    #handleTables() {\r\n        const me = this;\r\n        const clss = \"table table-light table-hover table-striped table-bordered w-auto shadow-sm\";\r\n        me.#handleStyles('table', clss);\r\n    }\r\n\r\n    #handleStyles(qry, css) {\r\n        const me = this;\r\n        const list = GSDOM.queryAll(me.#container, qry);\r\n        requestAnimationFrame(() => list.forEach(el => GSDOM.toggleClass(el, css)) );\r\n    }\r\n\r\n    #handleLinks() {\r\n        const me = this;\r\n        const links = GSDOM.queryAll(me.#container, 'a').filter(el => !GSAttr.get(el, 'href').startsWith('#'));\r\n\r\n        links\r\n            .filter(el => !(GSAttr.get(el, 'href').endsWith('.md') || GSAttr.get(el, 'href').endsWith('/')))\r\n            .forEach(el => el.target = \"_blank\");\r\n\r\n        links\r\n            .filter(el => GSAttr.get(el, 'href').endsWith('.md') || GSAttr.get(el, 'href').endsWith('/'))\r\n            .forEach(el => GSEvents.attach(el, el, 'click', me.#onLinkClick.bind(me)));\r\n\r\n    }\r\n\r\n    #onLinkClick(e) {\r\n        const me = this;\r\n        const el = e.target;\r\n        const href = GSAttr.get(el, 'href');\r\n        if (href.startsWith('#')) return;\r\n        GSEvents.prevent(e);\r\n        el.href = me.#normalize(href);\r\n\r\n        const success = GSEvents.send(me, 'link', el.href, false, false, true);\r\n        if (!success) return;\r\n\r\n        me.#toCache(el.href);\r\n        me.#onURL(el.href);\r\n        return false;\r\n    }\r\n\r\n    #fromCache() {\r\n        const me = this;\r\n        if (me.#cache.length === 0 ) return me.#first;\r\n        const url = me.#cache.pop();\r\n        return url && url === me.#last ? me.#fromCache() : url;\r\n    }\r\n\r\n    #toCache(url) {\r\n        const me = this;\r\n        if (me.#cache.length >= me.history) me.#cache = me.#cache.slice(1);\r\n        if (me.#last == url) return;\r\n        me.#cache.push(url);\r\n        me.#last = url;\r\n        if (!me.#first) me.#first = url;\r\n    }\r\n\r\n    #makeHtml(data) {\r\n        return this.#converter.makeHtml(data);\r\n    }\r\n\r\n    async #initLib() {\r\n        const me = this;\r\n        if (globalThis.showdown) return;\r\n        const script = document.createElement('script');\r\n        const promise = GSEvents.wait(script, 'load', 0, false);\r\n        script.type = \"text/javascript\";\r\n        script.src = GSMarkdownElement.URL_LIB;\r\n        GSDOM.appendChild(document.head, script);\r\n        await promise;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-markdown');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2026; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, html, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\n\r\nexport class GSMonacoElement extends GSElement {\r\n\r\n    static get URL_LIB() {\r\n        return globalThis.GS_URL_MONACO || 'https://unpkg.com/monaco-editor@latest/min/';\r\n    }\r\n\r\n    static properties = {\r\n        url: {},\r\n        theme: {},\r\n        target: {},\r\n        language: {},\r\n    }\r\n\r\n    #containerRef = createRef();\r\n    #editor = null;\r\n\r\n    constructor() {\r\n        super();\r\n        this.language = '';\r\n        this.theme = 'vs-dark';\r\n    }\r\n\r\n    async connectedCallback() {\r\n        await GSMonacoElement.#init();\r\n        super.connectedCallback();\r\n    }\r\n\r\n    createRenderRoot() {\r\n        return this;\r\n    }\r\n\r\n    firstUpdated() {\r\n        this.#onMonacoReady();\r\n        super.firstUpdated();\r\n    }\r\n\r\n    willUpdate(changed) {\r\n        const me = this;\r\n        if (!me.#editor) return;\r\n        if (changed.has('theme')) me.#onTheme(me.theme);\r\n        if (changed.has('target')) me.#onTarget(me.target);\r\n        if (changed.has('url')) me.#onURL(me.url);\r\n        if (changed.has('language')) me.#onLanguage(me.language);\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div ${ref(me.#containerRef)} class=\"${classMap(me.renderClass())}\"><div/>`;\r\n    }\r\n\r\n    get monaco() {\r\n        return window.monaco;\r\n    }\r\n\r\n    get editor() {\r\n        return this.#editor;\r\n    }\r\n\r\n    get model() {\r\n        return this.#editor.getModel();\r\n    }\r\n\r\n    /**\r\n     * Get editor code \r\n     * \r\n     * @param {string} data \r\n     */\r\n    get code() {\r\n        return this.#editor?.getValue() || '';\r\n    }\r\n\r\n    set code(data = '') {\r\n        const me = this;\r\n        if (me.#editor) me.#editor.setValue(data);\r\n    }\r\n\r\n    /**\r\n     * Get text selected in Monaco\r\n     */\r\n    get selection() {\r\n        const me = this;\r\n        return me.model.getValueInRange(me.editor.getSelection());\r\n    }\r\n\r\n    get owner() {\r\n        return this.parentElement;\r\n    }\r\n\r\n    #onLanguage(language) {\r\n        const me = this;\r\n        if (me.monaco && language) {\r\n            me.monaco.editor.setModelLanguage(me.model, language);\r\n        }\r\n    }\r\n\r\n    #onTheme(theme) {\r\n        const me = this;\r\n        if (me.monaco && theme) me.monaco.editor.setTheme(theme);\r\n    }\r\n\r\n    /**\r\n     * Search with CSS query for element, if found, \r\n     * get innerHTML, and send to highlighting\r\n     */\r\n    #onTarget(target) {\r\n        const me = this;\r\n        const el = target ? GSDOM.query(target) : null;\r\n        if (!el) return me.code = `Element with id ${target} not found!`;\r\n        me.code = el.innerHTML;\r\n    }\r\n\r\n    /**\r\n     * Download source from URL, then send to highlighting\r\n     */\r\n    async #onURL(url) {\r\n        const me = this;\r\n        try {\r\n            const data = url ? await GSLoader.load(url) : null;\r\n            if (!data) throw new Error(`Code URL ${url} unreachable!`);\r\n            me.code = '';\r\n            me.#onLanguage(me.language);\r\n            me.code = data;\r\n        } catch (error) {\r\n            me.code = error.message;\r\n        }\r\n    }\r\n\r\n    #onMonacoReady() {\r\n\r\n        const me = this;\r\n\r\n        const opt = {\r\n            value: ``,\r\n            language: me.language,\r\n            theme: me.theme,\r\n            automaticLayout: true,\r\n            minimap: { enabled: false }\r\n        };\r\n\r\n        me.#editor = me.monaco?.editor?.create(me.#container, opt);\r\n\r\n        me.attachEvent(window, 'resize', me.#onResize.bind(me));\r\n\r\n        try {\r\n            if (me.url) {\r\n                me.#onURL(me.url);\r\n            } else if (me.target) {\r\n                me.#onTarget(me.target);\r\n            }\r\n        } finally {\r\n            requestAnimationFrame(() => me.emit('initialized'));\r\n            me.#onResize();\r\n        }\r\n    }\r\n\r\n    #onResize(e) {\r\n        const me = this;\r\n        if (!me.#editor) return;\r\n        me.#editor.layout({ width: 0, height: 0 });\r\n\r\n        requestAnimationFrame(() => {\r\n            const rect = me.owner?.getBoundingClientRect();\r\n            if (rect) {\r\n                me.#editor.layout({ width: rect.width, height: rect.height });\r\n            }\r\n        });\r\n    }\r\n\r\n    get #container() {\r\n        return this.#containerRef.value;\r\n    }\r\n\r\n    static #initialized;\r\n\r\n    static async #initLib() {\r\n        if (globalThis.monaco) return;\r\n        const script = document.createElement('script');\r\n        const promise = GSEvents.wait(script, 'load', 0, false);\r\n        script.type = \"text/javascript\";\r\n        script.src = `${GSMonacoElement.URL_LIB}vs/loader.js`;\r\n        GSDOM.appendChild(document.head, script);\r\n        await promise;\r\n    }\r\n\r\n    // Before loading vs/editor/editor.main, define a global MonacoEnvironment that overwrites\r\n    // the default worker url location (used when creating WebWorkers). The problem here is that\r\n    // HTML5 does not allow cross-domain web workers, so we need to proxy the instantiation of\r\n    // a web worker through a same-domain script\r\n    static #initEnv() {\r\n        const url = GSMonacoElement.URL_LIB;\r\n        window.MonacoEnvironment = {\r\n            baseUrl: `${url}`,\r\n            getWorkerUrl: (workerId, label) => {\r\n                return `data:text/javascript;charset=utf-8,${encodeURIComponent(`\r\n                globalThis.MonacoEnvironment = {baseUrl: '${url}'};\r\n                importScripts('${url}vs/base/worker/workerMain.js');`\r\n                )}`;\r\n            }\r\n        };\r\n    }\r\n\r\n    static #initMonaco() {\r\n        return new Promise((resolve, reject) => {\r\n            // TODO  set disabled to true and manually load themes into shadow dom\r\n            require.config({\r\n                paths: { 'vs': `${GSMonacoElement.URL_LIB}/vs` },\r\n                'vs/css': { disabled: false }\r\n            });\r\n            require(['vs/editor/editor.main'], resolve);\r\n        });\r\n    }\r\n\r\n    static async #init() {\r\n        const me = GSMonacoElement;\r\n        if (me.#initialized) return;\r\n        me.#initEnv();\r\n        await me.#initLib();\r\n        await me.#initMonaco();\r\n        me.#initialized = true;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-monaco');\r\n    }\r\n\r\n}"],"names":["GSVersion","version","build","gsstyles","KEY","Symbol","for","OWNER","PARENT","HANDLER","GROUP","EVENTID","NEXT","PREV","RENDER","DEF","GSLog","static","el","msg","this","print","tracing","forced","type","logging","tmp","nodeName","id","fn","console","log","Error","Object","seal","GSUtil$1","GSUtil","globalThis","GS_FLAT","n","isNaN","parseFloat","isFinite","v","Date","Boolean","value","toString","val","normalize","toLowerCase","str","obj","replace","x","g","split","reverse","join","word","toUpperCase","slice","map","i","capitalize","constructor","o","Array","isArray","isBool","isDate","isNumber","isString","min","max","Math","match","isNull","dft","language","sep","numberSeparator","extractNumber","replaceAll","url","test","trim","startsWith","endsWith","pattern","charset","floor","random","length","navigator","languages","flags","RegExp","isStringEmpty","undefined","Intl","NumberFormat","format","DateTimeFormat","string","reg","keys","JSON_CHECK","lastIndex","isJsonString","isJsonType","JSON","parse","normalizeJson","warn","JSON_NORMALIZE","def","separator","filter","capitalizeAll","tpl","params","names","vals","values","Function","text","textArea","document","createElement","innerHTML","isStringNonEmpty","window","forEach","a","left","right","lmatch","rmatch","time","signal","AbortSignal","timeout","Promise","resolve","reject","iid","setTimeout","bind","addEventListener","clearTimeout","data","name","blob","Blob","URL","createObjectURL","href","download","click","revokeObjectURL","clazz","ext","freeze","expose","HTMLElement","isPrototypeOf","customElements","get","define","extends","isSealed","isFrozen","self","src","import","result","permissions","query","state","clipboard","writeText","readText","GSFunction$1","GSFunction","isFunction","includes","own","isFunctionDefined","desc","Reflect","getOwnPropertyDescriptor","__proto__","isValid","callFunctionAsync","toStringTag","owner","args","arguments","from","apply","native","parseFunction","isFunctionNative","isFunctionAsync","callFunctionSync","parseValue","context","cnt","async","contextualize","accept","queueMicrotask","e","func","leading","debounceLifo","debounceFifo","timer","GSID","prefx","next","s","l","h","charCodeAt","isProxy","GSAttr","isHTMLElement","asBool","setAttribute","removeAttribute","isInstance","getAttribute","attr","asNum","toJson","set","NaN","stringify","entries","kv","attributes","host","opt","recursive","Proxy","target","prop","dataset","attribute","toggle","Number","setAsNum","children","proxify","safe","unsafe","dflt","default","multi","hasAttribute","toStringArray","GSCSSMap","body","computedStyleMap","element","getMap","me","modern","capitalizeAttr","asText","to","unit","num","shift","matches","getComputedStyle","getComputedStyledMap","String","on","selText","ors","some","selector","logicalORs","styleSheets","cssRules","reduce","all","concat","containsAny","selectorText","GSDate","DEFAULT_FORMAT","asJSON","REGEX_FORMAT","last","getDate","first","getDay","mondayFirst","isMondayFirst","days","fill","push","year","getFullYear","setFullYear","month","getMonth","setMonth","day","setDate","YY","YYYY","M","MM","padStart","MMM","toLocale","MMMM","D","DD","d","dd","ddd","weekday","dddd","H","getHours","HH","formatHour","hh","meridiem","A","m","getMinutes","mm","getSeconds","ss","SSS","getMilliseconds","Z","zoneStr","ZZ","Q","ceil","k","kk","W","date","getTime","setHours","week1","round","WW","X","short","offset","Locale","getWeekInfo","firstDay","charAt","toLocaleString","size","isLowercase","hour","hour12","pop","negMinutes","getTimezoneOffset","minutes","abs","minuteOffset","getDateFormat","regex","getFormattedDateRegex","parseFormattedDate","groups","y","Y","valueOf","GSData","currency","extract","key","Set","b","every","index","toSorted","compareArrays","second","advanced","arr","indexOf","list","it","cfg","toType","rule","toRegex","childElementCount","querySelector","fmt","style","fields","limit","sts","rec","filterRecord","isPrimitive","filterSimple","filterComplex","filterValue","primitive","found","flt","toCheck","matchDate","matchNumber","op","toLocaleLowerCase","local","toLocaleDateString","iso","toISOString","operator","sort","sortPair","ord","idx","col","v1","v2","compare","order","compareNum","compareString","compareBool","s1","s2","localeCompare","ignoreNull","seg","writeSingleToObject","tree","hasOwnProperty","partial","r","readFromProperty","readFromObject","GSDOM","walk","isTemplateElement","cleanup","content","parentElement","removeChild","nodeValue","activeElement","active","shadowRoot","css","visibility","display","opacity","rect","getBoundingClientRect","width","height","html","single","mime","doc","DOMParser","parseFromString","head","firstElementChild","error","forceWrap","nodes","fromNode","wrap","appendChild","link","slot","isText","tagName","FORMEL","shadow","queryAll","HTMLButtonElement","hasClass","ownClazz","inheritance","pel","HTMLSelectElement","HTMLSlotElement","HTMLTemplateElement","SVGElement","Text","Comment","clazzName","parentAll","ShadowRoot","childNodes","isGSElement","orientation","classList","add","remove","newEl","injectable","isSVGElement","isOK","invalid","parentNode","nextElementSibling","insertBefore","placement","isok","insertAdjacentElement","parent","node","closest","childAll","child","offsetParent","c","HTMLBodyElement","root","getByID","documentElement","qry","levels","proxy","res","receiver","sanitize","sanitizer","setHTML","Document","textContent","requestAnimationFrame","assign","toggleClass","contains","unwrap","querySelectorAll","defaults","valueAsNumber","selectedOptions","checked","defaultValue","getValue","styleValue","textTransform","ignore","checkValidity","fromElement2Object","fromObject2Element","objectPathExist","fromValue","noEmpty","writeToObject","toValue","plain","definitions","innerText","props","allProperties","getAsNum","items","tag","asString","fromJsonAsString","fromJsonAsDOM","title","sub","location","hash","setValue","group","createTreeWalker","NodeFilter","SHOW_TEXT","nextNode","ts","textNodesUnder","t","wholeText","nextSibling","CLEANUP1","whiteList","asState","isAllowed","toValidationError","allowElement","allowTag","fetch","ok","sheet","CSSStyleSheet","replaceSync","adoptedStyleSheets","isFormElement","resetSelect","typed","isSelect","options","selected","dispatchEvent","Event","bubbles","composed","properties","mergeObjects","template","CustomEvent","globalDispatch","detail","message","GSEvents","Map","altContext","protect","listen","onContext","onKeyDown","event","shiftKey","prevent","code","ctrlKey","callback","loaded","wait","callFunction","sendSuspended","once","chained","suspended","removeEventListener","unlisten","toSignal","internal","evt","propagate","immediate","preventDefault","stopPropagation","stopImmediatePropagation","sender","cancelable","send","ClipboardEvent","FocusEvent","InputEvent","KeyboardEvent","MouseEvent","SubmitEvent","TouchEvent","WheelEvent","PointerEvent","capture","Window","isConnected","hasFunction","eventKey","elmap","getElementMap","eventMap","fnkey","defineProperty","gsid","writable","delete","removeListener","cache","removeElementMap","clear","elid","getElementID","fnid","getCallbackID","hashCode","action","onAction","prefix","findAction","onError","GS_LOG_ACTION","rid","waitAnimationFrame","onResize","attach","waitPageLoad","GSAbortController","AbortController","super","abort","clearInterval","GSDOMObserver","MutationObserver","observe","childList","subtree","observer","onObserve","forRemove","filtersDel","filtersAdd","hasFilters","hasFiltersAdd","hasFiltersDel","mutations","mutation","addedNodes","removedNodes","rootEL","filters","isFunctions","getFilter","exec","create","GSDynamicStyle","toName","raw","deleteRule","getRule","setRule","sync","insertRule","updateRule","isImportant","setProperty","source","dynamicStyleSheetByID","dynamicStyleSheet","gsClass","dynamicRule","dynamicRuleByID","dynamicStyle","dynamicStyleByID","GSCacheStyles","store","dynamic","styles","adopt","adoptedId","GSAdoptedEngine","now","preload","timerID","setInterval","sheets","adoptable","adoptSheet","update","scheduled","sorted","ID","cssText","monitorAttributes","ownerNode","adoptStyle","disconnect","mutationList","disabled","onAttributeChange","attributeFilter","attributeOldValue","HTMLLinkElement","rel","as","HTMLStyleElement","then","adoptLink","registerFilter","onMonitorFilter","onMonitorConnect","onMonitorDisconnect","init","GSLoader","GS_TEMPLATE_URL","origin","GS_ROUTER_URL","rootURL","defaultURL","TEMPLATE_URL","ROUTER_URL","hasKey","NO_CACHE","GS_NO_CACHE","localStorage","setItem","getItem","base","path","isFile","pathname","isExt","uri","UNIQUE","searchParams","append","level","isHTML","getRouterURL","loadSafe","routerURL","normalizeURL","routerPath","getTemplateURL","templateURL","templatePath","method","load","headers","asjson","ct","Accept","json","isJson","isFunc","GSTemplateCache","cloneNode","cached","getOrCreate","isHTMLTemplate","initTemplate","loadTemplate","isFunctionTemplate","loadHTMLTemplate","loadFunctionTemplate","loadURLTemplate","GSAttributeHandler","anchor","call","inject","property","swap","trigger","hashed","calls","toggles","triggers","targetList","handle","targets","handleTarget","handleBinding","handleAction","handleSwap","handleInject","handleAttribute","handleProperty","handleToggle","handleTrigger","handleEvent","handleCall","handleExec","handleTemplate","field","form","isForm","HTMLFormElement","isField","toObject","isAttributeJSON","jsonToAttr","toggleAttribute","isPropertyJSON","toggleProperty","isToggling","isActive","tout","symbol","handleContent","clean","useDef","definition","toHTML","gsHashed","applyContent","applyTemplate","clone","insertAdjacent","detach","off","parentComponent","toggling","DEFINITION","gsTarget","override","GSBeep","AudioContext","webkitAudioContext","audioContext","duration","frequency","volume","isAvailable","audioCtx","oscillatorNode","createOscillator","gainNode","createGain","connect","destination","gain","start","currentTime","stop","onended","hasBeenActive","userActivation","GSEnvironment","isMobile","userAgentData","mobile","userAgent","isDesktop","isWebkit","protocol","strVal","brands","brand","strAgt","isEdge","isDevice","platform","screen","otype","GSPromise","callbacks","promise","onAbort","await","aborted","onResolve","onReject","ps","p","GSEvent","EventTarget","listeners","listener","abortable","controller","emit","delayed","unbind","GSEventBus","register","registry","has","exist","bus","GSGesture","xDiff","yDiff","xDown","yDown","bindings","swipe","tap","longPress","delay","move","handleTouchMove","handleTouchStart","end","handleTouchEnd","touches","clientX","clientY","onLongPress","xUp","yUp","GSItem","autofocus","validate","GSElement","tags","collect","GS_LOCALIZATION_LANGUAGE","lang","GSLocalization","GSLocalizationImpl","queue","queued","GS_LOCALIZATION_URL","translate","deft","getLanguage","texthash","reset","promises","loadWait","sequential","Pragma","isDefault","hk","details","GSPopper","asRect","sx","scrollX","sy","scrollY","top","bottom","centerX","centerY","calcPadding","padding","elementPadding","paddingX","paddingY","elementWidth","clientWidth","elementHeight","clientHeight","elementX","elementY","arrow","pos","fromPlacement","isPlacementValid","position","margin","transform","offh","offw","boundingRect","arect","updateArrow","offH","offW","srcH","srcW","calcFixed","astyle","inset","srect","getOffset","calcAbsolute","aopt","isTop","isBottom","isStart","isEnd","trect","erect","arrowPosW","arrowPosH","applyDynamicStyle","GSQueryCSS","object","GSQuery","instance","GSRouter","enabled","hashCallback","onHashChange","getRouter","loadDefinition","enable","disable","route","unregister","deepClone","px","fromJson","GS_DEFINITION_URL","initialize","GS_ROUTER_WAIT","GSTheme","switch","theme","STORAGE","htmlEl","bsTheme","matchMedia","q","URLSearchParams","onTheme","settings","getSystemDefaultTheme","darkMode","lightMode","setup","BinaryTreeNode","isLeaf","hasChildren","isRoot","BinaryTree","inOrderTraversal","postOrderTraversal","preOrderTraversal","insert","parentNodeKey","canInsertLeft","canInsertRight","find","Node","previous","release","toJSON","DoublyLinkedList","tail","previousNode","insertAt","splice","insertFirst","insertLast","getAt","removeAt","full","acc","toArray","iterator","isInvalid","isInvalidIndex","isInteger","LinkedList","cb","asValues","asNodes","Stack","item","unshift","peek","isEmpty","Queue","enqueue","dequeue","Tree","folder","leaf","up","levelID","nodeID","isFolder","hasMore","firstChild","lastChild","down","previousSibling","inclusive","flat","iterate","filtered","br","newOne","findByKey","flatten","fromJSON","hasParent","DataSelector","SELECT","asArray","removeSelected","isSelected","GSReadWriteRegistryImpl","handlers","INTERNAL","addHandler","removeHandler","getHandler","newHandler","verify","rw","resetRegistry","GSReadWriteRegistry","GSAbstractReadWrite","processors","addProcessor","processor","removeProcessor","isRegistered","notify","onRead","postRead","onWrite","postWrite","addSelected","clearSelected","getSelected","GSReadWrite","reader","writer","mode","skip","TYPE","MODES","isQuark","METHOD","toURL","encodeURIComponent","fromLiteral","isOffline","isRemote","GSCachedReadWrite","reformat","records","postFilter","sortData","filterData","search","read","TreeNode","opened","focused","focusedNode","selectedNode","controllers","select","focus","open","addController","removeController","visible","expand","collapse","changed","onFocusChanged","onSelectionChanged","isPartialySelected","selectAll","deselectAll","selectionFlag","onSelectAll","onDeselectAll","selectedNodes","refresh","onRefresh","loading","onLoad","expandAll","collapseAll","expanded","collapsed","onExpand","onCollapse","onAppend","onInsert","GSTreeReader","resetData","litUrl","GS_LIT_URL","litModule","ReactiveController","ReactiveElement","AsyncDirective","AsyncReplaceDirective","CSSResult","Directive","LitElement","PartType","TemplateResultType","UnsafeHTMLDirective","UntilDirective","_$LE","_$LH","adoptStyles","asyncAppend","asyncReplace","choose","classMap","clearPart","createRef","defaultConverter","directive","getCommittedValue","getCompatibleStyle","getDirectiveClass","guard","ifDefined","insertPart","isCompiledTemplateResult","isDirectiveResult","isServer","isSingleExpression","isTemplateResult","keyed","literal","live","noChange","notEqual","nothing","range","ref","removePart","render","repeat","setChildPartValue","setCommittedValue","staticHtml","staticSvg","styleMap","supportsAdoptingStyleSheets","svg","templateContent","unsafeCSS","unsafeHTML","unsafeSVG","unsafeStatic","until","when","withStatic","gsAction","gsAnchor","gsAttribute","gsCall","gsExec","gsInject","gsProperty","gsSwap","gsTemplate","gsToggle","gsTrigger","gsValue","gsTimeout","DatasetDirective","part","srcset","DOMStringMap","remap","hasOwn","descriptors","getOwnPropertyDescriptors","listProperties","listGetters","getPrototypeOf","literalTemplate","listGettable","cssMap","CssMapDirective","partInfo","ATTRIBUTE","strings","classInfo","_previousClasses","_staticClasses","notEmpty","newVal","oldVal","numGT0","numGE0","numLT0","numLE0","AutocapitalizeTypes","autocapitalize","hasChanged","AutocompleteTypes","autocomplete","AutocorrectTypes","autocorrect","ButtonTypes","isType","buttonType","is","ColorTypes","color","EnvironmentTypes","environment","InputTypes","inputType","NavTypes","nav","OrientationTypes","PlacementTypes","PositionTypes","ProtocolTypes","SizeTypes","normal","medium","small","large","big","extra","stringArrayConverter","fromAttribute","toAttribute","AdoptedController","hostConnected","hostDisconnected","isGlobal","removeRule","staticRules","hasRules","renderRoot","onAdopted","AttributeController","eventName","onNotify","isFormEl","ContentController","refs","removeContent","hostUpdated","isSelf","contentRef","renderOptions","renderBefore","previousElementSibling","keep","DataController","readCallback","writeCallback","errorCallback","selectCallback","onSelect","write","storeID","firstPage","page","lastPage","nextPage","prevPage","storage","requestUpdate","onDataRead","onDataWrite","onDataError","ElementMoveController","attached","cursorX","cursorY","mouseUpCallback","mouseDownCallback","mouseMoveCallback","onMouseUp","onMouseDown","onMouseMove","attachEvent","removeEvent","onStartMove","onEndMove","onCursorRight","onCursorLeft","onCursorUp","onCursorDown","LocalizationController","hostUpdate","updateLanguage","updateLanguageExt","langauge","onLanguage","OrientationController","hosts","onOrientation","TemplateController","lastRef","isPrefetch","GS_TEMPLATE_PREFETCH","templateRef","toKey","schedule","hasUpdated","templateInjected","simple","slots","hasSlots","hasSimple","preprocessTemplate","templateSimple","templateSlots","templates","isTplEl","cacheable","err","gsCache","tasks","task","process","finally","ThemeController","updateTheme","updateThemeExt","SlotController","onSlotChanged","assignedElements","onSlotInjected","rtl","reflect","hide","rounded","bordered","onready","os","browser","adopted","uiHandler","localization","dataController","slotController","themes","refx","attributeChangedCallback","oldValue","newValue","connectedCallback","isBindable","binded","disconnectedCallback","detachListeners","ruleName","shouldUpdate","changedProperties","createRenderRoot","firstUpdated","willUpdate","updateHide","updateStorage","isAllowRender","renderUI","renderTemplate","renderClass","border","mapCSS","flag","waitEvent","direction","isFocused","isValidEnvironment","isValidBrowser","isValidOS","isValidProtocol","isValidOrientation","isGenerated","elementStyles","styleSheet","cssRule","rules","setCSSProperty","ElementNavigationController","onClickListener","onKeyUpListener","onKeyDownListener","onFocusInListener","onFocusOutListener","childTagName","onClick","onKeyUp","onFocusIn","onFocusOut","firstUpdate","circular","multiple","gsChildTagName","blur","onReset","onSelected","onDeselected","onFocused","isNavigable","isNav","relatedTarget","composedPath","GroupController","busEvent","busCallback","onBusEvent","GSRouterElement","router","updated","GSAccordionElement","autoclose","cssItem","cssHeader","cssBody","renderItems","close","isItemCloser","GSAccordionItemElement","component","GSAlertElement","closed","closable","pause","interval","handleBillboard","show","isBillboard","button","billboard","GSButtonElement","clickCss","hoverCss","toggleColor","outline","icon","tooltip","refEl","refIco","gsType","onMouseOver","onMouseOut","onDisabled","iconEl","animate","onHref","isReset","isSubmit","submit","buttonEl","hover","iconHtml","renderIcon","GSCalendarElement","editable","minYear","maxYear","arrovPrev","arrowNext","cssDays","cssToday","cssWeeks","cssMonth","cssYear","cssNav","cssSelected","arrowPrev","previousMonth","nextMonth","previousYear","nextYear","formatted","updateTarget","week","dayList","months","monthsHTML","yearHTML","onKey","onDay","daysHTML","tgt","HTMLInputElement","valueAsDate","isToday","today","c1","c2","current","monthList","onMonth","optionsHTML","onYear","isList","listID","selectedIndex","yearEl","validity","valid","GSCardElement","imageStyle","overlay","align","image","subtitle","footer","header","colorText","colorBack","colorBorder","cssTitle","cssSubtitle","cssFooter","cssImage","styleID","isVertical","renderVertical","renderHorizontal","imageTop","imageBottom","isBefore","startClass","endClass","startHtml","images","endHtml","isHorizontal","imageSlot","GSCenterElement","GSMenuElement","auto","dark","menuRef","closeSubmenus","updatePosition","onMouseLeave","submenu","dropend","dropstart","popup","caller","isMouseOrPointerEvent","renderSubmenu","renderHeader","renderMenu","renderDivider","menu","toSubmenu","menuItem","isSubmenu","innerWidth","GSContextElement","isInTable","attachTarget","assignedSlot","onPopup","GSCompareElement","background","before","after","elRef","clipRef","slideRef","mouseController","elPosition","splitter","onDoubleClick","isAuto","pct","isFixed","slider","clip","GSControllerElement","module","changes","GSCopyrightElement","company","isCompany","isYear","GSDataHandler","autoload","autorefresh","config","handler","lifoReadRef","lifoWriteRef","itemHolder","PROPERTIES","initLIFO","updateHandler","formatSort","formatFilter","isDebug","gsDebug","isCached","formated","save","verifyHandler","callOnceLifo","lifoReadRefCallback","lifoWriteRefCallback","lifoCall","GSDialogElement","standard","escapable","cancelText","confirmText","minWidth","buttonAlign","iconCancel","iconConfirm","colorCancel","colorConfirm","cssCancel","cssConfirm","cssContent","pass","dialogRef","btnConfirmRef","btnCancelRef","CSS","TITLE_CSS","HEADER_CSS","ALIGN","CANCEL","CONFIRM","updateStack","allowed","onOpenChanged","STACK","dialog","showModal","focusable","isHashed","afterOpen","afterClose","isDialog","renderConfirm","onBtnConfirm","renderCancel","onBtnCancel","renderFooter","renderContent","card","onDlgClose","onDlgCancel","onFormValidation","info","confirm","prompt","forms","f","tab","btnConfirm","btnCancel","QUERY_INPUT","isVisible","requestClose","GSDrawerElement","backdrop","scroll","fingers","transition","cssHead","onLeave","onEnter","hasHeader","headSlot","GSDropdownElement","renderButton","buttonClass","btn","GSEmailElement","user","domain","dev","updateUser","updateDomain","GSFormElement","acceptCharset","autocopy","autoselect","autovalidate","autoreport","autosubmit","enctype","novalidate","block","beep","formRef","lastState","formChange","formValidation","formEnabled","formDisabled","elementTemplate","formReset","formSubmit","submitButton","resetButton","elements","inputs","reportValidity","tplEl","GSFormGroupElement","layout","label","description","placeholder","mask","spellcheck","noAccessor","rows","cols","step","minLength","maxLength","selectable","autoid","reveal","readonly","required","invalidMessage","cellField","cellLabel","cssLabel","cssField","inputRef","ouptutRef","patterns","internals","attachInternals","validateAllowed","ICON","CSS_LABEL","CSS_LABEL_CELL","formComponent","SELECTOPT","renderFloating","cssCheck","renderInput","renderOutput","renderLabel","renderInfo","renderLabelWrap","renderField","isIcon","CSS_ICON","renderTooltip","isRange","idattr","isFieldset","radioLayout","fieldSet","inputHTML","selectHTML","isTextArea","fld","vertical","initStyle","renderOption","onChange","onBlur","listHTML","outerHTML","isBlock","isBeep","onInput","onInvalid","isSwitch","isCheckable","isFloating","setFormValue","setValidity","validationMessage","tagList","isCheck","isRadio","isChecked","isPassword","isEmail","isURL","GSFormPanelElement","renderFormGroup","formaction","formenctype","formmethod","formnovalidate","formtarget","maxlength","minlength","GSGroupElement","controllerGroup","initData","prerender","of","renderWrappedUI","renderWrappedClass","generated","getName","GSIconElement","superColor","_clicked","_hovered","postAnimate","fs","GSIndentElement","multiplier","numdef","GSImageElement","invert","grayscale","brightness","contrast","saturate","hue","sepia","alt","imageRef","complete","renderStyle","buildFilter","GSLayoutElement","resizable","autofit","vPos","hPos","els","dyncss","horizontal","lev","tc","dir","did","panelCSS","panelStyle","resize","grow","vpos","hpos","GSLinklement","ping","GSListElement","GSListItemElement","initial","isMatchHashBang","renderFirst","renderSecond","itemCSS","itemStatusCSS","isSelectable","renderText","activeCSS","cssActive","inactiveCSS","cssInactive","GSMouseElement","pageX","pageY","screenX","screenY","offsetX","offsetY","onMouse","GSMovableElement","onMove","cursor","updateCursor","GSNavElement","isTab","GSNavItemElement","badge","badgeColor","badgeValue","parentType","badgeUI","itemsCSS","buttonCSS","buildCSS","cssButton","navType","GSOverlayElement","autoremove","radius","styleID2","innerHeight","fillRule","clipRule","strokeLinejoin","strokeMiterlimit","zIndex","pathStr","createSVGPathString","pointerEvents","windowX","windowY","limitedRadius","normalizedRadius","highlightBoxWidth","highlightBoxHeight","GSPagerElement","pages","labelFirst","labelLast","labelNext","labelPrevious","half","renderPrevious","renderItem","renderNext","renderLast","pagination","decodeHTMLEntities","toTarget","ctrl","GSPopupElement","wMin","wMax","hMin","hMax","panelRef","onAuto","reposition","postPopup","popupFixed","panel","overflowH","overflowV","GSPopoverElement","arrowRef","arrowID","attachEvents","popover","fade","isFocusTrigger","isHoverTrigger","popupAbsolute","onFocus","GSProgressElement","updateStyle","percentage","onKeySelect","increase","decrease","trunc","old","GSSpinnerElement","pulsar","GSSplitterElement","styleTGT","cssUpdate","lock","updateMouse","isPreceeding","isStyleValue","styleDynamic","lockable","csize","cls","gsSplitter","updateX","updateY","dx","GSTabItemElement","updateCSS","tabCSS","panelByName","GSTabPanelElement","tabByName","tabs","GSTabGroupElement","findPanel","isAfter","renderTabs","panels","renderPanels","updatePanelState","GSTableElement","colspan","hidden","fixed","filterType","cssFilter","colorFilter","colorHead","colorSelect","colorSort","stripedColumn","divider","striped","grid","borderless","columns","datacolumn","multisort","multiselect","protected","sortable","sortOrder","headColor","CELLS","table","stripedColumns","renderFilters","onSort","entry","renderColumn","renderRecord","renderEmpty","renderHandler","columnType","columType","input","valueAt","row","cell","cfgType","timestamp","dataType","renderFilter","hasSub","onFilter","listid","icons","sortType","cells","remapRecord","renderCell","record","elementTofilter","column","getElementIndex","prepareSorter","isComplex","tr","GSTagElement","converter","appendable","closeColor","cssClose","cssTag","dataListRef","renderTags","renderList","updateTag","KEYS","srcElement","removeTag","addTag","isMax","datalist","optEl","tagEl","renderTag","tagClass","btnClass","GSTextElement","GSTooltipElement","arrowStyle","arrowEl","panelEl","refLocal","refGlobal","GSTemplateElement","CopySelectController","clickCallback","copyCallback","onCopy","writeToClipboard","isAutocopy","isAutoselect","MaskController","_","back","prev","initRules","j","buildSlots","findIndex","buildAccept","toPattern","isMatch","setCustomValidity","setSelectionRange","substring","selectionStart","selectionEnd","maskType","chars","masks","special","MultipatternController","multipattern","NumberController","PasswordController","revealing","isReveal","altKey","TextController","InteractiveController","monitorCallback","onMonitor","formElements","strict","isInList","togleEl","dataGroup","togleOption","isButtonElement","ComboController","onAttributeHandler","gsfTarget","gsfValue","gsfAttribute","ListController","ValidityController","processing","isAutoreport","isAutovalidate","togglUI","isEnter","onBlock","report","requestSubmit","onAutoValidity","PropagateController","EventsMixin","mixin","prototype","FormController","scheduleValidate","onSubmit","onFormData","onValidation","isScheduled","onvalidation","ControllerHandler","copyselect","typeController","validityController","comboController","buttonController","propagateController","formController","isButton","invoke","onEnable","onDisable","initControllers","prepare","isInput","initIinputControllers","initTextAreaControllers","isDataList","ButtonController","rateLimit","debounce","updateState","onValid","isManaged","GSExtButtonElement","observedAttributes","formEl","controllerHandler","preupdate","GSExtInputElement","maskController","patternController","listController","isCheckBox","updateMask","updateMultipattern","updateList","isMulti","GSExtTextAreaElement","HTMLTextAreaElement","GSExtSelectElement","objToHTML","GSExtDataListElement","HTMLDataListElement","setIf","GSExtFormElement","onvalid","isShadowed","disableInput","enableInput","childrens","GSBreadcrumbElement","spacing","updateChildren","$text","GSBreadcrumbItemElement","generate","GSAttachment","directory","file","fullPath","isImage","isImageType","isVideo","isVideoType","isTextType","transfer","transferredFiles","files","File","isDirectory","traverse","roots","createReader","readEntries","results","getEntries","getFile","webkitGetAsEntry","forceBinary","FileReader","readAsText","readAsArrayBuffer","readyState","DONE","Uint8Array","filename","toMime","mimeToExt","encoding","ourl","GSFileBoxElement","cssList","cssInput","maxFileSize","listEl","fileEl","dragging","TITLE","onDragenter","onDragleave","onDrop","onPaste","dataTransfer","hasFile","dropEffect","clipboardData","pastedFile","types","rgx","kind","getAsFile","attachments","DataTransfer","transferred","validAttachments","GSTimeFormat","toLocaleTimeString","GSDateFormat","GSYearFormat","GSCurrencyFormat","GSStepStyle","GSStepElement","iconCSS","titleCSS","INACTIVE","ICON_CSS","GSStepsElement","steps","isFirst","isLast","COMPLETED","SELECTED","GSNotificationElement","BOTTOM_END","DEFAULT","positionCSS","dismiss","success","danger","primary","secondary","light","requestPermission","showNative","showWeb","toast","dialogToast","notification","Notification","clearNative","dlg","nn","isNativeSupported","isGranted","permission","GSToastElement","pending","visibilityChange","isVisibilityChanged","pendingUpdate","validParent","renderWithHeader","renderSimple","isToast","isNotify","AbstractTreeController","addNodeController","removeNodeController","oldNode","TreeController","toggleState","addedNode","insertedNode","onRemove","GSTreeItemElement","renderSpinner","cssFocus","status","toggleSelection","parentItem","checkColor","checkColorSelected","ui","itemIco","itemIcon","openIcon","closeIcon","renderIndent","renderMulti","GSTreeElement","guide","shared","listRef","nextItem","previousItem","reload","lastElementChild","expandable","ServiceWorkkerElement","scope","trace","registration","workerMessage","messageChannel","nocache","onWorkerMessage","unload","ServiceWorkerTraceUpdate","available","clearCache","postMessage","nonNull","isLoaded","port1","onMessage","initChannel","MessageChannel","onmessage","port2","waiting","monitorServiceWorkerUpdate","installing","serviceWorker","invokeServiceWorkerUpdateFlow","monitorController","refreshing","GSChartElement","URL_LIB","GS_URL_CHART","canvasRef","chart","waitInit","destroy","isChart","renderData","canvas","updateChart","div","toBase64Image","quality","sets","datasets","ctx","getContext","Chart","initializing","registerables","nameV","valV","typeV","childs","isObject","_nam","GSChart","_val","_typ","GSHighlightElement","GS_URL_HLJS","codeRef","onTarget","onURL","onHighlight","hasLangauge","highlight","injectCSS","terminate","response","worker","blobURL","Worker","langs","GSMarkdownElement","GS_URL_MARKDOWN","history","maxHeight","containerRef","initLib","showdown","tasklists","tables","Converter","toCache","fromCache","container","makeHtml","handleLinks","handleTables","handleCode","parentPath","handleStyles","links","onLinkClick","script","GSMonacoElement","GS_URL_MONACO","editor","onMonacoReady","monaco","model","getModel","selection","getValueInRange","getSelection","setModelLanguage","setTheme","automaticLayout","minimap","MonacoEnvironment","baseUrl","getWorkerUrl","workerId","require","paths","vs","initialized","initEnv","initMonaco"],"mappings":"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"}