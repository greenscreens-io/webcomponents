{"version":3,"file":"io.greenscreens.components.all.min.js","sources":["../../modules/base/GSVersion.mjs","../../modules/base/style.mjs","../../modules/base/GSLog.mjs","../../modules/base/GSUtil.mjs","../../modules/base/GSFunction.mjs","../../modules/base/GSID.mjs","../../modules/base/GSAttr.mjs","../../modules/base/GSCSSMap.mjs","../../modules/base/GSDate.mjs","../../modules/base/GSData.mjs","../../modules/base/GSDOM.mjs","../../modules/base/GSEvents.mjs","../../modules/base/GSAbortController.mjs","../../modules/base/GSDOMObserver.mjs","../../modules/base/GSDynamicStyle.mjs","../../modules/base/GSCacheStyles.mjs","../../modules/base/GSAdoptedEngine.mjs","../../modules/base/GSLoader.mjs","../../modules/base/GSTemplateCache.mjs","../../modules/base/GSAttributeHandler.mjs","../../modules/base/GSBeep.mjs","../../modules/base/GSEnvironment.mjs","../../modules/base/GSPromise.mjs","../../modules/base/GSEvent.mjs","../../modules/base/GSEventBus.mjs","../../modules/base/GSGesture.mjs","../../modules/base/GSItem.mjs","../../modules/base/GSLocalization.mjs","../../modules/base/GSPopper.mjs","../../modules/base/GSQueryCSS.mjs","../../modules/base/GSQuery.mjs","../../modules/base/GSRouter.mjs","../../modules/base/GSTheme.mjs","../../modules/helpers/BinaryTree.mjs","../../modules/helpers/DoublyLinkedList.mjs","../../modules/helpers/LinkedList.mjs","../../modules/helpers/Stack.mjs","../../modules/helpers/Queue.mjs","../../modules/helpers/Tree.mjs","../../modules/data/DataSelector.mjs","../../modules/data/ReadWriteRegistry.mjs","../../modules/data/AbstractReadWrite.mjs","../../modules/data/ReadWrite.mjs","../../modules/data/CachedReadWrite.mjs","../../modules/data/TreeNode.mjs","../../modules/data/TreeReader.mjs","../../modules/lib1.mjs","../../modules/directives/dataset.mjs","../../modules/directives/literal.mjs","../../modules/directives/css-map.mjs","../../modules/properties/verificator.mjs","../../modules/properties/autocapitalize.mjs","../../modules/properties/autocomplete.mjs","../../modules/properties/autocorrect.mjs","../../modules/properties/buttonType.mjs","../../modules/properties/color.mjs","../../modules/properties/environment.mjs","../../modules/properties/inputType.mjs","../../modules/properties/nav.mjs","../../modules/properties/orientation.mjs","../../modules/properties/placement.mjs","../../modules/properties/position.mjs","../../modules/properties/protocol.mjs","../../modules/properties/size.mjs","../../modules/properties/arrayConverter.mjs","../../modules/controllers/AdoptedController.mjs","../../modules/controllers/AttributeController.mjs","../../modules/controllers/ContentController.mjs","../../modules/controllers/DataController.mjs","../../modules/controllers/ElementMoveController.mjs","../../modules/controllers/LocalizationController.mjs","../../modules/controllers/OrientationController.mjs","../../modules/controllers/TemplateController.mjs","../../modules/controllers/ThemeController.mjs","../../modules/controllers/SlotController.mjs","../../modules/GSElement.mjs","../../modules/controllers/ElementNavigationController.mjs","../../modules/controllers/GroupController.mjs","../../modules/components/Router.mjs","../../modules/components/Accordion.mjs","../../modules/components/AccordionItem.mjs","../../modules/components/Alert.mjs","../../modules/components/Button.mjs","../../modules/components/Calendar.mjs","../../modules/components/Card.mjs","../../modules/components/Center.mjs","../../modules/components/Menu.mjs","../../modules/components/Context.mjs","../../modules/components/Compare.mjs","../../modules/components/Controller.mjs","../../modules/components/Copyright.mjs","../../modules/components/DataHandler.mjs","../../modules/components/Dialog.mjs","../../modules/components/Drawer.mjs","../../modules/components/Dropdown.mjs","../../modules/components/Email.mjs","../../modules/components/Form.mjs","../../modules/components/FormGroup.mjs","../../modules/components/FormPanel.mjs","../../modules/components/Group.mjs","../../modules/components/Icon.mjs","../../modules/components/Indent.mjs","../../modules/components/Image.mjs","../../modules/components/Layout.mjs","../../modules/components/Link.mjs","../../modules/components/List.mjs","../../modules/components/ListItem.mjs","../../modules/components/Mouse.mjs","../../modules/components/Movable.mjs","../../modules/components/Nav.mjs","../../modules/components/NavItem.mjs","../../modules/components/Overlay.mjs","../../modules/components/Pager.mjs","../../modules/components/Popup.mjs","../../modules/components/Popover.mjs","../../modules/components/Progress.mjs","../../modules/components/Spinner.mjs","../../modules/components/Splitter.mjs","../../modules/components/tab/TabHeader.mjs","../../modules/components/tab/TabPanel.mjs","../../modules/components/tab/TabGroup.mjs","../../modules/components/Table.mjs","../../modules/components/Tag.mjs","../../modules/components/Text.mjs","../../modules/components/Tooltip.mjs","../../modules/components/Template.mjs","../../modules/components/ext/controllers/CopySelectController.mjs","../../modules/components/ext/controllers/MaskController.mjs","../../modules/components/ext/controllers/MultipatternController.mjs","../../modules/components/ext/controllers/NumberController.mjs","../../modules/components/ext/controllers/PasswordController.mjs","../../modules/components/ext/controllers/TextController.mjs","../../modules/components/ext/controllers/InteractiveController.mjs","../../modules/components/ext/controllers/ComboController.mjs","../../modules/components/ext/controllers/ListController.mjs","../../modules/components/ext/controllers/ValidityController.mjs","../../modules/components/ext/EventsMixin.mjs","../../modules/components/ext/controllers/FormController.mjs","../../modules/components/ext/ControllerHandler.mjs","../../modules/components/ext/GSButtonElement.mjs","../../modules/components/ext/GSInputElement.mjs","../../modules/components/ext/GSTextAreaElement.mjs","../../modules/components/ext/GSSelectElement.mjs","../../modules/components/ext/GSDataListElement.mjs","../../modules/components/ext/GSFormElement.mjs","../../modules/components/breadcrumb/Breadcrumb.mjs","../../modules/components/breadcrumb/BreadcrumbItem.mjs","../../modules/components/filebox/Attachment.mjs","../../modules/components/filebox/FileBox.mjs","../../modules/components/intl/TimeFormat.mjs","../../modules/components/intl/DateFormat.mjs","../../modules/components/intl/YearFormat.mjs","../../modules/components/intl/CurrencyFormat.mjs","../../modules/components/steps/StepStyle.mjs","../../modules/components/steps/Step.mjs","../../modules/components/steps/Steps.mjs","../../modules/components/toast/Notification.mjs","../../modules/components/toast/Toast.mjs","../../modules/components/tree/controllers/AbstractTreeController.mjs","../../modules/components/tree/controllers/TreeController.mjs","../../modules/components/tree/TreeItem.mjs","../../modules/components/tree/Tree.mjs","../../modules/components/ServiceWorkker.mjs","../../modules/extra/Chart.mjs","../../modules/extra/Highlight.mjs","../../modules/extra/Markdown.mjs","../../modules/extra/Monaco.mjs"],"sourcesContent":["/*\r\n * Copyright (C) 2015, 202$ Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSVersion class\r\n * @module base/GSVersion\r\n */\r\n\r\n/**\r\n * A class with library version / build\r\n * @class\r\n */\r\nexport class GSVersion {\r\n\r\n    static get version() {\r\n        return '2.0.0';\r\n    }\r\n\r\n    static get build() {\r\n        return 2025.0131;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Required CSS Styles for WebCompoents, regardless Bootstrap CSS.\r\n */\r\nexport const gsstyles = `.z-10k{z-index:10000 !important;}\r\n.gs-hide,gs-item{display:none !important;}\r\ngs-popover,gs-tooltip{position:fixed;top:0px;left:0px;},\r\n.d-contents{display:contents;}';\r\ngs-button-group::part(.btn-group){box-shadow:rgba(72, 72, 72, 0.4) 0px 0.125rem 0.25rem;}\r\ngs-group>gs-button::part(button) {box-shadow: none;}\r\ngs-group>gs-button:not(:last-child)::part(button) {border-top-right-radius: 0;border-bottom-right-radius: 0;}\r\ngs-group>gs-button:not(:first-child)::part(button) {margin-left: calc(var(--bs-border-width) * -5);border-top-left-radius: 0;border-bottom-left-radius: 0;}\r\ngs-layout {width: 100%;height: 100%;}\r\ngs-split-panel{flex: 1 1 auto !important;}\r\ninput[is=\"gs-ext-input\"][type=\"date\"]:before {content: attr(data-value);display: inline-block;position: absolute;}\r\ninput[is=\"gs-ext-input\"][type=\"date\"]::-webkit-datetime-edit, input::-webkit-inner-spin-button, input::-webkit-clear-button {visibility: hidden;display: inline-block;}\r\ninput[is=\"gs-ext-input\"][type=\"date\"]::-webkit-calendar-picker-indicator {position: relative;top: 0px;right: 0;color: black;opacity: 0.5;}\r\n`;","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSLog class\r\n * @module base/GSLog\r\n */\r\n\r\n/** \r\n * Internal logging mechanism\r\n * @Class\r\n */\r\nexport class GSLog {\r\n\r\n\t/**\r\n\t * static flag is loging enabled or disabled\r\n\t */\r\n\tstatic logging = true;\r\n\tstatic tracing = false;\r\n\r\n\t/**\r\n\t * Log info message\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} msg \r\n\t */\r\n\tstatic info(el, msg) {\r\n\t\tthis.#print(el, msg, true, 'info');\r\n\t}\r\n\r\n\t/**\r\n\t * Log warn message\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} msg \r\n\t */\r\n\tstatic warn(el, msg) {\r\n\t\tthis.#print(el, msg, true, 'warn');\r\n\t}\r\n\r\n\t/**\r\n\t * Log error message\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} msg \r\n\t */\r\n\tstatic error(el, msg) {\r\n\t\tthis.#print(el, msg, true, 'error');\r\n\t}\r\n\r\n\t/**\r\n\t * Debug messages only if tracing flag enabled\r\n\t * @param {*} el \r\n\t * @param {*} msg \r\n\t */\r\n\tstatic trace(el, msg) {\r\n\t\tif (GSLog.tracing) this.#print(el, msg, false, 'error');\r\n\t}\r\n\r\n\t/**\r\n\t * Generic logging function\r\n\t * @param {HTMLElement} el Element to log (optional)\r\n\t * @param {String} msg Message to log\r\n\t * @param {Boolean} forced - when logging disabled globaly, use this to force logging\r\n\t */\r\n\tstatic log(el, msg, forced) {\r\n\t\tthis.#print(el, msg, forced);\r\n\t}\r\n\r\n\tstatic #print(el, msg, forced, type) {\r\n\t\tif (!(forced || this.logging)) return;\r\n\t\tconst tmp = el ? `${el.nodeName} -> ${el.id}: ${msg}` : msg;\r\n\t\tlet fn = console[type || 'log'];\r\n\t\tfn = typeof fn === 'function' ? fn : console.log;\r\n\t\tfn(tmp);\r\n\t\tif (msg instanceof Error) fn(msg);\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.seal(GSLog);\r\n\t}\r\n}\r\n\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSUtil class\r\n * @module base/GSUtil\r\n */\r\n\r\nimport { GSLog } from \"./GSLog.mjs\";\r\n\r\n/**\r\n * A generic set of static functions used across GS WebComponents framework\r\n * @class\r\n */\r\nexport class GSUtil {\r\n\r\n\tstatic FLAT = globalThis.GS_FLAT == true;\r\n\tstatic ALPHANUM = /^[a-zA-Z0-9-_]+$/;\r\n\tstatic #JSON_NORMALIZE = /(['\"])?([a-z0-9A-Z_]+)(['\"])?\\s*:/g;\r\n\r\n\tstatic isNumber = (n) => { return !isNaN(parseFloat(n)) && isFinite(n); };\r\n\r\n\tstatic isDate = (v) => { return v instanceof Date };\r\n\r\n\tstatic isBool = (v) => { return typeof v === 'boolean' || v instanceof Boolean };\r\n\r\n\tstatic isString = value => typeof value === 'string';\r\n\r\n\tstatic isNull = value => value === null || value === undefined;\r\n\r\n\tstatic toBinary = (value = 0) => value.toString(2);\r\n\r\n\tstatic asBool = (val = false) => {\r\n\t\tconst v = GSUtil.normalize(val).toLowerCase();\r\n\t\treturn v === 'true' || v === '1';\r\n\t};\r\n\r\n\tstatic fromLiteral = (str = '', obj) => str.replace(/\\${(.*?)}/g, (x, g) => obj[g]);\r\n\r\n\tstatic reverse = (str) => (str || \"\").split(\"\").reverse().join(\"\");\r\n\r\n\tstatic capitalize = (word = '') => word ? word[0].toUpperCase() + word.slice(1).toLowerCase() : '';\r\n\r\n\tstatic capitalizeAll = (word = '', split = ' ') => word.split(split).map((v, i) => GSUtil.capitalize(v)).join(split);\r\n\r\n\tstatic capitalizeAttr = (word = '') => word.split('-').map((v, i) => i ? GSUtil.capitalize(v) : v).join('');\r\n\r\n\tstatic initerror = () => { throw new Error('This class cannot be instantiated') };\r\n\r\n\tstatic isInstance = (el) => el instanceof el.constructor;\r\n\r\n\tstatic isPrimitive = (o) => !Array.isArray(o) && (this.isBool(o) || this.isDate(o) || this.isNumber(o) || this.isString(o));\r\n\r\n\tstatic range = (val = 0, min = 10, max = 100) => (Math.max(Math.min(max, val), min));\r\n\r\n\tstatic extractNumber = (val = '') => val.match(/[\\d,\\.]*\\d/)?.[0];\r\n\r\n\tstatic nonNull = value => !GSUtil.isNull(value);\r\n\r\n\tstatic asArray(val) {\r\n\t\treturn Array.isArray(val) ? val : [val];\r\n\t}\r\n\r\n\tstatic asNum(val, dft = 0, language) {\r\n\t\tlanguage = language || GSUtil.language;\r\n\t\tif (GSUtil.isString(val)) {\r\n\t\t\tconst sep = GSUtil.numberSeparator(language);\r\n\t\t\tval = GSUtil.extractNumber(val)?.replaceAll(sep, '') || val;\r\n\t\t}\r\n\t\treturn GSUtil.isNumber(val) ? parseFloat(val) : dft;\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Validate string for url format\r\n\t * @param {String} url \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isURL = (url = '') => /^(https?:\\/\\/|\\/{1,2}|\\.\\/{1})(\\S*\\/*){1,}/i.test(url.trim());\r\n\r\n\tstatic isHTML = (val = '') => val.trim().startsWith('<') && val.trim().endsWith('>');\r\n\r\n\t/**\r\n\t * Generate random set of characters\r\n\t * @param {String} pattern \r\n\t * @param {String} charset \r\n\t * @returns {String}\r\n\t */\r\n\tstatic generateUUID = (pattern = \"xxxx-xxxx-xxxx-xxxx-xxxx\", charset = \"abcdef0123456789\") => pattern.replace(/[x]/g, () => charset[Math.floor(Math.random() * charset.length)]);\r\n\r\n\t/**\r\n\t * Get browser default language\r\n\t * @returns {String}\r\n\t */\r\n\tstatic get language() {\r\n\t\treturn navigator.language ? navigator.language : navigator.languages[0];\r\n\t}\r\n\r\n\t/**\r\n\t * Convert string to regex isntance\r\n\t * @param {*} val \r\n\t * @param {*} flags \r\n\t * @returns \r\n\t */\r\n\tstatic toRegex(val, flags) {\r\n\t\tif (val instanceof RegExp) return val;\r\n\t\treturn GSUtil.isStringEmpty(val) ? undefined : new RegExp(val, flags);\r\n\t}\r\n\r\n\t/**\r\n\t * Find number separator for given language\r\n\t * @param {string} language \r\n\t * @returns \r\n\t */\r\n\tstatic decimalSeparator(language) {\r\n\t\treturn Intl.NumberFormat(language).format(1.1)[1];\r\n\t}\r\n\r\n\t/**\r\n\t * Find decimal separator for given language\r\n\t * @param {string} language \r\n\t * @returns \r\n\t */\r\n\tstatic numberSeparator(language) {\r\n\t\treturn Intl.NumberFormat(language).format(1000)[1];\r\n\t}\r\n\r\n\t/**\r\n\t * Check if number is in range, inclusive\r\n\t * @param {Number} x \r\n\t * @param {Number} min \r\n\t * @param {Number} max \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic inRange(x = 0, min = 0, max = 0) {\r\n\t\treturn x >= min && x <= max;\r\n\t}\r\n\r\n\t/**\r\n\t * Try to find data format based on language\r\n\t * @param {string} language \r\n\t * @returns \r\n\t */\r\n\tstatic getDateFormat(language = undefined) {\r\n\t\tconst formatted = new Intl.DateTimeFormat(language).format(new Date(2000, 0, 2));\r\n\t\treturn formatted\r\n\t\t\t.replace('2000', 'YYYY')\r\n\t\t\t.replace('01', 'MM')\r\n\t\t\t.replace('1', 'M')\r\n\t\t\t.replace('02', 'DD')\r\n\t\t\t.replace('2', 'D');\r\n\t}\r\n\r\n\t/**\r\n\t * Sanitize text for HTML generation\r\n\t * @param {string} string \r\n\t * @returns \r\n\t */\r\n\tstatic sanitize(string = '') {\t\t\r\n\t\tconst map = {\r\n\t\t\t'&': '&amp;',\r\n\t\t\t'<': '&lt;',\r\n\t\t\t'>': '&gt;',\r\n\t\t\t'\"': '&quot;',\r\n\t\t\t\"'\": '&#x27;',\r\n\t\t\t\"/\": '&#x2F;',\r\n\t\t\t\"\\n\": '<br>',\r\n\t\t\t\"\\r\": '<br>',\r\n\t\t\t\"\\t\": '&nbsp;&nbsp;&nbsp;&nbsp;',\r\n\t\t\t' ': '&nbsp;',\r\n\t\t\t'\\\\': '&#x5C;',\r\n\t\t\t'`': '&#x60;'\r\n\t\t};\r\n\t\tconst reg = new RegExp(`[${Object.keys(map).join('')}]`, 'ig');\r\n\t\treturn string.replace(reg, (match) => (map[match]));\r\n\t}\r\n\t\t\r\n\tstatic isJsonString(val = '') {\r\n\t\treturn typeof val == 'string' && (val.startsWith('{') || val.startsWith('['));\r\n\t}\r\n\r\n\t/**\r\n\t * Check if provided parameter is of JSON type\r\n\t * @param {String|object} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isJsonType(val = '') {\r\n\t\treturn !GSUtil.isNull(val) && (Array.isArray(val) || typeof val == \"object\");\r\n\t}\r\n\r\n\t/**\r\n\t * Check if provided paramter is JSON\r\n\t * @param {String|object} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isJson(val = '') {\r\n\t\treturn GSUtil.isJsonString(val) || GSUtil.isJsonType(val);\r\n\t}\r\n\r\n\t/**\r\n\t * Convert provided paramter to JSON\r\n\t * @param {String|object} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic toJson(val = '', dft = {}, normalize = true) {\r\n\t\tif (GSUtil.isJsonString(val)) return JSON.parse(normalize ? GSUtil.normalizeJson(val) : val);\r\n\t\tif (GSUtil.isJsonType(val)) return val;\r\n\t\tif (val) GSLog.warn(null, `Invalid data to convert into JSON: ${val}`);\r\n\t\treturn dft;\r\n\t}\r\n\r\n\t/**\r\n\t * Normalize unquoted JSON\r\n\t * @param {String} val \r\n\t * @returns {String}\r\n\t */\r\n\tstatic normalizeJson(val = '') {\r\n\t\treturn val?.replace(GSUtil.#JSON_NORMALIZE, '\"$2\": ');\r\n\t}\r\n\r\n\t/**\r\n\t * Makes string value safe, always return value\r\n\t * @param {String|object} val \r\n\t * @returns {String}\r\n\t */\r\n\tstatic normalize(val, def = '') {\r\n\t\treturn (val ?? def).toString().trim();\r\n\t}\r\n\r\n\t/**\r\n\t * Convert string separated values into an array\r\n\t * @param {String} val \r\n\t * @param {String} separator \r\n\t * @returns {Array<String>}\r\n\t */\r\n\tstatic toStringArray(val = '', separator = ' ') {\r\n\t\treturn val.split(separator).map(v => v.trim()).filter(v => v.length > 0);\r\n\t}\r\n\r\n\t/**\r\n\t * Transform text based on CSS text attribute format\r\n\t * @param {String} format \r\n\t * @param {String} value \r\n\t * @returns {String}\r\n\t */\r\n\tstatic textTransform(format = '', value = '') {\r\n\t\tswitch (format) {\r\n\t\t\tcase 'lowercase':\r\n\t\t\t\tvalue = value.toLowerCase();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'uppercase':\r\n\t\t\t\tvalue = value.toUpperCase();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'capitalize':\r\n\t\t\t\tvalue = GSUtil.capitalizeAll(value);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert parameterized string literal as template to string \r\n\t * \r\n\t * \t const template = 'Example text: ${text}';\r\n\t *   const result = interpolate(template, {text: 'Foo Boo'});\r\n\t * \r\n\t * @param {String} tpl \r\n\t * @param {Object} params \r\n\t * @returns {function}\r\n\t */\r\n\tstatic fromTemplateLiteral(tpl, params) {\r\n\t\tconst names = Object.keys(params);\r\n\t\tconst vals = Object.values(params);\r\n\t\treturn new Function(...names, `return \\`${tpl}\\`;`)(...vals);\r\n\t}\r\n\r\n\t/**\r\n\t * Decode HTML entities (&nbsp; &laquot; etc...)\r\n\t * @param {string} text \r\n\t * @returns {string}\r\n\t */\r\n\tstatic decodeHTMLEntities(text) {\r\n\t\tconst textArea = document.createElement('textarea');\r\n\t\ttextArea.innerHTML = text;\r\n\t\treturn textArea.value;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert string pointer to object\r\n\t * @param {String} value \r\n\t * @returns {*}\r\n\t */\r\n\tstatic parseValue(value) {\r\n\t\tif (!GSUtil.isString(value)) return;\r\n\t\tif (!GSUtil.isStringNonEmpty(value)) return;\r\n\t\tlet o = window;\r\n\t\tlet fn = null;\r\n\t\tvalue.trim().split('.').forEach((v, i, a) => {\r\n\t\t\tif (!o) return;\r\n\t\t\tif (i < a.length - 1) {\r\n\t\t\t\treturn o = o[v];\r\n\t\t\t}\r\n\t\t\tfn = o[v];\r\n\t\t});\r\n\t\treturn fn;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if strings has data\r\n\t * \r\n\t * @param {String} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isStringNonEmpty(val = '') {\r\n\t\treturn !GSUtil.isStringEmpty(val);\r\n\t}\r\n\r\n\t/**\r\n\t * Check if strings is empty\r\n\t * \r\n\t * @param {String} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isStringEmpty(val = '') {\r\n\t\treturn GSUtil.normalize(val).trim().length === 0;\r\n\t}\r\n\r\n\t/**\r\n\t * match two strings, or first is not set\r\n\t * \r\n\t * @param {String} left \r\n\t * @param {String} right \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isStringMatch(left, right) {\r\n\t\tconst lmatch = GSUtil.isStringNonEmpty(left);\r\n\t\tconst rmatch = GSUtil.isStringNonEmpty(right);\r\n\t\tif (lmatch && rmatch) {\r\n\t\t\treturn left.trim().toLowerCase() === right.trim().toLowerCase();\r\n\t\t}\r\n\t\treturn lmatch === rmatch;\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * Async version of timeout\r\n\t * \r\n\t * @async\r\n\t * @param {Number} time \r\n\t * @param {number|AbortSignal} signal Abort object\r\n\t * @returns {Promise<void>}\r\n\t */\r\n\tstatic async timeout(time = 0, signal) {\r\n\t\tif (time <= 0) return;\r\n\t\tsignal = GSUtil.isNumber(signal) ? AbortSignal.timeout(signal) : signal;\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tconst iid = setTimeout(resolve.bind(null, true), time);\r\n\t\t\tif (signal instanceof AbortSignal) {\r\n\t\t\t\tsignal.addEventListener('abort', () => {\r\n\t\t\t\t\tclearTimeout(iid);\r\n\t\t\t\t\treject(new Error('aborted timeout'));\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Download provided data\r\n\t * \r\n\t * @async\r\n\t * @param {Array} data \r\n\t * @param {String} name File name\r\n\t * @param {String} type Mime type, default octet/stream\r\n\t */\r\n\tstatic async export(data, name, type = 'octet/stream') {\r\n\r\n\t\tconst blob = new Blob(data, { type: type });\r\n\t\tconst url = URL.createObjectURL(blob);\r\n\t\ttry {\r\n\t\t\tconst a = document.createElement(\"a\");\r\n\t\t\ta.href = url;\r\n\t\t\ta.download = name;\r\n\t\t\ta.click();\r\n\r\n\t\t\tawait GSUtil.timeout(2000);\r\n\r\n\t\t} finally {\r\n\t\t\tURL.revokeObjectURL(url);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Registration helper function, replacement for class static initializers\r\n\t * Mostly to support Safari browser.\r\n\t * \r\n\t * GSUtil.register(null, GSUtil, null, true, false, true);\r\n\t * \r\n\t * @param {String} name Custom element name\r\n\t * @param {HTMLElement} clazz Class extensing at least HTMLElement\r\n\t * @param {String} ext If existing tag extended, this is tagName\r\n\t * @param {Boolean} seal Should class be sealed\r\n\t * @param {Boolean} freeze Should class be freezed\r\n\t * @param {Boolean} expose Should class be exposed to \"self\"\r\n\t * \r\n\t * @returns {void}\r\n\t */\r\n\tstatic register(name, clazz, ext, seal = true, freeze = false, expose = false) {\r\n\t\tif (!HTMLElement.isPrototypeOf(clazz)) return;\r\n\t\tif (customElements.get(name)) return;\r\n\t\tcustomElements.define(name, clazz, { extends: ext?.toLowerCase() });\r\n\t\tif (seal && !Object.isSealed(clazz)) Object.seal(clazz);\r\n\t\tif (freeze && !Object.isFrozen(clazz)) Object.freeze(clazz);\r\n\t\tif (expose) self[clazz.name] = clazz;\r\n\t}\r\n\r\n\t/**\r\n\t * Import and initialize source in JavaScript modules\r\n\t * Standard eval or new Function can not be used\r\n\t * @param {String} src \r\n\t * @returns {*}\r\n\t */\r\n\tstatic async importSource(src) {\r\n\t\tconst blob = new Blob([src], { type: \"text/javascript\" });\r\n\t\tconst url = URL.createObjectURL(blob);\r\n\t\ttry {\r\n\t\t\treturn await import(url);\r\n\t\t} finally {\r\n\t\t\tURL.revokeObjectURL(url);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Use Clipboard API to write to the clipboard\r\n\t * @returns \r\n\t */\r\n\tstatic async writeToClipboard(value = '') {\r\n\t\tconst result = await navigator.permissions.query({ name: \"clipboard-write\" })\r\n\t\tif (result.state === \"granted\" || result.state === \"prompt\") {\r\n\t\t   return navigator.clipboard.writeText(value);\r\n\t\t}\r\n\t\treturn '';\r\n\t}\r\n\r\n\t/**\r\n\t * Use Clipboard API to read from the clipboard\r\n\t * @returns \r\n\t */\r\n\tstatic async readFromClipboard() {\r\n\t\tconst result = await navigator.permissions.query({ name: \"clipboard-read\" })\r\n\t\tif (result.state === \"granted\" || result.state === \"prompt\") {\r\n\t\t   return navigator.clipboard.readText();\r\n\t\t}\r\n\t\treturn '';\r\n\t}\t\r\n\r\n\tstatic {\r\n\t\tObject.seal(GSUtil);\r\n\t\tglobalThis.GSUtil = GSUtil;\r\n\t}\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSFunction class\r\n * @module base/GSFunction\r\n */\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A set of static functions used for processing functions\r\n * @class\r\n */\r\nexport class GSFunction {\r\n\r\n    /**\r\n     * Check if object is of type function\r\n     * \r\n     * @param {function} fn \r\n     * @returns {Boolean}\r\n     */\r\n    static isFunction = (fn) => typeof fn === 'function';\r\n\r\n    static isFunctionNative(fn) {\r\n        return GSFunction.isFunction(fn) && fn.toString().includes('native code');\r\n    }\r\n\r\n    /**\r\n     * Check if object has function\r\n     * \r\n     * @param {Object} o \r\n     * @param {function} fn \r\n     * @returns {Boolean}\r\n     */\r\n    static hasFunction(o, fn) {\r\n        return o && GSFunction.isFunction(o[fn]);\r\n    }\r\n\r\n    /**\r\n     * Check if class has defined getter\r\n     * @param {*} own \r\n     * @param {*} name \r\n     * @returns \r\n     */\r\n    static hasGetter(own, name) {\r\n        return GSFunction.isFunctionDefined(own, name, 'get');\r\n    }\r\n\r\n    /**\r\n     * * Check if class has defined setter\r\n     * @param {*} own \r\n     * @param {*} name \r\n     * @returns \r\n     */\r\n    static hasSetter(own, name) {\r\n        return GSFunction.isFunctionDefined(own, name, 'set');\r\n    }\r\n\r\n    /**\r\n     * Check if class instance has defined function\r\n     * @param {object} own Class instance\r\n     * @param {string} name Function name to check\r\n     * @param {string} fn Function name to check\r\n     * @returns {boolean} Returns true if getter exist\r\n     */\r\n    static isFunctionDefined(own, name, fn) {\r\n        const desc = own ? Reflect.getOwnPropertyDescriptor(own.__proto__, name) : false;\r\n        return desc && typeof desc[fn] === 'function';\r\n    }\r\n\r\n    /**\r\n     * Check if object is of type async function\r\n     * \r\n     * @param {function} fn \r\n     * @returns  {Boolean}\r\n     */\r\n    static isFunctionAsync(fn) {\r\n        if (!GSFunction.isFunction(fn)) return false;\r\n        const AsyncFunction = GSFunction.callFunctionAsync.constructor\r\n        let isValid = fn instanceof AsyncFunction;\r\n        if (!isValid) isValid = fn[Symbol.toStringTag] == \"AsyncFunction\";\r\n        return isValid;\r\n    }\r\n\r\n    /**\r\n     * Check if object is of type generator function\r\n     * \r\n     * @param {function} fn \r\n     * @returns {Boolean}\r\n     */\r\n    static isFunctionGenerator(fn) {\r\n        if (!GSFunction.isFunction(fn)) return false;\r\n        const GeneratorFunction = (function* () { }).constructor;\r\n        return fn instanceof GeneratorFunction;\r\n    }\r\n\r\n    /**\r\n     * Generic asynchronous function caller\r\n     * \r\n     * @async\r\n     * @param {function} fn \r\n     * @param {Object} owner \r\n     * @returns  {Promise}\r\n     * @throws {Error} \r\n     */\r\n    static async callFunctionAsync(fn, owner) {\r\n        const args = arguments ? Array.from(arguments).slice(2) : [];\r\n        return await fn.apply(owner || null, args);\r\n    }\r\n\r\n    /**\r\n     * Generic synchronous function caller\r\n     * \r\n     * @param {function} fn \r\n     * @param {Object} owner \r\n     * @returns {Object}\r\n     * @throws {Error}\r\n     */\r\n    static callFunctionSync(fn, owner) {\r\n        const args = arguments ? Array.from(arguments).slice(2) : [];\r\n        return fn.apply(owner || null, args);\r\n    }\r\n\r\n    /**\r\n     * Generic function caller\r\n     * \r\n     * @param {function} fn \r\n     * @param {Object} owner \r\n     * @returns {Object}\r\n     */\r\n    static async callFunction(fn, owner, native = true) {\r\n        fn = GSUtil.isString(fn) ? GSFunction.parseFunction(fn) : fn;\r\n        if (!GSFunction.isFunction(fn)) return;\r\n        if (!native && GSFunction.isFunctionNative(fn)) return;\r\n        const args = arguments ? Array.from(arguments).slice(3) : [];\r\n        if (GSFunction.isFunctionAsync(fn)) {\r\n            return await GSFunction.callFunctionAsync(fn, owner, ...args);\r\n        }\r\n        return GSFunction.callFunctionSync(fn, owner, ...args);\r\n    }\r\n\r\n    /**\r\n     * Convert string pointer to function call\r\n     * \r\n     * @param {String} value \r\n     * @returns  {function}\r\n     */\r\n    static parseFunction(value) {\r\n        const fn = GSUtil.parseValue(value);\r\n        return GSFunction.isFunction(fn) ? fn : null;\r\n    }\r\n\r\n    static async #contextualize(fn, context, args) {\r\n        if (!GSFunction.isFunction(fn)) return;\r\n        const isAsync = GSFunction.isFunctionAsync(fn);\r\n        if (isAsync) {\r\n            return await fn.apply(context, args);\r\n        } else {\r\n            return fn.apply(context, args);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Wrap function into a single call - loop first call executed\r\n     * @param {function} fn Function to be called\r\n     * @param {*} context Instance at which to call the function\r\n     * @returns {*} Function result\r\n     */\r\n    static callOnceFifo(fn, context) {\r\n        let cnt = false;\r\n        return async (...args) => {\r\n            if (cnt) return;\r\n            cnt = true;\r\n            const own = context || this;\r\n            return await GSFunction.#contextualize(fn, own, args);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Wrap function into a single call - loop last call executed\r\n     * @param {function} fn Function to be called\r\n     * @param {*} context Instance at which to call the function\r\n     * @returns {*} Function result\r\n     */\r\n    static callOnceLifo(fn, context) {\r\n        let cnt = 0;\r\n        return (...args) => {\r\n            if (cnt < 0) return;\r\n            cnt++;\r\n            const own = context || this;\r\n            return new Promise((accept, reject) => {\r\n                queueMicrotask(async () => {\r\n                    if (cnt <= 0) return;\r\n                    cnt--;\r\n                    if (cnt !== 0) return;\r\n                    try {\r\n                        const o = await GSFunction.#contextualize(fn, own, args);\r\n                        accept(o);\r\n                    } catch (e) {\r\n                        reject(e);\r\n                    } finally {\r\n                        cnt = -1;\r\n                    }\r\n                });\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Debounce function makes sure that code is only triggered once per user input. \r\n     * Search box suggestions, text-field auto-saves, and eliminating double-button clicks are all use cases for debounce.\r\n     * @param {Function} func \r\n     * @param {Number} timeout \r\n     * @returns {Function}\r\n     */\r\n    static debounce(func, timeout = 300, leading = false) {\r\n        return leading ? GSFunction.#debounceLifo(func, timeout) : GSFunction.#debounceFifo(func, timeout);\r\n    }\r\n\r\n    /**\r\n     * Call only last function call within timeout period.\r\n     * @param {Function} func \r\n     * @param {Number} timeout \r\n     * @returns {Function}\r\n     */\r\n    static #debounceLifo(func, timeout = 300) {\r\n        let timer;\r\n        return (...args) => {\r\n            clearTimeout(timer);\r\n            timer = setTimeout(() => { func.apply(this, args); }, timeout);\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Call only first function call within timeout period.\r\n     * @param {*} func \r\n     * @param {*} timeout \r\n     * @returns \r\n     */\r\n    static #debounceFifo(func, timeout = 300) {\r\n        let timer;\r\n        return (...args) => {\r\n            if (!timer) {\r\n                func.apply(this, args);\r\n            }\r\n            clearTimeout(timer);\r\n            timer = setTimeout(() => {\r\n                timer = undefined;\r\n            }, timeout);\r\n        };\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSFunction);\r\n        globalThis.GSFunction = GSFunction;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSID class\r\n * @module base/GSID\r\n */\r\n\r\n/**\r\n * Generic unique ID generator for element\r\n * @class\r\n */\r\nexport class GSID {\r\n\r\n\tstatic #id = 0;\r\n\r\n\t/**\r\n\t * Reset ID counter to 0\r\n\t */\r\n\tstatic reset() {\r\n\t\tthis.#id = 0;\r\n\t}\r\n\r\n\t/**\r\n\t * Get next unique generated ID\r\n\t * @param {*} prefx Value to prepend to ID counter\r\n\t * @returns {String} A generated ID\r\n\t */\r\n\tstatic next(prefx = 'GSId-') {\r\n\t\treturn `${prefx}${++this.#id}`;\r\n\t}\r\n\r\n\t/**\r\n\t * Auto generate next ID\r\n\t * @returns {String} A generated ID\r\n\t */\r\n\tstatic get id() {\r\n\t\treturn this.next();\r\n\t}\r\n\r\n\t/**\r\n\t * Calculate hashcode from string (Java compatible)\r\n\t * @param {*} s A text fro mwhich hashcode is calculated \r\n\t * @returns {Number} Generated numeric hashcode\r\n\t */\r\n\tstatic hashCode(s) {\r\n\t\tconst l = (s || '').length;\r\n\t\tlet h = 0, i = 0;\r\n\t\tif (l === 0) return h;\r\n\t\twhile (i < l) {\r\n\t\t\th = (h << 5) - h + s.charCodeAt(i++) | 0;\r\n\t\t}\r\n\t\treturn h;\r\n\t}\r\n\r\n\t/**\r\n\t * Set element id if not set already\r\n\t * @param {HTMLElement} el \r\n\t */\r\n\tstatic setIf(el) {\r\n\t\tif (el) {\r\n\t\t\tel.id = typeof el.id !== 'string' ? GSID.id : el.id || GSID.id;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.freeze(GSID);\r\n\t}\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\nconst isProxy = Symbol(\"isProxy\")\r\n\r\n/**\r\n * A module loading GSAttr class\r\n * @module base/GSAttr\r\n */\r\n\r\n/**\r\n * A generic set of static functions to handle DOM Attributes\r\n * @class\r\n */\r\nexport class GSAttr {\r\n\r\n\t/**\r\n\t * Check if given element is of type HTMLElement\r\n\t * NOTE: GSDOM.isHTMLElement duplicate - prevent circular import\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isHTMLElement(el) {\r\n\t\treturn el instanceof HTMLElement;\r\n\t}\r\n\r\n\t/**\r\n\t  * Generic function to change element node attribute\r\n\t  * \r\n\t  * @param {HTMLElement} el Target to receive attribute value\r\n\t  * @param {String} name Attribute name\r\n\t  * @param {Boolean} val Attribute value\r\n\t  */\r\n\tstatic toggle(el, name, val = false) {\r\n\t\tif (!GSAttr.isHTMLElement(el)) return;\r\n\t\tif (GSUtil.asBool(val)) {\r\n\t\t\tel.setAttribute(name, '');\r\n\t\t} else {\r\n\t\t\tel.removeAttribute(name);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Generic function to change elment node attribute\r\n\t * \r\n\t * @param {HTMLElement} el Target to receive attribute value\r\n\t * @param {String} name Attribite name\r\n\t * @param {String} val Attribute value\r\n\t */\r\n\tstatic set(el, name, val) {\r\n\t\tif (!GSAttr.isHTMLElement(el)) return;\r\n\t\tif (GSUtil.normalize(val)) {\r\n\t\t\tel.setAttribute(name, val);\r\n\t\t} else {\r\n\t\t\tel.removeAttribute(name);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Generic function to get element node attribute\r\n\t * \r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {String} val Default value\r\n\t * @returns {String}\r\n\t */\r\n\tstatic get(el, name = '', val = '') {\r\n\t\tif (!GSAttr.isHTMLElement(el)) return val;\r\n\t\tif (!GSUtil.isInstance(el)) return val;\r\n\t\tconst v = el.getAttribute(name) ?? val;\r\n\t\treturn GSUtil.normalize(v);\r\n\t}\r\n\r\n\t/**\r\n\t * Get attribute as boolean type\r\n\t * \r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {String} val Default value\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic getAsBool(el, name = '', val = 'false') {\r\n\t\tconst attr = GSAttr.get(el, name, val);\r\n\t\treturn GSUtil.asBool(attr, val);\r\n\t}\r\n\r\n\t/**\r\n\t * Get attribute as numberic type\r\n\t * \r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {String} val Default value\r\n\t * @returns {Number}\r\n\t */\r\n\tstatic getAsNum(el, name = '', val = '0') {\r\n\t\tconst attr = GSAttr.get(el, name, val);\r\n\t\treturn GSUtil.asNum(attr, val);\r\n\t}\r\n\r\n\t/**\r\n\t * Get attribute as JSON object type\r\n\t * \r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {String} val Default value\r\n\t * @returns {JSON}\r\n\t */\r\n\tstatic getAsJson(el, name = '', val = '{}') {\r\n\t\tconst attr = GSAttr.get(el, name, val);\r\n\t\treturn GSUtil.toJson(attr, val);\r\n\t}\r\n\r\n\t/**\r\n\t * Store data into attribute as boolean\r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {Boolean} val Default value\r\n\t */\r\n\tstatic setAsBool(el, name = '', val = 'false') {\r\n\t\t//GSAttr.toggle(el, name, GSUtil.asBool(val));\r\n\t\tGSAttr.set(el, name, GSUtil.asBool(val), false);\r\n\t\t/*\r\n\t\tif (!GSAttr.isHTMLElement(el)) return;\r\n\t\tel.toggleAttribute(name, GSUtil.asBool(val));\r\n\t\t*/\r\n\t}\r\n\r\n\t/**\r\n\t * Store data into attribute as numeric\r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {Number} val Default value\r\n\t */\r\n\tstatic setAsNum(el, name = '', val = '0') {\r\n\t\tGSAttr.set(el, name, GSUtil.asNum(val), NaN);\r\n\t}\r\n\r\n\t/**\r\n\t * Store data into attribute as JSON string\r\n\t * @param {HTMLElement} el Element containing attribute\r\n\t * @param {String} name Attribute name\r\n\t * @param {string} val Default value\r\n\t */\r\n\tstatic setAsJson(el, name = '', val = '{}') {\r\n\t\tGSAttr.set(el, name, JSON.stringify(val), val);\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON object to attribute string \r\n\t * @param {*} obj \r\n\t * @returns {String}\r\n\t */\r\n\tstatic flattenJson(obj) {\r\n\t\treturn Object.entries(obj || {}).map(kv => `${kv[0]}=${kv[1]}`).join(' ');\r\n\t}\r\n\r\n\t/**\r\n\t * Apply JSON object to element attributes\r\n\t * @param {*} obj \r\n\t */\r\n\tstatic jsonToAttr(obj, el) {\r\n\t\tif (!GSAttr.isHTMLElement(el)) return;\r\n\t\tObject.entries(obj || {})\r\n\t\t.filter(kv => kv[0] != 'items')\r\n\t\t.filter(kv => kv[0][0] != '#')\r\n\t\t.filter(kv => kv[0][0] != '$')\r\n\t\t.map(kv => GSAttr.set(el, kv[0], kv[1]));\r\n\t}\r\n\r\n\t/**\r\n\t * Convert list of data attributes into a string list\r\n\t * @param {HTMLElement} el \r\n\t * @returns {String}\r\n\t */\r\n\tstatic dataToString(el) {\r\n\t\treturn Array.from(el.attributes)\r\n\t\t\t.filter(v => v.name.startsWith('data-'))\r\n\t\t\t.map(v => `${v.name}=\"${v.value}\"`)\r\n\t\t\t.join(' ');\r\n\t}\r\n\r\n\t/**\r\n\t * Convert list of element attributes into a flat list separated by given separator (default ' ')\r\n\t * @param {HTMLMediaElement} el \r\n\t * @param {String} sep \r\n\t * @returns {String}\r\n\t */\r\n\tstatic flatten(el, sep = ' ') {\r\n\t\treturn Array.from(el?.attributes || []).map(a => `${a.name}=\"${a.value}\"`).join(sep);\r\n\t}\r\n\r\n\t/**\r\n\t * Generic attribute retriever \r\n\t * opt format { prop: {type:Number, attribute: 'alt-prop-name'}}\r\n\t * @param {HTMLElement} host The host element to proxify\r\n\t * @param {Object} [opt={}] Options object describing attribute mapping and types\r\n\t * @param {String} [recursive='items'] Property name for recursive proxification of children\r\n\t * @returns {Proxy}\r\n\t */\r\n\tstatic proxify(host, opt = {}, recursive = 'items') {\r\n\r\n\t\tconst instance = new Proxy(host, {\r\n\t\t\t\r\n\t\t\tset(target, prop, value) {\r\n\t\t\t\t\r\n\t\t\t\tif (prop === 'self') return;\r\n\t\t\t\tif (prop === 'dataset') return target.dataset = value;\r\n\t\t\t\tif (typeof prop === 'symbol') return target[prop] = value;\r\n\r\n\t\t\t\tconst type = opt[prop]?.type;\r\n\t\t\t\tprop = opt[prop]?.attribute || prop;\r\n\t\t\t\t\r\n\t\t\t\tswitch(type) {\r\n\t\t\t\t\tcase Boolean :\r\n\t\t\t\t\t\tGSAttr.toggle(target, prop,  GSUtil.asBool(value));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase Number :\r\n\t\t\t\t\t\tGSAttr.setAsNum(target, prop, value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase Object :\r\n\t\t\t\t\tcase Array :\r\n\t\t\t\t\t\tGSAttr.set(target, prop, JSON.stringify(value));\r\n\t\t\t\t\tdefault:\t\t\t\t\t\r\n\t\t\t\t\t\tGSAttr.set(target, prop, value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\r\n\t\t\tget(target, prop) {\r\n\t\t\t\t\r\n\t\t\t\tif (prop === 'self') return target;\r\n\t\t\t\tif (prop === 'dataset') return target.dataset;\r\n\t\t\t\tif (typeof prop === 'symbol') return target[prop];\r\n\t\t\t\tif (prop === 'isProxy') return isProxy;\r\n\t\t\t\tif (prop === recursive) return Array.from(target.children).map(el => GSAttr.proxify(el, opt, recursive)); \r\n\t\t\t\t\r\n\t\t\t\tconst tmp = opt; // Object.hasOwn(opt, prop) ? opt : target;\r\n\t\t\t\t\r\n\t\t\t\tconst type = tmp[prop]?.type;\r\n\t\t\t\tconst safe = tmp[prop]?.unsafe ? true : false;\r\n\t\t\t\tconst dflt = tmp[prop]?.default;\r\n\t\t\t\tconst multi = tmp[prop]?.multi === true;\r\n\t\t\t\t\r\n\t\t\t\tprop = tmp[prop]?.attribute || prop;\r\n\t\t\t\tlet val = target.hasAttribute(prop) ? GSAttr.get(target, prop) : target[prop];\r\n\r\n\t\t\t\tif (GSFunction.isFunction(val)) return val.bind(target);\r\n\t\t\t\t\r\n\t\t\t\tswitch(type) {\r\n\t\t\t\t\tcase Boolean :\r\n\t\t\t\t\t\treturn target.hasAttribute(prop);\r\n\t\t\t\t\tcase Number :\r\n\t\t\t\t\t\treturn GSUtil.asNum(val, 0);\r\n\t\t\t\t\tcase Object :\r\n\t\t\t\t\t\treturn GSUtil.toJson(val, {});\r\n\t\t\t\t\tcase Array :\r\n\t\t\t\t\t\treturn GSUtil.toJson(val, []);\r\n\t\t\t\t\tdefault:\t\t\t\t\t\r\n\t\t\t\t\t\tval = safe ? (val || dflt || '') : (val || dflt || undefined);\r\n\t\t\t\t\t\treturn multi ? GSUtil.toStringArray(val) : val;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\treturn instance;\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.seal(GSAttr);\r\n\t\tglobalThis.GSAttr = GSAttr;\r\n\t}\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\n\r\n/**\r\n * A module loading GSCSSMap class\r\n * @module base/GSCSSMap\r\n */\r\n\r\n/**\r\n * Wrapper around computedStyleMap to support Firefox and WebKit Mode\r\n * @class\r\n */\r\nexport class GSCSSMap {\r\n\r\n    static #modern = globalThis.document?.body?.computedStyleMap ? true : false;\r\n\r\n    #map;\r\n\r\n    constructor(element) {\r\n        const me = this;\r\n        me.#map = GSCSSMap.#getMap(element);\r\n    }\r\n\r\n    get(name) {\r\n        const me = this;\r\n        if (!me.#map) return undefined;\r\n        return GSCSSMap.#modern ? me.#map.get(name) : me.#map[GSUtil.capitalizeAttr(name)];\r\n    }\r\n\r\n    asText(name) {\r\n        return (this.get(name) || '')?.toString();\r\n    }\r\n\r\n    asBool(name) {\r\n        const val = this.get(name);\r\n        return GSUtil.asBool(GSCSSMap.#modern ? val?.value : val);\r\n    }\r\n\r\n    asNum(name) {\r\n        let val = this.get(name);\r\n        if (GSCSSMap.#modern && GSFunction.isFunction(val?.to)) {\r\n            if (val.unit !== 'number') val = val.to('px');\r\n        }\r\n        if (GSCSSMap.#modern) return GSUtil.asNum(val?.value);\r\n        const num = val?.match(/\\d*(\\.\\d*)?/g).filter(v => GSUtil.isNumber(v)).shift();\r\n        return GSUtil.asNum(num);\r\n    }\r\n\r\n    matches(name, value) {\r\n        return this.asText(name) == value;\r\n    }\r\n\r\n    /**\r\n     * Support for Firefox/Gecko to get element computedStyleMap\r\n     * @param {HTMLElement} el \r\n     * @returns {CSSStyleDeclaration}\r\n     */\r\n    static #getMap(el) {\r\n        if (GSCSSMap.#modern) return el.computedStyleMap();\r\n        if (globalThis.window?.getComputedStyle) return globalThis.window.getComputedStyle(el);\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Support for Firefox/Gecko to get element computedStyleMap item\r\n     * @param {HTMLElement} el \r\n     * @returns {}\r\n     */\r\n    static styleValue(el, name) {\r\n        return GSCSSMap.getComputedStyledMap(el).get(name);\r\n    }\r\n\r\n    /**\r\n     * Support for Firefox/Gecko to get element computedStyleMap\r\n     * @param {HTMLElement} element \r\n     * @returns {GSCSSMap}\r\n     */\r\n    static getComputedStyledMap(element) {\r\n        return new GSCSSMap(element);\r\n    }\r\n\r\n    static #normalize(str) {\r\n        if (!str) return '';\r\n        str = String(str).replace(/\\s*([>~+])\\s*/g, ' $1 ');\r\n        return str.replace(/(\\s+)/g, ' ').trim();\r\n    }\r\n\r\n    static #split(str, on) {\r\n        return str.split(on).map(x => x.trim()).filter(x => x);\r\n    }\r\n\r\n    static #containsAny(selText, ors) {\r\n        return selText ? ors.some(x => selText.includes(x)) : false;\r\n    }\r\n\r\n    /**\r\n     * Find css defined rules by css selector\r\n     * @param {String} selector \r\n     * @returns {CSSStyleRule}\r\n     */\r\n    static findRule(selector) {\r\n        const me = GSCSSMap;\r\n        const logicalORs = me.#split(me.#normalize(selector), ',');\r\n        const sheets = Array.from(globalThis.document.styleSheets);\r\n        const ruleArrays = sheets.map(x => Array.from(x.cssRules || []));\r\n        const allRules = ruleArrays.reduce((all, x) => all.concat(x), []);\r\n        return allRules.filter((x) => me.#containsAny(me.#normalize(x.selectorText), logicalORs));\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSCSSMap);\r\n        globalThis.GSCSSMap = GSCSSMap;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A module loading GSDate class\r\n * @module base/GSDate\r\n */\r\n\r\n/**\r\n * Custom Date class to help handling calendar and date formatting\r\n * \r\n * @class\r\n */\r\nexport class GSDate extends Date {\r\n\r\n    static DEFAULT_FORMAT = 'YYYY-MM-DDTHH:mm:ssZ';\r\n    static REGEX_FORMAT = /\\[([^\\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g\r\n\r\n    #language = navigator.language;\r\n\r\n    format(val = GSDate.DEFAULT_FORMAT, language) {\r\n        const me = this;\r\n        if (language) me.language = language;\r\n        const obj = me.asJSON();\r\n        return val.replace(GSDate.REGEX_FORMAT, (match, val) => val || obj[match]);\r\n    }\r\n\r\n    /**\r\n     * Build array days/weeks for a month\r\n     * @returns {Array<string>}\r\n     */\r\n    build() {\r\n        const me = this;\r\n        const last = me.last.getDate();\r\n        const first = me.first.getDay();\r\n\r\n        const mondayFirst = me.#isMondayFirst();\r\n\r\n        const dayOffset = mondayFirst ? -2 : -1;\r\n        const days = first === 0 ? [] : ' '.repeat(first + dayOffset).split(' ');\r\n        /*\r\n        const emptyDays =  first === 0 ? 0 : first + dayOffset;\r\n        const days = Array.from({ length: emptyDays }, () => '');\r\n        */\r\n        let i = 1;\r\n        while (i <= last) {\r\n            days.push(i.toString());\r\n            i++;\r\n        }\r\n\r\n        while (days.length % 7 != 0) days.push('');\r\n\r\n        return days;\r\n    }\r\n\r\n    get language() {\r\n        return this.#language;\r\n    }\r\n\r\n    set language(val) {\r\n        this.#language = val || navigator.language;\r\n    }\r\n\r\n    get year() {\r\n        return this.getFullYear();\r\n    }\r\n\r\n    set year(val = 0) {\r\n        this.setFullYear(val);\r\n    }\r\n\r\n    get month() {\r\n        return this.getMonth();\r\n    }\r\n\r\n    set month(val = 0) {\r\n        this.setMonth(val);\r\n    }\r\n\r\n    get day() {\r\n        return this.getDate();\r\n    }\r\n\r\n    set day(val = 0) {\r\n        this.setDate(val);\r\n    }\r\n\r\n    /**\r\n     * First date of the month\r\n     * @returns {Date}\r\n     */\r\n    get first() {\r\n        return new GSDate(this.getFullYear(), this.getMonth(), 1);\r\n    }\r\n\r\n    /**\r\n     * Last date of the month\r\n     * @returns {Date}\r\n     */\r\n    get last() {\r\n        return new GSDate(this.getFullYear(), this.getMonth() + 1, 0);\r\n    }\r\n\r\n    get YY() {\r\n        return String(this.YYYY).slice(-2);\r\n    }\r\n\r\n    get YYYY() {\r\n        return this.getFullYear();\r\n    }\r\n\r\n    get M() {\r\n        return this.getMonth() + 1;\r\n    }\r\n\r\n    get MM() {\r\n        return this.M.toString().padStart(2, '0');\r\n    }\r\n\r\n    get MMM() {\r\n        return this.#toLocale({ month: 'short' });\r\n    }\r\n\r\n    get MMMM() {\r\n        return this.#toLocale({ month: 'long' });\r\n    }\r\n\r\n    get D() {\r\n        return this.getDate().toString();\r\n    }\r\n\r\n    get DD() {\r\n        return this.D.padStart(2, '0');\r\n    }\r\n\r\n    get d() {\r\n        return this.getDay().toString();\r\n    }\r\n\r\n    get dd() {\r\n        return this.ddd.slice(0, 2);\r\n    }\r\n\r\n    get ddd() {\r\n        return this.#toLocale({ weekday: 'short' });\r\n    }\r\n\r\n    get dddd() {\r\n        return this.#toLocale({ weekday: 'long' });\r\n    }\r\n\r\n    get H() {\r\n        return this.getHours().toString();\r\n    }\r\n\r\n    get HH() {\r\n        return this.H.padStart(2, '0');\r\n    }\r\n\r\n    get h() {\r\n        return this.#formatHour(1);\r\n    }\r\n\r\n    get hh() {\r\n        return this.#formatHour(2);\r\n    }\r\n\r\n    get a() {\r\n        return this.#meridiem(true);\r\n    }\r\n\r\n    get A() {\r\n        return this.#meridiem(false);\r\n    }\r\n\r\n    get m() {\r\n        return this.getMinutes().toString();\r\n    }\r\n\r\n    get mm() {\r\n        return this.m.padStart(2, '0');\r\n    }\r\n\r\n    get s() {\r\n        return this.getSeconds().toString();\r\n    }\r\n\r\n    get ss() {\r\n        return this.s.padStart(2, '0');\r\n    }\r\n\r\n    get SSS() {\r\n        return this.getMilliseconds().toString().padStart(3, '0');\r\n    }\r\n\r\n    get Z() {\r\n        return this.#zoneStr();\r\n    }\r\n\r\n    get ZZ() {\r\n        return this.Z.replace(':', '');\r\n    }\r\n\r\n    get Q() {\r\n        return Math.ceil(this.M / 3);\r\n    }\r\n\r\n    get k() {\r\n        return (this.getHours() + 1).toString();\r\n    }\r\n\r\n    get kk() {\r\n        return this.k.padStart(2, '0');\r\n    }\r\n\r\n    get W() {\r\n        const date = new Date(this.getTime());\r\n        date.setHours(0, 0, 0, 0);\r\n        date.setDate(date.getDate() + 3 - (date.getDay() + 6) % 7);\r\n        const week1 = new Date(date.getFullYear(), 0, 4);\r\n        return 1 + Math.round(((date.getTime() - week1.getTime()) / 86400000 - 3 + (week1.getDay() + 6) % 7) / 7);\r\n    }\r\n\r\n    get WW() {\r\n        return this.W.toString().padStart(2, '0');\r\n    }\r\n\r\n    get x() {\r\n        return this.getTime();\r\n    }\r\n\r\n    get X() {\r\n        return Math.floor(this.x / 1000);\r\n    }\r\n\r\n    asJSON() {\r\n        const me = this;\r\n        return {\r\n            YY: me.YY,\r\n            YYYY: me.YYYY,\r\n            M: me.M,\r\n            MM: me.MM,\r\n            MMM: me.MMM,\r\n            MMMM: me.MMMM,\r\n            D: me.D,\r\n            DD: me.DD,\r\n            d: me.d,\r\n            dd: me.dd,\r\n            ddd: me.ddd,\r\n            dddd: me.dddd,\r\n            H: me.H,\r\n            HH: me.HH,\r\n            h: me.h,\r\n            hh: me.hh,\r\n            a: me.a,\r\n            A: me.A,\r\n            m: me.m,\r\n            mm: me.mm,\r\n            s: me.s,\r\n            ss: me.ss,\r\n            SSS: me.SSS,\r\n            Z: me.Z,\r\n            ZZ: me.ZZ,\r\n            Q: me.Q,\r\n            k: me.k,\r\n            kk: me.kk,\r\n            W: me.W,\r\n            WW: me.WW,\r\n            x: me.x,\r\n            X: me.X\r\n        }\r\n    }\r\n\r\n    static monthList(short = false, language = navigator.language, capitalize = true) {\r\n        const tmp = new GSDate();\r\n        tmp.language = language;\r\n        tmp.setDate(1);\r\n        tmp.setMonth(0);\r\n        const days = [];\r\n        let val = null;\r\n        let d = 12;\r\n        while (d--) {\r\n            val = short ? tmp.MMM : tmp.MMMM;\r\n            val = capitalize ? tmp.#capitalize(val) : val;\r\n            days.push(val);\r\n            tmp.setMonth(tmp.getMonth() + 1);\r\n        }\r\n        return days;\r\n    }\r\n\r\n    static dayList(short = false, language = navigator.language, capitalize = true) {\r\n        const tmp = new GSDate();\r\n        tmp.language = language;\r\n        const mondayFirst = tmp.#isMondayFirst();\r\n        const offset = mondayFirst ? 1 : 0;\r\n        tmp.setDate(tmp.getDate() - tmp.getDay() + offset);\r\n        const days = [];\r\n        let val = null;\r\n        let d = 7;\r\n        while (d--) {\r\n            val = short ? tmp.ddd : tmp.dddd;\r\n            val = capitalize ? tmp.#capitalize(val) : val;\r\n            days.push(val);\r\n            tmp.setDate(tmp.getDate() + 1);\r\n        }\r\n        return days;\r\n    }\r\n\r\n    #isMondayFirst() {\r\n        // TODO Firefox does not support it\r\n        return new Intl.Locale(this.#language)?.weekInfo?.firstDay === 1;\r\n    }\r\n\r\n    #capitalize(val = '') {\r\n        return val.charAt(0).toUpperCase() + val.slice(1);\r\n    }\r\n\r\n    #toLocale(opt) {\r\n        return this.toLocaleString(this.#language, opt);\r\n    }\r\n\r\n    #formatHour(size) {\r\n        return (this.getHours() % 12 || 12).toString().padStart(size, '0');\r\n    }\r\n\r\n    #meridiem(isLowercase) {\r\n        const opt = { hour: '2-digit', hour12: true };\r\n        const val = this.#toLocale(opt).split(' ').pop(-1);\r\n        return isLowercase ? val.toLowerCase() : val;\r\n    }\r\n\r\n    #zoneStr() {\r\n        const me = this;\r\n        const negMinutes = -1 * me.getTimezoneOffset();\r\n        const minutes = Math.abs(negMinutes)\r\n        const hourOffset = Math.floor(minutes / 60)\r\n        const minuteOffset = minutes % 60;\r\n\r\n        const seg1 = negMinutes <= 0 ? '+' : '-';\r\n        const seg2 = hourOffset.toString().padStart(2, '0');\r\n        const seg3 = minuteOffset.toString().padStart(2, '0');\r\n\r\n        return `${seg1}${seg2}:${seg3}`;\r\n    }\r\n\r\n    static parse(value, format, language) {\r\n        format = format || GSUtil.getDateFormat(language);\r\n        const regex = GSDate.#getFormattedDateRegex(format);\r\n        return GSDate.#parseFormattedDate(value, regex);\r\n    }\r\n    \r\n    static #getFormattedDateRegex(format) {\r\n        return new RegExp(\r\n            '^\\\\s*' + format.toUpperCase().replaceAll(/([MDY])\\1*/g, '(?<$1>\\\\d+)') + '\\\\s*$'\r\n        );\r\n    }\r\n\r\n    static #parseFormattedDate(value, regex) {\r\n\r\n        const { groups } = value.match(regex) ?? {};\r\n\r\n        if (!groups) return null;\r\n\r\n        const y = Number(groups.Y);\r\n        const m = Number(groups.M);\r\n        const d = Number(groups.D);\r\n\r\n        // Validate range of year and month\r\n        if (y < 1000 || y > 2999) return null;\r\n        if (m < 1 || m > 12) return null;\r\n\r\n        const date = new Date(y, m - 1, d);\r\n\r\n        // Validate day of month exists\r\n        if (d !== date.getDate()) return null;\r\n\r\n        return isNaN(date.valueOf()) ? null : date;\r\n    }\r\n\r\n    /**\r\n     * Check if a year is a leap year\r\n     * @param {number} year \r\n     * @returns {Boolean}\r\n     */\r\n    static isLeapYear(year) {\r\n        return (year % 4 === 0 && year % 100 !== 0) || (year % 400 === 0);\r\n    }\r\n\r\n    static {\r\n        globalThis.GSDate = GSDate;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSData class\r\n * @module base/GSData\r\n */\r\n\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSDate } from \"./GSDate.mjs\";\r\nimport { GSAttr } from \"./GSAttr.mjs\";\r\n\r\n/**\r\n * A set of static functions used for loading resources\r\n * @class\r\n */\r\nexport class GSData {\r\n\r\n    static PROPERTIES = { name: {}, type: {}, format: {}, currency: {}, language: {}, extract: {}, key: { type: Boolean } };\r\n\r\n    /**\r\n     * Removes duplicates from list\r\n     * @param {Array} data \r\n     * @returns {Array}\r\n     */\r\n    static unique(data) {\r\n        return Array.from(new Set(data));\r\n    }\r\n\r\n    static compareArrays = (a, b) => a.length === b.length && a.every((element, index) => element === b[index]);\r\n\r\n    /**\r\n     * Check if two arrays are equal\r\n     * \r\n     * @param {Array} a \r\n     * @param {Array} b \r\n     * @returns {Boolean}\r\n     */\r\n    static arraysEqual(a, b) {\r\n\r\n        if (!Array.isArray(a)) return false;\r\n        if (!Array.isArray(b)) return false;\r\n        if (a === b) return true;\r\n\r\n        a = a.toSorted();\r\n        b = b.toSorted();\r\n\r\n        return GSData.compareArrays(a, b);\r\n    }\r\n\r\n    /**\r\n     * Simple array merge, without duplicates. Used by observableAttributes\r\n     * TODO: improve https://www.geeksforgeeks.org/how-to-convert-array-of-objects-into-unique-array-of-objects-in-javascript/\r\n     * @param {Array} first \r\n     * @param {Array} second \r\n     * @param {Boolean} advanced Used when data is Object instead of string\r\n     * @returns {Array}\r\n     */\r\n    static mergeArrays(first = [], second = [], advanced = false) {\r\n        if (advanced) {\r\n            return [...new Set([...first, ...second].map(JSON.stringify))].map(JSON.parse);\r\n        }\r\n        return [...first, ...second].filter((value, index, arr) => arr.indexOf(value) === index);\r\n    }\r\n\r\n    /**\r\n     * Simple Object merge\r\n     * @param {*} list \r\n     * @returns \r\n     */\r\n    static mergeObjects(list = []) {\r\n        let o = {};\r\n        list.filter(o => o).forEach(it => o = { ...o, ...it });\r\n        return o;\r\n    }\r\n\r\n    /**\r\n     * Convert data to format by given definition.\r\n     * @param {object} cfg {name:'field_name' , type:'date', format:'d/m/y', currency:'eur', language:'hr', extract:'REGEX'}\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    static format(cfg, val) {\r\n\r\n        const type = GSData.#toType(cfg, val);\r\n        const language = cfg.language || GSUtil.language;\r\n        const rule = GSUtil.toRegex(cfg.extract, 'g');\r\n        val = rule ? val.match(rule)[0] : val;\r\n\r\n        // intercept overrides; used b GS-TABLE cell Ui remapping\r\n        if (cfg.childElementCount > 0) {\r\n            const el = cfg.querySelector(`gs-item[value=\"${val}\"]`);\r\n            return GSAttr.get(el, \"map\", val);\r\n        }\r\n\r\n        switch (type) {\r\n            case 'timestamp':\r\n                if (val instanceof Date) return val;\r\n                if (GSUtil.isNumber(val)) return new GSDate(val).format(cfg.format, language);\r\n                if (cfg.format) return GSDate.parse(val, cfg.format, language);\r\n                return Date.parse(val);\r\n            case 'date':\r\n                if (val instanceof Date) return val;\r\n                const fmt = GSUtil.asBool(cfg.format) ? undefined : cfg.format;\r\n                if (GSUtil.isString(val)) return GSDate.parse(val, fmt, language);\r\n                return val && val != 0 ? new GSDate(val).format(fmt, language) : val;\r\n            case 'string':\r\n            case 'text':\r\n                if (val instanceof Date) {\r\n                    const fmt = cfg.format || GSUtil.getDateFormat(language);\r\n                    return new GSDate(val).format(fmt, language);\r\n                };\r\n                break;\r\n            case 'boolean':\r\n                return GSUtil.asBool(val, false);\r\n            case 'number':\r\n                return GSUtil.asNum(val, val, language);\r\n            case 'currency':\r\n                if (GSUtil.isString(val)) val = GSUtil.asNum(val);\r\n                const opt = { style: 'currency', currency: cfg.currency };\r\n                return new Intl.NumberFormat(language, opt).format(val);\r\n        }\r\n\r\n        return val;\r\n    }\r\n\r\n    static #toType(cfg, val) {\r\n        if (cfg.type) return cfg.type;\r\n        if (val instanceof Date) return 'date';\r\n        if (val instanceof Number) return 'number';\r\n        if (val instanceof Boolean) return 'boolean';\r\n        return typeof val;\r\n    }\r\n\r\n    /**\r\n     * Filter array of records \r\n     * @param {Array} data Array of JSON objects or array of array of primitive types\r\n     * @param {Array<object>|String} filter Check filterComplex function for details\r\n     * @param {Array<String>} fields List of Object properties to check, if not set, all are checked\r\n     * @returns {Array}\r\n     */\r\n    static *filter(data = [], filter = [], fields, limit = 0) {\r\n        let cnt = 0;\r\n        let sts = false;\r\n        for (let rec of data) {\r\n            sts = GSData.filterRecord(rec, filter, fields);\r\n            if (sts) {\r\n                cnt++\r\n                yield rec;\r\n            }\r\n            if (limit > 0 && cnt >= limit) break;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Filter array of records \r\n     * @param {Array} data Array of JSON objects or array of array of primitive types\r\n     * @param {Array<object>|String} filter Check filterComplex function for details\r\n     * @param {Array<String>} fields List of Object properties to check, if not set, all are checked\r\n     * @returns {Array}\r\n     */\r\n    static filterData(data = [], filter = [], fields, limit = 0) {\r\n        data = Array.isArray(data) ? data : [data];\r\n        filter = Array.isArray(filter) ? filter : [filter];\r\n        if (filter.length === 0) return data;\r\n        return [...GSData.filter(data, filter, fields, limit)];\r\n    }\r\n\r\n    /**\r\n     * Filter single record to a matchign critheria\r\n     * @param {Array<object>|String} filter Check filterComplex function for details\r\n     * @param {Array} data Array of JSON objects or array of array of primitive types\r\n     * @param {Array<String>} fields List of Object properties to check, if not set, all are checked\r\n     * @returns {Array}\r\n     */\r\n    static filterRecord(rec, filter, fields) {\r\n        const isSimple = GSUtil.isPrimitive(filter);\r\n        return isSimple ? GSData.filterSimple(rec, filter, fields) : GSData.filterComplex(rec, filter, fields);\r\n    }\r\n\r\n    /**\r\n     * Check if JSON object contains a value in any of defined properties\r\n     * @param {Object} rec Json object to check\r\n     * @param {String} filter Value to search for\r\n     * @param {Array<string>} fields List of properties to serach\r\n     * @returns {Boolean} Return true if any of given properties (or all) contains provided value\r\n     */\r\n    static filterSimple(rec, filter = '', fields) {\r\n        filter = filter.toLowerCase();\r\n        fields = fields || Object.keys(rec);\r\n        let value = null;\r\n        for (let key of fields) {\r\n            value = rec[key];\r\n            if (GSData.filterValue(value, filter)) return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Check if object contains data in selected properties\r\n     * @todo Add support for eq,gt,lt,like,or operators\r\n     * @param {Object|Array} rec Json object or array of primitive values to check\r\n     * @param {Array<Object>} filter List of filter objects in format\r\n     *        [{name: idx[num] || name[string], value: ''  , op:'eq'}]\r\n     *        Where:\r\n     *           - name is numeric index only if rec is array of primitive values ([1,'a','b',4]...etc)\r\n     *           - name is string if rec is JSON object\r\n     * @returns {Boolean} Flag indicating if record is matched to a given filter critheria\r\n     */\r\n    static filterComplex(rec, filter, fields) {\r\n\r\n        let primitive = false;\r\n        let found = true;\r\n        let value = null;\r\n\r\n        for (let flt of filter) {\r\n\r\n            primitive = GSUtil.isPrimitive(flt);\r\n            if (primitive) {\r\n                found = found && GSData.filterSimple(rec, flt, fields);\r\n            } else {\r\n                value = rec[flt.name];\r\n                if (flt.name) {\r\n                    found = found && GSData.filterValue(value, flt)\r\n                } else {\r\n                    found = found && GSData.filterSimple(rec, flt.value, fields);\r\n                }\r\n            }\r\n\r\n            if (!found) break;\r\n        }\r\n\r\n        return found;\r\n    }\r\n\r\n    static filterValue(value, filter) {\r\n        const toCheck = GSUtil.isPrimitive(filter) ? filter : filter.value;\r\n        if (GSUtil.isDate(value)) {\r\n            return GSData.matchDate(value, filter);\r\n        } else if (GSUtil.isNumber(value)) {\r\n            return GSData.matchNumber(value, GSUtil.asNum(toCheck, null), filter.op);\r\n        } else {\r\n            return (GSUtil.normalize(value)).toLocaleLowerCase().includes(GSUtil.normalize(toCheck).toLocaleLowerCase());\r\n        }\r\n    }\r\n\r\n    static matchDate(val, filter, language) {\r\n\r\n        if (typeof filter === 'string') {\r\n            const value = '' + filter;\r\n            const local = val.toLocaleDateString(language);\r\n            const iso = val.toISOString();\r\n            return local.includes(value) || iso.includes(value);\r\n        }\r\n\r\n        if (!filter.value) return false;\r\n\r\n        const qry = filter.value instanceof Date ? 'date' : typeof filter.value;\r\n\r\n        switch (qry) {\r\n            case 'number':\r\n                return GSData.matchNumber(val.getTime(), filter.value, filter.op);\r\n            case 'date':\r\n                return GSData.matchNumber(val.getTime(), filter.value.getTime(), filter.op);\r\n        }\r\n\r\n        return GSData.matchDate(val, '' + filter.value, filter.language);\r\n    }\r\n\r\n    /**\r\n     * Match number by operator\r\n     * @param {*} value \r\n     * @param {*} query \r\n     * @param {*} operator \r\n     */\r\n    static matchNumber(value = 0, query = 0, operator = 'eq') {\r\n        switch (operator) {\r\n            case 'gt': return query > value;\r\n            case 'lt': return query < value;\r\n            case 'ge': return query >= value;\r\n            case 'le': return query <= value;\r\n        }\r\n        return value === query;\r\n    }\r\n\r\n    /**\r\n     * Sort data\r\n     * @param {*} data \r\n     * @param {*} sort \r\n     * @returns {Array}\r\n     */\r\n    static sortData(data, sort) {\r\n        if (sort.length === 0) return data;\r\n        return data.toSorted((a, b) => GSData.sortPair(a, b, sort));\r\n    }\r\n\r\n    /**\r\n     * Sort two values, recursion supported\r\n     * @param {*} v1 Array of primitive types or JSON object\r\n     * @param {*} v2 Array of primitive types or JSON object\r\n     * @param {Number} sort -1 | 0 | 1 (descending, as id, ascending )\r\n     * @returns {Number} -1 | 0 | 1\r\n     */\r\n    static sortPair(a, b, sort) {\r\n\r\n        const isArray = Array.isArray(a);\r\n        let sts = 0;\r\n\r\n        sort.forEach((o, i) => {\r\n            if (!o) return;\r\n            const ord = GSUtil.isNumber(o) ? o : o.ord;\r\n            const idx = GSUtil.isNumber(o.col) ? o.col : i;\r\n            const key = isArray ? idx : o.name;\r\n            const v1 = a[key];\r\n            const v2 = b[key];\r\n\r\n            sts = GSData.compare(v1, v2, ord, sts);\r\n        });\r\n\r\n        return sts;\r\n    }\r\n\r\n    /**\r\n     * Compare two values, recursion supported\r\n     * @param {*} v1 \r\n     * @param {*} v2 \r\n     * @param {Number} order -1 | 0 | 1 (descending, as id, ascending )\r\n     * @param {Number} sts previous value\r\n     * @returns {Number} -1 | 0 | 1\r\n     */\r\n    static compare(v1, v2, order, sts) {\r\n        if (GSUtil.isNumber(v1) && GSUtil.isNumber(v2)) {\r\n            return sts || GSData.compareNum(v1, v2, order);\r\n        } else if (GSUtil.isString(v1) || GSUtil.isString(v2)) {\r\n            return sts || GSData.compareString(v1, v2, order);\r\n        } else if (GSUtil.isBool(v1) || GSUtil.isBool(v2)) {\r\n            return sts || GSData.compareBool(v1, v2, order);\r\n        } else if (GSUtil.isDate(v1) || GSUtil.isDate(v2)) {\r\n            return sts || GSData.compareNum(Number(v1), Number(v2), order);\r\n        }\r\n        return sts;\r\n    }\r\n\r\n    /**\r\n     * Safely compare two boolean values\r\n     * @param {Boolean} v1 \r\n     * @param {Boolean} v2 \r\n     * @param {Number} ord \r\n     * @returns {Number} -1 | 0 | 1\r\n     */\r\n    static compareBool(v1, v2, ord) {\r\n        v1 = v1 ? 1 : 0;\r\n        v2 = v2 ? 1 : 0;\r\n        return GSData.compareNum(v1, v2, ord);\r\n    }\r\n\r\n    /**\r\n     * Compare two string values \r\n     * @param {String} v1 \r\n     * @param {String} v2 \r\n     * @param {Number} ord \r\n     * @returns {Number} -1, 1, 0\r\n     */\r\n    static compareString(v1, v2, ord) {\r\n        const s1 = (v1 || '').toString();\r\n        const s2 = (v2 || '').toString();\r\n        return ord < 0 ? s2.localeCompare(s1) : s1.localeCompare(s2);\r\n    }\r\n\r\n    /**\r\n     * Compare two numeric values\r\n     * @param {Number} v1 \r\n     * @param {Number} v2 \r\n     * @param {Number} ord positive = ascending, negative - descending \r\n     * @returns {Number} < 0 or 1 or > 0\r\n     */\r\n    static compareNum(v1, v2, ord) {\r\n        return ord < 0 ? v2 - v1 : v1 - v2;\r\n    }\r\n\r\n    /**\r\n     * Write value to JSON object into structured name.\r\n     * Name subelements are separated by dot (users.name etc.).\r\n     * @param {Object} obj \r\n     * @param {String} name  \r\n     * @param {Boolean} ignoreNull  \r\n     * @param {Object} value \r\n     */\r\n    static writeToObject(obj, name, value, ignoreNull = true) {\r\n        if (ignoreNull && GSUtil.isNull(value)) return;\r\n\r\n        const seg = name.split('.');\r\n        if (seg.length === 1) {\r\n            return GSData.#writeSingleToObject(obj, name, value);\r\n        }\r\n\r\n        const tree = seg.slice(0, -1);\r\n        const key = seg.slice(-1)[0];\r\n\r\n        tree.forEach(v => {\r\n            if (!obj.hasOwnProperty(v)) obj[v] = {};\r\n            obj = obj[v];\r\n        });\r\n\r\n        return GSData.#writeSingleToObject(obj, key, value);\r\n    }\r\n\r\n    static #writeSingleToObject(obj, name, value) {\r\n        if (obj.hasOwnProperty(name)) {\r\n            if (!Array.isArray(obj[name])) {\r\n                obj[name] = [obj[name]];\r\n            }\r\n            if (Array.isArray(value)) {\r\n                obj[name] = obj[name].concat(value);\r\n            } else {\r\n                obj[name].push(value);\r\n            }\r\n        } else {\r\n            obj[name] = value;\r\n        }\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Read object property by supporting arrays\r\n     * name can be plain name or name[idx]\r\n     * @param {*} obj \r\n     * @param {String} name \r\n     * @returns {*}\r\n     */\r\n    static readFromProperty(obj, name, partial = false) {\r\n        if (GSUtil.isNull(obj)) return;\r\n        const r = /\\[\\d+\\]$/g;\r\n        const isArray = r.test(name);\r\n        let n = name;\r\n        let i = '';\r\n\r\n        if (isArray) {\r\n            n = name.replace(r, '')\r\n            i = name.match(r).shift().match(/\\d+/).shift();\r\n            i = GSUtil.asNum(i);\r\n            obj = obj.hasOwnProperty(n) ? obj[n][i] : null;\r\n        } else if (obj.hasOwnProperty(n)) {\r\n            obj = partial ? obj[n] || obj : obj[n];\r\n        } else {\r\n            obj = null;\r\n        }\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Read value from JSON object by structured name.\r\n     * Name subelements are separated by dot (users.name etc.).\r\n     * @param {Object} obj \r\n     * @param {String} name \r\n     * @returns {*}\r\n     */\r\n\tstatic readFromObject(obj, name) {\r\n        if (obj?.hasOwnProperty(name)) return GSData.readFromProperty(obj, name);\r\n\t\treturn name ? name.split('.').reduce((a, v) => GSData.readFromProperty(a, v), obj) : undefined;\r\n\t}\r\n\t\r\n    /**\r\n     * Check if named path exist within the object\r\n     * @param {Object} obj \r\n     * @param {String} name \r\n     * @returns {Boolean}\r\n     */\r\n\tstatic objectPathExist(obj, name) {\r\n        return GSData.readFromObject(obj, name) !== undefined;\r\n\t}\r\n\r\n    /**\r\n     * Create a deep clone of an object\r\n     * @param {Object} obj \r\n     * @returns {Object}\r\n     */\r\n    static deepClone(obj) {\r\n        return JSON.parse(JSON.stringify(obj));\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSData);\r\n        globalThis.GSData = GSData;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDOM class\r\n * @module base/GSDOM\r\n */\r\n\r\nimport { GSAttr } from \"./GSAttr.mjs\";\r\nimport { GSCSSMap } from \"./GSCSSMap.mjs\";\r\nimport { GSData } from \"./GSData.mjs\";\r\nimport { GSLog } from \"./GSLog.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A generic set of static functions to handle DOM tree and DOM elements\r\n * @class\r\n */\r\nexport class GSDOM {\r\n\r\n\tstatic QUERY_FOCUSABLE = \"a[href]:not([tabindex='-1']),area[href]:not([tabindex='-1']),input:not([disabled]):not([tabindex='-1']),select:not([disabled]):not([tabindex='-1']),textarea:not([disabled]):not([tabindex='-1']),button:not([disabled]):not([tabindex='-1']),iframe:not([tabindex='-1']),[tabindex]:not([tabindex='-1']),[contentEditable=true]:not([tabindex='-1'])\";\r\n\tstatic QUERY_INPUT = \"input:not([type='hidden']):not(disabled):not(readonly),select:not([type='hidden']):not(disabled):not(readonly),textarea:not([type='hidden']):not(disabled):not(readonly)\";\r\n\tstatic #FORMEL = ['INPUT', 'SELECT', 'TEXTAREA', 'OUTPUT'];\r\n\t//static #CLEANUP1 = /(\\n*\\t*)*(?=\\n\\t*)/g\r\n\tstatic #CLEANUP1 = /(?:\\n+\\t*)+/g\r\n\r\n\t// Timeout for removing element\r\n\tstatic SPEED = 300;\r\n\r\n\t/**\r\n\t * Recursevly clean child elements. Helper for GC\r\n\t * @param {*} owner \r\n\t */\r\n\tstatic cleanup(owner) {\r\n\t\tArray.from(GSDOM.walk(owner, false, true, false))\r\n\t\t.forEach(el => {\r\n\t\t\tif (GSDOM.isTemplateElement(el)) GSDOM.cleanup(el.content);\r\n\t\t\tel.remove?.();\r\n\t\t\tel.innerHTML = '';\r\n\t\t\tel.nodeValue = undefined;\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Find active (focused) element\t\r\n\t * @returns {HTMLElement} Focused element\r\n\t */\r\n\tstatic get activeElement() {\r\n\t\treturn GSDOM.active(document.activeElement);\r\n\t}\r\n\r\n\t/**\r\n\t * Find active (focused) element\r\n\t * @param {HTMLElement} el Starting node\r\n\t * @returns {HTMLElement} Focused element\r\n\t */\r\n\tstatic active(el) {\r\n\t\treturn el.shadowRoot?.activeElement ? GSDOM.active(el.shadowRoot?.activeElement) : el;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if element is visible\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isVisible(el) {\r\n\t\tif (!GSDOM.isHTMLElement(el)) return false;\r\n\t\tconst css = GSCSSMap.getComputedStyledMap(el);\r\n\t\tconst visibility = !css.matches('visibility', 'hidden');\r\n\t\tconst display = !css.matches('display', 'none');\r\n\t\tconst opacity = css.asNum('opacity') > 0;\r\n\t\tconst rect = el.getBoundingClientRect();\r\n\t\tconst size = (rect.width > 0 && rect.height > 0);\r\n\t\treturn size && opacity && visibility && display;\r\n\t}\r\n\r\n\t/**\r\n\t* Parse string into html DOM\r\n\t*\r\n\t* @param {String} html Source to parse\r\n\t* @param {Boolean} single Return first element or all\r\n\t* @param {String} mime Src mime type\r\n\t* @return {HTMLElement}\r\n\t*/\r\n\tstatic parse(html = '', single = false, mime = 'text/html') {\r\n\t\ttry {\r\n\t\t\tconst parser = new DOMParser();\r\n\t\t\tconst doc = parser.parseFromString(html, mime);\r\n\t\t\treturn single ? (doc?.head?.firstElementChild || doc?.body?.firstElementChild) : doc;\r\n\t\t} catch (e) {\r\n\t\t\tGSLog.error(null, e);\r\n\t\t\tthrow e;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Parse source and auto wrap if required\r\n\t * @param {GSElement} own \r\n\t * @param {String} src \r\n\t * @returns {HTMLElement}\r\n\t */\r\n\tstatic parseWrapped(own, src = '', forceWrap = false) {\r\n\r\n\t\tconst doc = GSDOM.parse(src);\r\n\t\tconst head = GSDOM.#fromNode(doc.head.children);\r\n\t\tconst body = GSDOM.#fromNode(doc.body.children);\r\n\r\n\t\tconst nodes = [...head, ...body];\r\n\r\n\t\tconst wrap = forceWrap || nodes.length !== 1;\r\n\r\n\t\tconst tpl = GSDOM.wrap(own, wrap ? null : nodes.shift());\r\n\r\n\t\twhile (nodes.length > 0) tpl.appendChild(nodes.shift());\r\n\r\n\t\treturn tpl;\r\n\t}\r\n\r\n\t/**\r\n\t * The same as link function, with default wrapper element\r\n\t * \r\n\t * @param {HTMLElement} own Owner element to which target is linked\r\n\t * @param {HTMLElement} target Target elemetn to link to owner\r\n\t * @returns {HTMLElement} Return target\r\n\t */\r\n\tstatic wrap(own, target) {\r\n\t\treturn GSDOM.link(own, target || document.createElement('gs-block'));\r\n\t}\r\n\r\n\t/**\r\n\t * Create reference between two HTMLElements\r\n\t * \r\n\t * @param {HTMLElement} own Owner element to which target is linked\r\n\t * @param {HTMLElement} target Target elemetn to link to owner\r\n\t * @returns {HTMLElement} Return target\r\n\t */\r\n\tstatic link(own, target) {\r\n\t\ttarget.setAttribute('proxy', `#${own.id}`);\r\n\t\tif (own.slot) target.setAttribute('slot', own.slot);\r\n\t\treturn target;\r\n\t}\r\n\r\n\tstatic #fromNode(nodes) {\r\n\t\treturn Array.from(nodes || []).filter(el => !GSDOM.isText(el));\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given value is part of HTMLFormElement\r\n\t * @param {string | HTMLElement} el \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isFormElement(el) {\r\n\t\tconst name = GSUtil.isString(el) ? el : el?.tagName;\r\n\t\treturn GSDOM.#FORMEL.includes(name);\r\n\t}\r\n\r\n\t/**\r\n\t * Return all form elements for a given root element\r\n\t * @param {HTMLElement} el \r\n\t * @param {Boolean} shadow \r\n\t * @returns \r\n\t */\r\n\tstatic formElements(el, shadow = false) {\r\n\t\treturn GSDOM.queryAll(el, GSDOM.#FORMEL.map(v => v.toLowerCase()), shadow);\r\n\t}\r\n\r\n\t/**\r\n\t * Check if element is button\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isButtonElement(el) {\r\n\t\treturn (el instanceof HTMLButtonElement)\r\n\t\t\t|| el?.tagName === 'GS-BUTTON'\r\n\t\t\t|| GSDOM.hasClass(el, 'btn');\r\n\t}\r\n\r\n\t/**\r\n\t  * Check if given element is of given type \r\n\t  * \r\n\t  * @param {HTMLElement} el\r\n\t  * @param {String|class} type Tag Name, class name or Class\r\n\t  * @returns {Boolean}\r\n\t  */\r\n\tstatic isElement(el, type) {\r\n\r\n\t\tconst isArgs = type && el;\r\n\t\tif (!isArgs) return false;\r\n\r\n\t\tconst isStr = GSUtil.isString(type);\r\n\r\n\t\tif (!isStr) return el instanceof type;\r\n\r\n\t\tconst ownClazz = customElements.get(type.toLowerCase());\r\n\t\tif (ownClazz && el instanceof ownClazz) return el;\r\n\r\n\t\tconst it = GSDOM.inheritance(el);\r\n\t\tfor (let pel of it) {\r\n\t\t\tif (pel?.constructor?.name === type) return el;\r\n\t\t}\r\n\r\n\t\tif (type.toUpperCase() === el.tagName) return el;\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type HTMLSelectElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isSelect(el) {\r\n\t\treturn el instanceof HTMLSelectElement;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type HTMLSlotElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isSlotElement(el) {\r\n\t\treturn el instanceof HTMLSlotElement;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type HTMLElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isTemplateElement(el) {\r\n\t\treturn el instanceof HTMLTemplateElement;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type HTMLElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isHTMLElement(el) {\r\n\t\treturn el instanceof HTMLElement;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type SVGElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isSVGElement(el) {\r\n\t\treturn el instanceof SVGElement;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type Text\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isText(el) {\r\n\t\treturn el instanceof Text;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if given element is of type Comment\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isComment(el) {\r\n\t\treturn el instanceof Comment;\r\n\t}\r\n\r\n\t/*\r\n\t * Check if given element is of type GSElement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isGSElement(el) {\r\n\t\tif (!el?.clazzName) return false;\r\n\t\tconst it = GSDOM.inheritance(el);\r\n\t\tfor (let v of it) {\r\n\t\t\tif (!v) break;\r\n\t\t\tif (v?.clazzName === 'GSElement') return true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if standard element extended with GS\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isGSExtra(el) {\r\n\t\treturn el?.getAttribute('is')?.indexOf('GS-') === 0;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if element is inside shadowDom\r\n\t * @param {*} el \r\n\t */\r\n\tstatic isShadowed(el) {\r\n\t\treturn GSDOM.parentAll(el).filter(e => e instanceof ShadowRoot).next()?.value;\r\n\t}\r\n\r\n\t/**\r\n\t * Get all child GSElement\t\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Array<HTMLElement>}\r\n\t */\r\n\tstatic getChilds(el) {\r\n\t\treturn Array.from(el?.childNodes || []).filter(e => GSDOM.isGSElement(e));\r\n\t}\r\n\r\n\t/**\r\n\t * Hide html element\r\n\t * @param {HTMLElement} el \r\n\t * @param {Boolean} orientation \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic hide(el, orientation = false) {\r\n\t\treturn el?.classList?.add(orientation ? 'gs-hide-orientation' : 'gs-hide');\r\n\t}\r\n\r\n\t/**\r\n\t * Show html element\r\n\t * @param {HTMLElement} el \r\n\t * @param {Boolean} orientation \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic show(el, orientation = false) {\r\n\t\treturn el?.classList?.remove(orientation ? 'gs-hide-orientation' : 'gs-hide');\r\n\t}\r\n\r\n\t/**\r\n\t * Add node as next in list of nodes\r\n\t * @param {HTMLElement} target \r\n\t * @param {HTMLElement} newEl \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic addSibling(target, newEl) {\r\n\t\tconst injectable = GSDOM.isHTMLElement(newEl) || GSDOM.isSVGElement(newEl);\r\n\t\tconst isOK = GSDOM.isHTMLElement(target) && injectable;\r\n\t\tconst invalid = target === newEl && target.parentNode === newEl || target.nextElementSibling === newEl;\r\n\t\treturn isOK && !invalid ? target.parentNode.insertBefore(newEl, target.nextElementSibling) : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Add child node to a target\r\n\t * @param {HTMLElement} target \r\n\t * @param {HTMLElement} newEl \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic appendChild(target, newEl) {\r\n\t\tconst isok = GSDOM.isHTMLElement(target) && GSDOM.isHTMLElement(newEl);\r\n\t\treturn isok && target !== newEl ? target.appendChild(newEl) : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Add node to a target at specified place\r\n\t * @param {HTMLElement} target \r\n\t * @param {HTMLElement} newEl \r\n\t * @param {String} placement\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic insertAdjacent(target, newEl, placement) {\r\n\t\tconst isok = GSDOM.isHTMLElement(target) && GSDOM.isHTMLElement(newEl);\r\n\t\tconst invalid = target === newEl && target.parentNode === newEl\r\n\t\treturn isok && !invalid ? target.insertAdjacentElement(placement, newEl) : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Remove genarated componnt from parent\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic removeElement(el) {\r\n\t\treturn GSDOM.parent(el)?.removeChild(el);\r\n\t}\r\n\r\n\t/**\r\n\t * Walk node tree\r\n\t * \r\n\t * @param {HTMLLegendElement} node Start node to walk from \r\n\t * @param {Boolean} closest Direction down (false) or up (true)\r\n\t * @param {Boolean} all  Filter HTMLElements (false) only or text also (true) (only down)\r\n\t * @param {Boolean} shadow Traverse shadow DOM also (only down)\r\n\t * @returns {Iterable}\r\n\t */\r\n\tstatic walk(node, closest = false, all = false, shadow = true) {\r\n\t\treturn closest ? GSDOM.parentAll(node) : GSDOM.childAll(node, all, shadow);\r\n\t}\r\n\r\n\t/**\r\n\t * Traverse DOM tree top-to-bottom\r\n\t * \r\n\t * @param {*} node Start node\r\n\t * @param {*} all  Include all elements (Text,Comment, HTMLElements)\r\n\t * @param {*} shadow Include traversing across shadow tree\r\n\t * @param {*} child Inernal, do not use\r\n\t * @returns {Iterable}\r\n\t */\r\n\tstatic *childAll(node, all = false, shadow = true, child = false) {\r\n\t\tif (!node) return;\r\n\t\tif (child) yield node;\r\n\t\tif (shadow) yield* GSDOM.childAll(node.shadowRoot, all, shadow, true);\r\n\t\tconst list = all ? node.childNodes : node.children;\r\n\t\tif (!list) return;\r\n\t\tfor (let child of list) {\r\n\t\t\tyield* GSDOM.childAll(child, all, shadow, true);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Get parent element\r\n\t * \r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement}\r\n\t */\r\n\tstatic parent(el) {\r\n\t\treturn el ? (el.parentElement || el.parentNode || el.host) : null;\r\n\t}\r\n\r\n\t/**\r\n\t * Parent element iterator\r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement}\r\n\t * @iterator\r\n\t */\r\n\tstatic *parentAll(el) {\r\n\t\tlet e = GSDOM.parent(el);\r\n\t\twhile (e) {\r\n\t\t\tyield e;\r\n\t\t\te = GSDOM.parent(e);\r\n\t\t}\r\n\t\tif (e) return yield e;\r\n\t}\r\n\r\n\t/**\r\n\t * Element prototype iterator\r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement}\r\n\t * @iterator\r\n\t */\r\n\tstatic *inheritance(el) {\r\n\t\tlet e = el.__proto__;\r\n\t\twhile (e) {\r\n\t\t\tyield e;\r\n\t\t\te = e.__proto__;\r\n\t\t}\r\n\t\tif (e) return yield e;\r\n\t}\r\n\r\n\t/**\r\n\t * Recursively find offsetparent; used in positional offset calculation\r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement}\r\n\t */\r\n\tstatic offsetParent(el) {\r\n\t\tlet offset = el?.offsetParent;\r\n\t\tif (offset) return offset;\r\n\t\tconst it = GSDOM.parentAll(el);\r\n\t\tfor (const c of it) {\r\n\t\t\toffset = c.offsetParent;\r\n\t\t\tif (offset) break;\r\n\t\t}\r\n\t\treturn offset;\r\n\t}\r\n\r\n\t/**\r\n\t * Get root element whch might be shadow root, GSElement, any parent element\r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement|ShadowRoot}\r\n\t */\r\n\tstatic root(el) {\r\n\r\n\t\tif (!el) return null;\r\n\r\n\t\tconst it = GSDOM.parentAll(el);\r\n\t\tfor (let v of it) {\r\n\t\t\tif (v instanceof ShadowRoot) return v;\r\n\t\t\tif (v instanceof HTMLBodyElement) return v;\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * Get WebComponent owning element inside rendered shadow root\r\n\t * @param {HTMLElement} el \r\n\t * @returns {HTMLElement}\r\n\t */\r\n\tstatic component(el) {\r\n\t\treturn GSDOM.parent(GSDOM.root(el));\r\n\t}\r\n\r\n\t/**\r\n\t * Get node index between siblings\r\n\t * @param {HTMLElement} node \r\n\t * @returns {Number}\r\n\t */\r\n\tstatic getElementIndex(node) {\r\n\t\tif (!GSDOM.isHTMLElement(node)) return 0;\r\n\t\treturn [...node.parentElement.children].indexOf(node);\r\n\t}\r\n\r\n\t/**\r\n\t * Find element by ID within DOM Tree across Shadow DOM\r\n\t * @param {HTMLElement} el Root node to start from\r\n\t * @param {String} id Element id\r\n\t * @returns {HTMLElement} \r\n\t */\r\n\tstatic getByID(el, id) {\r\n\t\tif (typeof el === 'string') return GSDOM.getByID(document.documentElement, el);\r\n\t\tif (!(el && id)) return null;\r\n\t\tconst it = GSDOM.walk(el, false);\r\n\t\tfor (let o of it) {\r\n\t\t\tif (o.id === id) return o;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * Query DOM Tree up to find closest element across Shadow DOM\r\n\t * @param {HTMLElement} el Root node to start from\r\n\t * @param {String} qry CSS query\r\n\t * @param {Number} level How many levels to walk, 0 = all\r\n\t * @returns {HTMLElement} \r\n\t */\r\n\tstatic closest(el, qry, levels = 0) {\r\n\t\tif (typeof el === 'string') return GSDOM.closest(document.documentElement, qry);\r\n\t\tif (!(el && qry)) return null;\r\n\t\tlevels = GSUtil.asNum(levels, 0);\r\n\t\tconst limit = levels > 0;\r\n\t\tconst it = GSDOM.walk(el, true);\r\n\t\tfor (let o of it) {\r\n\t\t\tif (GSDOM.matches(o, qry)) return o;\r\n\t\t\tif (limit && --levels == 0) return null;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * Query DOM tree with support for Shadow DOM\r\n\t * \r\n\t * @param {HTMLElement} el Root node to start from\r\n\t * @param {String} qry CSS query\r\n\t * @returns {HTMLElement} \r\n\t */\r\n\tstatic query(el, qry, all = false, shadow = true) {\r\n\t\tif (typeof el === 'string') return GSDOM.query(document.documentElement, el, all, shadow);\r\n\t\tif (!(el && qry)) return null;\r\n\t\tif (GSDOM.matches(el, qry)) return GSDOM.#proxy(el);\r\n\t\tconst it = GSDOM.walk(el, false, all, shadow);\r\n\t\tfor (let o of it) {\r\n\t\t\tif (GSDOM.matches(o, qry)) return GSDOM.#proxy(o);\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * Query DOM tree with support for Shadow DOM\r\n\t * \r\n\t * @param {HTMLElement} el Root node to start from\r\n\t * @param {String} qry CSS query\r\n\t * @returns {Array<HTMLElement>}\r\n\t*/\r\n\tstatic queryAll(el, qry, all = false, shadow = true) {\r\n\t\tif (typeof el === 'string') return GSDOM.queryAll(document.documentElement, el, all, shadow);\r\n\t\tconst res = [];\r\n\t\tif (!(el && qry)) return res;\r\n\t\tconst it = GSDOM.walk(el, false, all, shadow);\r\n\t\tfor (let o of it) {\r\n\t\t\tif (GSDOM.matches(o, qry)) res.push(GSDOM.#proxy(o));\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n\r\n\t/**\r\n\t * Overide native to prevent DOM issue when input field name=id\r\n\t * @returns{Proxy}\r\n\t */\r\n\tstatic #proxy(el) {\r\n\t\tif (el.tagName !== 'FORM') return el;\r\n\t\tif (!GSDOM.isHTMLElement(el.id)) return el;\r\n\t\treturn new Proxy(el, {\r\n\t\t\tget: function (target, prop, receiver) {\r\n\t\t\t\tif (prop === '_owner_') return target;\r\n\t\t\t\tif (prop === 'id') return target.getAttribute('id');\r\n\t\t\t\tconst res = Reflect.get(target, prop);\r\n\t\t\t\treturn GSFunction.isFunction(res) ? res.bind(target) : res;\r\n\t\t\t},\r\n\t\t\tset: function (target, prop, value) {\r\n\t\t\t\treturn target[prop] = value;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Match element against CSS query\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} qry \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic matches(el, qry) {\r\n\t\t// return el && qry && typeof el.matches === 'function' && el.matches(qry);\r\n\t\treturn el && typeof el.matches === 'function' && el.matches(qry);\r\n\t}\r\n\r\n\t/**\r\n\t * Set html text to provided element.\r\n\t * NOTE: Done intentionaly like this to prevent source validation warning.\r\n\t *       Use sanitizer when not any more experimental feature;\r\n\t *       Watch for default Sanitizer.getDefaultConfiguration()\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} val \r\n\t * @param {Boolean} sanitize \r\n\t * @param {Sanitizer} sanitizer \r\n\t * @returns {void}\r\n\t */\r\n\tstatic setHTML(el, val = '', sanitize = false, sanitizer) {\r\n\t\tconst isValid = el instanceof ShadowRoot || el instanceof HTMLElement || el instanceof HTMLTemplateElement;\r\n\t\tif (!isValid) return;\r\n\t\tif (sanitize && el?.setHTML) {\r\n\t\t\tsanitizer ? el.setHTML(val, { sanitizer }) : el.setHTML(val);\r\n\t\t} else {\r\n\t\t\tel.innerHTML = val instanceof Document ? val.body.innerHTML : val;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Set text to provided element\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} val \r\n\t * @returns {void}\r\n\t */\r\n\tstatic setText(el, val = '') {\r\n\t\tif (el) el.textContent = val;\r\n\t}\r\n\r\n\t/**\r\n\t * Set style to an element\r\n\t * @param {HTMLElement|string} el \r\n\t * @param {Object} obj \r\n\t */\r\n\tstatic css(el, obj) {\r\n\t\tif (GSUtil.isString(el)) el = GSDOM.queryAll(el);\r\n\t\tif (GSDOM.isHTMLElement(el)) el = [el];\r\n\t\tif (!(Array.isArray(el) && el.length > 0)) return false;\r\n\t\trequestAnimationFrame(() => {\r\n\t\t\tel.forEach(it => {\r\n\t\t\t\tObject.entries(obj).forEach(kv => {\r\n\t\t\t\t\tit.style[kv[0]] = kv[1];\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Safe way to toggle CSS class on element, multipel classes are supported in space separated string list\r\n\t * @param {HTMLElement|string} el \r\n\t * @param {*} val list of css classes in space separated string\r\n\t * @param {Boolean} sts True to add, false to remove\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic toggleClass(el, val, sts) {\r\n\t\tif (GSUtil.isString(el)) el = GSDOM.queryAll(el);\r\n\t\tif (GSDOM.isHTMLElement(el)) el = [el];\r\n\t\tif (!(Array.isArray(el) && el.length > 0)) return false;\r\n\t\tif (!val || val.trim().length == 0) return false;\r\n\t\tval = val.split(' ').filter(v => v && v.trim().length > 0);\r\n\t\tif (GSUtil.isNull(sts)) return val.forEach(v => {\r\n\t\t\tel.forEach(it => it.classList.toggle(v));\r\n\t\t});\r\n\t\tel.forEach(it => {\r\n\t\t\tsts ? it.classList.add.apply(it.classList, val) : it.classList.remove.apply(it.classList, val);\r\n\t\t});\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t * Toggle element visibility\r\n\t * @param {HTMLElement|string} el \r\n\t * @param {Boolean} sts \r\n\t */\r\n\tstatic toggle(el, sts) {\r\n\t\treturn GSDOM.toggleClass(el, 'd-none', GSUtil.isNull(sts) ? sts : !sts);\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if element contains a css class\r\n\t * @param {HTMLElement} el \r\n\t * @param {String} val \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic hasClass(el, val = '') {\r\n\t\treturn el?.classList?.contains(val);\r\n\t}\r\n\r\n\t/**\r\n\t * Alternative way to clear fields instead of form.reset()\r\n\t * @param {HTMLElement} owner \r\n\t * @param {String} qry \r\n\t */\r\n\tstatic clearInputs(owner, qry = 'input, textarea, output') {\r\n\t\tconst root = GSDOM.unwrap(owner);\r\n\t\trequestAnimationFrame(() => {\r\n\t\t\troot.querySelectorAll(qry).forEach((el) => el.value = '');\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Get proper value from element\r\n\t * @param {HTMLElement} el \r\n\t * @param {Boolean} defaults Set default value for form reset \r\n\t * @returns {String|Number}\r\n\t */\r\n\tstatic getValue(el, defaults = false) {\r\n\t\tlet val = null;\r\n\t\tswitch (el.type) {\r\n\t\t\tcase 'datetime-local':\r\n\t\t\t\tval = el.value ? el.valueAsNumber : el.value;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'number':\r\n\t\t\t\tval = el.value ? el.valueAsNumber : 0;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'select-multiple':\r\n\t\t\t\tval = Array.from(el.selectedOptions).map(o => o.value);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'checkbox':\r\n\t\t\t\tif (GSUtil.isStringNonEmpty(el.value)) {\r\n\t\t\t\t\tval = el.checked ? el.value : null;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tval = el.checked;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tval = el.value;\r\n\t\t}\r\n\r\n\t\tif (GSUtil.isNull(val) && defaults) {\r\n\t\t\tval = el.defaultValue;\r\n\t\t}\r\n\t\treturn val;\r\n\t}\r\n\r\n\t/**\r\n\t * Get value from form element\r\n\t * @param {HTMLElement} el \r\n\t * @param {Boolean} defaults Set default value for form reset \r\n\t * @returns {String}\r\n\t */\r\n\tstatic toValue(el, defaults = false) {\r\n\t\tif (!GSDOM.isHTMLElement(el)) return undefined;\r\n\t\tlet value = GSDOM.getValue(el, defaults);\r\n\t\tif ('text' === el.type) {\r\n\t\t\tconst map = GSCSSMap.styleValue(el, 'text-transform');\r\n\t\t\tif (map) value = GSUtil.textTransform(map.value, value);\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\t/**\r\n\t * Set element value, taking chekbox into consideration\r\n\t * @param {HTMLElement} el \r\n\t * @param {String|Boolean|Number} val \r\n\t * @param {Boolean} defaults Set default value for form reset\r\n\t */\r\n\tstatic fromValue(el, val, defaults = false) {\r\n\t\tif (!GSDOM.isHTMLElement(el)) return;\r\n\t\tconst data = Array.isArray(val) ? val[0] || '' : val;\r\n\r\n\t\tswitch (el.type) {\r\n\t\t\tcase 'checkbox':\r\n\t\t\t\tif (GSUtil.isStringNonEmpty(el.value)) {\r\n\t\t\t\t\tel.checked = data === el.value;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tel.checked = data == true;\r\n\t\t\t\t}\r\n\t\t\t\tif (defaults) el.defaultValue = el.checked;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tel.value = GSUtil.normalize(data);\r\n\t\t\t\tif (defaults) el.defaultValue = el.value;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Convert form elements into JSON object\r\n\t * @param {HTMLElement} owner \r\n\t * @param {String} qry \r\n\t * @param {Boolean} invalid Should include invalid fields\r\n\t * @param {Boolean} defaults Set default value for form reset\r\n\t * @returns {Object}\r\n\t */\r\n\tstatic toObject(owner, qry = 'input, textarea, select, output', invalid = true, defaults = false) {\r\n\t\tconst root = GSDOM.unwrap(owner);\r\n\t\tconst params = {};\r\n\t\tGSDOM.queryAll(root, qry)\r\n\t\t\t.filter(el => el.name)\r\n\t\t\t.filter(el => el.dataset.ignore !== 'true')\r\n\t\t\t.filter(el => invalid ? true : el.checkValidity())\r\n\t\t\t.forEach(el => GSDOM.fromElement2Object(el, params, defaults));\r\n\t\treturn params;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON Object into HTMLElements (input)\r\n\t * @param {HTMLElement} owner Root selector (form)\r\n\t * @param {Object} obj Data source key/value pairs\r\n\t * @param {String} qry Element type selector,defaults to form elements \r\n\t * @param {Boolean} defaults Set default value for form reset  \r\n\t * @returns {Object}\r\n\t */\r\n\tstatic fromObject(owner, obj, qry = 'input, textarea, select, output', defaults = false) {\r\n\t\tobj = GSUtil.toJson(obj);\r\n\t\t// if (Object.entries(obj).length === 0) return;\r\n\t\tconst root = GSDOM.unwrap(owner);\r\n\t\tconst list = GSDOM.queryAll(root, qry); // root.querySelectorAll(qry);\r\n\t\tArray.from(list).forEach(el => GSDOM.fromObject2Element(el, obj, defaults));\r\n\t\treturn obj;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON Object into HTMLElement (input)\r\n\t * @param {HTMLElement} owner Element to populate\r\n\t * @param {Object} obj Data source key/value pairs\r\n\t * @param {Boolean} defaults Set default value for form reset\r\n\t */\r\n\tstatic fromObject2Element(el, obj, defaults = false) {\r\n\t\tif (!GSData.objectPathExist(obj, el?.name)) return;\r\n\t\tconst val = GSData.readFromObject(obj, el.name);\r\n\t\tif (el.type !== 'radio') {\r\n\t\t\tGSDOM.fromValue(el, val, defaults);\r\n\t\t} else if (el.value === val) el.checked = true;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert HTMLElement (input) value to JSON Object  \r\n\t * @param {HTMLElement} owner Element value source\r\n\t * @param {Object} obj Object to populate \r\n\t * @param {Boolean} defaults Set default value for form reset\r\n\t */\r\n\tstatic fromElement2Object(el, obj, defaults = false, noEmpty = false) {\r\n\t\tif (el?.name) {\r\n\t\t\tif (noEmpty && GSUtil.isStringEmpty(el.value)) return obj;\r\n\t\t\tif (el.type !== 'radio') {\r\n\t\t\t\t//params[el.name] = GSDOM.toValue(el);\r\n\t\t\t\tGSData.writeToObject(obj, el.name, GSDOM.toValue(el, defaults));\r\n\t\t\t} else if (el.checked) {\r\n\t\t\t\t//params[el.name] = GSDOM.toValue(el);\r\n\t\t\t\tGSData.writeToObject(obj, el.name, GSDOM.toValue(el, defaults));\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconsole.warn('Skipping element, name not defined!', el);\r\n\t\t}\r\n\t\treturn obj;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert HTMLElement into a JSON object\r\n\t * @param {HTMLElement|Array} own \r\n\t * @param {Boolean} recursive \r\n\t * @param {Boolean} plain  If false, will include #tagName\r\n\t * @param {Object} definitions Json data type definitions\t\r\n\t * @returns {Object}\r\n\t */\r\n\tstatic toJson(own, recursive = true, plain = false, definitions) {\r\n\t\tif (Array.isArray(own)) return own.map(o => GSDOM.toJson(o, recursive, plain, definitions));\r\n\t\tconst obj = {};\r\n\t\tif (!GSDOM.isHTMLElement(own)) return obj;\r\n\r\n\t\tif (!plain) obj['#tagName'] = own.tagName.toLowerCase();\r\n\t\tobj['$text'] = own.innerText;\r\n\r\n\t\t//obj.dataset = Object.assign({}, own.dataset);\r\n\r\n\t\tconst props = definitions || GSDOM.allProperties(own);\r\n\t\tArray.from(own.attributes).forEach(v => {\r\n\t\t\tconst type = props[v.name]?.type;\r\n\t\t\tswitch (type) {\r\n\t\t\t\tcase Boolean:\r\n\t\t\t\t\tobj[v.name] = own.hasAttribute(v.name);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Number:\r\n\t\t\t\t\tobj[v.name] = GSAttr.getAsNum(own, v.name);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tobj[v.name] = v.value;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (recursive) {\r\n\t\t\tconst children = Array.from(own.children).map(el => GSDOM.toJson(el, recursive, plain, definitions));\r\n\t\t\tif (children.length > 0) obj.items = children;\r\n\t\t}\r\n\r\n\t\treturn obj;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON object to DOM/html\r\n\t * @param {Object} obj \r\n\t * @param {Boolean} asString As string or HTMLElement Tree \r\n\t * @param {String} tag \r\n\t */\r\n\tstatic fromJson(obj, tag = 'gs-item', asString = false) {\r\n\t\treturn asString ? GSDOM.fromJsonAsString(obj, tag) : GSDOM.fromJsonAsDOM(obj, tag);\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON object to DOM tree\r\n\t * @param {Object} obj \r\n\t * @param {String} tag \r\n\t * @returns {HTMLElement|Array}\r\n\t */\r\n\tstatic fromJsonAsDOM(obj, tag = 'gs-item') {\r\n\t\tif (!obj) return null;\r\n\r\n\t\tconst isPrimitive = GSUtil.isNumber(obj) || GSUtil.isString(obj);\r\n\t\tif (isPrimitive) return GSDOM.fromJsonAsDOM({ title: obj }, tag);\r\n\r\n\t\tconst isArray = Array.isArray(obj);\r\n\t\tif (isArray) return obj.map(o => GSDOM.fromJsonAsDOM(o, tag));\r\n\r\n\t\tconst name = obj['#tagName'] || tag;\r\n\t\tconst el = document.createElement(name);\r\n\r\n\t\tObject.keys(obj)\r\n\t\t\t.filter(v => v != 'items')\r\n\t\t\t.filter(v => v[0] != '#')\r\n\t\t\t.filter(v => v[0] != '$')\r\n\t\t\t.forEach(v => el.setAttribute(v, obj[v]));\r\n\r\n\t\tif (obj[\"#def\"]) {\r\n\t\t\tel[Symbol.for(\"#def\")] = obj[\"#def\"];\r\n\t\t}\r\n\r\n\t\tif (Array.isArray(obj.items)) {\r\n\t\t\tobj.items.forEach(o => {\r\n\t\t\t\tconst sub = GSDOM.fromJsonAsDOM(o, tag);\r\n\t\t\t\tel.appendChild(sub);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn el;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert JSON object to HTML source\r\n\t * @param {Object} obj \r\n\t * @param {String} tag \r\n\t * @returns {String}\r\n\t */\r\n\tstatic fromJsonAsString(obj, tag = 'gs-item') {\r\n\t\tif (!obj) return null;\r\n\r\n\t\tif (Array.isArray(obj)) return obj.map(o => GSDOM.fromJsonAsString(o)).join('');\r\n\r\n\t\tconst name = obj['#tagName'] || tag;\r\n\t\tconst src = [];\r\n\t\tsrc.push(`<${name} `);\r\n\r\n\t\tObject.keys(obj)\r\n\t\t\t.filter(v => v != 'items')\r\n\t\t\t.filter(v => v[0] != '#')\r\n\t\t\t.filter(v => v[0] != '$')\r\n\t\t\t.forEach(v => src.push(` ${v}=\"${obj[v]}\" `));\r\n\r\n\t\tsrc.push(`>`);\r\n\r\n\t\tif (Array.isArray(obj.items)) {\r\n\t\t\tobj.items.forEach(o => {\r\n\t\t\t\tconst sub = GSDOM.fromJsonAsString(o, tag);\r\n\t\t\t\tsrc.push(sub);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tsrc.push(`</${name}>`);\r\n\r\n\t\treturn src.join('');\r\n\t}\r\n\r\n\t/**\r\n\t * Convert URL hash key/value to form elements\r\n\t * @param {HTMLElement} owner \r\n\t */\r\n\tstatic fromURLHashToForm(owner) {\r\n\t\tlocation.hash.slice(1).split('&')\r\n\t\t\t.filter(v => v.length > 1)\r\n\t\t\t.forEach(v => {\r\n\t\t\t\tconst d = v.split('=');\r\n\t\t\t\tGSDOM.setValue(`input[name=${d[0]}]`, d[1], owner);\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Return element shadowRoot or self\r\n\t * @param {HTMLElement} owner \r\n\t * @returns {HTMLElement|shadowRoot}\r\n\t */\r\n\tstatic unwrap(owner) {\r\n\t\treturn owner ? owner.self || owner : document;\r\n\t}\r\n\r\n\t/**\r\n\t * Enable input on all input elements under provided owner\r\n\t * @param {HTMLElement} own \r\n\t * @param {String} qry Default to form\r\n\t */\r\n\tstatic enableInput(own, qry = 'input, select, textarea, .btn', all = true, group = '') {\r\n\t\tgroup = GSUtil.capitalizeAttr(group);\r\n\t\tlet list = GSDOM.queryAll(own, qry);\r\n\t\tif (!all && group) list = list.filter(el => GSUtil.asBool(el.dataset[group]))\r\n\t\tlist.forEach(el => el.removeAttribute('disabled'));\r\n\t}\r\n\r\n\t/**\r\n\t * Disable input on all input elements under provided owner\r\n\t * @param {HTMLElement} own \r\n\t * @param {String} qry Default to form\r\n\t */\r\n\tstatic disableInput(own, qry = 'input, select, textarea, .btn', all = true, group = '') {\r\n\t\tgroup = GSUtil.capitalizeAttr(group);\r\n\t\tGSDOM.queryAll(own, qry)\r\n\t\t\t.filter(el => all ? true : !el.disabled)\r\n\t\t\t.forEach(el => {\r\n\t\t\t\tel.setAttribute('disabled', '');\r\n\t\t\t\tif (group) el.dataset[group] = true;\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Set value to a element by css selector\r\n\t * @param {String} qry \r\n\t * @param {String} val \r\n\t * @param {HTMLElement} own\r\n\t * @param {Boolean} defaults Set default value for form reset \r\n\t */\r\n\tstatic setValue(qry, val, own, defaults = false) {\r\n\t\tconst el = GSDOM.queryAll(own, qry);\r\n\t\tel.forEach(it => GSDOM.fromValue(it, val, defaults));\r\n\t}\r\n\r\n\t/**\r\n\t * Find text nodes\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Array<string>}\r\n\t */\r\n\tstatic textNodesUnder(el) {\r\n\t\tconst walk = document.createTreeWalker(el || document, NodeFilter.SHOW_TEXT, null, false);\r\n\t\tconst a = [];\r\n\t\tlet n;\r\n\t\twhile (n = walk.nextNode()) a.push(n);\r\n\t\treturn a;\r\n\t}\r\n\r\n\t/**\r\n\t * Remove invalid text characters from html element nodes\r\n\t * @param {HTMLElement} root \r\n\t */\r\n\tstatic cleanHTML(root) {\r\n\t\tconst ts = GSDOM.textNodesUnder(root || document).filter(t => t.wholeText.trim().length === 0);\r\n\t\tts.filter(el => el.nextSibling instanceof Text).forEach(el => el.remove());\r\n\t\tts.forEach(t => t.nodeValue = t.wholeText.replaceAll(/\\u0020{4}/g, '\\t').replaceAll(GSDOM.#CLEANUP1, ''));\r\n\t}\r\n\r\n\t/**\r\n\t * Validate against provided list, if child elements allowed inside provided element\r\n\t * @param {HTMLElement} el Element which child list to validate\r\n\t * @param {String} tagName Expected owner element tag name\r\n\t * @param {String} whiteList Uppercase list of tag names allowed as child\r\n\t * @param {String} slotList List of named slots allowed\r\n\t * @param {Boolean} asState return state as bool or throw an error (default)\r\n\t * @returns {Boolean} return true if validation is ok.\r\n\t * @throws {Error}\r\n\t */\r\n\tstatic validate(own, tagName, whiteList, asState = false) {\r\n\t\tif (own.tagName !== tagName) {\r\n\t\t\tif (asState) return false;\r\n\t\t\tthrow new Error(`Owner element : ${own.tagName}, id:${own.id} is not of excpected type: ${tagName}`);\r\n\t\t}\r\n\t\tconst ok = GSDOM.isAllowed(Array.from(own.childNodes), whiteList);\r\n\t\tif (ok) return true;\r\n\t\tif (asState) return false;\r\n\t\tconst msg = GSDOM.toValidationError(own, whiteList);\r\n\t\tthrow new Error(msg);\r\n\t}\r\n\r\n\t/**\r\n\t * Check against provided list, if child elements allowed inside provided element\r\n\t * @param {HTMLElement|Array<HTMLElement>} el Element which childs to validate against provided list\r\n\t * @param {String} whiteList Uppercase list of tag names allowed as child nodes\r\n\t * @param {String} slotList List of elements with named  slots allowed\r\n\t * @returns {Boolean} return tr ue if validation is ok.\r\n\t */\r\n\tstatic isAllowed(el, whiteList) {\r\n\t\tif (Array.isArray(el)) return el.filter(el => GSDOM.isAllowed(el, whiteList)).length === 0;\r\n\t\tconst allowElement = !(el instanceof Text || el instanceof Comment);\r\n\t\tconst allowTag = !whiteList.includes(el.tagName);\r\n\t\treturn allowElement && allowTag;\r\n\t}\r\n\r\n\tstatic toValidationError(own, whiteList) {\r\n\t\tconst list = `<${whiteList.join('>, <')}>`;\r\n\t\treturn `${own.tagName} ID: ${own.id} allows as a child nodes only : ${list}!`;\r\n\t}\r\n\r\n\t/**\r\n\t * Inject css directly into a shadowRoot of an element\r\n\t * \r\n\t * @async\r\n\t * @param {HTMLElement} own \r\n\t * @param {String} url \r\n\t * @returns {Promise<boolean>}\r\n\t */\r\n\tstatic async injectCSS(own, url) {\r\n\t\tif (!own?.shadowRoot instanceof ShadowRoot) return false;\r\n\t\tlet sts = true;\r\n\t\ttry {\r\n\t\t\tconst res = await fetch(url);\r\n\t\t\tif (!res.ok) return;\r\n\t\t\tconst css = await res.text();\r\n\t\t\tconst sheet = new CSSStyleSheet();\r\n\t\t\tsheet.replaceSync(css);\r\n\t\t\town.shadowRoot.adoptedStyleSheets = [sheet];\r\n\t\t} catch (e) {\r\n\t\t\tGSLog.error(null, e);\r\n\t\t\tsts = false;\r\n\t\t}\r\n\t\treturn sts;\r\n\t}\r\n\r\n\t/**\r\n\t * Reset form element\r\n\t * @param {*} element \r\n\t * @returns \r\n\t */\r\n\tstatic reset(element) {\r\n\t\tif (GSDOM.isFormElement(element)) {\r\n\t\t\tif (!GSDOM.resetSelect(element)) {\r\n\t\t\t\telement.dataset.typed = false;\r\n\t\t\t\telement.value = element.defaultValue;\r\n\t\t\t\tGSDOM.#dispatch(element);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Reset select element to default value\r\n\t * @param {HTMLSelectElement} element \r\n\t */\r\n\tstatic resetSelect(element) {\r\n\t\tif (GSDOM.isSelect(element)) {\r\n\t\t\tArray.from(element.options).forEach(el => el.selected = el.hasAttribute('selected'));\r\n\t\t\tGSDOM.#dispatch(element);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic #dispatch(element) {\r\n\t\telement.dispatchEvent(new Event('change', { bubbles: true, composed: true }));\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Extract and merge all static properties definition from WebComponent instance\r\n\t * @param {GSElement} obj \r\n\t * @returns {Object}\r\n\t */\r\n\tstatic allProperties(obj) {\r\n\t\tconst list = [...GSDOM.inheritance(obj)].map(o => o.properties).filter(o => o);\r\n\t\tlist.push(obj.constructor?.properties || obj.properties);\r\n\t\treturn GSData.mergeObjects(list);\r\n\t}\r\n\r\n\t/**\r\n\t * Return element template ref\r\n\t * @param {GSElement} host \r\n\t * @returns \r\n\t */\r\n\tstatic templateRef(host) {\r\n\t\tif (!host) return;\r\n\t\tif (host.tagName === 'GS-TEMPLATE') return host.src;\r\n\t\treturn host.template || host.query?.('template', false);\r\n\t}\r\n\r\n\tstatic #globalDispatch(name, opt) {\r\n\t\tqueueMicrotask(() => {\r\n\t\t\tglobalThis.dispatchEvent?.(new CustomEvent(name, opt));\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Register class as WebComponent to the browser\r\n\t * @param {String} name \r\n\t * @param {class} clazz Optional, if not set, use self\r\n\t * @param {Object} opt Options, used only when extending non HTMLElement class  \r\n\t */\r\n\tstatic define(name, clazz, opt) {\r\n\t\tif (!customElements.get(name)) {\r\n\t\t\tcustomElements.define(name, clazz, opt);\r\n\t\t\tGSDOM.#globalDispatch(name, { detail: { customElements: true } });\r\n\t\t}\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.seal(GSDOM);\r\n\t\tglobalThis.GSDOM = GSDOM;\r\n\t\tGSDOM.#globalDispatch('gs-base-ready', {\r\n\t\t\tdetail: {\r\n\t\t\t\tmessage: 'GS Base is ready',\r\n\t\t\t\ttime: new Date(),\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSEvents class\r\n * @module base/GSEvents\r\n */\r\n\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSID } from \"./GSID.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSLog } from \"./GSLog.mjs\";\r\n\r\n/**\r\n * Class for handling events, also a registry of all GS-* element listeners\r\n * @Class\r\n */\r\nexport class GSEvents {\r\n\r\n\tstatic #rid = 0;\r\n\tstatic #protect = false;\r\n\tstatic #cache = new Map();\r\n\r\n\tstatic #loaded = false;\r\n\tstatic #suspended = 0; // Corrected typo\r\n\r\n\tget altContext() {\r\n\t\treturn GSEvents.#protect;\r\n\t}\r\n\r\n\tset altContext(val) {\r\n\t\tGSEvents.#protect = GSUtil.asBool(val, true);\r\n\t}\r\n\r\n\t/**\r\n\t * Disable browser console and default context menu\r\n\t */\r\n\tstatic protect() {\r\n\t\tGSEvents.listen(globalThis, null, 'contextmenu', GSEvents.#onContext);\r\n\t\tGSEvents.listen(globalThis.document, null, 'keydown', GSEvents.#onKeyDown);\r\n\t}\r\n\r\n\tstatic #onContext(event) {\r\n\t\tif (GSEvents.#protect || !event.shiftKey) GSEvents.prevent(event);\r\n\t}\r\n\r\n\tstatic #onKeyDown(event) {\r\n\t\tconst code = event.code;\r\n\t\tif (code == 'F12') { // Prevent F12\r\n\t\t\treturn false;\r\n\t\t} else if (event.ctrlKey && event.shiftKey && code == 'KeyI') { // Prevent Ctrl+Shift+I\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Wait for web page to completely load, then send event to target element\r\n\t * DOMContentLoaded vs load ?!\r\n\t * @async\r\n\t * @param {HTMLElement} target \r\n\t * @param {String} name \r\n\t * @param {function} callback \r\n\t * @param {Promise<number>} timeout \r\n\t */\r\n\tstatic async waitPageLoad(target, name = 'loaded', callback, timeout = 0, prevent = true) {\r\n\t\tif (!GSEvents.#loaded) {\r\n\t\t\ttry {\r\n\t\t\t\tawait GSEvents.wait(globalThis.window, 'load', timeout, prevent);\r\n\t\t\t\tGSEvents.#loaded = true;\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error('Error waiting for page load:', e); // Improved error handling\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (GSEvents.#loaded) {\r\n\t\t\tawait GSFunction.callFunction(callback);\r\n\t\t\tGSEvents.sendSuspended(target, name);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Async version of event listener\r\n\t * \r\n\t * @async\r\n\t * @param {HTMLElement} own \r\n\t * @param {String} name \r\n\t * @param {Number} timeout  \r\n\t * @param {Boolean} prevent \r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic wait(own, name = '', timeout = 0, prevent = true) {\r\n\t\tif (GSUtil.isStringEmpty(name)) throw new Error('Event undefined!');\r\n\t\tif (!GSUtil.isNumber(timeout)) throw new Error('Invalid timeout value!');\r\n\t\tif (timeout > 0) return GSEvents.once(own, null, name, null, timeout);\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tGSEvents.once(own, null, name, e => {\r\n\t\t\t\tif (prevent) GSEvents.prevent(e);\r\n\t\t\t\tresolve(e);\r\n\t\t\t}, timeout);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Async version of animation frame\r\n\t * \r\n\t * @async\r\n\t * @param {function} callback \r\n\t * @param {Boolean} chaind Prevent consequtive chained calls.\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic async waitAnimationFrame(callback, chained = false) {\r\n\r\n\t\tif (chained) {\r\n\t\t\tif (typeof callback !== 'function') return;\r\n\t\t\tif (GSEvents.#suspended > 0) return GSFunction.callFunction(callback);\r\n\t\t\tGSEvents.#suspended++;\r\n\t\t}\r\n\r\n\t\treturn new Promise((accept, reject) => {\r\n\t\t\trequestAnimationFrame(async () => {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst o = await GSFunction.callFunction(callback);\r\n\t\t\t\t\taccept(o);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\treject(e);\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tif (chained && GSEvents.#suspended > 0) GSEvents.#suspended--;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Listen for an event on a given element or query\r\n\t * @param {*} own \r\n\t * @param {*} qry \r\n\t * @param {*} event \r\n\t * @param {*} callback \r\n\t * @param {*} opt \r\n\t * @returns {boolean|Array<boolean>} \r\n\t */\r\n\tstatic listen(own, qry, event, callback, opt = false) {\r\n\t\tif (!qry && own) return own.addEventListener(event, callback, opt);\r\n\t\treturn GSDOM.queryAll(own, qry).map(el => el.addEventListener(event, callback, opt));\r\n\t}\r\n\r\n\t/**\r\n\t * Unlisten for an event on a given element or query\r\n\t * @param {*} own \r\n\t * @param {*} qry \r\n\t * @param {*} event \r\n\t * @param {*} callback \r\n\t * @returns {boolean|Array<boolean>} \r\n\t */\r\n\tstatic unlisten(own, qry, event, callback) {\r\n\t\tif (!qry && own) return own.removeEventListener(event, callback);\r\n\t\treturn GSDOM.queryAll(own, qry).map(el => el.removeEventListener(event, callback));\r\n\t}\r\n\r\n\tstatic on = GSEvents.listen;\r\n\tstatic off = GSEvents.unlisten;\r\n\r\n\t/**\r\n\t * Wait for an event. Also, trigger on timeout if event not triggered.\r\n\t * @param {HTMLElement} own \r\n\t * @param {String} qry Optional selector within owner\r\n\t * @param {String} event Event name to wait for\r\n\t * @param {*} callback Function to call \r\n\t * @param {Number | AbortSignal} timeout If GT 0, retrun Promise\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic once(own, qry, event, callback, timeout = 0) {\r\n\t\tconst signal = GSEvents.#toSignal(timeout);\r\n\t\tif (signal && signal.internal) {\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tGSEvents.listen(own, qry, event, evt => {\r\n\t\t\t\t\tsignal.removeEventListener('abort', reject);\r\n\t\t\t\t\tcallback?.(evt);\r\n\t\t\t\t\tresolve(evt);\r\n\t\t\t\t}, { once: true, signal: signal });\r\n\t\t\t\tsignal.addEventListener('abort', reject);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn GSEvents.listen(own, qry, event, callback, { once: true, signal: signal });\r\n\t}\r\n\r\n\t/**\r\n\t * Generic prevent event\r\n\t *  default - prevent system default event handling\r\n\t *  propagation - prevent all bubbling\r\n\t *  immedate - prevent all bubbling + this element \r\n\t * \r\n\t * @param {Event} e \r\n\t */\r\n\tstatic prevent(e, defaults = true, propagate = true, immediate = true) {\r\n\t\tif (e) {\r\n\t\t\tif (defaults) e.preventDefault?.();\r\n\t\t\tif (propagate) e.stopPropagation?.();\r\n\t\t\tif (immediate) e.stopImmediatePropagation?.();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Generic event disaptcher.\r\n\t * NOTE: If expecting to catch return value, do not use async in listeners\r\n\t * \r\n\t * @param {HTMLElement} sender element that send event\r\n\t * @param {String} name  Event name to trigger \r\n\t * @param {Object} obj Data object to send \r\n\t * @param {Boolean} bubbles Send event to parent\r\n\t * @param {Boolean} composed Send event across shadowDom\r\n\t * @param {Boolean} cancelable Event is cancelable\r\n\t * @returns {Boolean} false if event is cancelable, and at least one of the event handlers which received event called Event.preventDefault(). Otherwise true.\r\n\t */\r\n\tstatic send(sender = document, name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n\t\tif (!GSUtil.isString(name) || name.length === 0) return false;\r\n\t\tconst opt = { detail: obj, bubbles: bubbles, composed: composed, cancelable: cancelable };\r\n\t\tconst event = new CustomEvent(name, opt);\r\n\t\treturn sender?.dispatchEvent(event);\r\n\t}\r\n\r\n\t/**\r\n\t * Convert event type to native event\r\n\t * @param {String} type \r\n\t * @param {Object} opt \r\n\t * @returns {Event}\r\n\t */\r\n\tstatic toEvent(type, opt) {\r\n\t\tlet evt = null;\r\n\t\tswitch (type) {\r\n\t\t\tcase 'copy':\r\n\t\t\tcase 'cut':\r\n\t\t\tcase 'paste':\r\n\t\t\t\tevt = new ClipboardEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'blur':\r\n\t\t\tcase 'focus':\r\n\t\t\tcase 'focusin':\r\n\t\t\tcase 'focusout':\r\n\t\t\t\tevt = new FocusEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'input':\r\n\t\t\tcase 'beforeinput':\r\n\t\t\t\tevt = new InputEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'keydown':\r\n\t\t\tcase 'keyup':\r\n\t\t\tcase 'keypress':\r\n\t\t\t\tevt = new KeyboardEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'dblclick':\r\n\t\t\tcase 'mousedown':\r\n\t\t\tcase 'mouseenter':\r\n\t\t\tcase 'mouseleave':\r\n\t\t\tcase 'mousemove':\r\n\t\t\tcase 'mouseout':\r\n\t\t\tcase 'mouseover':\r\n\t\t\tcase 'mouseup':\r\n\t\t\t\tevt = new MouseEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'submit':\r\n\t\t\t\tevt = new SubmitEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'touchstart':\r\n\t\t\tcase 'touchend':\r\n\t\t\tcase 'touchmove':\r\n\t\t\tcase 'touchcancel':\r\n\t\t\t\tevt = new TouchEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'whell':\r\n\t\t\t\tevt = new WheelEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'pointerover':\r\n\t\t\tcase 'pointerenter':\r\n\t\t\tcase 'pointerdown':\r\n\t\t\tcase 'pointermove':\r\n\t\t\tcase 'pointerup':\r\n\t\t\tcase 'pointercancel':\r\n\t\t\tcase 'pointerout':\r\n\t\t\tcase 'pointerleave':\r\n\t\t\tcase 'pointerrawupdate':\r\n\t\t\tcase 'gotpointercapture':\r\n\t\t\tcase 'lostpointercapture':\r\n\t\t\t\tevt = new PointerEvent(type, opt);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tevt = new CustomEvent(type, opt);\r\n\t\t}\r\n\t\treturn evt;\r\n\t}\r\n\r\n\t/**\r\n\t * Helper to fix some Firefox issues, detect event\r\n\t * @param {Event} e \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isMouseOrPointerEvent(e) {\r\n\t\treturn e instanceof MouseEvent || e instanceof PointerEvent;\r\n\t}\r\n\r\n\t/** \r\n\t * Generic event disaptcher in suspended rendering\r\n\t * \r\n\t * @param {HTMLElement} sender element that send event\r\n\t * @param {String} name  Event name to trigger\r\n\t * @param {Object} obj Data object to send \r\n\t * @param {Boolean} bubbles Send event to parent\r\n\t * @param {Boolean} composed Send event across shadowDom\r\n\t * @param {Boolean} cancelable Event is cancelable\r\n\t * @returns {void} \r\n\t */\r\n\tstatic sendSuspended(sender = document, name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n\t\treturn requestAnimationFrame(() => {\r\n\t\t\tGSEvents.send(sender, name, obj, bubbles, composed, cancelable);\r\n\t\t});\r\n\t}\r\n\r\n\t/** \r\n\t * Generic event disaptcher delayed in miliseconds\r\n\t * \r\n\t * @param {Number} timeout Time to delay event\r\n\t * @param {HTMLElement} sender element that send event\r\n\t * @param {String} name  Event name to trigger\r\n\t * @param {Object} obj Data object to send \r\n\t * @param {Boolean} bubbles Send event to parent\r\n\t * @param {Boolean} composed Send event across shadowDom\r\n\t * @param {Boolean} cancelable Event is cancelable\r\n\t * @returns {Number} setTimeout id for cancelation\r\n\t */\r\n\tstatic sendDelayed(timeout = 1, sender = document, name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n\t\treturn setTimeout(() => GSEvents.send(sender, name, obj, bubbles, composed, cancelable), timeout);\r\n\t}\r\n\r\n\t/**\r\n\t* Generic event listener appender\r\n\t * @param {HTMLElement} own Event owner (used to store event handler for later release by element destruction )\r\n\t * @param {HTMLElement} el Owner element to monitor\r\n\t * @param {String} name Event name to monitor\r\n\t * @param {Function} fn Callback to trigger on event\r\n\t * @param {Boolean} once Monitor event only once\r\n\t * @param {Boolean} capture Allow event capture\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic attach(own, el, name = '', fn, once = false, capture = false) {\r\n\t\tif (!el) return false;\r\n\t\tif (!(window instanceof Window || el.isConnected)) return false;\r\n\t\tif (!GSFunction.isFunction(fn)) return false;\r\n\t\tif (!GSFunction.hasFunction(el, 'addEventListener')) return false;\r\n\t\tconst me = this;\r\n\t\tconst obj = me.#eventKey(own, el, name, fn);\r\n\t\tconst elmap = me.#getElementMap(own);\r\n\t\tconst map = me.#eventMap(elmap, obj.key);\r\n\t\tmap.set(obj.fnkey, obj);\r\n\t\tobj.capture = capture;\r\n\t\tif (once) {\r\n\t\t\tobj.once = (e) => {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tobj.fn(e);\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tme.remove(obj.own, obj.el, obj.name, obj.once);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tObject.defineProperty(obj.once, 'gsid', { value: fn.gsid, writable: false });\r\n\t\t}\r\n\t\tel.addEventListener(name, once ? obj.once : obj.fn, { once: once, capture: capture });\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t* Generic event listener remover\r\n\t * @param {HTMLElement} own Event owner\r\n\t * @param {HTMLElement} el Owner element to monitor\r\n\t * @param {String} name Event name to moinitor\r\n\t * @param {Function} fn Callback to trigger on event\r\n\t */\r\n\tstatic remove(own, el, name = '', fn) {\r\n\t\tconst me = this;\r\n\t\tconst obj = me.#eventKey(own, el, name, fn);\r\n\t\tconst elmap = me.#getElementMap(own);\r\n\t\tconst map = me.#eventMap(elmap, obj.key);\r\n\t\tconst cfg = map.get(obj.fnkey);\r\n\t\tif (cfg) {\r\n\t\t\tmap.delete(cfg.fnkey);\r\n\t\t\tme.#removeListener(cfg);\r\n\t\t} else if (obj.fnkey === obj.key) {\r\n\t\t\tfor (let m of map.values()) {\r\n\t\t\t\tmap.delete(m.fnkey);\r\n\t\t\t\tme.#removeListener(m);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (map.size === 0) elmap.delete(obj.key);\r\n\t\tif (elmap.size === 0) me.#cache.delete(own);\r\n\t}\r\n\r\n\t/**\r\n\t * Release internal engine event listeners\r\n\t * @param {HTMLElement} own Event owner\r\n\t */\r\n\tstatic detachListeners(own) {\r\n\t\tconst me = this;\r\n\t\tconst map = me.#removeElementMap(own);\r\n\t\tif (!map) return;\r\n\r\n\t\tconst it = map.values();\r\n\t\tfor (let m of it) {\r\n\t\t\tfor (let o of m.values()) {\r\n\t\t\t\tme.#removeListener(o);\r\n\t\t\t}\r\n\t\t\tm.clear();\r\n\t\t}\r\n\t\tmap.clear();\r\n\t}\r\n\r\n\t/**\r\n\t * Generate an event key object\r\n\t * @param {*} el \r\n\t * @param {*} name \r\n\t * @param {*} fn \r\n\t * @returns {Object}\r\n\t */\r\n\tstatic #eventKey(own, el, name = '', fn = '') {\r\n\t\tif (!el) return false;\r\n\t\tconst me = this;\r\n\t\tconst elid = me.#getElementID(el);\r\n\t\tconst fnid = me.#getCallbackID(fn);\r\n\t\tconst key = GSID.hashCode(`${elid}${name}`);\r\n\t\tconst fnkey = GSID.hashCode(`${elid}${name}${fnid || ''}`);\r\n\t\treturn { own: own, fn: fn, el: el, name: name, key: key, fnkey: fnkey };\r\n\t}\r\n\r\n\t/**\r\n\t * Get or create a map holding an event map\r\n\t * @param {Map<HTMLElement, Object>} elmap\r\n\t * @param {HTMLElement} key\r\n\t * @returns {Map<HTMLElement, Object>}\r\n\t */\r\n\tstatic #eventMap(elmap, key) {\r\n\t\tconst me = this;\r\n\t\tlet map = elmap.get(key);\r\n\t\tif (!map) {\r\n\t\t\tmap = new Map();\r\n\t\t\telmap.set(key, map);\r\n\t\t}\r\n\t\treturn map;\r\n\t}\r\n\r\n\tstatic #getCallbackID(fn) {\r\n\t\tif (!GSFunction.isFunction(fn)) return null;\r\n\t\tif (!fn.gsid) Object.defineProperty(fn, 'gsid', { value: GSID.next(), writable: false });\r\n\t\treturn fn.gsid;\r\n\t}\r\n\r\n\tstatic #getElementID(el) {\r\n\t\tlet elid = el[Symbol.for('gs-event-id')];\r\n\t\tif (!elid) {\r\n\t\t\telid = GSID.id;\r\n\t\t\tel[Symbol.for('gs-event-id')] = elid;\r\n\t\t}\r\n\t\treturn elid;\r\n\t}\r\n\r\n\t/**\r\n\t * Get or create a map holding an event map\r\n\t * @param {HTMLElement} own\r\n\t * @returns {Map<HTMLElement, Object>}\r\n\t */\r\n\tstatic #getElementMap(own) {\r\n\t\tconst me = this;\r\n\t\treturn me.#eventMap(me.#cache, own);\r\n\t}\r\n\r\n\tstatic #removeElementMap(own) {\r\n\t\tconst me = this;\r\n\t\tconst map = me.#cache.get(own);\r\n\t\tif (!map) return;\r\n\t\tme.#cache.delete(own);\r\n\t\treturn map;\r\n\t}\r\n\r\n\tstatic #removeListener(o) {\r\n\t\to.el.removeEventListener(o.name, o.once ? o.once : o.fn, { capture: o.capture });\r\n\t\to.el = null;\r\n\t\to.fn = null;\r\n\t\to.once = null;\r\n\t}\r\n\r\n\t/**\r\n\t * Internal helper, converter to Abortignal\r\n\t * @param {*} timeout \r\n\t */\r\n\tstatic #toSignal(timeout = 0) {\r\n\t\tif (GSUtil.isNumber(timeout) && timeout > 0) {\r\n\t\t\ttimeout = AbortSignal.timeout(timeout);\r\n\t\t\ttimeout.internal = true;\r\n\t\t\treturn timeout;\r\n\t\t}\r\n\t\tif (timeout instanceof AbortSignal) return timeout;\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\t/**\r\n\t * Monitor GSElement 'action' events and trigger class functions if available.\r\n\t * @param {HTMLElement} owner \r\n\t * @param {String} type \r\n\t */\r\n\tstatic monitorAction(owner, type) {\r\n\t\towner.on('action', (e) => {\r\n\t\t\tconst me = owner;\r\n\t\t\tconst data = e.detail;\r\n\t\t\tconst action = GSUtil.isString(data) ? data : data.action || data.data?.action;\r\n\t\t\tGSEvents.onAction(me, action, type, e);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Trigger class function defined in 'action' attribute\r\n\t * @param {HTMLElement} owner \r\n\t * @param {String} action \r\n\t * @param {String} prefix \r\n\t * @param {Event} evt \r\n\t * @returns {*} Action result or false\r\n\t */\r\n\tstatic async onAction(owner, action, prefix, evt) {\r\n\r\n\t\tconst callback = GSEvents.findAction(owner, action, prefix);\r\n\t\tif (!callback) return;\r\n\r\n\t\tGSEvents.prevent(evt);\r\n\t\tlet sts = false;\r\n\t\ttry {\r\n\t\t\tif (GSFunction.isFunctionAsync(callback)) {\r\n\t\t\t\tsts = await callback(evt);\r\n\t\t\t} else {\r\n\t\t\t\tsts = callback(evt);\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tsts = e;\r\n\t\t\tif (!GSFunction.isFunction(owner.onError)) throw e;\r\n\t\t\towner.onError(e);\r\n\t\t}\r\n\t\treturn sts;\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Find object instance action by name\r\n\t * @param {Object} owner \r\n\t * @param {String} action \r\n\t * @returns {Function}\r\n\t */\r\n\tstatic findAction(owner, action = '', prefix = '') {\r\n\t\tlet sts = false;\r\n\t\tif (!action) return sts;\r\n\t\tconst me = owner;\r\n\t\taction = GSUtil.capitalizeAttr(GSUtil.capitalize(action));\r\n\t\tprefix = GSUtil.capitalizeAttr(GSUtil.capitalize(prefix));\r\n\t\tconst name = `on${prefix}${action}`;\r\n\t\tif (globalThis.GS_LOG_ACTION) GSLog.warn(owner, `Action : ${name}`);\r\n\t\tconst fn = me[name];\r\n\t\tsts = GSFunction.isFunction(fn);\r\n\t\tsts = sts && !GSFunction.isFunctionNative(fn);\r\n\t\treturn sts ? me[name].bind(me) : null\r\n\t}\r\n\r\n\tstatic #onResize() {\r\n\t\tclearTimeout(GSEvents.#rid);\t\t\t\r\n\t\tGSEvents.#rid = setTimeout(async () => {\r\n\t\t\tawait GSEvents.waitAnimationFrame();\r\n\t\t\tGSEvents.send(window, 'resized');\r\n\t\t}, 100);\r\n\t}\r\n\r\n\t/**\r\n\t * Helper tool to notify when window resized. \r\n\t * Can be activated only once.\r\n\t * Trigger 'resized' event on window on resize timeout.\r\n\t */\r\n\tstatic resizeMonitor() {\r\n\t\tconst me = GSEvents;\r\n\t\tconst own = document.documentElement;\r\n\t\tconst obj = me.#eventKey(own, window, 'resize', me.#onResize);\r\n\t\tconst elmap = me.#getElementMap(own);\r\n\t\tconst def = elmap.get(obj.key)?.get(obj.fnkey);\r\n\t\tif (!def) me.attach(own, window, 'resize', me.#onResize);\r\n\t}\r\n\r\n\tstatic {\r\n\t\t//GSEvents.resizeMonitor();\r\n\t\tObject.freeze(GSEvents);\r\n\t\tglobalThis.GSEvents = GSEvents;\r\n\t\tGSEvents.waitPageLoad();\r\n\t}\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\nimport { GSEvents } from \"./GSEvents.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n\r\n/**\r\n * A module loading GSAbortController class\r\n * @module base/GSAbortController\r\n */\r\n\r\n/**\r\n * Extend native AbortController with timeout \r\n * @class\r\n */\r\nexport class GSAbortController extends AbortController {\r\n\r\n    #iid = 0;\r\n\r\n    constructor(timeout = 0) {\r\n        super();\r\n        if (!GSUtil.isNumber(timeout)) throw new Error('Timeout parameter must be number');\r\n        const me = this;\r\n        if (timeout) me.#iid = setTimeout(me.abort.bind(me), timeout);\r\n        me.signal.addEventListener('abort', () => clearInterval(me.#iid));\r\n    }\r\n\r\n    wait(timeout = 0) {\r\n        return GSEvents.wait(this.signal, 'abort', timeout);\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSLog } from \"./GSLog.mjs\";\r\n\r\n/**\r\n * A module loading GSDOMObserver class\r\n * @module base/GSDOMObserver\r\n */\r\n\r\n/**\r\n * Generic HTMLElement node add/remove from DOM tree.\r\n * This Class accepts filter/callback function registration\r\n * as creation of independent observers for each Shadow DOM.\r\n * NOTE: Shadow dom must have independent observers!!!\r\n * Mostly used for dynamic attaching events to the elements not extended with is=\"gs-*\"\r\n * @class\r\n * @extends MutationObserver\r\n */\r\nexport class GSDOMObserver extends MutationObserver {\r\n\r\n    static #filtersAdd = new Map();\r\n    static #filtersDel = new Map();\r\n\r\n    /**\r\n     * Observe element for insertion / deletion\r\n     * @param {HTMLElement} el A HTMLElement instance to observe for child changes\r\n     * @param {Object} opt A JSON configuration object\r\n     * @returns {Boolean} A status of successful observer registration\r\n     */\r\n    observe(el, opt) {\r\n        const cfg = opt || { childList: true, subtree: true };\r\n        return super.observe(el, cfg);\r\n    }\r\n\r\n    /**\r\n     * Create a new observer instance for given root element\r\n     * @param {HTMLElement} el An element to monitor for changes \r\n     * @param {Object} opt A JSON configuration object\r\n     * @returns {GSDOMObserver}\r\n     */\r\n    static create(el, opt) {\r\n        const observer = new GSDOMObserver(GSDOMObserver.#onObserve);\r\n        observer.observe(el, opt);\r\n        return observer;\r\n    }\r\n\r\n    /**\r\n     * Get add or remove filter\r\n     * @param {Boolean} forRemove If \"true\", return injection filter functions, else removal functions\r\n     * @returns {Map<Function, Function>} Returns map of filter functions\r\n     */\r\n    static #getFilter(forRemove = false) {\r\n        return forRemove ? GSDOMObserver.#filtersDel : GSDOMObserver.#filtersAdd;\r\n    }\r\n\r\n    /**\r\n     * Is there any filter registered\r\n     */\r\n    static get #hasFilters() {\r\n        return GSDOMObserver.#hasFiltersAdd || GSDOMObserver.#hasFiltersDel;\r\n    }\r\n\r\n    static get #hasFiltersAdd() {\r\n        return GSDOMObserver.#filtersAdd.size > 0;\r\n    }\r\n\r\n    static get #hasFiltersDel() {\r\n        return GSDOMObserver.#filtersDel.size > 0;\r\n    }\r\n\r\n    /**\r\n     * Observer callback to filter elements\r\n     * @param {*} mutations \r\n     */\r\n    static #onObserve(mutations) {\r\n        if (!GSDOMObserver.#hasFilters) return;\r\n        mutations.forEach((mutation) => {\r\n            if (GSDOMObserver.#hasFiltersAdd) mutation.addedNodes.forEach(el => GSDOMObserver.#walk(el, GSDOMObserver.#filtersAdd));\r\n            if (GSDOMObserver.#hasFiltersDel) mutation.removedNodes.forEach(el => GSDOMObserver.#walk(el, GSDOMObserver.#filtersDel));\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Walk node tree\r\n     * @param {HTMLElement} rootEL node root\r\n     * @param {Map} filters\r\n     * @returns {Boolean} \r\n     */\r\n    static #walk(rootEL, filters) {\r\n        if (filters.size === 0) return false;\r\n        GSDOMObserver.#parse(rootEL, filters);\r\n        rootEL.childNodes.forEach(el => GSDOMObserver.#walk(el, filters));\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Call filter and callback function if node accepted\r\n     * @param {HTMLElement} el node root\r\n     * @param {Map} filters\r\n     * @returns {void}\r\n     */\r\n    static #parse(el, filters) {\r\n        filters.forEach((v, k) => {\r\n            try {\r\n                if (k(el)) v(el);\r\n            } catch (e) {\r\n                GSLog.error(null, e);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Execute observer logic \r\n     * \r\n     * @param {HTMLElement} el node root\r\n     * @param {Function} filter function to filter nodes\r\n     * @param {Function} callback function to be called on selected node\r\n     * \r\n     * @returns {Boolean}\r\n     */\r\n    static #exec(el, filter, callback) {\r\n        if (el instanceof HTMLElement == false) return false;\r\n        const tmp = new Map();\r\n        tmp.set(filter, callback);\r\n        return GSDOMObserver.#walk(el, tmp);\r\n    }\r\n\r\n    /**\r\n     * Check if parameter is function\r\n     * @param {function} fn \r\n     * @returns {Boolean} true if parameter is function type\r\n     */\r\n    static #isFunction(fn) {\r\n        return typeof fn === 'function';\r\n    }\r\n\r\n    /**\r\n     * Check if registration functions are valid\r\n     * @param {Function} filter function to filter nodes\r\n     * @param {Function} callback function to be called on selected node\r\n     * @returns {Boolean}\r\n     */\r\n    static #isFunctions(filter, callback) {\r\n        return GSDOMObserver.#isFunction(filter) && GSDOMObserver.#isFunction(callback);\r\n    }\r\n\r\n    /**\r\n     * Register element filter\r\n     * \r\n     * @param {Function} filter - filter function returns true\r\n     * @param {Function} callback - result function\r\n     * @param {Boolean} forRemove - call on node remove or add\r\n     * @param {HTMLElement} target - element to monitor\r\n     * @returns {Boolean} Returns true if filter registered\r\n     */\r\n    static registerFilter(filter, callback, forRemove = false, target) {\r\n\r\n        if (!GSDOMObserver.#isFunctions(filter, callback)) return false;\r\n\r\n        GSDOMObserver.#getFilter(forRemove).set(filter, callback);\r\n\r\n        // initially loaded does not trigger \r\n        if (!forRemove) GSDOMObserver.#exec(target || document.body, filter, callback);\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Unregister element filter\r\n     * \r\n     * @param {Function} fn Filter function\r\n     * @param {Boolean} forRemove Call on node remove or add\r\n     * \r\n     * @returns {Boolean} Returns true if unregistered\r\n     */\r\n    static unregisterFilter(fn, forRemove = false) {\r\n        return GSDOMObserver.#isFunction(fn) ? GSDOMObserver.#getFilter(forRemove).delete(fn) : false;\r\n    }\r\n\r\n    /**\r\n     * Static constructor with default body monitoring\r\n     */\r\n    static {\r\n        Object.freeze(GSDOMObserver);\r\n        globalThis.GSDOMObserver = GSDOMObserver;\r\n        GSDOMObserver.create(document.documentElement);\r\n    }\r\n\r\n}\r\n\r\n\r\n/*\r\nGSDOMObserver.registerFilter((el)=>{ return el.tagName ==='DIV'}, (el) => {\r\n    console.log(el);\r\n});\r\n*/\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSID } from \"./GSID.mjs\";\r\n\r\n/**\r\n * A dynamic CSSStyleSheet used for dynamic programmable changed\r\n * css classes attached to a WebComponent html template elements.\r\n * Programmatically changing dynamic class elements will not reflect \r\n * element style properties.\r\n */\r\nexport class GSDynamicStyle extends CSSStyleSheet {\r\n\r\n    /**\r\n     * Constructor for DynamicStlye\r\n     * @param {String} id Unique name for easier filtering  \r\n     */\r\n    constructor(id = 'dynamic') {\r\n        super();\r\n        this.id = id || GSID.id;\r\n    }\r\n\r\n\t/**\r\n\t * Remove dynamic element rule\r\n\t * @param {String} id  \r\n\t */\r\n\tdeleteRule(id = '') {\r\n        const me = this;\r\n\t\tArray.from(me.cssRules)\r\n\t\t\t.map((v, i) => v.selectorText === `.${id}` ? i : -1)\r\n\t\t\t.filter(v => v > -1)\r\n\t\t\t.forEach(v => me.deleteRule(v));\r\n\t}    \r\n\r\n    /**\r\n     * Get individual rule from dynamic styles cache\r\n     * @param {String} id CSS class name\r\n     * @returns {CSSRule} \r\n     */\r\n    getRule(id = '') {\r\n        return Array.from(this.cssRules).filter(v => v.selectorText === `.${id}`).pop();\r\n    }\r\n\r\n    /**\r\n     * Set dynamic element rule. Accepts string or json object representation\r\n     * @param {String} id Unique css class name used\r\n     * @param {string|object} style CSS style properties to apply\r\n     */\r\n    setRule(id, style = '', sync = false) {\r\n\r\n        const me = this;\r\n\r\n        if (!id) return;\r\n\r\n\t\tlet rule = me.getRule(id);\r\n\t\tif (!rule) {\r\n\t\t\tme.insertRule(`.${id} {}`);\r\n\t\t\treturn me.setRule(id, style, sync);\r\n\t\t}        \r\n\r\n        if (!style) return rule;\r\n\r\n        let data = [];\r\n        if (typeof style === 'string') {\r\n            data = style.replaceAll('\\n', '').split(';').map(v => v.trim().split(':')).filter(v => v.length === 2);\r\n        } else {\r\n            data = Object.entries(style);\r\n        }\r\n\r\n        if (sync) {\r\n            data.forEach(kv => me.#updateRule(rule, kv[0], kv[1]));\r\n        } else {\r\n            requestAnimationFrame(() => {\r\n                data.forEach(kv => me.#updateRule(rule, kv[0], kv[1]));\r\n            });\r\n        }\r\n\r\n        return rule;\r\n    }\r\n\r\n    #updateRule(rule, prop = '', style = '') {\r\n        style = (style || '').toString();\r\n        const isImportant = style.includes('!important');\r\n        style = style.replace('!important', '');\r\n        prop = prop.trim();\r\n        rule.style.setProperty(prop, style, isImportant ? 'important' : '');\r\n    }\r\n\r\n    /**\r\n     * Find element dynamic style attached. \r\n     * Will search for a StyleSheet within element shadow addoptedStyleSheet by element data-sheet property.\r\n     * @param {HTMLElement} source A html element continaing dynamically injected html style\r\n     * @returns {CSSStyleSheet} An instance of dynamic stylesheet containing dynamic rules\r\n     */\r\n\tstatic dynamicStyleSheet(source) {\r\n\t\t// find shadow root (or document)\r\n\t\tconst root = GSDOM.root(source);\r\n        const id = source.dataset.sheet || 'dynamic';\r\n\t\t// find custom; dynamic style\r\n\t\treturn GSDynamicStyle.dynamicStyleSheetByID(root, id);\r\n\t}\r\n\r\n    /**\r\n     * Fnd custom dynamic style\r\n     * @param {Document} root Document or shadowDom\r\n     * @param {String} id Dynamic CSS name\r\n     * @returns {CSSStyleSheet} An instance of dynamic stylesheet containing dynamic rules\r\n     */\r\n    static dynamicStyleSheetByID(root, id) {\r\n\t\treturn Array.from(root?.adoptedStyleSheets).filter(el => el.id === id).pop();\r\n    }\r\n\r\n\t/**\r\n\t * Find dynamic style & rule for element\r\n\t * @param {HTMLElement} source A html element with dynamic style attached  (with data-gs-class attribute set)\r\n\t * @returns {CSSStyleRule} Instance of dynamic css class \r\n\t */\r\n\tstatic dynamicRule(source) {\r\n\t\tconst style = GSDynamicStyle.dynamicStyleSheet(source);\r\n\t\treturn style?.getRule(source.dataset.gsClass);\t\t\r\n\t}\r\n\r\n    /**\r\n     * Fnd custom dynamic rule\r\n     * @param {Document} root Document or shadowDom\r\n     * @param {String} id Dynamic CSS name\r\n    * @returns {CSSStyleRule} Instance of dynamic css class \r\n     */    \r\n    static dynamicRuleByID(root, id) {\r\n        const style = GSDynamicStyle.dynamicStyleSheetByID(root, 'dynamic');\r\n        return style?.getRule(id);\r\n    }\r\n\r\n    /**\r\n     * Find element dynamic style\r\n     * @param {HTMLElement} source \r\n     * @returns {CSSStyle} Element dynamic style or default style if dynamic not defined\r\n     */\r\n\tstatic dynamicStyle(source) {\r\n\t\tconst rule = GSDynamicStyle.dynamicRule(source);\r\n\t\treturn rule?.style; // || source.style;\r\n\t}\r\n\r\n    /**\r\n     * Find element dynamic style\r\n     * @param {Document} source Document or shadowDOM\r\n     * @returns {CSSStyle} Element dynamic style or default style if dynamic not defined\r\n     */\r\n\tstatic dynamicStyleByID(root, id) {\r\n\t\tconst rule = GSDynamicStyle.dynamicRuleByID(root, id);\r\n\t\treturn rule?.style; // || source.style;\r\n\t}\r\n\r\n    /**\r\n     * Apply CSS properties to the element style.\r\n     * Will search for a StyleSheet within element shadow addoptedStyleSheet by element data-gs-class property.\r\n     * @param {HTMLElement} source Element with dynamic style attached (with data-gs-class attribute set)\r\n     * @param {Object} opt A JSON object of css arguments to apply \r\n     * @returns {CSSStyle} A copy of modifid CSSStyle object \r\n     */\r\n\tstatic applyDynamicStyle(source, opt) {\r\n        requestAnimationFrame(() => {\r\n            const style = GSDynamicStyle.dynamicStyle(source);\r\n            return Object.assign(style, opt);\r\n        });\r\n\t}\r\n    \r\n    /**\r\n     * \r\n     * @param {Document || ShadowRoot} root Element with dynamic style attached\r\n     * @param {String} id Dynamic CSS style name\r\n     * @param {Object} opt A JSON object of css arguments to apply \r\n     * @returns {CSSStyle} A copy of modifid CSSStyle object \r\n     */\r\n\tstatic applyDynamicStyleByID(root, id, opt) {\r\n        requestAnimationFrame(() => {\r\n            const style = GSDynamicStyle.dynamicStyleByID(root, id);\r\n            return Object.assign(style, opt);\r\n        });\r\n\t}     \r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSCacheStyles class\r\n * @module head/GSCacheStyles\r\n */\r\n\r\nimport { GSDynamicStyle } from \"./GSDynamicStyle.mjs\";\r\nimport { GSID } from \"./GSID.mjs\";\r\nimport { GSLog } from \"./GSLog.mjs\";\r\n\r\nimport { gsstyles } from \"./style.mjs\";\r\n\r\n/**\r\n * Cache for dynamically loaded styles.\r\n * Used to share styles among GS-* WebComponents\r\n * @class\r\n */\r\nexport class GSCacheStyles {\r\n\r\n\tstatic #store = new Map();\r\n\r\n\t/**\r\n\t * Create a new CSSStyleSheet\r\n\t * @param {String} id Unique ID\r\n\t * @returns {CSSStyleSheet} Created instance\r\n\t */\r\n\tstatic create(id) {\r\n\t\tconst sheet = new GSDynamicStyle(id);\r\n\t\tthis.#store.set(id, sheet);\r\n\t\treturn sheet;\r\n\t}\r\n\r\n\t/**\r\n\t * Store initialized stylesheet under the unique ID\r\n\t * @param {String} id \r\n\t * @param {CSSStyleSheet} style \r\n\t * @returns {CSSStyleSheet} Stored stylesheet\r\n\t */\r\n\tstatic set(id, style) {\r\n\r\n\t\tconst me = this;\r\n\r\n\t\tif (style instanceof CSSStyleSheet) {\r\n\t\t\tme.#store.set(id, style);\r\n\t\t}\r\n\r\n\t\tif (style && typeof style === 'string') {\r\n\t\t\tconst sheet = GSCacheStyles.create(id);\r\n\t\t\tsheet.replaceSync(style);\r\n\t\t}\r\n\r\n\t\treturn me.get(id);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Remove stylesheet by unique ID\r\n\t * @param {String} id \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic remove(id) {\r\n\t\treturn this.#store.delete(id);\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve stylesheet by unique ID\r\n\t * @param {String} id \r\n\t * @returns {CSSStyleSheet}\r\n\t */\r\n\tstatic get(id) {\r\n\t\treturn this.#store.get(id);\r\n\t}\r\n\r\n\t/**\r\n\t * Get list of dynamic styles\r\n\t * @returns {CSSStyleSheet}\r\n\t */\r\n\tstatic get dynamic() {\r\n\r\n\t\tconst me = GSCacheStyles;\r\n\t\tconst id = 'gs-dynamic';\r\n\t\t\r\n\t\tlet sheet = me.get(id);\r\n\t\tif (!sheet) {\r\n\t\t\tsheet = GSCacheStyles.create(id);\r\n\t\t\tdocument.adoptedStyleSheets = GSCacheStyles.styles;\r\n\t\t}\r\n\t\t\r\n\t\treturn sheet;\r\n\t}\r\n\r\n\t/**\r\n\t * Get individual rule from dynamic styles cache\r\n\t * @param {String} id \r\n\t * @returns {CSSRule}\r\n\t */\r\n\tstatic getRule(id = '') {\r\n\t\treturn GSCacheStyles.dynamic.getRule(id);\r\n\t}\r\n\r\n\t/**\r\n\t * Set dynamic element rule. Accepts string or json object representation\r\n\t * @param {String} id \r\n\t * @param {string|object} style \r\n\t */\r\n\tstatic setRule(id = '', style = '', sync = false) {\r\n\t\treturn GSCacheStyles.dynamic.setRule(id, style, sync);\r\n\t}\r\n\r\n\t/**\r\n\t * Remove dynamic element rule\r\n\t * @param {String} id  \r\n\t */\r\n\tstatic deleteRule(id = '') {\r\n\t\tGSCacheStyles.dynamic.deleteRule(id);\r\n\t}\r\n\r\n\t/**\r\n\t * Return list of registered style sheets\r\n\t * @returns {Array<CSSStyleSheet>}\r\n\t */\r\n\tstatic get styles() {\r\n\t\treturn Array.from(new Map([...GSCacheStyles.#store].sort((a, b) => String(a[0]).localeCompare(b[0]))).values());\r\n\t}\r\n\r\n\t/**\r\n\t * Inject CSS used by framework across all shadows\r\n\t * @param {string} css CSS string to inject\r\n\t * @param {number} [hash=0] Optional hash for the style\r\n\t */\r\n\tstatic adopt(css = '', hash = 0) {\r\n\t\tif (!css) return;\r\n\t\ttry {\r\n\t\t\thash = hash || GSID.hashCode(css);\r\n\t\t\tGSCacheStyles.set(hash, css);\r\n\t\t\tdocument.adoptedStyleSheets = GSCacheStyles.styles;\r\n\t\t} catch (e) {\r\n\t\t\tGSLog.error(null, e);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.freeze(GSCacheStyles);\r\n\t\tglobalThis.GSCacheStyles = GSCacheStyles;\r\n\t\tGSCacheStyles.adopt(gsstyles);\r\n\t}\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\nimport { GSDOM } from './GSDOM.mjs';\r\nimport { GSEvents } from './GSEvents.mjs';\r\nimport { GSDOMObserver } from './GSDOMObserver.mjs';\r\nimport { GSCacheStyles } from './GSCacheStyles.mjs';\r\n\r\nconst adoptedId = Symbol();\r\nconst observer = Symbol();\r\n\r\n/**\r\n * Monitor HTMLStyleElement & HTMLLinkElement (of type stylesheet) for changes.\r\n * Every such element marked with data-adoptable=\"true\" will be cached and\r\n * will trigger gs-adopted event to notify component controller to update adoptableStyleSheet list\r\n */\r\nexport class GSAdoptedEngine {\r\n\r\n  static timeout = 1000; // Default timeout for adopting stylesheets\r\n  static #timerID = 0;\r\n  static #ID = Date.now();\r\n  static #scheduled = false;\r\n\r\n  static #init() {\r\n    const me = GSAdoptedEngine;\r\n    me.observe(document.head);\r\n    me.#preload();\r\n    me.#timerID = setInterval(() => me.#adopt(), me.timeout);\r\n  }\r\n\r\n  static #clear() {\r\n    const me = GSAdoptedEngine;\r\n    clearInterval(me.#timerID);\r\n    me.#timerID = undefined;\r\n  }\r\n\r\n  static #adopt() {\r\n    const me = GSAdoptedEngine;\r\n    const sheets = me.#adoptable;\r\n    if (sheets.length == 0) return me.#clear();\r\n    sheets.map(s => me.#adoptSheet(s));\r\n    me.update();\r\n  }\r\n\r\n  static update() {\r\n    const me = GSAdoptedEngine;\r\n    if (me.#scheduled) return;\r\n    me.#scheduled = true;\r\n    queueMicrotask(() => {\r\n      requestAnimationFrame(() => {\r\n        try {\r\n          document.adoptedStyleSheets = me.#sorted;\r\n          document.adoptedStyleSheets.id = ++me.#ID;\r\n        } finally {\r\n          me.#scheduled = false;\r\n          globalThis.dispatchEvent(new CustomEvent('gs-adopted'));\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  static #asText(sheet) {\r\n    return Object.values(sheet.cssRules).map(o => o.cssText).join('');\r\n  }\r\n\r\n  static #adoptLink(el) {\r\n    const me = GSAdoptedEngine;\r\n    GSAdoptedEngine.#monitorAttributes(el);\r\n    Array.from(document.styleSheets).filter(s => s.ownerNode === el).map(s => me.#adoptSheet(s));\r\n  }\r\n\r\n  static #adoptSheet(sheet) {\r\n    const me = GSAdoptedEngine;\r\n    const style = me.#asText(sheet);\r\n    return me.#adoptStyle(sheet.ownerNode, style);\r\n  }\r\n\r\n  static #adoptStyle(ownerNode, style) {\r\n    const me = GSAdoptedEngine;\r\n    const sheet = new CSSStyleSheet();\r\n    sheet.replaceSync(style);\r\n    sheet.id = ++me.#ID;\r\n    ownerNode[adoptedId] = sheet.id;\r\n    me.#store(ownerNode, sheet);\r\n    return sheet;\r\n  }\r\n\r\n  static #store(ownerNode, sheet) {\r\n    GSCacheStyles.set(sheet.id, sheet);\r\n  }\r\n\r\n  static #remove(ownerNode, sheet) {\r\n    GSCacheStyles.remove(sheet.id);\r\n    ownerNode[observer]?.disconnect?.();\r\n    ownerNode[observer] = undefined;\r\n  }\r\n\r\n  static get #sorted() {\r\n    return GSCacheStyles.styles;\r\n  }\r\n\r\n  /**\r\n   * List of adoptable styles or links. Filter only those with dataset.adoptable=true\r\n   * @returns {HTMLStyleElement|HTMLLinkElement}\r\n   */\r\n  static get #adoptable() {\r\n    return Object.values(document.styleSheets)\r\n      .filter(o => o.ownerNode)\r\n      .filter(o => o.ownerNode.dataset.adoptable)\r\n      .filter(o => !o.ownerNode[adoptedId]);\r\n  }\r\n\r\n  static #preload() {\r\n    GSDOM.queryAll(document.head, 'link[rel=\"preload\"][as=\"style\"]')\r\n    .forEach(el => {\r\n      el.remove();\r\n      document.head.appendChild(el);\r\n    });\r\n  }\r\n\r\n  static #onAttributeChange(mutationList) {\r\n    mutationList.forEach((mutation) => {\r\n       const id = mutation.target[adoptedId];\r\n       const style = GSCacheStyles.get(id);\r\n       if(style) style.disabled = mutation.target.hasAttribute('disabled');\r\n    });\r\n    GSAdoptedEngine.update();\r\n  }\r\n  \r\n  static #monitorAttributes(element) {\r\n    const me = GSAdoptedEngine;\r\n    const callback = me.#onAttributeChange.bind(me);\r\n    const observer = new MutationObserver(callback);\r\n    observer.observe(element, {\r\n      attributeFilter: [\"disabled\"],\r\n      attributeOldValue: true,\r\n      subtree: false,\r\n    });\r\n    return observer;\r\n  }\r\n  \r\n  /**\r\n   * Filter style and link(css) elements which will be shared\r\n   * with all web components. Filter only those marked with data-adoptable\r\n   * @param {HTMLElement} el \r\n   * @returns {Boolean} Return true if monitored element is selected for further processing\r\n   */\r\n  static #onMonitorFilter(el) {\r\n    return (Boolean(el.dataset?.adoptable))\r\n      && (\r\n        (el instanceof HTMLLinkElement && (el.rel === 'stylesheet' || el.as === \"style\"))\r\n        || el instanceof HTMLStyleElement\r\n      );\r\n  }\r\n\r\n  /**\r\n   * When style added to the HTML page, attach it to the WebComponents\r\n   * @param {HTMLStyleElement|HTMLLinkElement} el \r\n   */\r\n  static #onMonitorConnect(el) {\r\n    const me = GSAdoptedEngine;\r\n    if (el instanceof HTMLStyleElement) {\r\n      me.#adoptStyle(el, el.innerText);\r\n      me.update();\r\n    } else if (el instanceof HTMLLinkElement) {\r\n      GSEvents.wait(el, 'load', 0, false).then(e => {\r\n        if (el.rel === 'preload') return el.rel = \"stylesheet\";\r\n        me.#adoptLink(e.target);\r\n        me.update();\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * When style removed, remove from adoptable and update\r\n   * @param {HTMLElement} el \r\n   */\r\n  static #onMonitorDisconnect(el) {\r\n    const me = GSAdoptedEngine;\r\n    me.#sorted.filter(o => o.id === el[adoptedId])\r\n          .forEach(o => me.#remove(el, o));\r\n    me.update();\r\n  }\r\n\r\n  /**\r\n   * Observe DOM tree for mutations\r\n   * @param {HTMLElement} owner Root element to watch DOM tree from \r\n   */\r\n  static observe(owner) {\r\n    const me = GSAdoptedEngine;\r\n    GSDOMObserver.registerFilter(me.#onMonitorFilter, me.#onMonitorConnect, false, owner);\r\n    GSDOMObserver.registerFilter(me.#onMonitorFilter, me.#onMonitorDisconnect, true, owner);\r\n  }\r\n\r\n  static {\r\n    this.#init();\r\n  }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSLoader class\r\n * @module base/GSLoader\r\n */\r\n\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSLog } from \"./GSLog.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSVersion } from \"./GSVersion.mjs\";\r\n\r\n/**\r\n * A set of static functions used for loading resources\r\n * @class\r\n */\r\nexport class GSLoader {\r\n\r\n    static TEMPLATE_URL = globalThis.GS_TEMPLATE_URL || location.origin;\r\n    static ROUTER_URL = globalThis.GS_ROUTER_URL || location.origin;\r\n\r\n    static NO_CACHE = false;\r\n    static UNIQUE = GSVersion.build;\r\n\r\n    static {\r\n        const rootURL = GSLoader.#defaultURL;\r\n        if (!globalThis.GS_TEMPLATE_URL) {\r\n            GSLoader.TEMPLATE_URL = rootURL;\r\n            globalThis.GS_TEMPLATE_URL = rootURL;\r\n        }\r\n\r\n        if (!globalThis.GS_ROUTER_URL) {\r\n            GSLoader.ROUTER_URL = rootURL;\r\n            globalThis.GS_ROUTER_URL = rootURL;\r\n        }\r\n\r\n        //const hasKey = Object.hasOwn(self, 'GS_NO_CACHE');\r\n        const hasKey = 'GS_NO_CACHE' in self;\r\n        if (hasKey) {\r\n            GSLoader.NO_CACHE = globalThis.GS_NO_CACHE === true;\r\n            if (localStorage) localStorage.setItem('GS_NO_CACHE', GSLoader.NO_CACHE);\r\n        }\r\n        GSLoader.NO_CACHE = localStorage ? localStorage.getItem('GS_NO_CACHE') == 'true' : false;\r\n\r\n    }\r\n\r\n    static get #defaultURL() {\r\n        const url = location.href.split('?').pop();\r\n        const seg = url.split('/');\r\n        return url.endsWith('/') ? url : seg.slice(0, -1).join('/');\r\n    }\r\n\r\n    /**\r\n     * Convert partial URL to a real URL\r\n     * @param {String} url \r\n     * @return {String}\r\n     */\r\n    static normalizeURL(url = '', base = false) {\r\n\r\n        url = url || '';\r\n        let path = null;\r\n        const isFile = location.pathname.split('/').pop(-1).includes('\\.');\r\n        const isExt = url.includes('extension:/');\r\n        const isUrl = url.startsWith('http');\r\n\r\n        if (isUrl || isExt) {\r\n            path = url;\r\n        } else if (url.startsWith('/')) {\r\n            path = `${location.origin}/${url}`;\r\n        } else if (isFile) {\r\n            path = `${location.origin}${location.pathname}/../${url}`;\r\n        } else {\r\n            path = `${location.origin}${location.pathname}/${url}`;\r\n        }\r\n\r\n        path = path.split('://').map(v => v.replaceAll(/\\/{2,}/g, '/')).join('://');\r\n        const uri = new URL(path);\r\n\r\n        // to handle caching\r\n        //if (!base && GSLoader.NO_CACHE) uri.searchParams.append('_dc', Date.now());\r\n        if (!base) {\r\n            const val = GSLoader.NO_CACHE ? Date.now() : GSLoader.UNIQUE;\r\n            uri.searchParams.append('_dc', val);\r\n        }\r\n\r\n        return uri.href;\r\n    }\r\n\r\n    /**\r\n     * Extrach parent path from provided URL string\r\n     * @param {String} url \r\n     * @param {Number} level How many levels to go up the chain\r\n     * @returns {String}\r\n     */\r\n    static parentPath(url = '', level = 1) {\r\n        return (url || '').split('/').slice(0, -1 * level).join('/') + '/';\r\n    }\r\n\r\n    /**\r\n     * Used to load router definition from virtual path\r\n     * \r\n     * @async\r\n     * @param {String} def\r\n     * @return {Promise<string>}\r\n     */\r\n    static async getRouter(def = '') {\r\n\r\n        if (!def) return def;\r\n\r\n        const isRef = def.startsWith('#');\r\n        if (isRef) {\r\n            const el = GSDOM.query(document.documentElement, def);\r\n            return el ? GSUtil.toJson(el.innerHTML) : {};\r\n        }\r\n\r\n        const isHTML = GSUtil.isHTML(def);\r\n        if (isHTML) return def;\r\n\r\n        def = GSLoader.#getRouterURL(def);\r\n        return GSLoader.loadSafe(def, 'GET', null, true);\r\n    }\r\n\r\n    /**\r\n     * Decode template URL into a real URL\r\n     * @param {String} url \r\n     * @return {String}\r\n     */\r\n    static #getRouterURL(url = '') {\r\n        url = url.startsWith('//') ? GSLoader.#routerURL + '/' + url : url;\r\n        return GSLoader.normalizeURL(url);\r\n    }\r\n\r\n    /**\r\n     * Retrieve default template url\r\n     * @return {String}\r\n     */\r\n    static get #routerURL() {\r\n        return GSLoader.normalizeURL(GSLoader.#routerPath, true);\r\n    }\r\n\r\n    /**\r\n     * Retrieve defult template path\r\n     * @return {String}\r\n     */\r\n    static get #routerPath() {\r\n        return GSLoader.ROUTER_URL ? GSLoader.ROUTER_URL.replace('//', '/') : '';\r\n    }\r\n\r\n    /**\r\n     * Used for override to get predefined template\r\n     * Can be html source or url, checks if load or not\r\n     * \r\n     * @async\r\n     * @param {String} def\r\n     * @return {Promise<string>}\r\n     */\r\n    static async getTemplate(def = '') {\r\n\r\n        if (!def) return def;\r\n\r\n        const isRef = def.startsWith('#');\r\n        if (isRef) {\r\n            const el = GSDOM.query(document.documentElement, def);\r\n            return el ? el.innerHTML : def;\r\n        }\r\n\r\n        const isHTML = GSUtil.isHTML(def);\r\n        if (isHTML) return def;\r\n\r\n        def = GSLoader.#getTemplateURL(def);\r\n        return GSLoader.loadSafe(def);\r\n    }\r\n\r\n    /**\r\n     * Decode template URL into a real URL\r\n     * @param {String} url \r\n     * @return {String}\r\n     */\r\n    static #getTemplateURL(url = '') {\r\n        /*\r\n        const isDirect =  /^(https?:\\/\\/)/i.test(url);\r\n        url = isDirect ? url : GSLoader.#templateURL + '/' + url;\r\n        */\r\n        url = url.startsWith('//') ? GSLoader.#templateURL + '/' + url : url;\r\n        return GSLoader.normalizeURL(url);\r\n    }\r\n\r\n    /**\r\n     * Retrieve default template url\r\n     * @return {String}\r\n     */\r\n    static get #templateURL() {\r\n        return GSLoader.normalizeURL(GSLoader.#templatePath, true);\r\n    }\r\n\r\n    /**\r\n     * Retrieve defult template path\r\n     * @return {String}\r\n     */\r\n    static get #templatePath() {\r\n        return GSLoader.TEMPLATE_URL ? GSLoader.TEMPLATE_URL.replace('//', '/') : '';\r\n    }\r\n\r\n    /**\r\n     * Load html template (used for template cache)\r\n     * \r\n     * @async\r\n     * @param {String} val Full or partial url path\r\n     * @param {String} method HTTP methog get|put|post\r\n     * @returns {Promise<string>}\r\n     * @throws {Error}\r\n     */\r\n    static async loadTemplate(val = '', method = 'GET') {\r\n        const url = GSLoader.#getTemplateURL(val);\r\n        return await GSLoader.load(url, method);\r\n    }\r\n\r\n    /**\r\n     * Load remote data as text (for loading templates)\r\n     * \r\n     * @async\r\n     * @param {String} val Full or partial url path\r\n     * @param {String} method HTTP method get|put|post\r\n     * @param {Object} headers HTTP request headers in JSON key/value pairs\r\n     * @param {Boolean} asjson Parse returned data as JSON\r\n     * @param {} body Data to send in a request \r\n     * @returns {Promise<object|string>}\r\n     */\r\n    static async load(val = '', method = 'GET', headers, asjson = false, body) {\r\n        let data = null;\r\n        const ct = 'Content-Type';\r\n        headers = { ...headers };\r\n        headers[ct] = asjson ? 'application/json; utf-8' : headers[ct] || 'text/plain';\r\n        headers.Accept = 'application/json';\r\n        const url = GSLoader.normalizeURL(val, true);\r\n        const opt = { method: method, headers: headers };\r\n        if (method === 'POST' || method === 'PUT' && body) {\r\n            // TODO - detect if binary\r\n            opt.body = JSON.stringify(body);\r\n        }\r\n        const res = await fetch(url, opt);\r\n        if (res.ok) data = asjson ? await res.json() : await res.text();\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * Load remote data without throwing an exception\r\n     * \r\n     * @async\r\n     * @param {String} url Full or partial url path\r\n     * @param {String} method http method GET|POST|PUT\r\n     * @param {Object} headers return json or string\r\n     * @param {Boolean} asjson return json or string\r\n     * @param {Object} dft default value\r\n     * @returns {Promise<object|string>}\r\n     */\r\n    static async loadSafe(url = '', method = 'GET', headers, asjson = false, dft, body) {\r\n        try {\r\n            if (url) return GSLoader.load(url, method, headers, asjson, body);\r\n        } catch (e) {\r\n            GSLog.error(null, e);\r\n        }\r\n        if (dft) return dft;\r\n        return asjson ? {} : '';\r\n    }\r\n\r\n\r\n    /**\r\n     * Load data from various sources\r\n     * \r\n     * @async\r\n     * @param {JSON|func|url} val \r\n     * @returns {Promise}\r\n     */\r\n    static async loadData(val = '') {\r\n\r\n        const isJson = GSUtil.isJson(val);\r\n        const func = !isJson && GSFunction.parseFunction(val);\r\n        const isFunc = func && GSFunction.isFunction(func);\r\n        const isData = !isFunc && GSUtil.parseValue(val);\r\n\r\n        if (isData || isJson) val = GSUtil.toJson(val);\r\n\r\n        if (isFunc) val = await GSFunction.callFunction(func);\r\n\r\n        if (!GSUtil.isJsonType(val)) return;\r\n\r\n        return val;\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSLoader);\r\n        globalThis.GSLoader = GSLoader;\r\n    }\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2022  Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSTemplateCache class\r\n * @module templating/GSTemplateCache\r\n */\r\n\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSLoader } from \"./GSLoader.mjs\";\r\nimport { GSLog } from \"./GSLog.mjs\";\r\n\r\n/**\r\n * Template cache to store loaded and preprocessed templates for reuse\r\n * @class\r\n */\r\nexport class GSTemplateCache {\r\n\r\n\tstatic #store = new Map();\r\n\r\n\t static clear() {\r\n\t\tGSTemplateCache.#store.clear();\r\n\t}\r\n\r\n\t/**\r\n\t * Store pre-processed template into a cache under given name. \r\n\t * Name is usually a path to a template.\r\n\t * @param {String} name Name of a template\r\n\t * @param {HTMLTemplateElement} template Preprocessed template\r\n\t */\r\n\tstatic store(name, template) {\r\n\t\tthis.#store.set(name, template);\r\n\t}\r\n\r\n\t/**\r\n\t * Remove template from cache\r\n\t * @param {String} name Name of a template\r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic remove(name) {\r\n\t\treturn this.#store.delete(name);\r\n\t}\r\n\r\n\t/**\r\n\t * Get template from cache by its name.\r\n\t * @param {*} name Name of a template\r\n\t * @returns {HTMLTemplateElement}\r\n\t */\r\n\tstatic load(name) {\r\n\t\treturn this.#store.get(name);\r\n\t}\r\n\r\n\t/**\r\n\t * Helper function to retrieve already existing template by name,\r\n\t * or inject a new one if it does not exist already and return template instance.\r\n\t * @param {String} name \r\n\t * @param {String} template \r\n\t * @returns {HTMLTemplateElement}\r\n\t */\r\n\tstatic getOrCreate(name, template) {\r\n\t\tconst me = GSTemplateCache;\r\n\t\tlet el = me.load(name);\r\n\t\tif (el) return el;\r\n\t\tel = me.create(template);\r\n\t\tme.store(name, el);\r\n\t\treturn el;\r\n\t}\r\n\r\n\t/**\r\n\t * Create template element from loaded template source\r\n\t * \r\n\t * @param {String} template \r\n\t * @returns {HTMLTemplateElement}\r\n\t */\r\n\tstatic create(template) {\r\n\t\tconst el = document.createElement('template');\r\n\t\tGSDOM.setHTML(el, template);\r\n\t\treturn el;\r\n\t}\r\n\r\n\t/**\r\n\t * Clone data from template element\r\n\t * \r\n\t * @param {HTMLTemplateElement} template \r\n\t * @returns {HTMLTemplateElement}\r\n\t */\r\n\tstatic clone(template) {\r\n\t\treturn GSDOM.isTemplateElement(template) ? template.content.cloneNode(true) : null;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if template is retrieved from function\r\n\t * \r\n\t * @param {String} tpl \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isFunctionTemplate(tpl) {\r\n\t\tconst fn = GSFunction.parseFunction(tpl);\r\n\t\treturn GSFunction.isFunction(fn) ? fn : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if template is retrieved from html code\r\n\t * \r\n\t * @param {String} tpl \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isHTMLTemplate(tpl) {\r\n\t\tconst val = tpl ? tpl.trim() : '';\r\n\t\t//return (val.startsWith('<') && val.endsWith('>')) ? tpl : false;\r\n\t\treturn /^<(.*)>$/s.test(val) ? tpl : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if template is retrieved from URL\r\n\t * \r\n\t * @param {String} tpl \r\n\t * @returns {Boolean}\r\n\t */\r\n\tstatic isURLTemplate(tpl) {\r\n\t\tconst val = tpl ? tpl.trim() : '';\r\n\t\treturn /^(https?:\\/\\/|.{0,2}\\/{1,2})/i.test(val) ? tpl : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Initialize loaded template\r\n\t * \r\n\t * @param {Boolean} cached Set to true to auto cache if template does not exist\r\n\t * @param {String} name Template name\r\n\t * @param {String} template Template source\r\n\t * @returns {HTMLTemplateElement} Template instance\r\n\t */\r\n\tstatic initTemplate(cached = false, name = '', template) {\r\n\t\tconst me = GSTemplateCache;\r\n\t\tif (cached) return me.getOrCreate(name, template);\r\n\t\treturn me.create(template);\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve template from given HTML text\r\n\t * \r\n\t * @param {Boolean} cached Set to true to auto cache if template does not exist\r\n\t * @param {String} name Template name\r\n\t * @param {String} tpl Template source\r\n\t * @returns {HTMLTemplateElement} Template instance\r\n\t */\r\n\tstatic loadHTMLTemplate(cached = false, name = '', tpl) {\r\n\t\tconst me = GSTemplateCache;\r\n\t\tconst o = me.isHTMLTemplate(tpl);\r\n\t\tif (!o) return o;\r\n\t\treturn me.initTemplate(cached, name, o);\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve template from given URL\r\n\t * \r\n\t * @async\r\n\t * @param {Boolean} cached Set to true to auto cache if template does not exist\r\n\t * @param {String} name Template name\r\n\t * @param {String} template Template source\r\n\t * @returns {Promise<HTMLTemplateElement>} Template instance\r\n\t */\r\n\tstatic async loadURLTemplate(cached = false, name = '', tpl) {\r\n\t\tconst me = GSTemplateCache;\r\n\t\ttry {\r\n\t\t\tlet template = null;\r\n\t\t\tif (cached) template = me.load(tpl);\r\n\t\t\tif (template) return template;\r\n\t\t\ttemplate = await GSLoader.loadTemplate(tpl);\r\n\t\t\treturn me.initTemplate(cached, name, template);\r\n\t\t} catch (e) {\r\n\t\t\tGSLog.error(me, e);\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve template from given function\r\n\t * \r\n\t * @async\r\n\t * @param {Boolean} cached Set to true to auto cache if template does not exist\r\n\t * @param {String} name Template name\r\n\t * @param {String} template Template source\r\n\t * @returns {Promise<HTMLTemplateElement>} Template instance\r\n\t */\r\n\tstatic async loadFunctionTemplate(cached = false, name = '', tpl) {\r\n\t\tconst me = GSTemplateCache;\r\n\t\tconst fn = me.isFunctionTemplate(tpl);\r\n\t\tif (!fn) return fn;\r\n\t\ttry {\r\n\t\t\tlet template = null;\r\n\t\t\tif (me.cached) template = me.load(o);\r\n\t\t\tif (template) return template;\r\n\t\t\ttemplate = GSFunction.isFunctionAsync(fn) ? await fn() : fn();\r\n\t\t\treturn me.initTemplate(cached, name, template);\r\n\t\t} catch (e) {\r\n\t\t\tGSLog.error(null, e);\r\n\t\t}\r\n\t\treturn fn;\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve and cache html template for element\r\n\t * \r\n\t * @async\r\n\t * @param {Boolean} cached Set to true to auto cache if template does not exist\r\n\t * @param {String} name Template name\r\n\t * @param {String} template Template source\r\n\t * @returns {Promise<HTMLTemplateElement>} Template instance\r\n\t */\r\n\tstatic async loadTemplate(cached = false, name = '', tpl) {\r\n\r\n\t\tif (!name) return false;\r\n\t\tif (!tpl) return false;\r\n\r\n\t\tconst me = GSTemplateCache;\r\n\r\n\t\t// try to load override template (by GSElement tag name)\r\n\t\tlet template = false;\r\n\r\n\t\tif (tpl.indexOf('#') == 0) {\r\n\t\t\t// return document.getElementById(tpl.slice(1));\r\n\t\t\treturn GSDOM.query(`template[id=\"${tpl.slice(1)}\"]`, true);\r\n\t\t}\r\n\r\n\t\tif (!template) {\r\n\t\t\ttemplate = me.loadHTMLTemplate(cached, name, tpl);\r\n\t\t}\r\n\r\n\t\tif (!template) {\r\n\t\t\ttemplate = await me.loadFunctionTemplate(cached, name, tpl);\r\n\t\t}\r\n\r\n\t\tif (!template) {\r\n\t\t\ttemplate = await me.loadURLTemplate(cached, name, tpl);\r\n\t\t}\r\n\r\n\t\treturn template;\r\n\t}\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSLog } from \"./GSLog.mjs\";\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSAttr } from \"./GSAttr.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSEvents } from \"./GSEvents.mjs\";\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSTemplateCache } from \"./GSTemplateCache.mjs\";\r\n\r\n/**\r\n * A module GSAttributeHandler GSAttr class\r\n * @module base/GSDOM\r\n */\r\n\r\n/**\r\n * Attributes to control click actions for buttons and links.\r\n * Used for meta linking between UI elements\r\n * \r\n * Attributes handled:\r\n * - data-gs-action - trigger action event\r\n * - data-gs-anchor - where to anchor injected html (self, beforebegin, afterbegin, etc.)\r\n * - data-gs-attribute - toggle element attribute (receive k=v;k1=v1 or JSON format)\r\n * - data-gs-call - calls a function on a given target (multiple functions supported)\r\n * - data-gs-event - emit event (can bubble or compose)\r\n * - data-gs-exec - execute a function (alternative to the call)\r\n * - data-gs-inject - inject HTML content; used for WebComponent append\r\n * - data-gs-property - togle element property (receive k=v;k1=v1 or JSON format)\r\n * - data-gs-swap - swap HTML content; used for WebComponent replacement\r\n * - data-gs-target - CSS query for a target or targets\r\n * - data-gs-template - template to load and inject template\r\n * - data-gs-timeout - a timeout between class toggle\r\n * - data-gs-toggle - toggle CSS classes on a given target\r\n * - data-gs-trigger - triggers an event on a given target\r\n * - data-gs-value - value to pass to a gs-call or gs-trigger\r\n *\r\n * NOTE: \r\n * data-gs-swap and gs-inject uses data-gs-anchor to determine \r\n * where to inject html. If not, set, innerHTML is used\r\n * \r\n * data-gs-target determine element on which to execute,\r\n * if not specified, it means current element\r\n * \r\n * @class\r\n */\r\nexport class GSAttributeHandler {\r\n\r\n    static #reverse = Symbol();\r\n    static #link = Symbol();\r\n\r\n    static DEFINITION = {\r\n        action: { attribute: 'data-gs-action' },\r\n        anchor: { attribute: 'data-gs-anchor' },\r\n        attribute: { attribute: 'data-gs-attribute' },\r\n        call: { attribute: 'data-gs-call' },\r\n\r\n        event: { attribute: 'data-gs-event' },\r\n        bubbles: { attribute: 'data-gs-bubbles', type: Boolean },\r\n        composed: { attribute: 'data-gs-composed', type: Boolean },\r\n\r\n        exec: { attribute: 'data-gs-exec' },\r\n        inject: { attribute: 'data-gs-inject' },\r\n        property: { attribute: 'data-gs-property' },\r\n        swap: { attribute: 'data-gs-swap' },\r\n        target: { attribute: 'data-gs-target' },\r\n        template: { attribute: 'data-gs-template' },\r\n        toggle: { attribute: 'data-gs-toggle' },\r\n        trigger: { attribute: 'data-gs-trigger' },\r\n        value: { attribute: 'data-gs-value' },\r\n\r\n        hashed: { attribute: 'data-gs-hashed', type: Boolean },\r\n\r\n        calls: { attribute: 'data-gs-call', multi: true },\r\n        toggles: { attribute: 'data-gs-toggle', multi: true },\r\n        timeout: { attribute: 'data-gs-timeout', type: Number },\r\n        triggers: { attribute: 'data-gs-trigger', multi: true },\r\n    }\r\n\r\n    #host;\r\n    #proxy;\r\n    #targetList = null\r\n    #active = false;\r\n    #callback;\r\n\r\n    constructor(el, target) {\r\n        const me = this;\r\n        me.#host = el.isProxy ? el.self : el;\r\n        me.#callback = me.handle.bind(me);\r\n        me.#proxy = el.isProxy ? el : GSAttributeHandler.proxify(me.#host);\r\n        if (target) me.#targetList = Array.isArray(target) ? target : [target];\r\n    }\r\n\r\n    /**\r\n     * Main function to process element data-gs-* attributes\r\n     * @param {Event} e \r\n     */\r\n    handle(e) {\r\n        const me = this;\r\n        me.targets.forEach(el => me.#handleTarget(me.#host, el, e));\r\n    }\r\n\r\n    /**\r\n     * Process each individual data-gs-* attribute\r\n     * @param {GSElement} host \r\n     * @param {String|HTMLElement} target \r\n     * @param {Event} evt \r\n     */\r\n    #handleTarget(host, target, evt) {\r\n        const me = this;\r\n        me.#handleBinding(target, evt);\r\n        me.#handleAction(target);\r\n        me.#handleSwap(host, target);\r\n        me.#handleInject(host, target);\r\n        me.#handleAttribute(target);\r\n        me.#handleProperty(target);\r\n        me.#handleToggle(target);\r\n        me.#handleTrigger(target, evt);\r\n        me.#handleEvent(host, evt);\r\n        me.#handleCall(host, target, evt);\r\n        me.#handleExec(host, target, evt);\r\n        me.#handleTemplate(host, target);\r\n    }\r\n\r\n    /**\r\n     * Bind provided value to the form or form element\r\n     * @param {HTMLFormElement|HTMLInputElement} target \r\n     * @param {Event} evt \r\n     * @returns \r\n     */\r\n    #handleBinding(target, evt) {\r\n        const source = evt?.target?.field || evt?.target?.form || evt?.target;\r\n        const isForm = source instanceof HTMLFormElement;\r\n        const isField = GSDOM.isFormElement(source);\r\n        if (!(isField || isForm)) return;\r\n        if (isField) {\r\n            target[source.name] = GSDOM.getValue(source);\r\n        } else {\r\n            Object.assign(target, GSDOM.toObject(source));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Trigger 'action' event on target to execute specific function\r\n     * @param {GSElement} target \r\n     */\r\n    #handleAction(target) {\r\n        if (this.action) GSEvents.send(target, 'action', this.action, true, true);\r\n    }\r\n\r\n    /**\r\n     * Set target attribute value\r\n     * @param {HTMLElement} target \r\n     * @returns \r\n     */\r\n    #handleAttribute(target) {\r\n        const me = this;\r\n\r\n        if (me.inject) target = GSDOM.query(target, me.inject);\r\n        if (me.swap) target = GSDOM.query(target, me.swap);\r\n\r\n        if (me.isAttributeJSON) {\r\n            const obj = GSUtil.toJson(me.attribute);\r\n            return GSAttr.jsonToAttr(target, obj);\r\n        }\r\n        const attrs = me.attributes;\r\n        attrs.forEach(v => me.#toggleAttribute(target, v[0], me.value || v[1]));\r\n    }\r\n\r\n    /**\r\n     * Set value to target propery\r\n     * @param {GSElement} target \r\n     * @returns \r\n     */\r\n    #handleProperty(target) {\r\n        const me = this;\r\n        if (me.inject) target = GSDOM.query(target, me.inject);\r\n        if (me.swap) target = GSDOM.query(target, me.swap);\r\n        if (me.isPropertyJSON) {\r\n            const obj = GSUtil.toJson(me.property);\r\n            return Object.assign(target, obj);\r\n        }\r\n        const props = me.properties;\r\n        props.forEach(v => me.#toggleProperty(target, v[0], me.value || v[1]));\r\n    }\r\n\r\n    #toggleAttribute(target, name, value) {\r\n\r\n        if (GSUtil.isBool(target[name])) {\r\n            return GSAttr.toggle(target, name, !target[name]);\r\n        } else if (GSUtil.isNumber(target[name])) {\r\n            value = GSUtil.asNum(value);\r\n        }\r\n        GSAttr.set(target, name, value);\r\n    }\r\n\r\n    #toggleProperty(target, name, value) {\r\n        if (GSUtil.isBool(target[name])) {\r\n            if (GSUtil.isStringEmpty(value)) {\r\n                target[name] = !target[name];\r\n            } else {\r\n                target[name] = GSUtil.asBool(value);\r\n            }\r\n        } else if (GSUtil.isNumber(target[name])) {\r\n            target[name] = GSUtil.asNum(value);\r\n        } else {\r\n            target[name] = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Toggle target css class\r\n     * @param {HTMLElement} target \r\n     */\r\n    async #handleToggle(target) {\r\n        const me = this;\r\n        const tout = me.timeout * 1000;\r\n        let toggles = me.toggles;\r\n        if (tout === 0) {\r\n            toggles.forEach(v => GSDOM.toggleClass(target, v));\r\n        } else {\r\n            if (target[me.#symbol]) toggles = toggles.slice().reverse();\r\n            for (const v of toggles) {\r\n                await GSUtil.timeout(tout);\r\n                GSDOM.toggleClass(target, v);\r\n            }\r\n            target[me.#symbol] = !target[me.#symbol];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Calls a function on a target\r\n     * @param {GSElement} host \r\n     * @param {HTMLElement} target \r\n     * @param {Event} evt \r\n     */\r\n    #handleCall(host, target, evt) {\r\n        const val = GSUtil.isJsonString(host.value) ? GSUtil.toJson(host.value) : host.value;\r\n        this.calls.forEach(v => GSFunction.callFunction(target[v], target, true, val || evt));\r\n    }\r\n\r\n    /**\r\n     * Calls a function on a target\r\n     * @param {*} host \r\n     * @param {*} target \r\n     * @param {*} evt \r\n     * @returns \r\n     */\r\n    #handleExec(host, target, evt) {\r\n        if (!this.exec) return;\r\n        try {\r\n            new Function(this.exec).bind(target)(evt);\r\n        } catch (e) {\r\n            GSLog.error(target, e);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Send an event to a target\r\n     * @param {HTMLElement} target \r\n     * @param {Event} evt \r\n     */\r\n    #handleTrigger(target, evt) {\r\n        this.triggers.forEach(v => GSEvents.send(target, v, evt));\r\n    }\r\n\r\n    #handleEvent(host, evt) {\r\n        //host.emit?.(this.event, evt, this.bubbles, this.composed, true);\r\n        GSEvents.send(host, this.event, evt, this.bubbles, this.composed, true);\r\n    }\r\n\r\n    #handleContent(host, target, value, clean = false) {\r\n        const me = this;\r\n        if (value) {\r\n            let src = '';\r\n            const useDef = GSUtil.asBool(value);\r\n            if (useDef) {\r\n                src = GSDOM.fromJsonAsString(me.definition);\r\n            } else {\r\n                src = me.#toHTML(value);\r\n            }\r\n\r\n            const content = GSDOM.parse(src, true);\r\n\r\n            if (!useDef) {\r\n                GSAttr.jsonToAttr(me.definition, content);\r\n            }\r\n\r\n            if (clean) {\r\n                //target.innerHTML = '';\r\n                GSDOM.cleanup(target);\r\n            }\r\n\r\n            content.dataset.gsHashed = me.hashed;\r\n            me.#applyContent(host, target, content);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * Inject HTML to target\r\n     * @param {GSElement} host \r\n     * @param {HTMLElement} target \r\n     */\r\n    #handleInject(host, target) {\r\n        this.#handleContent(host, target, this.inject, false);\r\n    }\r\n\r\n    /**\r\n     * Swap inner HTML on a target\r\n     * @param {HTMLElement} target \r\n     */\r\n    #handleSwap(host, target) {\r\n        this.#handleContent(host, target, this.swap, true);\r\n    }\r\n\r\n    /**\r\n     * Convert value as URL to a tempalte or as a component name to inject\r\n     * @param {String} value \r\n     * @returns {String}\r\n     */\r\n    #toHTML(value = '') {\r\n        return value.indexOf('/') < 0 ? `<${value}></${value}>` : `<gs-template flat src=\"${value}\"></gs-template>`;\r\n    }\r\n\r\n    /**\r\n     * Load HTML template and apply to a target\r\n     * @param {GSElement} host \r\n     * @param {HTMLElement} target \r\n     */\r\n    async #handleTemplate(host, target) {\r\n        const tpl = await GSTemplateCache.loadTemplate(true, this.template, this.template);\r\n        this.#applyTemplate(host, target, tpl);\r\n    }\r\n\r\n    /**\r\n     * Apply htmltemplate to a target\r\n     * @param {GSElement} host \r\n     * @param {HTMLElement} target \r\n     * @param {HTMLTemplateElement} template \r\n     */\r\n    #applyTemplate(host, target, template) {\r\n        const content = GSTemplateCache.clone(template);\r\n        this.#applyContent(host, target, content);\r\n    }\r\n\r\n    /**\r\n     * Apply html template to a target\r\n     * @param {GSElement} host \r\n     * @param {HTMLElement} target \r\n     * @param {HTMLTemplateElement} content \r\n     */\r\n    #applyContent(host, target, content) {\r\n        if (host?.anchor) {\r\n            GSDOM.insertAdjacent(target, content, host.anchor);\r\n        } else {\r\n            GSDOM.appendChild(target, content);\r\n        }\r\n    }\r\n\r\n    attach(name = 'click') {\r\n        const me = this;\r\n        if (!me.#active) {\r\n            GSEvents.on(me.#host, null, name, me.#callback);\r\n            me.#active = true;\r\n        }\r\n    }\r\n\r\n    detach(name = 'click') {\r\n        //GSEvents.detachListeners(this.#host);\r\n        const me = this;\r\n        GSEvents.off(me.#host, null, name, me.#callback);\r\n        me.#active = false;\r\n    }\r\n\r\n    get #symbol() {\r\n        return GSAttributeHandler.#reverse;\r\n    }\r\n\r\n    get targets() {\r\n\r\n        const me = this;\r\n\r\n        // if target not set (element #id), use owner element where to inject actions\r\n        if (!me.target && me.#targetList) {\r\n            return me.#targetList;\r\n        }\r\n\r\n        switch (me.target) {\r\n            case 'this':\r\n            case 'self':\r\n                return [me.#host];\r\n            case 'owner':\r\n                //return [GSDOM.root(me.#host)];\r\n                return [me.#host.parentComponent];\r\n            case 'parent':\r\n                return [me.#host.parentElement];\r\n        }\r\n\r\n        const list = GSDOM.queryAll(document.body, me.target, false, true).filter(el => el.tagName !== 'GS-ITEM');\r\n        if (list.length === 0) list.push(me.#host);\r\n        return list;\r\n    }\r\n\r\n    get host() { return this.#host; }\r\n\r\n    get definition() { return this.#proxy[Symbol.for('#def')]; }\r\n\r\n    get action() { return this.#proxy.action; }\r\n    get anchor() { return this.#proxy.anchor; }\r\n    get attribute() { return this.#proxy.attribute; }\r\n    get exec() { return this.#proxy.exec; }\r\n    get event() { return this.#proxy.event; }\r\n    get bubbles() { return this.#proxy.bubbles; }\r\n    get composed() { return this.#proxy.composed; }\r\n    get call() { return this.#proxy.call; }\r\n    get inject() { return this.#proxy.inject; }\r\n    get property() { return this.#proxy.property; }\r\n    get swap() { return this.#proxy.swap; }\r\n    get target() { return this.#proxy.target; }\r\n    get toggle() { return this.#proxy.toggle; }\r\n    get trigger() { return this.#proxy.trigger; }\r\n    get timeout() { return this.#proxy.timeout; }\r\n    get template() { return this.#proxy.template; }\r\n    get value() { return this.#proxy.value; }\r\n    get hashed() { return this.#proxy.hashed; }\r\n\r\n    get calls() { return this.#proxy.calls; }\r\n    get toggles() { return this.#proxy.toggles; }\r\n    get triggers() { return this.#proxy.triggers; }\r\n\r\n    get attributes() {\r\n        const val = this.#proxy.attribute || '';\r\n        return val.split(/[,;]/g).map(v => v.split('=')).filter(v => GSUtil.isStringNonEmpty(v[0]));\r\n    }\r\n\r\n    get properties() {\r\n        const val = this.#proxy.property || '';\r\n        return val.split(/[,;]/g).map(v => v.split('=')).filter(v => GSUtil.isStringNonEmpty(v[0]));\r\n    }\r\n\r\n    /**\r\n     * Is property value JSON\r\n     */\r\n    get isPropertyJSON() {\r\n        return GSUtil.isJson(this.property);\r\n    }\r\n\r\n    /**\r\n     * Is element attribute value JSON\r\n     */\r\n    get isAttributeJSON() {\r\n        return GSUtil.isJson(this.attribute);\r\n    }\r\n\r\n    /**\r\n     * Wrap any element into data-gs-* handler\r\n     * @param {HTMLElement} el \r\n     * @returns {Proxy}\r\n     */\r\n    static proxify(el) {\r\n        return GSAttr.proxify(el, GSAttributeHandler.DEFINITION);\r\n    }\r\n\r\n    /**\r\n     * Process data-gs-* attributes on a element\r\n     * @param {HTMLElement} el \r\n     * @param {Event} e \r\n     * @returns \r\n     */\r\n    static process(el, e) {\r\n        if (!el?.hasAttribute('data-gs-target')) return;\r\n        let me = el[GSAttributeHandler.#link];\r\n        if (!(me instanceof GSAttributeHandler)) {\r\n            me = new GSAttributeHandler(el);\r\n            el[GSAttributeHandler.#link] = me;\r\n        }\r\n        me.handle(e);\r\n    }\r\n\r\n    /**\r\n     * Create a new attribute handler instance\r\n     * @param {HTMLElement} el \r\n     * @returns \r\n     */\r\n    static create(el) {\r\n        const me = new GSAttributeHandler(el);\r\n        me.attach();\r\n        return me;\r\n    }\r\n\r\n    /**\r\n     * Clone element attributes (GS-ITEM to real WebComponent)\r\n     * @param {HTMLElement} from \r\n     * @param {HTMLElement} to \r\n     * @param {boolean} override If 'false' will skip existing attributes\r\n     */\r\n    static clone(from, to, override = true) {\r\n        const def = GSAttributeHandler.DEFINITION;\r\n        Object.values(def)\r\n            .filter(o => from.hasAttribute(o.attribute))\r\n            .filter(o => override || !to.hasAttribute(o.attribute))\r\n            .forEach(o => to.setAttribute(o.attribute, from.getAttribute(o.attribute)));\r\n    }\r\n\r\n    /**\r\n     * Check if component is bindable to events\r\n     * @param {HTMLElement} el \r\n     * @returns \r\n     */\r\n    static isBindable(el) {\r\n        const def = GSAttributeHandler.DEFINITION;\r\n        return Object.values(def)\r\n            .filter(o => el.hasAttribute(o.attribute))\r\n            .length > 0;\r\n\r\n    }\r\n\r\n    static {\r\n        const def = GSAttributeHandler.DEFINITION;\r\n        Object.values(def).forEach(o => Object.freeze(o));\r\n        Object.freeze(def);\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSBeep class\r\n * @module base/GSBeep\r\n */\r\n\r\n\r\n/**\r\n * A helper class to use browser AudiContext to make tones\r\n * @class\r\n */\r\nexport class GSBeep {\r\n\r\n    static audioCtx = globalThis.AudioContext || globalThis.webkitAudioContext || globalThis.audioContext;\r\n\r\n    /**\r\n     * Helper function to emit a beep sound in the browser using the Web Audio API.\r\n     * \r\n     * @param {number} duration - The duration of the beep sound in milliseconds.\r\n     * @param {number} frequency - The frequency of the beep sound.\r\n     * @param {number} volume - The volume of the beep sound.\r\n     * @param {string} tyoe - The sound type (sine, square, sawtooth, triangle, custom)\r\n     * \r\n     * @returns {Promise} - A promise that resolves when the beep sound is finished.\r\n     */\r\n    static beep(duration = 200, frequency = 440, volume = 1, type = 'sine') {\r\n        return new Promise((resolve, reject) => {\r\n            try{\r\n                if (!GSBeep.isAvailable) return resolve();\r\n                const context = new GSBeep.audioCtx();\r\n                const oscillatorNode = context.createOscillator();\r\n                const gainNode = context.createGain();\r\n                oscillatorNode.connect(gainNode);\r\n\r\n                // Set the oscillator frequency in hertz\r\n                oscillatorNode.frequency.value = frequency;\r\n\r\n                // Set the type of oscillator\r\n                oscillatorNode.type = type;\r\n                gainNode.connect(context.destination);\r\n\r\n                // Set the gain to the volume\r\n                gainNode.gain.value = volume * 0.01;\r\n\r\n                // Start audio with the desired duration\r\n                oscillatorNode.start(context.currentTime);\r\n                oscillatorNode.stop(context.currentTime + duration * 0.001);\r\n\r\n                // Resolve the promise when the sound is finished\r\n                oscillatorNode.onended = () => resolve();                \r\n            }catch(error) {\r\n                reject(error);\r\n            }\r\n        });\r\n    }\r\n\r\n    static get isAvailable() {\r\n        const {isActive, hasBeenActive } =  navigator.userActivation;\r\n        return isActive || hasBeenActive;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSEnvironment class\r\n * @module base/GSEnvironment\r\n */\r\n\r\n/**\r\n * A set of static functions used for detecting browser environment\r\n * such as OS, orientation, browser type etc.\r\n * @class\r\n */\r\nexport class GSEnvironment {\r\n\r\n    /**\r\n     * Check if page is inside mobile device\r\n     * @returns {Boolean}\r\n     */\r\n    static get isMobile() {\r\n        if (navigator.userAgentData) return navigator.userAgentData.mobile;\r\n        return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\r\n    }\r\n\r\n    /** \r\n     * Check if page is inside desktop\r\n     * @returns {Boolean}\r\n     */\r\n    static get isDesktop() {\r\n        return !GSEnvironment.isMobile;\r\n    }\r\n\r\n    static get isWebkit() {\r\n        return /webkit/.test(navigator.userAgent.toLowerCase());\r\n    }\r\n\r\n    /**\r\n     * Check if value match current URL scheme\r\n     * @param {*} val \r\n     */  \r\n    static isValidProtocol(val = '') {\r\n        if (!val) return true;\r\n        return location.protocol.slice(0, -1) === val;\r\n\t}\r\n\r\n    /**\r\n     * Check if value match current browser type\r\n     * @param {String} val \r\n     * @returns {Boolean}\r\n     */\r\n    static isValidBrowser(val = '') {\r\n        if (!val) return true;\r\n        const strVal = val.toLowerCase();\r\n        if (navigator.userAgentData) {\r\n            let sts = false;\r\n            navigator.userAgentData.brands.forEach((v) => {\r\n                if (v.brand.toLowerCase().includes(strVal)) {\r\n                    sts = true;\r\n                }\r\n            });\r\n            return sts;\r\n        }\r\n        const strAgt = navigator.userAgent.toLocaleLowerCase() || '';\r\n        const isEdge = strAgt.includes('edg');\r\n        if (isEdge && strVal.startsWith('edg')) return true;\r\n        return !isEdge && strAgt.includes(strVal);\r\n    }\r\n\r\n    /**\r\n     * Returns if environment matched\r\n     * dektop, mobile, tablet, android, linux, windows, macos, ios\r\n     * @returns {Boolean}\r\n     */\r\n    static isValidEnvironment(val = '') {\r\n\r\n        if (!val) return true\r\n\r\n        if (val === 'desktop') {\r\n            return GSEnvironment.isDesktop;\r\n        }\r\n\r\n        if (val === 'mobile') {\r\n            return GSEnvironment.isMobile;\r\n        }\r\n\r\n        return GSEnvironment.isDevice(val);\r\n    }\r\n\r\n    /**\r\n     * Returns true if device /os is valid\r\n     * @param {String} val \r\n     * @returns {Boolean}\r\n     */\r\n    static isDevice(val = '') {\r\n        if (!val) return true;\r\n        const strVal = val.toLowerCase();\r\n\r\n        if (navigator.userAgentData && navigator.userAgentData.platform) {\r\n            const platform = navigator.userAgentData.platform.toLowerCase();\r\n            return platform === strVal;\r\n        }\r\n\r\n        const strAgt = navigator.userAgent.toLocaleLowerCase();\r\n        return strAgt.indexOf(strVal) > 1;\r\n    }\r\n\r\n    /**\r\n     * Returns if orientation matched\r\n     * horizontal, vertical, portrait, landscape\r\n     * retuns true if value not set\r\n     * \r\n     * @param {String} val\r\n     * @returns {Boolean}\r\n     */\r\n    static isValidOrientation(val = '') {\r\n\r\n        if (!val) return true;\r\n\r\n        if (!screen.orientation) return true;\r\n\r\n        const otype = screen.orientation.type;\r\n\r\n        if (otype.includes('portrait')) {\r\n            return val === 'portrait' || val === 'vertical';\r\n        }\r\n\r\n        if (otype.includes('landscape')) {\r\n            return val === 'landscape' || val === 'horizontal';\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSEnvironment);\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A module loading GSPromise class\r\n * @module base/GSPromise\r\n */\r\n\r\n/**\r\n * A Promise wrapper for timeouted and cancelable events\r\n * @class\r\n */\r\nexport class GSPromise {\r\n\r\n    #signal;\r\n    #callback;\r\n    #callbacks;\r\n    #resolve;\r\n    #reject;\r\n    #promise;\r\n\r\n    /**\r\n     * \r\n     * @param {*} callback \r\n     * @param {Number|AbortSignal} signal Timeout or custom signal\r\n     */\r\n    constructor(callback, signal) {\r\n        const me = this;\r\n        me.#callback = callback;\r\n        me.#signal = signal instanceof AbortSignal ? signal : null;\r\n        me.#signal = GSUtil.isNumber(signal) ? AbortSignal.timeout(signal) : me.#signal;\r\n        me.#callbacks = {\r\n            abort: me.#onAbort.bind(me)\r\n        };\r\n    }\r\n\r\n    await() {\r\n        const me = this;\r\n        if (me.#promise) return me.#promise;\r\n        me.#signal?.addEventListener('abort', me.#callbacks.abort);\r\n        me.#promise = new Promise(me.#wrap.bind(me));\r\n        return me.#promise;\r\n    }\r\n\r\n    get aborted() {\r\n        return this.#signal?.aborted === true;\r\n    }\r\n\r\n    #wrap(resolve, reject) {\r\n        const me = this;\r\n        me.#resolve = resolve;\r\n        me.#reject = reject;\r\n        try {\r\n            me.#callback(me.#onResolve.bind(me), me.#onReject.bind(me));\r\n        } catch (e) {\r\n            me.#clear();\r\n            reject(e);\r\n        }\r\n    }\r\n\r\n    #onAbort() {\r\n        const me = this;\r\n        me.#clear();\r\n        me.#reject(new Error('Promise aborted!'));\r\n    }\r\n\r\n    #onResolve(o) {\r\n        const me = this;\r\n        me.#clear();\r\n        return me.aborted ? null : me.#resolve(o);\r\n    }\r\n\r\n    #onReject(e) {\r\n        const me = this;\r\n        me.#clear();\r\n        return me.aborted ? null : me.#reject(e);\r\n    }\r\n\r\n    #clear() {\r\n        const me = this;\r\n        me.#signal?.removeEventListener('abort', me.#callbacks.abort);\r\n    }\r\n\r\n\t/**\r\n\t * Execute array of promises sequentially\r\n\t * @param {Array<Promise>} ps \r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic sequential(ps) {\r\n\t\tif (!Array.isArray(ps)) ps = [];\r\n\t\treturn ps.reduce((p, next) => p.then(next), Promise.resolve());\r\n\t}\r\n\r\n    static {\r\n        globalThis.GSPromise = GSPromise;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSPromise } from \"./GSPromise.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\n\r\n/**\r\n * A module loading GSEvent class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Class extending native event with additional features\r\n * @Class\r\n */\r\nexport class GSEvent extends EventTarget {\r\n\r\n    #listeners = new Set();\r\n\r\n    #list(type = '', listener) {\r\n        const me = this;\r\n        const list = Array.from(me.#listeners);\r\n        return me.#isFunction(listener) ?\r\n            list.filter(o => o.type === type && o.listener === listener)\r\n            :\r\n            list.filter(o => o.type === type);\r\n    }\r\n\r\n    #isFunction(fn) {\r\n        return typeof fn === 'function';\r\n    }\r\n\r\n    /**\r\n     * Listen for events\r\n     * \r\n     * @param {String} type Event name to be listened\r\n     * @param {Function} listener  Callback to be called on event trigger\r\n     * @param {Number} timeout It event timeout set, return AbortSignal\r\n     * @param {boolean|AbortController} abortable If abortable set, return AbortController\r\n     */\r\n    on(type = '', listener, timeout = 0, abortable = false) {\r\n        if (!type) return reject('Event undefined!');\r\n        const controller = abortable instanceof AbortController ? abortable : (abortable ? new GSAbortController(timeout) : null);\r\n        const signal = controller || timeout == 0 ? controller?.signal : AbortSignal.timeout(timeout);\r\n        this.addEventListener(type, listener, { signal: signal });\r\n        return controller || signal;\r\n    }\r\n\r\n    /**\r\n     * Listen for events only once\r\n     * \r\n     * @param {String} type Event name to be listened\r\n     * @param {Function} listener  Callback to be called on event trigger\r\n     * @param {Number} timeout It event timeout set, return AbortSignal\r\n     * @param {boolean|AbortController} abortable If abortable set, return AbortController\r\n     */\r\n    once(type, listener, timeout = 0, abortable = false) {\r\n        if (!type) return reject('Event undefined!');\r\n        const me = this;\r\n        const wrap = (e) => {\r\n            listener(e);\r\n            me.#listeners.delete(wrap);\r\n        }\r\n        wrap.type = type;\r\n        wrap.listener = listener;\r\n        wrap.timeout = timeout;\r\n        wrap.controller = abortable instanceof AbortController ? abortable : (abortable ? new GSAbortController(timeout) : null);\r\n        wrap.signal = wrap.controller || timeout == 0 ? wrap.controller?.signal : AbortSignal.timeout(timeout);\r\n        me.addEventListener(type, wrap, { once: true, signal: wrap.signal });\r\n        return wrap.controller || wrap.signal;\r\n    }\r\n\r\n    /**\r\n     * Stop listening for events\r\n     * \r\n     * @param {String} type Event name to be listened\r\n     * @param {Function} listener  Callback to be called on event trigger\r\n     */\r\n    off(type = '', listener) {\r\n        this.removeEventListener(type, listener);\r\n    }\r\n\r\n    /**\r\n     * Send event to listeners\r\n     * \r\n     * @param {String} type Event name to be listened\r\n     * @param {Object} data  Data to send \r\n     * @param {Number} delayed Emit event delay in miliseconds\r\n     */\r\n    emit(type = '', data, delayed = 0) {\r\n        const me = this;\r\n        if (delayed === true) {\r\n            return queueMicrotask(() => me.#send(type, data));\r\n        }\r\n        delayed = GSUtil.asNum(delayed, 0);\r\n        if (delayed <= 0) return me.#send(type, data);\r\n        return setTimeout(() => me.#send(type, data), delayed);\r\n    }\r\n\r\n    #send(type = '', data) {\r\n        const evt = new CustomEvent(type, { detail: data });\r\n        return this.dispatchEvent(evt);\r\n    }\r\n\r\n    /**\r\n     * Wait for an event using GSPromise wrapper\r\n     * @param {String} type Event name to be listened\r\n     * @param {AbortSignal} signal Used to abort listener\r\n     * @returns {Event}\r\n    */\r\n    wait(type = '', signal) {\r\n        const me = this;\r\n        const callback = (resolve, reject) => {\r\n            me.once(type, resolve);\r\n        }\r\n        return new GSPromise(callback, signal).await();\r\n    }\r\n\r\n    listen(type, listener) { this.on(type, listener); }\r\n    unlisten(type, listener) { this.off(type, listener); }\r\n\r\n    /**\r\n     * Remove all listeners\r\n     */\r\n    unbind() {\r\n        const me = this;\r\n        Array.from(me.#listeners).forEach(o => {\r\n            super.removeEventListener(o.type, o.listener);\r\n        });\r\n        me.#listeners.clear();\r\n    }\r\n\r\n    addEventListener(type, listener, opt) {\r\n        const me = this;\r\n        if (!me.#isFunction(listener)) return false;\r\n        me.#listeners.add({ type: type, listener: listener });\r\n        return super.addEventListener(type, listener, opt);\r\n    }\r\n\r\n    removeEventListener(type, listener) {\r\n        const me = this;\r\n        const list = me.#list(type, listener);\r\n        list.forEach(o => {\r\n            super.removeEventListener(o.type, o.listener);\r\n            me.#listeners.delete(o);\r\n        });\r\n    }\r\n\r\n    static {\r\n        Object.freeze(GSEvent);\r\n        globalThis.GSEvent = GSEvent;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSEventBus class\r\n * @module base/GSEventBus\r\n */\r\n\r\nimport { GSEvent } from './GSEvent.mjs';\r\n\r\n/**\r\n * Class for handling shared events among components\r\n * Difference from native BroadcastChannel is :\r\n *  - support for multiple named events\r\n *  - does not work across different pages\r\n * @Class\r\n */\r\nexport class GSEventBus {\r\n\r\n    static #registry = new Map();\r\n\r\n    /**\r\n     * Static event emiter. If named event does not exist, create a new one\r\n     * \r\n     * @param {String} name EventBus name\r\n     * @param {String} type Event name\r\n     * @param {Object} data Dat to send\r\n     * \r\n     * @returns {boolean|object}\r\n     */\r\n    static send(name = '', type = '', data) {\r\n        return GSEventBus.register(name).emit(type, data);\r\n    }\r\n\r\n    /**\r\n     * Check if named event bus already exists\r\n     * \r\n     * @param {String} name \r\n     * @returns {Boolean}\r\n     */\r\n    static exist(name = '') {\r\n        return name && GSEventBus.#registry.has(name);\r\n    }\r\n\r\n    /**\r\n     * Register a named event bus. If already exists, will return existsing instance.\r\n     * @param {String} name unique bus name\r\n     * @returns {GSEventBus}\r\n     */\r\n    static register(name = '') {\r\n        if (!GSEventBus.exist(name)) {\r\n            GSEventBus.#registry.set(name, new GSEvent());\r\n        }\r\n        return GSEventBus.#registry.get(name);\r\n    }\r\n\r\n    /**\r\n     * Unregister named event bus from registry.\r\n     * @param {String} name unique buss name\r\n     * @returns {Boolean} State of removal.\r\n     */\r\n    static unregister(name = '') {\r\n        const bus = GSEventBus.#registry.get(name);\r\n        if (bus?.unbind) bus.unbind();\r\n        return GSEventBus.#registry.delete(name);\r\n    }\r\n\r\n    static {\r\n        Object.freeze(GSEventBus);\r\n        globalThis.GSEventBus = GSEventBus;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSGesture class\r\n * @module base/GSGesture\r\n */\r\nimport { GSEvents } from \"./GSEvents.mjs\";\r\n\r\n/**\r\n * A class for handling touch swipe and long press events.\r\n * @class\r\n */\r\nexport class GSGesture {\r\n\r\n    #xDiff = 0;\r\n    #yDiff = 0;\r\n    #xDown = null;\r\n    #yDown = null;\r\n    #element = null;\r\n    #bindings = null;\r\n\r\n    #swipe = false;\r\n    #tap = false;\r\n    #longPress = false;\r\n\r\n    // setTimeout id for longpress\r\n    #delay = 0;\r\n\r\n    // longpress delay\r\n    static timeout = 1500;\r\n\r\n    /**\r\n     * Constructor to attach Gesture featuer to an HTML element\r\n     * @param {HTMLElement} element \r\n     * @param {Boolean} swipe Monitor swipe gesture\r\n     * @param {Boolean} tap Monitor tap gesture\r\n     * @param {Boolean} longPress Monitor long press gesture\r\n     */\r\n    constructor(element, swipe, tap, longPress) {\r\n        const me = this;\r\n        me.#swipe = swipe;\r\n        me.#tap = tap;\r\n        me.#longPress = longPress;\r\n        me.#xDown = null;\r\n        me.#yDown = null;\r\n        me.#element = typeof (element) === 'string' ? document.querySelector(element) : element;\r\n\r\n        me.#bindings = {\r\n            move: me.#handleTouchMove.bind(me),\r\n            start: me.#handleTouchStart.bind(me),\r\n            end: me.#handleTouchEnd.bind(me)\r\n        };\r\n        GSEvents.attach(me.#element, me.#element, 'touchmove', me.#bindings.move, false);\r\n        GSEvents.attach(me.#element, me.#element, 'touchstart', me.#bindings.start, false);\r\n        GSEvents.attach(me.#element, me.#element, 'touchend', me.#bindings.end, false);\r\n    }\r\n\r\n    /**\r\n     * Remove gesture events from element\r\n     */\r\n    unbind() {\r\n        const me = this;\r\n        GSEvents.remove(me.#element, me.#element, 'touchmove', me.#bindings.move);\r\n        GSEvents.remove(me.#element, me.#element, 'touchstart', me.#bindings.start);\r\n        GSEvents.remove(me.#element, me.#element, 'touchend', me.#bindings.end);\r\n    }\r\n\r\n    #handleTouchStart(evt) {\r\n        const me = this;\r\n        me.#xDown = evt.touches[0].clientX;\r\n        me.#yDown = evt.touches[0].clientY;\r\n        if (me.#longPress) setTimeout(me.#onLongPress.bind(me), GSGesture.timeout);\r\n    }\r\n\r\n    #handleTouchEnd(evt) {\r\n        clearTimeout(this.#delay);\r\n    }\r\n\r\n    #handleTouchMove(evt) {\r\n\r\n        const me = this;\r\n\r\n        if (!me.#xDown || !me.#yDown) {\r\n            return;\r\n        }\r\n\r\n        if (!me.#swipe) return;\r\n\r\n        const xUp = evt.touches[0].clientX;\r\n        const yUp = evt.touches[0].clientY;\r\n\r\n        if (me.#longPress) {\r\n            const isMoving = Math.abs(me.#xDiff) > 10 && Math.abs(me.#yDiff) > 10;\r\n            if (isMoving) clearTimeout(me.#delay);\r\n        }\r\n\r\n        me.#xDiff = me.#xDown - xUp;\r\n        me.#yDiff = me.#yDown - yUp;\r\n\r\n        // Most significant.\r\n        const isHorisontal = Math.abs(me.#xDiff) > Math.abs(me.#yDiff);\r\n\r\n        let name = '';\r\n        if (isHorisontal) {\r\n            name = me.#xDiff > 0 ? 'swipe-left' : 'swipe-right';\r\n        } else {\r\n            name = me.#yDiff > 0 ? 'swipe-up' : 'swipe-down';\r\n        }\r\n\r\n        GSEvents.send(me.#element, name, evt);\r\n\r\n        // Reset values.\r\n        me.#xDown = null;\r\n        me.#yDown = null;\r\n    }\r\n\r\n    #onLongPress() {\r\n        GSEvents.send(me.#element, 'long-press');\r\n    }\r\n\r\n    /**\r\n     * Return number of fingers used in touch event\r\n     * @param {Event} e \r\n     * @returns {Number}\r\n     */\r\n    static fingers(e) {\r\n        return e.detail.touches?.length;\r\n    }\r\n\r\n    /**\r\n     * Attach swipe event to a element\r\n     * @param {HTMLElement} element \r\n     * @returns {GSGesture}\r\n     */\r\n    static attach(element, swipe = true, tap = false, longPress = false) {\r\n        return new GSGesture(element, swipe, tap, longPress);\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSAttr } from \"./GSAttr.mjs\";\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\n\r\n/**\r\n * A module loading GSItem class\r\n * @module base/GSItem\r\n */\r\n\r\n/**\r\n * Static class for handling generic configurable tag GS-ITEM\r\n */\r\nexport class GSItem extends HTMLElement {\r\n\r\n\tstatic #tags = ['GS-ITEM', 'TEMPLATE']\r\n\r\n\tstatic properties = {\r\n\t\tactive: { type: Boolean },\r\n\t\tdisabled: { type: Boolean },\r\n\t\tselected: { type: Boolean },\r\n\t\tautofocus: { type: Boolean },\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tGSItem.validate(this);\r\n\t}\r\n\r\n\t/**\r\n\t * Return template content of GS-ITEM element (if exists)\r\n\t * \r\n\t * @param {HTMLElement} el \r\n\t * @returns {String}\r\n\t */\r\n\tget body() {\r\n\t\tlet tpl = GSAttr.get(this, 'template');\r\n\t\tif (tpl) return `<gs-template flat src=\"${tpl}\"></gs-template>`;\r\n\t\ttpl = this.querySelector('template');\r\n\t\treturn tpl?.innerHTML || '';\r\n\t}\r\n\r\n\t/**\r\n\t * Get first level of generic gs-item elements\r\n\t * @param {HTMLElement} root \r\n\t * @returns {Array<HTMLElement>} \r\n\t */\r\n\tget items() {\r\n\t\treturn Array.from(this.children).filter(el => el.tagName == 'GS-ITEM')\r\n\t}\r\n\r\n\tget name() {\r\n\t\treturn GSAttr.get(this, 'name', '');\r\n\t}\r\n\r\n\t/**\r\n\t * Get parent GS-* component\r\n\t */\r\n\tget parentComponent() {\r\n\t\treturn GSDOM.parentAll(this).filter(x => x instanceof GSElement).next()?.value;\r\n\t}\r\n\t\t\r\n\tasJSON(recursive = true) {\r\n\t\treturn GSDOM.toJson(this, recursive);\r\n\t}\r\n\r\n\t/**\r\n\t * Validate that parent element contains only specific childrens\r\n\t * @param {*} own \r\n\t * @param {*} tagName \r\n\t * @returns \r\n\t */\r\n\tstatic validate(own, tagName = 'GS-ITEM') {\r\n\t\treturn GSDOM.validate(own, tagName, GSItem.#tags);\r\n\t}\r\n\r\n\t/**\r\n\t * Get first level of generic gs-item element, used for configuring gs-* components\r\n\t * @param {HTMLElement} root \r\n\t * @returns {Array<HTMLElement>} \r\n\t */\r\n\tstatic collect(root) {\r\n\t\tif (!GSDOM.isHTMLElement(root)) return [];\r\n\t\treturn Array.from(root.children).filter(el => el.tagName == 'GS-ITEM')\r\n\t}\r\n\t\t\r\n\t/**\r\n\t * Convert GS-ITEM list to JSON\r\n\t * @param {HTMLElement} root Element containing GS-ITEM childs \r\n\t * @returns {Array} Arary of JSON objects\r\n\t */\r\n\tstatic toJSON(root) {\r\n\t\treturn GSItem.collect(root).map(el => el.asJSON(true));\r\n\t}\r\n\r\n\t/**\r\n\t * Make GS-ITEM attributes JSON compatible \r\n\t * @param {*} root \r\n\t * @param {*} definition \r\n\t * @returns \r\n\t */\r\n    static proxify(root, definition) {        \r\n        return GSItem.collect(root).map(el => GSAttr.proxify(el, definition));\r\n    }\r\n\r\n\tstatic {\r\n\t\tcustomElements.define('gs-item', GSItem);\r\n\t\tObject.seal(GSItem);\r\n\t}\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\nimport { GSID } from './GSID.mjs';\r\nimport { GSLoader } from './GSLoader.mjs';\r\nimport { GSPromise } from './GSPromise.mjs';\r\nimport { GSEvents } from './GSEvents.mjs';\r\nimport { GSUtil } from './GSUtil.mjs';\r\n\r\n/**\r\n * A module loading GSLocalization class\r\n * @module base/GSLocalization\r\n */\r\n\r\nconst GS_LOCALIZATION_LANGUAGE = globalThis.GS_LOCALIZATION_LANGUAGE || document.documentElement.lang || navigator.language;\r\n\r\n/**\r\n * Generic text translation engine.\r\n * Each JSON langauge file is of 2 files format \r\n * default.json  {'UI text', 'KEY_NAME'}\r\n * language.json {$language$: 'langauge_name', KEY_NAME : 'translation text'}\r\n * @class\r\n */\r\nclass GSLocalizationImpl {\r\n\r\n    #languages = new Map();\r\n    #queue = new Set();\r\n    #queued = false;\r\n\r\n    #url = globalThis.GS_LOCALIZATION_URL;\r\n    #default = GS_LOCALIZATION_LANGUAGE;\r\n    #language;\r\n\r\n    constructor() {\r\n        this.load();\r\n    }\r\n\r\n    /**\r\n     * Default page langugae, use page language, or browser languge if value not set\r\n     */\r\n    get default() {\r\n        return this.#default;\r\n    }\r\n\r\n    set default(val = '') {\r\n        this.#default = val || GS_LOCALIZATION_LANGUAGE;\r\n    }\r\n\r\n    /**\r\n     * Language to which to translate\r\n     */\r\n    get lang() {\r\n        return this.#language || this.default;\r\n    }\r\n\r\n    set lang(val = '') {\r\n        this.#language = val;\r\n    }\r\n\r\n    /**\r\n     * URL from where to load JSON translation documents\r\n     */\r\n    get url() {\r\n        return this.#url;\r\n    }\r\n\r\n    set url(val = '') {\r\n        this.#url = val || globalThis.GS_LOCALIZATION_URL;\r\n    }\r\n\r\n    translate(language = '', value = '') {\r\n        const me = this;\r\n        if (GSUtil.isStringEmpty(language)) return value;\r\n        if (!me.#languages.has(language)) {\r\n            me.load(language);\r\n            return value;\r\n        }\r\n        const deft = me.#getLanguage('default');\r\n        const lang = me.#getLanguage(language);\r\n        const texthash = deft.get(GSID.hashCode(value));\r\n        return texthash ? lang.get(texthash) || value : value;\r\n    }\r\n\r\n    reset() {\r\n        const me = this;\r\n        me.#default = GS_LOCALIZATION_LANGUAGE;\r\n        me.#language = undefined;\r\n        me.load();\r\n    }\r\n\r\n    load(language = 'default') {\r\n        const me = this;\r\n        if (GSUtil.isStringEmpty(language)) return;\r\n        if (GSUtil.isStringEmpty(me.url)) return;\r\n        if (me.#languages.has(language)) return;\r\n        me.#queue.add(language);\r\n        if (me.#queued) return;\r\n        me.#queued = true;\r\n        queueMicrotask(async () => {\r\n            const promises = Array.from(me.#queue.values()).map(l => me.loadWait(l));\r\n            await GSPromise.sequential(promises);\r\n            me.#queued = false;\r\n        });\r\n\r\n    }\r\n\r\n    async loadWait(language) {\r\n        const me = this;\r\n        if (GSUtil.isStringEmpty(language)) return;\r\n        if (GSUtil.isStringEmpty(me.url)) return;\r\n        const headers = {\r\n            'Cache-Control': 'no-cache',\r\n            'Pragma': 'no-cache'\r\n        };\r\n        const url = GSLoader.normalizeURL(`${me.url}/${language}.json`);\r\n        let res = await GSLoader.loadSafe(url, 'GET', headers, true);\r\n        if (!res && language.indexOf('-') > 0) res = await me.loadWait(language.split('-')[0]);\r\n        if (!res) return false;\r\n        me.#queue.delete(language);\r\n        me.#store(language, res);\r\n    }\r\n\r\n    /**\r\n     * Store object properties as set of key-value pairs,\r\n     * keys are not stores as name, but as hash calc\r\n     * values double stored as a hash-key/value and hash-value/hash-key\r\n     * \r\n     * @param {string} lang \r\n     * @param {object} obj \r\n     * @returns \r\n     */\r\n    #store(lang, obj) {\r\n        if (!(obj && lang)) return false;\r\n        const isDefault = lang === 'default';\r\n        const map = this.#getLanguage(lang);\r\n        Object.entries(obj).forEach((kv) => {\r\n            const hk = GSID.hashCode(kv[0].trim());\r\n            map.set(hk, isDefault ? GSID.hashCode(kv[1]) : kv[1]);\r\n        });\r\n        GSEvents.send(window, 'gs-language', { details: lang });\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Get language map. Create a new one if not found.\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    #getLanguage(val = '') {\r\n        const me = this;\r\n        if (!me.#languages.has(val)) {\r\n            me.#languages.set(val, new Map());\r\n        }\r\n        return me.#languages.get(val);\r\n    }\r\n\r\n}\r\n\r\nexport const GSLocalization = new GSLocalizationImpl();","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSPopper class\r\n * @module base/GSPopper\r\n */\r\n\r\nimport { GSLog } from \"./GSLog.mjs\";\r\nimport { GSCSSMap } from \"./GSCSSMap.mjs\";\r\nimport { GSDynamicStyle } from \"./GSDynamicStyle.mjs\";\r\n\r\n/**\r\n * A generic set of static functions used across GS WebComponents framework\r\n * used for placing elements at fixed positions.\r\n * Also used to replace Bootstrap popper.\r\n * @class\r\n */\r\nexport class GSPopper {\r\n\r\n\t/**\r\n\t * A simple wrapper to get element DOMRect\r\n\t * @param {HTMLElement} el \r\n\t * @returns {DOMRect}\r\n\t */\r\n\tstatic asRect(el) {\r\n\t\treturn el.getBoundingClientRect();\r\n\t}\r\n\r\n\t/**\r\n\t * Get element offset position\r\n\t * Returns absolute position {left:0, top:0, width:0, height:0,centeY:0 centerX:0}\r\n\t * @param {HTMLElement} el \r\n\t * @returns {Object} \r\n\t */\r\n\tstatic getOffset(el) {\r\n\t\tconst rect = GSPopper.asRect(el);\r\n\t\tconst sx = window.scrollX;\r\n\t\tconst sy = window.scrollY;\r\n\t\tconst obj = {\r\n\t\t\tleft: rect.left + sx,\r\n\t\t\tright: rect.right + sx,\r\n\t\t\ttop: rect.top + sy,\r\n\t\t\tbottom: rect.bottom + sy,\r\n\t\t\theight: rect.height,\r\n\t\t\twidth: rect.width,\r\n\t\t\tx: rect.x + sx,\r\n\t\t\ty: rect.y + sy\r\n\t\t};\r\n\t\tobj.centerX = obj.left + (obj.width / 2);\r\n\t\tobj.centerY = obj.top + (obj.height / 2);\r\n\t\treturn obj;\r\n\t}\r\n\r\n\t/**\r\n\t * Return element position and size without padding\r\n\t * Returned objext is the same format as native getBoundingRect\r\n\t * @param {HTMLElement} element \r\n\t * @returns {Object} \r\n\t */\r\n\tstatic boundingRect(element, calcPadding) {\r\n\r\n\t\tconst rect = GSPopper.asRect(element);\r\n\t\tconst padding = GSPopper.elementPadding(calcPadding ? element : null);\r\n\r\n\t\tconst paddingX = padding.x;\r\n\t\tconst paddingY = padding.y;\r\n\r\n\t\tconst elementWidth = element.clientWidth - paddingX;\r\n\t\tconst elementHeight = element.clientHeight - paddingY;\r\n\r\n\t\tconst elementX = rect.left + padding.left;\r\n\t\tconst elementY = rect.top + padding.top;\r\n\r\n\t\tconst centerX = (elementWidth / 2) + elementX;\r\n\t\tconst centerY = elementY + (elementHeight / 2);\r\n\r\n\t\treturn {\r\n\t\t\twidth: elementWidth,\r\n\t\t\theight: elementHeight,\r\n\t\t\ttop: elementY,\r\n\t\t\tleft: elementX,\r\n\t\t\tx: elementX,\r\n\t\t\ty: elementY,\r\n\t\t\tcenterX: centerX,\r\n\t\t\tcenterY: centerY\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * Calculate element padding\r\n\t * @param {HTMLElement} element \r\n\t * @returns {Object}\r\n\t */\r\n\tstatic elementPadding(element) {\r\n\r\n\t\tconst obj = {\r\n\t\t\tleft: 0,\r\n\t\t\tright: 0,\r\n\t\t\ttop: 0,\r\n\t\t\tbottom: 0,\r\n\t\t\tx: 0,\r\n\t\t\ty: 0\r\n\t\t};\r\n\r\n\t\tconst isEl = element instanceof HTMLElement;\r\n\t\tif (!isEl) return obj;\r\n\t\tconst css = GSCSSMap.getComputedStyledMap(element);\r\n\r\n\t\tobj.left = css.asNum('padding-left');\r\n\t\tobj.right = css.asNum('padding-right');\r\n\t\tobj.top = css.asNum('padding-top');\r\n\t\tobj.bottom = css.asNum('padding-bottom');\r\n\t\tobj.x = obj.left + obj.right;\r\n\t\tobj.y = obj.top + obj.bottom;\r\n\r\n\t\treturn obj;\r\n\t}\r\n\r\n\t/**\r\n\t * Fixed positioning on a viewport.\r\n\t * @param {String} placement Location on target element top|bottom|left|right\r\n\t * @param {HTMLElement} source Element to show\r\n\t * @param {HTMLElement} target Element location at which to show\r\n\t * @param {Boolean} arrow if true, will calculate arrow position\r\n\t * @returns {void}\r\n\t */\r\n\tstatic popupFixed(placement = 'top', source, target, arrow) {\r\n\r\n\t\tif (!(source && target)) return false;\r\n\r\n\t\tconst pos = GSPopper.#fromPlacement(placement);\r\n\r\n\t\tif (!GSPopper.#isPlacementValid(pos)) {\r\n\t\t\tGSLog.warn(source, `Invalid popover position: ${placement}!`);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst style = GSDynamicStyle.dynamicStyle(source);\r\n\t\tif (!style) return;\r\n\r\n\t\tconst css = {\r\n\t\t\tposition: 'fixed',\r\n\t\t\ttop: '0px',\r\n\t\t\tleft: '0px',\r\n\t\t\tmargin: '0px',\r\n\t\t\tpadding: '0px',\r\n\t\t\ttransform: '',\r\n\t\t\ttranslate: ''\r\n\t\t};\r\n\r\n\t\tObject.assign(style, css);\r\n\r\n\t\tconst offh = source.clientHeight / 2;\r\n\t\tconst offw = source.clientWidth / 2;\r\n\r\n\t\tconst rect = GSPopper.boundingRect(target, arrow instanceof HTMLElement);\r\n\t\tconst arect = GSPopper.#updateArrow(source, arrow, pos);\r\n\r\n\t\tconst obj = {\r\n\t\t\tx: rect.centerX,\r\n\t\t\ty: rect.centerY,\r\n\t\t\toffH: offh,\r\n\t\t\toffW: offw,\r\n\t\t\tsrcH: source.clientHeight,\r\n\t\t\tsrcW: source.clientWidth\r\n\t\t}\r\n\r\n\t\tGSPopper.#calcFixed(pos, obj, rect, arect);\r\n\t\tstyle.translate = `${obj.x}px ${obj.y}px`;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Place element around target element. Bootstrap support for popup etc.\r\n\t * @param {String} placement Location on target element top|bottom|left|right\r\n\t * @param {HTMLElement} source Element to show\r\n\t * @param {HTMLElement} target Element location at which to show\r\n\t * @param {Boolean} arrow if true, will calculate arrow position\r\n\t * @returns {void}\r\n\t */\r\n\tstatic popupAbsolute(placement = 'top', source, target, arrow) {\r\n\r\n\t\tif (!(source && target)) return false;\r\n\r\n\t\tconst pos = GSPopper.#fromPlacement(placement);\r\n\r\n\t\tif (!GSPopper.#isPlacementValid(pos)) {\r\n\t\t\tGSLog.warn(source, `Invalid popover position: ${placement}!`);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst style = GSDynamicStyle.dynamicStyle(source);\r\n\t\tconst astyle = GSDynamicStyle.dynamicStyle(arrow);\r\n\t\tif (!style) return;\r\n\t\t\r\n\t\tconst css = {\r\n\t\t\tinset: GSPopper.#inset(pos),\r\n\t\t\tposition: 'absolute',\r\n\t\t\tmargin: '0px',\r\n\t\t\ttop: '0px',\r\n\t\t\tleft: '0px',\r\n\t\t\twidth: 'max-content',\r\n\t\t\theight: 'max-content',\t\t\t\r\n\t\t\ttransform: '',\r\n\t\t\ttranslate: ''\r\n\t\t};\r\n\r\n\t\tObject.assign(style, css);\r\n\t\tastyle.position = 'absolute';\r\n\r\n\t\tconst srect = GSPopper.asRect(source);\r\n\t\tconst arect = GSPopper.asRect(arrow);\r\n\t\tconst offset = GSPopper.getOffset(target);\r\n\r\n\t\tconst obj = {\r\n\t\t\tx: offset.centerX,\r\n\t\t\ty: offset.centerY\r\n\t\t}\r\n\r\n\t\tconst arr = {\r\n\t\t\tx: (srect.width / 2) - (arect.width / 2),\r\n\t\t\ty: (srect.height / 2) - (arect.height / 2)\r\n\t\t}\r\n\r\n\t\tGSPopper.#calcAbsolute(pos, obj, arr, srect, arect, offset);\r\n\r\n\t\tconst aopt = {\r\n\t\t\ttranslate: `${arr.x}px ${arr.y}px`,\r\n\t\t\ttop: arr.top ? arr.top : '',\r\n\t\t\tleft: arr.left ? arr.left : ''\r\n\t\t}\r\n\r\n\t\tconst opt = {\r\n\t\t\ttranslate : `${obj.x}px ${obj.y}px`\r\n\t\t};\r\n\r\n\t\tObject.assign(style, opt);\r\n\t\tObject.assign(astyle, aopt);\r\n\t}\r\n\r\n\tstatic #calcAbsolute(pos, obj, arr, srect, arect, offset) {\r\n\t\tif (pos.isTop) {\r\n\t\t\tarr.y = 0;\r\n\t\t\tarr.left = '0px';\r\n\t\t\tobj.x = obj.x - (srect.width / 2);\r\n\t\t\tobj.y = -1 * (srect.bottom - offset.top + arect.height);\r\n\t\t} else if (pos.isBottom) {\r\n\t\t\tarr.y = 0;\r\n\t\t\tarr.left = '0px';\r\n\t\t\tobj.x = obj.x - (srect.width / 2);\r\n\t\t\tobj.y = offset.bottom + arect.height;\r\n\t\t} else if (pos.isStart) {\r\n\t\t\tarr.x = 0;\r\n\t\t\tarr.top = '0px';\r\n\t\t\tobj.x = -1 * (srect.right - offset.left + arect.width);\r\n\t\t\tobj.y = obj.y - (srect.height / 2);\r\n\t\t} else if (pos.isEnd) {\r\n\t\t\tarr.x = 0;\r\n\t\t\tarr.top = '0px';\r\n\t\t\tobj.x = offset.right + arect.width;\r\n\t\t\tobj.y = obj.y - (srect.height / 2);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic #calcFixed(pos, obj, trect, arect) {\r\n\t\tif (pos.isTop) {\r\n\t\t\tobj.y = trect.top - obj.srcH - arect.size;\r\n\t\t\tobj.x = obj.x - obj.offW;\r\n\t\t} else if (pos.isBottom) {\r\n\t\t\tobj.y = trect.top + trect.height + arect.size;\r\n\t\t\tobj.x = obj.x - obj.offW;\r\n\t\t} else if (pos.isStart) {\r\n\t\t\tobj.x = trect.left - obj.srcW - arect.size;\r\n\t\t\tobj.y = obj.y - obj.offH + arect.size;\r\n\t\t} else if (pos.isEnd) {\r\n\t\t\tobj.x = trect.left + trect.width + arect.size;\r\n\t\t\tobj.y = obj.y - obj.offH + arect.size;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic #inset(obj) {\r\n\t\tif (obj.isTop) {\r\n\t\t\treturn 'auto auto 0px 0px';\r\n\t\t} else if (obj.isBottom) {\r\n\t\t\treturn '0px auto auto 0px';\r\n\t\t} else if (obj.isStart) {\r\n\t\t\treturn '0px 0px auto auto';\r\n\t\t} else if (obj.isEnd) {\r\n\t\t\treturn '0px auto auto 0px';\r\n\t\t}\r\n\t}\r\n\r\n\tstatic #isPlacementValid(obj) {\r\n\t\treturn obj.isStart || obj.isEnd || obj.isTop || obj.isBottom;\r\n\t}\r\n\r\n\tstatic #fromPlacement(placement) {\r\n\t\treturn {\r\n\t\t\tisStart: placement == 'start' || placement == 'left',\r\n\t\t\tisEnd: placement == 'end' || placement == 'right',\r\n\t\t\tisTop: placement == 'top',\r\n\t\t\tisBottom: placement == 'bottom'\r\n\t\t}\r\n\t}\r\n\r\n\tstatic #updateArrow(element, arrow, pos) {\r\n\r\n\t\tif (!arrow) return { x: 0, y: 0, size: 0, width: 0, height: 0 };\r\n\r\n\t\tlet shift = 0;\r\n\t\tconst erect = GSPopper.boundingRect(element);\r\n\t\tconst arect = GSPopper.boundingRect(arrow);\r\n\r\n\t\tconst size = pos.isStart || pos.isEnd ? arect.width : arect.height;\r\n\r\n\t\tconst arrowPosW = (erect.width / 2) - (size / 2);\r\n\t\tconst arrowPosH = (erect.height / 2) - (size / 2);\r\n\r\n\t\tarect.size = size;\r\n\r\n\t\tconst opt = {};\r\n\r\n\t\topt.position = 'absolute';\r\n\r\n\t\tif (pos.isStart || pos.isEnd) {\r\n\t\t\topt.left = '';\r\n\t\t\topt.top = '0px';\r\n\t\t\tshift = 0; //pos.isStart ? size : -1 * size;\r\n\t\t\topt.translate = `${shift}px ${arrowPosH / 2}px`;\r\n\t\t} else {\r\n\t\t\topt.top = '';\r\n\t\t\topt.left = '0px';\r\n\t\t\tshift = 0; //pos.isTop ? size : -1 * size;\r\n\t\t\topt.translate = `${arrowPosW}px ${shift}px`;\r\n\t\t}\r\n\r\n\t\tGSDynamicStyle.applyDynamicStyle(arrow, opt);\r\n\r\n\t\treturn arect;\r\n\t}\r\n\r\n\tstatic {\r\n\t\tObject.seal(GSPopper);\r\n\t\tglobalThis.GSPopper = GSPopper;\r\n\t}\r\n}\r\n\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSFunction } from \"./GSFunction.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSCSSMap } from \"./GSCSSMap.mjs\";\r\n\r\n/**\r\n * Proxy class to handle chained css.\r\n * Used internally, see GSQuery class.\r\n */\r\nexport class GSQueryCSS {\r\n\r\n    #map = null;\r\n\r\n    constructor(element) {\r\n        if (!GSDOM.isHTMLElement(element)) throw new Error('Only HTMLElement type allowed!');\r\n        this.#map = new GSCSSMap(element);\r\n    }\r\n\r\n    #isFunc(property) {\r\n        return GSFunction.hasFunction(this.#map, property);\r\n    }\r\n\r\n    get(object, property, receiver) {\r\n        return (value, dft) => {\r\n            const me = this;\r\n            if (GSUtil.isNull(value)) return me.#map.get(property);\r\n            if (me.#isFunc(property)) return me.#map[property](value, dft);\r\n            object[property] = value;\r\n            return receiver;\r\n        }\r\n    }\r\n\r\n    static wrap(element) {\r\n        return new Proxy(element.style, new GSQueryCSS(element));\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSQueryCSS } from \"./GSQueryCSS.mjs\";\r\n\r\n/**\r\n * Proxy class for wrapping HTMLElement, allowing to use GS query across shadow dom\r\n * and css operations for easier property get /set\r\n * \r\n * const el = GSQuery.wrap(document.body);\r\n * el.query('div') // query across shadow dom\r\n * el.css = {width:'100px'} // easier way to set css\r\n * \r\n * // chained css property setup\r\n * el.css.width('100px').background('red')\r\n * \r\n * // retrieve calculated value\r\n * console.log(el.css.background)\r\n * console.log(el.css.asNum('width'))\r\n */\r\nexport class GSQuery {\r\n\r\n    #css = null;\r\n\r\n    constructor(element) {\r\n        if (!Array.isArray(element)) this.#css = GSQueryCSS.wrap(element);\r\n    }\r\n\r\n    get(object, property) {\r\n        if (property === 'css') return this.#css;\r\n        if (property === 'query') {\r\n            return (value, all, shadow) => {\r\n                const el = GSDOM.query(object, value, all, shadow);\r\n                return GSQuery.wrap(el);\r\n            }\r\n        }\r\n        if (property === 'queryAll') {\r\n            return (value, all, shadow) => {\r\n                const el = GSDOM.queryAll(object, value, all, shadow);\r\n                return GSQuery.wrap(el);\r\n            }\r\n        }\r\n        return object[property];\r\n    }\r\n\r\n    set(object, property, value) {\r\n        switch (property) {\r\n            case 'css':\r\n                if (Array.isArray(object)) {\r\n                    object.forEach(element => element[property] = value);\r\n                } else {\r\n                    GSDOM.css(object, value);\r\n                }\r\n                break;\r\n            default:\r\n                object[property] = value;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    static instance(node) {\r\n        return new Proxy(node, new GSQuery(node));\r\n    }\r\n\r\n    static wrap(node) {\r\n        if (GSDOM.isHTMLElement(node)) return GSQuery.instance(node);\r\n        if (!Array.isArray(node)) return node;\r\n        node = node.map(element => GSQuery.wrap(element));\r\n        return GSQuery.instance(node);\r\n    }\r\n\r\n    static all(own, qry, all, shadow) {\r\n        return GSQuery.wrap(GSDOM.queryAll(own, qry, all, shadow));\r\n    }\r\n\r\n    static first(own, qry, all, shadow) {\r\n        return GSQuery.wrap(GSDOM.query(own, qry, all, shadow));\r\n    }\r\n\r\n    static {\r\n        Object.freeze(GSQuery);\r\n        globalThis.GSQuery = GSQuery;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSRouter class\r\n * @module base/GSRouter\r\n */\r\n\r\nimport { GSLog } from \"./GSLog.mjs\";\r\nimport { GSUtil } from \"./GSUtil.mjs\";\r\nimport { GSData } from \"./GSData.mjs\";\r\nimport { GSDOM } from \"./GSDOM.mjs\";\r\nimport { GSEvents } from \"./GSEvents.mjs\";\r\nimport { GSLoader } from \"./GSLoader.mjs\";\r\nimport { GSAttributeHandler } from \"./GSAttributeHandler.mjs\";\r\n\r\n/**\r\n * Class for handling hash based routing.\r\n * Class uses GSAttributeHandler and optional JSON definition to handle routing.\r\n * \r\n * Use globalThis.GS_ROUTER_URL before loading this module to define JSON definition file location\r\n * @Class\r\n */\r\nexport class GSRouter {\r\n\r\n    #owner = null;\r\n    #logging = true;\r\n    #enabled = false;\r\n    #hashCallback = null;\r\n    #cache = null;\r\n    #definition = {};\r\n\r\n    constructor(owner) {\r\n        const me = this;\r\n        me.#owner = owner;\r\n        me.#cache ??= new Map();\r\n        me.#hashCallback = me.#onHashChange.bind(me);\r\n    }\r\n\r\n    /**\r\n     * Loda JSON definition for routing from JSON document.\r\n     * @param {string} url \r\n     * @returns \r\n     */\r\n    async loadDefinition(url) {\r\n        return GSLoader.getRouter(url);\r\n    }\r\n\r\n    /**\r\n     * Initialize routing from provided URL\r\n     * @param {string} url \r\n     * @param {number} wait in ms\r\n     */\r\n    async initialize(url, wait = 0) {\r\n        const me = this;\r\n        me.#cache.clear();        \r\n        if (GSUtil.isStringNonEmpty(url)) {\r\n            me.#definition = await me.loadDefinition(url);\r\n        }\r\n        if (wait > 0) {\r\n            await GSEvents.waitPageLoad(null, null, null, wait);\r\n        }\r\n        me.enable();\r\n        me.#onHashChange();        \r\n    }\r\n\r\n    /**\r\n     * Enable routing\r\n     */\r\n    enable() {\r\n        if (this.#enabled) return;\r\n        GSEvents.on(globalThis, null, 'hashchange', this.#hashCallback);\r\n        this.#enabled = true;\r\n    }\r\n\r\n    /**\r\n     * Disable routing\r\n     */\r\n    disable() {\r\n        GSEvents.off(globalThis, null, 'hashchange', this.#hashCallback);\r\n        this.#enabled = false;\r\n    }\r\n\r\n    /**\r\n     * Register a single route with options\r\n     * @param {string} route Abstract url for a route\r\n     * @param {Object} options \r\n     */\r\n    register(route, options) {\r\n        this.#definition[route] = options;\r\n    }\r\n\r\n    /**\r\n     * Unregister a single route\r\n     * @param {string} route \r\n     */\r\n    unregister(route) {\r\n        delete this.#definition[route];\r\n    }\r\n\r\n    /**\r\n     * Get URL hashbang without hash\r\n     */\r\n    get hash() {\r\n        return location.hash.slice(1);\r\n    }\r\n\r\n    /**\r\n     * Return routing definition object\r\n     */\r\n    get definition() {\r\n        return GSData.deepClone(this.#definition);\r\n    }\r\n\r\n    get log() {\r\n        return this.#logging;\r\n    }\r\n\r\n    set log(val) {\r\n        this.#logging = GSUtil.asBool(val);\r\n    }\r\n\r\n    #onHashChange(e) {\r\n        const me = this;\r\n        const hash = me.hash;\r\n        let px = me.#cache.get(hash);\r\n        if (!px) {   \r\n            px = me.#proxify();         \r\n            if (px) me.#cache.set(hash, px);\r\n        }\r\n        // 1. 31.07.2025.\r\n        // GSAttributeHandler.process(px);\r\n        px?.handle(e);\r\n    }\r\n\r\n    #proxify() {\r\n        let px = undefined;\r\n        const me = this;\r\n        const hash = me.hash;\r\n        const def = me.#definition[\"#def\"] || {};\r\n        const defaults = me.#definition[\"#defaults\"] || {};\r\n        const route = me.#definition[hash];\r\n        if (route) {\r\n            const el = GSDOM.fromJson(Object.assign({}, route, def, defaults));\r\n            el.dataset.gsHashed = true;\r\n            // 1. 31.07.2025.\r\n            //px = GSAttributeHandler.proxify(el);\r\n            px = new GSAttributeHandler(el, me.#owner);\r\n        } else if (me.#logging) {\r\n            GSLog.warn(null, `No routing definition found for: ${hash}`);\r\n        }\r\n        return px;\r\n    }\r\n\r\n    static {\r\n        if (globalThis.GS_DEFINITION_URL) {\r\n            new GSRouter().initialize(globalThis.GS_DEFINITION_URL, globalThis.GS_ROUTER_WAIT);\r\n        }\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSTheme class\r\n * @module base/GSTheme\r\n */\r\n\r\n/**\r\n * Switch between dark and light mode\r\n * @Class\r\n */\r\nexport class GSTheme {\r\n\r\n    static #STORAGE = 'gs-theme-mode';\r\n\r\n    /**\r\n     * Changes the theme to 'dark mode' and save settings to local stroage.\r\n     * Basically, replaces/toggles every CSS class that has '-light' class with '-dark'\r\n     * @param {HTMLElement} el \r\n     */\r\n    static darkMode(el) {\r\n        GSTheme.#switch(el, 'light', 'dark');\r\n    }\r\n\r\n    /**\r\n     * Changes the theme to 'light mode' and save settings to local stroage.\r\n     * @param {HTMLElement} el \r\n     */\r\n    static lightMode(el) {\r\n        GSTheme.#switch(el, 'dark', 'light');\r\n    }\r\n\r\n    static #switch(el, from = 'light', to = 'dark') {\r\n\r\n        const root = el || document.body;\r\n\r\n        // TODO  switch dark/light mode ?!??!? \r\n\r\n        // save last state\r\n        GSTheme.theme = to;\r\n    }\r\n\r\n    static get theme() {\r\n        return localStorage.getItem(GSTheme.#STORAGE);\r\n    }\r\n\r\n    static set theme(val) {\r\n        localStorage.setItem(GSTheme.#STORAGE, val);\r\n        window.dispatchEvent(new CustomEvent('gs-theme', { detail: val }));\r\n        const htmlEl = document.head.parentElement;\r\n        if (val) {\r\n            htmlEl.dataset.bsTheme = val;\r\n        } else {\r\n            delete htmlEl.dataset.bsTheme;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get system default theme by media query\r\n     * @returns {String} dark|light \r\n     */\r\n    static getSystemDefaultTheme() {\r\n        const darkThemeMq = window.matchMedia('(prefers-color-scheme: dark)');\r\n        return darkThemeMq.matches ? 'dark' : 'light';\r\n    }\r\n\r\n    static #onTheme(e) {\r\n        const q = new URLSearchParams(location.hash.slice(1));\r\n        GSTheme.theme = q.get('theme');\r\n    }\r\n\r\n    static #setup() {\r\n        window.addEventListener('hashchange', GSTheme.#onTheme)\r\n        let settings = localStorage.getItem(GSTheme.#STORAGE);\r\n        if (settings == null) {\r\n            settings = GSTheme.getSystemDefaultTheme();\r\n        }\r\n\r\n\r\n        if (settings == 'dark') return GSTheme.darkMode();\r\n        if (settings == 'light') return GSTheme.lightMode();\r\n        // TODO switch\r\n\r\n    }\r\n\r\n    static {\r\n        GSTheme.#setup();\r\n        globalThis.GSTheme = GSTheme;\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/*\r\nconst tree = new BinaryTree(1, 'AB');\r\n\r\ntree.insert(1, 11, 'AC');\r\ntree.insert(1, 12, 'BC');\r\ntree.insert(12, 121, 'BG', { right: true });\r\n\r\n[...tree.preOrderTraversal()].map(x => x.value);\r\n// ['AB', 'AC', 'BC', 'BCG']\r\n\r\n[...tree.inOrderTraversal()].map(x => x.value);\r\n// ['AC', 'AB', 'BC', 'BG']\r\n\r\ntree.value;                // 'AB'\r\ntree.hasChildren;          // true\r\n\r\ntree.find(12).isLeaf;           // false\r\ntree.find(121).isLeaf;          // true\r\ntree.find(121).parent.value;    // 'BC'\r\ntree.find(12).left;             // null\r\ntree.find(12).right.value;      // 'BG'\r\n\r\ntree.remove(12);\r\n\r\n[...tree.postOrderTraversal()].map(x => x.value);\r\n// ['AC', 'AB']\r\n*/\r\n\r\n/**\r\n * Binary Tree Node data holder\r\n */\r\nexport class BinaryTreeNode {\r\n\r\n    constructor(key, value = key, parent = null) {\r\n        this.key = key;\r\n        this.value = value;\r\n        this.parent = parent;\r\n        this.left = null;\r\n        this.right = null;\r\n    }\r\n\r\n    /**\r\n     * Check if both left and right are empty.\r\n     */\r\n    get isLeaf() {\r\n        return this.left === null && this.right === null;\r\n    }\r\n\r\n    /**\r\n     * Check if node has children\r\n     */\r\n    get hasChildren() {\r\n        return !this.isLeaf;\r\n    }\r\n\r\n    /**\r\n     * Check if node is main root node \r\n     */\r\n    get isRoot() {\r\n        return this.parent ? false : true;\r\n    }\r\n\r\n    /**\r\n     * Get main root node\r\n     */\r\n    get root() {\r\n        return this.parent?.root || this;\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * Binary tree implementation\r\n */\r\nexport class BinaryTree extends BinaryTreeNode {\r\n\r\n    constructor(key, value = key) {\r\n        super(key, value);\r\n    }\r\n\r\n    /**\r\n     * Generator method that traverses the binary tree in in-order, \r\n     * using the yield* syntax to recursively delegate traversal to itself.\r\n     * @param {BinaryTreeNode} node \r\n     */\r\n    *inOrderTraversal(node = this) {\r\n        if (node.left) yield* this.inOrderTraversal(node.left);\r\n        yield node;\r\n        if (node.right) yield* this.inOrderTraversal(node.right);\r\n    }\r\n\r\n    /**\r\n     * Generator method that traverses the binary tree in post-order, \r\n     * using the yield* syntax to recursively delegate traversal to itself.\r\n     * @param {BinaryTreeNode} node \r\n     */\r\n    *postOrderTraversal(node = this) {\r\n        if (node.left) yield* this.postOrderTraversal(node.left);\r\n        if (node.right) yield* this.postOrderTraversal(node.right);\r\n        yield node;\r\n    }\r\n\r\n    /**\r\n     * Generator method that traverses the binary tree in pre-order, \r\n     * using the yield* syntax to recursively delegate traversal to itself.\r\n     * @param {BinaryTreeNode} node \r\n     */\r\n    *preOrderTraversal(node = this) {\r\n        yield node;\r\n        if (node.left) yield* this.preOrderTraversal(node.left);\r\n        if (node.right) yield* this.preOrderTraversal(node.right);\r\n    }\r\n\r\n    /**\r\n     * Uses the preOrderTraversal() method to find the given parent node and \r\n     * insert a new child BinaryTreeNode either as the left or right child, \r\n     * depending on the passed options object.\r\n     * @param {*} parentNodeKey \r\n     * @param {*} key \r\n     * @param {*} value \r\n     * @param {*} options \r\n     * @returns {boolean} Return true if data inserted\r\n     */\r\n    insert(\r\n        parentNodeKey,\r\n        key,\r\n        value = key,\r\n        { left, right } = { left: true, right: true }\r\n    ) {\r\n        for (let node of this.preOrderTraversal()) {\r\n            if (node.key === parentNodeKey) {\r\n                const canInsertLeft = left && node.left === null;\r\n                const canInsertRight = right && node.right === null;\r\n                if (!canInsertLeft && !canInsertRight) return false;\r\n                if (canInsertLeft) {\r\n                    node.left = new BinaryTreeNode(key, value, node);\r\n                    return true;\r\n                }\r\n                if (canInsertRight) {\r\n                    node.right = new BinaryTreeNode(key, value, node);\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Uses the preOrderTraversal() method to remove a BinaryTreeNode from the binary tree.\r\n     * @param {*} key \r\n     * @returns \r\n     */\r\n    remove(key) {\r\n        for (let node of this.preOrderTraversal()) {\r\n            if (node.left.key === key) {\r\n                node.left = null;\r\n                return true;\r\n            }\r\n            if (node.right.key === key) {\r\n                node.right = null;\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Uses the preOrderTraversal() method to retrieve the given node in the binary tree.\r\n     * @param {*} key \r\n     * @returns \r\n     */\r\n    find(key) {\r\n        for (let node of this.preOrderTraversal()) {\r\n            if (node.key === key) return node;\r\n        }\r\n        return undefined;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/*\r\nconst list = new DoublyLinkedList();\r\n\r\nlist.insertFirst(1);\r\nlist.insertFirst(2);\r\nlist.insertFirst(3);\r\nlist.insertLast(4);\r\nlist.insertAt(3, 5);\r\n\r\nlist.size;                      // 5\r\nlist.head.value;                // 3\r\nlist.head.next.value;           // 2\r\nlist.tail.value;                // 4\r\nlist.tail.previous.value;       // 5\r\n[...list].map(e => e.value);    // [3, 2, 1, 5, 4]\r\n\r\nlist.removeAt(1);               // 2\r\nlist.getAt(1).value;            // 1\r\nlist.head.next.value;           // 1\r\n[...list].map(e => e.value);    // [3, 1, 5, 4]\r\n\r\nlist.reverse();\r\n[...list].map(e => e.value);    // [4, 5, 1, 3]\r\n\r\nlist.clear();\r\nlist.size;                      // 0\r\n*/\r\n\r\n/**\r\n *  Linear data structure following doubly linked list order of operations.\r\n */\r\nexport class Node {\r\n\r\n    value = null;\r\n    next = null;\r\n    previous = null;\r\n\r\n    constructor(value, next = null, previous = null) {\r\n        this.value = value;\r\n        this.next = next;\r\n        this.previous = previous;\r\n    }\r\n\r\n    /**\r\n     * Use internally only or make sure node is deatached\r\n     */\r\n    release() {\r\n        this.value = undefined;\r\n        this.next = undefined;\r\n        this.previous = undefined;\r\n    }\r\n\r\n    toJSON() {\r\n        return this.value;\r\n    }\r\n}\r\n\r\nexport class DoublyLinkedList {\r\n\r\n    #nodes = [];\r\n\r\n    /**\r\n     * Number of elements in the list\r\n     */\r\n    get size() {\r\n        return this.#nodes.length;\r\n    }\r\n\r\n    /**\r\n     * First element in the list\r\n     */\r\n    get head() {\r\n        return this.size ? this.#nodes[0] : null;\r\n    }\r\n\r\n    /**\r\n     * Last elemet in the list\r\n     */\r\n    get tail() {\r\n        return this.size ? this.#nodes[this.size - 1] : null;\r\n    }\r\n\r\n    /**\r\n     * Create new linked node\r\n     * @param {*} value \r\n     * @param {*} nextNode \r\n     * @param {*} previousNode \r\n     * @returns \r\n     */\r\n    create(value, nextNode, previousNode) {\r\n        return new Node(value, nextNode, previousNode);\r\n    }\r\n\r\n    /**\r\n     * Insert data to the given position in the list\r\n     * @param {*} index \r\n     * @param {*} value \r\n     * @param {*} safe \r\n     * @returns \r\n     */\r\n    insertAt(index, value, safe) {\r\n        if (!this.#validate(index, safe)) return false;\r\n\r\n        const previousNode = this.#nodes[index - 1] || null;\r\n        const nextNode = this.#nodes[index] || null;\r\n        const node = this.create(value, nextNode, previousNode);\r\n\r\n        if (previousNode) previousNode.next = node;\r\n        if (nextNode) nextNode.previous = node;\r\n        this.#nodes.splice(index, 0, node);\r\n    }\r\n\r\n    /**\r\n     * Insert data to the beginning of the list\r\n     * @param {*} value \r\n     */\r\n    insertFirst(value) {\r\n        this.insertAt(0, value);\r\n    }\r\n\r\n    /**\r\n     * Insert data to the end of the list\r\n     * @param {*} value \r\n     */\r\n    insertLast(value) {\r\n        this.insertAt(this.size, value);\r\n    }\r\n\r\n    /**\r\n     * Retrieves the data in the given index\r\n     * @param {Number} index \r\n     * @returns \r\n     */\r\n    getAt(index) {\r\n        return this.#nodes[index];\r\n    }\r\n\r\n    indexOf(val) {\r\n        return this.#nodes.indexOf(val);\r\n    }\r\n\r\n    /**\r\n     * Remove the data at the given index\r\n     * @param {*} index \r\n     * @param {*} safe \r\n     * @returns \r\n     */\r\n    removeAt(index, safe) {\r\n\r\n        if (!this.#validate(index, safe)) return false;\r\n\r\n        const previousNode = this.#nodes[index - 1] || null;\r\n        const nextNode = this.#nodes[index + 1] || null;\r\n\r\n        if (previousNode) previousNode.next = nextNode;\r\n        if (nextNode) nextNode.previous = previousNode;\r\n\r\n        return this.#nodes.splice(index, 1);\r\n    }\r\n\r\n    /**\r\n     * Clear list\r\n     */\r\n    clear(full = true) {\r\n        if (full) this.#nodes.forEach(o => o.release());\r\n        this.#nodes = [];\r\n    }\r\n\r\n    /**\r\n     * Reverse data order\r\n     */\r\n    reverse() {\r\n        this.#nodes = this.#nodes.reduce((acc, { value }) => {\r\n            const nextNode = acc[0] || null;\r\n            const node = new Node(value, nextNode, null);\r\n            if (nextNode) nextNode.previous = node;\r\n            return [node, ...acc];\r\n        }, []);\r\n    }\r\n\r\n    toArray() {\r\n        return this.#nodes.map(e => e.value);\r\n    }\r\n\r\n    toJSON() {\r\n        return this.#nodes;\r\n    }\r\n\r\n    *[Symbol.iterator]() {\r\n        yield* this.#nodes;\r\n    }\r\n\r\n    #validate(index, safe = false) {\r\n        const isInvalid = this.#isInvalidIndex(index);\r\n        if (isInvalid) {\r\n            if (safe) {\r\n                console.log(this.#error());\r\n            } else {\r\n                throw new Error(this.#error());\r\n            }\r\n        }\r\n        return !isInvalid;\r\n    }\r\n\r\n    #isInvalidIndex(index) {\r\n        return !Number.isInteger(index) || index < 0 || index > this.size;\r\n    }\r\n\r\n    #error() {\r\n        return `Invalid index. Current length is ${this.size}.`;\r\n    }\r\n\r\n    /**\r\n     * Convert array to linked list\r\n     * @param {*} data \r\n     * @returns \r\n     */\r\n    static from(data) {\r\n        const list = new DoublyLinkedList();\r\n        if (Array.isArray(data)) data.forEach(v => list.insertLast(v));\r\n        return list;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/*\r\nconst list = new LinkedList(1);\r\n\r\nlist.append(2).append(3).append(4);\r\n\r\n*/\r\n\r\n/**\r\n * Node data holder\r\n */\r\nexport class LinkedList {\r\n\r\n    #value = null;\r\n    #next = null;\r\n    #previous = null;\r\n\r\n    constructor(value) {\r\n        this.#value = value;\r\n    }\r\n\r\n    [Symbol.for('gs-next')](val) {\r\n        this.#next = val;\r\n    }\r\n\r\n    [Symbol.for('gs-prev')](val) {\r\n        this.#previous = val;\r\n    }\r\n\r\n    remove() {\r\n        const me = this;\r\n        me.#previous?.[Symbol.for('gs-next')](me.#next);\r\n        me.#next?.[Symbol.for('gs-prev')](me.#previous);\r\n        return me.#release();\r\n    }\r\n\r\n    delete() {\r\n        return this.remove();\r\n    }\r\n    \r\n    /**\r\n     * Append node after \r\n     * @param {*} node \r\n     */\r\n    append(node) {\r\n\r\n        node = LinkedList.wrap(node);\r\n        node.#next = this.#next;\r\n        node.#previous = this;\r\n        this.#next = node;\r\n        return node;\r\n    }\r\n\r\n    add(node) {\r\n        return this.append(node);\r\n    }\r\n\r\n    /**\r\n     * Insert node before\r\n     * @param {*} node \r\n     */\r\n    insert(node) {\r\n        node = LinkedList.wrap(node);\r\n        node.#previous = this.#previous;\r\n        node.#next = this;\r\n        this.#previous = node;\r\n        return node;\r\n    }\r\n\r\n    update(val) {\r\n        this.#value = val;\r\n        return this;\r\n    }\r\n\r\n    find(cb) {\r\n        return this.iterator.find(cb);\r\n    }\r\n\r\n    filter(cb) {\r\n        return this.iterator.filter(cb);\r\n    }\r\n\r\n    map(cb) {\r\n        return this.iterator.map(cb);\r\n    }\r\n\r\n    forEach(cb) {\r\n        for (let n of this.iterator) {\r\n            cb(n, -1, this);\r\n        }\r\n    }\r\n    \r\n    every(cb) {\r\n        let result = undefined;\r\n        for (let n of this.iterator) {\r\n            result = cb(n, -1, this);\r\n            if (result) break;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    toArray(values = true) {\r\n        return values ? this.asValues : this.asNodes;\r\n    }\r\n\r\n    toJSON() {\r\n        return this.value;\r\n    }\r\n\r\n    /**\r\n     * Use internally only or make sure node is deatached\r\n     */\r\n    #release() {\r\n        this.#value = undefined;\r\n        this.#next = undefined;\r\n        this.#previous = undefined;\r\n        return this;\r\n    }\r\n        \r\n    get head() {\r\n        return this.previous?.head || this;\r\n    }\r\n\r\n    get tail() {\r\n        return this.next?.tail || this;\r\n    }\r\n\r\n    get next() {\r\n        return this.#next;\r\n    }\r\n\r\n    get previous() {\r\n        return this.#previous;\r\n    }\r\n\r\n    get value() {\r\n        return this.#value;\r\n    }\r\n\r\n    set value(val) {\r\n        this.#value = val;\r\n    }    \r\n\r\n    get asValues() {\r\n        return [...this].map(v => v.value);\r\n    }\r\n\r\n    get asNodes() {\r\n        return [...this];\r\n    }\r\n    \r\n    get iterator() {\r\n        return this[Symbol.iterator]();\r\n    }\r\n\r\n    *[Symbol.iterator]() {\r\n        yield this;\r\n        if (this.#next) yield* this.#next.iterator;        \r\n    }\r\n\r\n    static wrap(node) {\r\n        return node instanceof LinkedList ? node : new LinkedList(node);\r\n    }\r\n    \r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n *  Linear data structure following last in, first out (LIFO) order of operations.\r\n */\r\nexport class Stack extends Array {\r\n    \r\n    push(item) {\r\n        this.unshift(item);\r\n    }\r\n\r\n    pop() {\r\n        return this.shift();\r\n    }\r\n\r\n    peek() {\r\n        return this[0];\r\n    }\r\n\r\n    isEmpty() {\r\n        return this.length === 0;\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n *  Linear data structure following first in, first out (FIFO) order of operations.\r\n */\r\nexport class Queue extends Array {\r\n    \r\n    enqueue(item) {\r\n        this.push(item);\r\n    }\r\n\r\n    dequeue() {\r\n        return this.shift();\r\n    }\r\n\r\n    peek() {\r\n        return this[0];\r\n    }\r\n\r\n    isEmpty() {\r\n        return this.length === 0;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Tree Node data holder\r\n */\r\nexport class Tree {\r\n\r\n    value;\r\n\r\n    #key = null;\r\n    #parent = null;\r\n    #children;\r\n\r\n    #folder = false;\r\n    #level = 0;\r\n\r\n    constructor(key, value = key, parent = null, level = 0) {\r\n        this.#key = key;\r\n        this.#parent = parent;\r\n        this.#folder = value?.leaf === false;\r\n        this.#level = parent ? parent.level + 1 : level;\r\n        this.#children = this.#folder ? [] : undefined;\r\n        this.value = value;\r\n    }\r\n\r\n    /**\r\n     * Return tree list from root to this node.\r\n     */\r\n    get subtree() {\r\n        return Array.from(this.up(undefined, false, true, true));\r\n    }\r\n\r\n    get levelID() {\r\n        return this.subtree.map(o => o.level).join('.');\r\n    }\r\n\r\n    /**\r\n     * Unique node canonical form\r\n     */\r\n    get nodeID() {\r\n        //if (this.parent?.level < 0) return this.index;\r\n        return this.subtree.map(o => o.index).join('.');\r\n    }\r\n\r\n    get path() {\r\n        return this.subtree.map(o => o.key).join('/');\r\n    }\r\n\r\n    get index() {\r\n        return this.parent?.nodes.indexOf(this) || 0;\r\n    }\r\n\r\n    get size() {\r\n        return this.#children?.length || -1;\r\n    }\r\n\r\n    get level() {\r\n        return this.#level;\r\n    }\r\n\r\n    /**\r\n     * Check if node is main root node \r\n     */\r\n    get isRoot() {\r\n        return this.parent ? false : true;\r\n    }\r\n\r\n    /**\r\n     * Check if #children is empty\r\n     */\r\n    get isLeaf() {\r\n        return !this.#folder;\r\n    }\r\n\r\n    get isFolder() {\r\n        return this.#folder;\r\n    }\r\n\r\n    /**\r\n     * Check if has #childrens\r\n     */\r\n    get hasChildren() {\r\n        return this.#folder && this.size > 0;\r\n    }\r\n\r\n    /**\r\n     * Get parent node, readonly\r\n     */\r\n    get key() {\r\n        this.#key ??= this.nodeID;\r\n        return this.#key;\r\n    }\r\n\r\n    get nodes() {\r\n        return this.#children;\r\n    }\r\n\r\n    /**\r\n     * Get parent node, readonly\r\n     */\r\n    get parent() {\r\n        return this.#parent;\r\n    }\r\n\r\n    /**\r\n     * Get main root node\r\n     */\r\n    get root() {\r\n        return this.parent?.root || this;\r\n    }\r\n\r\n    /**\r\n     * Check if there are more siblings \r\n     */\r\n    get hasMore() {\r\n        return this.#parent?.size > this.index + 1;\r\n    }\r\n\r\n    get firstChild() {\r\n        return this.hasMore ? this.#children[0] : undefined;\r\n    }\r\n\r\n    get lastChild() {\r\n        return this.hasMore ? this.#children[this.#children.length - 1] : undefined;\r\n    }\r\n\r\n    get next() {\r\n        return this.down(this, false, false).next().value || this.nextSibling || this.parent?.nextSibling;\r\n    }\r\n\r\n    get previous() {\r\n        const node = this.previousSibling;\r\n        return (node?.hasChildren) ? node.lastChild : node || this.up(this, false, false).next().value;\r\n    }\r\n\r\n    get nextSibling() {\r\n        return this.hasMore ? this.#parent.#children[this.index + 1] : undefined;\r\n    }\r\n\r\n    get previousSibling() {\r\n        return this.index > 0 ? this.#parent.#children[this.index - 1] : undefined;\r\n    }\r\n\r\n    /**\r\n     * Clear all #children\r\n     */\r\n    clear() {\r\n        if (this.#children) {\r\n            this.#children.forEach(o => o.release?.());\r\n            this.#children = [];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Used internally, if called externally, \r\n     * make sure node is removed from parent \r\n     */\r\n    release() {\r\n        this.clear();\r\n        this.#key = null;\r\n        this.value = null;\r\n        this.#parent = null;\r\n    }\r\n\r\n    /**\r\n     * Walk down the tree\r\n     * @param {Tree} node starting node\r\n     * @param {Boolean} values yield values instead nodes\r\n     * @param {Boolean} inclusive include self\r\n     * @param {Boolean} reverse Order direction\r\n     * @param {Boolean} flat Navigate all nodes out of subtree\r\n     */\r\n    *down(node = this, values = false, inclusive = true, reverse = false, flat = false) {\r\n        const o = values ? node.value : node;\r\n        if (inclusive && !reverse && node.level > -1) yield o;\r\n        if (node.#children?.length) {\r\n            for (let child of node.#children) {\r\n                yield* this.down(child, values, true, reverse, flat);\r\n            }\r\n        }\r\n        if (flat) {\r\n            const item = node.nextSibling || node.parent.nextSibling;\r\n            if (item) yield* this.down(item, values, true, reverse, flat);\r\n        }\r\n        /*\r\n        */\r\n        if (inclusive && reverse && node.level > -1) yield o;\r\n    }\r\n\r\n    /**\r\n     * Walk up the tree\r\n     * @param {Tree} node starting node\r\n     * @param {Boolean} values yield values instead nodes\r\n     * @param {Boolean} inclusive include self\r\n     * @param {Boolean} reverse Order direction\r\n     */\r\n    *up(node = this, values = false, inclusive = true, reverse = false, flat = false) {\r\n        const o = values ? node.value : node;\r\n        if (inclusive && !reverse && node.level > -1) yield o;\r\n        if (flat) {\r\n            let item = node.previousSibling;\r\n            item = item?.isFolder ? item.lastChild : item;\r\n            if (item) yield* this.up(item, values, true, reverse, flat);\r\n        }        \r\n        if (node.parent) {\r\n            yield* this.up(node.parent, values, true, reverse, flat);\r\n        }\r\n        if (inclusive && reverse && node.level > -1) yield o;\r\n    }\r\n\r\n    /**\r\n     * Walk through all nodes\r\n     * @param {*} node \r\n     */\r\n    walk = this.down;\r\n\r\n    /**\r\n     * Simulate array function \"forEach\"\r\n     * @param {*} callback \r\n     * @param {*} flat If set, will iterate all nodes, otherwise only cildrens and subtrees\r\n     * @param {*} reverse If set, will iterate up the tree\r\n     * @returns \r\n     */\r\n    forEach(callback, flat = false, reverse = false) {\r\n        this.every((node, index) => {\r\n            callback(node, index);\r\n            return true;\r\n        }, flat, reverse);\r\n    }\r\n\r\n    /**\r\n     * Simulate array function \"every\"\r\n     * @param {*} callback \r\n     * @param {*} flat If set, will iterate all nodes, otherwise only cildrens and subtrees\r\n     * @param {*} reverse If set, will iterate up the tree\r\n     * @returns \r\n     */    \r\n    every(callback, flat = false, reverse = false) {\r\n        const it = this.iterate(flat, reverse);\r\n        let sts = true;\r\n        let i = 0;\r\n        for (let node of it) {\r\n            sts = callback(node, i++);\r\n            if (!sts) break;\r\n        }\r\n        return sts;\r\n    }\r\n\r\n    /**\r\n     * Simulate array function \"find\"\r\n     * @param {*} callback \r\n     * @param {*} flat If set, will iterate all nodes, otherwise only cildrens and subtrees\r\n     * @param {*} reverse If set, will iterate up the tree\r\n     * @returns \r\n     */    \r\n    find(callback, flat = false, reverse = false) {\r\n        const it = this.iterate(flat, reverse);\r\n        let i = 0;\r\n        for (let node of it) {\r\n            if (callback(node, i++)) return node;\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    /**\r\n     * Simulate array function \"filter\"\r\n     * @param {*} callback \r\n     * @param {*} flat If set, will iterate all nodes, otherwise only childrens and subtrees\r\n     * @param {*} reverse If set, will iterate up the tree\r\n     * @returns \r\n     */    \r\n    filter(callback, flat, reverse) {\r\n        return [...this.#filtered(callback, flat, reverse)];\r\n    }\r\n\r\n    *#filtered(callback, flat, reverse) {\r\n        const it = this.iterate(flat, reverse);\r\n        for (let node of it) {\r\n            let res = callback(node);\r\n            if (res) yield node;\r\n        }        \r\n    }\r\n\r\n    /**\r\n     * Iterate all nodes\r\n     * @param {boolean} flat If set, will iterate all nodes, otherwise only cildrens and subtrees\r\n     * @param {boolean} reverse If set, will iterate up the tree\r\n     */\r\n    *iterate(flat, reverse) {\r\n        reverse ? yield* this.up(this, false, false, false, flat) : yield* this.down(this, false, false,  false, flat);\r\n    }\r\n\r\n    /**\r\n     * Add a new Tree to the tree.\r\n     * @param {*} key \r\n     * @param {*} value \r\n     * @returns \r\n     */\r\n    append(key, value = key) {\r\n        let newOne = undefined;\r\n        if (key instanceof Tree) {\r\n            key.#parent = this;\r\n            key.#level = this.#level + 1;\r\n            newOne = key;\r\n        } else {\r\n            newOne = new Tree(key, value, this);\r\n        }\r\n        this.#folder = true;\r\n        this.#children ??= [];\r\n        this.#children.push(newOne);\r\n        return newOne;\r\n    }\r\n\r\n    /**\r\n     * Uses the walk() method and Array.prototype.push() \r\n     * to add a new Tree to the tree.\r\n     * @param {*} parentNodeKey \r\n     * @param {*} key \r\n     * @param {*} value \r\n     * @returns \r\n     */\r\n    insert(parentNodeKey, key, value = key) {\r\n        for (let node of this.walk()) {\r\n            if (node.key === parentNodeKey) {\r\n                const newOne = new Tree(key, value, node);\r\n                this.#folder = true;\r\n                this.#children ??= [];\r\n                node.#children.push(newOne);\r\n                return newOne;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Remove node from tree. If key is set, will search for first node with matching key.\r\n     * @param {*} key \r\n     * @returns \r\n     */\r\n    remove(key) {\r\n\r\n        const me = this;\r\n\r\n        if (key) {\r\n            const node = me.findByKey(key);\r\n            node?.remove();\r\n            return node;\r\n        }\r\n\r\n        if (me.isRoot) throw new Error('Root node can\\'t be removed!');\r\n        const node = me.parent;\r\n        const filtered = node.#children.filter(c => c !== me);\r\n        if (filtered.length !== node.#children.length) {\r\n            node.#children = filtered;\r\n            return me;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Uses the walk() method to retrieve the given node in the tree.\r\n     * @param {*} key \r\n     * @returns \r\n     */\r\n    findByKey(key) {\r\n        for (let node of this.walk()) {\r\n            if (node.key === key) return node;\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    /**\r\n     * Convert tree into array list\r\n     * @returns \r\n     */\r\n    flatten(values, inclusive, reverse) {\r\n        return [...this.down(this, values, inclusive, reverse)];\r\n    }\r\n\r\n    /**\r\n     * Load JSON data into tree\r\n     * @param {*} data \r\n     */\r\n    fromJSON(data) {\r\n        if (data) Tree.from(this, data);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Used by JSON.stringify to properly export as JSON\r\n     * @returns \r\n     */\r\n    toJSON() {\r\n        if (this.level < 0) return this.#children?.map(o => o.toJSON()) || {};\r\n        return this.isLeaf ? { key: this.key, value: this.value } :\r\n            {\r\n                key: this.key,\r\n                value: this.value,\r\n                items: this.#children.map(o => o.toJSON())\r\n            };\r\n    }\r\n\r\n    /**\r\n     * Make node iterable\r\n     */\r\n    *[Symbol.iterator]() {\r\n        yield* this.down();\r\n    }\r\n\r\n    /**\r\n     * Convert JSON tree into Linked Tree \r\n     * @param {*} data \r\n     * @returns \r\n     */\r\n    static from(parent, data) {\r\n        const raw = data || parent;\r\n        const hasParent = parent instanceof Tree;\r\n        if (Array.isArray(raw)) {\r\n            if (!hasParent) throw new Error('Parent required when data is array');\r\n            raw.forEach(o => Tree.from(parent, o));\r\n            return parent;\r\n        }\r\n        const { items, ...obj } = raw;\r\n        const tree = new Tree(obj.key, obj, data ? parent : undefined);\r\n        if (hasParent) parent.append(tree);\r\n        if (items) Tree.from(tree, items);\r\n        return tree;\r\n    }\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\n\r\n/**\r\n * A module loading GSAbstractReadWrite class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Generic Class for data read/write for various components such as grid/form/dynamic menu etc.\r\n * @Class\r\n */\r\nexport class DataSelector  {\r\n\r\n    static #SELECT = Symbol('select');\r\n\r\n    /**\r\n     * Store selected record ID\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    static addSelected(val) {\r\n        if (!val) return false;\r\n\r\n        if (Array.isArray(val)) {\r\n            val[DataSelector.#SELECT] = true;\r\n        } else {\r\n            GSUtil.asArray(val).forEach(o => o[DataSelector.#SELECT] = true);\r\n        }\r\n        return val;\r\n    }\r\n\r\n    /**\r\n     * Remove selected record ID\r\n     * @param {*} val \r\n     */\r\n    static removeSelected(val) {\r\n        if (!val) return false;\r\n        delete val[DataSelector.#SELECT];\r\n        return val;\r\n    }\r\n\r\n    /**\r\n     * Remove all selections\r\n     */\r\n    static clearSelected(data) {\r\n        const me = this;\r\n        GSUtil.asArray(data).forEach(o => me.removeSelected(o));\r\n    }\r\n\r\n    /**\r\n     * Return list of all selected record id's\r\n     */\r\n    static getSelected(data = []) {\r\n        const me = this;        \r\n        return me.isSelected(data) || GSUtil.asArray(data).filter(o => me.isSelected(o));\r\n    }\r\n\r\n    /**\r\n     * Check if record id is in list of selected records\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    static isSelected(val) {\r\n        return val ? val[DataSelector.#SELECT] === true : false;\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSEvent } from \"../base/GSEvent.mjs\";\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\n\r\n/**\r\n * A module loading GSReadWriteRegistry class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Global registry for GSAbstractReadWrite instances - data read/write \r\n * @Class\r\n */\r\nclass GSReadWriteRegistryImpl extends GSEvent {\r\n\r\n    static #instance = null;\r\n    static #INTERNAL = Symbol();\r\n\r\n    #handlers = new Map();\r\n\r\n    #map = new Map();\r\n\r\n    constructor(key) {\r\n        if (key != GSReadWriteRegistryImpl.#INTERNAL) throw new Error('Creating new instance not allowed.');\r\n        super();\r\n    }\r\n\r\n    /**\r\n     * Register data handler\r\n     * @param {string} type unique handler name\r\n     * @param {GSReadWriteRegistry} clazz \r\n     */\r\n    addHandler(type, clazz) {        \r\n        this.#handlers.set(type, clazz);\r\n    }\r\n\r\n    /**\r\n     * Unregister data handler\r\n     * @param {string} type unique handler name\r\n     */\r\n    removeHandler(type) {        \r\n        this.#handlers.delete(type);\r\n    }\r\n\r\n    /**\r\n     * Get registered handler by name\r\n     * @param {string} type unique handler name\r\n     */    \r\n    getHandler(type) {\r\n        return this.#handlers.get(type);\r\n    }\r\n\r\n    /**\r\n     * Initialize data handler instance\r\n     * @param {string} type unique handler name\r\n     * @param {string} name unique instance name\r\n     * @param {GSReadWriteRegistry} clazz \r\n     */    \r\n    newHandler(type, name, enabled) {\r\n        const clazz = this.getHandler(type);\r\n        return clazz ? new clazz(name, enabled) : undefined;\r\n    }\r\n\r\n    /**\r\n     * Register GSAbstractReadWrite instance or inherited classes\r\n     * @param {GSAbstractReadWrite} obj \r\n     */\r\n    register(obj) {\r\n        const me = this;\r\n        me.#verify(obj);\r\n        const cache = me.find(obj.id);\r\n        if (cache == obj) return;\r\n        if (cache) throw new Error(`Key (${obj.id}) already exist in read/write registry!`);\r\n        me.#map.set(obj.id, obj);\r\n        me.emit(`register-${obj.id}`, obj);\r\n        me.emit(`register`, obj);\r\n    }\r\n\r\n    /**\r\n     * Unregister GSAbstractReadWrite instance or inherited classes\r\n     * @param {GSAbstractReadWrite} obj \r\n     * @returns {boolean} Deletion status\r\n     */\r\n    unregister(obj) {\r\n        const me = this;\r\n        if (GSUtil.isString(obj)) obj = me.find(obj);\r\n        me.#verify(obj);\r\n        const sts = me.#map.delete(obj.id);\r\n        if (sts) {\r\n            me.emit(`unregister-${obj.id}`, obj);\r\n            me.emit(`unregister`, obj);\r\n        }\r\n        return sts;\r\n    }\r\n\r\n    /**\r\n     * Find registered handler\r\n     * @param {string} val \r\n     * @returns \r\n     */\r\n    find(val) {\r\n        return this.#map.get(val);\r\n    }\r\n\r\n    /**\r\n     * Wait for specific habdler to be either registered or unregistered\r\n     * @param {string} id \r\n     * @param {number|AbortSignal} signal Cancelation in timeout or provided signal\r\n     * @param {boolean} register Listen for register or unregister\r\n     * @returns \r\n     */\r\n    async wait(id = '', signal, register = true) {\r\n        if (!id) throw new Error('GSReadWrite ID not valid.');\r\n        const me = this;\r\n        if (register) {\r\n            const rw = me.find(id);\r\n            if (rw) return rw;\r\n        }\r\n        const type = register ? 'register' : 'unregister';\r\n        await super.wait(`${type}-${id}`, signal);\r\n        return me.find(id);\r\n    }\r\n\r\n    /**\r\n     * Reset the registry\r\n     */\r\n    resetRegistry() {\r\n        this.#handlers.clear();\r\n        this.#map.clear();\r\n    }\r\n\r\n    #verify(obj) {\r\n        //if (!(obj instanceof GSAbstractReadWrite)) throw new Error('Invalid parameter type.');\r\n    }\r\n\r\n    static get #self() {\r\n        if (!GSReadWriteRegistryImpl.#instance) GSReadWriteRegistryImpl.#instance = new GSReadWriteRegistryImpl(GSReadWriteRegistryImpl.#INTERNAL);\r\n        return GSReadWriteRegistryImpl.#instance;\r\n    }\r\n\r\n    static {\r\n        Object.seal(GSReadWriteRegistryImpl);\r\n        globalThis.GSReadWriteRegistry = GSReadWriteRegistryImpl.#self;\r\n    }\r\n\r\n}\r\n\r\nexport const GSReadWriteRegistry = globalThis.GSReadWriteRegistry;\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSID } from \"../base/GSID.mjs\";\r\nimport { GSEvent } from \"../base/GSEvent.mjs\";\r\nimport { GSReadWriteRegistry } from \"./ReadWriteRegistry.mjs\";\r\nimport { DataSelector } from \"./DataSelector.mjs\";\r\n\r\n/**\r\n * A module loading GSAbstractReadWrite class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Generic Class for data read/write for various components such as grid/form/dynamic menu etc.\r\n * @Class\r\n */\r\nexport class GSAbstractReadWrite extends GSEvent {\r\n\r\n    static #SELECT = Symbol('select');\r\n\r\n    #id = null;\r\n    #processors = null;\r\n\r\n    constructor(name, enabled = true) {\r\n        super();\r\n        const me = this;\r\n        me.#id = name || GSID.next();\r\n        if (enabled) me.enable();\r\n    }\r\n\r\n    /**\r\n     * Data preprocessor to register\r\n     * @param {object} processor\r\n     */\r\n    addProcessor(processor) {\r\n        if (!processor) return;\r\n        this.#processors ??= new Set();\r\n        this.#processors.add(processor);\r\n    }\r\n\r\n    /**\r\n     * Data preprocessor to remove\r\n     * @param {object} processor \r\n     */    \r\n    removeProcessor(processor) {\r\n        if (processor) this.#processors?.delete(processor);\r\n    }\r\n\r\n    /**\r\n     * Unique data handler name\r\n     * @returns {string} \r\n     */\r\n    get id() {\r\n        return this.#id;\r\n    }\r\n\r\n    /**\r\n     * Register into global data handler registry\r\n     */\r\n    enable() {\r\n        const me = this;\r\n        GSReadWriteRegistry.register(me);\r\n        me.emit('enabled');\r\n    }\r\n\r\n    /**\r\n     * Unregister from global data handler registry\r\n     */\r\n    disable() {\r\n        const me = this;\r\n        GSReadWriteRegistry.unregister(me);\r\n        me.emit('disabled');\r\n    }\r\n\r\n    /**\r\n     * Check if data handler is registered in global registry\r\n     * @returns {boolean}\r\n     */\r\n    get isRegistered() {\r\n        return GSReadWriteRegistry.find(this.id) ? true : false;\r\n    }\r\n\r\n    /**\r\n     * Generic event dispatcher, can be overriden to controll when to fire event\r\n     * @param {*} owner \r\n     * @param {*} type \r\n     * @param {*} data \r\n     * @param {*} error \r\n     */\r\n    notify(owner, type, data, error) {\r\n        this.emit(error ? 'error' : type, { type: type, error: error, owner: owner, data: data }, true);\r\n    }\r\n\r\n    /**\r\n     * Initiate data read from remote\r\n     * @param {HTMLElement} owner \r\n     * @returns {Array|Object} JSON data response\r\n     */\r\n    async read(owner) {\r\n        const me = this;\r\n        let data = null;\r\n        try {\r\n            data = await me.onRead(owner);\r\n            me.#processors?.forEach(c => c.postRead?.(data));\r\n            if (data) me.notify(owner, 'read', data);\r\n        } catch (e) {\r\n            me.notify(owner, 'read', data, e);\r\n            throw e;\r\n        }\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * Initiate data write to remote\r\n     * @param {HTMLElement} owner \r\n     * @returns {Array|Object} JSON data response\r\n     */\r\n    async write(owner, data) {\r\n        const me = this;\r\n        let result = null;\r\n        try {\r\n            result = await me.onWrite(owner, data);\r\n            me.#processors?.forEach(c => c.postWrite?.(data));\r\n            if (result) me.notify(owner, 'write', data);\r\n        } catch (e) {\r\n            me.notify(owner, 'write', data, e);\r\n            throw e;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Override in inherited class to implement read logic\r\n     * @param {} owner \r\n     * @returns \r\n     */\r\n    async onRead(owner) {\r\n        throw new Error('Extend base GSAbstractReadWrite to implement read operation');\r\n    }\r\n\r\n    /**\r\n     * Store selected record ID\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    addSelected(val) {\r\n        if (!val) return false;\r\n        DataSelector.addSelected(val);\r\n        const me = this;\r\n        me.emit('selection-add', val);\r\n        me.emit('select');\r\n        return val;\r\n    }\r\n\r\n    /**\r\n     * Remove selected record ID\r\n     * @param {*} val \r\n     */\r\n    removeSelected(val) {\r\n        if (!val) return false;\r\n        DataSelector.removeSelected(val);\r\n        const me = this;\r\n        me.emit('selection-remove', val);\r\n        me.emit('select');\r\n        return val;\r\n    }\r\n\r\n    /**\r\n     * Remove all selections\r\n     */\r\n    clearSelected(data) {\r\n        DataSelector.clearSelected(data);\r\n        const me = this;\r\n        me.emit('selection-clear');\r\n        me.emit('select');\r\n    }\r\n\r\n    /**\r\n     * Return list of all selected record id's\r\n     */\r\n    getSelected(data = []) {\r\n        return DataSelector.getSelected(data);\r\n    }\r\n\r\n    /**\r\n     * Check if record id is in list of selected records\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    isSelected(val) {\r\n        return DataSelector.isSelected(val);\r\n    }\r\n\r\n    /**\r\n     * Get list of selected records.\r\n     * Override in inherited class\r\n     */\r\n    get selected() {\r\n        return [];\r\n    }\r\n\r\n    /**\r\n     * Override in inherited class to implement write logic\r\n     * @param {} owner \r\n     * @param {} data\r\n     * @returns \r\n     */\r\n    async onWrite(owner, data) {\r\n        throw new Error('Extend base GSAbstractReadWrite to implement write operation');\r\n    }\r\n\r\n    /**\r\n     * Reset the abstract read/write handler\r\n     */\r\n    reset() {\r\n        this.#processors = null;\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSFunction } from \"../base/GSFunction.mjs\";\r\nimport { GSLoader } from \"../base/GSLoader.mjs\";\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\nimport { GSAbstractReadWrite } from \"./AbstractReadWrite.mjs\";\r\nimport { GSReadWriteRegistry } from \"./ReadWriteRegistry.mjs\";\r\n\r\n/**\r\n * A module loading GSReadWrite class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Generic Class for QUERY/REST data read/write for various components such as grid/form/dynamic menu etc.\r\n * Also, Green Screens Quark Engine or external functions are supported.\r\n * If mode=\"\", instance is used as local reader. \r\n * Use events to detect read/write requests or manually populate using this.setData([...]) \r\n * @Class\r\n */\r\nexport class GSReadWrite extends GSAbstractReadWrite {\r\n\r\n    static #TYPE = \"remote\";\r\n\r\n    static #MODES = ['', 'rest', 'query', 'quark'];\r\n    static #METHOD = ['GET', 'PUT', 'POST', 'DELETE'];\r\n\r\n    #src = '';\r\n    #headers = {};\r\n    #reader = 'GET';\r\n    #writer = 'POST';\r\n    #action = '';\r\n    #mode = '';\r\n\r\n    #key = null;\r\n\r\n    #skip = 0;\r\n    #limit = 0;\r\n\r\n    #sort = [];\r\n    #filter = [];\r\n\r\n    /**\r\n     * Instance constructor\r\n     * @param {string} name Unique handler name\r\n     * @param {boolean} enabled Automatically register in global registry. \r\n     */\r\n    constructor(name, enabled) {\r\n        super(name, enabled);\r\n    }\r\n\r\n    /**\r\n     * Handler type\r\n     */\r\n    get type() {\r\n        return GSReadWrite.#TYPE;\r\n    }\r\n\r\n    /**\r\n     * Handler operational mode\r\n     * rest, query, quark \r\n     * @returns {string} Operational mode\r\n     */\r\n    get mode() {\r\n        return GSUtil.normalize(this.#mode);\r\n    }\r\n\r\n    /**\r\n     * Handler operational mode\r\n     * Values: '', query, rest, quark\r\n     * @var {String} \r\n     */\r\n    set mode(val) {\r\n        const me = this;\r\n        val = GSUtil.normalize(val);\r\n        const isok = GSReadWrite.#MODES.includes(val);\r\n        if (!isok) throw new Error(null, `Invalid mode, allowed: ${GSReadWrite.#MODES}`);\r\n        if (me.#mode === 'quark' && me.#mode != val) {\r\n            me.#reader = 'GET';\r\n            me.#writer = 'POST';\r\n        }\r\n        return this.#mode = val;\r\n    }\r\n\r\n    /**\r\n     * HTTP method for reader (query/rest)\r\n     * @returns {string} Values GET,POST,PUT\r\n     */\r\n    get reader() {\r\n        return this.#reader;\r\n    }\r\n\r\n    /**\r\n     * HTTP method for reader (query/rest)\r\n     * Values GET,POST,PUT\r\n     * @var {String} \r\n     */\r\n    set reader(val) {\r\n        const me = this;\r\n        const isok = me.isQuark ? true : GSReadWrite.#METHOD.includes(val);\r\n        if (!isok) throw new Error(null, `Invalid method, allowed: ${GSReadWrite.#METHOD}`);\r\n        return me.#reader = val;\r\n    }\r\n\r\n    /**\r\n     * HTTP method for writer (query/rest)\r\n     * @returns {string} Values POST,PUT\r\n     */\r\n    get writer() {\r\n        return this.#writer;\r\n    }\r\n\r\n    /**\r\n     * HTTP method for writer (query/rest)\r\n     * Values POST,PUT\r\n     * @var {String} \r\n     */\r\n    set writer(val) {\r\n        const me = this;\r\n        const isok = me.isQuark ? true : GSReadWrite.#METHOD.includes(val);\r\n        if (!isok) throw new Error(null, `Invalid method, allowed: ${GSReadWrite.#METHOD}`);\r\n        return this.#writer = val;\r\n    }\r\n\r\n    /**\r\n     * Custom HTTP headers\r\n     * @returns {Object} Json structure\r\n     */\r\n    get headers() {\r\n        return { ...this.#headers };\r\n    }\r\n\r\n    /**\r\n     * Custom HTTP headersas String or Json structure\r\n     * @var {Object} \r\n     */\r\n    set headers(val = {}) {\r\n        val = GSUtil.toJson(val);\r\n        const me = this;\r\n        me.#headers = { ...val };\r\n    }\r\n\r\n    /**\r\n     * Record key field\r\n     */\r\n    get key() {\r\n        return this.#key;\r\n    }\r\n\r\n    /**\r\n     * Record key field\r\n     * @var {String} \r\n     */\r\n    set key(val) {\r\n        this.#key = val;\r\n    }\r\n\r\n    /**\r\n     * Base URL part\r\n     * @returns {string} \r\n     */\r\n    get src() {\r\n        return this.#src;\r\n    }\r\n\r\n    /**\r\n     * Base URL part\r\n     * @var {String} \r\n     */\r\n    set src(val = '') {\r\n        const me = this;\r\n        me.#src = val;\r\n    }\r\n\r\n    /**\r\n     * Number of records to return\r\n     * @returns {Number} \r\n     */\r\n    get limit() {\r\n        return this.#limit;\r\n    }\r\n\r\n    /**\r\n     * Number of records to return\r\n     * @var {Number} \r\n     */\r\n    set limit(val = 10) {\r\n        this.#limit = GSUtil.asNum(val, 10);\r\n    }\r\n\r\n    /**\r\n     * Number of records to skip\r\n     * @returns {Number} \r\n     */\r\n    get skip() {\r\n        return this.#skip;\r\n    }\r\n\r\n    /**\r\n     * Number of records to skip\r\n     * @var {Number} \r\n     */\r\n    set skip(val = 0) {\r\n        this.#skip = GSUtil.asNum(val, 0);\r\n    }\r\n\r\n    /**\r\n     * Filter data in format \r\n     * [{name: idx[num] || name[string], value: ''  , op:'eq'}]\r\n     * @returns {Array<Object>} \r\n     */\r\n    get filter() {\r\n        return this.#filter;\r\n    }\r\n\r\n    set filter(val) {\r\n        const me = this;\r\n        val = val || [];\r\n        val = GSUtil.isJson(val) ? GSUtil.toJson(val) : val;\r\n        me.#filter = Array.isArray(val) ? val : [val];\r\n    }\r\n\r\n    /**\r\n     * Sort data in format\r\n     * [{col: idx[num] || name[string]  , op: -1 | 1 }]\r\n     * @returns {Array<Object>} \r\n     */\r\n    get sort() {\r\n        return this.#sort;\r\n    }\r\n\r\n    set sort(val) {\r\n        const me = this;\r\n        val = val || [];\r\n        val = GSUtil.isJson(val) ? GSUtil.toJson(val) : val;\r\n        me.#sort = Array.isArray(val) ? val : [val];\r\n    }\r\n\r\n    /**\r\n     * Generated URL segment based on selected mode (query/rest)\r\n     * - quark - JSON path to CRUD object; ie. io.greenscreens.CRUD\r\n     * - rest - url rest format, ie. /${limit}/${skip}?sort=${sort}&filter=${filter}\r\n     * - query - url format, ie. ?limit=${limit}&skip=${skip}&sort=${sort}&filter=${filter}\r\n     * @returns {string} \r\n     */\r\n    get action() {\r\n        const me = this;\r\n        let def = '';\r\n        switch (me.mode) {\r\n            case 'query':\r\n                def = '?limit=${limit}&skip=${skip}&sort=${sort}&filter=${filter}';\r\n                break;\r\n            case 'rest':\r\n                def = '/${limit}/${skip}?sort=${sort}&filter=${filter}';\r\n                break;\r\n        }\r\n        return me.#action || def;\r\n    }\r\n\r\n    /**\r\n     * Set custom URL segment to be attached to based 'src'.\r\n     * Format depends on mode[query|rest]\r\n     * @var {String}\r\n     */\r\n    set action(val = '') {\r\n        const me = this;\r\n        me.#action = val;\r\n    }\r\n\r\n    /**\r\n    * Generate URL from src and mode type\r\n    */\r\n    get url() {\r\n        const me = this;\r\n        return me.#toURL(me.#src, me.#skip, me.#limit, me.#filter, me.#sort);\r\n    }\r\n\r\n    #toURL(src, skip, limit, filter, sort) {\r\n        const me = this;\r\n        if (GSUtil.isStringEmpty(src)) throw new Error('Attribute \"src\" not set!');\r\n        sort = sort ? JSON.stringify(sort) : '';\r\n        filter = filter ? JSON.stringify(filter) : '';\r\n        const opt = { limit: limit, skip: skip, sort: encodeURIComponent(sort), filter: encodeURIComponent(filter) };\r\n        return src + GSUtil.fromLiteral(me.action, opt);\r\n    }\r\n\r\n    /**\r\n     * If handler is local for manual data entry\r\n     * @returns {boolean}\r\n     */\r\n    get isOffline() {\r\n        return this.mode === '';\r\n    }\r\n\r\n    /**\r\n     * If handler is for Green Screens Quark Engine or custom global function.\r\n     * @returns {boolean}\r\n     */\r\n    get isQuark() {\r\n        return this.mode === 'quark';\r\n    }\r\n\r\n    /**\r\n     * If handler is for HTTP requests (query|rest)\r\n     * @returns {boolean}\r\n     */\r\n    get isRemote() {\r\n        return ['rest', 'query'].includes(this.mode);\r\n    }\r\n\r\n    /**\r\n     * Override in inherited class\r\n     * @param {} owner Calling HTMLElement\r\n     * @returns {Array<Object>} Json Array data loaded \r\n     */\r\n    async onRead(owner) {\r\n        const me = this;\r\n        if (me.isOffline) return;\r\n        if (!me.#reader) return super.onRead(owner);\r\n        if (me.isRemote) return await GSLoader.load(me.url, me.#reader, me.#headers, true);\r\n        if (!me.isQuark) return;\r\n        const fn = GSFunction.parseFunction(me.#reader);\r\n        if (!fn) throw new Error('Reader quark function not found!')\r\n        return fn(me.skip, me.limit, me.filter, me.sort);\r\n    }\r\n\r\n    /**\r\n     * Override in inherited class\r\n     * @param {} owner Calling HTMLElement\r\n     * @param {Object} data JSON object to send to the remote\r\n     * @returns {Object} Json Object with write response\r\n     */\r\n    async onWrite(owner, data) {\r\n        const me = this;\r\n        if (me.isOffline) return;\r\n        if (!me.#writer) return super.onWrite(owner);\r\n        if (!me.isRemote) return await GSLoader.load(me.url, me.#writer, me.#headers, true, data);\r\n        if (!me.isQuark) return;\r\n        const fn = GSFunction.parseFunction(me.#writer);\r\n        if (!fn) throw new Error('Writer quark function not found!')\r\n        return fn(data);\r\n    }\r\n\r\n    /**\r\n     * Reset the read/write handler\r\n     */\r\n    reset() {\r\n        this.#src = '';\r\n        this.#headers = {};\r\n        this.#reader = 'GET';\r\n        this.#writer = 'POST';\r\n        this.#action = '';\r\n        this.#mode = '';\r\n        this.#key = null;\r\n        this.#skip = 0;\r\n        this.#limit = 0;\r\n        this.#sort = [];\r\n        this.#filter = [];\r\n    }\r\n\r\n    /**\r\n     * Register generic handler under unique name.\r\n     * @param {string} name Unique handler name\r\n     * @returns {GSReadWrite} Data handler instance\r\n     */\r\n    static register(name) {\r\n        return new GSReadWrite(name, true);\r\n    }\r\n\r\n    static {\r\n        GSReadWriteRegistry.addHandler(GSReadWrite.#TYPE, GSReadWrite);\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSData } from \"../base/GSData.mjs\";\r\nimport { GSReadWrite } from \"./ReadWrite.mjs\";\r\nimport { GSReadWriteRegistry } from \"./ReadWriteRegistry.mjs\";\r\n\r\n/**\r\n * A module loading GSCachedReadWrite class\r\n * @module base/GSCachedReadWrite\r\n */\r\n\r\n/**\r\n * ReadWrite with cached memory data. \r\n * @Class\r\n */\r\nexport class GSCachedReadWrite extends GSReadWrite {\r\n\r\n    static #TYPE = 'cached';\r\n\r\n    #data = [];\r\n\r\n    #reformat(data = []) {\r\n\r\n        let records = [];\r\n        if (Array.isArray(data)) {\r\n            records = data;\r\n        } else if (Array.isArray(data.data)) {\r\n            records = data.data;\r\n        } else {\r\n            records = [data];\r\n        }\r\n\r\n        return records;\r\n    }\r\n\r\n    #postFilter(data) {\r\n        const me = this;\r\n        data = GSData.sortData(data, me.sort);        \r\n        let limit = me.limit === 0 ? data.length : me.limit;\r\n        data = data.slice(me.skip, me.skip + limit);\r\n        return data;\r\n    }\r\n\r\n    clear() {\r\n        this.clearSelected(this.#data);\r\n        this.#data = [];\r\n    }\r\n\r\n    append(data) {\r\n        if(!data) return false;\r\n        const me = this;\r\n        data = me.#reformat(data);\r\n        me.#data = me.#data.concat(data);\r\n        return me.#data;\r\n    }\r\n\r\n    remove(data) {\r\n        const me = this;\r\n        me.removeSelected(data);\r\n        me.#data = me.#data.filter(o => o =! data);\r\n        return me.#data;\r\n    }\r\n\r\n    /**\r\n     * Override in inherited class\r\n     * @param {} owner Calling HTMLElement\r\n     * @returns {Array<Object>} Json Array data loaded \r\n     */\r\n    async onRead(owner) {\r\n        const me = this;\r\n\r\n        if (me.#data.length === 0) {\r\n            const data = await super.onRead();\r\n            me.#data = me.#reformat(data);\r\n        }\r\n\r\n        let data = GSData.filterData(me.#data, me.filter, me.fields, me.limit);\r\n        data = me.#postFilter(data);\r\n        return data;\r\n    }\r\n\r\n    async onWrite(owner, data) {\r\n        return this.append(data);        \r\n    }\r\n\r\n    disable() {\r\n        this.#data = [];\r\n        super.disable();\r\n    }\r\n\r\n    set search(val) {\r\n        const me = this;\r\n        me.filter = val ? [{value : val}] : [];\r\n        me.read();\r\n        /*\r\n        let data = GSData.filterData(me.#data, [{value : val}]);\r\n        data = me.#postFilter(data);\r\n        me.notify(me, 'read', data);\r\n        */\r\n    }\r\n\r\n    clearSelected() {\r\n        return super.clearSelected(this.#data);\r\n    }\r\n\r\n    /**\r\n     * Return list of all selected record id's\r\n     */\r\n    get selected() {\r\n        return super.getSelected(this.#data);\r\n    }\r\n\r\n    /**\r\n     * Handler type\r\n     */\r\n    get type() {\r\n        return GSCachedReadWrite.#TYPE;\r\n    }\r\n\r\n    /**\r\n     * Reset the cached read/write handler\r\n     */\r\n    reset() {\r\n        this.clear();\r\n        super.reset();\r\n    }\r\n\r\n    /**\r\n     * Register generic handler under unique name.\r\n     * @param {string} name Unique handler name\r\n     * @returns {GSReadWrite} Data handler instance\r\n     */\r\n    static register(name) {\r\n        return new GSCachedReadWrite(name, true);\r\n    }\r\n\r\n    static {\r\n        GSReadWriteRegistry.addHandler(GSCachedReadWrite.#TYPE, GSCachedReadWrite);\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { Tree } from \"../helpers/Tree.mjs\";\r\n\r\n/**\r\n * A module loading TreeNode class\r\n * @module data/TreeNode\r\n */\r\n\r\n/**\r\n * UI mediator between Tree linked nodes and WebComponents\r\n * @Class\r\n */\r\nexport class TreeNode extends Tree {\r\n\r\n    #multi = false;\r\n    #opened = false;\r\n    #focused = false;\r\n    #selected = false;\r\n    \r\n    #focusedNode = undefined;\r\n    #selectedNode = undefined;\r\n    #controllers = undefined;\r\n\r\n    constructor(key, value = key, parent = null, level = 0) {\r\n        super(key, value, parent, level);\r\n\r\n        if (value?.select === true || (this.multi && parent?.selected)) this.selected = true;\r\n        if (value?.focus === true) this.focused = true;\r\n        if (value?.open === true) this.opened = true;\r\n    }\r\n\r\n    addController(controller) {\r\n        const root = this.root;\r\n        (root.#controllers ??= new Set()).add(controller);\r\n    }\r\n\r\n    removeController(controller) {\r\n        this.root.#controllers?.delete(controller);\r\n    }\r\n\r\n    /**\r\n     * Is multi selection available\r\n     */\r\n    get multi() {\r\n        return this.root.#multi === true;\r\n    }\r\n\r\n    set multi(val) {\r\n        this.root.#multi = val === true;\r\n    }\r\n\r\n    get visible() {\r\n        if (this.level < 0) return true;\r\n        return this.parent?.opened;\r\n    }\r\n\r\n    /**\r\n     * select single node, removing seelction flag from all other nodes\r\n     */\r\n    get opened() {\r\n        if (this.level < 0) return true;\r\n        return this.isLeaf ? this.parent?.opened : this.#opened;\r\n    }\r\n\r\n    set opened(val) {\r\n        val = val === true;\r\n        if (val) {\r\n            this.expand();\r\n        } else {\r\n            this.collapse();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Focus single node, removing focus flag from all other nodes\r\n     */\r\n    get focused() {\r\n        return this.#focused;\r\n    }\r\n\r\n    set focused(val) {\r\n        val = val === true;\r\n        const root = this.root;\r\n        const changed = this.#focused != val;\r\n        const focusedNode = root.focusedNode();\r\n        \r\n        root.#focusedNode = undefined;        \r\n        this.#focused = val;\r\n        if (focusedNode && focusedNode !== this) {\r\n            focusedNode.focused = false;\r\n        }\r\n\r\n        if (val) root.#focusedNode = this;\r\n        if (changed) root.#controllers?.forEach((c) => c.onFocusChanged?.(this));\r\n    }\r\n\r\n    /**\r\n     * Select single or multi node, depending on multi selection flag\r\n     * If single, remove selection flag from all other nodes\r\n     */\r\n    get selected() {\r\n        return this.#selected;\r\n    }\r\n\r\n    set selected(val) {\r\n        val = val === true;\r\n        const root = this.root;\r\n        const selectedNode = root.selectedNode();\r\n        const changed = this.#selected != val;\r\n        this.#selected = val;\r\n        if (val) {\r\n            if (selectedNode && selectedNode !== this && !root.multi) {\r\n                selectedNode.selected = false;\r\n            }\r\n            root.#selectedNode = this;\r\n        }\r\n        if (changed) {\r\n            root.#controllers?.forEach((c) => c.onSelectionChanged?.(this, selectedNode));\r\n            if (root.multi) root.#controllers?.forEach((c) => c.onSelectionChanged?.(this.parent, selectedNode));\r\n        } \r\n    }\r\n\r\n    get isPartialySelected() {\r\n        return this.selected && this.hasChildren && this.nodes.length > this.nodes.filter(n => n.selected).length;\r\n    }\r\n\r\n    /* hide from public\r\n    get host() {\r\n        return this[Symbol.for('gs-element')];\r\n    }\r\n\r\n    set host(el) {\r\n        this[Symbol.for('gs-element')] = el;\r\n    }\r\n    */\r\n\r\n    selectAll() {\r\n        const root = this.root;\r\n        if (!root.multi) {\r\n            this.deselectAll();\r\n            this.selected = true;\r\n            return\r\n        }\r\n        this.#selectionFlag(true);\r\n        root.#selectedNode = this;\r\n        root.#controllers?.forEach((c) => c.onSelectAll?.(root));\r\n    }\r\n\r\n    deselectAll() {\r\n        const root = this.root;\r\n        this.#selectionFlag(false);\r\n        root.#selectedNode = undefined;\r\n        root.#controllers?.forEach((c) => c.onDeselectAll?.(root));\r\n    }\r\n\r\n    /**\r\n     * Return last focused node\r\n     * @returns \r\n     */\r\n    focusedNode() {\r\n        const node = this.root.#focusedNode;\r\n        return node?.focused ? node : undefined;\r\n    }\r\n\r\n    /**\r\n     * Return last selected node\r\n     * @returns \r\n     */\r\n    selectedNode() {\r\n        const node = this.root.#selectedNode;\r\n        return node?.selected ? node : undefined;\r\n    }\r\n\r\n    /**\r\n     * List all selected nodes.\r\n     * @returns \r\n     */\r\n    selectedNodes() {\r\n        const root = this.root;\r\n        if (!root.multi) {\r\n            const node = root.selectedNode()\r\n            return node?.selected ? [node] : [];\r\n        }\r\n        return Array.from(root.walk().filter(o => o.selected));\r\n    }\r\n\r\n    /**\r\n     * Call from external controller data must be refresshed (to notify UI optionally)\r\n     * @param {*} root \r\n     */\r\n    refresh(root) {\r\n        root = root || this.root;\r\n        root.#controllers?.forEach((c) => c.onRefresh?.(this));\r\n    }\r\n\r\n    /**\r\n     * Notify controllers about data loading (from async controller)\r\n     * @param {*} root \r\n     */\r\n    loading(root) {\r\n        root = root || this.root;\r\n        root.#controllers?.forEach((c) => c.onLoad?.(this));\r\n    }\r\n\r\n    expandAll(root) {\r\n        const me = this;\r\n        root = root || me.root;\r\n        for (let node of this.walk()) {\r\n            if (!node.isLeaf) node.expand(root);\r\n        }\r\n    }\r\n\r\n    collapseAll(root) {\r\n        const me = this;\r\n        root = root || me.root;\r\n        for (let node of this.walk()) {\r\n            if (!node.isLeaf) node.collapse(root);\r\n        }\r\n    }\r\n\r\n    expand(root) {\r\n        const me = this;\r\n        root = root || me.root;\r\n        if (!me.parent?.opened) {\r\n            me.parent?.expand(root);\r\n        }\r\n        const update = !me.opened;\r\n        me.#opened = true;\r\n        if (update) me.#expanded(root);\r\n        //me.nodes?.filter( n => !n.opened).forEach(c => c.refresh(root));\r\n        me.nodes?.forEach(c => c.refresh(root));\r\n    }\r\n\r\n    collapse(root) {\r\n        const me = this;\r\n        root = root || me.root;\r\n        const update = me.#opened || me.parent.#opened;\r\n        me.nodes?.filter(n => n.opened || n.parent.opened).forEach(o => o.collapse(root));\r\n        //me.nodes?.forEach(o => o.collapse(root));\r\n        me.#opened = false;\r\n        if (update) me.#collapsed(root);\r\n    }\r\n\r\n    select(val = true) {\r\n        this.selected = val === true;\r\n    }\r\n\r\n    #expanded(root) {\r\n        root.#controllers?.forEach((c) => c.onExpand?.(this));\r\n    }\r\n\r\n    #collapsed(root) {\r\n        root.#controllers?.forEach((c) => c.onCollapse?.(this));\r\n    }\r\n\r\n    release() {\r\n        if (this.#selected) this.selected = false;\r\n        super.release();\r\n    }\r\n\r\n    append(key, value = key) {\r\n        const me = this;\r\n        const node = super.append(key, value);\r\n        if (node) me.root.#controllers?.forEach((c) => c.onAppend?.(me, node));\r\n        return node;\r\n    }\r\n\r\n    insert(parentNodeKey, key, value = key) {\r\n        const me = this;\r\n        const node = super.insert(parentNodeKey, key, value);\r\n        if (node) me.root.#controllers?.forEach((c) => c.onInsert?.(me, node));\r\n        return node;\r\n    }\r\n\r\n    remove() {\r\n        const node = super.remove();\r\n        if (node) this.root.#controllers?.forEach((c) => c.onInsert?.(node));\r\n        return node;\r\n    }\r\n\r\n    #selectionFlag(val = false) {\r\n        val = val === true\r\n        for (let node of this.walk()) {\r\n            node.selected = val;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Load JSON data into tree\r\n     * @param {*} data \r\n     */\r\n    fromJSON(data) {\r\n        if (data) TreeNode.from(this, data);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Used by JSON.stringify to properly export as JSON\r\n     * @returns \r\n     */\r\n    toJSON() {\r\n        if (this.level < 0) return this.nodes?.map(o => o.toJSON()) || {};\r\n        const obj = Object.assign({\r\n            key: this.key,\r\n            opened: this.#opened,\r\n            focused: this.#focused,\r\n            selected: this.#selected,\r\n            items: undefined\r\n        }, this.value);\r\n        obj.items = this.nodes?.map(o => o.toJSON());\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Reset the tree node\r\n     */\r\n    reset() {\r\n        this.#multi = false;\r\n        this.#opened = false;\r\n        this.#focused = false;\r\n        this.#selected = false;\r\n        this.#focusedNode = undefined;\r\n        this.#selectedNode = undefined;\r\n        this.#controllers = undefined;\r\n    }\r\n\r\n    static get root() {\r\n        return new TreeNode(null, null, null, -1);\r\n    }\r\n\r\n    /**\r\n     * Convert JSON tree into Linked Tree \r\n     * @param {*} data \r\n     * @returns \r\n     */\r\n    static from(parent, data) {\r\n        const raw = data || parent;\r\n        const hasParent = parent instanceof TreeNode;\r\n        if (Array.isArray(raw)) {\r\n            if (!hasParent) return TreeNode.from(TreeNode.root, raw);\r\n            raw.forEach(o => TreeNode.from(parent, o));\r\n            return parent;\r\n        }\r\n        const { items, ...obj } = raw;\r\n        obj.leaf = !Array.isArray(items);\r\n        const tree = new TreeNode(obj.key, obj, data ? parent : undefined);\r\n        if (items) TreeNode.from(tree, items);\r\n        if (hasParent) parent.append(tree);\r\n        return tree;\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSReadWrite } from \"./ReadWrite.mjs\";\r\nimport { GSReadWriteRegistry } from \"./ReadWriteRegistry.mjs\";\r\nimport { TreeNode } from \"./TreeNode.mjs\";\r\n\r\n/**\r\n * A module loading GSTreeReader class\r\n * @module base/GSEvent\r\n */\r\n\r\n/**\r\n * Generic Class for reading Tree nodes\r\n * @Class\r\n */\r\nexport class GSTreeReader extends GSReadWrite {\r\n\r\n    #data = TreeNode.root;\r\n\r\n    /**\r\n     * Instance constructor\r\n     * @param {string} name Unique handler name\r\n     * @param {boolean} enabled Automatically registe in global registry. \r\n     */\r\n    constructor(name, enabled) {\r\n        super(name, enabled);\r\n    }\r\n\r\n    async write(val) {\r\n        throw new Error('Writer not available for TreeReader')\r\n    }\r\n\r\n    async read(owner) {\r\n        const me = this;\r\n        let node = undefined;\r\n        const data = await super.read(owner);\r\n        if (!this.#data) {\r\n            node = TreeNode.from(data);\r\n            this.#data = node;\r\n        } else {\r\n            const parent = me.filter?.length > 0 ? me.#data.findByKey(me.filter[0]) : me.#data;\r\n            parent.clear();\r\n            node = parent.fromJSON(data);\r\n        }\r\n        me.filter = undefined;\r\n        me.notify(owner, 'read', node);\r\n        return node;\r\n    }\r\n\r\n    disable() {\r\n        super.disable();\r\n        this.#data?.release();\r\n    }\r\n\r\n    notify(owner, type, data, error) {\r\n        const isNode = data instanceof TreeNode;\r\n        if (!error && !isNode && type === 'read') return;\r\n        super.notify(owner, type, data, error);\r\n    }\r\n\r\n    /**\r\n     * Called from Tree when node is expanded \r\n     * @param {*} node \r\n     */\r\n    async onExpand(node) {\r\n        if (node.hasChildren) return;\r\n        node.loading();\r\n        this.filter = node.key;\r\n        return await this.read();\r\n    }\r\n\r\n    get data() {\r\n        return this.#data;\r\n    }\r\n\r\n    /**\r\n     * Reset the tree data\r\n     */\r\n    resetData() {\r\n        this.#data = TreeNode.root;\r\n    }\r\n\r\n    /**\r\n     * Register generic handler under unique name.\r\n     * @param {string} name Unique handler name\r\n     * @returns {GSTreeReader} Data handler instance\r\n     */\r\n    static register(name) {\r\n        return new GSTreeReader(name, true);\r\n    }\r\n\r\n    static {\r\n        GSReadWriteRegistry.addHandler('tree', GSTreeReader);\r\n    }\r\n\r\n}","// Lit 3.0 Google\r\nconst litUrl = globalThis.GS_LIT_URL || '/bootstrap-lit/assets/lib/lit-all.min.js';\r\nconst litModule = await import(litUrl);\r\n\r\n// small helper to print this exports (or any other module); use it when upgrading to a new Lit version to regenerte export list below\r\nexport const printModuleExports = (module) => console.log(Object.keys(module || litModule).map(v => `export const ${v} = litModule.${v};`).join('\\n'));\r\n\r\nexport const ReactiveController = litModule.ReactiveController;\r\nexport const ReactiveElement = litModule.ReactiveElement;\r\nexport const AsyncDirective = litModule.AsyncDirective;\r\nexport const AsyncReplaceDirective = litModule.AsyncReplaceDirective;\r\nexport const CSSResult = litModule.CSSResult;\r\nexport const Directive = litModule.Directive;\r\nexport const LitElement = litModule.LitElement;\r\nexport const PartType = litModule.PartType;\r\nexport const TemplateResultType = litModule.TemplateResultType;\r\nexport const UnsafeHTMLDirective = litModule.UnsafeHTMLDirective;\r\nexport const UntilDirective = litModule.UntilDirective;\r\nexport const _$LE = litModule._$LE;\r\nexport const _$LH = litModule._$LH;\r\nexport const adoptStyles = litModule.adoptStyles;\r\nexport const asyncAppend = litModule.asyncAppend;\r\nexport const asyncReplace = litModule.asyncReplace;\r\nexport const cache = litModule.cache;\r\nexport const choose = litModule.choose;\r\nexport const classMap = litModule.classMap;\r\nexport const clearPart = litModule.clearPart;\r\nexport const createRef = litModule.createRef;\r\nexport const css = litModule.css;\r\nexport const defaultConverter = litModule.defaultConverter;\r\nexport const directive = litModule.directive;\r\nexport const getCommittedValue = litModule.getCommittedValue;\r\nexport const getCompatibleStyle = litModule.getCompatibleStyle;\r\nexport const getDirectiveClass = litModule.getDirectiveClass;\r\nexport const guard = litModule.guard;\r\nexport const html = litModule.html;\r\nexport const ifDefined = litModule.ifDefined;\r\nexport const insertPart = litModule.insertPart;\r\nexport const isCompiledTemplateResult = litModule.isCompiledTemplateResult;\r\nexport const isDirectiveResult = litModule.isDirectiveResult;\r\nexport const isPrimitive = litModule.isPrimitive;\r\nexport const isServer = litModule.isServer;\r\nexport const isSingleExpression = litModule.isSingleExpression;\r\nexport const isTemplateResult = litModule.isTemplateResult;\r\nexport const join = litModule.join;\r\nexport const keyed = litModule.keyed;\r\nexport const literal = litModule.literal;\r\nexport const live = litModule.live;\r\nexport const map = litModule.map;\r\nexport const noChange = litModule.noChange;\r\nexport const notEqual = litModule.notEqual;\r\nexport const nothing = litModule.nothing;\r\nexport const range = litModule.range;\r\nexport const ref = litModule.ref;\r\nexport const removePart = litModule.removePart;\r\nexport const render = litModule.render;\r\nexport const repeat = litModule.repeat;\r\nexport const setChildPartValue = litModule.setChildPartValue;\r\nexport const setCommittedValue = litModule.setCommittedValue;\r\nexport const staticHtml = litModule.staticHtml;\r\nexport const staticSvg = litModule.staticSvg;\r\nexport const styleMap = litModule.styleMap;\r\nexport const supportsAdoptingStyleSheets = litModule.supportsAdoptingStyleSheets;\r\nexport const svg = litModule.svg;\r\nexport const templateContent = litModule.templateContent;\r\nexport const unsafeCSS = litModule.unsafeCSS;\r\nexport const unsafeHTML = litModule.unsafeHTML;\r\nexport const unsafeSVG = litModule.unsafeSVG;\r\nexport const unsafeStatic = litModule.unsafeStatic;\r\nexport const until = litModule.until;\r\nexport const when = litModule.when;\r\nexport const withStatic = litModule.withStatic;","import { Directive, directive, nothing } from \"../lib.mjs\";\r\n\r\nconst definition = {\r\n    'action': 'gsAction',\r\n    'anchor': 'gsAnchor',\r\n    'attribute': 'gsAttribute',\r\n    'call': 'gsCall',\r\n    'exec': 'gsExec',\r\n    'inject': 'gsInject',\r\n    'property': 'gsProperty',\r\n    'swap': 'gsSwap',\r\n    'target': 'gsTarget',\r\n    'template': 'gsTemplate',\r\n    'toggle': 'gsToggle',\r\n    'trigger': 'gsTrigger',\r\n    'value': 'gsValue',\r\n    'calls':'gsCall',\r\n    'toggles':'gsToggle',\r\n    'timeout':'gsTimeout',\r\n    'triggers':'gsTrigger'\r\n};\r\n\r\nconst template = {\r\n    'gsAction': undefined,\r\n    'gsAnchor': undefined,\r\n    'gsAttribute': undefined,\r\n    'gsCall': undefined,\r\n    'gsExec': undefined,\r\n    'gsInject': undefined,\r\n    'gsProperty': undefined,\r\n    'gsSwap': undefined,\r\n    'gsTarget': undefined,\r\n    'gsTemplate': undefined,\r\n    'gsToggle': undefined,\r\n    'gsTrigger': undefined,\r\n    'gsValue': undefined,\r\n    'gsCall': undefined,\r\n    'gsToggle': undefined,\r\n    'gsTimeout': undefined,\r\n    'gsTrigger': undefined\r\n};\r\n\r\nclass DatasetDirective extends Directive {\r\n\r\n    render(obj) {\r\n        console.log(obj);\r\n        return nothing;\r\n    }\r\n\r\n    update(part, [obj, flat = true]) {\r\n\r\n        if (!obj) return nothing;\r\n        const dataset = part.element.dataset;\r\n        const srcset = obj.dataset || obj;\r\n        const isDataset = srcset instanceof DOMStringMap;\r\n\r\n        if (isDataset) {\r\n            Object.assign(dataset, srcset);\r\n        } \r\n        \r\n        if (flat) this.#remap(dataset, obj);\r\n\r\n        return nothing;\r\n    }\r\n\r\n    #remap(dataset, obj) {\r\n        const opt = Object.assign({}, template);\r\n        const list = Object.entries(obj).filter(v => Object.hasOwn(definition, v[0]));\r\n        if (list.length > 0) {\r\n            list.forEach(kv => opt[definition[kv[0]]] = kv[1]);\r\n            Object.keys(opt)\r\n            .filter(k => opt[k] !== undefined)\r\n            .forEach(k => dataset[k] = opt[k]);\r\n        }\r\n    }\r\n}\r\n\r\nexport const dataset = directive(DatasetDirective);\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { html } from '../lib.mjs';\r\n\r\n/**\r\n * Generic object property descriptor getter\r\n * @param {Object} instance \r\n * @returns {PropertyDescriptor}\r\n */\r\nfunction descriptors(instance) {\r\n  return Object.entries(Object.getOwnPropertyDescriptors(instance));\r\n}\r\n\r\n/**\r\n * List of all object property descriptors \r\n * @param {Object} instance Object instance \r\n * @returns {Array<PropertyDescriptor>}\r\n */\r\nfunction listProperties(instance) {\r\n  return descriptors(instance)\r\n    .filter(e => typeof e[1].value !== 'function')\r\n    .map(e => e[0]);\r\n}\r\n\r\n/**\r\n * List all object property getters\r\n * @param {Object} instance \r\n * @returns {Array}\r\n */\r\nfunction listGetters(instance) {\r\n  return descriptors(Reflect.getPrototypeOf(instance))\r\n    .filter(e => typeof e[1].get === 'function' && e[0] !== '__proto__')\r\n    .map(e => e[0]);\r\n}\r\n\r\n/**\r\n * List of all gettable properties from an object\r\n * @param {Object} instance \r\n * @returns {Array}\r\n */\r\nfunction listGettable(instance) {\r\n  return new Set([...listGetters(instance), ...listProperties(instance)]);\r\n}\r\n\r\n/**\r\n * Parse string literal template into Lit html instance\r\n * @param {*} tpl \r\n * @param {*} params \r\n * @returns {function}\r\n */\r\nexport function literalTemplate(tpl, params) {\r\n  const names = Array.from(listGettable(params));\r\n  const vals = names.map(v => params[v]);\r\n  names.push('html');\r\n  vals.push(html);\r\n  return new Function(...names, `return html\\`${tpl}\\`;`)(...vals);\r\n}","/**\r\n * A clone of classMap directive to support CSS directive.\r\n * Lit classs is not expoed, so we have to clone it and create our own.\r\n */\r\n\r\nimport { Directive, PartType, directive, noChange } from \"../lib.mjs\";\r\n\r\nclass CssMapDirective extends Directive {\r\n\r\n    constructor(partInfo) {\r\n        super(partInfo);\r\n        if (partInfo.type !== PartType.ATTRIBUTE ||\r\n            partInfo.name !== 'css' ||\r\n            partInfo.strings?.length > 2) {\r\n            throw new Error('`classMap()` can only be used in the `css` attribute ' +\r\n                'and must be the only part in the attribute.');\r\n        }\r\n    }\r\n\r\n    render(classInfo) {\r\n        // Add spaces to ensure separation from static classes\r\n        return (' ' +\r\n            Object.keys(classInfo)\r\n                .filter((key) => classInfo[key])\r\n                .join(' ') +\r\n            ' ');\r\n    }\r\n\r\n    update(part, [classInfo]) {\r\n\r\n        // Remember dynamic classes on the first render\r\n        if (this._previousClasses === undefined) {\r\n            this._previousClasses = new Set();\r\n            if (part.strings !== undefined) {\r\n                this._staticClasses = new Set(part.strings\r\n                    .join(' ')\r\n                    .split(/\\s/)\r\n                    .filter((s) => s !== ''));\r\n            }\r\n\r\n            for (const name in classInfo) {\r\n                if (classInfo[name] && !this._staticClasses?.has(name)) {\r\n                    this._previousClasses.add(name);\r\n                }\r\n            }\r\n            return this.render(classInfo);\r\n        }\r\n\r\n        const classList = part.element.classList;\r\n\r\n        // Remove old classes that no longer apply\r\n        for (const name of this._previousClasses) {\r\n            if (!(name in classInfo)) {\r\n                classList.remove(name);\r\n                this._previousClasses.delete(name);\r\n            }\r\n        }\r\n\r\n        // Add or remove classes based on their classMap value\r\n        for (const name in classInfo) {\r\n            // We explicitly want a loose truthy check of `value` because it seems\r\n            // more convenient that '' and 0 are skipped.\r\n            const value = !!classInfo[name];\r\n            if (value !== this._previousClasses.has(name) &&\r\n                !this._staticClasses?.has(name)) {\r\n                if (value) {\r\n                    classList.add(name);\r\n                    this._previousClasses.add(name);\r\n                } else {\r\n                    classList.remove(name);\r\n                    this._previousClasses.delete(name);\r\n                }\r\n            }\r\n        }\r\n        return noChange;\r\n    }\r\n}\r\n\r\n/**\r\n * A directive that applies dynamic CSS classes.\r\n *\r\n * This must be used in the `css` attribute and must be the only part used in\r\n * the attribute. It takes each property in the `classInfo` argument and adds\r\n * the property name to the element's `classList` if the property value is\r\n * truthy; if the property value is falsey, the property name is removed from\r\n * the element's `css`.\r\n *\r\n * For example `{foo: bar}` applies the class `foo` if the value of `bar` is\r\n * truthy.\r\n *\r\n * @param classInfo\r\n */\r\nexport const cssMap = directive(CssMapDirective);\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport const notEmpty = (newVal, oldVal) => newVal !== oldVal && newVal;\r\nexport const numGT0 = (newVal, oldVal) => newVal !== oldVal && Number(newVal) > 0;\r\nexport const numGE0 = (newVal, oldVal) => newVal !== oldVal && Number(newVal) >= 0;\r\nexport const numLT0 = (newVal, oldVal) => newVal !== oldVal && Number(newVal) < 0;\r\nexport const numLE0 = (newVal, oldVal) => newVal !== oldVal && Number(newVal) <= 0;\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport const AutocapitalizeTypes = ['', 'none', 'off', 'on', 'sentences', 'words', 'characters'];\r\n\r\nexport const autocapitalize = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && AutocapitalizeTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport const AutocompleteTypes = ['', 'off', 'on'];\r\n\r\nexport const autocomplete = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && AutocompleteTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport const AutocorrectTypes = ['', 'on', 'off'];\r\n\r\nexport const autocorrect = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && AutocorrectTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\n\r\nexport class ButtonTypes {\r\n\r\n    static values = ['button', 'reset', 'submit'];\r\n\r\n    static is(val) {\r\n        return ButtonTypes.values.includes(val);\r\n    }\r\n\r\n    static isReset(val) {\r\n        return  ButtonTypes.isType(val, 'reset');\r\n    }\r\n\r\n    static isSubmit(val) {\r\n        return  ButtonTypes.isType(val, 'submit');\r\n    }\r\n\r\n    /**\r\n     * Check button type, by spec, if not set, default is 'submit'\r\n     * @param {*} type - button type\r\n     * @param {*} value - matching value\r\n     * @returns \r\n     */\r\n    static isType(type, value) {\r\n        return ButtonTypes.#normalize(type) === value;\r\n    }\r\n\r\n    static #normalize(type) {\r\n        return GSUtil.normalize(type, 'submit').toLowerCase();\r\n    }\r\n} \r\n\r\nexport const buttonType = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && ButtonTypes.is(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport const ColorTypes = ['', 'primary', 'secondary', 'dark', 'light', 'info', 'warning', 'danger', 'alert', 'link', 'success'];\r\n\r\nexport const color = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && ColorTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport const EnvironmentTypes = ['', 'desktop', 'mobile', 'tablet', 'android', 'linux', 'windows', 'macos', 'ios'];\r\n\r\nexport const environment = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && EnvironmentTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport const InputTypes = [\r\n   { type: 'checkbox', ignore: true},\r\n   { type: 'radio', ignore: true},\r\n   { type: 'switch', ignore: true},\r\n   { type: 'range', ignore: true},\r\n   { type: 'number', native: true},\r\n   { type: 'email', native: true},\r\n   { type: 'url',  native: true},\r\n   { type: 'file', native: true}, \r\n   { type: 'text'},\r\n   { type: 'password'}\r\n];\r\n\r\nexport const inputType = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && InputTypes.filter(o => o.type === newVal).length === 1;\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport const NavTypes = ['', 'pills', 'tabs', 'underline'];\r\n\r\nexport const nav = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && NavTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport class OrientationTypes {\r\n\r\n    static values =  ['', 'horizontal', 'vertical', 'portrait', 'landscape'];\r\n\r\n    static includes(val) {\r\n        return OrientationTypes.values.includes(val);\r\n    }\r\n\r\n    static isVertical(val) {\r\n        const idx = OrientationTypes.values.indexOf(val);\r\n        return idx === 2 || idx === 3;\r\n    }\r\n\r\n    static isHorizontal(val) {\r\n        const idx = OrientationTypes.values.indexOf(val);\r\n        return idx === 1 || idx === 4;\r\n    }\r\n\r\n}\r\n\r\nexport const orientation = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && OrientationTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport class PlacementTypes {\r\n\r\n    static values = ['center', 'left', 'right', 'start', 'end', 'top', 'bottom'];\r\n\r\n    static includes(val) {\r\n        return PlacementTypes.values.includes(val);\r\n    }\r\n\r\n    static isVertical(val) {\r\n        return PlacementTypes.values.indexOf(val) > 4;\r\n    }\r\n\r\n    static isHorizontal(val) {\r\n        const idx = PlacementTypes.values.indexOf(val)\r\n        return idx > 0 && idx < 5;\r\n    }\r\n\r\n    static isCenter(val) {\r\n        return PlacementTypes.values.indexOf(val) === 0;\r\n    }\r\n\r\n    static isBefore(val) {\r\n        return ['left', 'start', 'top'].includes(val);\r\n    }\r\n\r\n    static isAfter(val) {\r\n        return ['right', 'end', 'bottom'].includes(val);\r\n    }\r\n}\r\n\r\n\r\nexport const placement = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && PlacementTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport class PositionTypes {\r\n\r\n    static values = ['absolute', 'fixed', 'relative', 'sticky', 'static'];\r\n\r\n    static includes(val) {\r\n        return PositionTypes.values.includes(val);\r\n    }\r\n}\r\n\r\n\r\nexport const position = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && PositionTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport const ProtocolTypes = ['', 'http', 'https'];\r\n\r\nexport const protocol = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && ProtocolTypes.includes(newVal);\r\n    }\r\n\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport const SizeTypes = { 'default' : '', 'normal': '',  'medium': '', 'small': 'sm', 'large': 'lg', 'big' : 'lg', 'extra' : 'xl' };\r\n\r\nexport const size = {\r\n    hasChanged(newVal, oldVal) {\r\n        return newVal !== oldVal && Object.hasOwn(SizeTypes, newVal);\r\n    }\r\n\r\n};","export const stringArrayConverter = {\r\n    fromAttribute: (value, type) => {\r\n        return (value || '').split(',');\r\n    },\r\n    toAttribute: (value, type) => {\r\n        return (value || []).join(',');\r\n    }\r\n};","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDynamicStyle } from '../base/GSDynamicStyle.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSCacheStyles } from '../base/GSCacheStyles.mjs';\r\n\r\n/**\r\n * Controller register self to gs-adopted event listener list.\r\n * Every time even gs-adopted is triggered by the GSAdoptedEngien class,\r\n * all registerd controller will be processed for reapplaying stylesheet \r\n * Also, this controlelr takes care of adding custom dynamic styles \r\n * to the end fo the list.\r\n * \r\n * Custom dynamic styles are used internally by the components for dynamic \r\n * style changes to preven dom node polution; \r\n * Style  changes  are not visible directly on DOM node.\r\n */\r\nexport class AdoptedController {\r\n\r\n  #host;\r\n  #dynamic;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    AdoptedController.#controllers.add(me);\r\n    me.#adopt();\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    AdoptedController.#controllers.delete(me);\r\n    me.#host.removeController(me);\r\n    me.#host = null;\r\n    me.#dynamic = null;\r\n  }\r\n\r\n  /**\r\n   * Initialize dynamic style for component instance\r\n   * Call it from constructor for style to be applied to the current component\r\n   * @param {String} name CSS class name\r\n   * @param {Object|String} values CSS class styles to be applied\r\n   * @returns {CSSStyleRule} An instance of a CSS class\r\n   */\r\n  style(name, values, isGlobal = false) {\r\n    const me = this;\r\n    let style = null;\r\n    if (isGlobal) {\r\n      style = GSCacheStyles.dynamic;\r\n    } else {\r\n      me.#dynamic = me.#dynamic ?? new GSDynamicStyle('dynamic');      \r\n      style = me.#dynamic;\r\n    }    \r\n    if (values === null && style.rules.length > 0 ) return style.removeRule(name);\r\n    return style.setRule(name, values, true);\r\n  }\r\n\r\n  #adopt(forced = false) {\r\n    const me = this;\r\n    if (!me.#sheets) return;\r\n    if (forced || me.#changed) {\r\n      const sheets = [...document.adoptedStyleSheets];\r\n      // support for lit \"static styles = css``\"\r\n      const internal = Array.from(me.#sheets);\r\n      if (me.#dynamic) internal.push(me.#dynamic);\r\n      me.#root.adoptedStyleSheets = [...sheets, ...internal];\r\n    }\r\n  }\r\n\r\n  get #changed() {\r\n    return document.adoptedStyleSheets.id !== this.#sheets?.id;\r\n  }\r\n\r\n  get #root() {\r\n    return this.#host?.renderRoot;\r\n  }\r\n\r\n  get #sheets() {\r\n    return this.#root?.adoptedStyleSheets;\r\n  }\r\n\r\n  /**\r\n   * Global listener for gs-adopted event triggered from GSAdoptedEngine\r\n   */\r\n  static #controllers = new Set();\r\n\r\n  static #onAdopted(e) {\r\n    requestAnimationFrame(() => {\r\n      AdoptedController.#controllers.forEach(c => c.#adopt());\r\n    });\r\n  }\r\n\r\n  static #init() {\r\n    const me = AdoptedController;\r\n    GSEvents.on(window, null, 'gs-adopted', me.#onAdopted);\r\n  }\r\n\r\n  static {\r\n    this.#init();\r\n  }\r\n\r\n}  \r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSAttributeHandler } from \"../base/GSAttributeHandler.mjs\";\r\nimport { GSDOM } from \"../base/GSDOM.mjs\";\r\n\r\n/**\r\n * Attributes to control click actions for buttons and links.\r\n * Used to brings meta linking between UI elements\r\n */\r\nexport class AttributeController extends GSAttributeHandler {\r\n\r\n  constructor(host) {\r\n    super(host);\r\n    const me = this;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.attach(me.#eventName);\r\n    // me.host.on('notify', e => me.onNotify(e));\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.host.removeController(me);\r\n    me.detach(me.#eventName);\r\n  }\r\n\r\n  onNotify(evt) {\r\n    const me = this;\r\n    me.handle(evt);\r\n  }\r\n\r\n  get #eventName() {\r\n    const tag = this.host?.tagName.toLowerCase();\r\n    const clazz = this.host?.clazzName;\r\n    const isFormEl = GSDOM.isFormElement(this.host);\r\n    const v1 = ['gs-form', 'gs form-group'].includes(tag);\r\n    const v2 = ['GSFormGroupElement'].includes(clazz);\r\n    return v1 || v2 || isFormEl ? 'change' : 'click';\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSDOM } from \"../base/GSDOM.mjs\";\r\n\r\n/**\r\n * Handle rendered content cleanup (remove by default)\r\n * Set \"keep\" to the component to prevent rendered content removal.\r\n */\r\nexport class ContentController {\r\n\r\n  #host;\r\n  #ref;\r\n  #refs = new Set();\r\n\r\n  constructor(host) {\r\n    this.#host = host;\r\n    host.addController(this);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#removeContent();\r\n    me.#host = null;\r\n    me.#refs = null;\r\n    me.#ref = null;\r\n  }\r\n\r\n  // called only once, before host.firstUpdate\r\n  hostUpdated() {\r\n    const me = this;\r\n    if (!me.#isSelf() && me.#target) me.#refs.add(me.#target);\r\n  }\r\n\r\n  get contentRef() {\r\n    return this.#ref;\r\n  }\r\n\r\n  get #options() {\r\n    return this.#host?.renderOptions;\r\n  }\r\n\r\n  get #target() {\r\n    return this.#options?.renderBefore?.previousElementSibling;\r\n  }\r\n\r\n  #isSelf() {\r\n    const me = this;\r\n    const target = me.#target;\r\n    const root = me.#host?.renderRoot;\r\n    const shadow = me.#host?.shadowRoot;\r\n    return (target === shadow || target == root);\r\n  }\r\n\r\n  #removeContent() {\r\n    const me = this;\r\n    if (!me.#host?.keep) {\r\n      Array.from(me.#refs)\r\n        .filter(el => el ? true : false)\r\n        .forEach(el => GSDOM.cleanup(el));\r\n    }\r\n    me.#refs?.clear();\r\n  }\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSLog } from \"../base/GSLog.mjs\";\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\nimport { DataSelector } from \"../data/DataSelector.mjs\";\r\nimport { GSReadWriteRegistry } from \"../data/ReadWriteRegistry.mjs\";\r\n\r\n/**\r\n * Controller between component and DataReadWrite.\r\n */\r\nexport class DataController {\r\n\r\n  #host;\r\n\r\n  #readCallback;\r\n  #writeCallback;\r\n  #errorCallback;\r\n  #selectCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#readCallback = me.#onRead.bind(me);\r\n    me.#writeCallback = me.#onWrite.bind(me);\r\n    me.#errorCallback = me.#onError.bind(me);\r\n    me.#selectCallback = me.#onSelect.bind(me);\r\n    me.#host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.#listen(false);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#unlisten();\r\n    me.#host.removeController(me);\r\n  }\r\n\r\n  async read(obj) {\r\n    return this.store?.read(this.#host);\r\n  }\r\n\r\n  async write(obj) {\r\n    return this.store?.write(this.#host, obj);\r\n  }\r\n\r\n  async storage() {\r\n    return GSReadWriteRegistry.wait(this.storeID);\r\n  }\r\n\r\n  sort(val) {\r\n    if (!this.store) return;\r\n    this.store.sort = val;\r\n    return this.store.read();\r\n  } \r\n\r\n  filter(val) {\r\n    if (!this.store) return;\r\n    this.store.filter = val;\r\n    return this.store.read();\r\n  }\r\n\r\n  search(val) {\r\n    if (!this.store) return;\r\n    this.store.search = val;\r\n  }\r\n\r\n  firstPage() {\r\n    this.page = 1;\r\n  }\r\n\r\n  lastPage() {\r\n    this.nextPage();\r\n  }\r\n\r\n  nextPage() {\r\n    this.page = this.page + 1;\r\n  }\r\n\r\n  prevPage() {\r\n    this.page = this.page - 1;\r\n  }\r\n\r\n  get selected() {\r\n    return this.store?.selected;\r\n  }\r\n\r\n  isSelected(val) {\r\n    return this.#selector.isSelected(val);\r\n  }\r\n\r\n  addSelected(val) {\r\n    return this.#selector.addSelected(val);\r\n  }\r\n  \r\n  removeSelected(val) {\r\n    return this.#selector.removeSelected(val);\r\n  }\r\n\r\n  clearSelected(data) {\r\n    return this.#selector.clearSelected(data);\r\n  }\r\n\r\n  getSelected(data) {\r\n    return GSUtil.asArray(data).filter(o => DataSelector.isSelected(o));\r\n  }\r\n\r\n  get #selector() {\r\n    return this.store || DataSelector;\r\n  }\r\n\r\n  get store() {\r\n    return GSReadWriteRegistry.find(this.storeID);\r\n  }\r\n\r\n  get storeID() {\r\n    return this.#host?.storage;\r\n  }\r\n\r\n  get page() {\r\n    const store = this.store;\r\n    return store ? Math.floor(store.skip / Math.max(store.limit, 1)) + 1 : 1;\r\n  }\r\n\r\n  set page(val) {\r\n    val = Math.max(1, GSUtil.asNum(val, 1));    \r\n    const store = this.store;\r\n    if (store) {\r\n      store.skip = val > 0 ? (store.limit * val) - store.limit : 0;\r\n      store.read(this.#host);\r\n    }\r\n  }\r\n\r\n  async #listen(read = true) {\r\n    const me = this;\r\n    const storage = await me.storage();\r\n    if (storage) {\r\n      storage.on('read', me.#readCallback);\r\n      storage.on('write', me.#writeCallback);\r\n      storage.on('error', me.#errorCallback);\r\n      storage.on('select', me.#selectCallback);\r\n      if (read) storage.read(me.#host);\r\n    }\r\n  }\r\n\r\n  #unlisten() {\r\n    const me = this;\r\n    const storage = me.store;\r\n    if (storage) {\r\n      storage.off('read', me.#readCallback);\r\n      storage.off('write', me.#writeCallback);\r\n      storage.off('error', me.#errorCallback);\r\n      storage.off('select', me.#selectCallback);\r\n    }\r\n  }\r\n\r\n  #onSelect(e) {\r\n    this.#host.requestUpdate?.();\r\n  }\r\n\r\n  #onRead(e) {\r\n    const me = this;\r\n    me.#host.onDataRead?.(e.detail.data);\r\n    me.#notify('data-read', e.detail.data);\r\n  }\r\n\r\n  #onWrite(e) {\r\n    const me = this;\r\n    me.#host.onDataWrite?.(e.detail.data);\r\n    me.#notify('data-write', e.detail.data);\r\n  }\r\n\r\n  #onError(e) {\r\n    const me = this;\r\n    GSLog.error(me.#host, e);\r\n    me.#host.onDataError?.(e);\r\n    me.#notify('data-error', e.detail.data);\r\n  }\r\n\r\n  #notify(name, data) {\r\n    this.#host.emit(name, data, true, false, true);\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Controller for elment move events, properly handling mouse events.\r\n */\r\nexport class ElementMoveController {\r\n\r\n  #host;\r\n  #element;\r\n  #attached = false;\r\n\r\n  #cursorX = 0;\r\n  #cursorY = 0;\r\n\r\n  #mouseUpCallback;\r\n  #mouseDownCallback;\r\n  #mouseMoveCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n    me.#mouseUpCallback = me.#onMouseUp.bind(me);\r\n    me.#mouseDownCallback = me.#onMouseDown.bind(me);\r\n    me.#mouseMoveCallback = me.#onMouseMove.bind(me);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host = null;\r\n  }\r\n\r\n  attach(element) {\r\n    const me = this;\r\n    if (!me.#attached) {\r\n      me.#element = element;\r\n      me.#attached = true;\r\n      me.#host.attachEvent(me.#element, 'mousedown', me.#mouseDownCallback);\r\n    }\r\n  }\r\n\r\n  reset() {\r\n    const me = this;\r\n    me.#cursorX = 0;\r\n    me.#cursorY = 0;\r\n    me.#host.removeEvent(document, 'mouseup', me.#mouseUpCallback);\r\n    me.#host.removeEvent(document, 'mousemove', me.#mouseMoveCallback);\r\n  }\r\n\r\n  /**\r\n  * Call host onStartMove function\r\n  * @param {MouseEvent} e \r\n  */\r\n  #onMouseDown(e) {\r\n    const me = this;\r\n    me.#host.prevent(e);\r\n    me.#cursorX = e.clientX;\r\n    me.#cursorY = e.clientY;\r\n    me.#host.onStartMove?.(e, me.#cursorX, me.#cursorY);\r\n    me.#host.attachEvent(document, 'mouseup', me.#mouseUpCallback, true);\r\n    me.#host.attachEvent(document, 'mousemove', me.#mouseMoveCallback);\r\n  }\r\n\r\n  /**\r\n   * Remove mousemove listener and call host onEndMove function\r\n   * @param {MouseEvent} e \r\n   */\r\n  #onMouseUp(e) {\r\n    const me = this;\r\n    me.#host.prevent(e);\r\n    me.#host.removeEvent(document, 'mousemove', me.#mouseMoveCallback);\r\n    return me.#host.onEndMove?.(e, me.#cursorX, me.#cursorY);\r\n  }\r\n\r\n  /**\r\n   * Call host onMouseMove function\r\n   * @param {MouseEvent} e \r\n   */\r\n  #onMouseMove(e) {\r\n    const me = this;\r\n    me.#host.prevent(e);\r\n\r\n    me.#host.onMouseMove?.(e, me.#cursorX, me.#cursorY);\r\n\r\n    if (me.#cursorX < e.clientX) {\r\n      me.#host.onCursorRight?.(e, me.#cursorX, me.#cursorY);\r\n    } else if (me.#cursorX > e.clientX) {\r\n      me.#host.onCursorLeft?.(e, me.#cursorX, me.#cursorY);\r\n    }\r\n\r\n    if (me.#cursorY < e.clientY) {\r\n      me.#host.onCursorUp?.(e, me.#cursorX, me.#cursorY);\r\n    } else if (me.#cursorY > e.clientY) {\r\n      me.#host.onCursorDown?.(e, me.#cursorX, me.#cursorY);\r\n    }\r\n\r\n    me.#cursorX = e.clientX;\r\n    me.#cursorY = e.clientY;\r\n\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\n\r\n/**\r\n * Listens for theme change and update component to apply new theme.\r\n * External theme changes only if component theme is not set.\r\n * Bootstrap uses CSS selector for theme in form of attribute value [data-bs-theme=\"***\"]\r\n * Compoennt and all first level childern in shadow dom are updated\r\n */\r\nexport class LocalizationController {\r\n\r\n  #host;\r\n  #language;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#language = host.language;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    LocalizationController.#controllers.add(this);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    LocalizationController.#controllers.delete(me);\r\n    me.#host.removeController(me);\r\n    me.#host = null;\r\n    me.#language = null;\r\n  }\r\n\r\n  // called every time host is updated\r\n  hostUpdate() {\r\n    const me = this;\r\n    if (me.#language !== me.#host?.language) {\r\n      me.#language === me.#host?.language;\r\n      me.updateLanguage(me.#language);\r\n    }\r\n  }\r\n\r\n  updateLanguageExt(langauge) {\r\n    if (!this.#language) this.updateLanguage(langauge);\r\n  }\r\n\r\n  updateLanguage(lang) {\r\n    if (!lang) return;\r\n    this.#host.requestUpdate();\r\n  }\r\n\r\n  static #controllers = new Set();\r\n\r\n  static #onLanguage(e) {\r\n    const me = LocalizationController;\r\n    me.#controllers.forEach(c => c.updateLanguageExt(e.detail));\r\n  }\r\n\r\n  static #init() {\r\n    GSEvents.on(window, null, 'gs-language', LocalizationController.#onLanguage);\r\n  }\r\n\r\n  static {\r\n    LocalizationController.#init();\r\n  }\r\n\r\n}  \r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Handle screen orientation events.\r\n * Trigger rerender to optionally hide element if \r\n * screen orientation is not supported\r\n */\r\nexport class OrientationController {\r\n\r\n    static #hosts = new Set();\r\n    #host;\r\n    \r\n    constructor(host) {\r\n      this.#host = host;\r\n      host.addController(this);\r\n    }\r\n    \r\n    hostConnected() {\r\n      OrientationController.#hosts.add(this);\r\n      this.update();\r\n    }\r\n    \r\n    hostDisconnected() {\r\n      const me = this;\r\n      OrientationController.#hosts.delete(me);\r\n      me.#host.removeController(me);      \r\n      me.#host = null;\r\n    }\r\n\r\n    update() {\r\n      this.#host.requestUpdate();\r\n    }\r\n\r\n    static #onOrientation(e) {\r\n      Array.from(OrientationController.#hosts).forEach(h => h.update());\r\n    }\r\n    \r\n    static {\r\n      screen.orientation.addEventListener('change', OrientationController.#onOrientation);\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../base/GSUtil.mjs\";\r\nimport { GSTemplateCache } from \"../base/GSTemplateCache.mjs\";\r\nimport { GSDOM } from \"../base/GSDOM.mjs\";\r\n\r\n// internal hidden flag to prevent double injection\r\nconst RENDER_SYMBOL = Symbol.for(\"GS-TEMPLATE-RENDER\");\r\n\r\n/**\r\n * Handle element template and signal rerender when ready\r\n * Sequencial template load is used to prevent multiple request for the same URL\r\n */\r\nexport class TemplateController {\r\n\r\n  #host;\r\n  #template;\r\n  #lastRef;\r\n  #once;\r\n\r\n  static #scheduled = false;\r\n  static #tasks = new Set();\r\n  static #cache = new Map();\r\n  static #refs = new Set();\r\n\r\n  static get isPrefetch() {\r\n    return globalThis.GS_TEMPLATE_PREFETCH || false;\r\n  }\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#once = true;\r\n    host[RENDER_SYMBOL] = false;\r\n    host.addController(this);\r\n  }\r\n\r\n  // inherited\r\n  hostConnected() {\r\n    const me = this;\r\n    /* \r\n    if(TemplateController.isPrefetch) {\r\n      me.hostUpdate();\r\n    }\r\n    */\r\n  }\r\n\r\n  // inherited\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    delete me.#host[RENDER_SYMBOL];\r\n    me.#host = null;\r\n    me.#lastRef = null;\r\n    me.#template = null;\r\n  }\r\n\r\n  // inherited\r\n  hostUpdate() {\r\n    const me = this;\r\n    if (me.#template) return;\r\n    const ref = me.templateRef;\r\n    if (me.#lastRef !== ref) {\r\n      const template = TemplateController.#cache.get(me.#toKey(ref));\r\n      if (GSUtil.isJsonType(template)) me.#applyTemplate(template);\r\n      me.#lastRef = ref;\r\n      if (ref && !me.#template) {\r\n        TemplateController.#schedule(me);\r\n      }\r\n    }\r\n  }\r\n\r\n  // inherited\r\n  hostUpdated() {\r\n    const me = this;\r\n    const host = me.#host;\r\n    if (me.#template && me.#once) {\r\n      me.#once = false;\r\n      //host.removeController(me);\r\n      host.templateInjected?.();\r\n      //queueMicrotask(()=> me.hostDisconnected());\r\n    }\r\n\r\n  }\r\n\r\n  #toKey(ref) {\r\n    const me = this;\r\n    return GSUtil.isString(ref) ? `${ref}@${me.#host?.tagName || ''}` : ref;\r\n  }\r\n\r\n  #hasKey(key) {\r\n    return TemplateController.#refs.has(key) || TemplateController.#cache.has(key);\r\n  }\r\n\r\n  // applly template opts {simple, slots}\r\n  #applyTemplate({ simple, slots }) {\r\n\r\n    // is template does not contain slots\r\n    const me = this;\r\n    if (!me.#host) return;\r\n\r\n    const hasSlots = GSDOM.isTemplateElement(slots);\r\n    const hasSimple = GSDOM.isTemplateElement(simple);\r\n\r\n    let signal = true;\r\n\r\n    if (hasSlots) {\r\n      // slot elements must be added only once \r\n      if (me.#host[RENDER_SYMBOL] === false) {\r\n        me.#host[RENDER_SYMBOL] = true;\r\n        const clone = slots.cloneNode(true);\r\n        Array.from(clone.content.children).forEach(el => me.#host.appendChild(el));\r\n      }\r\n    }\r\n\r\n    if (hasSimple) {\r\n      if (simple.content.childElementCount > 0) {\r\n        signal = false;\r\n        me.#template = simple.cloneNode(true);\r\n        me.#host.requestUpdate();\r\n      }\r\n    }\r\n\r\n    if (signal) me.#host.templateInjected?.();\r\n\r\n  }\r\n\r\n  // separate first level nodes into sloted nodes and plain shadow injectable node \r\n  #preprocessTemplate(template) {\r\n    let templateSimple = null;\r\n    let templateSlots = null;\r\n    const slots = Array.from(template.content.children).filter(el => el.hasAttribute('slot'));\r\n    const hasSlots = slots.length > 0;\r\n    const hasSimple = template.content.childElementCount > slots.length;\r\n    if (hasSlots) {\r\n      if (hasSimple) {\r\n        templateSlots = document.createElement('template');\r\n        slots.forEach(el => templateSlots.content.appendChild(el));\r\n      } else {\r\n        templateSlots = template;\r\n      }\r\n    }\r\n    templateSimple = hasSimple && template?.content.childElementCount > 0 ? template : null;\r\n    templateSlots = hasSlots && templateSlots?.content.childElementCount > 0 ? templateSlots : null;\r\n    // cache copy for page inejcted tempkates as they might be cleared elswhere\r\n    templateSimple = templateSimple?.isConnected ? templateSimple.cloneNode(true) : templateSimple;\r\n    return { simple: templateSimple, slots: templateSlots };\r\n  }\r\n\r\n  async #load() {\r\n\r\n    const me = this;\r\n    const ref = me.templateRef;\r\n    \r\n    if (!ref) return;\r\n    const key = me.#toKey(ref);\r\n\r\n    // prevents double load\r\n    if (me.#hasKey(key)) {\r\n      // already scheduled\r\n      return;\r\n    }\r\n    TemplateController.#refs.add(key);\r\n\r\n    let templates = null;\r\n\r\n    const isTplEl = GSDOM.isTemplateElement(ref);\r\n    const cacheable = GSUtil.isString(ref);\r\n    if (cacheable) {\r\n      templates = TemplateController.#cache.get(key);\r\n    }\r\n\r\n    if (!templates) {\r\n      \r\n      try {\r\n        const template = isTplEl ? ref : await GSTemplateCache.loadTemplate(true, ref, ref);\r\n        templates = me.#preprocessTemplate(template);\r\n      } catch (err) {\r\n        TemplateController.#refs.delete(key);\r\n        throw err;\r\n      }\r\n\r\n      if (cacheable) {\r\n        if (templates.simple) templates.simple.dataset.gsCache = true;\r\n        TemplateController.#cache.set(key, templates);\r\n      }\r\n    }\r\n    \r\n    TemplateController.#refs.delete(key);\r\n    me.#applyTemplate(templates);\r\n  }\r\n\r\n  get isTemplateElement() {\r\n    return this.#host?.tagName === 'GS-TEMPLATE';\r\n  }\r\n\r\n  get template() {\r\n    return this.#template;\r\n  }\r\n\r\n  get templateRef() {\r\n    return GSDOM.templateRef(this.#host);\r\n  }\r\n\r\n  static async #process(tasks) {\r\n    const list = Array.from(tasks);\r\n    for (let item of list) {\r\n      await item.#load();\r\n      tasks.delete(item);\r\n    }\r\n  }\r\n\r\n  static #schedule(task) {\r\n    const me = TemplateController;\r\n    me.#tasks.add(task);\r\n    if (!me.#scheduled) {\r\n      me.#scheduled = true;\r\n      queueMicrotask(() => me.#process(me.#tasks).finally(me.#scheduled = false));\r\n    }\r\n  }\r\n\r\n  static clear() {\r\n    GSTemplateCache.clear();\r\n    TemplateController.#tasks.clear();\r\n    TemplateController.#cache.clear();\r\n    TemplateController.#refs.clear();\r\n  }\r\n\r\n}  \r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\n\r\n/**\r\n * Listens for theme change and update component to apply new theme.\r\n * External theme changes only if component theme is not set.\r\n * Bootstrap uses CSS selector for theme in form of attribute value [data-bs-theme=\"***\"]\r\n * Compoennt and all first level childern in shadow dom are updated\r\n */\r\nexport class ThemeController {\r\n\r\n  #host;\r\n  #theme;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#theme = host.theme;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    ThemeController.#controllers.add(this);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    ThemeController.#controllers.delete(me);\r\n    me.#host.removeController(me);\r\n    me.#host = null;\r\n    me.#theme = null;\r\n  }\r\n\r\n  hostUpdate() {\r\n    const me = this;\r\n    if (me.#theme !== me.#host?.theme) {\r\n      me.#theme === me.#host?.theme;\r\n      me.updateTheme(me.#theme);\r\n    }\r\n  }\r\n\r\n  updateThemeExt(theme) {\r\n    if (!this.#theme) this.updateTheme(theme);\r\n  }\r\n\r\n  updateTheme(theme) {\r\n    if (!theme) return;\r\n    const me = this;\r\n    GSAttr.set(me.#host, 'data-bs-theme', theme);\r\n    const children = me.#host?.renderRoot?.children || [];\r\n    Array.from(children).forEach(el => GSAttr.set(el, 'data-bs-theme', theme));\r\n  }\r\n\r\n  static #controllers = new Set();\r\n\r\n  static #onTheme(e) {\r\n    const me = ThemeController;\r\n    me.#controllers.forEach(c => c.updateThemeExt(e.detail));\r\n  }\r\n\r\n  static #init() {\r\n    GSEvents.on(window, null, 'gs-theme', ThemeController.#onTheme);\r\n  }\r\n\r\n  static {\r\n    ThemeController.#init();\r\n  }\r\n\r\n}  \r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Handle event when template slot changes\r\n */\r\nexport class SlotController {\r\n\r\n    #host;\r\n    \r\n    constructor(host) {\r\n      this.#host = host;\r\n      host.addController(this);\r\n    }\r\n    \r\n    hostConnected() {\r\n      const me = this;\r\n      const target = me.#host.renderRoot || me.#host;\r\n      me.#host.attachEvent(target, 'slotchange', me.#onSlotChanged.bind(me));\r\n    }\r\n    \r\n    hostDisconnected() {\r\n      const me = this;\r\n      me.#host.removeController(me);      \r\n      me.#host = null;\r\n    }\r\n\r\n    #onSlotChanged(e) {\r\n      if (typeof e.target.assignedElements === 'function') {\r\n        e.target.assignedElements().forEach(el => {\r\n          el.onSlotInjected?.(e.target);\r\n        });\r\n      }\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { templateContent, noChange, LitElement, CSSResult } from './lib.mjs';\r\n\r\nimport { GSEvents } from './base/GSEvents.mjs';\r\nimport { GSEnvironment } from './base/GSEnvironment.mjs';\r\nimport { GSFunction } from './base/GSFunction.mjs';\r\nimport { GSLocalization } from './base/GSLocalization.mjs';\r\nimport { AdoptedController } from './controllers/AdoptedController.mjs';\r\nimport { ContentController } from './controllers/ContentController.mjs';\r\nimport { AttributeController } from './controllers/AttributeController.mjs';\r\nimport { LocalizationController } from './controllers/LocalizationController.mjs';\r\nimport { OrientationController } from './controllers/OrientationController.mjs';\r\nimport { TemplateController } from './controllers/TemplateController.mjs';\r\nimport { orientation } from './properties/orientation.mjs';\r\nimport { protocol } from './properties/protocol.mjs';\r\nimport { environment } from './properties/environment.mjs';\r\nimport { ThemeController } from './controllers/ThemeController.mjs';\r\nimport { notEmpty } from './properties/verificator.mjs';\r\nimport { DataController } from './controllers/DataController.mjs';\r\nimport { GSDOM } from './base/GSDOM.mjs';\r\nimport { GSData } from './base/GSData.mjs';\r\nimport { GSUtil } from './base/GSUtil.mjs';\r\nimport { SlotController } from './controllers/SlotController.mjs';\r\nimport { GSAttributeHandler } from './base/GSAttributeHandler.mjs';\r\nimport { GSDOMObserver } from './base/GSDOMObserver.mjs';\r\n\r\n/**\r\n * Main WebComponent used by all other GS-* components\r\n */\r\nexport class GSElement extends LitElement {\r\n\r\n  static properties = {\r\n    flat: { type: Boolean },\r\n    rtl: { type: Boolean, reflect: true },\r\n    hide: { type: Boolean, reflect: true },\r\n    padding: { type: Number },\r\n    margin: { type: Number },\r\n    rounded: { type: Boolean },\r\n    bordered: { type: Boolean },\r\n    shadow: { type: Boolean },\r\n    keep: { type: Boolean },\r\n\r\n    onready: {},\r\n    css: {},\r\n    theme: {},\r\n\r\n    os: {},\r\n    browser: {},\r\n    language: { reflect: true, hasChanged: notEmpty },\r\n    environment: environment,\r\n    orientation: orientation,\r\n    protocol: protocol,\r\n\r\n    template: {}\r\n  }\r\n\r\n  #adopted = undefined;\r\n  #uiHandler = undefined;\r\n  #orientation = undefined;\r\n  #localization = undefined;\r\n  #dataController = undefined;\r\n  #slotController = undefined;\r\n  #themes = undefined;\r\n  #template = undefined;\r\n  #content = undefined;\r\n  \r\n  #ref = undefined;\r\n  #refs = undefined;\r\n  #refx = undefined;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.css = '';\r\n    me.language = \"\";\r\n    me.#adopted = new AdoptedController(me);\r\n    me.#content = new ContentController(me);\r\n    me.#localization = new LocalizationController(me);\r\n    me.#orientation = new OrientationController(me);\r\n    //me.#template = new TemplateController(me);\r\n    me.#themes = new ThemeController(me);\r\n    me.#slotController = new SlotController(me);\r\n  }\r\n\r\n  attributeChangedCallback(name, oldValue, newValue) {\r\n    super.attributeChangedCallback(name, oldValue, newValue);\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    const me = this;\r\n    const tpl = GSDOM.templateRef(me);\r\n    if (tpl) me.#template = new TemplateController(me);\r\n    if (me.isBindable) me.binded();\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    const me = this;\r\n    GSEvents.detachListeners(this);\r\n    super.disconnectedCallback();\r\n    me.#ref?.clear();\r\n    me.#refs?.clear();\r\n    me.#refx?.clear();\r\n    me.#ref = null;\r\n    me.#refs = null;\r\n    me.#refx = null;\r\n    me.#adopted = null;\r\n    me.#uiHandler = null;\r\n    me.#orientation = null;\r\n    me.#localization = null;\r\n    me.#dataController = null;\r\n    me.#slotController = null;\r\n    me.#themes = null;\r\n    me.#template = null;\r\n    me.#content = null;\r\n    //me.renderOptions = null;\r\n    me.adoptedStyleSheets = [];\r\n    const shadow = this.shadowRoot;\r\n    if (shadow) {\r\n      //if (shadow._$litPart$) shadow._$litPart$ = null;\r\n      shadow.adoptedStyleSheets = [];\r\n      // shadow.innerHTML = '';\r\n      //GSDOM.cleanup(shadow);\r\n      queueMicrotask(() => GSDOM.cleanup(shadow));\r\n    }\r\n    queueMicrotask(() => GSDOM.cleanup(me));\r\n    // GSDOM.cleanup(me);\r\n    // console.log('removed', me);\r\n  }\r\n\r\n  shouldUpdate(changedProperties) {\r\n    return this.isConnected; // && this.isAllowRender;\r\n  }\r\n\r\n  /**\r\n   * Override Lit element createRenderRoot function.\r\n   * If flat, do not create shadowDom, render within self\r\n   * @returns \r\n   */\r\n  createRenderRoot() {\r\n    return this.flat ? this : super.createRenderRoot();\r\n  }\r\n\r\n  /**\r\n   * Override Lit element firstUpdated function.\r\n   * Here we call attribute script onready if available\r\n   * Make sure that inherited classes calls super.firstUpdated\r\n   */\r\n  firstUpdated() {\r\n    super.firstUpdated();\r\n    const me = this;\r\n    if (me.onready) {\r\n      const owner = me.onready.startsWith('this') ? this : window;\r\n      GSFunction.callFunction(me.onready, owner);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Override Lit element willUpdate function.\r\n   * Make sure that inherited classes calls super.willUpdate\r\n   * @param {*} changed \r\n   */\r\n  willUpdate(changed) {\r\n    const me = this;\r\n    if (changed.has('storage')) {\r\n      me.#dataController?.hostDisconnected();\r\n      me.#dataController = undefined;\r\n      if (me.storage) {\r\n        me.#dataController = new DataController(me);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Called when this element injected in some slot\r\n   * @param {*} slot \r\n   */\r\n  onSlotInjected(slot) {\r\n\r\n  }\r\n\r\n  /**\r\n   * Override Lit element render function and control rendering\r\n   * @returns {*} Parsed lit html structure\r\n   */\r\n  render() {\r\n    return this.isAllowRender && !this.hide ? this.renderUI() : '';\r\n  }\r\n\r\n  /**\r\n   * Actual render function to override in inherited components\r\n   * @returns {*} Parsed lit html structure\r\n   */\r\n  renderUI() {\r\n    return this.renderTemplate();\r\n  }\r\n\r\n  /**\r\n   * Render html from provided template element or template url\r\n   * @returns {*}\r\n   */\r\n  renderTemplate() {\r\n    return this.templateRef ? templateContent(this.templateRef) : noChange;\r\n  }\r\n\r\n  /**\r\n   * Render this class css attributes.\r\n   * @returns {Object} JSON object with CSS properties\r\n   */\r\n  renderClass() {\r\n    const me = this;\r\n    const obj = {\r\n      'border': me.bordered,\r\n      'shadow-sm': me.shadow,\r\n      'rounded': me.rounded,\r\n      [`p-${me.padding}`]: me.padding >= 0,\r\n      [`m-${me.margin}`]: me.margin >= 0\r\n    };\r\n    return me.mapCSS(me.css, obj);\r\n  }\r\n\r\n  /**\r\n   * Called when asynchronnous template is injected into component\r\n   */\r\n  templateInjected() {\r\n\r\n  }\r\n\r\n  /**\r\n   * Attach bindings\r\n   */\r\n  binded() {\r\n    this.#uiHandler ??= new AttributeController(this);\r\n  }\r\n\r\n  /**\r\n   * Handle bindings \r\n   * @param {*} e \r\n   */\r\n  handle(e) {\r\n    this.#uiHandler?.handle(e);\r\n  }\r\n\r\n  /**\r\n   * Parse CSS string into JSON object\r\n   * @param {String} css CSS string to parse into JSON object\r\n   * @param {Object} obj JSON object to witch to add parsed CSS\r\n   * @returns {Object} css parsed JSON object \r\n   */\r\n  mapCSS(css, obj, flag = true) {\r\n    obj = obj || {};\r\n    (css || '').split(' ')\r\n      .map(v => v.trim())\r\n      .filter(v => v.length > 0)\r\n      .map(v => obj[v.trim()] = flag);\r\n    return obj;\r\n  }\r\n\r\n  /**\r\n   * Initialize dynamic style for component.\r\n   * Call it from constructor for style to be applied to the component\r\n   * Creates a dynamic StyleSheet which holds dynamic StyleRules for template elements\r\n   * @param {String} id \r\n   * @param {String|Object} value \r\n   * @param {boolean} isGlobal \r\n   * @returns {CSSStyleRule}\r\n   */\r\n  dynamicStyle(id, value, isGlobal = false) {\r\n    return this.#adopted?.style(id, value, isGlobal);\r\n  }\r\n\r\n  /**\r\n   * Find element by its ID\r\n   * @param {String} name \r\n   * @returns {HTMLElement}\r\n   */\r\n  getByID(query = '') {\r\n    return GSDOM.getByID(this, query);\r\n  }\r\n\r\n  /**\r\n   * Find closest top element by CSS selector\r\n   * @param {String} query \r\n   * @param {Number} levels - walk limit\r\n   * @returns {HTMLElement}\r\n   */\r\n  closest(query = '', levels = -1, cached = false) {\r\n    const me = this;\r\n\r\n    let result = me.#refx?.get(query);\r\n    if (result && !result.isConnected) {\r\n      result = undefined;\r\n      me.#refx?.delete(query);\r\n    }\r\n    result ??= GSDOM.closest(this, query, levels);\r\n    \r\n    if (result && cached && !me.#ref?.has(query)) {\r\n      me.#refx ??= new Map();\r\n      me.#refx.set(query, result);\r\n    }\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Find element by CSS selector (top level is this element)\r\n   * @param {String} name \r\n   * @returns {HTMLElement}\r\n   */\r\n  query(query = '', shadow = false, cached = false) {\r\n    const me = this;\r\n\r\n    let result = me.#refs?.get(query);\r\n    if (result && !result.isConnected) {\r\n      result = undefined;\r\n      me.#refs?.delete(query);\r\n    }\r\n    result ??= GSDOM.query(this, query, false, shadow);\r\n    \r\n    if (result && cached && !me.#ref?.has(query)) {\r\n      me.#ref ??= new Map();\r\n      me.#ref.set(query, result);\r\n    }\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Find multiple elements by CSS selector (top level is this element)\r\n   * @param {String} query \r\n   * @returns {Array<HTMLElement>}\r\n   */\r\n  queryAll(query = '', shadow = false, cached = false) {\r\n    const me = this;\r\n    let result = me.#refs?.get(query);\r\n    if (result && !result.isConnected) {\r\n      result = undefined;\r\n      me.#refs?.delete(query);\r\n    }\r\n    result ??= GSDOM.queryAll(this, query, false, shadow);\r\n    if (result && cached && !me.#refs?.has(query)) {\r\n      me.#refs ??= new Map();\r\n      me.#refs.set(query, result);\r\n    } \r\n    return result;        \r\n  }\r\n\r\n  /**\r\n   * Generic component signal\r\n   * @param {Boolean} bubbles  Does buuble to upper nodes\r\n   * @param {Boolean} composed Does traverse from shadow DOM \r\n   */\r\n  notify(bubbles = true, composed = false, data) {\r\n    this.emit('notify', data, bubbles, composed, true);\r\n  }\r\n\r\n  /**\r\n   * Send event\r\n   * @param {String} name \r\n   * @param {Object} obj \r\n   * @param {Boolean} bubbles \r\n   * @param {Boolean} composed \r\n   * @param {Boolean} cancelable \r\n   */\r\n  emit(name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n    return GSEvents.send(this, name, obj, bubbles, composed, cancelable);\r\n  }\r\n\r\n  /**\r\n   * Wait for event to happen\r\n   * @async\r\n   * @param {String} name \r\n   * @returns {Promise}\r\n   */\r\n  waitEvent(name = '', timeout = 0) {\r\n    return GSEvents.wait(this, name, timeout);\r\n  }\r\n\r\n  /**\r\n   * Listen once for triggered event\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  once(name, func) {\r\n    return this.listen(name, func, true);\r\n  }\r\n\r\n  /**\r\n   * Alternative function for event listen\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  on(name, func, once = false) {\r\n    return this.listen(name, func, once);\r\n  }\r\n\r\n  /**\r\n   * Alternative function for event unlisten\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  off(name, func) {\r\n    return this.unlisten(name, func);\r\n  }\r\n\r\n  /**\r\n   * Prevent event firing up the DOM tree\r\n   * @param {Event} e \r\n   */\r\n  prevent(e, defaults, propagate, immediate) {\r\n    return GSEvents.prevent(e, defaults, propagate, immediate);\r\n  }\r\n\r\n  /**\r\n   * Attach event to this element\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  listen(name, func, once = false) {\r\n    return this.attachEvent(this, name, func, once);\r\n  }\r\n\r\n  /**\r\n   * Remove event from this element\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  unlisten(name, func) {\r\n    return this.removeEvent(this, name, func);\r\n  }\r\n\r\n  /**\r\n  * Generic event listener appender\r\n  * \r\n  * @param {HTMLElement} el Element on which to monitor for named events\r\n  * @param {String} name Event name to watch for\r\n  * @param {Function} fn Event trigger callback\r\n  * @param {Boolean} once Listen only once\r\n  * @returns {Boolean} State if attachment was successful\r\n  */\r\n  attachEvent(el, name = '', fn, once = false) {\r\n    return GSEvents.attach(this, el, name, fn, once);\r\n  }\r\n\r\n  /**\r\n  * Generic event listener remove\r\n  * @param {HTMLElement} el Element on which to monitor for named events\r\n  * @param {String} name Event name to watch for\r\n  * @param {Function} fn Event trigger callback\r\n  * @returns {Boolean} State if attachment was successful\t\r\n  */\r\n  removeEvent(el, name = '', fn) {\r\n    return GSEvents.remove(this, el, name, fn);\r\n  }\r\n\r\n  /**\r\n   * Generic element hide function\r\n   */\r\n  toggle() {\r\n    this.hide = !this.hide;\r\n  }\r\n\r\n  translate(value) {\r\n    return GSLocalization.translate(this.language, value);\r\n  }\r\n\r\n  get direction() {\r\n    if (GSUtil.isNull(this.rtl)) return undefined;\r\n    return this.rtl ? 'rtl' : 'ltr';\r\n  }\r\n\r\n  /**\r\n   * Check if component is bindable to process data-gs-atributes\r\n   */\r\n  get isBindable() {\r\n    //return this.dataset.gsTarget;\r\n    return GSAttributeHandler.isBindable(this);\r\n  }\r\n\r\n  /**\r\n   * Return true if current element or chadow dom child is focused\r\n   */\r\n  get isFocused() {\r\n    return this === document.activeElement;\r\n  }\r\n\r\n  /**\r\n   * Element tag name\r\n   */\r\n  get tag() {\r\n    return this.tagName.toLowerCase();\r\n  }\r\n\r\n  /**\r\n   * Reference to cached template if set\r\n   */\r\n  get templateRef() {\r\n    return this.#template?.template;\r\n  }\r\n\r\n  /**\r\n   * Reference to rendered content\r\n   */\r\n  get contentRef() {\r\n    return this.#content?.contentRef;\r\n  }\r\n\r\n  /**\r\n   * Reference to data controller if initialized\r\n   */\r\n  get dataController() {\r\n    return this.#dataController;\r\n  }\r\n\r\n  /**\r\n  * Check if element is allowed to be rendered\r\n  * @returns {Boolean} \r\n  */\r\n  get isAllowRender() {\r\n    // this.isConnected &&\r\n    return this.isValidEnvironment\r\n      && this.isValidBrowser\r\n      && this.isValidOS\r\n      && this.isValidProtocol\r\n      && this.isValidOrientation;\r\n  }\r\n\r\n  /**\r\n   * Returns if environment matched\r\n   * dektop, mobile, tablet, android, linux, winwdows, macos\r\n   * @returns {Boolean} \r\n   */\r\n  get isValidEnvironment() {\r\n    return GSEnvironment.isValidEnvironment(this.environment ?? '');\r\n  }\r\n\r\n  /**\r\n   * Return true if element can be rendered bysed on OS matching\r\n   * linux, windows...etc\r\n   * @returns {Boolean} \r\n   */\r\n  get isValidOS() {\r\n    return GSEnvironment.isDevice(this.os ?? '');\r\n  }\r\n\r\n  /**\r\n   * Returns if orientation matched for element rendering\r\n   * horizontal | landscape), vertical | portrait), ; return true if not set\r\n   * @returns {Boolean} \r\n   */\r\n  get isValidOrientation() {\r\n    return GSEnvironment.isValidOrientation(this.orientation ?? '');\r\n  }\r\n\r\n  /**\r\n   * Returns if browser matched, used to determine rendering/removal\r\n   * @returns {Boolean} \r\n   */\r\n  get isValidBrowser() {\r\n    return GSEnvironment.isValidBrowser(this.browser ?? '');\r\n  }\r\n\r\n  /**\r\n   * Returns if browser matched, used to determine rendering/removal\r\n   * @returns {Boolean} \r\n   */\r\n  get isValidProtocol() {\r\n    return GSEnvironment.isValidProtocol(this.protocol ?? '');\r\n  }\r\n\r\n  /**\r\n   * Internal attribute set if component is generated by other components\r\n   */\r\n  get isGenerated() {\r\n    return this.hasAttribute('generated');\r\n  }\r\n\r\n  /**\r\n   * Get parent GS-* component\r\n   */\r\n  get parentComponent() {\r\n    return GSDOM.parentAll(this).filter(x => x instanceof GSElement).next()?.value;\r\n  }\r\n\r\n  /**\r\n   * Get this class name\r\n   */\r\n  get clazzName() {\r\n    return this.constructor.name;\r\n  }\r\n\r\n  get definitions() {\r\n    const list = [...GSDOM.inheritance(this)].map(o => o.constructor?.properties).filter(o => o);\r\n    list.push(this.constructor?.properties);\r\n    return GSData.mergeObjects(list);\r\n  }\r\n\r\n  /**\r\n   * Get instance of internal styles\r\n   */\r\n  get elementStyles() {\r\n    return this.constructor.elementStyles\r\n        .filter(o => o instanceof CSSStyleSheet || o.styleSheet instanceof CSSStyleSheet)\r\n        .map(o => o.styleSheet || o)\r\n        .pop();    \r\n    /*\r\n    .map(s => {\r\n       Object.values(s)\r\n        .filter(o => o instanceof CSSStyleSheet || o instanceof CSSResult)\r\n        .map(o => o.styleSheet || o)\r\n        .pop()\r\n    }).pop();\r\n    */\r\n  }\r\n\r\n  /**\r\n   * Internal shadow styles rule\r\n   * @param {*} name \r\n   * @returns \r\n   */\r\n  cssRule(name) {\r\n    return Array.from(this.elementStyles?.rules ?? []).filter(r => r.selectorText === name).pop();\r\n  }\r\n\r\n  /**\r\n   * Set dynamic CSS rule \r\n   * See GSIcon hot it is done\r\n   * @param {*} rule \r\n   * @param {*} name \r\n   * @param {*} value \r\n   */\r\n  setCSSProperty(rule, name, value) {\r\n    this.cssRule(rule)?.style?.setProperty(name, value);\r\n  }\r\n\r\n  /**\r\n   * Extract and merge all static properties definition from WebComponent instance\r\n   * @param {GSElement} obj \r\n   * @returns {Object}\r\n   */\r\n  static allProperties(obj) {\r\n    return GSDOM.allProperties(obj);\r\n  }\r\n\r\n  /**\r\n   * Register class as WebComponent to the browser\r\n   * @param {String} name \r\n   * @param {class} clazz Optional, if not set, use self\r\n   * @param {Object} opt Options, used only when extending non HTMLElement class  \r\n   */\r\n  static define(name, clazz, opt) {\r\n    return GSDOM.define(name, clazz || this, opt);\r\n  }\r\n\r\n  static {\r\n    GSElement.define('gs-element', GSElement);\r\n    // global document element removal monitor, help GS cleanup\r\n    GSDOMObserver.registerFilter(el => true, el => { GSDOM.cleanup(el) }, true, document.body);\r\n  }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSElement } from \"../GSElement.mjs\";\r\n\r\n/**\r\n * Controller for child element navigation / selection / focusing\r\n */\r\nexport class ElementNavigationController {\r\n\r\n  #host;\r\n  #attached;\r\n  #focused;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host = null;\r\n    me.#attached = false;\r\n  }\r\n\r\n  get circular() {\r\n    return this.#host?.circular === true;\r\n  }\r\n\r\n  get multiple() {\r\n    return this.#host?.multiple === true;\r\n  }\r\n\r\n  get focused() {\r\n    return this.#focused;\r\n  }\r\n\r\n  get selected() {\r\n    return this.#host.active;\r\n  }\r\n\r\n  /**\r\n   * Called on first update from host component\r\n   */\r\n  init() {\r\n\r\n  }\r\n\r\n  /**\r\n   * Called on first update from host component\r\n   */  \r\n  attach(el) {\r\n    const me = this;\r\n    if (me.#attached) return;\r\n    me.#attached = true;\r\n    if (me.#host) {\r\n      me.#host.attachEvent(el, 'keydown', e => me.onKeyDown(e));\r\n      me.#host.attachEvent(el, 'keyup', e => me.onKeyUp(e));\r\n      me.#host.attachEvent(el, 'click', e => me.onClick(e));\r\n      me.#host.attachEvent(el, 'focusin', e => me.onFocusIn(e));\r\n      me.#host.attachEvent(el, 'focusout', e => me.onFocusOut(e));\r\n    }\r\n  }\r\n\r\n  previous() {\r\n    const me = this;\r\n    let el = me.#focused?.previousElementSibling;\r\n    while (el?.disabled) el = el.previousElementSibling;\r\n    if (me.circular && !el) el = me.lastElementChild;\r\n    el?.focus();\r\n  }\r\n\r\n  next() {\r\n    const me = this;\r\n    let el = me.#focused?.nextElementSibling;\r\n    while (el?.disabled) el = el.nextElementSibling;\r\n    if (me.circular && !el) el = me.firstElementChild;\r\n    el?.focus();\r\n  }\r\n\r\n  /**\r\n   * Reset focus / selection\r\n   */\r\n  reset() {\r\n    const me = this;\r\n    const active = me.selected;\r\n    if (me.multiple) {\r\n      active.forEach(el => {\r\n        el.active = false;\r\n        el.blur();\r\n      });\r\n    } else if (active) {\r\n      active.active = false;\r\n      active.blur();\r\n    }\r\n    me.#focused = undefined;\r\n    me.#host?.emit('group-reset', undefined, true);\r\n  }\r\n\r\n  /**\r\n   * Callback when child element selected\r\n   * @param {*} el \r\n   */\r\n  #onSelected(el) {\r\n    const me = this;\r\n    me.#host?.onSelected?.(el);\r\n    me.#host?.emit('group-selected', el, true);\r\n  }\r\n\r\n  /**\r\n   * Callback when child element deselected\r\n   * @param {*} el \r\n   */\r\n  #onDeselected(el) {\r\n    this.#host?.onDeselected?.(el);\r\n    this.#host?.emit('group-deselected', el, true);\r\n  }\r\n\r\n  /**\r\n   * Callback when child element focused\r\n   * @param {*} el \r\n   */\r\n  #onFocused(el) {\r\n    this.#host?.onFocused?.(el);\r\n    this.#host?.emit('group-focused', el, true);\r\n  }\r\n\r\n  /**\r\n   * Element navigation filter where we can select if focused element is navigable\r\n   * @param {*} el \r\n   * @returns \r\n   */\r\n  #isNavigable(el) {\r\n    return this.#host?.isNavigable ? this.#host?.isNavigable(el) : true;\r\n  }\r\n\r\n  #focus(el) {\r\n    const me = this;\r\n    if (!me.#isNavigable(el)) return;\r\n    me.#focused = el;\r\n    if (el) {\r\n      me.#onFocused(me.#focused);\r\n    }\r\n  }\r\n\r\n  #toggle(el) {\r\n    if (!el) return;\r\n    const me = this;\r\n    if (!me.#isNavigable(el)) return;\r\n    if (el.active) {\r\n      me.#onSelected(el);\r\n    } else {\r\n      me.#onDeselected(el);\r\n    }\r\n  }\r\n\r\n  #select(el) {\r\n    const me = this;\r\n    if (!me.#isNavigable(el)) return;\r\n\r\n    const active = me.selected;\r\n    if (active && !me.multiple) {\r\n      active.active = false;\r\n      me.#toggle(active);\r\n    }\r\n\r\n    if (me.multiple) {\r\n      el.active = !el.active;\r\n    } else {\r\n      el.active = true;\r\n    }\r\n    me.#toggle(el);\r\n  }\r\n\r\n  onFocusOut(e) {\r\n    const me = this;\r\n    //if (me.#focused === e.target) me.#focused = undefined;\r\n  }\r\n\r\n  onFocusIn(e) {\r\n    if (!e.target.isNav) return;\r\n    const me = this;\r\n    if(e.relatedTarget?.isNav) {\r\n      me.#focus(e.target)\r\n    } else {\r\n      me.selected?.focus();\r\n    }\r\n\r\n  }\r\n\r\n  onClick(e) {\r\n    const me = this;\r\n    const el = e.composedPath()\r\n    .filter(el => el instanceof GSElement)\r\n    .filter(el => el.parentComponent === me.#host).pop();\r\n    if (!me.#isNavigable(el)) return;\r\n    if (e.ctrlKey) me.reset();\r\n    me.#onDeselected(me.selected);\r\n    me.#select(el);\r\n  }\r\n\r\n  onKeyDown(e) {\r\n    const me = this;\r\n    if (!e.target.isNav) return;\r\n    switch (e.code) {\r\n      case 'ArrowUp':\r\n      case 'ArrowLeft':\r\n        me.previous();\r\n        break;\r\n      case 'ArrowDown':\r\n      case 'ArrowRight':\r\n        me.next();\r\n        break;\r\n    }\r\n\r\n  }\r\n\r\n  onKeyUp(e) {\r\n    const me = this;\r\n    if (!e.target.isNav) return;\r\n    switch (e.code) {\r\n      case 'Space':\r\n      case 'Enter':\r\n        me.#focused?.click();\r\n        break;\r\n    }\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSEventBus } from \"../base/GSEventBus.mjs\";\r\n\r\n/**\r\n * Controller for multiple elements groups\r\n */\r\nexport class GroupController {\r\n\r\n  #host;\r\n\r\n  #busEvent;\r\n  #busCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    if (me.#host.group) {\r\n      me.#busCallback = me.#onBusEvent.bind(me);\r\n      me.#busEvent = GSEventBus.register(me.#host.clazzName);\r\n      me.#busEvent.on(me.#host.group, me.#busCallback);\r\n    }\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#busEvent?.off(me.#host.group, me.#busCallback);\r\n    me.#host.removeController(me);\r\n    me.#host = null;\r\n  }\r\n\r\n  #onBusEvent(e) {\r\n    this.#host.onBusEvent?.(e);\r\n  }\r\n\r\n  notify(data) {\r\n    const me = this;\r\n    me.#busEvent?.emit(me.#host.group, {owner: me.#host, item:data}); \t\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSRouter } from '../base/GSRouter.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { html } from '../lib1.mjs';\r\n\r\nexport class GSRouterElement extends GSElement {\r\n\r\n  #router = null;\r\n\r\n  static properties = {\r\n    url: {},\r\n    disabled: { type: Boolean },\r\n    logging: { type: Boolean }\r\n  };\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.id = GSID.next();\r\n    me.logging = false;\r\n    me.#router = new GSRouter(me);\r\n    me.#router.log = false;\r\n  }\r\n\r\n  renderUI() {\r\n    //return super.renderUI();\r\n    return html`<slot><slot/>`;\r\n  }\r\n\r\n  updated(changed) {\r\n    const me = this;\r\n    me.#router.log = me.logging;\r\n    if (changed.has('url')) {\r\n      me.#router.initialize(me.url);\r\n    }\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    const me = this;\r\n    me.#router?.disable();\r\n    me.#router = null;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-router');\r\n  }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\n\r\nexport class GSAccordionElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    autoclose: { type: Boolean },\r\n    cssItem: { reflect: true, attribute: 'css-item' },\r\n    cssHeader: { reflect: true, attribute: 'css-header' },\r\n    cssBody: { reflect: true, attribute: 'css-body' },\r\n    data: { type: Array }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.data = this.settings;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\"\r\n       @notify=\"${me.#onNotify.bind(me)}\"\r\n       @click=\"${me.#onClick}\" \r\n       @keyup=\"${me.#onKeyUp}\" \r\n       class=\"accordion ${classMap(me.renderClass())}\">\r\n       ${this.#renderItems()}\r\n       <slot></slot></div>`\r\n  }\r\n\r\n  get items() {\r\n    return this.queryAll('gs-accordion-item', false, true);\r\n  }\r\n\r\n  get settings() {\r\n    const cfg = this.constructor.properties;\r\n    return GSItem.collect(this).map(el => GSAttr.proxify(el, cfg));\r\n  }\r\n\r\n  close() {\r\n    this.#state(false);\r\n  }\r\n\r\n  open() {\r\n    this.#state(true);\r\n  }\r\n\r\n  onDataRead(data) {\r\n    this.data = data;\r\n  }\r\n\r\n  #renderItems() {\r\n    return this.data.map(o => {\r\n      return html`<gs-accordion-item generated\r\n        .opened=\"${ifDefined(o.disabled === true)}\" \r\n        message=\"${ifDefined(o.message)}\" \r\n        template=\"${ifDefined(o.template)}\" \r\n        title=\"${ifDefined(o.title)}\"></gs-accordion-item>`;\r\n    });\r\n  }\r\n\r\n  #state(val = false) {\r\n    this.items.forEach(el => el.opened = val);\r\n    this.notify();\r\n  }\r\n\r\n  #onNotify(e) {\r\n    const me = this;\r\n    if (me.autoclose && e.target.opened) {\r\n      me.items.filter(el => el != e.target).forEach(el => el.opened = false);\r\n    }\r\n  }\r\n\r\n  #onClick(e) {\r\n    const isItemCloser = e?.composedPath()[0]?.matches('.accordion-button');\r\n    if(isItemCloser) e.target.toggle?.();\r\n  }\r\n\r\n  #onKeyUp(e) {\r\n    switch (e.code) {\r\n      case 'ArrowLeft':\r\n        e.target.close?.();\r\n        break;\r\n      case 'ArrowRight':\r\n        e.target.open?.();\r\n        break;\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-accordion');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { html } from '../lib.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSAccordionItemElement extends GSElement {\r\n\r\n  static properties = {\r\n    cssHeader: { reflect: true, attribute: 'css-header' },\r\n    cssBody: { reflect: true, attribute: 'css-body' },\r\n    message: { reflect: true, },\r\n    title: { reflect: true, },\r\n    opened: { type: Boolean, reflect: true },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  shouldUpdate(changedProperties) {\r\n    return this.owner?.tagName === 'GS-ACCORDION';\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const owner = me.owner;\r\n    const cssHeader = me.cssHeader || owner?.cssHeader;\r\n    const cssBody = me.cssBody || owner?.cssBody;\r\n    return html`<div class=\"accordion-item ${me.css}\">\r\n             <h2 class=\"accordion-header\">\r\n               <button type=\"button\" \r\n                class=\"accordion-button  ${cssHeader} ${me.opened ? '' : 'collapsed'}\"> \r\n                 ${me.translate(me.title)}\r\n               </button>\r\n             </h2>\r\n             <div class=\"accordion-collapse collapse  ${cssBody} ${me.opened ? 'show' : ''}\">\r\n               <div class=\"accordion-body\">\r\n                   ${me.translate(me.message)}\r\n                   ${me.renderTemplate()}\r\n                   <slot></slot>\r\n               </div>\r\n             </div>      \r\n     </div>`\r\n  }\r\n\r\n  open() {\r\n    this.notify(true);\r\n  }\r\n  \r\n  close() {\r\n    this.notify(false);\r\n  }\r\n\r\n  toggle() {\r\n    this.notify(!this.opened);\r\n  }\r\n\r\n  notify(val = false) {\r\n    const me = this;\r\n    me.opened = val;\r\n    super.notify();\r\n  }\r\n\r\n  get owner() {\r\n    return this.closest('gs-accordion') || GSDOM.component(this);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-accordion-item');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, ref, html, ifDefined } from '../lib.mjs';\r\nimport { color } from '../properties/index.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\n\r\nexport class GSAlertElement extends GSElement {\r\n\r\n    static properties = {\r\n        message: { reflect: true },\r\n        color: { ...color },\r\n        closed: { reflect: true, type: Boolean },\r\n        closable: { reflect: true, type: Boolean },\r\n        delay: { reflect: true, type: Number },\r\n    }\r\n\r\n    #ref;\r\n    #pause = false;\r\n    #interval = 0;\r\n    #last = 0;\r\n    #data;\r\n\r\n    constructor() {\r\n        super();\r\n        this.delay = 1;\r\n        this.#ref = createRef();\r\n        this.#data = this.#proxify(this);\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        clearInterval(this.#interval);\r\n        super.disconnectedCallback();\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div role=\"alert\" dir=\"${ifDefined(me.direction)}\" ${ref(me.#ref)} \r\n            @mouseover=\"${() => me.#pause = true}\"\r\n            @mouseout=\"${() => me.#pause = false}\"\r\n            class=\"alert fade ${classMap(me.renderClass())}\" >\r\n            ${me.#first}\r\n            ${me.renderTemplate()}\r\n            <slot></slot>\r\n            ${me.#second}\r\n        </div>`;\r\n    }\r\n\r\n    firstUpdated(changed) {\r\n        this.#handleBillboard();\r\n        super.firstUpdated(changed);\r\n    }\r\n\r\n    updated(changed) {\r\n        if (!changed.has('opened')) return;\r\n        this.#handleBillboard();\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            'show': !me.closed,\r\n            'alert-dismissible': me.closable,\r\n            [`alert-${me.color}`]: me.color,\r\n\r\n        }\r\n        return css;\r\n    }\r\n\r\n    open() {\r\n        this.notify(false);\r\n    }\r\n\r\n    close() {\r\n        this.notify(true);\r\n    }\r\n\r\n    toggle() {\r\n        this.notify(!this.closed);\r\n    }\r\n\r\n    notify(val = false) {\r\n        const me = this;\r\n        me.closed = val;\r\n        if (me.closed) setTimeout(() => { me.#ref.value.classList.toggle('d-none', true) }, 250);\r\n        super.notify();\r\n    }\r\n\r\n    get isBillboard() {\r\n        return this.#data?.length > 0;\r\n    }\r\n\r\n    get #message() {\r\n        return this.translate(this.message);\r\n    }\r\n\r\n    get #first() { return this.rtl ? this.#button : this.#message; };\r\n\r\n    get #second() { return this.rtl ? this.#message : this.#button; };\r\n\r\n    get #button() {\r\n        return this.closable ? html`<button type=\"button\" class=\"btn-close\" aria-label=\"Close\" @click=\"${this.close}\"></button>` : '';\r\n    }\r\n\r\n    /**\r\n     * Proxify GS-ITEM elements to easily read attributes\r\n     */\r\n    #proxify(root) {\r\n        return GSItem.collect(root).map(el => GSAttr.proxify(el, {message:{}}));\r\n    }\r\n\r\n    #handleBillboard() {\r\n        const me = this;\r\n        if (me.closed) {\r\n            clearInterval(me.#interval);\r\n            me.#interval = 0;\r\n        } else {\r\n            me.#billboard();\r\n        }        \r\n    }\r\n\r\n    #billboard() {\r\n        const me = this;\r\n        if (!me.isBillboard) return;\r\n        const items = me.#data;\r\n        if (me.message) {\r\n            me.#last = -1;\r\n        } else {\r\n            me.message = items[0].message;\r\n        }\r\n        me.#interval = setInterval(() => {\r\n            if (me.#pause) return;\r\n            me.#last++;\r\n            if (me.#last >= items.length ) me.#last = 0;\r\n            me.message = items[me.#last].message;\r\n        }, me.delay * 1000);\r\n    }\r\n\r\n    static {\r\n        this.define('gs-alert');\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, ifDefined, html, ref, createRef } from '../lib.mjs';\r\nimport { color, size, buttonType, ButtonTypes, SizeTypes } from '../properties/index.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSButtonElement extends GSElement {\r\n\r\n  static properties = {\r\n    type: { ...buttonType }, // reset, submit\r\n    size: { ...size }, // small, large, normal\r\n    color: { ...color },\r\n    clickCss: { attribute : 'click-css'},\r\n    hoverCss: { attribute : 'hover-css'},\r\n    toggleColor: { ...color, attribute : 'toggle-color' },\r\n    autofocus: { type: Boolean },\r\n    disabled: { type: Boolean, reflect: true },\r\n    outline: { type: Boolean, reflect: true },\r\n    active: { type: Boolean, reflect: true },\r\n    toggling: { type: Boolean },\r\n    icon: {},\r\n    title: {},\r\n    tooltip: {},\r\n    text: {},\r\n    url: {}\r\n  };\r\n\r\n  #refEl = createRef();\r\n  #refIco = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    this.type = 'button';\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    if (this.autofocus && !this.disabled) this.focus();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<button is=\"gs-ext-button\" part=\"button\" role=\"button\" \r\n        ${ref(me.#refEl)}\r\n        dir=\"${ifDefined(me.direction)}\"\r\n        type=\"${ifDefined(me.type)}\" \r\n        class=\"btn ${classMap(me.renderClass())}\" \r\n        title=\"${ifDefined(me.#tooltip)}\"\r\n        ?disabled=${me.disabled}\r\n        @mouseover=\"${me.#onMouseOver}\"\r\n        @mouseout=\"${me.#onMouseOut}\"\r\n        @disabled=\"${me.#onDisabled}\"\r\n        @click=\"${me.#onClick}\">\r\n          ${me.#first} ${me.#second}</button>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const size = SizeTypes[me.size];\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'active': me.active,\r\n      'focus-ring': document.activeElement === me,\r\n      [`text-${me.text}`]: me.text,\r\n      [`btn-${size}`]: size,\r\n      [`btn-outline-${me.color}`]: me.outline,\r\n      [`btn-${me.color}`]: !me.outline && me.color,\r\n      [`btn-${me.toggleColor}`]: me.active && me.toggleColor,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  click() {\r\n    this.#refEl.value?.click();\r\n  }\r\n\r\n  focus() {\r\n    requestAnimationFrame(() => this.#refEl.value?.focus());\r\n  }\r\n\r\n  toggle() {\r\n    this.active = !this.active;\r\n  }\r\n\r\n  #onClick(e) {\r\n    const me = this;\r\n    if(me.toggling) me.toggle();\r\n    me.iconEl?.animate?.();\r\n    me.#onHref(e)\r\n    if (me.dataset.event) return me.emit(me.dataset.event, null, me.dataset.bubbles, me.dataset.composed, true);\r\n    if (me.isReset) return me.form?.reset();\r\n    if (me.isSubmit) return me.form?.submit();\r\n    me.notify();\r\n  }\r\n\r\n  #onDisabled(e) {\r\n    this.disabled = this.buttonEl.disabled;\r\n  }\r\n\r\n  #onHref(e) {\r\n    const me = this;\r\n    if (!me.url) return;\r\n    if (me.url.startsWith('#')) {\r\n      location.hash = me.url;\r\n    } else {\r\n      location.href = me.url;\r\n    }\r\n  }\r\n\r\n  #onMouseOver() {\r\n    this.iconEl?.hover?.(true);\r\n  }\r\n\r\n  #onMouseOut() {\r\n    this.iconEl?.hover?.(false);\r\n  }\r\n\r\n  get isReset() {\r\n    return ButtonTypes.isReset(this.type);\r\n  }\r\n\r\n  get isSubmit() {\r\n    return ButtonTypes.isSubmit(this.type);\r\n  }\r\n\r\n  get iconEl() {\r\n    return this.#refIco.value;\r\n  }\r\n\r\n  get buttonEl() {\r\n    return this.#refEl.value;\r\n  }\r\n  \r\n\r\n  get form() {\r\n    return this.closest('gs-form, form');\r\n  }\r\n\r\n  get #title() {\r\n    return this.translate(this.title);\r\n  }\r\n\r\n  get #tooltip() {\r\n    return this.translate(this.tooltip);\r\n  }\r\n\r\n  get #first() { return this.rtl ? this.#title : this.#iconHtml; };\r\n\r\n  get #second() { return this.rtl ? this.#iconHtml : this.#title; };\r\n\r\n  get #iconHtml() { return this.icon ? this.#renderIcon : html`<slot name=\"icon\"></slot>`; }\r\n\r\n  get #renderIcon() {\r\n    return  html`\r\n    <gs-icon ${ref(this.#refIco)} \r\n    name=\"${this.icon}\" \r\n    click-css=\"${ifDefined(this.clickCss)}\" \r\n    hover-css=\"${ifDefined(this.hoverCss)}\" \r\n    data-delay=\"1\"></gs-icon>`;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-button');\r\n  }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { unsafeHTML, classMap, html, ifDefined, css } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSDate } from '../base/GSDate.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { notEmpty, numGE0 } from '../properties/index.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\nexport class GSCalendarElement extends GSElement {\r\n\r\n  static styles = css`.year::-webkit-outer-spin-button,.year::-webkit-inner-spin-button {-webkit-appearance: none;margin: 0;} .year {-moz-appearance: textfield;} .day:focus{font-weight: bold;}`\r\n\r\n  static properties = {\r\n    date: {},\r\n    target: {},\r\n    format: { hasChanged: notEmpty },\r\n    editable: { type: Boolean },\r\n    range: { type: Number },\r\n    year: { type: Number },\r\n    month: { type: Number, hasChanged: numGE0 },\r\n    day: { type: Number, hasChanged: numGE0 },\r\n    minYear: { attribute: 'year-min', type: Number },\r\n    maxYear: { attribute: 'year-max', type: Number },\r\n    arrovPrev: { attribute: 'arrow-prev' },\r\n    arrowNext: { attribute: 'arrow-next' },\r\n    cssDays: { attribute: 'css-days' },\r\n    cssToday: { attribute: 'css-today' },\r\n    cssWeeks: { attribute: 'css-weeks' },\r\n    cssMonth: { attribute: 'css-month' },\r\n    cssYear: { attribute: 'css-year' },\r\n    cssNav: { attribute: 'css-nav' },\r\n    cssHeader: { attribute: 'css-header' },\r\n    cssSelected: { attribute: 'css-selected' },\r\n  }\r\n\r\n  #date;\r\n  #selected;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.#date = new GSDate();\r\n    me.#date.day = 1;\r\n    me.#selected = new GSDate();\r\n    me.#date.language = GSUtil.language;\r\n    me.#selected.language = GSUtil.language;\r\n    \r\n    me.language = GSUtil.language;\r\n    me.day = me.#selected.day;\r\n    me.month = me.#selected.month;\r\n    me.year = me.#selected.year;\r\n    \r\n    me.editable = false;\r\n    me.range = 5;\r\n    me.minYear = 1900;\r\n    me.maxYear = 2100;\r\n    me.arrowPrev = '&#10094;';\r\n    me.arrowNext = '&#10095;';\r\n    me.cssNav = 'btn-light';\r\n    me.cssToday = 'btn-secondary';\r\n    me.cssSelected = 'btn-primary';\r\n    me.cssWeeks = 'fw-bold text-bg-dark';\r\n    me.cssYear = 'form-control fs-5 fw-bold border-0 text-center m-1 p-0';\r\n    me.cssMonth = 'form-control fs-3 fw-bold border-0 text-center m-1 p-0';\r\n  }\r\n\r\n  get date() {\r\n    const me = this;\r\n    //return this.#date.toISOString();\r\n    return new Proxy(this.#date, {\r\n      set(target, prop, value) {\r\n        if (typeof target[prop] != 'function') {\r\n          target[prop] = value;\r\n          me.#update();\r\n        }\r\n        return true;\r\n      },\r\n      get(target, prop, receiver) {\r\n        const value = target[prop];\r\n        if (value instanceof Function) {\r\n          return function (...args) {\r\n            try {\r\n              return value.apply(this === receiver ? target : this, args);\r\n            } finally {\r\n              me.#update();\r\n            }\r\n          };\r\n        }\r\n        return value;\r\n      }\r\n    });\r\n  }\r\n\r\n  previousMonth() {\r\n    const me = this;\r\n    if (me.month == 0) {\r\n      me.month = 11;\r\n      me.year--;\r\n    } else {\r\n      me.month--;\r\n    }\r\n  }\r\n\r\n  nextMonth() {\r\n    const me = this;\r\n    if (me.month == 11) {\r\n      me.month = 0;\r\n      me.year++;\r\n    } else {\r\n      me.month++;\r\n    }\r\n  }\r\n\r\n  previousYear() {\r\n    this.year--;\r\n  }\r\n\r\n  nextYear() {\r\n    this.year++;\r\n  }\r\n\r\n  formatted(date) {\r\n    const me = this;\r\n    return (date || me.#date).format(me.format, me.language);\r\n  }\r\n\r\n  updated() {\r\n    const me = this;\r\n    const date = new GSDate(me.#date);\r\n    me.#updateTarget(date);\r\n    me.emit('date', { type: 'calendar', date: date, val: me.formatted(date) }, true, true);\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    me.#date.day = 1;\r\n    me.#date.month = me.month;\r\n    me.#date.year = me.year;\r\n    me.#date.day = me.day;\r\n    me.#date.language = me.language;\r\n\r\n    const week = GSDate.dayList(true, me.language).map(v => html`<div class=\"col\">${v}</div>`);\r\n    const months = me.#monthsHTML();\r\n    const year = me.#yearHTML();\r\n\r\n    return html`\r\n          <div class=\"container-fluid text-center ${classMap(me.renderClass())}\"\r\n          dir=\"${ifDefined(me.direction)}\"\r\n          @keydown=\"${me.#onKey}\"\r\n          @click=\"${me.#onDay}\">\r\n          <div class=\"row align-items-center ${me.cssHeader} header\">\r\n              <div class=\"col-auto\">\r\n                  <a href=\"#\" @click=\"${me.previousMonth}\" class=\"btn ${me.cssNav} arrow prev\">${unsafeHTML(me.arrowPrev)}</a>\r\n              </div>\r\n              <div class=\"col\"></div>\r\n              <div class=\"col-auto\">\r\n                  ${months}\r\n                  ${year}\r\n              </div>\r\n              <div class=\"col\"></div>\r\n              <div class=\"col-auto\">\r\n                  <a href=\"#\" @click=\"${me.nextMonth}\" class=\"btn ${me.cssNav} arrow next\">${unsafeHTML(me.arrowNext)}</a>\r\n              </div>\r\n          </div>\r\n          <div class=\"row weeks ${me.cssWeeks}\">${week}</div>\r\n          ${unsafeHTML(me.#daysHTML())}\r\n      </div>`;\r\n  }\r\n\r\n  #updateTarget(date) {\r\n    const me = this;\r\n    if (!me.target) return;\r\n    const tgt = GSDOM.query(document.documentElement, me.target);\r\n    if (!tgt) return;\r\n\r\n    if (tgt instanceof HTMLInputElement) {\r\n      if (tgt.type === 'date') return tgt.valueAsDate = date;\r\n      return tgt.value = me.formatted(date);\r\n    }\r\n    GSDOM.setHTML(tgt, me.formatted(date));\r\n  }\r\n\r\n  #update() {\r\n    const me = this;\r\n    me.#selected.day = 1;\r\n    me.#selected.month = me.#date.month;\r\n    me.#selected.year = me.#date.year;\r\n    me.#selected.day = me.#date.day;\r\n    me.#selected.language = me.#date.language;\r\n\r\n    me.day = me.#date.day;\r\n    me.month = me.#date.month;\r\n    me.year = me.#date.year;\r\n    me.language = me.#date.language;\r\n  }\r\n\r\n  #isToday(v, date) {\r\n    const me = this;\r\n    return v && GSUtil.asNum(v) === date.day && date.month === me.#date.month && me.#date.year === date.year;\r\n  }\r\n\r\n  #daysHTML() {\r\n    const me = this;\r\n    const today = new GSDate();\r\n    today.language = me.language;\r\n    const list = me.#date.build(me.language);\r\n    const result = list\r\n      .map(v => {\r\n        const c1 = me.#isToday(v, today) ? me.cssToday : '';\r\n        const c2 = me.#isToday(v, me.#selected) ? me.cssSelected : '';\r\n\r\n        const d = v ? `<a tabindex=\"0\" href=\"#\" class=\"btn shadow-none ${c2} ${c1} day\" data-day=\"${v}\">${v}</a>` : ''\r\n        return `<div class=\"col p-0\">${d}</div>`;\r\n      })\r\n      .map((v, i) => {\r\n        if (i === 0) return `<div class=\"row days\">${v}`;\r\n        const isBreak = i % 7 == 0;\r\n        return isBreak ? `</div><div class=\"row days\">${v}` : v;\r\n      });\r\n    result.push('</div>');\r\n    return result.join('');\r\n  }\r\n\r\n  #monthsHTML() {\r\n    const me = this;\r\n    const current = me.#date.MMMM;\r\n    const months = GSDate.monthList(false, me.language);\r\n    const list = months.map((v, i) => html`<option value=\"${i}\" selected=${ifDefined(current == v ? true : undefined)}>${v}</option>`);\r\n    return html`<select @change=\"${me.#onMonth}\" name=\"month\" class=\"month ${me.cssMonth}\" value=\"${months.indexOf(current)}\">${list}</select>`;\r\n  }\r\n\r\n  #yearHTML() {\r\n\r\n    const me = this;\r\n\r\n    const options = [];\r\n    let minYear = me.minYear;\r\n    let maxYear = me.maxYear;\r\n\r\n    if (me.range > 0) {\r\n      const year = new GSDate().year;\r\n      minYear = year - me.range;\r\n      maxYear = year + me.range;\r\n      me.#optionsHTML(options, minYear, maxYear);\r\n    }\r\n\r\n    if (!me.editable) {\r\n      return html`<select @change=\"${me.#onYear}\" name=\"year\" class=\"year ${me.cssYear}\" data-gs-min=\"${minYear}\" data-gs-max=\"${maxYear}\">${options}</select>`;\r\n    }\r\n\r\n    const isList = me.editable && me.range && options.length > 0;\r\n    const listID = isList ? GSID.next : null;\r\n    const list = isList ? html`<datalist id=\"${listID}\">${options}</datalist>` : '';\r\n\r\n    return html`<input name=\"year\" \r\n      type=\"number\" \r\n      list=\"${ifDefined(listID)}\"\r\n      class=\"year ${me.cssYear}\" \r\n      @change=\"${me.#onYear}\" \r\n      min=\"${minYear}\" \r\n      max=\"${maxYear}\"\r\n      value=\"${me.#date.getFullYear()}\">\r\n      ${list}`;\r\n  }\r\n\r\n  #optionsHTML(options, minYear = 0, maxYear = 0) {\r\n    const me = this;\r\n    let val = minYear;\r\n    while (val <= maxYear) {\r\n      if (me.editable) {\r\n        options.push(html`<option value=\"${val}\" selected=${ifDefined(val == me.year ? true : undefined)}>`);\r\n      } else {\r\n        options.push(html`<option value=\"${val}\" selected=${ifDefined(val == me.year ? true : undefined)}>${val}</option>`);\r\n      }\r\n      val++;\r\n    }\r\n\r\n    return options;\r\n  }\r\n\r\n  #onDay(e) {\r\n    GSEvents.prevent(e);\r\n    if (!e.target.classList.contains('day')) return;\r\n    const me = this;\r\n    const day = GSUtil.asNum(e.target.dataset.day, me.day);\r\n\r\n    me.#selected.day = 1;\r\n    me.#selected.month = me.month;\r\n    me.#selected.year = me.year;\r\n    me.#selected.day = day;\r\n\r\n    me.day = day;\r\n  }\r\n\r\n  #onMonth(e) {\r\n    this.month = e.target.selectedIndex;\r\n  }\r\n\r\n  #onYear(e) {\r\n    const yearEl = e?.target;\r\n    if (yearEl?.validity.valid) {\r\n      this.year = yearEl.value;\r\n    }\r\n  }\r\n\r\n  #onKey(e) {\r\n    // console.log(e);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-calendar');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, css, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { placement, PlacementTypes } from '../properties/placement.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\nexport class GSCardElement extends GSElement {\r\n\r\n  static styles = css`.card-header, .card-footer{ background-color: inherit; color: inherit;}`;\r\n\r\n  static properties = {\r\n\r\n    imageStyle: { type: Object, attribute: 'image-style', reflect : true },\r\n\r\n    overlay: { type: Boolean },\r\n    placement: { ...placement },\r\n    align: { ...placement },\r\n\r\n    image: {},\r\n    title: {},\r\n    subtitle: {},\r\n    text: {},\r\n    footer: {},\r\n    header: {},\r\n\r\n    colorText: { attribute: 'color-text' },\r\n    colorBack: { attribute: 'color-back' },\r\n    colorBorder: { attribute: 'color-border' },\r\n\r\n    cssTitle: { attribute: 'css-title' },\r\n    cssSubtitle: { attribute: 'css-subtitle' },\r\n    cssText: { attribute: 'css-text' },\r\n    cssFooter: { attribute: 'css-footer' },\r\n    cssHeader: { attribute: 'css-header' },\r\n    cssBody: { attribute: 'css-body' },\r\n    cssImage: { attribute: 'css-image' },\r\n\r\n  }\r\n\r\n  #styleID = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    this.border = false;\r\n    this.shadow = false;\r\n    this.align = 'start';\r\n    this.placement = 'top';\r\n    this.imageStyle = this.imageStyle || {};\r\n    this.dynamicStyle(this.#styleID);\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const content =  me.isVertical ? me.#renderVertical() : me.#renderHorizontal();\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\" class=\"card ${classMap(me.renderClass())}\">${content}</div>`;\r\n  }\r\n\r\n  #renderVertical() {\r\n    const me = this;\r\n    return [me.#imageTop, me.#header, me.#body, me.#footer, me.#imageBottom];\r\n  }\r\n\r\n  #renderHorizontal() {\r\n    const me = this;\r\n    const start = PlacementTypes.isBefore(me.placement);\r\n    const startClass = start ? 'col-4' : 'col-8';\r\n    const endClass = start ? 'col-8' : 'col-4';\r\n    const startHtml = start ? me.#images : me.#body;\r\n    const endHtml =  start ? me.#body : me.#images;\r\n    return html`<div class=\"row g-0\">\r\n        <div class=\"${startClass}\">\r\n            ${startHtml}\r\n        </div>\r\n        <div class=\"${endClass}\">\r\n          ${endHtml}\r\n        </div>\r\n      </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      border: me.border || me.colorBorder,\r\n      [`text-${me.align}`]: me.align,\r\n      [`text-${me.colorText}`]: me.colorText,\r\n      [`bg-${me.colorBack}`]: me.colorBack,\r\n      [`border-${me.colorBorder}`]: me.colorBorder,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  get isVertical() {\r\n    return PlacementTypes.isVertical(this.placement);\r\n  }\r\n\r\n  get isHorizontal() {\r\n    return PlacementTypes.isHorizontal(this.placement);\r\n  }\r\n\r\n  get #body() {\r\n    const me = this;\r\n    return html`<div class=\"${me.overlay ? 'card-img-overlay' : 'card-body'} ${me.cssBody}\">\r\n      <h5 class=\"card-title  ${me.cssTitle}\"><slot name=\"title\">${me.translate(me.title)}</slot></h5>\r\n      <h6 class=\"card-subtitle  ${me.cssSubtitle}\"><slot name=\"subtitle\">${me.translate(me.subtitle)}</slot></h6>\r\n      <p class=\"card-text ${me.cssText}\"><slot name=\"text\">${me.translate(me.text)}</slot></p>\r\n      <slot name=\"body\"></slot>\r\n    </div>    \r\n    `;\r\n  }\r\n\r\n  get #header() {\r\n    return this.overlay ? '' : html`<div class=\"card-header  ${this.cssHeader}\"><slot name=\"header\">${this.header}</slot></div>`;\r\n  }\r\n\r\n  get #footer() {\r\n    return this.overlay ? '' : html`<div class=\"card-footer ${this.cssFooter}\"><slot name=\"footer\">${this.footer}</slot></div>`;\r\n  }\r\n\r\n  get #imageSlot() {\r\n    return html`<slot name=\"image\"></slot>`;\r\n  }\r\n\r\n  get #image() {\r\n    const me = this;\r\n    const css = me.isHorizontal ? 'img-fluid' : 'card-img';\r\n    me.dynamicStyle(me.#styleID, me.imageStyle);\r\n    return html`<img src=\"${me.image}\" class=\"rounded-${me.placement} ${css} ${me.cssImage} ${me.#styleID}\" alt=\"...\">`;\r\n  }\r\n\r\n  get #images() {\r\n    return this.image ? this.#image : this.#imageSlot;\r\n  }\r\n\r\n  get #imageTop() {\r\n    return this.placement === 'top' ? this.#images : '';\r\n  }\r\n\r\n  get #imageBottom() {\r\n    return this.placement === 'bottom' ? this.#images : '';\r\n  }\r\n\r\n  static {\r\n    this.define('gs-card');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSCenterElement extends GSElement {\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\"\r\n      class=\"position-absolute top-50 start-50 translate-middle ${classMap(me.renderClass())}\">\r\n    ${me.renderTemplate()}<slot></slot></div>`;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-center');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSMenuElement class\r\n * @module components/GSMenuElement\r\n */\r\n\r\nimport { classMap, ifDefined, html, ref, createRef } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { dataset } from '../directives/dataset.mjs';\r\nimport { GroupController } from '../controllers/GroupController.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\n/**\r\n * Renderer for panel layout \r\n * @class\r\n * @extends {Component}\r\n */\r\nexport class GSMenuElement extends GSElement {\r\n\r\n    static properties = {\r\n        storage: {},\r\n        auto: { type: Boolean, reflect: true },\r\n        opened: { type: Boolean, reflect: true },\r\n        dark: { type: Boolean },\r\n        reverse: { type: Boolean },\r\n        offset: { type: Number },\r\n        data: { type: Array },\r\n    }\r\n\r\n    // GS-ITEM attributes mapping\r\n    static options = {\r\n        name: {},\r\n        title: {},\r\n        header: {},\r\n        color: {},\r\n        icon: {},\r\n        url: { default: '#' }\r\n    }\r\n\r\n    #menuRef = createRef();\r\n    #styleID = GSID.id;\r\n    #controller = null;\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;\r\n        me.offset = 0;\r\n        me.dynamicStyle(me.#styleID);\r\n        me.data = me.#proxify(me);\r\n        me.#controller = new GroupController(this);\r\n    }\r\n\r\n    onBusEvent(e) {\r\n       if (e.detail.owner != this) {\r\n            this.opened = false;\r\n       }\r\n     }\r\n\r\n    willUpdate(changed) {\r\n        super.willUpdate(changed);\r\n        if (changed.has('opened') && !this.opened) {\r\n            this.#closeSubmenus();\r\n        }\r\n    }\r\n\r\n    updated() {\r\n        this.#updatePosition();\r\n        if (this.opened) {\r\n            this.#controller.notify();\r\n        }\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<ul \r\n            ${ref(me.#menuRef)}\r\n            dir=\"${ifDefined(me.direction)}\"\r\n            class=\"dropdown-menu ${classMap(me.renderClass())}\"\r\n            data-gs-class=\"${me.#styleID}\"\r\n            data-menu=\"true\"\r\n            @mouseover=\"${me.#onMouseOver}\"\r\n            @mouseleave=\"${me.#onMouseLeave}\"\r\n            @keydown=\"${me.#onKeyDown}\"\r\n            @click=\"${me.#onClick}\">\r\n            ${me.#items(me.data)}\r\n        </ul>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            'submenu': me.dataset.submenu,\r\n            'dropdown-menu-dark': me.dark,\r\n            [me.#styleID]: true,\r\n            'show': me.opened,\r\n            'dropend': !me.reverse,\r\n            'dropstart': me.reverse,\r\n        }\r\n        return css;\r\n    }\r\n\r\n    close() {\r\n        this.opened = false;\r\n    }\r\n\r\n    open() {\r\n        this.opened = true;\r\n    }\r\n\r\n    toggle() {\r\n        this.opened = !this.opened;\r\n    }\r\n\r\n    /**\r\n     * Show at x/y position on the screen\r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @param {HTMLElement} caller\r\n     * @returns {void}\r\n     */\r\n    popup(x = 0, y = 0, caller) {\r\n\r\n        const me = this;\r\n        // offset to render under the mouse,\r\n        // important for GSGrid for better UI experience\r\n        const offset = GSUtil.asNum(me.offset, 0);\r\n        let target = caller;\r\n\r\n        if (GSEvents.isMouseOrPointerEvent(x)) {\r\n            const e = x;\r\n            target = e.target;\r\n            y = e.clientY;\r\n            x = e.clientX;\r\n            let offset = GSDOM.offsetParent(me);\r\n            offset = offset ? offset.getBoundingClientRect() : null;\r\n            x = x - (offset?.left || 0);\r\n            y = y - (offset?.top || 0);\r\n        }\r\n\r\n        const cfg = { clientX: x - offset, clientY: y - offset, target: target };\r\n\r\n        requestAnimationFrame(() => {\r\n            const style = {\r\n                position: 'fixed',\r\n                top: '0px',\r\n                left: '0px',\r\n                translate: `${cfg.clientX}px ${cfg.clientY}px`\r\n            };\r\n            const rule = me.dynamicStyle(me.#styleID);\r\n            Object.assign(rule.style, style);\r\n        });\r\n        me.open();\r\n\r\n    }\r\n\r\n    onDataRead(data) {\r\n        this.data = data;\r\n    }\r\n\r\n    #items(root) {\r\n        const me = this;\r\n        return root.map(el => me.#item(el));\r\n    }\r\n\r\n    #item(el) {\r\n        const me = this;\r\n        const isSub = el.items?.length > 0;\r\n        if (isSub) return me.#renderSubmenu(el);\r\n        if (!(el.header || el.name)) return me.#renderDivider();\r\n        return el.header ? me.#renderHeader(el) : me.#renderMenu(el);\r\n    }\r\n\r\n    #renderHeader(el) {\r\n        return html`<li data-inert=\"true\"><h6 class=\"dropdown-header\">${this.#renderIcon(el)}${el.header}</h6></li>`;\r\n    }\r\n\r\n    #renderDivider() {\r\n        return html`<li data-inert=\"true\"><hr class=\"dropdown-divider\"></li>`;\r\n    }\r\n\r\n    #renderSubmenu(el) {\r\n        const me = this;\r\n        return html`<li>\r\n            <a class=\"dropdown-item dropdown-toggle\" data-toggle=\"true\" href=\"#\">\r\n                <div class=\"d-inline-block w-100\">${me.#renderIcon(el)}${el.name}</div>\r\n            </a>\r\n            <gs-menu auto \r\n                .data=${el.items} \r\n                ?dark=${me.dark} \r\n                ?reverse=\"${me.reverse}\" \r\n                language=\"${ifDefined(me.language)}\" \r\n                data-submenu=\"true\">\r\n            </gs-menu>\r\n        </li>`;\r\n    }\r\n\r\n    #renderIcon(el) {\r\n        return el.icon ? html`<gs-icon css=\"mx-1\" name=\"${el.icon}\"></gs-icon>` : '';\r\n    }\r\n\r\n    #renderMenu(el) {\r\n        return html`<li>\r\n                <gs-button css=\"dropdown-item shadow-none\" \r\n                    ${dataset(el, false)}\r\n                    url=\"${el.url}\"\r\n                    title=\"${el.name}\" \r\n                    language=\"${ifDefined(this.language)}\" \r\n                    icon=\"${ifDefined(el.icon)}\" \r\n                    text=\"${ifDefined(el.color)}\"\r\n                    data-gs-target=\"${ifDefined(el.target || 'self')}\"\r\n                    data-gs-action=\"${ifDefined(el.action)}\">\r\n                </gs-button></li>`;\r\n    }\r\n\r\n    /**\r\n     * Proxify GS-ITEM elements to easily read attributes\r\n     */\r\n    #proxify(root) {\r\n        return GSItem.collect(root).map(el => GSAttr.proxify(el, GSMenuElement.options));\r\n    }\r\n\r\n    #closeSubmenus(menu) {\r\n        GSDOM.queryAll(this.renderRoot, 'gs-menu', false, false)\r\n            .filter(el => el != menu)\r\n            .forEach(el => el.close());\r\n    }\r\n\r\n    #onKeyDown(e) {\r\n        const me = this;\r\n        switch (e.key) {\r\n            case 'Escape':\r\n                me.close();\r\n                break;\r\n        }\r\n    }\r\n\r\n    #onClick(e) {\r\n        GSEvents.prevent(e);\r\n        const me = this;\r\n        const submenu = me.#toSubmenu(e);\r\n        submenu?.close();\r\n        if (me.auto) me.close();\r\n    }\r\n\r\n    #onMouseLeave(e) {\r\n        GSEvents.prevent(e);\r\n        if (this.auto) this.close();\r\n    }\r\n\r\n    #onMouseOver(e) {\r\n        GSEvents.prevent(e);\r\n        const me = this;\r\n        const submenu = me.#toSubmenu(e);\r\n        me.#closeSubmenus(submenu);\r\n        submenu?.open();\r\n    }\r\n\r\n    #toSubmenu(e) {\r\n        const menuItem = e.target.closest('li');\r\n        return menuItem?.querySelector('gs-menu');\r\n    }\r\n\r\n    #updatePosition() {\r\n        const me = this;\r\n        if (!me.opened) return;\r\n        const rule = me.dynamicStyle(me.#styleID);\r\n        if (me.isSubmenu) {\r\n            const opt = { translate: `0px -25px` };\r\n            if (me.reverse) {\r\n                opt.left = 'inherited';\r\n                opt.right = '100%';\r\n            } else {\r\n                opt.right = 'inherited';\r\n                opt.left = '100%';\r\n            }\r\n            Object.assign(rule.style, opt);\r\n        } else {\r\n            rule.style.translate = null;\r\n            const rect = me.#menu.getBoundingClientRect();\r\n            const offset = window.innerWidth - rect.right;\r\n            me.reverse = offset - 5 < 0;\r\n            if (me.reverse) rule.style.translate = `${offset - 2}px`;\r\n        }\r\n    }\r\n\r\n    get isSubmenu() {\r\n        return this.dataset.submenu;\r\n    }\r\n\r\n    get #menu() {\r\n        return this.#menuRef.value;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-menu');\r\n    }\r\n}\r\n","/*GSContextElement\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSContextElement class\r\n * @module components/GSContextElement\r\n */\r\n\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSMenuElement } from './Menu.mjs';\r\n\r\n/**\r\n * Renderer for context menu\r\n * @class\r\n * @extends {GSMenuElement}\r\n */\r\nexport class GSContextElement extends GSMenuElement {\r\n\r\n    static properties = {\r\n        target: {},\r\n        filter: {},\r\n        altContext: { type: Boolean, attribute: 'altcontext' },\r\n        disabled: { type: Boolean },\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;        \r\n        me.auto = true;\r\n        if (me.#isInTable) {\r\n            me.slot = \"extra\";\r\n            me.target = \"tbody\";\r\n            me.filter = \"[selected]\";\r\n            me.offset =\"4\";\r\n        }\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        const me = this;\r\n        me.attachEvent(window, 'resize', me.close.bind(me));        \r\n        if (!me.slot) me.#attachTarget();\r\n    }\r\n    \r\n    onSlotInjected(slot) {\r\n        this.#attachTarget();\r\n    }\r\n\r\n    #attachTarget() {\r\n        const me = this;        \r\n        const owner = GSDOM.parent(me.assignedSlot || me);\r\n        let targets = me.target ? GSDOM.queryAll(owner, me.target) : [owner];\r\n        if (!targets.length) targets = GSDOM.queryAll(document.documentElement, me.target);\r\n        targets.forEach(target => me.attachEvent(target, 'contextmenu', me.#onPopup.bind(me)));\r\n    }\r\n\r\n    #match(e) {\r\n        const me = this;\r\n        return e.composedPath().filter(el => el.matches)\r\n            .filter(el => el.matches(me.filter ? me.filter : me.target));\r\n    }\r\n\r\n    #onPopup(e) {\r\n        const me = this;\r\n        if (e.shiftKey && me.altContext) return;\r\n        const list = me.#match(e);\r\n        if (list.length === 0) return;\r\n        GSEvents.prevent(e);\r\n        me.popup(e);\r\n        return true;\r\n    }\r\n\r\n    get #isInTable() {\r\n        return this.parentComponent?.tagName === 'GS-TABLE';\r\n    }\r\n\r\n    /**\r\n     * Show submenu at x/y position on the screen\r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @returns {void}\r\n     */\r\n    popup(x = 0, y = 0, caller) {\r\n        return this.disabled ? false : super.popup(x, y, caller);\r\n    }\r\n\r\n    static {\r\n        this.define('gs-context');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, css, html, ifDefined, ref } from '../lib.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color, notEmpty } from '../properties/index.mjs';\r\nimport { ElementMoveController } from '../controllers/ElementMoveController.mjs';\r\n\r\nexport class GSCompareElement extends GSElement {\r\n\r\n  static styles = css`.slider {\r\n         --gs-position : 50%;\r\n          left : var(--gs-position);\r\n          width: 8px;\r\n          height: 100%;\r\n          border-width: 1px;\r\n          cursor: w-resize;\r\n          border-color: darkgray;\r\n          border-style: solid;\r\n          background-color: lightgray;\r\n      }\r\n      .clipper {\r\n        --gs-position : 50%;\r\n        clip-path: inset(0px var(--gs-position) 0px 0px);\r\n      }\r\n    `;\r\n\r\n  static properties = {\r\n    background: { ...color },\r\n    width: { type: Number },\r\n    height: { type: Number },\r\n    before: { hasChanged: notEmpty },\r\n    after: { hasChanged: notEmpty },\r\n  }\r\n\r\n  #styleID = GSID.id;\r\n\r\n  #elRef = createRef();\r\n  #clipRef = createRef();\r\n  #slideRef = createRef();\r\n\r\n  #mouseController;\r\n  #elPosition;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.width = 0;\r\n    me.height = 0;\r\n    me.dynamicStyle(me.#styleID);\r\n    me.#mouseController = new ElementMoveController(me);\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    this.#mouseController.attach(this.#splitter);\r\n    super.firstUpdated(changed);\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    const me = this;\r\n    const dynamic = me.#dynamic;\r\n    dynamic.width = me.width > 0 ? `${me.width}px` : '';\r\n    dynamic.height = me.height > 0 ? `${me.height}px` : '';\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div ${ref(me.#elRef)} \r\n         dir=\"${ifDefined(me.direction)}\"\r\n         @loaded=\"${me.#onLoad}\" \r\n         @dblclick=\"${me.#onDoubleClick}\"\r\n         data-gs-class=\"${me.#styleID}\"\r\n         class=\"${classMap(me.renderClass())}\">\r\n      <div class=\"overflow-hidden position-absolute top-0 start-0 overflow-hidden\"><slot name=\"before\">${me.#before}</slot></div>\r\n      <div ${ref(me.#clipRef)} class=\"overflow-hidden position-absolute top-0 start-0 overflow-hidden clipper\"><slot name=\"after\">${me.#after}</slot></div>\r\n      <div ${ref(me.#slideRef)} class=\"slider position-absolute top-0><slot name=\"control\"></slot></div>\r\n    </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      \"position-relative\": true,\r\n      \"user-select-none\": true,\r\n      \"d-contents\": me.isAuto,\r\n      \"h-100\": me.isAuto,\r\n      \"w-100\": me.isAuto,\r\n      \"overflow-hidden\": true,\r\n      [`bg-${me.background}`]: me.background,\r\n      [`${me.#styleID}`]: true\r\n    }\r\n    return css;\r\n  }\r\n\r\n  /**\r\n   * Handles resizing based on mouse move event\r\n   * @param {MouseEvent} e \r\n   */\r\n  onStartMove(e) {\r\n    this.#elPosition = this.#splitter.getBoundingClientRect();\r\n  }\r\n\r\n  onMouseMove(e) {\r\n    const me = this;\r\n    const offset = me.#elPosition.left;\r\n    const width = me.#elPosition.width;\r\n    const pos = GSUtil.range(e.clientX - offset, 0, width);\r\n    const pct = (pos / width) * 100;\r\n    me.#update(pct);\r\n  }\r\n\r\n  get isAuto() {\r\n    return this.width == 0 || this.height == 0;\r\n  }\r\n\r\n  get isFixed() {\r\n    return !this.isAuto;\r\n  }\r\n\r\n  get #dynamic() {\r\n    return this.dynamicStyle(this.#styleID).style;\r\n  }\r\n\r\n  get #before() {\r\n    return this.before ? html`<img @load=\"${this.#onLoad}\" src=\"${me.before}\"></img>` : '';\r\n  }\r\n\r\n  get #after() {\r\n    return this.after ? html`<img @load=\"${this.#onLoad}\" src=\"${me.after}\"></img>` : '';\r\n  }\r\n\r\n  get #isAuto() {\r\n    return this.width === 0 || this.height === 0;\r\n  }\r\n\r\n  get #splitter() {\r\n    return this.#elRef.value;\r\n  }\r\n\r\n  get #slider() {\r\n    return this.#slideRef.value;\r\n  }\r\n\r\n  get #clip() {\r\n    return this.#clipRef.value;\r\n  }\r\n\r\n  #onLoad(e) {\r\n    const me = this;\r\n    if (me.#isAuto) {\r\n      const el = e.target;\r\n      me.height = me.height || el.height;\r\n      me.width = me.width || el.width;\r\n    }\r\n  }\r\n\r\n  #onDoubleClick(e) {\r\n    const me = this;\r\n    me.prevent(e);\r\n    me.#update();\r\n    me.#mouseController.reset();\r\n  }\r\n\r\n  #update(pct = 50) {\r\n    const me = this;\r\n    me.#clip.style.setProperty('--gs-position', `${100 - pct}%`);\r\n    me.#slider.style.setProperty('--gs-position', `${pct}%`);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-compare');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\n\r\n/**\r\n * Helper component to enable controller attachment to the GS WebComponent.\r\n * It is used to simplify and separate templates from logic.\r\n */\r\nexport class GSControllerElement extends GSElement {\r\n\r\n  static properties = {\r\n    module: {},\r\n    controller: {},\r\n  }\r\n\r\n  #clazz = false;\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  updated(changes) {\r\n    super.updated(changes);\r\n    const me = this;\r\n    if (me.isConnected && me.isValid) {\r\n      me.#initialize();\r\n    }\r\n  }\r\n\r\n  get isValid() {\r\n    return this.parentElement instanceof GSElement;\r\n  }\r\n\r\n  async #initialize() {\r\n\r\n    const me = this;\r\n    const host = me.parentElement;\r\n\r\n    if (me.#clazz) return;\r\n\r\n    let clazz = globalThis[me.controller];\r\n    if (!clazz && me.module) {\r\n      const url = GSLoader.normalizeURL(me.module);\r\n      const module = await import(url);\r\n      clazz = module[me.controller];\r\n    }\r\n\r\n    if (clazz) {\r\n      new clazz(host);\r\n      me.#clazz = clazz;\r\n      globalThis[me.controller] = clazz;\r\n    }\r\n\r\n  }\r\n\r\n  static {\r\n    this.define('gs-controller');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\nexport class GSCopyrightElement extends GSElement {\r\n\r\n  static properties = {\r\n    year: { reflect: true, type: Number },\r\n    company: { reflect: true },\r\n    url: { reflect: true },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.flat = true;\r\n    this.css = 'fixed-bottom d-flex justify-content-center align-items-center mt-1 p-2 text-muted';\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    if (!(me.isCompany && me.isYear)) return '';\r\n    const year = new Date().getFullYear();\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\" class=\"${classMap(me.renderClass())}\"><a target=\"_blank\" href=\"${me.url ? me.url : '#'}\"><small>&copy; ${me.company} ${me.year}. - ${year}.</small></a></div>`;\r\n  }\r\n\r\n  get isCompany() {\r\n    return GSUtil.isStringNonEmpty(this.company);\r\n  }\r\n\r\n  get isYear() {\r\n    return GSUtil.isStringNonEmpty(this.year);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-copyright');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSLog } from '../base/GSLog.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSFunction } from '../base/GSFunction.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { numGT0 } from '../properties/verificator.mjs';\r\nimport { GSReadWriteRegistry } from '../data/ReadWriteRegistry.mjs';\r\nimport { GSData } from '../base/GSData.mjs';\r\n\r\n/**\r\n * A module loading GSDataHandler class\r\n * @module components/GSDataHandler\r\n */\r\n\r\n/**\r\n * GUI element for easier access to the GSReadWrite/GSTreeReader\r\n * @class\r\n * @extends {GSElement}\r\n */\r\nexport class GSDataHandler extends GSElement {\r\n\r\n    static properties = {\r\n        storage: { state: true },\r\n        src: { reflect: true },\r\n        action: { reflect: true },\r\n        mode: { reflect: true },\r\n        reader: { reflect: true },\r\n        writer: { reflect: true },\r\n        limit: { type: Number, reflect: true },\r\n        skip: { type: Number, reflect: true },\r\n        filter: { type: Array, reflect: true },\r\n        sort: { type: Array, reflect: true },\r\n        type: {},\r\n        autoload: { type: Boolean },\r\n        autorefresh: { type: Number, reflect: true, hasChanged: numGT0 },\r\n    }\r\n\r\n    #iid = 0;\r\n    #config = null;\r\n    #handler = null;\r\n    #lifoReadRef = null;\r\n    #lifoWriteRef = null;\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;\r\n        me.storage = me.storage || me.id;\r\n        me.autorefresh = 0;\r\n        me.autoload = false;\r\n        me.flat = true;\r\n        me.filter = [];\r\n        me.sort = [];\r\n        me.limit = 0;\r\n        me.skip = 0;\r\n        me.src = '';\r\n        me.type = 'remote';\r\n        me.mode = 'query';\r\n        me.reader = 'GET';\r\n        me.writer = 'POST';\r\n        if (me.#isInTable) {\r\n            me.slot = \"extra\";\r\n          }\r\n        if (!me.isGenerated && !me.id) throw new Error('Element ID is required attribute!');\r\n        GSItem.validate(me, me.tagName);\r\n    }\r\n    \r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        const me = this;\r\n        me.storage = me.storage || me.id;\r\n        const itemHolder = me.isGenerated && me.childElementCount === 0 ? me.parentComponent : me;\r\n        me.#config = GSItem.proxify(itemHolder, GSData.PROPERTIES);\r\n        me.#initLIFO(true);\r\n        me.#initLIFO(false);\r\n    }\r\n    \r\n    disconnectedCallback() {\r\n        super.disconnectedCallback();\r\n        const me = this;\r\n        me.#handler?.disable();\r\n        me.#handler?.removeProcessor(me);\r\n        me.#lifoReadRef = null;\r\n        me.#lifoWriteRef = null;\r\n        clearTimeout(me.#iid);\r\n    }\r\n    \r\n    firstUpdated() {\r\n        const me = this;\r\n        me.#handler = GSReadWriteRegistry.newHandler(me.type, me.storage, false);\r\n        if (me.#config?.length > 0) me.#handler?.addProcessor(me);\r\n        me.#updateHandler(true);                \r\n    }\r\n\r\n    willUpdate(changed) {\r\n        super.willUpdate(changed);\r\n        const me = this;\r\n        me.#updateHandler();\r\n        if (changed.has('autorefresh')) me.schedule(me.autorefresh);\r\n    }\r\n\r\n    #updateHandler(first = false) {\r\n        const me = this;\r\n        if (!me.#handler) return;\r\n\r\n        me.#handler.src = me.src;\r\n        me.#handler.key = me.key;\r\n        me.#handler.mode = me.mode;\r\n        me.#handler.action = me.action;\r\n        me.#handler.reader = me.reader;\r\n        me.#handler.writer = me.writer;\r\n\r\n        me.#handler.limit = me.limit;\r\n        me.#handler.skip = me.skip;\r\n        me.#handler.sort = me.formatSort(me.sort);\r\n        me.#handler.filter = me.formatFilter(me.filter);\r\n        if (me.autoload) me.read();\r\n        if (first) {\r\n            me.#handler.enable();\r\n            // to prevent double read by this component and table\r\n            if (me.autoload) {\r\n                me.dataController?.read();\r\n            } \r\n        }\r\n    }\r\n\r\n    get isDebug() {\r\n        return this.dataset.gsDebug;\r\n    }\r\n\r\n    get handler() {\r\n        return this.#handler;\r\n    }\r\n\r\n    get isRegistered() {\r\n        return this.#handler?.isRegistered === true;\r\n    }\r\n\r\n    get isOffline() {\r\n        return this.#handler?.isOffline;\r\n    }\r\n\r\n    get isCached() {\r\n        return this.#handler?.type == 'cached';\r\n    }\r\n\r\n    set search(val) {\r\n        if (this.#handler) this.#handler.search = val;\r\n    }\r\n\r\n    get key() {\r\n        return this.#config.filter(o => o.key).map(o => o.name).pop() || null;\r\n    }\r\n\r\n    /**\r\n     * Filter data in format \r\n     * [{name: idx[num] || name[string], value: ''  , op:'eq'}]\r\n     */\r\n    formatFilter(val) {\r\n        val = this.#formated(val);\r\n        return Array.isArray(val) ? val : [];\r\n    }\r\n\r\n    /**\r\n     * Sort data in format\r\n     * [{col: idx[num] || name[string]  , op: -1 | 1 }]\r\n     */\r\n    formatSort(val) {\r\n        val = this.#formated(val);\r\n        let sort = undefined;\r\n        if (typeof val === 'string') {\r\n            sort = [{ col: val }];\r\n        } else if (Array.isArray(val)) {\r\n            sort = val;\r\n        } else if (GSUtil.isNumber(val)) {\r\n            const idx = Math.abs(val);\r\n            sort = new Array(idx);\r\n            sort[idx - 1] = { ord: val };\r\n        }\r\n        return sort || [];\r\n    }\r\n\r\n    schedule(time = 0) {\r\n        const me = this;\r\n        time = GSUtil.asNum(time) * 1000;\r\n        clearInterval(me.#iid);\r\n        if (time > 0) me.#iid = setInterval(() => {\r\n            me.read(me);\r\n        }, time);\r\n    }\r\n\r\n    read() {\r\n        return this.#lifoReadRef();\r\n    }\r\n\r\n    write(data, append = false) {\r\n        return this.#lifoWriteRef(data, append);\r\n    }\r\n\r\n    load() {\r\n        return this.read();\r\n    }\r\n\r\n    save(data) {\r\n        return this.write(data);\r\n    }\r\n\r\n    /**\r\n     * Return list of all selected record id's\r\n     */\r\n    get selected() {\r\n        return this.#handler?.selected;\r\n    }\r\n\r\n    /**\r\n     * Store selected record ID\r\n     * @param {*} val \r\n     * @returns \r\n     */\r\n    addSelected(val) {\r\n        return this.#handler?.addSelected(val);\r\n    }\r\n\r\n    /**\r\n     * Remove selected record ID\r\n     * @param {*} val \r\n     */\r\n    removeSelected(val) {\r\n        return this.#handler?.removeSelected(val);\r\n    }\r\n\r\n    /**\r\n     * Remove all selections\r\n     */\r\n    clearSelected(data) {\r\n        return this.#handler?.clearSelected();\r\n    }\r\n\r\n    /**\r\n     * Callback for data read result\r\n     */\r\n    onDataRead(obj) {\r\n        if (this.isDebug) GSLog.log(this, 'Data Read: ' + JSON.stringify(obj));\r\n    }\r\n\r\n    /**\r\n     * Callback for data write result\r\n     * @param {*} obj \r\n     */\r\n    onDataWrite(obj) {\r\n        if (this.isDebug) GSLog.log(this, 'Data write: ' + JSON.stringify(obj));\r\n    }\r\n\r\n    /**\r\n     * Process data after receive, before notifying \r\n     * @param {*} data \r\n     */\r\n    postRead(data) {\r\n        const me = this;\r\n        if (!Array.isArray(data)) data = [data];\r\n        data.forEach(r => {\r\n            me.#config.forEach(c => {\r\n                let val = r[c.name];\r\n                if (!GSUtil.isNull(val)) {\r\n                    val = GSData.format(c, val);\r\n                    r[c.name] = val;\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Callback on data red/write error\r\n     * @param {*} obj \r\n     */\r\n    onDataError(obj) {\r\n        if (this.isDebug) GSLog.log(this, 'Data error: ' + JSON.stringify(obj));\r\n    }\r\n\r\n    #verifyHandler() {\r\n        const me = this;\r\n        if (me.isOffline || me.isRegistered) return;\r\n        throw new Error('Data handler not initialized!');\r\n    }\r\n\r\n    #initLIFO(read = true) {\r\n        const me = this;\r\n        if (read) {\r\n            me.#lifoReadRef = GSFunction.callOnceLifo(me.#lifoReadRefCallback, me);\r\n        } else {\r\n            me.#lifoWriteRef = GSFunction.callOnceLifo(me.#lifoWriteRefCallback, me);\r\n        }\r\n    }\r\n\r\n    #lifoReadRefCallback() {\r\n        const me = this;\r\n        me.#initLIFO(true);\r\n        return me.#lifoCall(true);\r\n    }\r\n\r\n    #lifoWriteRefCallback(data, append) {\r\n        const me = this;\r\n        me.#initLIFO(false);\r\n        return me.#lifoCall(false, data, append);\r\n    }\r\n    \r\n    #lifoCall(read = true, data, append) {\r\n        const me = this;\r\n        me.#verifyHandler();        \r\n        if (read) return me.#handler?.read(me);        \r\n        if (!append) me.#handler.clear();\r\n        return me.#handler?.write(me, data);\r\n    }\r\n\r\n    #formated(val) {\r\n        return GSUtil.isJsonString(val) ? JSON.parse(val) : val;\r\n    }\r\n\r\n    get #isInTable() {\r\n        return this.parentComponent?.tagName === 'GS-TABLE';\r\n    }\r\n\r\n    static {\r\n        this.define('gs-data-handler');\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, css, html, ifDefined, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { size, SizeTypes } from '../properties/size.mjs';\r\n\r\nexport class GSDialogElement extends GSElement {\r\n\r\n  static CSS = 'rounded shadow-sm';\r\n  static HEADER_CSS = 'p-3';\r\n  static TITLE_CSS = 'fs-5 fw-bold text-muted';\r\n  static ALIGN = 'end';\r\n  static CANCEL = 'Cancel';\r\n  static CONFIRM = 'Ok';\r\n\r\n  static #STACK = [];\r\n\r\n  static styles = css`dialog {\r\n      --bs-modal-width: 500px;\r\n      width:var(--bs-modal-width);\r\n      outline:none;\r\n    }\r\n    dialog::backdrop {\r\n      backdrop-filter: blur(4px);\r\n      backdrop-filter: blur(var(--gs-backdrop-blur));      \r\n      background-color: var(--gs-backdrop-color);\r\n      display: var(--gs-backdrop-display);\r\n    }`;\r\n\r\n  static properties = {\r\n\r\n    standard: { reflect: true, type: Boolean },\r\n    opened: { reflect: true, type: Boolean },\r\n    cancelable: { reflect: true, type: Boolean },\r\n    closable: { reflect: true, type: Boolean },\r\n    escapable: { reflect: true, type: Boolean },\r\n    disabled: { reflect: true, type: Boolean },\r\n\r\n    size: size,\r\n\r\n    title: { reflect: true },\r\n    message: { reflect: true },\r\n    cancelText: { reflect: true, attribute: 'text-cancel' },\r\n    confirmText: { reflect: true, attribute: 'text-confirm' },\r\n\r\n    minWidth: { reflect: true, type: Number, attribute: 'min-width' },\r\n    buttonAlign: { reflect: true, attribute: 'button-align' },\r\n\r\n    iconCancel: { reflect: true, attribute: 'icon-cancel' },\r\n    iconConfirm: { reflect: true, attribute: 'icon-confirm' },\r\n\r\n    colorCancel: { attribute: 'color-cancel' },\r\n    colorConfirm: { attribute: 'color-confirm' },\r\n\r\n    cssCancel: { attribute: 'css-cancel' },\r\n    cssConfirm: { attribute: 'css-confirm' },\r\n\r\n    cssTitle: { attribute: 'css-title' },\r\n    cssHeader: { attribute: 'css-header' },\r\n    cssFooter: { attribute: 'css-footer' },\r\n    cssBody: { attribute: 'css-body' },\r\n    cssContent: { attribute: 'css-content' },\r\n\r\n  }\r\n\r\n  #pass = false;\r\n  #styleID = GSID.id;\r\n  #dialogRef = createRef();\r\n  #btnConfirmRef = createRef();\r\n  #btnCancelRef = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    const clazz = GSDialogElement;\r\n    me.opened = false;\r\n    me.standard = false;\r\n    me.cancelable = false;\r\n    me.closable = false;\r\n    me.escapable = false;\r\n    me.disabled = false;\r\n    me.shadow = false;\r\n    me.rounded = false;\r\n\r\n    me.minWidth = 0;\r\n    me.css = clazz.CSS;\r\n    me.cssTitle = clazz.TITLE_CSS;\r\n    me.cssHeader = clazz.HEADER_CSS;\r\n    me.buttonAlign = clazz.ALIGN;\r\n    me.cancelText = clazz.CANCEL;\r\n    me.confirmText = clazz.CONFIRM;\r\n    me.colorCancel = 'secondary';\r\n    me.colorConfirm = 'primary';\r\n    me.dynamicStyle(me.#styleID);\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    super.disconnectedCallback();\r\n    GSDialogElement.#updateStack();\r\n  }\r\n\r\n  firstUpdated() {\r\n    super.firstUpdated();\r\n    this.#pass = true;\r\n  }\r\n\r\n  _shouldUpdate(changed) {\r\n    const me = this;\r\n    return me.opened === true || me.#pass;\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    const me = this;\r\n    const allowed = me.opened === true || me.#pass;\r\n    // initially hidden dialogs rendering are posponed\r\n    if (!allowed) {\r\n      GSUtil.timeout(1000).then(() => {\r\n        queueMicrotask(() => { \r\n          const allowed = me.opened === true || me.#pass;\r\n          if (!allowed) {\r\n            me.#pass = true;\r\n            if (me.isConnected) me.requestUpdate();\r\n          }\r\n        });          \r\n      });\r\n    }\r\n    return allowed;\r\n  }\r\n\r\n  updated(changed) {\r\n    super.updated(changed);\r\n    if (changed.has('opened')) {\r\n      this.#onOpenChanged();\r\n    }\r\n  }\r\n\r\n  #onOpenChanged() {\r\n    const me = this;\r\n    let state = null;\r\n    if (me.opened) {\r\n      GSDialogElement.#STACK.push(me);\r\n      state = 'opening';\r\n      if (me.standard) {\r\n        me.#dialog?.open();\r\n      } else {\r\n        me.#dialog?.showModal();\r\n      }\r\n      me.#focusable()?.focus();\r\n    } else {\r\n      state = 'closing';\r\n      if (me.isHashed) location.hash = '';\r\n      GSDialogElement.#STACK.pop();\r\n      me.#dialog?.close();\r\n    }\r\n    me.notify(true, false, state);\r\n  }\r\n\r\n  #renderConfirm() {\r\n    const me = this;\r\n    if (!me.closable) return '';\r\n    return html`<gs-button  ${ref(me.#btnConfirmRef)} \r\n      @click=\"${me.#onConfirm.bind(me)}\" \r\n      icon=\"${ifDefined(me.iconConfirm)}\"\r\n      language=\"${ifDefined(me.language)}\"\r\n      .disabled=\"${me.disabled}\"  \r\n      css=\"${ifDefined(me.cssConfirm)}\" \r\n      color=\"${ifDefined(me.colorConfirm)}\" \r\n      title=\"${me.confirmText}\">\r\n      </gs-button>`;\r\n  }\r\n\r\n  #renderCancel() {\r\n    const me = this;\r\n    if (!me.cancelable) return '';\r\n    return html`<gs-button ${ref(me.#btnCancelRef)}\r\n      @click=\"${me.#onCancel.bind(me)}\" \r\n      icon=\"${ifDefined(me.iconCancel)}\"\r\n      language=\"${ifDefined(me.language)}\"\r\n      css=\"${ifDefined(me.cssCancel)}\" \r\n      color=\"${ifDefined(me.colorCancel)}\" \r\n      title=\"${me.cancelText}\">\r\n      </gs-button>`;\r\n  }\r\n\r\n  #renderFooter() {\r\n    const me = this;\r\n    const isFooter = me.cancelable || me.closable;\r\n    if (!isFooter) return '';\r\n    return html`<div class=\"card-footer d-flex user-select-none justify-content-${me.buttonAlign} ${me.cssFooter}\">\r\n       <slot name=\"actions\"></slot>\r\n      ${me.#renderCancel()} &nbsp;${me.#renderConfirm()}\r\n      </div>`;\r\n  }\r\n\r\n  #renderContent() {\r\n    const me = this;\r\n    const css = {\r\n      card : true,\r\n      [`p-${me.padding}`]: me.padding >= 0,\r\n      [`m-${me.margin}`]: me.margin >= 0      \r\n    }\r\n    me.cssContent?.match(/[^ ]+/g).forEach(v => css[v]=true);\r\n    return css;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const size = SizeTypes[me.size];\r\n    //...super.renderClass(),\r\n    const css = {\r\n      'dialog': true,\r\n      'p-0': true,\r\n      'border': me.bordered,\r\n      'border-0': !me.bordered,\r\n      'shadow-sm': me.shadow,\r\n      'rounded': me.rounded,      \r\n      [me.#styleID]: true,\r\n      [`modal-${size}`]: size ? true : false\r\n    }\r\n    return css;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const styles = {\r\n      'min-width': me.minWidth > 0 ? `${me.minWidth}px` : undefined\r\n    };\r\n    me.dynamicStyle(me.#styleID, styles);\r\n    return html`\r\n        <dialog tabindex=\"-1\" ${ref(me.#dialogRef)} \r\n            dir=\"${ifDefined(me.direction)}\"\r\n            @close=\"${me.#onCancel.bind(me)}\"\r\n            @cancel=\"${me.#onCancel.bind(me)}\"\r\n            @keydown=\"${me.#onKeyDown.bind(me)}\"\r\n            @form=\"${me.#onForm.bind(me)}\"\r\n            @confirm=\"${me.#onConfirm.bind(me)}\"\r\n            @submit=\"${me.#onSubmit.bind(me)}\"\r\n            class=\"${classMap(me.renderClass())}\">\r\n            <div class=\"${classMap(me.#renderContent())}\">\r\n                <div class=\"card-header user-select-none ${me.cssHeader}\">\r\n                  <div class=\"card-title ${me.cssTitle}\">\r\n                    <slot name=\"title\">${me.translate(me.title)}</slot>\r\n                  </div>\r\n                </div>\r\n                <div class=\"card-body ${me.cssBody}\">\r\n                  <slot name=\"body\">\r\n                  ${me.translate(me.message)}\r\n                  ${me.renderTemplate()}\r\n                  </slot>\r\n                  </div>\r\n                  ${me.#renderFooter()}\r\n                  </div>\r\n                  <slot name=\"extra\"></slot>\r\n                  <div class=\"toast-container position-fixed\"></slot></div>\r\n                  </dialog>\r\n                  `;\r\n  }\r\n\r\n  /**\r\n   * Generic modal popup function\r\n   * @param {string} title Modal title\r\n   * @param {string} message Modal message \r\n   * @param {boolean} closable Can user close it (close button)\r\n   * @param {boolean} cancelable Is cancel button available\r\n   * @returns {Promise}\r\n   */\r\n  info(title = '', message = '', closable = false, cancelable = false) {\r\n    const me = this;\r\n    me.title = title;\r\n    me.message = message;\r\n    me.closable = closable;\r\n    me.cancelable = cancelable;\r\n    me.escapable = cancelable;\r\n    me.open();\r\n    if (closable || cancelable) return me.waitEvent('click-action');\r\n  }\r\n\r\n  confirm(title = '', message = '') {\r\n    return this.info(title, message, true, false);\r\n  }\r\n\r\n  prompt(title = '', message = '') {\r\n    return this.info(title, message, true, true);\r\n  }\r\n\r\n  reset(data, index = 0) {\r\n    index = GSUtil.asNum(index, 0);\r\n    const me = this;\r\n    me.forms?.forEach?.(f => { f.reset(); f.data = data; });\r\n    const tab = me.tab;\r\n    if (tab && index > -1) tab.index = index;\r\n  }\r\n\r\n  open() {\r\n    this.opened = true;\r\n  }\r\n\r\n  close() {\r\n    this.opened = false;\r\n  }\r\n\r\n  toggle() {\r\n    this.opened = !this.opened;\r\n  }\r\n\r\n  /**\r\n   * Retrun true if dialog is opened by hashbang.\r\n   * Used to clear the hashbang on close\r\n   */\r\n  get isHashed() {\r\n    return GSUtil.asBool(this.dataset.gsHashed);\r\n  }\r\n\r\n  get form() {\r\n    return this.query('gs-form', true, true);\r\n  }\r\n\r\n  get forms() {\r\n    return this.queryAll('gs-form', true, true);\r\n  }\r\n\r\n  get tab() {\r\n    return this.query('gs-tab', true, true);\r\n  }\r\n\r\n  get #dialog() {\r\n    return this.#dialogRef.value;\r\n  }\r\n\r\n  get #btnConfirm() {\r\n    return this.#btnConfirmRef.value;\r\n  }\r\n\r\n  get #btnCancel() {\r\n    return this.#btnCancelRef.value;\r\n  }\r\n\r\n  /**\r\n   * Return active button\r\n   * @returns {HTMLButtonElement|GSButton}\r\n   */\r\n  #focusable() {\r\n    const me = this;\r\n    const form = me.queryAll(GSDOM.QUERY_INPUT, true).filter(el => GSDOM.isVisible(el)).shift();\r\n    if (form) return form;\r\n    if (me.cancelable) return me.#btnCancel;\r\n    if (me.closable) return me.#btnConfirm;\r\n    return me;\r\n  }\r\n\r\n  async #onConfirm(e) {\r\n    const me = this;\r\n    if (me.disabled) return;\r\n    const ret = await Promise.all(me.forms?.map?.(form => form.submit()));\r\n    if (ret.indexOf(false) < 0) me.close();\r\n  }\r\n\r\n  #onCancel(e) {\r\n    const me = this;\r\n    me.close();\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n    const me = this;\r\n    if (e.key === 'Escape') {\r\n      GSEvents.prevent(e);\r\n      if (me.cancelable || me.escapable) {\r\n        me.close();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle injected form events\r\n   * @param {*} e \r\n   */\r\n  #onForm(e) {\r\n    let sts = true;\r\n    const me = this;\r\n    const data = e.detail;\r\n    switch (data.type) {\r\n      case 'submit':\r\n        sts = me.emit('data', data.data, false, false, true);\r\n        if (!sts) GSEvents.prevent(e);\r\n        //me.opened = false;\r\n        break;\r\n      case 'valid':\r\n        me.disabled = data.data === false;\r\n        break;\r\n    }\r\n    return sts;\r\n  }\r\n\r\n  #onSubmit(e) {\r\n    debugger;\r\n  }\r\n\r\n  static #updateStack() {\r\n    GSDialogElement.#STACK = GSDialogElement.#STACK.filter(v => v.isConnected);\r\n  }\r\n\r\n  /**\r\n   * Return number of dialogs in a stack\r\n   */\r\n  static get size() {\r\n    return GSDialogElement.#STACK.length;\r\n  }\r\n\r\n  static get top() {\r\n    GSDialogElement.#updateStack();\r\n    const size = GSDialogElement.size;\r\n    return size === 0 ? null : GSDialogElement.#STACK[size - 1];\r\n  }\r\n\r\n  static get opened() {\r\n    GSDialogElement.#updateStack();\r\n    return Array.from(GSDialogElement.#STACK);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-dialog');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, unsafeHTML, html, ifDefined } from '../lib.mjs';\r\nimport { placement, PlacementTypes } from '../properties/placement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSDrawerElement extends GSElement {\r\n\r\n  static properties = {\r\n    autoclose: { reflect: true, type: Boolean },\r\n    closable: { reflect: true, type: Boolean },\r\n    backdrop: { reflect: true, type: Boolean },\r\n    expanded: { reflect: true, type: Boolean },\r\n    scroll: { reflect: true, type: Boolean },\r\n\r\n    min: { reflect: true, type: Number},\r\n    max: { reflect: true},\r\n    fingers: { reflect: true, type: Number},\r\n    placement: {...placement},\r\n    \r\n    transition: { reflect: true },\r\n    duration: { reflect: true, type: Number },\r\n\r\n    title: { reflect: true},\r\n\r\n    cssTitle: { reflect: true, attribute: \"css-title\"},\r\n    cssHead: { reflect: true, attribute: \"css-head\" },\r\n    cssBody: { reflect: true, attribute: \"css-body\" },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.placement = 'start';\r\n    me.cssTitle = 'fs-5';\r\n    me.transition = 'linear';\r\n    me.duration = 0.2;\r\n    me.min = 0;\r\n    me.max = 'auto';\r\n    me.fingers = 2;\r\n    me.on('mouseleave', me.#onLeave.bind(me));\r\n    me.on('mouseenter', me.#onEnter.bind(me));\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`${unsafeHTML(me.#style)}\r\n    <div tabindex=\"-1\" dir=\"${ifDefined(me.direction)}\"\r\n     class=\"offcanvas overflow-hidden anime ${classMap(me.renderClass())}\">\r\n      ${me.#header}\r\n      <div class=\"offcanvas-body  ${me.cssBody}\">\r\n        ${me.renderTemplate()}\r\n        <slot name=\"body\"></slot>\r\n      </div>\r\n    </div>${me.#backdrop}`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'show': true,\r\n      'anime-open' : me.expanded,\r\n      'anime-close' : !me.expanded,\r\n      [`offcanvas-${me.placement}`]: me.placement,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  get #style() {\r\n    const me = this;\r\n    const pos = me.isHorizontal ? 'width' : 'height';\r\n    return `<style>\r\n    .anime {\r\n      transition-property: ${pos} !important;\r\n      transition-duration: ${me.duration}s  !important;\r\n      transition-timing-function: ${me.transition} !important;\r\n    }\r\n    .anime-open {\r\n        ${pos} : ${me.max}${GSUtil.isNumber(me.max) ? 'px':''} !important;\r\n    }\r\n    .anime-close {\r\n      ${pos} : ${me.min}${GSUtil.isNumber(me.min) ? 'px':''} !important;\r\n    }    \r\n    </style>`;\r\n  }\r\n\r\n  get #backdrop() {\r\n    const me = this;\r\n    if (!me.backdrop) return '';\r\n    return html`<div class=\"offcanvas-backdrop fade ${me.expanded ? 'show' : 'invisible'}\" @click=\"${me.close}\"></div>`;\r\n  }\r\n\r\n  get #button() {\r\n    const me = this;\r\n    return me.closable ? html`<button type=\"button\" class=\"btn-close text-reset\" @click=\"${me.close}\"></button>` : '';\r\n  }\r\n\r\n  get #title() {\r\n    const me = this;\r\n    return me.title ? html`<div class=\"offcanvas-title ${me.cssTitle}\">${me.translate(me.title)}</div>` : '';\r\n  }\r\n\r\n  get #header() {\r\n    const me = this;\r\n    return me.#hasHeader ? html`<div class=\"offcanvas-header ${me.cssHead}\"><slot name=\"header\">${me.#title}${me.#button}</slot></div>` : '';\r\n  }\r\n\r\n  get #headSlot() {\r\n    return this.querySelector('[slot=\"header\"]', false, true);\r\n  }\r\n\r\n  get #hasHeader() {\r\n    return this.title || this.closable || this.#headSlot;\r\n  }\r\n\r\n  #notify(val) {\r\n    const me = this;\r\n    me.expanded = val == true;\r\n    me.notify();\r\n  }\r\n\r\n  #onLeave() {\r\n    const me = this;\r\n    if (me.autoclose) me.close();\r\n  }\r\n\r\n  #onEnter() {\r\n    const me = this;\r\n    if (me.min > 0) me.open();\r\n  }\r\n\r\n  open() {\r\n    this.#notify(true);\r\n  }\r\n\r\n  close() {\r\n    this.#notify(false);\r\n  }\r\n\r\n  toggle() {\r\n    this.#notify(!this.expanded);\r\n  }\r\n\r\n  get isHorizontal() {\r\n    return !this.isVertical;\r\n  }\r\n\r\n  get isVertical() {\r\n    return PlacementTypes.isVertical(this.placement);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-drawer');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDropdownElement class\r\n * @module components/GSDropdownElement\r\n */\r\n\r\nimport { html, ifDefined } from '../lib.mjs';\r\nimport { cssMap } from '../directives/css-map.mjs';\r\nimport { color } from '../properties/color.mjs';\r\nimport { GSMenuElement } from './Menu.mjs';\r\n\r\n/**\r\n * Renderer for panel layout \r\n * @class\r\n * @extends {GSMenuElement}\r\n */\r\nexport class GSDropdownElement extends GSMenuElement {\r\n\r\n    static properties = {\r\n        icon: {},\r\n        text: {...color},\r\n        color: {...color},\r\n        size: {},\r\n        title: {},\r\n        tooltip: {},\r\n        group: {},\r\n        simple: {type:Boolean}\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.auto = true;\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div class=\"dropdown\"  dir=\"${ifDefined(me.direction)}\">\r\n                ${me.#renderButton()}\r\n                ${super.renderUI()}\r\n            </div>`;\r\n    }\r\n\r\n    #buttonClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            'btn': true,\r\n            [`btn-${me.color}`] : me.color ? true : false,\r\n            'dropdown-toggle': !me.simple,\r\n            'shadow-none' : true,\r\n        }\r\n        return css;\r\n    }\r\n\r\n    #renderButton() {\r\n        const me = this;\r\n        return html`<gs-link css=\"${cssMap(me.#buttonClass())}\"\r\n            url=\"#\"         \r\n            icon=\"${ifDefined(me.icon)}\"\r\n            text=\"${ifDefined(me.text)}\"\r\n            size=\"${ifDefined(me.size)}\"\r\n            title=\"${ifDefined(me.title)}\"\r\n            tooltip=\"${ifDefined(me.tooltip)}\"\r\n            @notify=\"${me.toggle}\">\r\n            </gs-link>`;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-dropdown');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { css, html, unsafeHTML } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\n/**\r\n * Safe email rendering to protect from spam bots.\r\n */\r\nexport class GSEmailElement extends GSElement {\r\n\r\n  static shadowRootOptions = { mode: 'closed' }\r\n\r\n  static style = css`.e-mail:before {\r\n    content: attr(data-website) \"\\0040\" attr(data-user);\r\n    unicode-bidi: bidi-override;\r\n    direction: rtl;\r\n    }`;\r\n\r\n  static properties = {\r\n    user: { reflect: true },\r\n    domain: { reflect: true },\r\n    dev: { type: Boolean }\r\n  }\r\n\r\n  #user;\r\n  #domain;\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  willUpdate(changes) {\r\n    super.willUpdate(changes);\r\n    this.#updateUser();\r\n    this.#updateDomain()\r\n  }\r\n\r\n  renderUI() {\r\n    return html`${unsafeHTML(this.#style)}<a @click=\"${this.#onClick}\" class=\"e-mail\" data-user=\"${this.#user}\" data-website=\"${this.#domain}\"  href=\"mailto://\"></a>`;\r\n  }\r\n\r\n  get #style() {\r\n    return '<style>.e-mail:before { content: attr(data-website) \"\\u0040\" attr(data-user); unicode-bidi: bidi-override; direction: rtl; }</style>';\r\n  }\r\n\r\n  get #url() {\r\n    return `mailto://${GSUtil.reverse(this.dataset.user)}@${GSUtil.reverse(this.dataset.domain)}`;\r\n  }\r\n\r\n  #updateUser() {\r\n    const me = this;\r\n    const dataset = me.dataset;\r\n    if (me.user) {\r\n      me.#user = dataset.user || GSUtil.reverse(me.user);\r\n      if (me.dev) dataset.user = me.#user;\r\n      me.user = '';\r\n    }\r\n  }\r\n\r\n  #updateDomain() {\r\n    const me = this;\r\n    const dataset = me.dataset;\r\n    if (me.domain) {\r\n      me.#domain = dataset.domain || GSUtil.reverse(me.domain);\r\n      if (me.dev) dataset.domain = me.#domain;\r\n      me.domain = '';\r\n    }\r\n  }\r\n\r\n  #onClick(e) {\r\n    const me = this;\r\n    me.prevent(e);\r\n    window.location.href = me.#url;\r\n    //window.open(me.#url, '_blank');  \r\n  }\r\n\r\n  static {\r\n    this.define('gs-email');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, html, ifDefined, ref, templateContent } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSLog } from '../base/GSLog.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\nexport class GSFormElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    data: { type: Object },\r\n    disabled: { reflect: true, type: Boolean },\r\n\r\n    url: { reflect: true },\r\n    name: { reflect: true },\r\n    rel: { reflect: true },\r\n    acceptCharset: { reflect: true, attribute: 'accept-charset' },\r\n    autocapitalize: { reflect: true },\r\n    autocomplete: { reflect: true },\r\n\r\n    // default settings for FormGroup or gs-ext-* form elements\r\n    autocopy: { reflect: true, type: Boolean },\r\n    autofocus: { reflect: true, type: Boolean },\r\n    autoselect: { reflect: true, type: Boolean },\r\n    autovalidate: { reflect: true, type: Boolean },\r\n    autoreport: { reflect: true, type: Boolean },\r\n\r\n    action: { reflect: true },\r\n    enctype: { reflect: true },\r\n    method: { reflect: true },\r\n    novalidate: { reflect: true, type: Boolean },\r\n    target: { reflect: true },\r\n\r\n    block: { reflect: true, type: Boolean },\r\n    beep: { reflect: true, type: Boolean },\r\n    timeout: { reflect: true, type: Number }\r\n  }\r\n\r\n  #formRef = createRef();\r\n  #lastState = undefined;\r\n\r\n  constructor() {\r\n    super();\r\n    this.data = {};\r\n    this.disabled = false;\r\n    this.method = \"dialog\";\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<form is=\"gs-ext-form\"\r\n      ${ref(me.#formRef)}\r\n      id=\"${ifDefined(me.name)}\"\r\n      name=\"${ifDefined(me.name)}\"\r\n      dir=\"${ifDefined(me.direction)}\"\r\n      class=\"${classMap(me.renderClass())}\"\r\n      \r\n      @blur=\"${me.#onBlur}\"\r\n      @change=\"${me.#onChange}\"\r\n      @invalid=\"${me.#onInvalid}\"\r\n      @submit=\"${me.submit}\"\r\n      @reset=\"${me.reset}\"\r\n      \r\n      method=\"${me.method}\"      \r\n      url=\"${ifDefined(me.url)}\"\r\n      \r\n      rel=\"${ifDefined(me.rel)}\"\r\n      acceptCharset=\"${ifDefined(me.acceptCharset)}\"\r\n      autocapitalize=\"${ifDefined(me.autocapitalize)}\"\r\n      autocomplete=\"${ifDefined(me.autocomplete)}\"\r\n      action=\"${ifDefined(me.action)}\"\r\n      enctype=\"${ifDefined(me.enctype)}\"\r\n      target=\"${ifDefined(me.target)}\"\r\n\r\n      ?novalidate=\"${me.novalidate}\">\r\n      ${templateContent(me.#elementTemplate)}\r\n      <slot></slot>\r\n    </form>`;\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    const me = this;\r\n    me.dataController?.read();\r\n  }\r\n\r\n  updated(changed) {\r\n    const me = this;\r\n    if (changed.has('data')) {\r\n      if (GSUtil.isNull(me.data)) {\r\n        me.reset();\r\n      } else {\r\n        me.asJSON = Object.assign(me.asJSON, me.data);\r\n      }\r\n    }\r\n  }\r\n\r\n  templateInjected() {\r\n    const me = this;\r\n  }\r\n\r\n  async reset(e) {\r\n    const me = this;\r\n    me.form?.reset();\r\n    me.data = {};\r\n    await me.dataController?.read(me.asJSON);\r\n  }\r\n\r\n  async submit(e) {\r\n    GSEvents.prevent(e, true, false, false);\r\n    const me = this;\r\n    if (me.disabled) return;\r\n    if (!me.validate()) return;\r\n    const json = me.asJSON;\r\n    await me.dataController?.write(json);\r\n    const data = { type: 'submit', data: json, source: e, owner: me };\r\n    return me.emit('form', data, true, true, true);\r\n  }\r\n\r\n  get submitButton() {\r\n    return this.form?.submitButton;\r\n  }\r\n\r\n  get resetButton() {\r\n    return this.form?.resetButton;\r\n  }\r\n\r\n  get form() {\r\n    return this.#formRef.value;\r\n  }\r\n\r\n  /**\r\n  * Overide native to pickup all form elements, including ones in shadow dom\r\n  */\r\n  get elements() {\r\n    return this.form?.elements || [];\r\n  }\r\n\r\n  /**\r\n   * Get all form attached native fields unwrapepd from GSWebComponents\r\n   */\r\n  get fields() {\r\n    return this.form?.fields || [];\r\n  }\r\n\r\n  /**\r\n   * Find all inputs by querying across inner shadow \r\n   */\r\n  get inputs() {\r\n    return this.form?.inputs || [];\r\n  }\r\n\r\n  get invalid() {\r\n    return this.form?.invalid;\r\n  }\r\n\r\n  get isValid() {\r\n    return this.form?.isValid;\r\n  }\r\n\r\n  get asJSON() {\r\n    return this.form?.asJSON;\r\n  }\r\n\r\n  set asJSON(data) {\r\n    const me = this;\r\n    if (me.form) {\r\n      me.form.asJSON = data;\r\n      me.validate();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Find field by name\r\n   * @param {*} name \r\n   * @returns \r\n   */\r\n  field(name) {\r\n    return this.form?.field(name);\r\n  }\r\n\r\n  checkValidity() {\r\n    return this.form?.checkValidity();\r\n  }\r\n\r\n  reportValidity() {\r\n    return this.form?.reportValidity();\r\n  }\r\n\r\n  validate(e) {\r\n    const me = this;\r\n    let isValid = me.form?.validate();\r\n    isValid = me.onValidate(isValid);\r\n    me.#notify(isValid, e);\r\n    me.invalid[0]?.focus();\r\n    return isValid;\r\n  }\r\n\r\n  disable(all = false) {\r\n    this.form?.disable(all);\r\n  }\r\n\r\n  enable(all = false) {\r\n    this.form?.enable(all);\r\n  }\r\n\r\n  /**\r\n   * For DataController read callback\r\n   * \r\n   * @param {Array} data \r\n   */\r\n  onDataRead(data) {\r\n    const me = this;\r\n    if (Array.isArray(data)) {\r\n      data.forEach(o => me.asJSON = o);\r\n    } else {\r\n      me.asJSON = data;\r\n    }\r\n  }\r\n\r\n  onDataWrite(data) {\r\n\r\n  }\r\n\r\n  onDataError(e) {\r\n    GSLog.error(this, e);\r\n  }\r\n\r\n  onValidate(sts) {\r\n\r\n    return sts;\r\n  }\r\n\r\n  #onInvalid(e) {\r\n    const me = this;\r\n    me.prevent(e, false, true, false);\r\n    me.#notify(false, e);\r\n  }\r\n\r\n  #onBlur(e) {\r\n    const me = this;\r\n    me.prevent(e, false, true, false);\r\n    me.#notify(me.isValid, e);\r\n  }\r\n\r\n  #onChange(e) {\r\n    const me = this;\r\n    //me.prevent(e, false, true, false);\r\n    me.#notify(me.isValid, e);\r\n  }\r\n\r\n  #notify(isValid = false, e) {\r\n    const me = this;\r\n    if (me.#lastState === isValid) return;\r\n    me.#lastState = isValid;\r\n    const data = { type: 'valid', data: isValid, owner: me, event: e };\r\n    me.emit('form', data, true, true);\r\n  }\r\n\r\n  get #elementTemplate() {\r\n    const tplEl = this.firstElementChild;\r\n    return GSDOM.isTemplateElement(tplEl) ? tplEl : undefined;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-form');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, ref, html, unsafeHTML, ifDefined } from '../lib.mjs';\r\nimport { inputType, numGT0, numGE0, autocapitalize, autocorrect } from '../properties/index.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { dataset } from '../directives/dataset.mjs';\r\n\r\nexport class GSFormGroupElement extends GSElement {\r\n\r\n  static CSS_LABEL_CELL = 'col-md-4 col-sm-4 col-xs-2';\r\n  static CSS_LABEL = 'user-select-none fw-small fw-light text-secondary';\r\n  static CSS_ICON = 'text-primary me-2 fs-5';\r\n  static ICON = 'info-circle-fill';\r\n\r\n  static formAssociated = true;\r\n\r\n  static #SELECTOPT = {\r\n    name: {},\r\n    value: {},\r\n    selected: { type: Boolean }\r\n  }\r\n\r\n  static properties = {\r\n    icon: { reflect: true },\r\n    layout: { reflect: true },\r\n    placement: { reflect: true },\r\n\r\n    label: { reflect: true },\r\n    description: { reflect: true },\r\n    placeholder: { reflect: true },\r\n\r\n    pattern: { reflect: true },\r\n    mask: { reflect: true },\r\n\r\n    form: { reflect: true },\r\n    wrap: { reflect: true },\r\n    spellcheck: { reflect: true },\r\n\r\n    type: { reflect: true, ...inputType },\r\n    name: { reflect: true },\r\n    list: { reflect: true },\r\n    accept: { reflect: true },\r\n    value: { noAccessor: true },\r\n\r\n    values: {},\r\n\r\n    lang: { reflect: true },\r\n    title: { reflect: true },\r\n    rows: { type: Number, reflect: true, hasChanged: numGT0 },\r\n    cols: { type: Number, reflect: true, hasChanged: numGT0 },\r\n    step: { type: Number, reflect: true, hasChanged: numGT0 },\r\n    min: { type: Number, reflect: true, hasChanged: numGE0 },\r\n    max: { type: Number, reflect: true, hasChanged: numGT0 },\r\n    minLength: { type: Number, reflect: true, hasChanged: numGE0 },\r\n    maxLength: { type: Number, reflect: true, hasChanged: numGT0 },\r\n\r\n    reverse: { reflect: true, type: Boolean },\r\n    selectable: { reflect: true, type: Boolean },\r\n\r\n    autoid: { type: Boolean, reflect: true },\r\n    autocopy: { type: Boolean, reflect: true },\r\n    autoselect: { type: Boolean, reflect: true },\r\n\r\n    autocapitalize: { ...autocapitalize, reflect: true },\r\n    autocorrect: { ...autocorrect, reflect: true },\r\n    autocomplete: { reflect: true },\r\n    autofocus: { type: Boolean, reflect: true },\r\n    autoselect: { type: Boolean, reflect: true },\r\n    autovalidate: { type: Boolean, reflect: true },\r\n    autoreport: { type: Boolean, reflect: true },\r\n\r\n    disabled: { type: Boolean, reflect: true },\r\n    checked: { type: Boolean, reflect: true },\r\n    multiple: { type: Boolean, reflect: true },\r\n    reveal: { type: Boolean, reflect: true },\r\n    readonly: { type: Boolean, reflect: true },\r\n    required: { type: Boolean, reflect: true },\r\n\r\n    invalidMessage: { reflect: true, attribute: 'invalid-message' },\r\n\r\n    cellField: { reflect: true, attribute: 'cell-field' },\r\n    cellLabel: { reflect: true, attribute: 'cell-label' },\r\n    cssLabel: { reflect: true, attribute: 'css-label' },\r\n    cssField: { reflect: true, attribute: 'css-field' },\r\n\r\n    block: { reflect: true, type: Boolean },\r\n    beep: { reflect: true, type: Boolean },\r\n    timeout: { reflect: true, type: Number }\r\n  }\r\n\r\n  #styleID = GSID.id;\r\n  #inputRef = createRef();\r\n  #ouptutRef = createRef();\r\n  #patterns = [];\r\n  #options = [];\r\n  #internals = null;\r\n\r\n  constructor() {\r\n    super();\r\n    this.#internals = this.attachInternals();\r\n    this.#validateAllowed();\r\n    this.dynamicStyle(this.#styleID);\r\n    this.rows = 0;\r\n    this.cols = 0;\r\n    this.type = 'text';\r\n    this.placement = 'top';\r\n    this.layout = 'horizontal';\r\n    this.invalidMessage = 'Invalid input',\r\n      this.icon = GSFormGroupElement.ICON;\r\n    this.cssLabel = GSFormGroupElement.CSS_LABEL;\r\n    this.cellLabel = GSFormGroupElement.CSS_LABEL_CELL;\r\n  }\r\n\r\n  connectedCallback() {\r\n    const me = this;\r\n    const form = me.formComponent;\r\n    me.layout = GSAttr.get(form, 'layout', me.layout);\r\n\r\n    if (!me.form && form) me.form = form.name;\r\n\r\n    if (me.selectable) {\r\n      me.#options = GSItem.proxify(me, GSFormGroupElement.#SELECTOPT);\r\n    } else {\r\n      me.#patterns = GSItem.collect(me)\r\n        .filter(el => el.dataset.pattern)\r\n        .map(el => new RegExp(el.dataset.pattern));\r\n    }\r\n    super.connectedCallback();\r\n  }\r\n\r\n  updated(changed) {\r\n    const me = this;\r\n    //me.#onInput();\r\n    me.emit('input');\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    switch (me.layout) {\r\n      case 'floating': return me.#renderFloating();\r\n      case 'vertical': return me.#renderVertical();\r\n      default: return me.#renderHorizontal();\r\n    }\r\n  }\r\n\r\n\r\n  #renderFloating() {\r\n    const me = this;\r\n    return html`\r\n    <div  dir=\"${ifDefined(me.direction)}\" class=\"row ${classMap(me.renderClass())}\">\r\n       <div class=\"form-floating ${me.#cssCheck} ${me.#cellField}\">\r\n          ${me.#renderInput()}\r\n          ${me.#renderOutput()}\r\n          ${me.#renderLabel()}\r\n       </div>\r\n       ${me.#renderInfo()}\r\n    </div>\r\n    <slot></slot>`;\r\n  }\r\n\r\n  #renderVertical() {\r\n    const me = this;\r\n    return html`\r\n    <div  dir=\"${ifDefined(me.direction)}\" class=\"row ${classMap(me.renderClass())}\">\r\n      <div class=\"col-12 text-md-start ${me.cellLabel}\">\r\n          ${me.#renderLabel()}\r\n      </div>\r\n       <div class=\"${me.#cssCheck} ${me.#cellField}\">\r\n          ${me.#renderInput()}\r\n          ${me.#renderOutput()}\r\n       </div>\r\n       ${me.#renderInfo()}   \r\n    </div>      \r\n    <slot></slot>`;\r\n  }\r\n\r\n  #renderHorizontal() {\r\n    const me = this;\r\n    return html`\r\n    <div  dir=\"${ifDefined(me.direction)}\" class=\"row form-group ${classMap(me.renderClass())}\">    \r\n       <slot name=\"header\"></slot>\r\n       ${me.#renderLabelWrap()}\r\n       ${me.#renderField()}\r\n       ${me.#renderInfo()}\r\n       <slot name=\"footer\"></slot>\r\n    </div>\r\n    <slot></slot>`;\r\n  }\r\n\r\n  #renderLabel() {\r\n    const me = this;\r\n    return html`<label class=\"${me.#cssLabel} ${me.cssLabel} user-select-none\" for=\"${me.name}\">${me.translate(me.label)}</label>`;\r\n  }\r\n\r\n  #renderLabelWrap() {\r\n    const me = this;\r\n    return html`<div class=\" text-md-end ${me.cellLabel}\">${me.#renderLabel()}</div>`;\r\n  }\r\n\r\n  #renderIcon() {\r\n    const me = this;\r\n    return me.#isIcon ? html`<gs-icon size=\"5\" css=\"${GSFormGroupElement.CSS_ICON}}\" name=\"${me.icon}\"></gs-icon>` : html`<slot name=\"icon\"></slot>`;\r\n  }\r\n\r\n  #renderTooltip() {\r\n    const me = this;\r\n    const tgt = me.#isIcon ? '@parent' : `[name='${me.name}']`;\r\n    return me.description ? html`<gs-tooltip local language=\"${ifDefined(me.language)}\" placement=\"${me.placement}\" title=\"${me.description}\" target=${ifDefined(tgt)}></gs-tooltip>` : '';\r\n  }\r\n\r\n  #renderInfo() {\r\n    const me = this;\r\n    const tooltip = me.#renderTooltip();\r\n    if (tooltip && me.#isIcon) return html`\r\n    <div class=\"col-auto\">\r\n       ${tooltip}\r\n       ${me.#renderIcon()}\r\n    </div>`;\r\n    return tooltip;\r\n  }\r\n\r\n  #renderField() {\r\n    const me = this;\r\n    return html`\r\n    <div class=\"${me.#cssCheck} ${me.#cellField}\">\r\n       <slot name=\"body\">${me.#renderInput()}${me.#renderOutput()}</slot>\r\n    </div>`;\r\n  }\r\n\r\n  #renderOutput() {\r\n    const me = this;\r\n    if (!me.isRange) return \"\";\r\n    return html`<span ${ref(me.#ouptutRef)} class=\"position-absolute px-1\">${me.value}</span>`;\r\n  }\r\n\r\n  #renderInput() {\r\n\r\n    const me = this;\r\n\r\n    const idattr = me.autoid ? me.name : undefined;\r\n    const val = me.isFieldset ? me.values.split(',') : me.value;\r\n\r\n    if (Array.isArray(val)) {\r\n      const wrap = me.dataset.radioLayout === 'vertical';\r\n      return val.map((it, i) => { return { v: it, id: `${me.name}_${i}` } })\r\n        .map((o, i) => me.#fieldSet(me.name + i, o.v, me.#inputHTML(o.id, me.name, o.v), wrap));\r\n    }\r\n\r\n    if (me.selectable) return me.#selectHTML(idattr, me.name, me.value);\r\n\r\n    if (me.#isTextArea) return me.#textArea(idattr, me.name, me.value);\r\n\r\n    return me.#inputHTML(idattr, me.name, me.value);\r\n  }\r\n\r\n  #fieldSet(id, val, fld, vertical = false) {\r\n    const me = this;\r\n    return vertical ?\r\n      html`<div class=\"me-3\">${fld}<label for=\"${id}\" class=\"ms-1\">${me.translate(val)}</label></div>`\r\n      :\r\n      html`<span class=\"me-3\">${fld}<label for=\"${id}\" class=\"ms-1\">${me.translate(val)}</label></span>`;\r\n  }\r\n\r\n  #initStyle() {\r\n    const me = this;\r\n    const style = {\r\n      transform: me.reverse && me.isRange ? 'rotateY(180deg)' : ''\r\n    }\r\n    me.dynamicStyle(me.#styleID, style);\r\n  }\r\n\r\n  #renderOption(el) {\r\n    const title = el.name || el.innerText || el.value;\r\n    return html`<option ${dataset(el, false)} value=\"${el.value}\" ?selected=\"${el.selected}\">${title}</option>`;\r\n  }\r\n\r\n  #renderOptions() {\r\n    const me = this;\r\n    return me.#options.map(el => me.#renderOption(el));\r\n    /*\r\n    return repeat(me.#options, (el) => el.value, (el, index) => {\r\n      return html`<option value=\"${el.value}\">${el.name || el.innerText || el.value}</option>`\r\n    });\r\n    */\r\n  }\r\n\r\n  #selectHTML(id, name, value) {\r\n    const me = this;\r\n    me.#initStyle();\r\n\r\n    // not used \r\n    // id=${ifDefined(id)} \r\n    return html`<select ais=\"gs-ext-select\"\r\n            ${ref(me.#inputRef)}\r\n            ${dataset(me, false)}\r\n\r\n            @change=\"${me.#onChange.bind(me)}\"\r\n            @blur=\"${me.#onBlur.bind(me)}\"\r\n        \r\n            name=\"${name}\"             \r\n            form=\"${ifDefined(me.form)}\"\r\n            class=\"${me.#cssField} ${me.cssField} ${me.#styleID}\" \r\n\r\n            ?autofocus=\"${me.autofocus || me.form?.autofocus}\"\r\n            ?autocopy=\"${me.autocopy || me.form?.autocopy}\"\r\n            ?autoselect=\"${me.autoselect || me.form?.autoselect}\"\r\n            ?autovalidate=\"${me.autovalidate || me.form?.autovalidate}\"\r\n            ?autoreport=\"${me.autoreport || me.form?.autoreport}\"\r\n\r\n            ?readonly=\"${me.readonly}\"\r\n            ?required=\"${me.required}\"\r\n            ?disabled=\"${me.disabled}\">\r\n              ${me.#renderOptions()}\r\n            </select>`;\r\n  }\r\n\r\n  get #isTextArea() {\r\n    const me = this;\r\n    return (me.rows > 0 || me.cols > 0) && me.type === 'text';\r\n  }\r\n\r\n  get #listHTML() {\r\n    const me = this;\r\n    let list = '';\r\n    if (me.list) {\r\n      const root = me.parentComponent || me.parentElement;\r\n      const el = GSDOM.query(root, `datalist[id=\"${me.list}\"]`, true, true);\r\n      if (el) list = html`${unsafeHTML(el.outerHTML)}`;\r\n    }\r\n    return list;\r\n  }\r\n\r\n  get #isBlock() {\r\n    return this.block || this.formComponent?.block || false;\r\n  }\r\n\r\n  get #isBeep() {\r\n    return this.beep || this.formComponent?.beep || false;\r\n  }\r\n\r\n  #timeout() {\r\n    return this.timeout || this.formComponent?.timeout || 0;\r\n  }\r\n\r\n  #textArea(id, name, value) {\r\n    const me = this;\r\n    me.#initStyle();\r\n    const placeholder = me.placeholder ? me.translate(me.placeholder, false) : null;\r\n    const title = me.title ? me.translate(me.title, false) : null;\r\n\r\n    // not used\r\n    // id=${ifDefined(id)}\r\n\r\n    return html`<textarea is=\"gs-ext-textarea\" \r\n            ${ref(me.#inputRef)}\r\n            ${dataset(me, false)}\r\n            @input=\"${me.#onInput.bind(me)}\"\r\n            @change=\"${me.#onChange.bind(me)}\"\r\n            @blur=\"${me.#onBlur.bind(me)}\"\r\n            @invalid=\"${me.#onInvalid.bind(me)}\"\r\n            lang=\"${ifDefined(me.lang)}\"\r\n            minlength=\"${ifDefined(me.minLength)}\"\r\n            maxlength=\"${ifDefined(me.maxLength)}\"\r\n            cols=\"${me.cols}\"\r\n            rows=\"${me.rows}\"\r\n\r\n            ?block=\"${me.#isBlock}\"\r\n            ?beep=\"${me.#isBeep}\"\r\n            timeout=\"${me.#timeout()}\"\r\n\r\n            spellcheck=\"${ifDefined(me.spellcheck)}\" \r\n            wrap=\"${ifDefined(me.wrap)}\" \r\n            form=\"${ifDefined(me.form)}\" \r\n            name=\"${name}\" \r\n            value=\"${ifDefined(value)}\"\r\n            placeholder=\"${ifDefined(placeholder)}\"\r\n            title=\"${ifDefined(title)}\"\r\n    \r\n            class=\"${me.#cssField} ${me.cssField} ${me.#styleID}\" \r\n\r\n            autocomplete=\"${ifDefined(me.autocomplete)}\"\r\n            autocorrect=\"${ifDefined(me.autocorrect)}\"\r\n            autocapitalize=\"${ifDefined(me.autocapitalize)}\"\r\n\r\n            ?autofocus=\"${me.autofocus || me.form?.autofocus}\"\r\n            ?autocopy=\"${me.autocopy || me.form?.autocopy}\"\r\n            ?autoselect=\"${me.autoselect || me.form?.autoselect}\"\r\n            ?autovalidate=\"${me.autovalidate || me.form?.autovalidate}\"\r\n            ?autoreport=\"${me.autoreport || me.form?.autoreport}\"\r\n\r\n            ?readonly=\"${me.readonly}\"\r\n            ?required=\"${me.required}\"\r\n            ?disabled=\"${me.disabled}\"      \r\n      ></textarea>`;\r\n  }\r\n\r\n  #inputHTML(id, name, value) {\r\n    const me = this;\r\n    const type = me.isSwitch ? 'checkbox' : me.type;\r\n    let title = me.isRange ? me.defaultValue : me.title;\r\n    title = title ? me.translate(me.title, false) : title;\r\n\r\n    const placeholder = me.placeholder ? me.translate(me.placeholder, false) : null;\r\n    const description = me.description ? me.translate(me.description, false) : null;\r\n\r\n    me.#initStyle();\r\n\r\n    // this does not work, \"is\" must be set explicitly, or it will not initialize element properly\r\n    // is=\"${ifDefined(me.isDate ? '' : 'gs-ext-input')}\"\r\n\r\n    // not used\r\n    // id=${ifDefined(id)} \r\n\r\n    return html`<input is=\"gs-ext-input\"\r\n            ${ref(me.#inputRef)}\r\n            ${dataset(me, false)}\r\n\r\n            @input=\"${me.#onInput.bind(me)}\"\r\n            @change=\"${me.#onChange.bind(me)}\"\r\n            @blur=\"${me.#onBlur.bind(me)}\"\r\n            @invalid=\"${me.#onInvalid.bind(me)}\"\r\n        \r\n            name=\"${name}\" \r\n            type=\"${type}\" \r\n            form=\"${ifDefined(me.form)}\"\r\n            value=\"${ifDefined(value)}\"\r\n            title=\"${ifDefined(title)}\"\r\n\r\n\r\n            ?block=\"${me.#isBlock}\"\r\n            ?beep=\"${me.#isBeep}\"\r\n            timeout=\"${me.#timeout()}\"\r\n\r\n            class=\"${me.#cssField} ${me.cssField} ${me.mask ? 'font-monospace' : ''} ${me.#styleID}\" \r\n\r\n            placeholder=\"${ifDefined(placeholder)}\"\r\n            description=\"${ifDefined(description)}\"\r\n\r\n            .multipattern=\"${ifDefined(me.#patterns)}\"\r\n            mask=\"${ifDefined(me.mask)}\"\r\n            pattern=\"${ifDefined(me.pattern)}\"\r\n            list=\"${ifDefined(me.list)}\"\r\n            accept=\"${ifDefined(me.accept)}\"\r\n             \r\n            step=\"${ifDefined(me.step)}\"\r\n            min=\"${ifDefined(me.min)}\"\r\n            max=\"${ifDefined(me.max)}\"\r\n            lang=\"${ifDefined(me.lang)}\"\r\n\r\n            minlength=\"${ifDefined(me.minLength)}\"\r\n            maxlength=\"${ifDefined(me.maxLength)}\"\r\n\r\n            autocomplete=\"${ifDefined(me.autocomplete)}\"\r\n            autocorrect=\"${ifDefined(me.autocorrect)}\"\r\n            autocapitalize=\"${ifDefined(me.autocapitalize)}\"\r\n\r\n            ?autofocus=\"${me.autofocus || me.form?.autofocus}\"\r\n            ?autocopy=\"${me.autocopy || me.form?.autocopy}\"\r\n            ?autoselect=\"${me.autoselect || me.form?.autoselect}\"\r\n            ?autovalidate=\"${me.autovalidate || me.form?.autovalidate}\"\r\n            ?autoreport=\"${me.autoreport || me.form?.autoreport}\"            \r\n\r\n            ?multiple=\"${me.multiple}\"\r\n            ?checked=\"${me.checked}\"\r\n            ?readonly=\"${me.readonly}\"\r\n            ?required=\"${me.required}\"\r\n            ?disabled=\"${me.disabled}\"\r\n            ?reveal=\"${me.reveal}\"\r\n            >${me.#listHTML}`;\r\n  }\r\n\r\n  get #cssField() {\r\n    const me = this;\r\n    if (me.selectable) return 'form-select ms-0';\r\n    if (me.isCheckable) return 'form-check-input ms-0';\r\n    if (me.isRange) return 'form-range';\r\n    return 'form-control';\r\n  }\r\n\r\n  get #cssLabel() {\r\n    const me = this;\r\n    if (me.isCheckable) return 'form-check-label';\r\n    if (me.isFloating) return 'ms-2';\r\n    return me.isVertical ? 'form-label' : '';\r\n  }\r\n\r\n  get #cssCheck() {\r\n    const me = this;\r\n    if (me.isCheckable) {\r\n      //return me.#isSwitch ? 'form-check form-switch ps-3 fs-5' : 'form-check';\r\n      if (me.isSwitch) return 'form-check form-switch ps-3 fs-5';\r\n      return me.isFieldset ? '' : 'form-check';\r\n    }\r\n    return '';\r\n  }\r\n\r\n  get #cellField() {\r\n    const me = this;\r\n    const val = (me.isHorizontal) ? '6' : '11';\r\n    return me.cellField || `col-md-${val} col-sm-${val} col-xs-11`;\r\n  }\r\n\r\n  get #isIcon() {\r\n    return GSUtil.isStringNonEmpty(this.icon);\r\n  }\r\n\r\n  #onInput(e) {\r\n    if (!e.composed) this.emit(e.type, e);\r\n  }\r\n\r\n  #onBlur(e) {\r\n    if (!e.composed) this.emit(e.type, e, true, true);\r\n  }\r\n\r\n  #onChange(e) {\r\n    const me = this;\r\n    const field = me.field;\r\n    me.#internals?.setFormValue(field.value);\r\n    me.#internals?.setValidity(field.validity, field.validationMessage, field);\r\n    if (!e.composed) me.emit(e.type, e, true, true);\r\n    me.requestUpdate();\r\n  }\r\n\r\n  #onInvalid(e) {\r\n    if (!e.composed) this.emit('invalid', e, true, true);\r\n  }\r\n\r\n  #validateAllowed() {\r\n    const me = this;\r\n    const slots = ['header', 'body', 'footer'];\r\n    let list = Array.from(me.children).filter(el => el.slot && !slots.includes(el.slot));\r\n    if (list.length > 0) throw new Error(`Custom element injection must contain slot=\"header|body|footer\" attribute! Element: ${me.tagName}, ID: ${me.id}`);\r\n    list = Array.from(me.children).filter(el => !el.slot);\r\n    const tagList = ['GS-ITEM', 'DATALIST'];\r\n    const allowed = GSDOM.isAllowed(list, tagList);\r\n    if (!allowed) throw new Error(GSDOM.toValidationError(me, tagList));\r\n  }\r\n\r\n  translate(value = '', sanitize) {\r\n    value = super.translate(value);\r\n    return sanitize ? GSUtil.sanitize(value) : value;\r\n  }\r\n\r\n  reset() {\r\n    this.field?.reset?.();\r\n  }\r\n\r\n  get isFloating() {\r\n    return this.layout === 'floating';\r\n  }\r\n\r\n  get isHorizontal() {\r\n    return this.layout === 'horizontal';\r\n  }\r\n\r\n  get isVertical() {\r\n    return this.layout === 'vertical';\r\n  }\r\n\r\n  get isFieldset() {\r\n    const me = this;\r\n    return me.type === 'radio' && me.values?.includes(',');\r\n  }\r\n\r\n  get isCheckable() {\r\n    const me = this;\r\n    return me.isCheck || me.isRadio || me.isSwitch;\r\n  }\r\n\r\n  get isChecked() {\r\n    return this.field?.checked;\r\n  }\r\n\r\n  get isCheck() {\r\n    return this.type === 'checkbox';\r\n  }\r\n\r\n  get isRadio() {\r\n    return this.type === 'radio';\r\n  }\r\n\r\n  get isSwitch() {\r\n    return this.type === 'switch';\r\n  }\r\n\r\n  get isNumber() {\r\n    return this.type === 'number';\r\n  }\r\n\r\n  get isRange() {\r\n    return this.type === 'range';\r\n  }\r\n\r\n  get isText() {\r\n    return this.type === 'text';\r\n  }\r\n\r\n  get isPassword() {\r\n    return this.type === 'passsword';\r\n  }\r\n\r\n  get isEmail() {\r\n    return this.type === 'email';\r\n  }\r\n\r\n  get isURL() {\r\n    return this.type === 'url';\r\n  }\r\n\r\n  get isFile() {\r\n    return this.type === 'file';\r\n  }\r\n\r\n  get isDate() {\r\n    return this.type === 'date';\r\n  }\r\n\r\n  get field() {\r\n    return this.#inputRef.value;\r\n  }\r\n\r\n  get value() {\r\n    const me = this;\r\n    return me.field ? me.field?.value : me.defaultValue;\r\n  }\r\n\r\n  set value(val) {\r\n    const me = this;\r\n    if (me.field) me.field.value = val;\r\n  }\r\n\r\n  get defaultValue() {\r\n    const me = this;\r\n    return me.field ? me.field.defaultValue : GSAttr.get(me, 'value', '');\r\n  }\r\n\r\n  set defaultValue(val) {\r\n    const me = this;\r\n    if (me.field) me.field.defaultValue = val;\r\n    GSAttr.set(me, 'value', val);\r\n\r\n  }\r\n\r\n  get validity() {\r\n    return this.#internals.validity;\r\n  }\r\n\r\n  get formComponent() {\r\n    return GSDOM.closest(this, 'gs-form');\r\n  }\r\n\r\n  static {\r\n    this.define('gs-form-group');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, html, render, ifDefined, ref, repeat } from '../lib.mjs';\r\nimport { GSLog } from '../base/GSLog.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSFormGroupElement } from './FormGroup.mjs';\r\n\r\n// TODO: Make generic JSON to template generator, \r\n// then create string template and apply it to the lit html function.\r\n// Use all properties exstractor from super components and use type definition for bool proeprties.\r\n// Use xtype(#tagName) to define component type and use it to create component instance.\r\n\r\n/**\r\n * Component is responsible for auto-building gs-form and gs-form-group elements\r\n * from either JSON data or GS-ITEM elements.\r\n */\r\nexport class GSFormPanelElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    data: { type: Array },\r\n  }\r\n\r\n  #formRef = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    this.data = this.#proxify;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const data = me.data || {};\r\n    // const tpl = me.#renderContent(); \r\n    const tpl = me.#renderTemplate();\r\n    return html`<gs-form ${ref(me.#formRef)}\r\n\r\n      storage=\"${ifDefined(data.storage)}\" \r\n      disabled=${ifDefined(data.disabled)}.\r\n      data=\"${ifDefined(data.data)}\"\r\n      \r\n      name=\"${ifDefined(data.name)}\"\r\n      rel=\"${ifDefined(data.rel)}\"\r\n      acceptCharset=\"${ifDefined(data.acceptCharset)}\"\r\n      autocapitalize=\"${ifDefined(data.autocapitalize)}\"\r\n      autocomplete=\"${ifDefined(data.autocomplete)}\"\r\n\r\n      action=\"${ifDefined(data.action)}\"\r\n      enctype=\"${ifDefined(data.enctype)}\"\r\n      method=\"${ifDefined(data.method)}\"\r\n      novalidate=\"${ifDefined(data.novalidate)}\"\r\n      target=\"${ifDefined(data.target)}\"\r\n\r\n      block=\"${ifDefined(data.block)}\"\r\n      beep=\"${ifDefined(data.beep)}\"\r\n      timeout=\"${ifDefined(data.timeout)}\"\r\n\r\n      flat=\"${ifDefined(data.flat)}\"\r\n      rtl=\"${ifDefined(data.rtl)}\"\r\n      hide=\"${ifDefined(data.hide)}\"\r\n      padding=\"${ifDefined(data.padding)}\"\r\n      margin=\"${ifDefined(data.margin)}\"\r\n      rounded=\"${ifDefined(data.rounded)}\"\r\n      bordered=\"${ifDefined(data.bordered)}\"\r\n      shadow=\"${ifDefined(data.shadow)}\"\r\n      keep=\"${ifDefined(data.keep)}\"\r\n      css=\"${ifDefined(data.css)}\"\r\n      theme=\"${ifDefined(data.theme)}\"\r\n      os=\"${ifDefined(data.os)}\"\r\n      browser=\"${ifDefined(data.browser)}\"\r\n      language=\"${ifDefined(data.language)}\"\r\n      environment=\"${ifDefined(data.environment)}\"\r\n      orientation=\"${ifDefined(data.orientation)}\"\r\n      protocol=\"${ifDefined(data.protocol)}\"\r\n      template=\"${ifDefined(data.template)}\"      \r\n      >${tpl}</gs-form>`;\r\n    //${templateContent(tpl)}\r\n    //${unsafeHTML(tpl.outerHTML)}\r\n  }\r\n\r\n  #renderTemplate() {\r\n    const tpl = document.createElement('template');\r\n    const content = this.#renderContent();\r\n    render(content, tpl.content);\r\n    return tpl;\r\n  }\r\n\r\n  #renderContent() {\r\n    const me = this;\r\n    const items = me.data?.items || [];\r\n    return html`${repeat(items, (item) => me.#renderFormGroup(me.data, item))}`;\r\n  }\r\n\r\n  // to generate into a template, all properties must be attributes, \r\n  // as properties are not transferable outside of template\r\n  #renderFormGroup(definition, item) {\r\n    return html`<gs-form-group \r\n      icon=\"${ifDefined(item.icon)}\"\r\n      layout=\"${ifDefined(item.layout)}\"\r\n      placement=\"${ifDefined(item.placement)}\"\r\n\r\n      label=\"${ifDefined(item.label)}\"\r\n      description=\"${ifDefined(item.description)}\"\r\n      placeholder=\"${ifDefined(item.placeholder)}\"\r\n      \r\n      pattern=\"${ifDefined(item.pattern)}\"\r\n      mask=\"${ifDefined(item.mask)}\"\r\n\r\n      form=\"${ifDefined(item.form)}\"\r\n      formaction=\"${ifDefined(item.formaction)}\"\r\n      formenctype=\"${ifDefined(item.formenctype)}\"\r\n      formmethod=\"${ifDefined(item.formmethod)}\"\r\n      formnovalidate=\"${ifDefined(item.formnovalidate)}\"\r\n      formtarget=\"${ifDefined(item.formtarget)}\"\r\n      wrap=\"${ifDefined(item.wrap)}\"\r\n      spellcheck=\"${ifDefined(item.spellcheck)}\"\r\n\r\n      type=\"${ifDefined(item.type)}\"\r\n      name=\"${ifDefined(item.name)}\"\r\n      list=\"${ifDefined(item.list)}\"\r\n      accept=\"${ifDefined(item.accept)}\"\r\n      value=\"${ifDefined(item.value)}\"\r\n      \r\n      lang=\"${ifDefined(item.lang)}\"\r\n      title=\"${ifDefined(item.title)}\"\r\n      cols=\"${ifDefined(item.cols)}\"\r\n      rows=\"${ifDefined(item.rows)}\"\r\n      step=\"${ifDefined(item.step)}\"\r\n      min=\"${ifDefined(item.min)}\"\r\n      max=\"${ifDefined(item.max)}\"\r\n      maxlength=\"${ifDefined(item.maxlength)}\"\r\n      minlength=\"${ifDefined(item.minlength)}\"\r\n\r\n      reverse=\"${ifDefined(item.reverse)}\"\r\n      selectable=\"${ifDefined(item.selectable)}\"\r\n\r\n      autoid=\"${ifDefined(item.autoid)}\"\r\n      autocopy=\"${ifDefined(item.autocopy)}\"\r\n      autoselect=\"${ifDefined(item.autoselect)}\"\r\n\r\n      autocapitalize=\"${ifDefined(item.autocapitalize)}\"\r\n      autocorrect=\"${ifDefined(item.autocorrect)}\"\r\n      autocomplete=\"${ifDefined(item.autocomplete)}\"\r\n\r\n      autofocus=\"${ifDefined(item.autofocus)}\"\r\n      autoselect=\"${ifDefined(item.autoselect)}\"\r\n\r\n      disabled=\"${ifDefined(item.disabled)}\"\r\n      checked=\"${ifDefined(item.checked)}\"\r\n      multiple=\"${ifDefined(item.multiple)}\"\r\n      reveal=\"${ifDefined(item.reveal)}\"\r\n      readonly=\"${ifDefined(item.readonly)}\"\r\n      required=\"${ifDefined(item.required)}\"\r\n\r\n      invalidMessage=\"${ifDefined(item.invalidMessage)}\"  \r\n      \r\n      block=\"${ifDefined(item.block || definition.block)}\"\r\n      beep=\"${ifDefined(item.beep || definition.beep)}\"\r\n      timeout=\"${ifDefined(item.timeout || definition.timeout)}\"\r\n\r\n      flat=\"${ifDefined(item.flat)}\"\r\n      rtl=\"${ifDefined(item.rtl)}\"\r\n      hide=\"${ifDefined(item.hide)}\"\r\n      padding=\"${ifDefined(item.padding)}\"\r\n      margin=\"${ifDefined(item.margin)}\"\r\n      rounded=\"${ifDefined(item.rounded)}\"\r\n      bordered=\"${ifDefined(item.bordered)}\"\r\n      shadow=\"${ifDefined(item.shadow)}\"\r\n      keep=\"${ifDefined(item.keep)}\"\r\n      css=\"${ifDefined(item.css)}\"\r\n      theme=\"${ifDefined(item.theme)}\"\r\n      os=\"${ifDefined(item.os)}\"\r\n      browser=\"${ifDefined(item.browser)}\"\r\n      language=\"${ifDefined(item.language || definition.language)}\"\r\n      environment=\"${ifDefined(item.environment)}\"\r\n      orientation=\"${ifDefined(item.orientation)}\"\r\n      protocol=\"${ifDefined(item.protocol)}\"\r\n      template=\"${ifDefined(item.template)}\">\r\n      </gs-form-group>`;\r\n  }\r\n\r\n  get form() {\r\n    return this.#formRef.value;\r\n  }\r\n\r\n  onDataRead(data) {\r\n    this.data = data;\r\n  }\r\n\r\n  onDataError(e) {\r\n    GSLog.error(this, e);\r\n  }\r\n\r\n  get #proxify() {\r\n    return GSItem.collect(this).map(el => GSAttr.proxify(el, GSFormGroupElement.properties));\r\n  }\r\n\r\n  static {\r\n    this.define('gs-form-panel');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSGroupElement class\r\n * @module components/GSGroupElement\r\n */\r\n\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSAttributeHandler } from '../base/GSAttributeHandler.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { ElementNavigationController } from '../controllers/ElementNavigationController.mjs';\r\nimport { GroupController } from '../controllers/GroupController.mjs';\r\nimport { classMap, createRef, html, render, ifDefined, ref } from '../lib.mjs';\r\n\r\n/**\r\n * Renderer for grouped elements such as Buttons, Navs, Tabs and lists.\r\n * Components handles grouped elements navigation, selection and focus.\r\n * \r\n * @class\r\n * @extends { GSElement }\r\n */\r\nexport class GSGroupElement extends GSElement {\r\n\r\n  static properties = {\r\n    // multiple lists with single select across \r\n    group : {},\r\n    storage: {},    \r\n    circular: { type: Boolean },\r\n    multiple: { type: Boolean },\r\n    data: { type: Array },\r\n  }\r\n\r\n  #elRef = createRef();\r\n  #controller;\r\n  #controllerGroup;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.data = me.initData();\r\n    me.#controller = new ElementNavigationController(me);\r\n    me.#controllerGroup = new GroupController(me);\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    const me = this;\r\n    // allow single setting at the container component to apply to the child\r\n    Array.from(me.children).forEach(it => {\r\n      GSAttributeHandler.clone(me, it, false);\r\n    });\r\n  }  \r\n\r\n\r\n  #prerender() {\r\n    const me = this;\r\n    me.queryAll('[generated]').forEach(el => el.remove());\r\n    if (me.data.length > 0) {\r\n      const items = me.renderItems();\r\n      const tpl = document.createElement('template');\r\n      render(items, tpl);\r\n      Array.of(...tpl.children).forEach(el => GSDOM.appendChild(me, el));\r\n    }\r\n  }\r\n  \r\n  firstUpdated(changed) {\r\n    const me = this;\r\n    me.#controller.init();\r\n    me.#controller.attach(me.#elRef.value);\r\n    super.firstUpdated(changed);\r\n    //me.#prerender();\r\n  }  \r\n\r\n  willUpdate(changed) {\r\n    const me = this;\r\n    if (changed.has('data')) {      \r\n      me.#prerender();\r\n    }\r\n    super.willUpdate(changed);\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div ${ref(me.#elRef)} \r\n      dir=\"${ifDefined(me.direction)}\"\r\n      class=\"${classMap(me.renderClass())}\">\r\n      ${me.renderWrappedUI()}\r\n      </div>`;\r\n  }\r\n\r\n  renderWrappedUI(name) {\r\n    const me = this;\r\n    return html`<div \r\n      class=\"${classMap(me.renderWrappedClass())}\">\r\n      <slot name=\"${ifDefined(name)}\"></slot>\r\n      </div>`;\r\n  }\r\n\r\n  renderWrappedClass() {\r\n    return {};\r\n  }\r\n\r\n  renderItems() {\r\n    return '';\r\n  }\r\n\r\n  initData() {\r\n    return this.settings(GSItem);\r\n  }\r\n\r\n  previous() {\r\n    this.#controller.previous();\r\n  }\r\n\r\n  next() {\r\n    this.#controller.next();\r\n  }\r\n\r\n  /**\r\n   * Reset focus / selection\r\n   */\r\n  reset() {\r\n    this.#controller.reset();\r\n  }\r\n\r\n  /**\r\n   * Element navigation filter where we can select if focused element is navigable\r\n   * @param {*} el \r\n   * @returns \r\n   */\r\n  isNavigable(el) {\r\n    return el?.tagName === this.childTagName;\r\n  }\r\n\r\n  onDataRead(data) {\r\n    this.data = data;\r\n  }\r\n\r\n  onBusEvent(e) {\r\n    let owner, item;  \r\n    ({owner, item} = e.detail);\r\n    if (owner != this) {\r\n      if (!item?.disabled || owner?.selectable) {\r\n        this.reset();\r\n      }\r\n    }\r\n  }\r\n  \r\n  onSelected(el) {\r\n    this.#controllerGroup.notify(el);\r\n  }\r\n\r\n  get focused() {\r\n    return this.#controller.focused;\r\n  }\r\n\r\n  get selected() {\r\n    return this.#controller.selected;\r\n  }\r\n\r\n  get childTagName() {\r\n    return '';\r\n  }\r\n    \r\n  get items() {\r\n    const me = this;\r\n    return me.queryAll(me.childTagName, true);\r\n  }\r\n\r\n  get generated() {\r\n    return this.items.filter(el => el.hasAttribute('generated'));\r\n  }\r\n\r\n  get active() {\r\n    const me = this;\r\n    const list = me.items.filter(el => el.hasAttribute('active'));\r\n    return me.multiple ? list : list.pop();\r\n  }\r\n\r\n  childByName(name = '', shadow = false) {\r\n    return this.query(`${this.childTagName}[name=\"${name}\"]`, shadow, true);\r\n  }\r\n\r\n  settings(el) {\r\n    const tagName = customElements.getName(el)?.toUpperCase() || 'GS-ITEM';\r\n    const cfg = GSElement.allProperties(el);\r\n    const items = Array.from(this.children).filter(e => e.tagName === tagName ).map(el => GSAttr.proxify(el, cfg));\r\n    const active = items.filter(el => el.active);\r\n    active.forEach((el, idx) => el.active = idx === 0);\r\n    return items;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-group');\r\n  }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, css, html, ifDefined, createRef, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { notEmpty, numGT0 } from '../properties/index.mjs';\r\nimport { color } from '../properties/color.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\nexport class GSIconElement extends GSElement {\r\n\r\n  static styles = css`\r\n    :host {\r\n      --gs-icon-super-color : cornflowerblue;\r\n      --gs-icon-content : '';\r\n    }\r\n    i::after {\r\n      top: -8px;\r\n      font-size: 0.7em;\r\n      position: relative;\r\n      content: var(--gs-icon-content);\r\n      content: attr(data-super);\r\n      color: var(--gs-icon-super-color);\r\n    }`;\r\n\r\n  static properties = {\r\n    name: { reflect: true, hasChanged: notEmpty },\r\n    size: { reflect: true, type: Number, hasChanged: numGT0 },\r\n    color: { reflect: true, ...color },\r\n    superColor: { attribute : 'super-color'},\r\n    super: { reflect: true },\r\n    clickCss: { attribute : 'click-css'},\r\n    hoverCss: { attribute : 'hover-css'},\r\n    _clicked: { attribute:false},\r\n    _hovered: { attribute:false},\r\n  }\r\n\r\n  #ref = createRef();\r\n  \r\n  constructor() {\r\n    super();\r\n    //this.flat = true;\r\n  }\r\n\r\n  /*\r\n  firstUpdated() {\r\n    super.firstUpdated();\r\n    this.#embdeded = GSDOM.matches(this.parentComponent, '[icon]');\r\n  }\r\n  */\r\n\r\n  updated(changed) {\r\n    if (changed.has('_clicked')) {\r\n      if (this._clicked) this.#postAnimate();\r\n    } \r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    me.setCSSProperty(':host', '--gs-icon-super-color', me.superColor);\r\n    return html`<i  ${ref(me.#ref)}\r\n       class=\"bi ${classMap(me.renderClass())}\"\r\n       data-super=\"${ifDefined(me.super)}\"\r\n       @click=\"${me.animate}\"\r\n       @mouseover=\"${me.#onMouseOver}\"\r\n       @mouseout=\"${me.#onMouseOut}\"></i>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      [`text-${me.color}`]: me.color,\r\n      [`bi-${me.name}`]: me.name,\r\n      'fs': me.size > 0,\r\n      [`fs-${me.size}`]: me.size > 0,\r\n      [me.clickCss]: me._clicked,\r\n      [me.hoverCss]: me._hovered,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  async #postAnimate() {\r\n    const me = this;\r\n    const delay = GSUtil.asNum(me.dataset.delay, 1);\r\n    if (delay > 0) {\r\n      await GSUtil.timeout(delay * 1000);\r\n      me._clicked = false;\r\n    }    \r\n  }\r\n\r\n  #onMouseOver(e) {\r\n    this.hover(true);\r\n  }\r\n\r\n  #onMouseOut(e) {\r\n    this.hover(false);\r\n  }\r\n\r\n  animate() {\r\n    const me = this;\r\n    me._hovered = false;\r\n    me._clicked = true;\r\n  }\r\n\r\n  hover(sts = false) {\r\n    const me = this;\r\n    if (sts) {\r\n      me._clicked = false;\r\n    }\r\n    me._hovered = sts;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-icon');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { css, html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { numGT0 } from '../properties/index.mjs';\r\n\r\nexport class GSIndentElement extends GSElement {\r\n\r\n  static styles = css`.indent {\r\n      --gs-indent : 10px;\r\n      margin-left: var(--gs-indent);\r\n      margin-right: var(--gs-indent);\r\n    }`;\r\n\r\n  static properties = {\r\n    flat: { type: Boolean },\r\n    size: { type: Number, hasChanged: numGT0 },\r\n    multiplier: { type: Number, hasChanged: numGT0 }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.size = 1;\r\n    me.multiplier = 10;\r\n  }\r\n\r\n  renderUI() {\r\n    const size = this.size * this.multiplier;\r\n    return html`<span class=\"indent\" style=\"--gs-indent: ${size}px;\"></span>`;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-indent');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, html, ifDefined, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { notEmpty, numGE0 } from '../properties/index.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\nconst numdef = { reflect: true, type: Number, hasChanged: numGE0 };\r\n\r\nexport class GSImageElement extends GSElement {\r\n\r\n  static properties = {\r\n    src: { hasChanged: notEmpty },\r\n    width: numdef,\r\n    height: numdef,\r\n    opacity: numdef,\r\n    invert: numdef,\r\n    grayscale: numdef,\r\n    brightness: numdef,\r\n    blur: numdef,\r\n    contrast: numdef,\r\n    saturate: numdef,\r\n    hue: numdef,\r\n    sepia: numdef,\r\n\r\n    alt: {},\r\n    loading: {}\r\n\r\n  }\r\n\r\n  #imageRef = createRef();\r\n  #styleID = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    this.dynamicStyle(this.#styleID);\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    this.#update();\r\n    return this.src;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<img ${ref(me.#imageRef)} \r\n            @load=\"${me.#onLoad}\"\r\n            src=\"${me.src}\" \r\n            alt=\"${me.alt}\" \r\n            loading=\"${ifDefined(me.loading)}\" \r\n            class=\"${me.#styleID}\" \r\n            data-gs-class=\"${me.#styleID}\">\r\n          </img>`;\r\n  }\r\n\r\n  get complete() {\r\n    return this.#imageRef.value?.complete || false;\r\n  }\r\n\r\n  get #dynamic() {\r\n    return this.dynamicStyle(this.#styleID).style;\r\n  }\r\n\r\n  #renderStyle() {\r\n    const me = this;\r\n    const filter = me.#buildFilter();\r\n    const css = {\r\n      width: me.width > 0 ? me.width : undefined,\r\n      height: me.height > 0 ? me.height : undefined,\r\n      filter: filter.length > 0 ? filter.join(' ') : ''\r\n    }\r\n    return css;\r\n  }\r\n\r\n  #buildFilter() {\r\n    const me = this;\r\n    const o = [];\r\n\r\n    if (me.blur > 0) o.push(`blur(${me.blur}px)`);\r\n    if (me.invert > 0) o.push(`invert(${me.invert})`);\r\n    if (me.opacity > 0) o.push(`opacity(${me.opacity})`);\r\n    if (me.contrast > 0) o.push(`contrast(${me.contrast})`);\r\n    if (me.grayscale > 0) o.push(`grayscale(${me.grayscale})`);\r\n    if (me.brightness > 0) o.push(`brightness(${me.brightness})`);\r\n\r\n    if (me.hue > 0) o.push(`hue-rotate(${me.hue}deg)`);\r\n    if (me.sepia > 0) o.push(`sepia(${me.sepia}%)`);\r\n    if (me.saturate > 0) o.push(`saturate(${me.saturate}%)`);\r\n\r\n    return o;\r\n  }\r\n\r\n  #update() {\r\n    const me = this;\r\n    const dynamic = me.#dynamic;\r\n    dynamic.filter = me.#buildFilter().join(' ').trim();\r\n    dynamic.width = me.width > 0 ? `${me.width}px` : '';\r\n    dynamic.height = me.height > 0 ? `${me.height}px` : '';\r\n  }\r\n\r\n  #onLoad(e) {\r\n    const el = e.target;\r\n    const me = this;\r\n    if (el) {\r\n      me.height = me.height || el.height;\r\n      me.width = me.width || el.width;\r\n      me.emit('loaded', { width: el.width, height: el.height, element: el }, true);\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-image');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSLayout class\r\n * @module components/GSLayoutElement\r\n */\r\n\r\nimport { classMap, html, ifDefined, templateContent } from '../lib.mjs';\r\nimport { orientation, OrientationTypes } from '../properties/orientation.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\n\r\n/**\r\n * Renderer for panel layout \r\n * @class\r\n * @extends {Component}\r\n */\r\nexport class GSLayoutElement extends GSElement {\r\n\r\n    static properties = {\r\n        type: { ...orientation }\r\n    }\r\n\r\n    // GS-ITEM attributes mapping\r\n    static options = {\r\n        id : {},\r\n        type: {},\r\n        min: { type: Number },\r\n        max: { type: Number },\r\n        size: { type: Number },\r\n        resizable: { type: Boolean },\r\n        autofit: { type: Boolean },\r\n        vPos: { attribute: 'h-pos' },\r\n        hPos: { attribute: 'v-pos' },\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;\r\n        me.autofit = true;  \r\n        me.#items(me).map((el, idx, els) => me.#dyncss(el, idx, els, 0));\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        if ( this.autofit && GSDOM.root(this) === document.body) document.body.classList.add('vh-100');\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        const list = me.#items(me).map((el, idx, els) => me.#build(el, idx, els));\r\n        return html`<div  dir=\"${ifDefined(me.direction)}\" class=\"d-flex flex-fill w-100 h-100 ${classMap(me.renderClass())}\">${list}</div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const horizontal = OrientationTypes.isHorizontal(me.type);\r\n        return {\r\n            ...super.renderClass(),\r\n            'flex-column': horizontal\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Proxify GS-ITEM elements to easily read attributes\r\n     */\r\n    #items(root) {\r\n        return GSItem.collect(root).map(el => GSAttr.proxify(el, GSLayoutElement.options));\r\n    }\r\n\r\n    #resizable(el) {\r\n        return el.size > 0 || el.min > 0 || el.max > 0 || el.resizable;\r\n    }\r\n\r\n    #dyncss(el, idx, els, lev = 0) {\r\n        const me = this;\r\n        me.#items(el.self).map((it, idx, items) => me.#dyncss(it, idx, items, lev+1));\r\n        if(me.#resizable(el)) me.dynamicStyle(`gsd-${lev}-${idx}`);\r\n    }\r\n\r\n    #build(el, idx, els, lev = 0) {\r\n\r\n        const me = this;\r\n        const type = el.self.parentElement.type || 'vertical';\r\n\r\n        const list = me.#items(el.self).map((it, idx, items) => me.#build(it, idx, items, lev+1));\r\n        \r\n        const min = el.min;\r\n        const max = el.max;\r\n        const template = el.template;\r\n        const tplEl = me.#elementTemplate(el);\r\n\r\n        const tc = `#${tplEl?.id}` !== template;\r\n\r\n        const dir = el.type || type || 'vertical';\r\n        const horizontal = OrientationTypes.isHorizontal(dir);\r\n        \r\n        const col = list.length > 0 && horizontal ? 'flex-column' : '';\r\n\r\n        const did = `gsd-${lev}-${idx}`;\r\n        const css = me.#panelCSS(el, col, did);\r\n        const style = me.#panelStyle(el, horizontal);\r\n        me.dynamicStyle(did, style);\r\n\r\n        const slot = el.name ? html`<slot name=\"${el.name}\"></slot>` : '';\r\n        const src = html`<div id=\"${ifDefined(el.id)}\" class=\"d-flex ${classMap(css)}\">\r\n            ${list}\r\n            ${templateContent(tplEl)}\r\n            ${template && tc ? html`<gs-template flat src=\"${template}\"></gs-template>` : ''}\r\n            ${slot}\r\n            </div>`;\r\n            // ${tc ? me.renderTemplate() : ''}\r\n            \r\n\r\n        if (!el.resizable) return src;\r\n\r\n        const resize = (idx === els.length - 1) ? 'end' : 'start';\r\n        const splitter = me.#splitter(min, max, type, resize);\r\n\r\n        if (idx === els.length - 1) return [splitter , src];\r\n        return [src, splitter];\r\n    }\r\n    \r\n    #elementTemplate(el) {\r\n        const tplEl = el.self.firstElementChild;\r\n        return  GSDOM.isTemplateElement(tplEl) ? tplEl : undefined;\r\n    }\r\n\r\n    #panelCSS(el, col, did) {\r\n\r\n        const resizable = this.#resizable(el);\r\n        const grow = resizable ? '' : 'flex-grow-1';\r\n\r\n        let vpos = el.vPos;\r\n        let hpos = el.hPos;\r\n\r\n        hpos = hpos ? `align-items-${hpos}` : '';\r\n        vpos = vpos ? `justify-content-${vpos}` : '';\r\n\r\n        const css = this.mapCSS(el.css, {\r\n            [did] : resizable,\r\n            [col] : col,\r\n            [grow] : grow,\r\n            [hpos] : hpos,\r\n            [vpos] : vpos\r\n        });\r\n    \r\n        return css;        \r\n    }\r\n\r\n    #panelStyle(el, horizontal) {\r\n        const min = el.size || el.min;\r\n        const max = el.max || el.size;\r\n        const style = {};\r\n        if (horizontal) {\r\n            style['min-height'] = min > 0 ? `${min}px` : undefined;\r\n            style['max-height'] = max > 0 ? `${max}px` : undefined;\r\n        } else {\r\n            style['min-width'] = min > 0 ? `${min}px` : undefined;\r\n            style['max-width'] = max > 0 ? `${max}px` : undefined;\r\n        }\r\n        return style;        \r\n    }\r\n\r\n    #splitter(min, max, dir, resize) {\r\n        return html`<gs-splitter split=\"${dir}\" resize=\"${resize}\" min=\"${min}\" max=\"${max}\"></gs-splitter>`;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-layout');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, ifDefined, html, createRef, ref } from '../lib.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color } from '../properties/index.mjs';\r\nimport { dataset } from '../directives/dataset.mjs';\r\n\r\nexport class GSLinklement extends GSElement {\r\n\r\n  static properties = {\r\n    clickCss: { attribute : 'click-css'},\r\n    hoverCss: { attribute : 'hover-css'},\r\n    autofocus: { type: Boolean },\r\n    disabled: { type: Boolean, reflect: true },\r\n    size: { type: Number },\r\n    text: { ...color },\r\n    color: { ...color },\r\n    url: {},\r\n    ping: {},\r\n    icon: {},\r\n    title: {},\r\n    tooltip: {},\r\n    target: {}\r\n  };\r\n\r\n  #refEl = createRef();\r\n  #refIco = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    this.url = '#';\r\n    // this.text = 'primary'; // do not set as default -> gs-dropdown\r\n    // this.target = '_blank'; // not used \r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    if (this.autofocus && !this.disabled) this.focus();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`\r\n      <a ${ref(me.#refEl)}  \r\n        dir=\"${ifDefined(me.direction)}\"\r\n        title=\"${ifDefined(me.translate(me.tooltip))}\" \r\n        href=\"${ifDefined(me.url)}\" \r\n        ping=\"${ifDefined(me.ping)}\" \r\n        target=\"${ifDefined(me.target)}\"\r\n        class=\"${classMap(me.renderClass())}\" \r\n        ?disabled=${me.disabled} \r\n        @mouseover=\"${me.#onMouseOver}\"\r\n        @mouseout=\"${me.#onMouseOut}\"        \r\n        @click=\"${me.#onClick}\">\r\n        ${me.#first}${me.#second}\r\n        </a>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'active': me.active,      \r\n      [`fs-${me.size}`]: me.size > 0,\r\n      [`text-${me.text}`]: me.text,\r\n      [`bg-${me.color}`]: me.color\r\n    }\r\n    return css;\r\n  }\r\n\r\n  click() {\r\n    this.#refEl.value?.click();\r\n  }\r\n\r\n  focus() {\r\n    requestAnimationFrame(() => this.#refEl.value?.focus());\r\n  }\r\n\r\n  get iconEl() {\r\n    return this.#refIco.value;\r\n  }\r\n\r\n  #onClick(e) {\r\n    const me = this;\r\n    me.iconEl?.animate();\r\n    me.notify();\r\n    if (me.url === '#' || GSUtil.isStringEmpty(me.url)) {\r\n      GSEvents.prevent(e);\r\n      me.handle(e);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  #onMouseOver() {\r\n    this.iconEl?.hover(true);\r\n  }\r\n\r\n  #onMouseOut() {\r\n    this.iconEl?.hover(false);\r\n  }\r\n\r\n  get #title() {\r\n    return this.translate(this.title);\r\n  }\r\n\r\n  get #first() { return this.rtl ? this.#title : this.#iconHtml; };\r\n\r\n  get #second() { return this.rtl ? this.#iconHtml : this.#title; };\r\n\r\n  get #iconHtml() { return this.icon ? this.#renderIcon : html`<slot name=\"icon\"></slot>`; }\r\n\r\n  get #renderIcon() {\r\n    return  html`\r\n    <gs-icon css=\"mx-1\" ${ref(this.#refIco)} \r\n    name=\"${this.icon}\" \r\n    size=\"${this.size}\" \r\n    click-css=\"${ifDefined(this.clickCss)}\" \r\n    hover-css=\"${ifDefined(this.hoverCss)}\" \r\n    data-delay=\"1\"></gs-icon>`;\r\n  }\r\n\r\n  /**\r\n   * Generate clickable link\r\n   * @param {*} options \r\n   * @param {*} css \r\n   * @param {*} before \r\n   * @param {*} after \r\n   * @returns \r\n   */\r\n  static generate(options, css, before, after) {\r\n    const opt = options;\r\n    return html`<a class=\"${classMap(css)}\"\r\n        tabindex=\"0\"    \r\n        ${dataset(opt, true)}\r\n        part=\"${ifDefined(opt.part)}\"\r\n        tooltip=\"${ifDefined(opt.tooltip)}\"\r\n        href=\"${ifDefined(opt.url)}\">        \r\n        ${before || ''}\r\n        ${ifDefined(opt.title)}\r\n        <slot></slot> \r\n        ${after || ''}\r\n    </a>`;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-link');\r\n  }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { html, ifDefined } from '../lib.mjs';\r\nimport { GSGroupElement } from './Group.mjs';\r\n\r\nexport class GSListElement extends GSGroupElement {\r\n\r\n  static properties = {\r\n    selectable: { reflect: true, type: Boolean }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.circular = false;\r\n    this.multiple = false;\r\n    this.selectable = false;\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    return this.data.length > 0 || this.items.length > 0;\r\n  }\r\n\r\n  renderClass() {\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'list-group': true,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  renderWrappedUI() {\r\n    return html`<slot></slot>`;\r\n  }\r\n\r\n  reset() {\r\n    this.items.forEach(el => el.reset());\r\n    this.notify();\r\n  }\r\n\r\n  renderItems() {    \r\n    return this.data.map(o => {\r\n      return html`<gs-list-item generated\r\n        .active=\"${ifDefined(o.active === true)}\"\r\n        .autofocus=\"${ifDefined(o.autofocus === true)}\"\r\n        .disabled=\"${ifDefined(o.disabled === true)}\" \r\n        icon=\"${ifDefined(o.icon)}\" \r\n        href=\"${ifDefined(o.href)}\" \r\n        target=\"${ifDefined(o.target)}\" \r\n        title=\"${ifDefined(o.title)}\"></gs-list-item>`;\r\n    });\r\n  }\r\n\r\n  isNavigable(el) {\r\n    return super.isNavigable(el) && this.selectable;\r\n  }\r\n\r\n  get childTagName() {\r\n    return 'GS-LIST-ITEM';\r\n  }\r\n\r\n  static {\r\n    this.define('gs-list');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, ifDefined, html, createRef, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\nexport class GSListItemElement extends GSElement {\r\n\r\n  static properties = {\r\n    url: {},\r\n    target: {},\r\n    title: {},\r\n    icon: {},\r\n    size: { type: Number },\r\n    autofocus: { type: Boolean, reflect: true },\r\n    disabled: { type: Boolean, reflect: true },\r\n    active: { type: Boolean, reflect: true }\r\n  }\r\n\r\n  #initial;\r\n  #refEl = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    this.binded();\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    this.#initial = this.active;\r\n  }\r\n\r\n  shouldUpdate(changedProperties) {\r\n    return this.parentComponent?.tagName === 'GS-LIST';\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n        // allow single setting at the gs-list to apply to the child\r\n        // GSAttributeHandler.clone(this.parentComponent, this, false);\r\n        const me = this;\r\n        if (me.isMatchHashBang) me.active = true;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<a  tabindex=\"0\" ${ref(me.#refEl)}\r\n       href=\"${ifDefined(me.href)}\" \r\n       target=\"${ifDefined(me.target)}\" \r\n       class=\"${classMap(me.renderClass())}\">\r\n        ${me.#renderFirst()} \r\n        ${me.#renderSecond()}\r\n        <slot>${me.renderTemplate()}</slot>\r\n      </a>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'list-group-item': true,\r\n      'list-group-item-action': true,\r\n      [`fs-${me.size}`]: me.size > 0,\r\n      [me.#itemCSS] : true,\r\n      'active': me.isActive\r\n    }\r\n    return me.mapCSS(me.#itemStatusCSS, css);\r\n  }\r\n\r\n  get isActive() {\r\n    return this.active && this.isSelectable;\r\n  }\r\n\r\n  get isSelectable() {\r\n    return !GSUtil.asBool(this.disabled) || GSUtil.asBool(this.parentComponent.selectable);\r\n  }\r\n\r\n  get isMatchHashBang() {\r\n    return GSUtil.isStringNonEmpty(this.url) && this.url === location.hash;\r\n  }\r\n\r\n  #renderIcon() {\r\n    const me = this;\r\n    return me.icon ? html`<gs-icon name=\"${me.icon}\" size=\"${me.size}\"></gs-icon>` : html`<slot name=\"icon\"></slot>`;\r\n  }\r\n\r\n  #renderText() {\r\n    return this.title ? html`<span>${this.translate(this.title)}</span>` : html`<slot name=\"title\"></slot>`;\r\n  }\r\n\r\n  #renderFirst() {\r\n    return this.rtl ? this.#renderText() : this.#renderIcon();\r\n  }\r\n\r\n  #renderSecond() {\r\n    return this.rtl ? this.#renderIcon() : this.#renderText();\r\n  }\r\n\r\n  toggle() {\r\n    this.active = !this.active;\r\n  }\r\n\r\n  reset() {\r\n    this.active = this.autofocus || this.#initial || false;\r\n  }\r\n\r\n  click() {\r\n    this.#refEl.value?.click();\r\n  }\r\n\r\n  focus() {\r\n    requestAnimationFrame(() => this.#refEl.value?.focus());\r\n  }\r\n\r\n  get href() {\r\n    return this.url ? this.url : '#';\r\n  }\r\n\r\n  get #activeCSS() {\r\n    return this.parentComponent.dataset?.cssActive || '';\r\n  }\r\n\r\n  get #inactiveCSS() {\r\n    return this.parentComponent.dataset?.cssInactive || '';\r\n  }\r\n\r\n  get #itemCSS() {\r\n    return this.parentComponent.dataset?.cssItem || '';\r\n  }\r\n\r\n  get #itemStatusCSS() {\r\n    return this.isActive ? this.#activeCSS : this.#inactiveCSS;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-list-item');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\n/**\r\n * For debugging purposes for floating element such as popup, popover, menus... \r\n * https://developer.mozilla.org/en-US/docs/Web/CSS/CSSOM_view/Coordinate_systems\r\n */\r\nexport class GSMouseElement extends GSElement {\r\n\r\n  static properties = {\r\n    pageX: { type: Number },\r\n    pageY: { type: Number },\r\n    screenX: { type: Number },\r\n    screenY: { type: Number },\r\n    clientX: { type: Number },\r\n    clientY: { type: Number },       \r\n    offsetX: { type: Number },       \r\n    offsetY : { type: Number }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    this.attachEvent(window, 'mousemove', this.#onMouse.bind(this));\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`\r\n    Offset(${me.offsetX}, ${me.offsetY}) \r\n    Viewport(${me.clientX}, ${me.clientY}) \r\n    Page(${me.pageX}, ${me.pageY}) \r\n    Screen(${me.screenX}, ${me.screenY})`;\r\n  }\r\n\r\n  #onMouse(e) {\r\n    const me = this;\r\n    me.offsetX = e.offsetX;\r\n    me.offsetY = e.offsetY;\r\n    me.clientX = e.clientX;\r\n    me.clientY = e.clientY;\r\n    me.pageX = e.pageX;\r\n    me.pageY = e.pageY;\r\n    me.screenX = e.screenX;\r\n    me.screenY = e.screenY;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-mouse');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, css, html, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color } from '../properties/color.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\n/**\r\n * This component allow moving contained elements acroos UI\r\n */\r\nexport class GSMovableElement extends GSElement {\r\n\r\n  static styles = css`\r\n  :host {\r\n      --gs-width : inherited;\r\n      --gs-height : inherited;\r\n      --gs-min-width: inherited;\r\n      --gs-max-width: inherited;\r\n      --gs-min-height: inherited;\r\n      --gs-max-height: inherited;\r\n  }\r\n  .gs-movable {\r\n    left: var(--mouse-x) !important;\r\n    top: var(--mouse-y) !important;\r\n   }`;\r\n\r\n  static properties = {\r\n    shadow: { type: Boolean},\r\n    border: { type: Boolean},\r\n    color: { reflect: true, ...color }\r\n  }\r\n\r\n  #styleID = GSID.id;\r\n  #refEl = createRef();\r\n  #enabled = false;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.dynamicStyle(me.#styleID);\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    const me = this;\r\n    const root = document.documentElement;\r\n    me.attachEvent(root, 'mousemove', me.#onMove.bind(me));\r\n    me.attachEvent(root, 'mousedown', me.#onMouseDown.bind(me));\r\n    me.attachEvent(root, 'mouseup', me.#onMouseUp.bind(me));\r\n  }\r\n\r\n  firstUpdated() {\r\n    super.firstUpdated();\r\n    const me = this;\r\n    const rule = me.dynamicStyle(me.#styleID);\r\n    Object.assign(rule.style, {cursor: 'move'});\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div ${ref(me.#refEl)} \r\n      data-gs-class=\"${me.#styleID}\"\r\n      class=\"${classMap(me.renderClass())}\"\r\n      @mousedown=\"${() => me.#enabled = true}\"\r\n      @mouseup=\"${() => me.#enabled = false}\">\r\n      <slot></slot>\r\n      </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'gs-movable' : true,\r\n      [me.#styleID]: true,\r\n      'position-absolute' : true,\r\n      'border' : me.border,\r\n      'shadow-sm' : me.shadow,\r\n      [`text-${me.color}`]: me.color,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  #updateCursor(move) {\r\n    const me = this;\r\n    const rule = me.dynamicStyle(me.#styleID);\r\n    Object.assign(rule.style, {'user-select': move ? 'none' : ''});\r\n  }\r\n\r\n  #onMove(e) {\r\n    if (this.#enabled) {\r\n      const style = this.#refEl.value.style;\r\n      style?.setProperty('--mouse-x', e.clientX + \"px\");\r\n      style?.setProperty('--mouse-y', e.clientY + \"px\");\r\n    }\r\n  }\r\n\r\n  #onMouseDown(e) {\r\n    this.#updateCursor(true);\r\n  }\r\n\r\n  #onMouseUp(e) {\r\n    this.#updateCursor(false);\r\n  }\r\n\r\n\r\n  static {\r\n    this.define('gs-movable');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { html, ifDefined } from '../lib.mjs';\r\nimport { GSGroupElement } from './Group.mjs';\r\nimport { PlacementTypes, nav, placement } from '../properties/index.mjs';\r\n\r\nexport class GSNavElement extends GSGroupElement {\r\n\r\n  static properties = {\r\n    type: nav,\r\n    placement: placement,\r\n    vertical: { type: Boolean }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.circular = true;\r\n    this.multiple = false;\r\n    this.type = 'pills';\r\n    this.placement = 'start';\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    return this.data.length > 0 || this.query('gs-nav-item', false, true);\r\n  }\r\n  \r\n  renderWrappedClass() {\r\n    const me = this;\r\n    const isBefore = PlacementTypes.isBefore(me.placement);\r\n    const isTab = me.type === 'tabs';\r\n    const css = {\r\n      'nav': true,\r\n      [`nav-${me.type}`]: me.type,\r\n      'flex-column': me.vertical,\r\n      'border-bottom-0': me.vertical,\r\n      'border-end': isTab && isBefore && me.vertical,\r\n      'border-start': isTab && !isBefore && me.vertical,\r\n      [`justify-content-${me.placement}`]: !me.vertical\r\n    }\r\n    return css;\r\n  }\r\n\r\n  /**\r\n   * Render items based on data propprty (might be from gs-item)\r\n   * @returns \r\n   */\r\n  renderItems() {\r\n    return this.data.map(o => {\r\n      return html`<gs-nav-item generated\r\n        .active=\"${o.active === true}\"\r\n        .autofocus=\"${o.autofocus === true}\"\r\n        .disabled=\"${ifDefined(o.disabled === true)}\" \r\n        icon=\"${ifDefined(o.icon)}\" \r\n        href=\"${ifDefined(o.href)}\" \r\n        target=\"${ifDefined(o.target)}\" \r\n        title=\"${ifDefined(o.title)}\">\r\n        </gs-nav-item>`;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Callback when child element focused\r\n   * @param {*} el \r\n   */\r\n  onFocused(el) {\r\n    // el?.click();\r\n  }\r\n\r\n  get childTagName() {\r\n    return 'GS-NAV-ITEM';\r\n  }\r\n\r\n  static {\r\n    this.define('gs-nav');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, ifDefined, html, createRef, ref } from '../lib.mjs';\r\nimport { NavTypes, PlacementTypes, color } from '../properties/index.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSNavItemElement extends GSElement {\r\n\r\n  static properties = {\r\n    href: {},\r\n    target: {},\r\n    title: {},\r\n    icon: {},\r\n    disabled: { type: Boolean },\r\n    autofocus: { type: Boolean },\r\n    active: { type: Boolean, reflect: true },\r\n    tooltip: {}, // Add tooltip property\r\n    badge: { type: Boolean },\r\n    badgeColor: {...color},\r\n    badgeValue: { }\r\n  }\r\n\r\n  #refEl = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    this.badgeColor = 'danger';\r\n    this.badgeValue = '!';\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    delete this[Symbol.for('gs-element')];\r\n    super.disconnectedCallback();\r\n  }\r\n  \r\n  shouldUpdate(changedProperties) {\r\n    return this.parentComponent?.tagName === this.parentType;\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    if (this.autofocus && !this.disabled) this.focus();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div class=\"nav-item position-relative ${classMap(me.renderClass())}\">${me.#button}${me.#badgeUI}</div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    return this.mapCSS(this.#itemsCSS, super.renderClass());\r\n  }\r\n\r\n  reset() {\r\n    this.active = this.autofocus || false;\r\n  }\r\n\r\n  click() {\r\n    this.#refEl.value?.click();\r\n  }\r\n\r\n  focus() {\r\n    requestAnimationFrame(() => this.#refEl.value?.focus());\r\n  }\r\n\r\n  get parentType() {\r\n    return 'GS-NAV';\r\n  }\r\n\r\n  get isNav() {\r\n    return true;\r\n  }\r\n\r\n  get vertical() {\r\n    return this.parentComponent.vertical || false;\r\n  }\r\n\r\n  get placement() {\r\n    return this.parentComponent.placement;\r\n  }\r\n\r\n  get url() {\r\n    return this.href && this.target ? this.href : '#';\r\n  }\r\n\r\n  get #title() {\r\n    return html`<slot>${this.translate(this.title)}</slot>`;\r\n  }\r\n\r\n  get #icon() {\r\n    return this.icon ? html`<gs-icon name=\"${this.icon}\"></gs-icon>` : html`<slot name=\"icon\"></slot>`;\r\n  }\r\n\r\n  get #first() {\r\n    return this.rtl ? this.#title : this.#icon;\r\n  }\r\n\r\n  get #second() {\r\n    return this.rtl ? this.#icon : this.#title;\r\n  }\r\n\r\n  get #button() {\r\n    const me = this;\r\n    let obj = me.mapCSS(me.#buttonCSS, {});\r\n    if (me.active) obj = me.mapCSS(me.#buildCSS + ' ' + me.#activeCSS, obj);\r\n    return html`<a tabindex=\"0\" type=\"button\" role=\"nav\" \r\n     ${ref(me.#refEl)}\r\n     class=\"nav-link ${classMap(obj)}\"\r\n     href=\"${ifDefined(me.url)}\" \r\n     target=\"${ifDefined(me.target)}\"\r\n     title=\"${ifDefined(me.tooltip)}\"> \r\n        ${me.#first} \r\n        ${me.#second}\r\n      </a>`;\r\n  }\r\n\r\n  get #badgeUI() {\r\n    const me = this;\r\n    if (!me.badge) return '';\r\n    const css = {\r\n      'top-0' : true,\r\n      'end-0' : true,\r\n      'translate-middle-y' : true,\r\n      [`text-bg-${me.badgeColor}`]: me.badgeColor,\r\n    };\r\n    return html`<span class=\"badge rounded-pill position-absolute ${classMap(css)}\">${me.badgeValue}</span>`;\r\n  }\r\n\r\n  get #itemsCSS() {\r\n    return this.parentComponent.dataset?.cssItem || '';\r\n  }\r\n\r\n  get #buttonCSS() {\r\n    return this.parentComponent.dataset?.cssButton || '';\r\n  }\r\n\r\n  get #activeCSS() {\r\n    return this.parentComponent.dataset?.cssActive || '';\r\n  }\r\n\r\n  get #navType() {\r\n    return NavTypes.indexOf(this.parentComponent.type);\r\n  }\r\n\r\n  // fiix for shadowed DOM, parent class=\"nav nav-pills..\" \r\n  // do not cross shadow dom, so item elements does not see CSS\r\n  // we have to simulate\r\n  get #buildCSS() {\r\n    const isVertical = this.vertical;\r\n    const isBefore = PlacementTypes.isBefore(this.placement);\r\n    switch (this.#navType) {\r\n      // pills\r\n      case 1: return 'rounded text-bg-primary';\r\n      // tabs\r\n      case 2:\r\n        if (isVertical) {\r\n          if (isBefore) {\r\n            return 'shadow-none border border-end-0';\r\n          } else {\r\n            return 'shadow-none border border-start-0';\r\n          }\r\n        }\r\n        return 'shadow-none border border-bottom-0';\r\n      // underline\r\n      case 3: return 'shadow-none border-bottom border-3 fw-medium';\r\n      default:\r\n        return '';\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-nav-item');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { svg, html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\n\r\nexport class GSOverlayElement extends GSElement {\r\n\r\n    static properties = {\r\n        color: {},\r\n        target: {},\r\n        autoremove: { type: Boolean },\r\n        opened: { type: Boolean },\r\n        opacity: { type: Number },\r\n        padding: { type: Number },\r\n        radius: { type: Number },\r\n    }\r\n\r\n    #styleID = GSID.id;\r\n    #styleID2 = GSID.id;\r\n\r\n    constructor() {\r\n        super();\r\n        //this.color = 'rgb(0,0,0)';\r\n        this.color = '#000';\r\n        this.opacity = 0.7;\r\n        this.padding = 1;\r\n        this.radius = 6;\r\n        this.dynamicStyle(this.#styleID);\r\n        this.dynamicStyle(this.#styleID2);\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        const me = this;\r\n        me.attachEvent(window, 'resize', () => me.requestUpdate());\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        if (!me.opened) return '';\r\n        const path = me.#path;\r\n        return path ? html`<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:space=\"preserve\"\r\n            xmlnsXlink=\"http://www.w3.org/1999/xlink\"\r\n            version=\"1.1\" preserveAspectRatio=\"xMinYMin slice\"\r\n            viewBox=\"0 0 ${window.innerWidth} ${window.innerHeight}\"\r\n            class=\"gs-overlay gs-overlay-animated ${me.#styleID}\"\r\n            @click=\"${me.reset.bind(me)}\">\r\n            ${path}\r\n        </svg>` : '';\r\n    }\r\n\r\n    async firstUpdated(changed) {\r\n        const me = this;\r\n        const opt = {\r\n            fillRule: \"evenodd\",\r\n            clipRule: \"evenodd\",\r\n            strokeLinejoin: \"round\",\r\n            strokeMiterlimit: \"2\",\r\n            zIndex: \"10000\",\r\n            position: \"fixed\",\r\n            top: \"0\",\r\n            left: \"0\",\r\n            width: \"100%\",\r\n            height: \"100%\"\r\n        };\r\n        me.dynamicStyle(me.#styleID, opt);\r\n        super.firstUpdated(changed);\r\n    }\r\n\r\n    open() {\r\n        this.opened = true;\r\n    }\r\n\r\n    close() {\r\n        this.opened = false;\r\n    }\r\n\r\n    toggle() {\r\n        this.opened = !this.opened;\r\n    }\r\n\r\n    reset() {\r\n        const me = this;\r\n        if (me.autoremove) me.close();\r\n    }\r\n\r\n    get #path() {\r\n        const me = this;\r\n        const el = GSDOM.query(me.target);\r\n        if (!me.target) return '';\r\n        const pathStr = me.#createSVGPathString(el);\r\n        const opt = { fill: me.color, opacity: me.opacity, pointerEvents: 'auto', cursor: 'auto' };\r\n        me.dynamicStyle(me.#styleID2, opt);\r\n        return svg`<path class=\"${me.#styleID2}\"  d=\"${pathStr}\"></path>`;\r\n    }\r\n\r\n    #createSVGPathString(target) {\r\n\r\n        const me = this;\r\n        const windowX = window.innerWidth;\r\n        const windowY = window.innerHeight;\r\n\r\n        const rect = target.getBoundingClientRect();\r\n\r\n        const padding = me.padding;\r\n        const radius = me.radius;\r\n\r\n        const width = rect.width + padding * 2;\r\n        const height = rect.height + padding * 2;\r\n\r\n        // prevent glitches when stage is too small for radius\r\n        const limitedRadius = Math.min(radius, width / 2, height / 2);\r\n\r\n        // no value below 0 allowed + round down\r\n        const normalizedRadius = Math.floor(Math.max(limitedRadius, 0));\r\n\r\n        const highlightBoxX = rect.x - padding + normalizedRadius;\r\n        const highlightBoxY = rect.y - padding;\r\n        const highlightBoxWidth = width - normalizedRadius * 2;\r\n        const highlightBoxHeight = height - normalizedRadius * 2;\r\n\r\n        const val = `M${windowX},0L0,0L0,${windowY}L${windowX},${windowY}L${windowX},0Z\r\n            M${highlightBoxX},${highlightBoxY} \r\n            h${highlightBoxWidth} \r\n            a${normalizedRadius},${normalizedRadius} 0 0 1 ${normalizedRadius},${normalizedRadius} \r\n            v${highlightBoxHeight} \r\n            a${normalizedRadius},${normalizedRadius} 0 0 1 -${normalizedRadius},${normalizedRadius} \r\n            h-${highlightBoxWidth} \r\n            a${normalizedRadius},${normalizedRadius} 0 0 1 -${normalizedRadius},-${normalizedRadius} \r\n            v-${highlightBoxHeight} \r\n            a${normalizedRadius},${normalizedRadius} 0 0 1 ${normalizedRadius},-${normalizedRadius} z`;\r\n        return val.replace(/[\\t\\n]/g, ' ');\r\n    }\r\n\r\n    static {\r\n        this.define('gs-overlay');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, html, ifDefined, map, range, ref } from '../lib.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { size, SizeTypes } from '../properties/index.mjs';\r\n\r\nexport class GSPagerElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    size: { ...size },\r\n    first: { type: Boolean },\r\n    last: { type: Boolean },\r\n    next: { type: Boolean },\r\n    previous: { type: Boolean },\r\n    pages: { type: Number },\r\n\r\n    labelFirst: { attribute: 'label-first' },\r\n    labelLast: { attribute: 'label-last' },\r\n    labelNext: { attribute: 'label-next' },\r\n    labelPrevious: { attribute: 'label-previous' },\r\n\r\n    cssItem: { attribute: 'css-item' },\r\n\r\n  }\r\n\r\n  #ref = createRef();\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.pages = 5;\r\n    me.labelFirst = '&laquo;';\r\n    me.labelLast = '&raquo;';\r\n    me.labelNext = '&rsaquo;';\r\n    me.labelPrevious = '&lsaquo;';\r\n    if (me.#isInTable) {\r\n      me.slot = \"extra\";\r\n    }\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const half = Math.floor((me.pages - 1) / 2);\r\n    const page = me.dataController?.page || 0;\r\n    const start = page - half < 1 ? 1 : page - half;\r\n    const end = page > 0 ? page + half : me.pages;\r\n\r\n    return html`<nav \r\n        dir=\"${ifDefined(me.direction)}\"\r\n        @click=\"${me.#onClick}\"\r\n        @keyup=\"${me.#onKeyUp}\"\r\n        @keydown=\"${me.#onKeyDown}\">\r\n        <ul ${ref(me.#ref)} class=\"${classMap(me.renderClass())}\">\r\n        ${me.#renderFirst()}\r\n        ${me.#renderPrevious()}\r\n        ${map(range(start, end + 1), (i) => me.#renderItem(i, '', '', i  === page))}\r\n        ${me.#renderNext()}\r\n        ${me.#renderLast()}\r\n        </ul></nav>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const size = me.size ? SizeTypes[me.size] || me.size : '';\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'pagination': true,\r\n      [`pagination-${size}`]: size,\r\n\r\n    }\r\n    return css;\r\n  }\r\n\r\n  updated() {\r\n    const target = this.#ref.value;\r\n    if (target && this.isFocused) {\r\n      target.querySelector('.active > a')?.focus();\r\n    }\r\n  }\r\n\r\n  onDataRead() {\r\n    this.requestUpdate();\r\n  }\r\n\r\n  #renderFirst() {\r\n    return this.first ? this.#renderItem(this.labelFirst, 'first', 'First page') : '';\r\n  }\r\n\r\n  #renderLast() {\r\n    return this.last ? this.#renderItem(this.labelLast, 'last', 'Last page') : '';\r\n  }\r\n\r\n  #renderPrevious() {\r\n    return this.previous ? this.#renderItem(this.labelPrevious, 'previous', 'Previous page') : '';\r\n  }\r\n\r\n  #renderNext() {\r\n    return this.next ? this.#renderItem(this.labelNext, 'next', 'Next page') : '';\r\n  }\r\n\r\n  #renderItem(text = '', name = '', title = '', active = false) {\r\n    const me = this;\r\n    text = GSUtil.decodeHTMLEntities(text);\r\n    return html`<li class=\"page-item ${active ? 'active' : ''}\">\r\n              <a class=\"page-link ${this.cssItem}\" \r\n                 name=\"${name}\" \r\n                 title=\"${me.translate(title)}\" \r\n                 href=\"#\">${me.translate(text)}</a>\r\n            </li>`;\r\n  }\r\n\r\n  #onClick(e) {\r\n\r\n    const me = this;\r\n    const el = this.#toTarget(e, 'a');\r\n    if (!el) return;\r\n\r\n    const ctrl = me.dataController;\r\n    if (!ctrl) return;\r\n\r\n    const val = el.name || el.text;\r\n    me.emit(val, el);\r\n    \r\n    switch (val) {\r\n      case 'first':\r\n        return ctrl.firstPage();\r\n      case 'last':\r\n        return ctrl.lastPage();\r\n      case 'next':\r\n        return ctrl.nextPage();\r\n      case 'previous':\r\n        return ctrl.prevPage();\r\n    }\r\n\r\n    ctrl.page = val;\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n    const current = this.#toTarget(e, 'li');\r\n    let el = null;\r\n    switch (e.code) {\r\n      case 'ArrowLeft':\r\n        el = current?.previousElementSibling;\r\n        break;\r\n      case 'ArrowRight':\r\n        el = current?.nextElementSibling;\r\n        break;\r\n    }\r\n    el = el?.querySelector('a');\r\n    el?.focus();\r\n  }\r\n\r\n  #onKeyUp(e) {\r\n    if (e.code === 'Space') {\r\n      this.#toTarget(e, 'a')?.click();\r\n    }\r\n  }\r\n\r\n  #toTarget(e, name) {\r\n    const el = e.target.closest(name) || e.target;\r\n    return el.tagName === name.toUpperCase() ? el : undefined;\r\n  }\r\n\r\n  get #isInTable() {\r\n    return this.parentComponent?.tagName === 'GS-TABLE';\r\n  }\r\n  \r\n  static {\r\n    this.define('gs-pagination');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, ref, classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { placement, position } from '../properties/index.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSPopper } from \"../base/GSPopper.mjs\";\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\n\r\nexport class GSPopupElement extends GSElement {\r\n\r\n  static properties = {\r\n    placement: { ...placement },\r\n    position: { ...position },\r\n    trigger: {},\r\n    target: {},\r\n    autoclose: { type: Boolean },\r\n    autofocus: { type: Boolean },\r\n    opened: { type: Boolean },\r\n    hPos: { type: Number, attribute: 'h-pos' },\r\n    vPos: { type: Number, attribute: 'v-pos' },\r\n    wMin: { type: Number, attribute: 'w-min' },\r\n    wMax: { type: Number, attribute: 'w-max' },\r\n    hMin: { type: Number, attribute: 'h-min' },\r\n    hMax: { type: Number, attribute: 'h-max' },\r\n\r\n  }\r\n\r\n  #caller = null;\r\n  #panelRef = createRef();\r\n  #styleID = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    this.autofocus = true;\r\n    this.autoclose = true;\r\n    this.trigger = 'click';\r\n    this.position = 'absolute';\r\n    this.placement = 'bottom';\r\n    this.dynamicStyle(this.#styleID);\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    const me = this;\r\n    me.#attachTarget(); // Fixed typo: #attachTaraget -> #attachTarget\r\n    me.attachEvent(window, 'resize', me.close.bind(me));\r\n    me.on('mouseleave', me.#onAuto.bind(me));\r\n  }\r\n\r\n  firstUpdated(changedProperties) {\r\n    const me = this;\r\n    requestAnimationFrame(() => {\r\n      me.#resize();\r\n      me.#reposition();\r\n    });\r\n    super.firstUpdated();\r\n  }\r\n\r\n  updated() {\r\n    const me = this;\r\n    me.#reposition();\r\n    if (me.autofocus) me.focus();\r\n    me.notify();\r\n    me.#postPopup();\r\n  }\r\n\r\n  willUpdate(changedProperties) {\r\n    if (changedProperties.has('opened')) {\r\n      this.#postPopup();\r\n    }\r\n    return super.willUpdate(changedProperties); \r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div \r\n      ${ref(me.#panelRef)}\r\n      dir=\"${ifDefined(me.direction)}\"\r\n      class=\"fade ${classMap(me.renderClass())}\"\r\n      data-gs-class=\"${me.#styleID}\"\r\n      @keydown=\"${me.#onKeyDown}\">\r\n      ${me.renderTemplate()}\r\n      <slot></slot>\r\n    </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'show': me.opened,\r\n      //'d-none' : !me.opened,\r\n      [me.#styleID]: true,\r\n      [`position-${me.position}`]: me.position,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  focus() {\r\n    this.query('[tabindex], input, select, textarea, button, a', true)?.focus();\r\n  }\r\n\r\n  open() {\r\n    this.opened = true;\r\n  }\r\n\r\n  close() {\r\n    this.opened = false;\r\n  }\r\n\r\n  toggle() {\r\n    this.opened = !this.opened;\r\n  }\r\n\r\n  /**\r\n   * Show popup at x/y position on the screen\r\n   * @param {Number} x \r\n   * @param {Number} y \r\n   * @returns {void}\r\n   */\r\n  popup(x = 0, y = 0) {\r\n    const me = this;\r\n    const obj = {\r\n      top: '0px',\r\n      left: '0px',\r\n      translate: `${x}px ${y}px`\r\n    };\r\n    me.#resize(obj);\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n    const me = this;\r\n    switch (e.key) {\r\n      case 'Escape':\r\n        me.close();\r\n        break;\r\n    }\r\n  }\r\n\r\n  #reposition() {\r\n    const me = this;\r\n    //if (!me.opened) return;\r\n    if (me.vPos || me.hPos) {\r\n      const opt = {\r\n        top: '0px',\r\n        left: '0px',\r\n        translate: `${me.hPos}px ${me.vPos}px`\r\n      };\r\n      const rule = me.dynamicStyle(me.#styleID);\r\n      Object.assign(rule.style, opt);\r\n    } else if (me.target) {\r\n      let target = GSDOM.query(document.documentElement, me.target);\r\n      target = target.renderRoot?.firstElementChild || target;\r\n      GSPopper.popupFixed(me.placement, me.#panel, target);\r\n    }\r\n\r\n  }\r\n\r\n  #resize(obj = {}) {\r\n    const me = this;\r\n    const rule = me.dynamicStyle(me.#styleID);\r\n    if (me.wMax) obj['max-width'] = `${me.wMax}px`;\r\n    if (me.wMin) obj['min-width'] = `${me.wMin}px`;\r\n    if (me.hMax) obj['max-height'] = `${me.hMax}px`;\r\n    if (me.hMin) obj['min-height'] = `${me.hMin}px`;\r\n    Object.assign(rule.style, obj);\r\n  }\r\n\r\n  #onPopup(e) {\r\n    const me = this;\r\n    me.#caller = e;\r\n    if (e instanceof Event) {\r\n      GSEvents.prevent(e);\r\n      me.#caller = e.composedPath().filter(e => (!(e instanceof HTMLSlotElement))).shift();\r\n    }\r\n\r\n    if (me.placement) {\r\n      GSPopper.popupFixed(me.placement, me.#panel, me.#caller);\r\n      me.opened = true;\r\n      return;\r\n    }\r\n\r\n    let x = e.clientX, y = e.clientY;\r\n    const rect = me.#panel.getBoundingClientRect();\r\n    const overflowH = x + rect.width > window.innerWidth;\r\n    const overflowV = y + rect.height > window.innerHeight;\r\n\r\n    if (overflowH) x = window.innerWidth - rect.width;\r\n    if (overflowV) y = window.innerHeight - rect.height;\r\n\r\n    me.popup(x, y);\r\n    return true;\r\n  }\r\n\r\n  #postPopup() {\r\n    const me = this;\r\n    const rule = me.dynamicStyle(me.#styleID);\r\n    Object.assign(rule.style, {display: me.opened ? '' : 'none'}); \r\n  }\r\n\r\n  #attachTarget() { // Fixed typo: #attachTaraget -> #attachTarget\r\n    const me = this;\r\n    const targets = GSDOM.queryAll(document.documentElement, me.target);\r\n    me.trigger.split(' ').forEach(evt => {\r\n      targets.forEach(target => me.attachEvent(target, evt, me.#onPopup.bind(me)));\r\n    });\r\n  }\r\n\r\n  #onAuto(e) {\r\n    if (this.autoclose) this.close();\r\n  }\r\n\r\n  get #panel() {\r\n    return this.#panelRef.value;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-popup');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, ref, classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { placement } from '../properties/index.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSPopper } from '../base/GSPopper.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\n\r\nexport class GSPopoverElement extends GSElement { // Fixed typo: GSPopoverlement -> GSPopoverElement\r\n\r\n  static properties = {\r\n    placement: { ...placement },\r\n    target: {},\r\n    trigger: {},\r\n    title: {},\r\n    content: {},\r\n    opened: { type: Boolean },\r\n  }\r\n\r\n  #arrowRef = createRef();\r\n  #panelRef = createRef();\r\n  #styleID = GSID.id;\r\n  #arrowID = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    // added to the GSCacheStyle\r\n    //this.style.position = 'fixed';\r\n    this.placement = 'top';\r\n    this.trigger = 'hover';\r\n    this.content = '';\r\n    this.dynamicStyle(this.#styleID);\r\n    this.dynamicStyle(this.#arrowID);\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.connectedCallback();\r\n    const me = this;\r\n    me.#attachEvents();\r\n    me.#reposition();\r\n    super.firstUpdated(changed);\r\n  }\r\n  \r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    this.#reposition();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const head = me.title ? html`<div class=\"popover-header ${me.cssHead}\">${me.translate(me.title)}</div>` : '';\r\n    return html`\r\n    <div ${ref(me.#panelRef)} \r\n        dir=\"${ifDefined(me.direction)}\"\r\n        data-popper-placement=\"${me.placement}\"\r\n        class=\"${classMap(me.renderClass())}\" \r\n        data-gs-class=\"${me.#styleID}\" \r\n        role=\"tooltip\">\r\n        <div ${ref(me.#arrowRef)} \r\n          class=\"popover-arrow ${me.#arrowID}\" \r\n          data-gs-class=\"${me.#arrowID}\">\r\n        </div>\r\n        ${head}\r\n        <div class=\"popover-body\">\r\n          ${me.renderTemplate()}\r\n          ${me.content}\r\n          <slot></slot>\r\n        </div>\r\n    </div>            \r\n    `;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'popover': true,\r\n      'bs-popover-auto': true,\r\n      'fade': true,\r\n      'show': me.opened,\r\n      [me.#styleID]: true\r\n    }\r\n    return css;\r\n  }\r\n\r\n  open() {\r\n    this.opened = true;\r\n  }\r\n\r\n  close() {\r\n    this.opened = false;\r\n  }\r\n\r\n  toggle() {\r\n    this.opened = !this.opened;\r\n  }\r\n\r\n  get isFocusTrigger() {\r\n    return this.trigger.includes('focus');\r\n  }\r\n\r\n  get isHoverTrigger() {\r\n    return this.trigger.includes('hover');\r\n  }\r\n\r\n  get #ref() {\r\n    const me = this;\r\n    switch (me.target) {\r\n      case '@parent':\r\n        return this.parentElement;\r\n      case '@previous':\r\n        return this.previousElementSibling;\r\n      case '@next':\r\n        return this.nextElementSibling;\r\n      default:\r\n        return GSDOM.query(document.body, me.target);\r\n    }\r\n  }\r\n\r\n  #reposition() {\r\n    const me = this;\r\n    const source = me.#panel;\r\n    if (!source) return;\r\n    if (me.opened) {\r\n      GSPopper.popupAbsolute(me.placement, source, me.#ref, me.#arrow);\r\n    } else {\r\n      me.dynamicStyle(me.#styleID, {top:'-1000px', left:'-1000px'});\r\n    }\r\n  }\r\n\r\n  // https://javascript.info/mousemove-mouseover-mouseout-mouseenter-mouseleave\r\n  #attachEvents() {\r\n\r\n    const me = this;\r\n    const el = me.#ref;\r\n\r\n    if (me.isHoverTrigger) {\r\n      GSEvents.attach(me, el, 'mouseover', me.open.bind(me));\r\n      GSEvents.attach(me, el, 'mouseleave', me.close.bind(me));\r\n    }\r\n\r\n    if (me.isFocusTrigger) {\r\n      GSEvents.attach(me, el, 'click', me.#onFocus.bind(me));\r\n      GSEvents.attach(me, me.#panel, 'mouseleave', me.close.bind(me));\r\n      GSEvents.attach(me, window, 'click', me.close.bind(me));\r\n    }\r\n\r\n  }\r\n\r\n  #onFocus(e) {\r\n    GSEvents.prevent(e);\r\n    this.toggle();\r\n  }\r\n  \r\n  get #arrow() { return this.#arrowRef.value; }\r\n  get #panel() { return this.#panelRef.value; }\r\n\r\n  static {\r\n    this.define('gs-popover');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { html, classMap, ifDefined } from '../lib.mjs';\r\nimport { literalTemplate } from '../directives/literal.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\nexport class GSProgressElement extends GSElement {\r\n\r\n  static properties = {\r\n    min: { reflect: true, type: Number },\r\n    max: { reflect: true, type: Number },\r\n    step: { reflect: true, type: Number },\r\n    value: { reflect: true, type: Number },\r\n    label: { reflect: true }\r\n  }\r\n\r\n  #styleID = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    this.min = 0;\r\n    this.step = 1;\r\n    this.max = 100;\r\n    this.value = 0;\r\n    this.styles = { width: '0%' };\r\n    this.dynamicStyle(this.#styleID);\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'progress-bar' : true,\r\n      [me.#styleID] : true\r\n    }\r\n    return css;\r\n  }  \r\n\r\n  renderUI() {\r\n    const me = this;\r\n    me.#updateStyle();\r\n    const obj = {min :me.min, max:me.max, step:me.step, value:me.value, percentage:me.percentage};\r\n    return html`\r\n    <div class=\"progress\" @keydown=\"${me.#onKeySelect}\" dir=\"${ifDefined(me.direction)}\">\r\n        <div class=\"${classMap(me.renderClass())}\" \r\n             \r\n             role=\"progressbar\"\r\n             tabindex=\"0\">\r\n             ${literalTemplate(me.label, obj)}\r\n        </div>\r\n    </div>    \r\n    `;\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    const me = this;\r\n    if (changed.has('value')) {\r\n      let val = me.step + changed.get('value');\r\n      val = me.#update(val, val);\r\n      changed.set('value', val);\r\n    }\r\n  }\r\n\r\n  updated(changed) {\r\n    if (changed.has('value')) {\r\n      this.notify();\r\n    }\r\n  }\r\n\r\n  increase(val) {\r\n    const me = this;\r\n    val = GSUtil.isNumber(val) ? val : me.step;\r\n    me.value = me.#update(me.value + val, me.value);\r\n    return true;\r\n  }\r\n\r\n  decrease(val) {\r\n    const me = this;\r\n    val = GSUtil.isNumber(val) ? val : me.step;\r\n    me.value = me.#update(me.value - val, me.value);\r\n    return true;\r\n  }\r\n\r\n  get percentage() {\r\n    const me = this;\r\n    return Math.trunc((me.value / me.max) * 100);\r\n  }\r\n\r\n  #updateStyle() {\r\n    const me = this;\r\n    me.styles.width = `${me.percentage}%`;\r\n    me.dynamicStyle(me.#styleID, me.styles);\r\n  }\r\n\r\n  #update(val, old = 0) {\r\n    val = GSUtil.asNum(val, GSUtil.asNum(old));\r\n    const me = this;\r\n    if (val > me.max) val = me.max;\r\n    if (val < me.min) val = me.min;\r\n    return val;\r\n  }\r\n\r\n  #onKeySelect(e) {\r\n    const me = this;\r\n    switch (e.code) {\r\n      case 'ArrowUp' :\r\n      case 'ArrowRight' :\r\n          return me.increase();\r\n      case 'ArrowLeft' :\r\n      case 'ArrowDown' :\r\n         return me.decrease();\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-progress');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, css, html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color } from '../properties/index.mjs';\r\n\r\nexport class GSSpinnerElement extends GSElement {\r\n\r\n    static styles = css`.spinner-border { border: var(--bs-spinner-border-width) solid currentcolor; border-right-color: transparent; }`;\r\n\r\n    static properties = {\r\n        color: { ...color, reflect: true },\r\n        small: { type: Boolean, reflect: true },\r\n        pulsar: { type: Boolean }\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div class=\"${classMap(me.renderClass())}\" role=\"status\"></div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            \"spinner-border\": !me.pulsar,\r\n            \"spinner-grow\": me.pulsar,\r\n            [`text-${me.color}`]: me.color,\r\n            [`spinner-border-sm`]: !me.pulsar && me.small,\r\n            [`spinner-grow-sm`]: me.pulsar && me.small,\r\n        }\r\n        return css;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-spinner');\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSSplitterElement class\r\n * @module components/GSSplitterElement\r\n */\r\n\r\nimport { classMap, createRef, ref, html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSCSSMap } from '../base/GSCSSMap.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { notEmpty, numGT0, placement } from '../properties/index.mjs';\r\nimport { ElementMoveController } from '../controllers/ElementMoveController.mjs';\r\n\r\n/**\r\n * Renderer for element splitter\r\n * @class\r\n * @extends {Component}\r\n */\r\nexport class GSSplitterElement extends GSElement {\r\n\r\n    static properties = {\r\n        // Check if splitter use vertical or horizontal splitting\r\n        split: { reflect: true },\r\n        // start|end|top|bottom\r\n        resize: { ...placement, hasChanged: notEmpty },\r\n        size: { type: Number, hasChanged: numGT0 }\r\n    }\r\n\r\n    #cursor = 0;\r\n    #styleID = GSID.id;\r\n    #styleTGT = GSID.id;\r\n    #elRef = createRef();\r\n    #mouseController;\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;\r\n        me.size = 8;\r\n        me.resize = 'start';\r\n        me.dynamicStyle(me.#styleID);\r\n        me.#load();\r\n        me.#mouseController = new ElementMoveController(me);\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        super.disconnectedCallback();\r\n        //this.dynamicStyle(this.#styleTGT, null, true);\r\n    }\r\n\r\n    firstUpdated(changed) {\r\n        super.firstUpdated(changed);\r\n        const me = this;\r\n        me.#mouseController.attach(me.#splitter);\r\n        //const shadow = GSDOM.root(me.target) instanceof ShadowRoot;\r\n        //me.dynamicStyle(me.#styleTGT, {}, !shadow);\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div ${ref(me.#elRef)} \r\n            @dblclick=\"${me.#onDoubleClick}\"\r\n            data-gs-class=\"${me.#styleID}\" \r\n            class=\"${classMap(me.renderClass())}\">\r\n            <slot></slot>\r\n        </div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            'splitter': true,\r\n            [me.#styleID]: true\r\n        }\r\n        return css;\r\n    }\r\n\r\n    updated(changedProperties) {\r\n        const me = this;\r\n        me.#cssUpdate();\r\n    }\r\n\r\n    /**\r\n    * Lock UI for mouse events to enable resizing over embedded iframes\r\n    * @param {MouseEvent} e \r\n    */\r\n    onStartMove(e) {\r\n        const me = this;\r\n        me.#cursor = me.isVertical ? e.clientX : e.clientY;\r\n        me.#lock(true);\r\n        GSEvents.send(globalThis, 'gs-split', { start: true });\r\n    }\r\n\r\n    /**\r\n     * Handles resizing based on mouse move event\r\n     * @param {MouseEvent} e \r\n     */\r\n    onMouseMove(e) {\r\n        const me = this;\r\n        const pos = me.isVertical ? e.clientX : e.clientY;\r\n        me.#updateMouse(pos);\r\n    }\r\n\r\n    /**\r\n     * Save last position and unlock mouse UI events when resizing finished\r\n     * @param {*} e \r\n     */\r\n    onEndMove(e) {\r\n        const me = this;\r\n        me.#save();\r\n        me.#lock(false);\r\n        GSEvents.send(globalThis, 'gs-split', { stop: true });\r\n    }\r\n\r\n    /**\r\n    * Check if splitter use vertical or hotizontal splitting\r\n    * @returns {Boolean}\r\n    */\r\n    get isVertical() {\r\n        return this.split === 'vertical';\r\n    }\r\n\r\n    get isHorizontal() {\r\n        return !this.isVertical;\r\n    }\r\n\r\n    /**\r\n     * Return preceding element\r\n     * @returns {HTMLElement}\r\n     */\r\n    get start() {\r\n        return this.previousElementSibling;\r\n    }\r\n\r\n    /**\r\n    * Return following element\r\n    * @returns {HTMLElement}\r\n    */\r\n    get end() {\r\n        return this.nextElementSibling;\r\n    }\r\n\r\n    /**\r\n     * Return closest element found\r\n     * @returns {HTMLElement}\r\n     */\r\n    get target() {\r\n        const me = this;\r\n        let el = me.#isPreceeding ? me.start : me.end;\r\n        el = el || me.parentElement;\r\n        el = GSDOM.isGSElement(el) ? el.self : el;\r\n        if (el instanceof ShadowRoot) {\r\n            // no firefox support\r\n            el = Array.from(el.children).filter(o => !GSDOM.isStyleValue(o, 'display', 'none')).pop();\r\n        }\r\n        el.classList?.add(me.#styleTGT);\r\n        return el;\r\n    }\r\n\r\n    get #isPreceeding() {\r\n        const me = this;\r\n        const resize = me.resize;\r\n        return resize === 'start' || resize === 'top';\r\n    }\r\n\r\n    get #splitter() {\r\n        return this.#elRef.value;\r\n    }\r\n\r\n    get #styleDynamic() {\r\n        return this.target.style;\r\n    }\r\n\r\n    /**\r\n     * Get elements which must be protected to allow mouse move over \r\n     */\r\n    get #lockable() {\r\n        const me = this;\r\n        const qry = 'iframe,embed,portal';\r\n        const p = GSDOM.queryAll(me.previousElementSibling, qry);\r\n        const n = GSDOM.queryAll(me.nextElementSibling, qry);\r\n        return [...p, ...n];\r\n    }\r\n\r\n    #load() {\r\n        const me = this;\r\n        if (!me.id) return;\r\n        const key = GSID.hashCode(location.origin + location.pathname);\r\n        let val = localStorage.getItem(`gs-splitter-${key}-${me.id}`);\r\n        val = GSUtil.asNum(val);\r\n        me.#update(val);\r\n    }\r\n\r\n    #save() {\r\n        const me = this;\r\n        if (!me.id) return;\r\n        const css = GSCSSMap.getComputedStyledMap(me.target);\r\n        const val = me.isVertical ? css.get('width') : css.get('height');\r\n        if (!val) return;\r\n        const key = GSID.hashCode(location.origin + location.pathname);\r\n        localStorage.setItem(`gs-splitter-${key}-${me.id}`, val);\r\n    }\r\n\r\n    #onDoubleClick(e) {\r\n\r\n        const me = this;\r\n        let csize = 0;\r\n        let key = '';\r\n\r\n        if (me.isVertical) {\r\n            key = 'width';\r\n            csize = me.target.clientWidth;\r\n        } else {\r\n            key = 'height';\r\n            csize = me.target.clientHeight;\r\n        }\r\n\r\n        let min = GSCSSMap.styleValue(me.target, `min-${key}`);\r\n        let max = GSCSSMap.styleValue(me.target, `max-${key}`);\r\n\r\n        min = GSUtil.asNum(min.value);\r\n        max = GSUtil.asNum(max.value);\r\n\r\n        if ((max - min) / 2 > csize) {\r\n            csize = max;\r\n        } else {\r\n            csize = min;\r\n        }\r\n        me.#update(csize);\r\n\r\n    }\r\n\r\n    /**\r\n     * Lock IFRAME,EMBED,PORTAL elements for mouse move events\r\n     * @param {*} lock \r\n     */\r\n    #lock(lock = true) {\r\n        const me = this;\r\n        const cls = 'pe-none';\r\n        if (lock) {\r\n            me.#lockable\r\n                .filter(el => !GSDOM.hasClass(el, 'pe-none'))\r\n                .forEach(el => {\r\n                    GSDOM.toggleClass(el, cls, true);\r\n                    el.dataset.gsSplitter = true;\r\n                });\r\n        } else {\r\n            me.#lockable\r\n                .filter(el => el.dataset.gsSplitter)\r\n                .forEach(el => {\r\n                    GSDOM.toggleClass(el, cls, false);\r\n                    delete el.dataset.gsSplitter;\r\n                });\r\n        }\r\n    }\r\n\r\n    #updateMouse(pos) {\r\n        const me = this;\r\n        requestAnimationFrame(() => {\r\n            if (me.isVertical) {\r\n                me.#updateX(pos);\r\n            } else {\r\n                me.#updateY(pos);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Calculate width based on mouse position\r\n     * @param {Number} pos \r\n     */\r\n    #updateX(pos) {\r\n        const me = this;\r\n        const target = me.target;\r\n        const dir = me.#isPreceeding ? 1 : -1;\r\n        let dx = (pos - me.#cursor) * dir;\r\n        dx = dx + target.clientWidth;\r\n        dx = dx < 0 ? 0 : dx;\r\n        me.#styleDynamic.width = dx + \"px\";\r\n        //me.dynamicStyle(me.#styleTGT, { width: dx + \"px\" }, true);\r\n        me.#cursor = pos;\r\n    }\r\n\r\n    /**\r\n     * Calculate height based on mouse position\r\n     * @param {Number} pos \r\n     */\r\n    #updateY(pos) {\r\n        const me = this;\r\n        const target = me.target;\r\n        const dir = me.#isPreceeding ? 1 : -1;\r\n        let dx = (pos - me.#cursor) * dir;\r\n        dx = dx + target.clientHeight;\r\n        dx = dx < 0 ? 0 : dx;\r\n        me.#styleDynamic.height = dx + \"px\";\r\n        //me.dynamicStyle(me.#styleTGT, { height: dx + \"px\" }, true);\r\n        me.#cursor = pos;\r\n    }\r\n\r\n    #update(val = 0) {\r\n        if (val <= 0) return\r\n        const me = this;\r\n        me.#cursor = val;\r\n        const key = me.isVertical ? 'width' : 'height';\r\n        me.#styleDynamic[key] = val + \"px\";\r\n        //me.dynamicStyle(me.#styleTGT, { [key]: val + \"px\" }, true);\r\n    }\r\n\r\n    #cssUpdate() {\r\n        const me = this;\r\n        const size = me.isVertical ? 'width' : 'height';\r\n        const full = me.isVertical ? 'height' : 'width';\r\n        const cursor = me.isVertical ? 'w-resize' : 'n-resize';\r\n        const opt = {\r\n            [size]: `${me.size}px`,\r\n            [full]: '100%',\r\n            'border-width': '1px',\r\n            cursor: cursor,\r\n            'border-color': 'darkgray',\r\n            'border-style': 'solid',\r\n            'background-color': 'lightgray',\r\n        };\r\n        me.dynamicStyle(me.#styleID, opt);\r\n    }\r\n\r\n    static {\r\n        this.define('gs-splitter');\r\n    }\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from '../../base/GSUtil.mjs';\r\nimport { GSNavItemElement } from '../NavItem.mjs';\r\n\r\n/**\r\n * Tab component (gs-tab-header), generate selectable/switchable tabs on a panel\r\n */\r\nexport class GSTabItemElement extends GSNavItemElement {\r\n\r\n  static properties = {\r\n    name: {}\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.css = this.#updateCSS + this.css;\r\n  }\r\n\r\n  get #updateCSS() {\r\n    const me = this;\r\n    return me.shouldUpdate() ? GSUtil.normalize(me.parentComponent?.tabCSS) : '';\r\n  }\r\n\r\n  get parentType() {\r\n    return 'GS-TAB-GROUP';\r\n  }\r\n\r\n  get panel() {\r\n    const me = this;\r\n    const key = Symbol.for('gs-element');\r\n    return me[key] || me.owner.panelByName(me.name);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-tab-header');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSDOM } from '../../base/GSDOM.mjs';\r\nimport { classMap, html, ifDefined } from '../../lib.mjs';\r\n\r\n/**\r\n * Container for individual tab; part of tabed panel\r\n */\r\nexport class GSTabPanelElement extends GSElement {\r\n\r\n  static properties = {\r\n    name: {},\r\n    template: {},\r\n    active: { type: Boolean, reflect : true }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.active = false;\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    delete this[Symbol.for('gs-element')];\r\n    super.disconnectedCallback();\r\n  }\r\n\r\n  shouldUpdate(changedProperties) {\r\n    return this.parentComponent?.tagName === this.parentType;\r\n  }\r\n\r\n  /*\r\n  @invalid=\"${me.#onInvalid}\"\r\n  @change=\"${me.#onChange}\"\r\n  */\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div  \r\n      dir=\"${ifDefined(me.direction)}\" \r\n      class=\"${classMap(this.renderClass())}\">\r\n      <slot>\r\n      ${me.renderTemplate()}\r\n      </slot></div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'tab-pane': true,\r\n      'd-none' : !me.active,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  get parentType() {\r\n    return 'GS-TAB-GROUP';\r\n  }\r\n\r\n  get owner() {\r\n    return this.closest(this.parentType.toLowerCase(), -1, true) || GSDOM.component(this);\r\n  }\r\n\r\n  get form() {\r\n    return this.closest('form', -1, true);\r\n  }\r\n\r\n  get tab() {\r\n    const me = this;\r\n    const key = Symbol.for('gs-element');\r\n    return me[key] || me.owner.tabByName(me.name);\r\n  }\r\n\r\n  get tabs() {\r\n    return this.owner.tabs;\r\n  }\r\n\r\n  /*\r\n  #onChange(e) {\r\n    const me = this;\r\n    if (me.form) {\r\n      const isValid = me.form.isValid;\r\n      me.tabs?.forEach(el => el.badge = !isValid);\r\n    }\r\n  }\r\n\r\n  #onInvalid(e) {\r\n    const me = this;\r\n    if (me.form) me.badge = false;\r\n  }\r\n  */\r\n\r\n  static {\r\n    this.define('gs-tab-panel');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSID } from '../../base/GSID.mjs';\r\nimport { html, ifDefined } from '../../lib.mjs';\r\nimport { PlacementTypes } from '../../properties/placement.mjs';\r\nimport { GSNavElement } from '../Nav.mjs';\r\n\r\n/**\r\n * Panel with tabs component (gs-tab-group), generate childrens gs-tab-header and gs-tab-panel \r\n */\r\nexport class GSTabGroupElement extends GSNavElement {\r\n\r\n  static properties = {\r\n    panelCSS: { attribute: 'css-panel' },\r\n    tabCSS: { attribute: 'css-tab' },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n   \r\n  firstUpdated(changed) {\r\n    super.firstUpdated(changed);\r\n    const me = this;\r\n    // link tabs and panels\r\n    me.items.forEach(el => me.#findPanel(el));\r\n    me.onSelected(me.active);\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    return this.data.length > 0 || this.items.length > 0;\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    const me = this;\r\n    if (changed.has('data')) {      \r\n      me.items.forEach(el => me.#findPanel(el));\r\n    }\r\n    super.willUpdate(changed);\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'd-flex': me.vertical\r\n    }\r\n    return css;\r\n  }\r\n\r\n  renderWrappedUI() {\r\n    const me = this;\r\n    const reverse = PlacementTypes.isAfter(me.placement);\r\n    const list = [super.renderWrappedUI('tabs'),\r\n    html`<div class=\"tab-content flex-fill ${me.panelCSS}\"  dir=\"${ifDefined(me.direction)}\">\r\n        <slot name=\"panels\"></slot>\r\n      </div>\r\n      <slot class=\"d-none\"></slot>`];\r\n    return reverse ? list.reverse() : list;\r\n  }\r\n\r\n  renderWrappedClass() {\r\n    const me = this;\r\n    const css = super.renderWrappedClass();\r\n    return me.mapCSS(me.tabCSS, css);\r\n  }\r\n\r\n  /**\r\n   * Render items based on data property (might be from gs-item)\r\n   * @returns \r\n   */\r\n  renderItems() {\r\n    const me = this;\r\n    const tabs =  me.#renderTabs();\r\n    const panels = me.#renderPanels();\r\n    return tabs.concat(...panels);\r\n  }\r\n\r\n  #renderTabs() {    \r\n    return this.data.map(o => {\r\n      if (!o.name) o.name = GSID.id;\r\n      return html`<gs-tab-header generated slot=\"tabs\"\r\n        .active=\"${ifDefined(o.active === true)}\"\r\n        .autofocus=\"${ifDefined(o.autofocus === true)}\"\r\n        .disabled=\"${ifDefined(o.disabled === true)}\" \r\n        icon=\"${ifDefined(o.icon)}\"\r\n        title=\"${ifDefined(o.title)}\"\r\n        name=\"${o.name}\"></gs-tab-header>`;\r\n    });    \r\n  }\r\n\r\n  /**\r\n   * Render items based on data property (might be from gs-item)\r\n   * @returns \r\n   */\r\n  #renderPanels() {\r\n    return this.data.map(o => {\r\n      if (!o.name) o.name = GSID.id;\r\n      return html`<gs-tab-panel generated  \r\n        slot=\"panels\" name=\"${o.name}\" \r\n        .active=\"${ifDefined(o.active)}\"\r\n        template=\"${ifDefined(o.template)}\"></gs-tab-panel>`;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Callback when tab selected\r\n   * @param {GSTabElement} el \r\n   */\r\n  onSelected(el) {\r\n    el?.click();\r\n    const panel = this.#findPanel(el);\r\n    if (panel) panel.active = true;\r\n  }\r\n\r\n  /**\r\n   * Callback when tab deselected\r\n   * @param {GSTabElement} el \r\n   */\r\n  onDeselected(el) {\r\n    const panel = this.#findPanel(el);\r\n    if (panel) panel.active = false;\r\n  }\r\n\r\n  get childTagName() {\r\n    return 'GS-TAB-HEADER';\r\n  }\r\n\r\n  get tabs() {\r\n    return this.items;\r\n  }\r\n\r\n  get panels() {\r\n    return this.queryAll('gs-tab-panel', false, true);\r\n  }\r\n\r\n  tabByName(name = '', shadow = false) {\r\n    return super.childByName(name, shadow);\r\n  }\r\n\r\n  panelByName(name = '', shadow = false) {\r\n    return this.query(`gs-tab-panel[name=\"${name}\"]`, shadow, true);\r\n  }\r\n\r\n  /**\r\n   * Selected Tab node name is used to find the panel.\r\n   * If panel found, auto-link it with node element\r\n   * @param {GSTabElement} el \r\n   */\r\n  #findPanel(el) {\r\n    if (!el) return null;\r\n    const me = this;\r\n    const generated = me.data?.length > 0;\r\n    const key = Symbol.for('gs-element');\r\n    let panel = el[key] || me.panelByName(el.name, generated);\r\n    if (panel && !el[key]) {\r\n      el[key] = panel;\r\n      panel[key] = el;\r\n    }\r\n    return panel;\r\n  }\r\n\r\n  static {\r\n    this.define('gs-tab-group');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, css, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { color } from '../properties/color.mjs';\r\nimport { GSData } from '../base/GSData.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { DataSelector } from '../data/DataSelector.mjs';\r\n\r\n/**\r\n * A HTML Table renderer for tabular data representation.\r\n * Either use \"storage\" property to point to data handler\r\n * or use simpler form by using \"data\" property.\r\n * \r\n * NOTE: Simpler form currently does not suport data filter.\r\n * Simpler form is only for read-ony static data representation.\r\n */\r\nexport class GSTableElement extends GSElement {\r\n\r\n  static #icons = ['sort-up', 'arrow-down-up', 'sort-down-alt'];\r\n\r\n  static styles = css`th:hover { opacity: 50% !important; }`;\r\n\r\n  static CELLS = {\r\n    align: {},\r\n    width: {},\r\n    width: {},\r\n    css: {},\r\n    title: {},\r\n    colspan: {},\r\n    storage: {},\r\n    ref: {}, // if set; use storage or gs-items to map ref value to virtual field\r\n    list : { type: Boolean }, // if set, use storage record column as a filter\r\n    filter: { type: Boolean },\r\n    hidden: { type: Boolean },\r\n    fixed: { type: Boolean },\r\n    filterType: { attribute: 'filter-type' },\r\n    cssFilter: { attribute: 'css-filter' },\r\n    cssHeader: { attribute: 'css-header' },\r\n    color: { ...color},\r\n    ...GSData.PROPERTIES\r\n  }\r\n\r\n  static properties = {\r\n    storage: {},\r\n    color: { ...color },\r\n    colorFilter: { ...color, attribute: 'filter-color' },\r\n    colorHead: { ...color, attribute: 'head-color' },\r\n    colorSelect: { ...color, attribute: 'select-color' },\r\n    colorSort: { ...color, attribute: 'sort-color' },\r\n    stripedColumn: { type: Boolean, attribute: 'striped-column' },\r\n    cssFilter: { attribute: 'css-filter' },\r\n    cssHeader: { attribute: 'css-header' },\r\n    divider: { type: Boolean },\r\n    striped: { type: Boolean },\r\n    hover: { type: Boolean },\r\n    small: { type: Boolean },\r\n    grid: { type: Boolean },\r\n    borderless: { type: Boolean },\r\n\r\n    sort: { type: Array, state: true },\r\n    columns: { type: Array, state: true },\r\n    key: { type: Number, state: true },\r\n    data: { type: Array },\r\n    \r\n    datacolumn: { type: Boolean },\r\n    multisort: { type: Boolean },\r\n    multiselect: { type: Boolean },\r\n    protected: { type: Boolean },\r\n    selectable: { type: Boolean },\r\n    toggle: { type: Boolean },\r\n    sortable: { type: Boolean },\r\n  }\r\n\r\n  #config = [];\r\n  #sortOrder = [];\r\n  #auto = false;\r\n\r\n  constructor() {\r\n    super();\r\n    this.headColor = 'secondary';\r\n    this.colorSelect = 'info';\r\n    this.columns = [];    \r\n    this.data = [];\r\n    this.sort = [];\r\n    this.key = 0;\r\n  }\r\n\r\n  get selected() {\r\n    return this.dataController?.selected;\r\n  }\r\n\r\n  set search(val) {\r\n    const me = this;\r\n    if (me.storage && me.dataController) {\r\n      return me.dataController.search = val;\r\n    }\r\n  }\r\n\r\n  connectedCallback() {\r\n    const me = this;\r\n    me.#config = GSItem.proxify(me, GSTableElement.CELLS);\r\n    if (me.columns.length === 0) me.columns = me.#config.map(v => v.name);\r\n    /* TODO - auto storage prevents using plain table with \r\n       columns, data properties programmatically\r\n    if (!me.storage) {      \r\n      me.storage = me.#auto = GSID.next('table-');\r\n    }\r\n    */\r\n    super.connectedCallback();\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    super.disconnectedCallback();\r\n    this.dataController?.clearSelected(this.data);\r\n    this.data = [];\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'user-select-none': me.protected,\r\n      'table': true,\r\n      'table-sm': me.small,\r\n      'table-hover': me.hover,\r\n      'table-striped': me.striped,\r\n      'table-bordered': me.grid,\r\n      'table-borderless': me.borderless,\r\n      'table-striped-columns': me.stripedColumns,\r\n      [`table-${me.color}`]: me.color,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  firstUpdated() {\r\n    this.dataController?.read();\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    const me = this;\r\n    if (me.columns.length != me.sort.length) me.sort = Array(me.columns.length).fill(0);\r\n    if (me.datacolumn && me.data.length > 0) {\r\n      me.columns = me.data[0];\r\n      me.data = me.data.slice(1);\r\n    }\r\n    if (changed.has('multiselect') && !me.multiselect) me.dataController?.clearSelected();\r\n    if (changed.has('selectable') && !me.selectable) me.dataController?.clearSelected();\r\n    if (changed.has('sortable') || changed.has('multisort')) {\r\n      me.sort = Array(me.columns.length).fill(0);\r\n      me.#sortOrder = [];\r\n    }\r\n\r\n    super.willUpdate(changed);\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const headColor = me.colorHead ? `table-${me.colorHead}` : '';\r\n    return html`\r\n      <table  \r\n       dir=\"${ifDefined(me.direction)}\"\r\n       @keyup=\"${me.#onKeyUp}\"\r\n       @keydown=\"${me.#onKeyDown}\"\r\n       class=\"${classMap(me.renderClass())}\">\r\n        <thead class=\"${ifDefined(headColor)}\">\r\n          ${me.#renderFilters()}\r\n          <tr @click=${me.#onSort}>\r\n            ${me.columns.map((entry, index) => me.#renderColumn(entry, index))}\r\n          </tr>\r\n        </thead>\r\n        <tbody @click=${me.#onSelect} @contextmenu=${me.#onSelect} class=\"${me.divider ? 'table-group-divider' : ''}\" role=\"button\">\r\n          ${me.data.map((entry, index) => me.#renderRecord(entry, index))}\r\n          ${me.#renderEmpty()}\r\n        </tbody>\r\n      </table>\r\n      <slot name=\"extra\">${me.#renderHandler()}</slot>\r\n    `;\r\n  }\r\n\r\n  #renderHandler() {\r\n    const me = this;\r\n    return me.#auto ? html`<gs-data-handler type=\"cached\" mode=\"\" id=${me.#auto} generated></gs-data-handler>` : '';\r\n  }\r\n\r\n  onDataRead(data) {\r\n    const me = this;\r\n    me.data = data;\r\n    //me.dataController?.clearSelected();\r\n\r\n    // update filtering\r\n    if (data.length > 0 && me.#hasFilters) {\r\n      me.#config.forEach((entry, index) => {\r\n        entry.columnType = me.#columType(index);\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear table filters\r\n   */\r\n  clear() {\r\n    this.#input.forEach(el => el.value = '');\r\n    this.dataController?.filter([]);\r\n  }\r\n\r\n  valueAt(row, cell) {\r\n    return this.data.length > row ? this.data[row][cell] : undefined;\r\n  }\r\n\r\n  get #input() {\r\n    return this.queryAll('th > input, th > select', true, true);\r\n  }\r\n\r\n  get #hasFilters() {\r\n    return this.#config.filter(o => o.filter).length > 0;\r\n  }\r\n\r\n  #columType(index) {\r\n    const me = this;\r\n    const cfg = me.#config[index];\r\n    const cell = me.valueAt(0, me.columns[index]);\r\n    cfg.type = cfg.type || 'text';\r\n    const cfgType = { 'string': 'text', 'currency': 'number', 'timestamp': 'datetime-local' }[cfg.type]\r\n    const dataType = cell instanceof Date ? 'date' : typeof cell;\r\n    return cell ? dataType : cfgType || cfg.type;\r\n  }\r\n\r\n  #renderFilters() {\r\n    const me = this;\r\n    return me.#hasFilters ? html`<tr>${me.columns.map((entry, index) => me.#renderFilter(entry, index))}</tr>` : '';\r\n  }\r\n\r\n  #renderFilter(cell, index) {\r\n    const me = this;\r\n    const cfg = me.#config[index];\r\n    if (!cfg?.filter) return html`<th></th>`;\r\n\r\n    let mask = undefined;\r\n    const hasSub = cfg.childElementCount > 0;\r\n    const isDate = cfg.columnType === 'date';\r\n    if (isDate) mask = cfg.format || GSUtil.getDateFormat(cfg.language || GSUtil.language);\r\n    const css = `${GSUtil.normalize(me.cssFilter)} ${GSUtil.normalize(cell.cssFilter)}`; \r\n    const color = `text-bg-${GSUtil.normalize(cell.color || me.colorFilter)}`; \r\n    \r\n\r\n    if ((hasSub || cfg.list) && cfg.fixed) {\r\n      return html`<th .index=${index} @change=\"${me.#onFilter}\">\r\n          <select is=\"gs-ext-select\" .index=${index}\r\n              class=\"form-select ${css} ${color}\" \r\n              name=\"${cell}\"\r\n              storage=\"${ifDefined(cfg.list ? me.storage : null)}\"\r\n              key=\"${ifDefined(cfg.list ? cfg.name : null)}\"> \r\n              ${me.#renderOption(cfg)}\r\n              </select>\r\n          </th>`;\r\n    }\r\n\r\n    let listid = '';\r\n    let list = undefined;\r\n    if (hasSub || cfg.list) {\r\n      listid = `${me.id}-list-${index}`;\r\n      list = html`<datalist id=\"${listid}\" is=\"gs-ext-datalist\"\r\n              storage=\"${ifDefined(cfg.list ? me.storage : null)}\"\r\n              key=\"${ifDefined(cfg.list ? cfg.name : null)}\"> \r\n              ${me.#renderOption(cfg)}</datalist>`;\r\n    } \r\n\r\n    return html`<th .index=${index} @change=\"${me.#onFilter}\">\r\n    <input is=\"gs-ext-input\" .index=${index}\r\n      class=\"form-control ${css} ${color}\" \r\n      mask=\"${ifDefined(mask)}\"\r\n      list=\"${ifDefined(listid)}\"\r\n      name=\"${cell}\" \r\n      placeholder=\"${ifDefined(cfg.title)}\" \r\n      type=\"${cfg.filterType || cfg.columnType}\"\r\n      data-slots=\"${ifDefined(isDate ? 'DMY' : undefined)}\"/>\r\n    ${list}\r\n    </th>`;\r\n  }\r\n\r\n  #renderOption(cfg) {\r\n    if (cfg.childElementCount == 0) return '';\r\n    const sub = GSItem.proxify(cfg);\r\n    return sub.map(el => html`<option value=\"${el.value}\">${cfg.fixed ? el.map : ''}</option>`);\r\n  }\r\n\r\n  #renderColumn(cell, index) {\r\n    const me = this;\r\n    const cfg = me.#config[index];\r\n    if (cfg?.hidden) return '';\r\n    const css = `${GSUtil.normalize(me.cssHeader)} ${GSUtil.normalize(cell.cssHeader)}`; \r\n    return html`\r\n      <th .index=${index} class=\"${css}\" \r\n        colspan=\"${ifDefined(cfg?.colspan)}\"\r\n        width=\"${ifDefined(cfg?.width)}\">\r\n        <div class=\"d-flex justify-content-between\"> \r\n          <span>${cfg?.title || cell}</span>\r\n          ${me.#renderIcon(index)}\r\n        </div>\r\n      </th>\r\n    `\r\n  }\r\n\r\n  #renderIcon(index) {\r\n    const me = this;\r\n    if (!me.sortable) return '';\r\n    const icons = GSTableElement.#icons;\r\n    const sortType = me.sort[index];\r\n    const order = me.multisort ? me.#sortOrder.indexOf(index) + 1 : '';\r\n    return html`<gs-icon name=\"${icons[sortType + 1]}\" super=\"${order > 0 ? order : ''}\" color=\"${ifDefined(me.colorSort)}\"></gs-icon>`;\r\n  }\r\n\r\n  #renderRecord(entry, index) {\r\n    const me = this;\r\n    const controller = me.dataController || DataSelector;\r\n    const selected = controller?.isSelected(entry);\r\n    const color = me.colorSelect && selected ? `table-${me.colorSelect}` : '';\r\n    const cells = me.#remapRecord(entry);\r\n    return html`\r\n        <tr .index=${index} class=\"${color}\" tabindex=\"0\" ?selected=${selected}>\r\n          ${cells.map((cell, i) => me.#renderCell(cell, i))}\r\n        </tr>\r\n      `;\r\n  }\r\n\r\n  #renderCell(cell, index) {\r\n    const cfg = this.#config[index];\r\n    if (cfg?.hidden) return '';\r\n    return html`<td class=\"text-${cfg?.align}\" colspan=\"${ifDefined(cfg?.colspan)}\" ><span>${cell}</span></td>`;\r\n  }\r\n\r\n  #remapRecord(record) {\r\n    const me = this;\r\n    if (!Array.isArray(record)) record = me.columns.map(v => record[v]);\r\n    return record.map((val, i) => me.#config[i] ? GSData.format(me.#config[i], val) : val);\r\n  }\r\n\r\n  #renderEmpty() {\r\n    const me = this;\r\n    return me.data.length > 0 ?  '' :\r\n    html`<tr data-ignore=\"true\"><td colspan=\"${me.columns.length}\" class=\"text-center fw-bold text-muted\">${me.translate('No Data')}</td></tr>`;\r\n  }\r\n\r\n  #elementTofilter(el) {\r\n    if (!el.value) return undefined;\r\n    const isDate = el.type === 'date';\r\n    const val = isDate ? el.valueAsDate : el.value;\r\n    const cfg = this.#config[el.index];\r\n    return { name: el.name, value: val, language : cfg?.language };\r\n  }\r\n\r\n  #onFilter(e) {\r\n    \r\n    const me = this;\r\n    \r\n    const filter = me.#input\r\n      .map(el => me.#elementTofilter(el))\r\n      .filter(el => el?.value);\r\n\r\n    if (me.storage) {\r\n      me.dataController?.filter(filter);\r\n    } else {\r\n      // TODO keep full data, use sorted\r\n      // GSData.filter(me.data, filter);\r\n    }\r\n  }  \r\n\r\n  #onSort(e) {\r\n    \r\n    const me = this;\r\n    \r\n    if (!me.sortable) return;\r\n    \r\n    const icon = e.target.tagName === 'GS-ICON' ? e.target : e.target.closest('gs-icon');\r\n    const column = e.target.closest('th');\r\n    if (!icon || !column) return;\r\n\r\n    const idx = column.index !== undefined ? column.index : GSDOM.getElementIndex(column);\r\n    const current = me.sort[idx];\r\n    const sortType = current === 1 ? -1 : current + 1;\r\n\r\n    if (me.multisort) {\r\n      if (sortType == 0) {\r\n        me.#sortOrder = me.#sortOrder.filter(v => v != idx);\r\n      } else if (!me.#sortOrder.includes(idx)) {\r\n        me.#sortOrder.push(idx);\r\n      }\r\n    } else {\r\n      me.sort = Array(me.columns.length).fill(0);\r\n      me.#sortOrder = [idx];\r\n    }\r\n\r\n    me.sort[idx] = sortType;\r\n\r\n    const sort = me.#prepareSorter(me.sort, me.#sortOrder);\r\n\r\n    if (me.storage) {\r\n      me.dataController?.sort(sort);\r\n    } else {\r\n      me.data = GSData.sortData(me.data, sort);\r\n    }\r\n\r\n    me.emit('sort');\r\n  }\r\n\r\n  #prepareSorter(sort, sortOrder) {\r\n    \r\n    const me = this;\r\n\r\n    if (sort.filter(v => v).length === 0) {\r\n      sort = Array(me.columns.length).fill(0);\r\n      sort[me.key] = 1;\r\n    }\r\n\r\n    // if data record is object (not simple array)\r\n    const isComplex = me.data[0] && !Array.isArray(me.data[0]);\r\n\r\n    // sort list \r\n    const list = sort.map((v, i) => v ? { name: isComplex ? me.columns[i] : undefined, col: i, ord: v, idx: sortOrder.indexOf(i) } : null).filter(v => v);\r\n\r\n    // order sort list by idx\r\n    sort = GSData.sortData(list, [{ name: 'idx', ord: 1 }]);\r\n\r\n    return sort;\r\n  }\r\n\r\n  #onSelect(e) {\r\n    \r\n    const me = this;\r\n    \r\n    if (!me.selectable) return;\r\n    \r\n    const tr = e.target.tagName === 'TR' ? e.target : e.target.closest('tr');\r\n    if (!tr) return;\r\n    \r\n    // if context menu is attached and right click made\r\n    if (e.button === 2 && !me.query('gs-context', false, true)) return;\r\n    \r\n    const controller = me.dataController || DataSelector;\r\n    if (!controller) return;\r\n\r\n    const record = me.data[tr.index];\r\n    const isSelected = controller.isSelected(record);\r\n    if (me.multiselect) {\r\n      if (isSelected) {\r\n        controller.removeSelected(record);\r\n      } else {\r\n        controller.addSelected(record);\r\n      }\r\n    } else if (me.toggle) {\r\n      controller.clearSelected(me.data);\r\n      if (!isSelected) {\r\n        controller.addSelected(record);\r\n      }\r\n    } else {\r\n      controller.clearSelected(me.data);\r\n      controller.addSelected(record);\r\n    }\r\n    me.requestUpdate();\r\n    me.emit('select');\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n\r\n    if (!e.target.matches('tbody tr')) return;\r\n    let el = null;\r\n\r\n    switch (e.code) {\r\n      case 'ArrowUp':\r\n        el = e.target.previousElementSibling;\r\n        break;\r\n      case 'ArrowDown':\r\n        el = e.target.nextElementSibling;\r\n        break;\r\n    }\r\n\r\n    if (el) {\r\n      el.focus();\r\n      this.emit('focus', el);\r\n    }\r\n  }\r\n\r\n  #onKeyUp(e) {\r\n    if (e.code === 'Space') this.#onSelect(e);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-table');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSTag class\r\n * @module components/GSTag\r\n */\r\n\r\nimport { createRef, ref, classMap, css, html, ifDefined } from '../lib.mjs';\r\nimport { stringArrayConverter, color } from '../properties/index.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSItem } from '../base/GSItem.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\n\r\n/**\r\n * Tag list element\r\n * \r\n * @class\r\n * @extends {GSTagElement}\r\n */\r\nexport default class GSTagElement extends GSElement {\r\n\r\n    static #KEYS = ['Enter', 'NumpadEnter', 'Comma', 'Space'];\r\n\r\n    static styles = css`\r\n        .tag-input:focus-visible {\r\n            outline:none;\r\n        }\r\n        .tag .btn-close {\r\n            background: none;\r\n        }            \r\n        .tag .btn-close::after {\r\n            content: 'x';\r\n        }`;\r\n\r\n    static properties = {\r\n        placeholder: {},\r\n        max: { type: Number },\r\n        size: { type: Number },\r\n        name: {},\r\n        data: { type: Array },\r\n        values: { type: Array, reflect: true, converter: stringArrayConverter },\r\n        appendable: { type: Boolean },\r\n        color: { ...color },\r\n        closeColor: { ...color, attribute: 'close-color' },\r\n        cssClose: { attribute: 'css-close' },\r\n        cssTag: { attribute: 'css-tag' },\r\n    }\r\n\r\n    // GS-ITEM attributes mapping\r\n    static options = {\r\n        name: {}\r\n    }\r\n\r\n    #dataListRef = createRef();\r\n    #inputRef = createRef();\r\n\r\n    constructor() {\r\n        super();\r\n        this.name = '';\r\n        this.data = this.#items;\r\n        this.closeColor = 'light';\r\n        this.color = 'primary';\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        const tags = me.#renderTags();\r\n        return html`\r\n        <div  dir=\"${ifDefined(me.direction)}\" \r\n            class=\"${classMap(me.renderClass())}\"\r\n            @click=\"${me.#onClick.bind(me)}\">\r\n            ${tags}\r\n            <input type=\"text\" \r\n            @keydown=\"${me.#onKeyDown.bind(me)}\"\r\n            @input=\"${me.#onInput.bind(me)}\"\r\n            ${ref(me.#inputRef)}\r\n            name=\"${me.name}\" \r\n            list=\"${me.name}_list\"\r\n            class=\"form-control d-flex w-auto flex-grow-1\" \r\n            placeholder=\"${me.#info}\">\r\n            <datalist ${ref(me.#dataListRef)} id=\"${me.name}_list\">${me.#renderList()}</datalist>\r\n        </div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            \"d-flex\": true,\r\n            \"flex-wrap\": true,\r\n            \"align-items-center\": true,\r\n            \"gap-1 \": true,\r\n        }\r\n        return css;\r\n    }\r\n\r\n    get #info() {\r\n        const me = this;\r\n        const alt = me.max > 0 ? `Add max ${me.max} tags...` : '';\r\n        return me.placeholder ? me.placeholder : alt;\r\n    }\r\n\r\n    #onInput(e) {\r\n        if (!e.inputType) this.#updateTag(e);\r\n    }\r\n\r\n    #onKeyDown(e) {\r\n        if (GSTagElement.#KEYS.includes(e.code)) this.#updateTag(e);\r\n    }\r\n\r\n    #onClick(e) {\r\n        const isClose = e.srcElement === e.target && e.target instanceof HTMLButtonElement;\r\n        if (isClose) this.#removeTag(e.target.parentElement);\r\n    }\r\n\r\n    #updateTag(e) {\r\n        GSEvents.prevent(e);\r\n        const me = this;\r\n        me.#addTag(me.#selected);\r\n    }\r\n\r\n    get #isMax() {\r\n        const me = this;\r\n        return me.max > 0 && me.data.length >= me.max;\r\n    }\r\n\r\n    get #options() {\r\n        return Array.from(this.#datalist.children);\r\n    }\r\n\r\n    get #selected() {\r\n        const me = this;\r\n        return me.#options.filter(el => el.value.toLowerCase() === me.#input.value.toLowerCase()).pop();\r\n    }\r\n\r\n    #addTag(optEl) {\r\n        const me = this;\r\n        const fld = me.#input;\r\n        if (me.#isMax || (!optEl && me.appendable == false)) {\r\n            fld.value = '';\r\n            return;\r\n        }\r\n        if (!me.values.includes(fld.value)) {\r\n            me.values.push(fld.value);\r\n            fld.value = '';\r\n            me.requestUpdate();\r\n        }\r\n    }\r\n\r\n    #removeTag(tagEl) {\r\n        if (!tagEl) return;\r\n        const me = this;\r\n        const value = tagEl.dataset.value;\r\n        me.values = me.values.filter(v => v != value);\r\n    }\r\n\r\n    #renderTags() {\r\n        const me = this;\r\n        return me.values.map(v => me.#renderTag(v));\r\n    }\r\n\r\n    #renderTag(val = '') {\r\n        if (!val) return '';\r\n        const me = this;\r\n        const size = me.size > 0 ? `fs-${me.size}` : '';\r\n        return html`<div class=\"${classMap(me.#tagClass)}\" data-value=\"${val}\">${val}<button type=\"button\" class=\"${classMap(me.#btnClass)}\"></button></div>`;\r\n    }\r\n\r\n    get #tagClass() {\r\n        const me = this;\r\n        const opt = {\r\n            badge: true,\r\n            tag: true,\r\n            [`fs-${me.size}`]: me.size > 0,\r\n            [`text-bg-${me.color}`]: me.color ? true : false\r\n        }\r\n        return me.mapCSS(me.cssTag, opt);\r\n    }\r\n\r\n    get #btnClass() {\r\n        const me = this;\r\n        const opt = {\r\n            'btn-close': true,\r\n            'ms-1': true,\r\n            [`text-bg-${me.closeColor}`]: me.closeColor ? true : false\r\n        }\r\n        return me.mapCSS(me.cssClose, opt);\r\n    }\r\n\r\n    #renderList() {\r\n        const me = this;\r\n        return me.data.map(v => html`<option value=\"${v}\">`);\r\n    }\r\n\r\n    /**\r\n     * Proxify GS-ITEM elements to easily read attributes\r\n     */\r\n    #proxify(root) {\r\n        return GSItem.collect(root).map(el => GSAttr.proxify(el));\r\n    }\r\n\r\n    get #items() {\r\n        return this.#proxify(this).map(el => el.name).filter(v => v ? true : false);\r\n    }\r\n\r\n    get #input() {\r\n        return this.#inputRef.value;\r\n    }\r\n\r\n    get #datalist() {\r\n        return this.#dataListRef.value;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-tag');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\nexport class GSTextElement extends GSElement {\r\n\r\n  #text = \"\";\r\n\r\n  constructor() {\r\n    super();\r\n    this.flat = true;\r\n    this.#text = this.innerText;\r\n    this.innerText = \"\";\r\n  }\r\n\r\n  renderUI() {\r\n    return this.translate(this.#text);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-text');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, ref, classMap, html, ifDefined } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { placement } from '../properties/index.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\nimport { GSPopper } from '../base/GSPopper.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\n\r\nexport class GSTooltipElement extends GSElement {\r\n\r\n  static properties = {\r\n    placement: { ...placement },\r\n    title: {},\r\n    target: {},\r\n    opened: { type: Boolean },\r\n    local: { type: Boolean },\r\n  }\r\n\r\n  #arrowRef = createRef();\r\n  #panelRef = createRef();\r\n  #styleID = GSID.id;\r\n  #arrowStyle = GSID.id;\r\n\r\n  constructor() {\r\n    super();\r\n    this.placement = 'top';\r\n    this.dynamicStyle(this.#styleID);\r\n    this.dynamicStyle(this.#arrowStyle);\r\n  }\r\n\r\n  firstUpdated(changed) {\r\n    super.connectedCallback();\r\n    const me = this;\r\n    me.#attachEvents();\r\n    me.#reposition();\r\n    super.firstUpdated(changed);\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    this.#reposition();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`\r\n    <div ${ref(me.#panelRef)} \r\n      dir=\"${ifDefined(me.direction)}\"\r\n      role=\"tooltip\"\r\n      data-popper-placement=\"${me.placement}\"\r\n      data-gs-class=\"${me.#styleID}\"\r\n      class=\"${classMap(me.renderClass())}\">\r\n      <div ${ref(me.#arrowRef)} \r\n          class=\"tooltip-arrow ${me.#arrowStyle}\" \r\n          data-gs-class=\"${me.#arrowStyle}\">\r\n      </div>\r\n      <div class=\"tooltip-inner\">${me.translate(me.title)}</div>\r\n    </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'tooltip': true,\r\n      'bs-tooltip-auto': true,\r\n      'fade': true,\r\n      'show': me.opened,\r\n      [me.#styleID]: true\r\n    }\r\n    return css;\r\n  }\r\n\r\n  open() {\r\n    this.opened = true;\r\n  }\r\n\r\n  close() {\r\n    this.opened = false;\r\n  }\r\n\r\n  toggle() {\r\n    this.opened = !this.opened;\r\n  }\r\n\r\n  #attachEvents() {\r\n    const me = this;\r\n    me.attachEvent(me.#ref, 'mouseenter', me.open.bind(me));\r\n    me.attachEvent(me.#ref, 'mouseleave', me.close.bind(me));\r\n  }\r\n\r\n  #reposition() {\r\n    const me = this;\r\n    const arrowEl = me.#arrow;\r\n    const panelEl = me.#panel;\r\n    if (!panelEl) return;\r\n    if (me.opened) {\r\n      GSPopper.popupFixed(me.placement, panelEl, me.#ref, arrowEl);\r\n    } else {\r\n      me.dynamicStyle(me.#styleID, { top: '-1000px', left: '-1000px' });\r\n    }\r\n  }\r\n\r\n  get #ref() {\r\n    const me = this;\r\n    switch (me.target) {\r\n      case '@parent':\r\n        return this.parentElement;\r\n      case '@previous':\r\n        return this.previousElementSibling;\r\n      case '@next':\r\n        return this.nextElementSibling;\r\n      default:\r\n        return me.local ? me.#refLocal : me.#refGlobal;\r\n    }\r\n  }\r\n\r\n  get #refLocal() {\r\n    const root = GSDOM.root(this);\r\n    return GSDOM.query(root, this.target);\r\n  }\r\n  \r\n  get #refGlobal() {\r\n    return GSDOM.query(document.body, this.target);\r\n  }\r\n\r\n  get #arrow() { return this.#arrowRef.value; }\r\n  get #panel() { return this.#panelRef.value; }\r\n\r\n  static {\r\n    this.define('gs-tooltip');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { notEmpty } from '../properties/index.mjs';\r\n\r\nexport class GSTemplateElement extends GSElement {\r\n\r\n  static properties = {\r\n    src: { reflect: true, hasChanged: notEmpty }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  createRenderRoot() {\r\n    const me = this;\r\n    if (me.flat) {\r\n      me.renderOptions.renderBefore = me;\r\n      return me.parentElement;\r\n    }\r\n    return super.createRenderRoot();\r\n  }\r\n\r\n  renderUI() {\r\n    return html`${this.renderTemplate()}`;\r\n  }\r\n\r\n\ttemplateInjected() {\r\n\t\tthis.emit('template-injected', null, true, true);\r\n\t}\r\n\r\n  static {\r\n    this.define('gs-template');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../../../base/GSUtil.mjs\";\r\n\r\n/**\r\n * Handle automatic field value copy and select\r\n */\r\nexport class CopySelectController {\r\n\r\n  #host;\r\n\r\n  #clickCallback;\r\n  #copyCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#clickCallback = me.onClick.bind(me);\r\n    me.#copyCallback = me.onCopy.bind(me);\r\n    host.addController?.(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.#host.on?.('click', me.#clickCallback);\r\n    me.#host.on?.('copy', me.#copyCallback);\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController?.(me);\r\n    me.#host.off?.('click', me.#clickCallback);\r\n    me.#host.off?.('copy', me.#copyCallback);\r\n  }\r\n\r\n  onCopy(e) {\r\n    GSUtil.writeToClipboard(this.#host.value);\r\n  }\r\n\r\n  onClick(e) {\r\n      const me = this;\r\n      if (me.#host.autocopy) me.onCopy(e);\r\n      if (me.#host.autoselect) me.#host.select();\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../../../base/GSUtil.mjs\";\r\n\r\n\r\n/**\r\n * Handle field mask \r\n */\r\nexport class MaskController {\r\n\r\n  static #special = '.^$*+?()[]{}\\|';\r\n\r\n  static #maskType = {\r\n    x: /[0-9a-fA-F]/g,\r\n    n: /[0-9]/g,\r\n    y: /[0-9]/g,\r\n    m: /[0-9]/g,\r\n    d: /[0-9]/g,\r\n    h: /[0-9]/g,\r\n    s: /[0-9]/g,\r\n    '.': /[0-9]/g,\r\n    '#': /[a-zA-Z]/g,\r\n    '*': /[0-9a-zA-Z]/g,\r\n    '_': /./g\r\n  };\r\n\r\n  #back = false;\r\n  #slots;\r\n  #prev;\r\n  #first;\r\n  #accept;\r\n  #pattern;\r\n\r\n  #host;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    me.initRules();\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n  }\r\n\r\n  initRules() {\r\n    const me = this;\r\n    if (!me.pattern) return;\r\n    me.#slots = me.#buildSlots();\r\n    me.#prev = (j => Array.from(me.pattern, (c, i) => me.#slots.has(c) ? j = i + 1 : j))(0);\r\n    me.#first = [...me.pattern].findIndex(c => me.#slots.has(c));\r\n    me.#accept = me.#buildAccept();\r\n    me.#toPattern();\r\n  }\r\n\r\n  validate() {  \r\n    const me = this;  \r\n    const isMatch = me.isEmpty ? true :me.isMatch;\r\n    me.setCustomValidity(isMatch ? '' : 'Mask not matched!');\r\n    return isMatch;\r\n  }\r\n\r\n  setCustomValidity(val) {\r\n    return this.#host.setCustomValidity(val);\r\n  }\r\n    \r\n  setSelectionRange(i, j) {\r\n    this.#host.setSelectionRange(i, j);\r\n  }\r\n\r\n  select() {\r\n    this.#host.select();\r\n  }\r\n\r\n  get isEmpty() {\r\n    return GSUtil.isStringEmpty(this.raw);\r\n  }\r\n\r\n  get isValid() {\r\n    return this.#host.validity.valid;\r\n  }\r\n\r\n  get disabled() {\r\n    return this.#host.disabled;\r\n  }\r\n\r\n  get required() {\r\n    return this.#host.required;\r\n  }    \r\n\r\n  get value() {\r\n    const [i, j] = this.#range();\r\n    return this.raw.substring(0, j);\r\n  }\r\n\r\n  set value(val) {\r\n    this.#host.value = val;\r\n  }\r\n\r\n  get raw() {\r\n    return this.#host.raw;\r\n  }\r\n\r\n  get required() {\r\n    return this.#host.required;\r\n  }\r\n\r\n  get pattern() {\r\n    return this.#host.mask;\r\n  }\r\n\r\n  get dataset() {\r\n    return this.#host.dataset;\r\n  }\r\n\r\n  get selectionStart() {\r\n    return this.#host.selectionStart;\r\n  }\r\n\r\n  get selectionEnd() {\r\n    return this.#host.selectionEnd;\r\n  }\r\n\r\n  get autoselect() {\r\n    return this.#host.autoselect;\r\n  }\r\n\r\n  get isMatch() {\r\n    const me = this;\r\n\r\n    let isMatch = true;\r\n    if (me.#pattern) {\r\n      me.#pattern.lastIndex = 0;\r\n      isMatch = me.#pattern.test(me.raw);\r\n    }\r\n\r\n    return isMatch;\r\n  }\r\n\r\n  onInput(e) {\r\n    this.#format();\r\n  }\r\n\r\n  onKeyDown(e) {\r\n    const me = this;\r\n    me.#back = e.key === \"Backspace\";\r\n    const isTab = e.key === \"Tab\";\r\n    if (isTab) {\r\n      me.#format();\r\n      me.validate();\r\n    }\r\n  }\r\n\r\n  onFocus(e) {\r\n    const me = this;\r\n    me.#format();\r\n    if (me.autoselect) me.select();\r\n  }\r\n\r\n  onChange(e) {\r\n    const me = this;\r\n    me.#format();\r\n  }\r\n\r\n  onBlur(e) {\r\n    this.validate();\r\n  }\r\n\r\n  /**\r\n   * If data-slots not defined, try to detect automatically\r\n   * @returns \r\n   */\r\n  #buildSlots() {\r\n    const me = this;\r\n    let slots = me.dataset.slots;\r\n    if (!slots) {\r\n      const maskType = MaskController.#maskType;\r\n      slots = [...new Set(me.pattern)]\r\n        .filter(v => maskType[v.toLowerCase()])\r\n        .join('');\r\n    }\r\n    return new Set(slots || \"_\");\r\n  }\r\n\r\n  /**\r\n   * If data-accept not defined, try to detect automatically\r\n   * @returns \r\n   */\r\n  #buildAccept() {\r\n    const me = this;\r\n    let accept = me.dataset.accept;\r\n    if (!accept) {\r\n      const maskType = MaskController.#maskType;\r\n      accept = [...new Set(me.pattern)]\r\n        .map(v => maskType[v.toLowerCase()])\r\n        .filter(v => v);\r\n      if (accept.length > 0) {\r\n        const tmp = {};\r\n        accept.forEach(v => tmp[v.src] = v);\r\n        accept = Object.values(tmp);\r\n        return accept.length === 1 ? accept.pop() : accept;\r\n      }\r\n\r\n    }\r\n    return new RegExp(accept || \"\\\\d\", \"g\");\r\n  }\r\n\r\n  #range() {\r\n    const me = this;\r\n    const value = me.raw;\r\n    return [me.selectionStart, me.selectionEnd].map(i => {\r\n      i = me.#clean(value.slice(0, i)).findIndex(c => me.#slots.has(c));\r\n      return i < 0 ? me.#prev[me.#prev.length - 1] : me.#back ? me.#prev[i - 1] || me.#first : i;\r\n    });\r\n  }\r\n\r\n  #format() {\r\n    const me = this;\r\n    const [i, j] = me.#range();\r\n    const val = me.#clean(me.#host.raw);\r\n    me.value = val.join``;\r\n    me.setSelectionRange(i, j);\r\n    me.#back = false;\r\n  }\r\n\r\n  #clean(input) {\r\n    const me = this;\r\n    input = input.match(me.#accept) || [];\r\n    return Array.from(me.pattern, (c, i) => input[i] === c || me.#slots.has(c) ? input.shift() || c : c);\r\n  }\r\n\r\n  #toPattern() {\r\n\r\n    const me = this;\r\n\r\n    if (me.pattern.length === 0) return;\r\n\r\n    const chars = me.pattern.split('');\r\n    const masks = ['^'];\r\n\r\n    const maskType = MaskController.#maskType;\r\n    const special = MaskController.#special;\r\n\r\n    let cnt = 0;\r\n    chars.forEach((v, i) => {\r\n      const m = me.#slots.has(v) ? maskType[v.toLowerCase()] : null;\r\n      if (!m) {\r\n        if (cnt > 0) masks.push(`{${++cnt}}`);\r\n        cnt = 0;\r\n        if (special.includes(v)) masks.push('\\\\');\r\n        return masks.push(v);\r\n      }\r\n\r\n      chars[i] = new RegExp(m, 'g');\r\n\r\n      if (masks.length === 0) return masks.push(m.source);\r\n\r\n      if (masks[masks.length - 1] === m.source) return cnt++;\r\n\r\n      if (cnt > 0) masks.push(`{${++cnt}}`);\r\n      cnt = 0;\r\n      masks.push(m.source);\r\n    });\r\n\r\n    if (cnt > 0) masks.push(`{${++cnt}}`);\r\n    masks.push('$');\r\n\r\n    me.#pattern = new RegExp(masks.join(''), 'g');\r\n    // me.#max = me.pattern.length;\r\n    // me.#masks = chars;\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../../../base/GSUtil.mjs\";\r\n\r\n/**\r\n * Handle multiple patterns\r\n */\r\nexport class MultipatternController {\r\n\r\n  #host;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n  }\r\n  \r\n  validate() {    \r\n    const me = this;  \r\n    const isMatch = me.isEmpty ? true :me.isMatch;\r\n    me.setCustomValidity(isMatch ? '' : 'Pattern not matched!');\r\n    return isMatch;\r\n  }\r\n\r\n  setCustomValidity(val) {\r\n    return this.#host.setCustomValidity(val);\r\n  }\r\n\r\n  get isEmpty() {\r\n    return GSUtil.isStringEmpty(this.raw);\r\n  }\r\n    \r\n  get isValid() {\r\n    return this.#host.validity.valid;\r\n  }\r\n\r\n  get value() {\r\n    return this.#host.value;\r\n  }\r\n\r\n  set value(val) {\r\n    this.#host.value = val;\r\n  }\r\n\r\n  get raw() {\r\n    return this.#host.raw;\r\n  }\r\n\r\n  get required() {\r\n    return this.#host.required;\r\n  }\r\n\r\n  get disabled() {\r\n    return this.#host.disabled;\r\n  }    \r\n\r\n  get dataset() {\r\n    return this.#host.dataset;\r\n  }\r\n\r\n  get patterns() {\r\n    const obj = this.#host.multipattern;\r\n    if (obj instanceof RegExp) return [obj];\r\n    if (Array.isArray(obj)) return obj.filter(o => o instanceof RegExp);\r\n    throw new Error('Invalid multipattern value. Expected RegExp object or array.');\r\n  }\r\n\r\n  get isMatch() {\r\n    const me = this;\r\n    let isMatch = true;\r\n    for (const r of me.patterns) {\r\n      isMatch = r.test(me.value);\r\n      if (isMatch) break;\r\n    }\r\n   \r\n    return isMatch;\r\n  }\r\n\r\n  onKeyDown(e) {\r\n    const isTab = e.key === 'Tab';\r\n    if (isTab) {\r\n      this.validate();\r\n    } \r\n  }\r\n\r\n  onBlur(e) {\r\n    this.validate();\r\n  }\r\n\r\n  onChange(e) {\r\n    this.validate();\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSUtil } from \"../../../base/GSUtil.mjs\";\r\n\r\n/**\r\n * Handle for input type number to support max length entry\r\n */\r\nexport class NumberController {\r\n\r\n  #host;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n  }\r\n\r\n  get maxLength() {\r\n    return GSUtil.asNum(this.#host.maxLength, 0);\r\n  }\r\n\r\n  get value() {\r\n    return this.#host.value;\r\n  }\r\n\r\n  set value(val) {\r\n    this.#host.value = val;\r\n  }\r\n\r\n  get type() {\r\n    return this.#host?.type;\r\n  }\r\n    \r\n  onInput(e) {\r\n    const me = this;\r\n    if (me.type === 'number') {\r\n      if (me.maxLength > 0 && me.value.length > me.maxLength) {\r\n          me.value = me.value.substring(0, me.maxLength);\r\n      }\r\n    }\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Handle for input tpye password to support keyboard shortcut for password reveal.\r\n */\r\nexport class PasswordController {\r\n\r\n  #host;\r\n\r\n  #revealing = false;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n  }\r\n\r\n  get reveal() {\r\n    return this.#host.reveal;\r\n  }\r\n\r\n  get type() {\r\n    return this.#host?.type;\r\n  }\r\n\r\n  set type(val) {\r\n    if (this.#host) this.#host.type = val;\r\n  }\r\n\r\n  #isReveal(e) {\r\n    return this.reveal && e.key === 'Shift' && e.altKey && e.ctrlKey && e.shiftKey && this.type === 'password';\r\n  }\r\n\r\n  onKeyUp(e) {\r\n    const me = this;\r\n    if (e.key === 'Shift' && me.#revealing) {\r\n      me.type = 'password';\r\n    }\r\n  }\r\n\r\n  onKeyDown(e) {\r\n    const me = this;\r\n    if (me.#isReveal(e)) {\r\n      me.#revealing = true;\r\n      me.type = 'text';\r\n    }\r\n  }\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSCSSMap } from \"../../../base/GSCSSMap.mjs\";\r\nimport { GSUtil } from \"../../../base/GSUtil.mjs\";\r\n\r\n/**\r\n * Handle for input type text to support text value changes based on CSS\r\n */\r\nexport class TextController {\r\n\r\n  #host;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n  }\r\n\r\n  get raw() {\r\n    return this.#host.raw;\r\n  }\r\n\r\n  get value() {\r\n    return this.#host.value;\r\n  }\r\n\r\n  set value(val) {\r\n    this.#host.value = val;\r\n  }\r\n\r\n  get type() {\r\n    return this.#host?.type;\r\n  }\r\n\r\n  onInput(e) {\r\n    const input = e.target;\r\n    const start = input.selectionStart;\r\n    const end = input.selectionEnd;\r\n    input.value = this.#transform();\r\n    input.setSelectionRange(start, end);\r\n  }\r\n\r\n  onChange(e) {\r\n    this.value = this.#transform();\r\n  }\r\n\r\n  onBlur(e) {\r\n    this.value = this.#transform();\r\n  }\r\n\r\n  #transform() {\r\n    const me = this;\r\n    if (me.type === 'text') {\r\n      const map = GSCSSMap.styleValue(this.#host, 'text-transform');\r\n      if (map) return GSUtil.textTransform(map.value, me.raw);\r\n    }\r\n    return me.value;\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSAttr } from \"../../../base/GSAttr.mjs\";\r\nimport { GSDOM } from \"../../../base/GSDOM.mjs\";\r\nimport { GSEvents } from \"../../../base/GSEvents.mjs\";\r\n\r\n/**\r\n * Handle data filtering for options atribute (combo and data lists)\r\n * Changes in one field list, updates available selections in another field selections.\r\n * \r\n * Options element data-* attributes matching other elements changes \r\n * \"disabled\" attribute for fields, and visibility for non field elements.\r\n * \r\n * NOTE: This applies only for \"gs-form\" or \"form\" child elements.\r\n */\r\nexport class InteractiveController {\r\n\r\n  #host;\r\n\r\n  #monitorCallback;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#monitorCallback = me.#onMonitor.bind(me);\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n    const me = this;\r\n    const list = me.list;\r\n    if (list) {\r\n      me.#host.attachEvent(me.filter, 'change', me.#monitorCallback);\r\n    }\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host.removeEvent(me.filter, 'change', me.#monitorCallback);\r\n  }\r\n\r\n  hostUpdated() {\r\n    // trigger only first time\r\n    if (!this.#host.hasUpdated) {\r\n      this.onChange();\r\n    }\r\n  }\r\n\r\n  get component() {\r\n    return this.#host\r\n  }\r\n\r\n  get value() {\r\n    return this.#host.value;\r\n  }\r\n\r\n  set value(val) {\r\n    this.#host.value = val;\r\n  }\r\n\r\n  get list() {\r\n    return this.#host;\r\n  }\r\n\r\n  get filter() {\r\n    const me = this;\r\n    const filter = GSAttr.get(me.#host, 'data-filter');\r\n    return GSDOM.getByID(me.owner, filter);\r\n  }\r\n\r\n  get owner() {\r\n    //return this.#host.owner;\r\n    return this.#host.form || GSDOM.closest(this.#host, 'form');\r\n  }\r\n\r\n  get formElements() {\r\n    return GSDOM.formElements(this.owner, true);\r\n  }\r\n\r\n  get strict() {\r\n    return GSAttr.get(this.#host, 'strict', '');\r\n  }\r\n\r\n  onBlur(e) {\r\n    if (!this.#isInList()) GSEvents.send(this.#host, 'strict', { ok: false, source: e });\r\n  }\r\n\r\n  onChange(e) {\r\n\r\n    const me = this;\r\n    const own = me.owner;\r\n    let clean = false;\r\n    let opt = GSDOM.query(me.list, `option[value=\"${me.value}\"]`);\r\n    if (!opt) {\r\n        opt = me.list?.querySelector('option');\r\n        clean = true;\r\n    }\r\n\r\n    const obj = opt?.dataset || {};\r\n    Object.entries(obj).forEach(p => {\r\n        const val = clean ? '' : p[1];\r\n        const key = p[0];\r\n        if (key === 'id' || key === 'group') {\r\n          GSAttr.set(me.#host, `data-${key}`, p[1]);\r\n          return;\r\n        } \r\n\r\n        const filter = `[data-${key}]:not([data-${key}=\"\"]`;\r\n        const els = Array.from(GSDOM.queryAll(own, filter));\r\n        els.filter(el => el.tagName !== 'OPTION')\r\n            .filter(el => el.tagName !== 'GS-ITEM')\r\n            .filter(el => el !== me.#host)\r\n            .filter(el => el !== me.filter) \r\n            .filter(v => GSDOM.closest(v, 'gs-form-group') ? false: true ) \r\n            //.filter(el => GSAttr.get(el, 'list').length === 0)\r\n            .forEach(el => me.#togleEl(el, key, val))\r\n    });\r\n  }\r\n\r\n  #onMonitor(e) {\r\n    const me = this;\r\n    const list = me.list;\r\n    me.value = '';\r\n    me.#host.disabled = false;\r\n    const dataGroup = GSAttr.get(me.filter, 'data-group');\r\n    const filter = dataGroup ? `option[data-group=\"${dataGroup}\"]` : `option[data-id=\"${e.target.value}\"]`;\r\n    GSDOM.queryAll(list, 'option').forEach(el => me.#togleOption(el, true));\r\n    GSDOM.queryAll(list, filter).forEach(el => me.#togleOption(el, false));\r\n\r\n  }\r\n\r\n  #togleOption(el, value) {\r\n      GSAttr.toggle(el, 'disabled', value);\r\n      GSDOM.toggleClass(el, 'd-none', value);\r\n  }\r\n\r\n  #togleEl(el, key = '', value = '') {\r\n\r\n    const data = GSAttr.get(el, `data-${key}`, '').split(/[,;;]/);\r\n    const isMatch = value.length > 0 && data.includes(value);\r\n    const frmel = GSDOM.isFormElement(el) || GSDOM.isButtonElement(el) || el.tagName === \"GS-FORM-GROUP\";\r\n\r\n    if (frmel) {\r\n      GSAttr.toggle(el, 'disabled', !isMatch);\r\n    } else {\r\n      isMatch ? GSDOM.show(el) : GSDOM.hide(el);\r\n    }\r\n\r\n    //this.formElements.forEach(el => GSAttr.set(el, 'data-ignore', isMatch ? null : true));\r\n    GSAttr.set(el, 'data-ignore', isMatch ? null : true);\r\n    GSDOM.queryAll(el, 'input,textarea,select').forEach(el => GSAttr.set(el, 'data-ignore', isMatch ? null : true));\r\n  }\r\n\r\n  #isInList() {\r\n    const me = this;\r\n    const list = me.list;\r\n    if (!list) return true;\r\n    if (!me.strict) return true;\r\n    if (!list.querySelector('option')) return true;\r\n    const opt = list.querySelector(`option[value=\"${me.value}\"]`);\r\n    return opt != null;\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { InteractiveController } from \"./InteractiveController.mjs\";\r\n\r\n\r\n/**\r\n * Handle data filtering for list atribute, and linked fields.\r\n * Changes in one field list, update available selections in another field selections.\r\n */\r\nexport class ComboController extends InteractiveController {\r\n\r\n  constructor(host) {\r\n    super(host);\r\n  }\r\n\r\n  get list() {\r\n    return this.component;\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSAttr } from \"../../../base/GSAttr.mjs\";\r\nimport { GSDOM } from \"../../../base/GSDOM.mjs\";\r\nimport { InteractiveController } from \"./InteractiveController.mjs\";\r\n\r\n/**\r\n * Handle data filtering for list atribute, and linked fields.\r\n * Changes in one field list, update available selections in another field selections.\r\n */\r\nexport class ListController extends InteractiveController {\r\n\r\n  constructor(host) {\r\n    super(host);\r\n  }\r\n\r\n  get list() {\r\n    const me = this;\r\n    if (me.component.list) return me.component.list;\r\n    const list = GSAttr.get(me.component, 'list');\r\n    return GSDOM.getByID(me.owner, list);\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSBeep } from \"../../../base/GSBeep.mjs\";\r\nimport { GSDOM } from \"../../../base/GSDOM.mjs\";\r\nimport { GSEvents } from \"../../../base/GSEvents.mjs\";\r\nimport { GSUtil } from \"../../../base/GSUtil.mjs\";\r\n\r\n\r\n/**\r\n * Handle for input/textarea to support validity checkups\r\n */\r\nexport class ValidityController {\r\n\r\n  #host = undefined;\r\n  #processing = false;  \r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#processing = false;\r\n    me.#host = host;\r\n    host.addController?.(me);\r\n  }\r\n\r\n  hostConnected() {\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController?.(me);\r\n    me.#host = undefined;\r\n    me.#processing = false;\r\n  }\r\n  \r\n  get autoreport() {\r\n    return this.#host.autoreport;\r\n  }\r\n\r\n  get autovalidate() {\r\n    return this.#host.autovalidate;\r\n  }\r\n\r\n  get isValid() {\r\n    return this.#host.validity.valid;\r\n  }\r\n\r\n  get disabled() {\r\n    return this.#host.disabled;\r\n  }\r\n\r\n  get required() {\r\n    return this.#host.required;\r\n  }  \r\n\r\n  get value() {\r\n    return this.#host.value;\r\n  }\r\n\r\n  get beep() {\r\n    return this.#host.beep;\r\n  }\r\n\r\n  get block() {\r\n    return this.#host.block;\r\n  }\r\n\r\n  get timeout() {\r\n    return this.#host.timeout;\r\n  }\r\n\r\n  get isVisible() {\r\n    return GSDOM.isVisible(this.#host);\r\n  }\r\n\r\n  validate() {\r\n    const me = this;    \r\n    const sts = me.isValid || me.disabled;\r\n    me.#togglUI(sts);\r\n    return sts;\r\n  }  \r\n    \r\n  onFocus(e) {\r\n    this.validate();\r\n  }\r\n\r\n  onKeyDown(e) {\r\n    const me = this;\r\n    const isTab = e.key === 'Tab';\r\n    if (isTab && !me.validate()) {\r\n        me.#onBlock(e);\r\n        me.#report();\r\n    }\r\n  }\r\n\r\n  onInvalid(e) {\r\n    this.validate();\r\n  }\r\n\r\n  onChange(e) {\r\n    this.#onAutoValidity(e);    \r\n  }\r\n\r\n  onBlur(e) {\r\n    const me = this;\r\n    me.#onBlock(e);\r\n    me.#onAutoValidity(e);\r\n  }\r\n\r\n  #onBlock(e) {    \r\n    const me = this;\r\n    if (me.isValid) return;\r\n    if (me.isVisible && me.block) {\r\n      GSEvents.prevent(e, false, true, false);\r\n      me.#focus();\r\n    }        \r\n  }\r\n\r\n  #onAutoValidity(e) {\r\n    return this.autoreport ? this.#reportValidity() : this.autovalidate ? this.#checkValidity() : this.validate();\r\n  }  \r\n\r\n  #focus() {\r\n    return this.#host.focus();\r\n  }\r\n\r\n  #checkValidity() {\r\n    const me = this;  \r\n    me.validate();\r\n    return me.#host.checkValidity();\r\n  }\r\n\r\n  #reportValidity() {\r\n    const me = this;  \r\n    me.validate();\r\n    return me.#host.reportValidity();\r\n  }  \r\n\r\n  async #report() {    \r\n    const me = this;\r\n    if (me.#processing || me.isValid || !me.isVisible) return;\r\n    me.#processing = true;\r\n    if (me.beep) {\r\n      try {\r\n        await me.#beep();\r\n        await GSUtil.timeout(me.timeout);\r\n      } catch (e) {\r\n        console.error(e);\r\n      }\r\n    }\r\n    me.#processing = false;\r\n  }\r\n\r\n  #togglUI(isValid) {\r\n    const me = this;\r\n    requestAnimationFrame(() => {\r\n      GSDOM.toggleClass(me.#host, 'is-invalid', !isValid);\r\n    });\r\n  }\r\n\r\n  #beep() {\r\n    return GSBeep.beep(100, 1200, 150, 'triangle');\r\n  }\r\n\r\n}  ","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSDOM } from \"../../base/GSDOM.mjs\";\r\nimport { GSEvents } from \"../../base/GSEvents.mjs\";\r\nimport { GSElement } from \"../../GSElement.mjs\";\r\n\r\n/*\r\n* Shared event handling extensions\r\n*/\r\nconst EventsMixin = {\r\n\r\n  [Symbol.for('gs-owner')]() {\r\n    const own = GSDOM.root(this);\r\n    return GSDOM.unwrap(own);\r\n  },\r\n\r\n  /**\r\n   * Get parent GS-* component\r\n   */\r\n  [Symbol.for('gs-parent')]() {\r\n    return GSDOM.parentAll(this).filter(x => x instanceof GSElement).next()?.value;\r\n  },\r\n\r\n  ////////////////////////////////////////////////////////////////////////\r\n  // cross shadow query\r\n\r\n  /**\r\n   * Find closest top element by CSS selector\r\n   * @param {String} query \r\n   * @returns {HTMLElement}\r\n   */\r\n  closest(query = '') {\r\n    return GSDOM.closest(this, query);\r\n  },\r\n\r\n  /**\r\n   * Find element by CSS selector (top level is this element)\r\n   * @param {String} name \r\n   * @returns {HTMLElement}\r\n   */\r\n  query(query = '', shadow = false) {\r\n    return GSDOM.query(this, query, false, shadow);\r\n  },\r\n\r\n  /**\r\n   * Find multiple elements by CSS selector (top level is this element)\r\n   * @param {String} query \r\n   * @returns {Array<HTMLElement>}\r\n   */\r\n  queryAll(query = '', shadow = false) {\r\n    return GSDOM.queryAll(this, query, false, shadow);\r\n  },\r\n\r\n\r\n  ////////////////////////////////////////////////////////////////////////\r\n  // event handling helpers\r\n\r\n  /**\r\n   * Generic component signal\r\n   * @param {Boolean} bubbles  Does buuble to upper nodes\r\n   * @param {Boolean} composed Does traverse from shadow DOM \r\n   */\r\n  notify(bubbles = true, composed = false, data) {\r\n    this.emit('notify', data, bubbles, composed, true);\r\n  },\r\n\r\n  /**\r\n   * Send event\r\n   * @param {String} name \r\n   * @param {Object} obj \r\n   * @param {Boolean} bubbles \r\n   * @param {Boolean} composed \r\n   * @param {Boolean} cancelable \r\n   */\r\n  emit(name, obj = '', bubbles = false, composed = false, cancelable = false) {\r\n    return GSEvents.send(this, name, obj, bubbles, composed, cancelable);\r\n  },\r\n\r\n  /**\r\n   * Wait for event to happen\r\n   * @async\r\n   * @param {String} name \r\n   * @returns {Promise}\r\n   */\r\n  waitEvent(name = '', timeout = 0) {\r\n    return GSEvents.wait(this, name, timeout);\r\n  },\r\n\r\n  /**\r\n   * Listen once for triggered event\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  once(name, func) {\r\n    return this.listen(name, func, true);\r\n  },\r\n\r\n  /**\r\n   * Alternative function for event listen\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  on(name, func, once = false) {\r\n    return this.listen(name, func, once);\r\n  },\r\n\r\n  /**\r\n   * Alternative function for event unlisten\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  off(name, func) {\r\n    return this.unlisten(name, func);\r\n  },\r\n\r\n  /**\r\n   * Prevent event firing up the DOM tree\r\n   * @param {Event} e \r\n   */\r\n  prevent(e, defaults = true, propagate = true, immediate = true) {\r\n    GSEvents.prevent(e, defaults, propagate, immediate);\r\n  },\r\n\r\n  /**\r\n   * Attach event to this element\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  listen(name, func, once = false) {\r\n    return this.attachEvent(this, name, func, once);\r\n  },\r\n\r\n  /**\r\n   * Remove event from this element\r\n   * @param {String} name  A name of the event\r\n   * @param {Function} func A callback function on event trigger\r\n   * @returns {Boolean}\r\n   */\r\n  unlisten(name, func) {\r\n    return this.removeEvent(this, name, func);\r\n  },\r\n\r\n  /**\r\n  * Generic event listener appender\r\n  * \r\n  * @param {HTMLElement} el Element on which to monitor for named events\r\n  * @param {String} name Event name to watch for\r\n  * @param {Function} fn Event trigger callback\r\n  * @param {Boolean} once Listen only once\r\n  * @returns {Boolean} State if attachment was successful\r\n  */\r\n  attachEvent(el, name = '', fn, once = false) {\r\n    return GSEvents.attach(this, el, name, fn, once);\r\n  },\r\n\r\n  /**\r\n  * Generic event listener remove\r\n  * @param {HTMLElement} el Element on which to monitor for named events\r\n  * @param {String} name Event name to watch for\r\n  * @param {Function} fn Event trigger callback\r\n  * @returns {Boolean} State if attachment was successful\t\r\n  */\r\n  removeEvent(el, name = '', fn) {\r\n    return GSEvents.remove(this, el, name, fn);\r\n  }\r\n\r\n  //////////////////////////////////////////////////////////////\r\n\r\n}\r\n\r\n/**\r\n * Function to apply mixin into defiend class\r\n * @param {*} clazz \r\n * @returns \r\n */\r\nexport const mixin = (clazz) => {\r\n  return Object.assign(clazz.prototype || clazz, EventsMixin);\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nexport class FormController {\r\n\r\n  #host = undefined;\r\n  #processing = false;\r\n\r\n  constructor(host) {\r\n    const me = this;\r\n    me.#host = host;\r\n    me.#processing = false;\r\n    host.addController(me);\r\n  }\r\n\r\n  hostConnected() {\r\n\r\n  }\r\n\r\n  hostDisconnected() {\r\n    const me = this;\r\n    me.#host.removeController(me);\r\n    me.#host = undefined;\r\n    me.#processing = false;\r\n  }\r\n\r\n  hostUpdated() {\r\n    // trigger only first time\r\n    if (!this.#host.hasUpdated) {\r\n\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Form reset event\r\n   * @param {*} e \r\n   */\r\n  onReset(Event) {\r\n    const me = this;\r\n\r\n  }\r\n\r\n  /**\r\n   * Form submit event\r\n   * @param {*} e \r\n   */\r\n  onSubmit(Event) {\r\n    const me = this;\r\n\r\n  }\r\n\r\n  /**\r\n   * Event triggered on new FormData(form)\r\n   * @param {Event} e \r\n   */\r\n  onFormData(e) {\r\n    const me = this;\r\n\r\n  }\r\n\r\n  /**\r\n   * Field event propagated to the form\r\n   * @param {Event} e \r\n   */\r\n  onInvalid(e) {\r\n    const me = this;\r\n\r\n  }\r\n\r\n  /**\r\n   * Field event propagated to the form\r\n   * @param {Event} e \r\n   */  \r\n  onChange(e) {\r\n    const me = this;\r\n\r\n  }\r\n\r\n  /**\r\n   * Field event propagated to the form\r\n   * @param {Event} e \r\n   */  \r\n  onBlur(e) {\r\n\r\n  }  \r\n\r\n  get form() {\r\n    return this.#host.form;\r\n  }\r\n\r\n  get inputs() {\r\n    return this.form?.inputs;\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSEvents } from '../../base/GSEvents.mjs';\r\n\r\nimport { ValidityController } from './controllers/ValidityController.mjs';\r\nimport { CopySelectController } from './controllers/CopySelectController.mjs';\r\nimport { PasswordController } from './controllers/PasswordController.mjs';\r\nimport { NumberController } from './controllers/NumberController.mjs';\r\nimport { TextController } from './controllers/TextController.mjs';\r\nimport { ComboController } from './controllers/ComboController.mjs';\r\nimport { FormController } from './controllers/FormController.mjs';\r\nimport { DataController } from \"../../controllers/DataController.mjs\";\r\n\r\n/**\r\n * Helper class wizh shared code for form elements to process controllers.\r\n */\r\nexport class ControllerHandler {\r\n\r\n\r\n  #host = undefined;\r\n  #handlers = undefined;\r\n  #controllers = undefined;\r\n\r\n  #copyselect = undefined;\r\n  #typeController = undefined;\r\n  #validityController = undefined;\r\n  #comboController = undefined;\r\n\r\n  #formController = undefined;\r\n  #dataController = undefined;\r\n\r\n  constructor(host) {\r\n    this.#host = host;\r\n  }\r\n\r\n  connectedCallback() {\r\n    const me = this;\r\n    const host = me.#host;\r\n\r\n    if (me.isForm) {\r\n      host.on('reset', me.#onReset.bind(me));\r\n      host.on('submit', me.#onSubmit.bind(me));\r\n      host.on('formdata', me.#onFormData.bind(me));\r\n    } else {\r\n      host.on('keydown', me.#onKeyDown.bind(me));\r\n      host.on('keyup', me.#onKeyUp.bind(me));\r\n      host.on('input', me.#onInput.bind(me));\r\n      host.on('focus', me.#onFocus.bind(me));\r\n    }\r\n\r\n    // field events catched at the form level also \r\n    host.on('change', me.#onChange.bind(me));\r\n    host.on('blur', me.#onBlur.bind(me));\r\n    host.on('invalid', me.#onInvalid.bind(me));\r\n\r\n    me.#invoke((c) => c.hostConnected?.());\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    const me = this;\r\n    GSEvents.detachListeners(me.#host);\r\n    me.#invoke((c) => c.hostDisconnected?.());\r\n\r\n    me.#controllers?.clear();\r\n\r\n    me.#host = undefined;\r\n    me.#handlers = undefined;\r\n    me.#controllers = undefined;\r\n    me.#comboController = undefined;\r\n\r\n    me.#formController = undefined;\r\n    me.#dataController = undefined;\r\n\r\n    me.#copyselect = undefined;\r\n    me.#typeController = undefined;\r\n    me.#validityController = undefined;\r\n  }\r\n\r\n  hostUpdated(name) {\r\n    const me = this;\r\n    if (!me.#host.hostUpdated) {\r\n      me.#initControllers();\r\n      me.#host.checkValidity?.();\r\n    }\r\n    this.#invoke((c) => c.hostUpdated?.(name));\r\n  }\r\n\r\n  validate() {\r\n    this.#invoke((c) => c.validate?.());\r\n  }\r\n\r\n  addController(controller) {\r\n    if (!controller) return;\r\n    const me = this;\r\n    me.#controllers ??= new Set();\r\n    me.#controllers.add(controller);\r\n    me.#prepare();\r\n    if (me.#host.isConnected) {\r\n      controller.hostConnected?.();\r\n    }\r\n  }\r\n\r\n  removeController(controller) {\r\n    const me = this;\r\n    me.#controllers?.delete(controller);\r\n    me.#prepare();\r\n  }\r\n\r\n  #prepare() {\r\n    const me = this;\r\n    me.#handlers = me.#controllers ? Array.from(me.#controllers).reverse() : [];\r\n  }\r\n\r\n  #invoke(callback) {\r\n    if (typeof callback === 'function') {\r\n      this.#handlers?.forEach(callback);\r\n    }\r\n  }\r\n\r\n  validate(e) {\r\n    return this.#handlers ? this.#handlers.every(c => c.validate ? c.validate(e) : true) : true;\r\n  }\r\n\r\n  #onInvalid(e) {\r\n    this.#invoke(c => c.onInvalid?.(e));\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n    this.#invoke(c => c.onKeyDown?.(e));\r\n  }\r\n\r\n  #onKeyUp(e) {\r\n    this.#invoke(c => c.onKeyUp?.(e));\r\n  }\r\n\r\n  #onInput(e) {\r\n    this.#invoke(c => c.onInput?.(e));\r\n  }\r\n\r\n  #onFocus(e) {\r\n    this.#invoke(c => c.onFocus?.(e));\r\n  }\r\n\r\n  #onChange(e) {\r\n    this.#invoke(c => c.onChange?.(e));\r\n  }\r\n\r\n  #onBlur(e) {\r\n    this.#invoke(c => c.onBlur?.(e));\r\n  }\r\n\r\n  #onReset(e) {\r\n    this.#invoke(c => c.onReset?.(e));\r\n  }\r\n  \r\n  #onSubmit(e) {\r\n    this.#invoke(c => c.onSubmit?.(e));\r\n  }\r\n  \r\n  #onFormData(e) {\r\n    this.#invoke(c => c.onFormData?.(e));\r\n  }\r\n\r\n  #initControllers() {\r\n    const me = this;\r\n    const host = me.#host;\r\n\r\n    if (me.isForm) {\r\n      me.#formController ??= new FormController(host);\r\n    } else {\r\n      me.#validityController ??= new ValidityController(host);\r\n      if (me.isInput) me.#initIinputControllers();\r\n      if (me.isTextArea) me.#initTextAreaControllers();\r\n      if (me.isSelect) me.#comboController ??= new ComboController(host);\r\n    }\r\n\r\n    if (host.storage) {\r\n      if (me.isSelect || me.isDataList ) {\r\n        me.#dataController ??= new DataController(host);\r\n      }\r\n    }\r\n  }\r\n\r\n  #initTextAreaControllers() {\r\n      const me = this;\r\n      const host = me.#host;\r\n      me.#typeController ??= new TextController(host);\r\n      me.#copyselect ??= new CopySelectController(host);\r\n  }\r\n\r\n  #initIinputControllers() {\r\n    const me = this;\r\n    const host = me.#host;\r\n    let ok = false;\r\n    switch (host.type) {\r\n      case 'text':\r\n        ok = true;\r\n        me.#typeController ??= new TextController(host);\r\n        break;\r\n      case 'password':\r\n        ok = true;\r\n        me.#typeController ??= new PasswordController(host);\r\n        break;\r\n      case 'number':\r\n        ok = true;\r\n        me.#typeController ??= new NumberController(host);\r\n        break;\r\n    }\r\n    if (ok) {\r\n      me.#copyselect ??= new CopySelectController(host);\r\n    }\r\n  }\r\n\r\n  get tagName() {\r\n    return this.#host?.tagName;\r\n  }\r\n\r\n  get isForm() {\r\n    return (this.tagName === 'FORM');\r\n  }\r\n\r\n  get isTextArea() {\r\n    return (this.tagName === 'TEXTAREA');\r\n  }\r\n\r\n  get isInput() {\r\n    return (this.tagName === 'INPUT');\r\n  }\r\n\r\n  get isSelect() {\r\n    return (this.tagName === 'SELECT');\r\n  }\r\n\r\n  get isDataList() {\r\n    return (this.tagName === 'DATALIST');\r\n  }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDataListExt class\r\n * @module components/ext/GSDataListExt\r\n */\r\n\r\nimport { ButtonTypes } from '../../properties/index.mjs';\r\nimport { GSDOM } from \"../../base/GSDOM.mjs\";\r\nimport { GSEvents } from \"../../base/GSEvents.mjs\";\r\nimport { mixin } from \"./EventsMixin.mjs\";\r\nimport { GSAttr } from '../../base/GSAttr.mjs';\r\nimport { GSFunction } from '../../base/GSFunction.mjs';\r\n\r\n/**\r\n * Add JSON loader to select element\r\n * <textarea is=\"gs-ext-textarea\"></textarea>\r\n * \r\n * [{text:'', value:'' selected:true}]\r\n * \r\n * @class\r\n * @extends { HTMLButtonElement }\r\n */\r\nexport class GSExtButtonElement extends HTMLButtonElement {\r\n\r\n    static {\r\n        mixin(GSExtButtonElement);\r\n        GSDOM.define('gs-ext-button', GSExtButtonElement, { extends: 'button' });\r\n        Object.seal(GSExtButtonElement);\r\n    }\r\n\r\n    static get observedAttributes() {\r\n        return ['disabled'];\r\n    }\r\n\r\n    #hasUpdated = false;\r\n    #controllerHandler = undefined;\r\n    #formEl = undefined;\r\n\r\n    constructor() {\r\n        super();\r\n        //this.#controllerHandler = ???\r\n    }\r\n\r\n    connectedCallback() {\r\n        const me = this;\r\n        me.#controllerHandler?.connectedCallback();\r\n        me.#formEl = me.form;\r\n        me.#preupdate();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        const me = this;\r\n        GSEvents.detachListeners(me);\r\n        me.#controllerHandler?.disconnectedCallback();\r\n        me.#controllerHandler = undefined;\r\n        me.#formEl = undefined;\r\n    }\r\n\r\n    attributeChangedCallback(name, oldValue, newValue) {\r\n        const me = this;\r\n        me.#preupdate(name);\r\n        me.willUpdate(name, oldValue, newValue);\r\n        me.#controllerHandler?.hostUpdated(name);\r\n    }\r\n\r\n    #preupdate(name) {\r\n        const me = this;\r\n        if (!me.#hasUpdated) {\r\n            me.firstUpdated(name);\r\n            me.#controllerHandler?.hostUpdated(name);\r\n            me.#hasUpdated = true;\r\n        }\r\n    }\r\n\r\n    firstUpdated(changed) {\r\n        const me = this;\r\n        const form = me.#formEl;\r\n        if (me.isSubmit && form) {\r\n            me.attachEvent(form, 'change', me.#onFormState.bind(me));\r\n            me.attachEvent(form, 'invalid', me.#onFormState.bind(me));\r\n            const callback = me.#onClick.bind(me);\r\n            const clickFn = me.rateLimit > 0 ? GSFunction.debounce(callback, me.rateLimit, true) : callback;\r\n            me.on('click', clickFn);\r\n        }\r\n    }\r\n\r\n    willUpdate(changed, oldValue, newValue) {\r\n        if (changed === 'disabled') {\r\n            this.emit('disabled', this.disabled, true, true, true);\r\n        }\r\n    }\r\n\r\n    addController(controller) {\r\n        this.#controllerHandler?.addController(controller);\r\n    }\r\n\r\n    removeController(controller) {\r\n        this.#controllerHandler?.removeController(controller);\r\n    }\r\n\r\n    get owner() {\r\n        return this[Symbol.for('gs-owner')]();\r\n    }\r\n\r\n    get parentComponent() {\r\n        return this[Symbol.for('gs-parent')]();\r\n    }\r\n\r\n    get hasUpdated() {\r\n        return this.#hasUpdated;\r\n    }\r\n\r\n    get form() {\r\n        const me = this;\r\n        return super.form || me.owner?.form || me.closest?.('form');\r\n    }\r\n\r\n    get isSubmit() {\r\n        return ButtonTypes.isSubmit(this.type);\r\n    }\r\n\r\n    get isReset() {\r\n        return ButtonTypes.isReset(this.type);\r\n    }\r\n\r\n    /**\r\n     * Limit button click rate ini milliseconds.\r\n     * If set to 0, no limit is applied.\r\n     */\r\n    get rateLimit() {\r\n        return GSAttr.getAsNum(this, 'rate-limit', 0);\r\n    }\r\n\r\n    /**\r\n     * If the button is part fo the form, check if form is valid\r\n     * ba iterating all field elements and checkin it's validity state.\r\n     * If not part of the form, always return true.\r\n     * We use basic functionality, to support native non-extended form also\r\n     */\r\n    get isValid() {\r\n        const elements = this.#formEl?.elements;\r\n        return elements ? Array.from(elements)\r\n            .filter(el => GSDOM.isFormElement(el))\r\n            .filter(el => el.validity?.valid === false)\r\n            .length === 0\r\n            : true;\r\n    }\r\n\r\n    /**\r\n     * If form is available, monitor elements change events\r\n     * and validate form for validity to update disabled state button[type=\"submit\"]\r\n     * \r\n     * @param {*} e \r\n     */\r\n    #onFormState(e) {\r\n        const me = this;\r\n        if (me.#formEl && me.isSubmit) {\r\n            me.disabled = me.isValid === false;\r\n        }\r\n    }\r\n\r\n    #onClick(e) {\r\n        const me = this;\r\n        if (me.#formEl && me.isSubmit) {\r\n            if (me.isValid) {\r\n                if (me.isSubmit) me.#formEl.requestSubmit();\r\n                if (me.isReset) me.#formEl.reset();\r\n            } else {\r\n                GSEvents.prevent(e);\r\n                me.disabled = true;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSDOM } from '../../base/GSDOM.mjs';\r\nimport { GSEvents } from '../../base/GSEvents.mjs';\r\n\r\nimport { MaskController } from './controllers/MaskController.mjs';\r\nimport { MultipatternController } from './controllers/MultipatternController.mjs';\r\nimport { ListController } from './controllers/ListController.mjs';\r\nimport { GSAttr } from '../../base/GSAttr.mjs';\r\nimport { GSUtil } from '../../base/GSUtil.mjs';\r\nimport { ControllerHandler } from './ControllerHandler.mjs';\r\nimport { mixin } from './EventsMixin.mjs';\r\n\r\n\r\n/**\r\n * Extended HTMLInputElement with controllers support\r\n * adding various features such as masked input support \r\n */\r\nexport class GSExtInputElement extends HTMLInputElement {\r\n\r\n  static {\r\n    mixin(GSExtInputElement);\r\n    GSDOM.define('gs-ext-input', GSExtInputElement, { extends: 'input' });\r\n    Object.seal(GSExtInputElement);\r\n  }\r\n\r\n  static get observedAttributes() {\r\n    // 'autocopy', 'autofocus', 'autoselect', 'autovalidate','autoreport', 'block', 'beep', 'timeout', \r\n    return ['multipattern', 'mask', 'required', 'disabled'];\r\n  }\r\n\r\n  #controllerHandler = undefined;\r\n  #maskController = undefined;\r\n  #patternController = undefined;\r\n  #listController = undefined;\r\n\r\n  #pattern = undefined;\r\n  #hasUpdated = false;\r\n\r\n  constructor() {\r\n    super();\r\n    this.#controllerHandler = new ControllerHandler(this);\r\n  }\r\n\r\n  connectedCallback() {\r\n    const me = this;\r\n    me.#controllerHandler?.connectedCallback();\r\n    me.#preupdate();\r\n    me.dataset.value = me.value;\r\n    me.on('change', e => me.dataset.value = me.value);\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    const me = this;\r\n    me.#controllerHandler?.disconnectedCallback();\r\n    me.#controllerHandler = undefined;\r\n\r\n    me.#maskController = undefined;\r\n    me.#patternController = undefined;\r\n    me.#listController = undefined;\r\n    me.#pattern = undefined;\r\n\r\n    GSEvents.detachListeners(me);\r\n  }\r\n\r\n  attributeChangedCallback(name, oldValue, newValue) {\r\n    const me = this;    \r\n    if (me.isCheckBox && name === 'required' && me.required) return me.required = false;\r\n    me.#preupdate(name);\r\n    me.willUpdate(name, oldValue, newValue);\r\n    me.#controllerHandler?.hostUpdated(name);\r\n  }\r\n\r\n  addController(controller) {\r\n    this.#controllerHandler?.addController(controller);\r\n  }\r\n\r\n  removeController(controller) {\r\n    this.#controllerHandler?.removeController(controller);\r\n  }\r\n\r\n  get owner() {\r\n    return this[Symbol.for('gs-owner')]();\r\n  }\r\n\r\n  /**\r\n   * Get parent GS-* component\r\n   */\r\n  get parentComponent() {\r\n    return this[Symbol.for('gs-parent')]();\r\n  }\r\n\r\n\r\n  get hasUpdated() {\r\n    return this.#hasUpdated;\r\n  }\r\n\r\n  get autocopy() {\r\n    return this.hasAttribute('autocopy');\r\n  }\r\n\r\n  get autofocus() {\r\n    return this.hasAttribute('autofocus');\r\n  }\r\n\r\n  get autoselect() {\r\n    return this.hasAttribute('autoselect');\r\n  }\r\n\r\n  /**\r\n   * If set, autoamtically calls reportValidity\r\n   */\r\n  get autoreport() {\r\n    return this.hasAttribute('autoreport');\r\n  }\r\n\r\n  /**\r\n   * If set, autoamtically calls checkValidity\r\n   */\r\n  get autovalidate() {\r\n    return this.hasAttribute('autovalidate');\r\n  }\r\n\r\n  get beep() {\r\n    return this.hasAttribute('beep');\r\n  }\r\n\r\n  get block() {\r\n    return this.hasAttribute('block');\r\n  }\r\n\r\n  get mask() {\r\n    return GSAttr.get(this, 'mask');\r\n  }\r\n\r\n  get multipattern() {\r\n    return this.#pattern;\r\n    //return GSDOM.getValue(this, 'multipattern');\r\n  }\r\n\r\n  // enable password reveal\r\n  get reveal() {\r\n    return this.hasAttribute('reveal');\r\n  }\r\n\r\n  get timeout() {\r\n    return GSAttr.getAsNum(this, 'timeout', 0);\r\n  }\r\n\r\n  set autocopy(value) {\r\n    GSAttr.toggle(this, 'autocopy', value);\r\n  }\r\n\r\n  set autofocus(value) {\r\n    GSAttr.toggle(this, 'autocopy', value);\r\n  }\r\n\r\n  set autoselect(value) {\r\n    GSAttr.toggle(this, 'autocopy', value);\r\n  }\r\n\r\n  set autoreport(value) {\r\n    GSAttr.toggle(this, 'autoreport', value);\r\n  }\r\n\r\n  set autovalidate(value) {\r\n    GSAttr.toggle(this, 'autovalidate', value);\r\n  }\r\n\r\n  set beep(value) {\r\n    GSAttr.toggle(this, 'beep', value);\r\n  }\r\n\r\n  set block(value) {\r\n    GSAttr.toggle(this, 'block', value);\r\n  }\r\n\r\n  set mask(value) {\r\n    GSAttr.set(this, 'mask', value);\r\n  }\r\n\r\n  set multipattern(value) {\r\n    let data = value;\r\n    // convert to array if not, and stringify if values are regex\r\n    if (GSUtil.isJsonType(value)) {\r\n      const tmp = (Array.isArray(value) ? value : [value]).map(v => v.source || v.toString?.() || v);\r\n      data = JSON.stringify(tmp);\r\n    }\r\n    GSAttr.set(this, 'multipattern', data);\r\n  }\r\n\r\n  /**\r\n   * Useds only on password type to reveal \r\n   * password with key shortcut ctrl-altt-shift\r\n   */\r\n  set reveal(value) {\r\n    if (this.type === 'password') GSAttr.toggle(this, 'reveal', value);\r\n  }\r\n\r\n  set timeout(value) {\r\n    GSAttr.setAsNum(this, 'timeout', value);\r\n  }\r\n\r\n  get required() {\r\n    return super.required;\r\n  }\r\n\r\n  set required(value) {\r\n    super.required = this.isCheckBox ? false : GSUtil.asBool(value);\r\n  }  \r\n\r\n  get raw() {\r\n    return super.value;\r\n  }\r\n\r\n  get value() {\r\n    return this.#maskController ? this.#maskController.value : super.value;\r\n  }\r\n\r\n  set value(val) {\r\n    super.value = this.mask === val ? '' : val;\r\n  }\r\n\r\n  /**\r\n   * Return true if current element or chadow dom child is focused\r\n   */\r\n  get isFocused() {\r\n    return this === document.activeElement;\r\n  }\r\n\r\n  get isCheckBox() {\r\n    return this.type === 'checkbox';\r\n  }\r\n\r\n  get form() {\r\n    const me = this;\r\n    return super.form || me.owner?.form || me.closest?.('form');\r\n  }\r\n\r\n  reset() {\r\n    const me = this;\r\n    me.setCustomValidity('');\r\n    GSDOM.reset(me);\r\n    return me.validate();\r\n  }\r\n\r\n  checkValidity() {\r\n    this.validate();\r\n    return super.checkValidity();\r\n  }\r\n\r\n  reportValidity() {\r\n    this.validate();\r\n    return super.reportValidity();\r\n  }\r\n\r\n  validate(e) {\r\n    return this.#controllerHandler.validate(e);\r\n  }\r\n\r\n  /**\r\n   * Find closest top element by CSS selector\r\n   * @param {String} query \r\n   * @returns {HTMLElement}\r\n   */\r\n  closest(query = '') {\r\n    return GSDOM.closest(this, query);\r\n  }\r\n\r\n\r\n  firstUpdated(changed) {\r\n    const me = this;\r\n    if (me.autofocus) me.focus();\r\n    const data = me.formComponent?.data;\r\n    if (data) GSDOM.fromObject2Element(me, data);\r\n  }\r\n\r\n  willUpdate(changed, oldValue, newValue) {\r\n\r\n    const me = this;\r\n\r\n    if ('mask' === changed) {\r\n      me.#updateMask();\r\n    }\r\n\r\n    if ('multipattern' === changed) {\r\n      me.#updateMultipattern(newValue);\r\n    }\r\n\r\n    if ('list' === changed) {\r\n      me.#updateList();\r\n    }\r\n\r\n    if (changed === 'required' || changed === 'disabled') {\r\n      me.validate();\r\n    }\r\n  }\r\n\r\n  #preupdate(name) {\r\n    const me = this;\r\n    if (!me.#hasUpdated) {\r\n      me.#updateMask();\r\n      me.#updateMultipattern(me.pattern);\r\n      me.#updateList();\r\n      me.firstUpdated(name);\r\n      me.#controllerHandler?.hostUpdated(name);\r\n      me.#hasUpdated = true;\r\n      me.validate();\r\n    }\r\n  }\r\n\r\n  #updateMask() {\r\n    const me = this;\r\n    if (me.mask && me.type === 'text') {\r\n      me.placeholder = me.mask;\r\n      me.#maskController ??= new MaskController(me);\r\n    } else {\r\n      me.removeController(me.#maskController);\r\n      me.#maskController = null;\r\n    }\r\n  }\r\n\r\n  #updateMultipattern(newValue) {\r\n    const me = this;\r\n    if (GSUtil.isJsonString(newValue)) {\r\n      const tmp = GSUtil.toJson(newValue, []);\r\n      me.#pattern = (Array.isArray(tmp) ? tmp : []).map(v => new RegExp(v));\r\n    } else {\r\n      me.#pattern = undefined;\r\n    }\r\n\r\n    const isMulti = Array.isArray(me.#pattern) && me.#pattern.length > 0;\r\n    const isType = ['text', 'password'].includes(me.type);\r\n    if (isMulti && isType) {\r\n      me.#patternController ??= new MultipatternController(me);\r\n    } else {\r\n      me.removeController(me.#patternController);\r\n      me.#patternController = null;\r\n    }\r\n  }\r\n\r\n  #updateList() {\r\n    const me = this;\r\n    if (me.list) {\r\n      me.#listController ??= new ListController(me);\r\n    } else {\r\n      me.removeController(me.#listController);\r\n      me.#listController = null;\r\n    }\r\n  }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDataListExt class\r\n * @module components/ext/GSDataListExt\r\n */\r\n\r\nimport { GSDOM } from \"../../base/GSDOM.mjs\";\r\nimport { GSLoader } from \"../../base/GSLoader.mjs\";\r\nimport { GSEvents } from \"../../base/GSEvents.mjs\";\r\nimport { GSAttr } from \"../../base/GSAttr.mjs\";\r\nimport { ControllerHandler } from \"./ControllerHandler.mjs\";\r\nimport { mixin } from \"./EventsMixin.mjs\";\r\n\r\n/**\r\n * Add JSON loader to select element\r\n * <textarea is=\"gs-ext-textarea\"></textarea>\r\n * \r\n * [{text:'', value:'' selected:true}]\r\n * \r\n * @class\r\n * @extends { HTMLTextAreaElement }\r\n */\r\nexport class GSExtTextAreaElement extends HTMLTextAreaElement {\r\n\r\n    static {\r\n        mixin(GSExtTextAreaElement);\r\n        GSDOM.define('gs-ext-textarea', GSExtTextAreaElement, { extends: 'textarea' });\r\n        Object.seal(GSExtTextAreaElement);\r\n    }\r\n\r\n    #hasUpdated = false;\r\n    #controllerHandler = undefined;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#controllerHandler = new ControllerHandler(this);\r\n    }\r\n\r\n    connectedCallback() {\r\n        const me = this;\r\n        me.#controllerHandler?.connectedCallback();\r\n        me.#preupdate();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        const me = this;\r\n        me.#controllerHandler?.disconnectedCallback();\r\n        me.#controllerHandler = undefined;\r\n        GSEvents.detachListeners(me);\r\n    }\r\n\r\n    attributeChangedCallback(name, oldValue, newValue) {\r\n        const me = this;\r\n        me.#preupdate(name);\r\n        me.willUpdate(name, oldValue, newValue);\r\n        me.#controllerHandler?.hostUpdated(name);\r\n    }\r\n\r\n    #preupdate(name) {\r\n        const me = this;\r\n        if (!me.#hasUpdated) {\r\n            me.firstUpdated(name);\r\n            me.#controllerHandler?.hostUpdated(name);\r\n            me.#hasUpdated = true;\r\n        }\r\n    }\r\n\r\n    firstUpdated(changed) {\r\n        const me = this;\r\n        const data = me.formComponent?.data;\r\n        if (data) GSDOM.fromObject2Element(me, data);\r\n        if (me.autofocus) me.focus();\r\n    }\r\n\r\n    willUpdate(changed, oldValue, newValue) {\r\n        if (changed === 'required' || changed === 'disabled') {\r\n            this.validate();\r\n        }\r\n    }\r\n\r\n    addController(controller) {\r\n        this.#controllerHandler?.addController(controller);\r\n    }\r\n\r\n    removeController(controller) {\r\n        this.#controllerHandler?.removeController(controller);\r\n    }\r\n\r\n    reset() {\r\n        const me = this;\r\n        me.setCustomValidity('');\r\n        GSDOM.reset(me);\r\n        me.validate();\r\n    }\r\n\r\n    checkValidity() {\r\n        this.validate();\r\n        return super.checkValidity();\r\n    }\r\n\r\n    reportValidity() {\r\n        this.validate();\r\n        return super.reportValidity();\r\n    }\r\n\r\n    validate(e) {\r\n        return this.#controllerHandler.validate(e);\r\n    }\r\n\r\n    get owner() {\r\n        return this[Symbol.for('gs-onwner')]();\r\n    }\r\n\r\n    get parentComponent() {\r\n        return this[Symbol.for('gs-parent')]();\r\n    }\r\n\r\n    get hasUpdated() {\r\n        return this.#hasUpdated;\r\n    }\r\n\r\n    /**\r\n     * If set, autoamtically calls reportValidity\r\n     */\r\n    get autoreport() {\r\n        return this.hasAttribute('autoreport');\r\n    }\r\n\r\n    /**\r\n     * If set, automatically calls checkValidity\r\n     */\r\n    get autovalidate() {\r\n        return this.hasAttribute('autovalidate');\r\n    }\r\n\r\n    get autoselect() {\r\n        return this.hasAttribute('autoselect');\r\n    }\r\n\r\n    get autocopy() {\r\n        return this.hasAttribute('autocopy');\r\n    }\r\n\r\n    get block() {\r\n        return this.hasAttribute('block');\r\n    }\r\n\r\n    get beep() {\r\n        return this.hasAttribute('beep');\r\n    }\r\n\r\n    get timeout() {\r\n        return GSAttr.getAsNum(this, 'timeout', 0);\r\n    }\r\n\r\n    set autoreport(value) {\r\n        GSAttr.toggle(this, 'autoreport', value);\r\n    }\r\n\r\n    set autovalidate(value) {\r\n        GSAttr.toggle(this, 'autovalidate', value);\r\n    }\r\n\r\n    set autoselect(value) {\r\n        GSAttr.toggle(this, 'autoselect', value);\r\n    }\r\n\r\n    set autocopy(value) {\r\n        GSAttr.toggle(this, 'autocopy', value);\r\n    }\r\n\r\n    set block(val = false) {\r\n        GSAttr.toggle(this, 'block', val);\r\n    }\r\n\r\n    set beep(val = false) {\r\n        GSAttr.toggle(this, 'beep', val);\r\n    }\r\n\r\n    set timeout(val = 0) {\r\n        return GSAttr.setAsNum(this, 'timeout', val);\r\n    }\r\n\r\n    get form() {\r\n        const me = this;\r\n        return super.form || me.owner?.form || me.closest?.('form');\r\n    }\r\n\r\n    async load(url = '') {\r\n        if (!url) return;\r\n        this.value = await GSLoader.loadSafe(url, 'GET', null, true);\r\n    }\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDataListExt class\r\n * @module components/ext/GSDataListExt\r\n */\r\n\r\nimport { GSDOM } from \"../../base/GSDOM.mjs\";\r\nimport { GSLoader } from \"../../base/GSLoader.mjs\";\r\nimport { GSEvents } from \"../../base/GSEvents.mjs\";\r\nimport { GSAttr } from \"../../base/GSAttr.mjs\";\r\nimport { GSUtil } from \"../../base/GSUtil.mjs\";\r\nimport { mixin } from \"./EventsMixin.mjs\";\r\nimport { GSLog } from \"../../base/GSLog.mjs\";\r\nimport { ControllerHandler } from \"./ControllerHandler.mjs\";\r\n\r\n/**\r\n * Add JSON loader to select element\r\n * <select is=\"gs-ext-select\" data=\"data.json\">\r\n * \r\n * [{text:'', value:'' selected:true}]\r\n * \r\n * @class\r\n * @extends {HTMLSelectElement}\r\n */\r\nexport class GSExtSelectElement extends HTMLSelectElement {\r\n\r\n    static {\r\n        mixin(GSExtSelectElement);\r\n        GSDOM.define('gs-ext-select', GSExtSelectElement, { extends: 'select' });\r\n        Object.seal(GSExtSelectElement);\r\n    }\r\n\r\n    #data = [];\r\n\r\n    #controllerHandler = undefined;\r\n    #hasUpdated = false;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#controllerHandler = new ControllerHandler(this);\r\n    }\r\n\r\n    static get observedAttributes() {\r\n        return ['url'];\r\n    }\r\n\r\n    connectedCallback() {\r\n        const me = this;\r\n        me.#controllerHandler?.connectedCallback();\r\n        me.#preupdate();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        const me = this;\r\n        me.#controllerHandler?.disconnectedCallback();\r\n        me.#controllerHandler = undefined;\r\n        GSEvents.detachListeners(me);\r\n    }\r\n\r\n    attributeChangedCallback(name, oldValue, newValue) {\r\n        const me = this;\r\n        me.#preupdate(name);\r\n        me.willUpdate(name, oldValue, newValue);\r\n        me.#controllerHandler?.hostUpdated(name);\r\n    }\r\n\r\n    #preupdate(name) {\r\n        const me = this;\r\n        if (!me.#hasUpdated) {\r\n            me.firstUpdated(name);\r\n            me.#controllerHandler?.hostUpdated(name);\r\n            me.#hasUpdated = true;\r\n        }\r\n    }\r\n\r\n    firstUpdated(changed) {\r\n        const me = this;\r\n        const data = me.form?.data;\r\n        if (data) GSDOM.fromObject2Element(me, data);\r\n        if (me.autofocus) me.focus();\r\n        me.on('reset', me.#onReset);\r\n    }\r\n\r\n    willUpdate(changed, oldValue, newValue) {\r\n\r\n        if (changed === 'url') this.load(newValue);\r\n        if (changed === 'required' || changed === 'disabled') {\r\n            this.validate();\r\n        }\r\n    }\r\n\r\n    addController(controller) {\r\n        this.#controllerHandler?.addController(controller);\r\n    }\r\n\r\n    removeController(controller) {\r\n        this.#controllerHandler?.removeController(controller);\r\n    }\r\n\r\n    get owner() {\r\n        return this[Symbol.for('gs-owner')]();\r\n    }\r\n\r\n    get parentComponent() {\r\n        return this[Symbol.for('gs-parent')]();\r\n    }    \r\n\r\n    get asJSON() {\r\n        return this.query('option').forEach(el => GSDOM.fromElement2Object(el, {}));\r\n    }\r\n\r\n    set asJSON(data) {\r\n        this.apply(data);\r\n    }\r\n\r\n    /**\r\n     * Storage records key to use to generate unique list\r\n     */\r\n    get key() {\r\n        return GSAttr.get(this, 'key', 0);\r\n    }\r\n\r\n    get storage() {\r\n        return GSAttr.get(this, 'storage');\r\n    }\r\n\r\n    get form() {\r\n        const me = this;\r\n        return super.form || me.owner?.form || me.closest?.('form');\r\n    }\r\n\r\n    /**\r\n     * Support for multiple selections\r\n     */\r\n    get values() {\r\n        return Array.from(this.selectedOptions).map(el => el.value);\r\n    }\r\n\r\n    /**\r\n     * String array ov values to match for selection\r\n     */\r\n    set values(values) {\r\n        values ??= [];\r\n        if (GSUtil.isString(values)) values = values.split(',');\r\n        Array.from(el.options).forEach(el => el.selected = values.indexOf(el.value) > -1);\r\n    }\r\n\r\n    checkValidity() {\r\n        this.validate();\r\n        return super.checkValidity();\r\n    }\r\n\r\n    reportValidity() {\r\n        this.validate();\r\n        return super.reportValidity();\r\n    }\r\n\r\n    validate(e) {\r\n        return this.#controllerHandler.validate(e);\r\n    }\r\n\r\n    reset() {\r\n        GSDOM.resetSelect(this);\r\n    }\r\n        \r\n    /**\r\n     * For DataController read callback\r\n     * Convert record data to html JSON format \r\n     * @param {Array} data \r\n     */\r\n    onDataRead(data = []) {\r\n        const me = this;\r\n        const key = me.key;\r\n        data = Array.isArray(data) ? data : [data];\r\n        data = data.map(o => GSUtil.isString(o) ? o : o[key])\r\n            .filter(v => v)\r\n            .map(v => {return {text: v, value: v}});\r\n        me.apply(data);\r\n    }\r\n\r\n    /**\r\n     * Load html definition in JSON format\r\n     * @param {string} url \r\n     * @returns \r\n     */\r\n    async load(url = '') {\r\n        if (!url) return;\r\n        try {\r\n            const data = await GSLoader.loadSafe(url, 'GET', null, true);\r\n            this.apply(data);\r\n        } catch (error) {\r\n            console.error('Failed to load data:', error);\r\n            GSLog.error(this, error);\r\n        }\r\n    }\r\n\r\n    apply(data) {\r\n\r\n        if (!Array.isArray(data)) return false;\r\n\r\n        const me = this;\r\n\r\n        queueMicrotask(() => {\r\n\r\n            const list = [];\r\n            data.forEach(o => {\r\n                list.push(me.#objToHTML(o));\r\n            });\r\n\r\n            GSDOM.setHTML(me, list.join('\\n'));\r\n        });\r\n        return true;\r\n    }\r\n\r\n    #objToHTML(o) {\r\n        const seg = ['<option'];\r\n\r\n        Object.entries(o).forEach(it => {\r\n            const key = it[0];\r\n            const val = it[1];\r\n            if ('text' === key) return;\r\n            if ('selected' === key) return seg.push(key);\r\n            seg.push(`${key}=\"${val}\"`);\r\n        });\r\n\r\n        seg.push('>')\r\n        seg.push(o.text);\r\n        seg.push('</option>')\r\n\r\n        return seg.join(' ');\r\n    }\r\n\r\n    #onReset(e) {\r\n        this.reset();\r\n    }\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDataListElement class\r\n * @module components/ext/GSDataListElement\r\n */\r\n\r\n\r\nimport { GSID } from \"../../base/GSID.mjs\";\r\nimport { GSDOM } from \"../../base/GSDOM.mjs\";\r\nimport { GSUtil } from \"../../base/GSUtil.mjs\";\r\nimport { GSLoader } from \"../../base/GSLoader.mjs\";\r\nimport { GSEvents } from \"../../base/GSEvents.mjs\";\r\nimport { GSLog } from \"../../base/GSLog.mjs\";\r\nimport { GSAttr } from \"../../base/GSAttr.mjs\";\r\nimport { mixin } from \"./EventsMixin.mjs\";\r\nimport { ControllerHandler } from \"./ControllerHandler.mjs\";\r\n\r\n/**\r\n * Add JSON loader to datalist element\r\n * \r\n * <datalist is=\"gs-datalist\" data=\"data.json\">\r\n * \r\n * [{text:'', value:'' selected:true}]\r\n * \r\n * @class\r\n * @extends {HTMLDataListElement}\r\n */\r\nexport class GSExtDataListElement extends HTMLDataListElement {\r\n\r\n    static {\r\n        mixin(GSExtDataListElement);\r\n        GSDOM.define('gs-ext-datalist', GSExtDataListElement, { extends: 'datalist' });\r\n        Object.seal(GSExtDataListElement);\r\n    }\r\n\r\n    #data = [];\r\n\r\n    #controllerHandler = undefined;\r\n    #hasUpdated = false;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#controllerHandler = new ControllerHandler(this);\r\n    }\r\n\r\n    static get observedAttributes() {\r\n        return ['url'];\r\n    }\r\n\r\n    connectedCallback() {\r\n        const me = this;\r\n        GSID.setIf(me);\r\n        me.#controllerHandler?.connectedCallback();\r\n        me.#preupdate();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        const me = this;\r\n        me.#controllerHandler?.disconnectedCallback();\r\n        me.#controllerHandler = undefined;\r\n        GSEvents.detachListeners(me);\r\n    }\r\n\r\n    attributeChangedCallback(name, oldValue, newValue) {\r\n        const me = this;\r\n        me.#preupdate(name);\r\n        me.willUpdate(name, oldValue, newValue);\r\n        me.#controllerHandler?.hostUpdated(name);\r\n    }\r\n\r\n    #preupdate(name) {\r\n        const me = this;\r\n        if (!me.#hasUpdated) {\r\n            me.firstUpdated(name);\r\n            me.#controllerHandler?.hostUpdated(name);\r\n            me.#hasUpdated = true;\r\n        }\r\n    }\r\n   \r\n    firstUpdated(changed) {\r\n        const me = this;\r\n        if (me.autofocus) me.focus();\r\n        const data = me.form?.data;\r\n        if (data) GSDOM.fromObject2Element(me, data);\r\n    }\r\n\r\n    willUpdate(changed, oldValue, newValue) {\r\n\r\n        if (changed === 'url') this.load(newValue);\r\n        if (changed === 'required' || changed === 'disabled') {\r\n            this.validate();\r\n        }\r\n    }\r\n\r\n    addController(controller) {\r\n        this.#controllerHandler?.addController(controller);\r\n    }\r\n\r\n    removeController(controller) {\r\n        this.#controllerHandler?.removeController(controller);\r\n    }\r\n    \r\n    get owner() {\r\n        return this[Symbol.for('gs-owner')]();\r\n    }\r\n\r\n    get parentComponent() {\r\n        return this[Symbol.for('gs-parent')]();\r\n    }    \r\n\r\n    get asJSON() {\r\n        return this.query('option').forEach(el => GSDOM.fromElement2Object(el, {}));\r\n    }\r\n\r\n    set asJSON(data) {\r\n        this.apply(data);\r\n    }\r\n\r\n    get storage() {\r\n        return GSAttr.get(this, 'storage');\r\n    }\r\n\r\n    /**\r\n     * Storage records key to use to generate unique list\r\n     */\r\n    get key() {\r\n        return GSAttr.get(this, 'key', 0);\r\n    }   \r\n\r\n    /**\r\n     * For DataController read callback\r\n     * Convert record data to html JSON format \r\n     * \r\n     * @param {Array} data \r\n     */\r\n    onDataRead(data = []) {\r\n        const me = this;\r\n        const key = me.key;\r\n        data = Array.isArray(data) ? data : [data];\r\n        data = data.map(o => GSUtil.isString(o) ? o : o[key])\r\n            .filter(v => v)\r\n            .map(v => {return {value: v}});\r\n        me.apply(data);\r\n    }   \r\n\r\n    /**\r\n     * Load html definition in JSON format\r\n     * @param {string} url \r\n     * @returns \r\n     */\r\n    async load(url = '') {\r\n        if (!url) return;\r\n        try {\r\n            const data = await GSLoader.loadSafe(url, 'GET', null, true);\r\n            this.apply(data);\r\n        } catch (error) {\r\n            console.error('Failed to load data:', error);\r\n            GSLog.error(this, error);\r\n        }\r\n    }\r\n\r\n    apply(data) {\r\n\r\n        if (!Array.isArray(data)) return false;\r\n\r\n        const me = this;\r\n\r\n        queueMicrotask(() => {\r\n\r\n            const list = [];\r\n            data.forEach(o => {\r\n                list.push(me.#objToHTML(o));\r\n            });\r\n\r\n            GSDOM.setHTML(me, list.join('\\n'));\r\n        });\r\n        return true;\r\n    }\r\n\r\n    #objToHTML(o) {\r\n        const seg = ['<option'];\r\n\r\n        if (GSUtil.isString(o)) o = { value: o };\r\n\r\n        Object.entries(o).forEach(it => {\r\n            const key = it[0];\r\n            const val = it[1];\r\n            if ('text' === key) return;\r\n            if ('selected' === key) return seg.push(key);\r\n            seg.push(`${key}=\"${val}\"`);\r\n        });\r\n\r\n        if (o.text) {\r\n            seg.push('>')\r\n            seg.push(o.text);\r\n            seg.push('</option>')\r\n        } else {\r\n            seg.push('>')\r\n        }\r\n\r\n        return seg.join(' ');\r\n    }\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSDataListExt class\r\n * @module components/ext/GSDataListExt\r\n */\r\n\r\nimport { GSDOM } from \"../../base/GSDOM.mjs\";\r\nimport { GSEvents } from \"../../base/GSEvents.mjs\";\r\nimport { GSAttr } from \"../../base/GSAttr.mjs\";\r\nimport { ControllerHandler } from \"./ControllerHandler.mjs\";\r\nimport { mixin } from './EventsMixin.mjs';\r\nimport { GSLog } from \"../../base/GSLog.mjs\";\r\nimport { GSLoader } from \"../../base/GSLoader.mjs\";\r\n\r\n/**\r\n * Extended native forn with additional functionality\r\n * \r\n * @class\r\n * @extends { HTMLFormElement }\r\n */\r\nexport class GSExtFormElement extends HTMLFormElement {\r\n\r\n    static {\r\n        mixin(GSExtFormElement);\r\n        GSDOM.define('gs-ext-form', GSExtFormElement, { extends: 'form' });\r\n        Object.seal(GSExtFormElement);\r\n    }\r\n\r\n    static get observedAttributes() {\r\n        return ['disabled', 'url'];\r\n    }\r\n\r\n    #hasUpdated = false;\r\n    #controllerHandler = undefined;\r\n\r\n    constructor() {\r\n        super();\r\n        this.#controllerHandler = new ControllerHandler(this);\r\n    }\r\n\r\n    connectedCallback() {\r\n        const me = this;\r\n        me.#controllerHandler?.connectedCallback?.();\r\n        me.#preupdate();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        const me = this;\r\n        me.#controllerHandler?.disconnectedCallback?.();\r\n        me.#controllerHandler = undefined;\r\n        GSEvents.detachListeners(me);\r\n    }\r\n\r\n    attributeChangedCallback(name, oldValue, newValue) {\r\n        const me = this;\r\n        me.#preupdate(name);\r\n        me.willUpdate(name, oldValue, newValue);\r\n        me.#controllerHandler?.hostUpdated?.(name);\r\n    }\r\n\r\n    #preupdate(name) {\r\n        const me = this;\r\n        if (!me.#hasUpdated) {\r\n            me.firstUpdated(name);\r\n            me.#controllerHandler?.hostUpdated?.(name);\r\n            me.#hasUpdated = true;\r\n        }\r\n    }\r\n\r\n    firstUpdated(changed) {\r\n        const me = this;\r\n        const data = me.formComponent?.data;\r\n        if (data) GSDOM.fromObject2Element(me, data);\r\n        if (me.autofocus) me.focus();\r\n    }\r\n\r\n    willUpdate(changed, oldValue, newValue) {\r\n        const me = this;\r\n        if (changed === 'url') me.load(newValue);\r\n        if (changed === 'disabled') {\r\n            me.disable ? me.disable(true) : me.enable(true);\r\n        }\r\n    }\r\n\r\n    addController(controller) {\r\n        this.#controllerHandler?.addController(controller);\r\n    }\r\n\r\n    removeController(controller) {\r\n        this.#controllerHandler?.removeController(controller);\r\n    }\r\n\r\n    reset() {\r\n        const me = this;\r\n        // reset non shadeowed\r\n        super.reset();\r\n        // reset shadowed\r\n        me.inputs\r\n            .filter(el => GSDOM.isShadowed(el))\r\n            .forEach(el => GSDOM.reset(el));\r\n        me.validate();\r\n    }\r\n\r\n    checkValidity() {\r\n        this.validate();\r\n        return super.checkValidity();\r\n    }\r\n\r\n    reportValidity() {\r\n        this.validate();\r\n        return super.reportValidity();\r\n    }\r\n\r\n    checkValidity() {\r\n        return super.checkValidity() &&\r\n            this.inputs\r\n                .filter(el => !el.disabled)\r\n                .every(el => el.checkValidity());\r\n    }\r\n\r\n    reportValidity() {\r\n        return super.reportValidity() &&\r\n            this.inputs\r\n                .filter(el => !el.disabled)\r\n                .every(el => el.reportValidity());\r\n    }\r\n    /**\r\n     * Validate each individual field, return true only if all fields are valid\r\n     * @returns \r\n     */\r\n    validate(e) {\r\n        return this.inputs\r\n            .filter(el => !el.disabled)\r\n            .every(c => c.validate ? c.validate(e) : true);\r\n    }\r\n\r\n    /**\r\n     * Find field by name\r\n     * @param {*} name \r\n     * @returns \r\n     */\r\n    field(name) {\r\n        return name && this.inputs.filter(f => f.name === name);\r\n    }\r\n\r\n    disable(all = false) {\r\n        GSDOM.disableInput(this, 'input, textarea, select', all, 'gs-ext-form');\r\n        const btn = this.submitButton;\r\n        if (btn) btn.disabled = true;\r\n    }\r\n\r\n    enable(all = false) {\r\n        GSDOM.enableInput(this, 'input, textarea, select', all, 'gs-ext-form');\r\n        const btn = this.submitButton;\r\n        if (btn) btn.disabled = false;\r\n    }\r\n\r\n    async load(url = '') {\r\n        if (!url) return;\r\n        try {\r\n            const data = await GSLoader.loadSafe(url, 'GET', null, true);\r\n            this.onDataRead(data);\r\n        } catch (error) {\r\n            console.error('Failed to load data:', error);\r\n            GSLog.error(this, error);\r\n        }\r\n    }\r\n\r\n    #button(type) {\r\n        return this.queryAll(`button[type=\"${type}\"]`, true);\r\n    }\r\n\r\n    #childrens(shadow = false) {\r\n        return this.queryAll('input,select,output,textarea', shadow);\r\n    }\r\n\r\n    get owner() {\r\n        return this[Symbol.for('gs-owner')]();\r\n    }\r\n\r\n    get parentComponent() {\r\n        return this[Symbol.for('gs-parent')]();\r\n    }    \r\n\r\n    get hasUpdated() {\r\n        return this.#hasUpdated;\r\n    }\r\n\r\n    get asJSON() {\r\n        const data = {};\r\n        this.inputs.forEach(field => GSDOM.fromElement2Object(field, data));\r\n        return data;\r\n    }\r\n\r\n    set asJSON(data) {\r\n        const me = this;\r\n        me.inputs.forEach(field => GSDOM.fromObject2Element(field, data));\r\n        me.validate();\r\n    }\r\n        \r\n    /**\r\n     * If set, autoamtically calls reportValidity\r\n     */\r\n    get autoreport() {\r\n        return this.hasAttribute('autoreport');\r\n    }\r\n\r\n    /**\r\n     * If set, autoamtically calls checkValidity\r\n     */\r\n    get autovalidate() {\r\n        return this.hasAttribute('autovalidate');\r\n    }\r\n\r\n    get block() {\r\n        return this.hasAttribute('block');\r\n    }\r\n\r\n    get beep() {\r\n        return this.hasAttribute('beep');\r\n    }\r\n\r\n    get timeout() {\r\n        return GSAttr.getAsNum(this, 'timeout', 0);\r\n    }\r\n\r\n    set autoreport(value) {\r\n        GSAttr.toggle(this, 'autoreport', value);\r\n    }\r\n\r\n    set autovalidate(value) {\r\n        GSAttr.toggle(this, 'autovalidate', value);\r\n    }\r\n\r\n    set block(val = false) {\r\n        GSAttr.toggle(this, 'block', val);\r\n    }\r\n\r\n    set beep(val = false) {\r\n        GSAttr.toggle(this, 'beep', val);\r\n    }\r\n\r\n    set timeout(val = 0) {\r\n        return GSAttr.setAsNum(this, 'timeout', val);\r\n    }\r\n\r\n    get submitButton() {\r\n        return this.#button('submit');\r\n    }\r\n\r\n    get resetButton() {\r\n        return this.#button('reset');\r\n    }\r\n\r\n    /**\r\n     * Pickup all form elements, including custom ones\r\n     */\r\n    get elements() {\r\n        return super.elements;\r\n    }\r\n\r\n    /**\r\n     * Get all form attached native fields unwrapepd from GSWebComponents\r\n     */\r\n    get fields() {\r\n        return Array.from(this.elements).map(el => el.field || el);\r\n    }\r\n\r\n    /**\r\n     * Find all inputs by querying across inner shadow \r\n     */\r\n    get inputs() {\r\n        return this.#childrens(true);\r\n    }\r\n\r\n    get invalid() {\r\n        return this.inputs\r\n        .filter(el => !el.disabled)\r\n        .filter(el => !el.validity.valid);\r\n    }\r\n\r\n    get isValid() {\r\n        return this.invalid.length === 0;\r\n    }\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { html, ifDefined, repeat } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { color } from '../../properties/color.mjs';\r\n\r\nexport class GSBreadcrumbElement extends GSElement {\r\n\r\n  static properties = {\r\n    storage: {},\r\n    data: { type: Array },\r\n    color: { ...color },\r\n    divider: { reflect: true },\r\n    spacing: { reflect: true, type: Number },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.spacing = 1;\r\n    me.divider = 'chevron-right';\r\n    me.#updateChildren();\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    this.#updateChildren();\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<nav part=\"base\" class=\"breadcrumb\" @click=\"${me.#onClick}\" dir=\"${ifDefined(me.direction)}\"><slot>\r\n      ${repeat(me.data || [], (item) => item, (item) => html`\r\n        <gs-breadcrumb-item  \r\n        href=\"${item.href}\"\r\n        color=\"${item.color}\"\r\n        .data=${item}     \r\n        .active=${item.active}\r\n        .divider=\"${item.divider || me.divider}\"\r\n        .spacing=\"${item.spacing || me.spacing}\">\r\n          ${item.$text}\r\n        </gs-breadcrumb-item>\r\n      `)}\r\n    </slot></nav>`;\r\n  }\r\n\r\n  onDataRead(data) {\r\n    this.data = data;\r\n  }\r\n\r\n  #updateChildren() {\r\n    const me = this;\r\n    me.queryAll('gs-breadcrumb-item').forEach(el => {\r\n      el.divider = me.divider;\r\n      el.spacing = me.spacing;\r\n      el.color = me.color;\r\n    });\r\n  }\r\n\r\n  #onClick(e) {\r\n    const el = e.target.closest('gs-bradcrumb-item');\r\n    el?.handle(e);\r\n  } \r\n\r\n  static {\r\n    this.define('gs-breadcrumb');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { color } from '../../properties/color.mjs';\r\nimport { GSLinklement } from '../Link.mjs';\r\nimport { GSAttributeHandler } from '../../base/GSAttributeHandler.mjs';\r\n\r\nexport class GSBreadcrumbItemElement extends GSElement {\r\n\r\n  static properties = {\r\n    href: {},\r\n    color: { ...color },\r\n    data: { state: true, type: Object },\r\n    active: { reflect: true, type: Boolean },\r\n    divider: { state: true, type: Boolean },\r\n    spacing: { state: true, type: Number },\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.data = {};\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div part=\"base\" class=\"breadcrumb-item ${classMap(me.renderClass())}\"  dir=\"${ifDefined(me.direction)}\">\r\n        <span part=\"prefix\"><slot name=\"prefix\"></slot></span>        \r\n        ${me.#label}\r\n        <span part=\"suffix\"><slot name=\"suffix\"></slot></span>\r\n        <span part=\"separator\"><slot name=\"separator\">${me.#separator}</slot></span>\r\n      </div>`;\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const css = {\r\n      ...super.renderClass(),\r\n      'active': me.active,\r\n    }\r\n    return css;\r\n  }\r\n\r\n  get #label() {\r\n    const me = this;\r\n    if (me.active) return html`<slot></slot>`;\r\n    me.data.url = me.data.url || me.href;\r\n    me.data.part = 'label';\r\n    return GSLinklement.generate(me.data, {})\r\n  }\r\n\r\n  get #separator() {\r\n    const me = this;\r\n    return me.nextElementSibling && me.divider ? html`<gs-icon size=\"7\" color=\"${me.color}\" css=\"mx-${me.spacing}\" name=\"${me.divider}\"></gs-icon>` : '';\r\n  }\r\n\r\n  handle(e) {\r\n    GSAttributeHandler.process(this.query('a', true), e);\r\n  }\r\n\r\n  static {\r\n    this.define('gs-breadcrumb-item');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSAttachment class\r\n * @module components/filebox/GSAttachment\r\n */\r\n\r\n/**\r\n * Handles DataFileTransfer object\r\n * @class\r\n */\r\nexport class GSAttachment {\r\n\r\n    constructor(file, directory) {\r\n        this.file = file;\r\n        this.directory = directory;\r\n    }\r\n\r\n    static traverse(transfer, directory) {\r\n        return GSAttachment.#transferredFiles(transfer, directory);\r\n    }\r\n\r\n    static from(files) {\r\n        return Array.from(files).filter(f => f instanceof File).map(f => new GSAttachment(f));\r\n    }\r\n\r\n    get fullPath() {\r\n        const me = this;\r\n        return me.directory ? `${me.directory}/${me.file.name}` : me.file.name;\r\n    }\r\n\r\n    isImage() {\r\n        return ['image/gif', 'image/png', 'image/jpg', 'image/jpeg', 'image/svg+xml'].includes(this.file.type);\r\n    }\r\n\r\n    isVideo() {\r\n        return ['video/mp4', 'video/quicktime'].includes(this.file.type);\r\n    }\r\n\r\n    static #transferredFiles(transfer, directory) {\r\n        if (directory && GSAttachment.#isDirectory(transfer)) {\r\n            return GSAttachment.#traverse('', GSAttachment.#roots(transfer));\r\n        }\r\n        return Promise.resolve(GSAttachment.#visible(Array.from(transfer.files || [])).map(f => new GSAttachment(f)));\r\n    }\r\n\r\n    static #hidden(file) {\r\n        return file.name.startsWith('.');\r\n    }\r\n\r\n    static #visible(files) {\r\n        return Array.from(files).filter(file => !GSAttachment.#hidden(file));\r\n    }\r\n\r\n    static #getFile(entry) {\r\n        return new Promise(function (resolve, reject) {\r\n            entry.file(resolve, reject);\r\n        });\r\n    }\r\n\r\n    static #getEntries(entry) {\r\n        return new Promise(function (resolve, reject) {\r\n            const result = [];\r\n            const reader = entry.createReader();\r\n            const read = () => {\r\n                reader.readEntries(entries => {\r\n                    if (entries.length > 0) {\r\n                        result.push(...entries);\r\n                        read();\r\n                    } else {\r\n                        resolve(result);\r\n                    }\r\n                }, reject);\r\n            };\r\n            read();\r\n        });\r\n    }\r\n\r\n    static async #traverse(path, entries) {\r\n        const results = [];\r\n        for (const entry of GSAttachment.#visible(entries)) {\r\n            if (entry.isDirectory) {\r\n                const entries = await GSAttachment.#getEntries(entry);\r\n                const list = await GSAttachment.#traverse(entry.fullPath, entries);\r\n                results.push(...(list));\r\n            } else {\r\n                const file = await GSAttachment.#getFile(entry);\r\n                results.push(new GSAttachment(file, path));\r\n            }\r\n        }\r\n        return results;\r\n    }\r\n\r\n    static #isDirectory(transfer) {\r\n        return Array.from(transfer.items).some((item) => {\r\n            const entry = item.webkitGetAsEntry && item.webkitGetAsEntry();\r\n            return entry && entry.isDirectory;\r\n        });\r\n    }\r\n\r\n    static #roots(transfer) {\r\n        return Array.from(transfer.items)\r\n            .map((item) => item.webkitGetAsEntry())\r\n            .filter(entry => entry != null);\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSFileBox class\r\n * @module components/filebox/GSFileBox\r\n */\r\n\r\nimport { classMap, createRef, ref, css, html, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSAttachment } from './Attachment.mjs';\r\nimport { GSEvents } from '../../base/GSEvents.mjs';\r\n\r\n/**\r\n * File box allows drag-n-drop fiels for upload\r\n * <gs-filebox id=\"other\" multiple=\"true\" directory=\"true\" elid=\"test\"></gs-filebox>\r\n * Use event listener to return false for file access filtering\r\n * @class\r\n * @extends {GSElement}\r\n */\r\nexport class GSFileBoxElement extends GSElement {\r\n\r\n    static TITLE = 'Drop file/s here or click to select';\r\n    static CSS = 'border-2 p-4 d-block text-center dash';\r\n\r\n    static properties = {\r\n        cssList: { attribute: 'css-list' },\r\n        cssLabel: { attribute: 'css-label' },\r\n        cssInput: { attribute: 'css-input' },\r\n\r\n        multiple: { reflect: true, type: Boolean },\r\n        directory: { reflect: true, type: Boolean },\r\n        name: {},\r\n        title: {},\r\n        accept: {},\r\n        filter: {},\r\n        maxFileSize: { reflect: true, attribute: 'max-file-size', type: Number }, // New property\r\n    }\r\n\r\n    #listEl = createRef();\r\n    #fileEl = createRef();\r\n    #dragging = null;\r\n\r\n    constructor() {\r\n        super();\r\n        this.css = GSFileBoxElement.CSS;\r\n        this.cssInput = 'd-none';\r\n        this.multiple = true;\r\n        this.title = GSFileBoxElement.TITLE;\r\n        this.filter = '^image\\/(gif|png|jpeg)$'\r\n        this.directory = false;\r\n        this.maxFileSize = 0; // Default to 0, meaning no limit\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`\r\n        <div part=\"border\" class=\"${classMap(me.renderClass())}\"\r\n            dir=\"${ifDefined(me.direction)}\"\r\n            @click=\"${me.#onClick}\"\r\n            @dragenter=\"${me.#onDragenter}\"\r\n            @dragover=\"${me.#onDragenter}\"\r\n            @dragleave=\"${me.#onDragleave}\"\r\n            @drop=\"${me.#onDrop}\"\r\n            @paste=\"${me.#onPaste}\"\r\n            @change=\"${me.#onChange}\">\r\n            <label part=\"label\" class=\"${me.cssLabel}\" for=\"${me.name}\">${me.translate(me.title)}</label>\r\n            <input ${ref(me.#fileEl)}  part=\"input\" \r\n                type=\"file\" accept=\"${me.accept}\" \r\n                class=\"${me.cssInput}\" \r\n                name=\"${me.name}\" \r\n                id=\"${me.name}\" \r\n                ${me.multiple ? \"multiple\" : \"\"} \r\n                ${me.directory ? \"directory webkitdirectory\" : \"\"}>\r\n            <pre ${ref(me.#listEl)} part=\"list\" class=\"${me.cssList}\"></pre>\r\n        </div>\r\n        `\r\n    }\r\n\r\n    get listEl() {\r\n        return this.#listEl.value;\r\n    }\r\n\r\n    get fileEl() {\r\n        return this.#fileEl.value;\r\n    }\r\n\r\n    #onClick(e) {\r\n        this.fileEl.click();\r\n    }\r\n\r\n    #onDragenter(e) {\r\n        const me = this;\r\n        if (me.#dragging) clearTimeout(me.#dragging);\r\n        me.#dragging = setTimeout(() => me.removeAttribute('hover'), 200);\r\n        const transfer = e.dataTransfer;\r\n        if (!transfer || !me.#hasFile(transfer)) return;\r\n        transfer.dropEffect = 'copy';\r\n        me.setAttribute('hover', '');\r\n        e.preventDefault();\r\n    }\r\n\r\n    #onDragleave(e) {\r\n        const me = this;\r\n        if (e.dataTransfer) e.dataTransfer.dropEffect = 'none';\r\n        me.removeAttribute('hover');\r\n        GSEvents.prevent(e);\r\n    }\r\n\r\n    #onDrop(e) {\r\n        const me = this;\r\n        me.removeAttribute('hover');\r\n        const transfer = e.dataTransfer;\r\n        if (!transfer || !me.#hasFile(transfer)) return;\r\n        me.#attach(transfer);\r\n        GSEvents.prevent(e);\r\n    }\r\n\r\n    #onPaste(e) {\r\n        const me = this;\r\n        if (!e.clipboardData) return;\r\n        if (!e.clipboardData.items) return;\r\n        const file = me.#pastedFile(e.clipboardData.items);\r\n        if (!file) return;\r\n        const files = [file];\r\n        me.#attach(files);\r\n        GSEvents.prevent(e);\r\n    }\r\n\r\n    #onChange(e) {\r\n        const me = this;\r\n        const input = me.fileEl;\r\n        const files = input.files;\r\n        if (!files || files.length === 0) return;\r\n        me.#attach(files);\r\n        // input.value = '';\r\n    }\r\n\r\n    #hasFile(transfer) {\r\n        return Array.from(transfer.types).includes('Files');\r\n    }\r\n\r\n    #pastedFile(items) {\r\n        const me = this;\r\n        const rgx = me.filter ? new RegExp(me.filter) : null;\r\n        for (const item of items) {\r\n            if (item.kind === 'file') {\r\n                if (!rgx) return item.getAsFile();\r\n                if (rgx.test(item.type)) return item.getAsFile();\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    #accept(attachments) {\r\n        const me = this;\r\n        const dataTransfer = new DataTransfer();\r\n        attachments.forEach(a => dataTransfer.items.add(a.file))\r\n        me.fileEl.files = dataTransfer.files;\r\n        me.listEl.textContent = attachments.map(a => a.file.name).join('\\n');\r\n    }\r\n\r\n    async #attach(transferred) {\r\n        const me = this;\r\n        const isDataTfr = transferred instanceof DataTransfer;\r\n        const attachments = isDataTfr\r\n            ? await GSAttachment.traverse(transferred, me.directory)\r\n            : GSAttachment.from(transferred);\r\n\r\n        // Filter out files that exceed the maxFileSize\r\n        const validAttachments = me.maxFileSize > 0 \r\n            ? attachments.filter(a => a.file.size <= me.maxFileSize)\r\n            : attachments;\r\n\r\n        const accepted = me.emit('accept', { attachments: validAttachments }, true, false, true);\r\n        if (accepted && validAttachments.length) {\r\n            me.#accept(validAttachments);\r\n            me.emit('accepted', { attachments: validAttachments }, true);\r\n        }\r\n    }\r\n\r\n    static styles = css`\r\n        .dash {\r\n            border-style: var(--gs-fieldbox-border, dashed) !important;\r\n            border-color: var(--gs-fieldbox-border-color, lightgrey);\r\n        }\r\n        input[type=file] {\r\n            color : var(--gs-fieldbox-color, transparent);\r\n        } \r\n        input[type=file]::file-selector-button {}             \r\n        input[type=file]::file-selector-button:hover {}`;\r\n\r\n    static {\r\n        this.define('gs-filebox');\r\n    }\r\n\r\n}\r\n\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSUtil } from '../../base/GSUtil.mjs';\r\n\r\n/**\r\n * A module rendering current time on a page\r\n * @module components/TimeFormat\r\n */\r\n\r\n/**\r\n * Render Time value\r\n * \r\n * @class\r\n * @extends {HTMLElement}\r\n */\r\nexport class GSTimeFormat extends GSElement {\r\n\r\n    static properties = {\r\n        interval: {reflect:true, type:Number},\r\n        language: {reflect:true},\r\n    }\r\n\r\n    #id = 0;\r\n\r\n    constructor() {\r\n        super();\r\n        this.interval = 1;\r\n        this.language = GSUtil.language;\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        this.start();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        this.stop();\r\n        super.disconnectedCallback();\r\n    }\r\n\r\n    renderUI() {\r\n        const date = new Date();\r\n        return date.toLocaleTimeString(this.language);\r\n    }    \r\n\r\n    start() {\r\n        const me = this;\r\n        if (me.interval >0 && me.#id === 0) {\r\n            me.#id = setInterval(me.#update.bind(me), me.interval * 1000);\r\n        } else {\r\n            me.requestUpdate();\r\n        }\r\n    }\r\n\r\n    stop() {\r\n        clearInterval(this.#id);\r\n        this.#id = 0;\r\n    }\r\n    \r\n    #update() {\r\n       requestAnimationFrame(() => this.requestUpdate());\r\n    }\r\n\r\n    static {\r\n        this.define('gs-time-format');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module rendering date with specific langauge support\r\n * @module components/DateFormat\r\n */\r\n\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSDate } from '../../base/GSDate.mjs';\r\n\r\n/**\r\n * Render Date value with international language support\r\n * \r\n * All options - set dasta-[name]; data-weekday etc...\r\n       {\r\n       weekday: 'narrow' | 'short' | 'long',\r\n       era: 'narrow' | 'short' | 'long',\r\n       year: 'numeric' | '2-digit',\r\n       month: 'numeric' | '2-digit' | 'narrow' | 'short' | 'long',\r\n       day: 'numeric' | '2-digit',\r\n       hour: 'numeric' | '2-digit',\r\n       minute: 'numeric' | '2-digit',\r\n       second: 'numeric' | '2-digit',\r\n       timeZoneName: 'short' | 'long',\r\n\r\n       // Time zone to express it in\r\n       timeZone: 'Asia/Shanghai',\r\n       // Force 12-hour or 24-hour\r\n       hour12: true | false,\r\n\r\n       dateStyle: full | long | medium | short\r\n       timeStyle: full | long | medium | short\r\n\r\n       // Rarely-used options\r\n       hourCycle: 'h11' | 'h12' | 'h23' | 'h24',\r\n       formatMatcher: 'basic' | 'best fit'\r\n       }\r\n * @class\r\n * @extends {HTMLElement}\r\n */\r\nexport class GSDateFormat extends GSElement {\r\n\r\n    static properties = {\r\n        value: {},\r\n        format: {},\r\n        language: {},\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.language = navigator.language;\r\n        this.value = new Date();\r\n    }\r\n\r\n    renderUI() {\r\n        return this.result;\r\n    }    \r\n\r\n    get result() {\r\n        const me = this;\r\n        const val = me.date;\r\n        if (me.format) return val.format(me.format);\r\n        return new Intl.DateTimeFormat(me.language, me.dataset).format(val);\r\n    }\r\n\r\n    get date() {\r\n        const me = this;\r\n        const o = Date.parse(me.value || new Date());\r\n        const date = new GSDate(o);\r\n        date.language = me.language;\r\n        return date;\r\n    }\r\n\r\n\r\n    static {\r\n        this.define('gs-date-format');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module rendering current year on a page\r\n * @module components/YearFormat\r\n */\r\nimport { GSElement } from '../../GSElement.mjs';\r\n\r\n/**\r\n * Render Year value\r\n * \r\n * @class\r\n * @extends {HTMLElement}\r\n */\r\nexport class GSYearFormat extends GSElement {\r\n\r\n    static properties = {\r\n        offset: {type :Number},\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.offset = 0;\r\n    }\r\n\r\n    renderUI() {\r\n        return this.value;\r\n    }\r\n\r\n    get value() {\r\n        return this.current + this.offset;\r\n    }\r\n\r\n    get current() {\r\n        return new Date().getFullYear();\r\n    }\r\n\r\n    static {\r\n        this.define('gs-year-format');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/NumberFormat/NumberFormat#options\r\n\r\n\r\n/**\r\n * A module rendering numeric value as curency format with specific langauge support\r\n * @module components/CurrencyFormat\r\n */\r\nimport { GSElement } from '../../GSElement.mjs';\r\n\r\n/**\r\n * Render Year value\r\n * \r\n * @class\r\n * @extends {HTMLElement}\r\n */\r\nexport class GSCurrencyFormat extends GSElement {\r\n\r\n    static properties = {\r\n        value: {},\r\n        currency: {},\r\n        language: {},\r\n    }\r\n\r\n    renderUI() {\r\n        return this.format;\r\n    }\r\n\r\n    get #options() {\r\n        const me = this;\r\n        return Object.apply(me.dataset, { style: 'currency', currency: me.currency });\r\n    }\r\n\r\n    get format() {\r\n        const me = this;\r\n        return new Intl.NumberFormat(me.language, me.#options).format(me.value);\r\n    }\r\n\r\n    static {\r\n        this.define('gs-currency-format');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { GSCacheStyles } from \"../../base/GSCacheStyles.mjs\";\r\n\r\n/**\r\n * A module loading GSStepStyle class\r\n * @module components/steps/GSStepStyle\r\n */\r\nexport class GSStepStyle {\r\n\r\n    static {\r\n        GSCacheStyles.adopt(GSStepStyle.style);\r\n    }\r\n\r\n    static get style() {\r\n        return `\r\n        .step .step-icon-wrap {\r\n            height: 80px;\r\n        }\r\n        \r\n        .step .step-icon-wrap::before,\r\n        .step .step-icon-wrap::after {\r\n            display: block;\r\n            position: absolute;\r\n            top: 50%;\r\n            width: 50%;\r\n            height: 3px;\r\n            margin-top: -1px;\r\n            background-color: var(--bs-gray-200);\r\n            content: '';\r\n            z-index: 1\r\n        }\r\n        \r\n        .step .step-icon-wrap::before {\r\n            left: 0\r\n        }\r\n        \r\n        .step .step-icon-wrap::after {\r\n            right: 0\r\n        }\r\n        \r\n        .step .step-icon {\r\n            width: 80px;\r\n            height: 80px;\r\n            line-height: 81px;\r\n            z-index: 5\r\n        }\r\n                \r\n        .step:first-child .step-icon-wrap::before {\r\n            display: none\r\n        }\r\n        \r\n        .step:last-child .step-icon-wrap::after {\r\n            display: none\r\n        }\r\n                \r\n        @media (max-width: 576px) {\r\n            .flex-sm-nowrap .step .step-icon-wrap::before,\r\n            .flex-sm-nowrap .step .step-icon-wrap::after {\r\n                display: none\r\n            }\r\n        }\r\n        \r\n        @media (max-width: 768px) {\r\n            .flex-md-nowrap .step .step-icon-wrap::before,\r\n            .flex-md-nowrap .step .step-icon-wrap::after {\r\n                display: none\r\n            }\r\n        }\r\n        \r\n        @media (max-width: 991px) {\r\n            .flex-lg-nowrap .step .step-icon-wrap::before,\r\n            .flex-lg-nowrap .step .step-icon-wrap::after {\r\n                display: none\r\n            }\r\n        }\r\n        \r\n        @media (max-width: 1200px) {\r\n            .flex-xl-nowrap .step .step-icon-wrap::before,\r\n            .flex-xl-nowrap .step .step-icon-wrap::after {\r\n                display: none\r\n            }\r\n        }        \r\n        `;\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSStepElement class\r\n * @module components/steps/GSStepElement\r\n */\r\n\r\nimport { html, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\n\r\n/**\r\n * GSStep a signle element\r\n * @class\r\n * @extends {Component}\r\n */\r\nexport default class GSStepElement extends GSElement {\r\n\r\n    static INACTIVE = 'text-bg-light';\r\n    static SELECTED = 'text-bg-primary';\r\n    static COMPLETED = 'text-bg-secondary';\r\n\r\n    static ICON_CSS = 'border rounded-circle fs-1';\r\n    static TITLE_CSS = 'mb-0 fs-6 mt-3 fw-bold';\r\n\r\n    static properties = {\r\n        title: {},\r\n        icon: {},\r\n        color: {},\r\n        iconCSS: { attribute: 'icon-css' },\r\n        titleCSS: { attribute: 'title-css' },\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        const clazz = GSStepElement;\r\n        this.icon = clazz.INACTIVE;\r\n        this.iconCSS = clazz.ICON_CSS;\r\n        this.titleCSS = clazz.TITLE_CSS;\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`\r\n        <div class=\"step d-block w-100 text-center mb-4\"  dir=\"${ifDefined(me.direction)}\">\r\n            <div class=\"step-icon-wrap d-block w-100 text-center position-relative\">\r\n                <div class=\"step-icon position-relative d-inline-block ${me.iconCSS} ${me.color || GSStepElement.INACTIVE}\">\r\n                    ${me.#renderIcon()}\r\n                </div>\r\n            </div>\r\n            <div class=\"step-title ${me.titleCSS}\">${me.translate(me.title)}</div>\r\n        </div>        \r\n        `;\r\n    }\r\n\r\n    #renderIcon() {\r\n        return this.icon ? html`<gs-icon name=\"${this.icon}\"></gs-icon>` : html`<slot name=\"icon\"></slot>`;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-step');\r\n    }\r\n\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading GSStepsElement class\r\n * @module components/steps/GSStepsElement\r\n */\r\n\r\nimport { classMap, html, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSStepStyle } from \"./StepStyle.mjs\";\r\nimport GSStepElement from './Step.mjs';\r\n\r\n/**\r\n * Steps walker prev/next track current step and update step status\r\n * \r\n * @class\r\n * @extends {Component}\r\n */\r\nexport default class GSStepsElement extends GSElement {\r\n\r\n    static CSS = 'steps d-flex flex-wrap flex-sm-nowrap justify-content-between padding-top-2x padding-bottom-1x';\r\n\r\n    #index = -1;\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    shouldUpdate(changedProperties) { \r\n        return this.steps.length > 0;\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div class=\"${classMap(me.renderClass())}\"  dir=\"${ifDefined(me.direction)}\"><slot></slot></div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        return this.mapCSS(GSStepsElement.CSS, super.renderClass());\r\n    }\r\n\r\n    get steps() {\r\n        return this.queryAll('gs-step', false, true);\r\n    }\r\n\r\n    get length() {\r\n        return this.steps.length;\r\n    }\r\n\r\n    get index() {\r\n        return this.#index;\r\n    }\r\n\r\n    set index(val = 0) {\r\n        const me = this;\r\n        if (val < 0 || val >= me.length) return;\r\n        me.#index = val;\r\n    }\r\n\r\n    get current() {\r\n        const me = this;\r\n        return me.steps[me.#index];\r\n    }\r\n\r\n    get isFirst() {\r\n        return this.#index === 0;\r\n    }\r\n\r\n    get isLast() {\r\n        return this.#index === this.length - 1;\r\n    }\r\n\r\n    next() {\r\n        const me = this;\r\n        if (me.steps.length === 0) return;\r\n        if (me.isLast) return false;\r\n        if (me.#index > - 1) me.current.color = GSStepElement.COMPLETED;\r\n        me.index++;\r\n        me.current.color = GSStepElement.SELECTED;\r\n        return me.current;\r\n    }\r\n\r\n    previous() {\r\n        const me = this;\r\n        if (me.steps.length === 0) return;\r\n        if (me.isFirst) return false;\r\n        me.current.color = GSStepElement.INACTIVE;\r\n        me.index--;\r\n        me.current.color = GSStepElement.SELECTED;\r\n        return me.current;\r\n    }\r\n\r\n    reset() {\r\n        const me = this;\r\n        me.steps.forEach(it => it.color = GSStepElement.INACTIVE);\r\n        requestAnimationFrame(() => {\r\n            me.#index = 0;\r\n            me.current.color = GSStepElement.SELECTED;\r\n        });\r\n    }\r\n\r\n    static {\r\n        GSStepStyle.style;\r\n        this.define('gs-steps', GSStepsElement);\r\n    }\r\n\r\n}","\r\nimport { classMap, html, ifDefined } from '../../lib.mjs';\r\nimport { GSAttr } from '../../base/GSAttr.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSDOM } from '../../base/GSDOM.mjs';\r\n\r\nexport class GSNotificationElement extends GSElement {\r\n\r\n    static TOP_START = \"position-fixed top-0 start-0\";\r\n    static TOP_CENTER = \"position-fixed top-0 start-50 translate-middle-x\";\r\n    static TOP_END = \"position-fixed top-0 end-0\";\r\n\r\n    static MIDDLE_START = \"position-fixed top-50 start-0 translate-middle-y\";\r\n    static MIDDLE_CENTER = \"position-fixed top-50 start-50 translate-middle\";\r\n    static MIDDLE_END = \"position-fixed top-50 end-0 translate-middle-y\";\r\n    \r\n    static BOTTOM_START = \"position-fixed bottom-0 start-0\";\r\n    static BOTTOM_CENTER = \"position-fixed bottom-0 start-50 translate-middle-x\";\r\n    static BOTTOM_END = \"position-fixed bottom-0 end-0\";\r\n\r\n    static DEFAULT = GSNotificationElement.BOTTOM_END;\r\n\r\n    static properties = {\r\n        position: { reflect: true },\r\n        native: { reflect: true, type: Boolean }\r\n    };\r\n\r\n    #list = new Set();\r\n\r\n    constructor() {\r\n        super();\r\n        this.css = 'p-3';\r\n        this.position = GSNotificationElement.DEFAULT;\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div  dir=\"${ifDefined(me.direction)}\"\r\n            class=\"toast-container z-10k ${classMap(me.renderClass())}\">\r\n            <slot></slot>\r\n        </div>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        return me.mapCSS(me.#positionCSS, super.renderClass());\r\n    }    \r\n\r\n    get #positionCSS() {\r\n        const clazz = GSNotificationElement;\r\n        const val = this.position || clazz.DEFAULT;\r\n        return val.indexOf('_') > 0 && clazz[val] ? clazz[val] : val;\r\n    }\r\n\r\n    clear() {\r\n        this.queryAll('gs-toast').forEach(el => el.dismiss());\r\n    }\r\n\r\n    info(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-info', closable, timeout, delay, options);\r\n    }\r\n\r\n    success(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-success', closable, timeout, delay, options);\r\n    }\r\n\r\n    warn(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-warning', closable, timeout, delay, options);\r\n    }\r\n\r\n    danger(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-danger', closable, timeout, delay, options);\r\n    }\r\n\r\n    primary(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-primary', closable, timeout, delay, options);\r\n    }\r\n\r\n    secondary(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-secondary', closable, timeout, delay, options);\r\n    }\r\n\r\n    dark(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-dark', closable, timeout, delay, options);\r\n    }\r\n\r\n    light(title, message, closable, timeout, delay, options) {\r\n        return this.display(title, message, 'text-bg-light', closable, timeout, delay, options);\r\n    }\r\n\r\n    /**\r\n     * Main function to show notification. \r\n     * It has support for Bootstrap based and web based notifications.\r\n     * \r\n     * @async\r\n     * @param {String} title Notification title\r\n     * @param {String} message Notification message\r\n     * @param {String} css CSS styling (web only)\r\n     * @param {Boolean} closable Can user close it (web only)\r\n     * @param {Number} timeout Timeout after which to close notification  (default 2 sec)\r\n     * @param {Number} delay Timeout after which to show notification (default 1 sec)\r\n     * @param {Object} options Options for native Notification\r\n     * @returns {Promise<Notification|GSToast>}\r\n     */\r\n    async display(title = '', message = '', css = '', closable = false, timeout = 2, delay = 0.5, options) {\r\n        if (!message) return;\r\n        const me = this;\r\n        if (me.native) {\r\n            let sts = await GSNotificationElement.requestPermission();\r\n            if (sts) sts = me.#showNative(title, message, timeout, delay, options);\r\n            if (sts) return sts;\r\n        }\r\n        return me.#showWeb(title, message, css, closable, timeout, delay);\r\n    }\r\n\r\n    #showWeb(title, message, css, closable, timeout, delay) {\r\n        const me = this;\r\n        const tpl = `<gs-toast css=\"${css}\"  opened ${closable ? 'closable' : ''} timeout=\"${timeout}\"  delay=\"${delay}\" message=\"${message}\" title=\"${title}\" language=\"${me.language}\" ></gs-toast>`;\r\n        const el = GSDOM.parse(tpl, true);\r\n        requestAnimationFrame(async () => {\r\n            await me.#delay(delay);\r\n            const toast = me.#dialogToast;\r\n            if (toast !== me) GSAttr.set(toast, 'class', `toast-container ${me.css} ${me.position}`);\r\n            toast.appendChild(el);\r\n        });\r\n        return el;\r\n    }\r\n\r\n    async #showNative(title, message, timeout, delay, options = {}) {\r\n        const me = this;\r\n        await me.#delay(delay);\r\n        options.body = options.body || message;\r\n        const notification = new Notification(title, options);\r\n        me.#list.add(notification);\r\n        const callback = me.#clearNative.bind({ notification: notification, owner: me });\r\n        notification.addEventListener('close', callback);\r\n        if (timeout > 0) notification.iid = setTimeout(callback, timeout * 1000);\r\n        return notification;\r\n    }\r\n\r\n    get #dialogToast() {\r\n        const dlg = customElements.get('gs-dialog')?.top;\r\n        return dlg && dlg.isConnected ? (GSDOM.query(dlg, '.toast-container') || this) : this;\r\n    }\r\n\r\n    async #delay(delay = 0) {\r\n        if (GSUtil.isNumber(delay) && delay > 0) await GSUtil.timeout(delay * 1000);\r\n    }\r\n\r\n    #clearNative() {\r\n        const me = this;\r\n        me.notification.close();\r\n        me.owner.#list.delete(me.notification);\r\n        if (me.notification.iid) clearTimeout(me.notification.iid);\r\n    }\r\n\r\n    /**\r\n     * Clear all triggered notifications\r\n     */\r\n    clear() {\r\n        const me = this;\r\n        Array.from(me.querySelectorAll('gs-toast')).forEach(el => el.remove());\r\n        me.#list.forEach(nn => nn.close());\r\n        me.#list.clear();\r\n    }\r\n\r\n    /**\r\n     * Check if native notification is supported\r\n     * @returns {Boolean} \r\n     */\r\n    static get isNativeSupported() {\r\n        return \"Notification\" in self;\r\n    }\r\n\r\n    /**\r\n     * Check if native notification is allowed\r\n     * @returns {Boolean} \r\n     */\r\n    static get isGranted() {\r\n        return Notification.permission === \"granted\";\r\n    }\r\n\r\n    /**\r\n     * Request useage for browser native notification\r\n     * \r\n     * @async\r\n     * @returns {Promise<boolean>} Return granted status\r\n     */\r\n    static async requestPermission() {\r\n        const clazz = GSNotificationElement;\r\n        if (!clazz.isNativeSupported) return false;\r\n        if (!clazz.isGranted) await Notification.requestPermission();\r\n        return clazz.isGranted;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-notification');\r\n    }\r\n}","\r\nimport { classMap, html, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSDOM } from '../../base/GSDOM.mjs';\r\nimport { GSUtil } from '../../base/GSUtil.mjs';\r\nimport { GSNotificationElement } from './Notification.mjs';\r\n\r\nexport class GSToastElement extends GSElement {\r\n\r\n    static properties = {\r\n        closable: { reflect: true, type: Boolean },\r\n        opened: { reflect: true, type: Boolean },\r\n        message: { reflect: true },\r\n        title: { reflect: true },\r\n        delay: { reflect: true, type: Number },\r\n        timeout: { reflect: true, type: Number }\r\n    }\r\n\r\n    #pending = false;\r\n\r\n    constructor() {\r\n        super();\r\n        const me = this;\r\n        me.timeout = 2;\r\n        me.delay = 2;\r\n        me.auto = true; \r\n    }\r\n\r\n    shouldUpdate(changedProperties) {\r\n        const me = this;\r\n        const visibilityChange = me.#isVisibilityChanged(changedProperties);\r\n        if (me.delay > 0 && me.opened && visibilityChange) {\r\n            me.#pending = true;\r\n            me.#pendingUpdate();\r\n        }\r\n        return me.#validParent && (!me.#pending);\r\n    }\r\n\r\n    #isVisibilityChanged(changedProperties) {\r\n        return changedProperties.has('opened');\r\n    }\r\n\r\n    async #pendingUpdate() {\r\n        const me = this;\r\n        await GSUtil.timeout(me.delay * 1000);\r\n        me.#pending = false;\r\n        me.requestUpdate();\r\n    }\r\n\r\n    async updated(changedProperties) {\r\n        const me = this;\r\n        const visibilityChange = me.#isVisibilityChanged(changedProperties);\r\n        if (me.timeout > 0 && me.opened) {\r\n            await GSUtil.timeout(me.timeout * 1000);\r\n            me.opened = false;\r\n        } else if (visibilityChange && !me.opened) { \r\n            me.remove();\r\n        };\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return me.title ? me.#renderWithHeader() : me.#renderSimple();\r\n    }\r\n\r\n    #renderWithHeader() {\r\n        const me = this;\r\n        return html`\r\n        <div dir=\"${ifDefined(me.direction)}\"\r\n            class=\"mt-1 mb-1 toast fade ${classMap(me.renderClass())}\">\r\n            <div class=\"toast-header\">\r\n                ${me.translate(me.title)}\r\n                <slot name=\"header\"></slot>\r\n                ${me.closable ? me.#button : ''}\r\n            </div>\r\n            <div class=\"toast-body\">\r\n                ${me.translate(me.message)}\r\n                <slot name=\"body\"></slot>\r\n            </div>\r\n        </div>            \r\n        `;\r\n    }\r\n\r\n    #renderSimple() {\r\n        const me = this;\r\n        return html`\r\n        <div class=\"mt-1 mb-1 toast fade ${classMap(me.renderClass())}\">\r\n          <div class=\"d-flex\">\r\n              <div class=\"toast-body\">\r\n              ${me.translate(me.message)}\r\n              <slot name=\"body\"></slot>\r\n              </div>\r\n              ${me.closable ? me.#button : ''}\r\n          </div>\r\n        </div>            \r\n        `;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const css = {\r\n            ...super.renderClass(),\r\n            'show': me.opened,\r\n        }\r\n        return css;\r\n    }\r\n\r\n    dismiss() {\r\n        this.opened = false;\r\n    }\r\n\r\n    get #button() {\r\n        const me = this;\r\n        return html`<button type=\"button\" class=\"btn-close me-2 m-auto\" @click=\"${me.dismiss}\"></button>`;\r\n    }\r\n\r\n    get #validParent() {\r\n        const isToast = GSDOM.hasClass(this.parentElement, 'toast-container');\r\n        const isNotify = this.parentElement instanceof GSNotificationElement;\r\n        return isToast || isNotify;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-toast');\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * Controller managing data tree navigation.\r\n * Controller is added to every gs-tree-node and \r\n * reacts on Tree node changes to update UI\r\n */\r\nexport class AbstractTreeController {\r\n\r\n    #host;\r\n    #node;\r\n\r\n    constructor(host) {\r\n        const me = this;\r\n        me.#host = host;\r\n        host.addController(me);\r\n    }\r\n    \r\n    hostConnected() {\r\n        const me = this;\r\n        me.#node = me.#host.node;\r\n        me.#addNodeController(me);\r\n    }\r\n\r\n    hostDisconnected() {\r\n        const me = this;\r\n        me.#removeNodeController(me);\r\n        me.#host.removeController(me);\r\n    }\r\n\r\n    // before rendering\r\n    hostUpdate() {\r\n        const me = this;\r\n        const oldNode = me.#node;\r\n        me.#node = me.#host.node;\r\n        if (oldNode != me.#node) {\r\n            me.#removeNodeController(me);\r\n            me.#addNodeController(me);\r\n        }\r\n    }\r\n\r\n    // link Tree node callbacks with controller and component\r\n    #addNodeController(controller) {\r\n        this.#host.node?.addController?.(controller);\r\n    }\r\n\r\n    // unlink Tree node callbacks with controller and component\r\n    #removeNodeController(controller) {\r\n        this.#node?.removeController?.(controller);\r\n    }\r\n\r\n    host(node) {\r\n        return node[Symbol.for('gs-element')] || this.#host;\r\n    }\r\n\r\n    match(node) {\r\n        const host = this.host(node);\r\n        return host?.node === node;\r\n    }\r\n\r\n    get store() {\r\n        return this.#host.dataController?.store;\r\n    }\r\n\r\n    requestUpdate(node) {\r\n        if (this.match(node)) this.host(node).requestUpdate();\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { AbstractTreeController } from './AbstractTreeController.mjs';\r\n\r\n/**\r\n * Controller managing data TreeNode callbacks to reflect UI.\r\n */\r\nexport class TreeController extends AbstractTreeController {\r\n\r\n    constructor(host) {\r\n        super(host);\r\n    }\r\n\r\n    #toggleState(node, state = false) {\r\n        const el = this.host(node);\r\n        if (el) el.loading = state;\r\n    }\r\n\r\n    // Tree controller callbacks\r\n    onLoad(node) {\r\n        this.#toggleState(node, true);\r\n    }\r\n\r\n    onRefresh(node) {\r\n        this.requestUpdate(node);\r\n    }\r\n\r\n    onAppend(node, addedNode) {\r\n        this.#toggleState(node);\r\n        this.requestUpdate(node.root);\r\n    }\r\n\r\n    onInsert(node, insertedNode) {\r\n        this.#toggleState(node);\r\n        this.requestUpdate(node.root);\r\n    }\r\n\r\n    onExpand(node) {\r\n        const store = this.store;\r\n        if (store) {\r\n            store.onExpand(node);\r\n        } else {\r\n            this.requestUpdate(node);\r\n        }\r\n    }\r\n\r\n    onCollapse(node) {\r\n        this.requestUpdate(node);\r\n    }\r\n\r\n    onFocusChanged(node) {\r\n        this.requestUpdate(node);\r\n    }\r\n\r\n    onSelectionChanged(node, selectedNode) {\r\n        this.requestUpdate(node);\r\n    }\r\n\r\n    onRemove(node) {\r\n        if (this.match(node)) this.host(node).remove();\r\n    }\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { html } from '../../lib.mjs';\r\nimport { TreeNode } from '../../data/TreeNode.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSLinklement } from '../Link.mjs';\r\nimport { GSAttributeHandler } from '../../base/GSAttributeHandler.mjs';\r\n\r\nexport class GSTreeItemElement extends GSElement {\r\n\r\n  /*\r\n  static styles = css`            \r\n    :focus-visible {\r\n      outline: none !important;\r\n    }  \r\n    .list-group-item {\r\n      cursor: pointer;\r\n    }`;\r\n    */\r\n\r\n  static properties = {\r\n    loading: { state: true },\r\n    node: { type: Object, hasChanged: (newVal) => newVal instanceof TreeNode }\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.flat = true;\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    return this.node ? true : false;\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    if (changed.has('node')) this.node[Symbol.for('gs-element')] = this;\r\n  }\r\n\r\n  updated() {\r\n    if (this.focused) this.#link?.focus();\r\n    this.dataset.visible = this.visible;\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    const node = me.node;\r\n    const opt = me.value || {};\r\n    opt.tooltip = me.translate(opt.tooltip)\r\n    opt.title = me.translate(opt.title)\r\n    const before = me.loading ? me.#renderSpinner(node.level) : me.#renderIcon(node.level);\r\n    return GSLinklement.generate(opt, me.renderClass(), before);\r\n  }\r\n\r\n  renderClass() {\r\n    const me = this;\r\n    const opt = {\r\n      'list-group-item': true,\r\n      'list-group-item-action': true,\r\n      'user-select-none  ': true,\r\n      'border-0': me.#border ? false : true,\r\n      'gs-hide': !me.visible\r\n    };\r\n    return me.mapCSS(me.#cssFocus, me.mapCSS(me.#cssSelected, opt, me.selected && !me.multiselect), me.focused);\r\n  }\r\n\r\n  /**\r\n   * Toggle folder\r\n   */\r\n  toggle() {\r\n    this.opened ? this.close() : this.open();\r\n  }\r\n\r\n  /**\r\n   * Open folder\r\n   */\r\n  open() {\r\n    this.#status(true);\r\n    this.focus();\r\n  }\r\n\r\n  /**\r\n   * Close folder\r\n   */\r\n  close() {\r\n    this.#status(false);\r\n  }\r\n\r\n  /**\r\n   * Toggle selection state\r\n   */\r\n  toggleSelection() {\r\n    this.select(!this.selected);\r\n  }\r\n\r\n  focus(val = true) {\r\n    if (val) super.focus();\r\n    this.focused = val == true;\r\n  }\r\n\r\n  select(val = true) {\r\n    this.selected = val == true;\r\n  }\r\n\r\n  handle(e) {\r\n    GSAttributeHandler.process(this.#link, e);\r\n    /*\r\n    const me = this;\r\n    const isIcon = e.target.tagName === 'GS-ICON';\r\n    if (me.multiselect && isIcon) {\r\n      me.toggleSelection();\r\n    } else {\r\n      GSAttributeHandler.process(me.#link, e);\r\n    }\r\n    */\r\n  }\r\n\r\n  get #link() {\r\n    return this.query('a');\r\n  }\r\n\r\n  get isLeaf() {\r\n    return this.node?.isLeaf;\r\n  }\r\n\r\n  get isFolder() {\r\n    return !this.isLeaf;\r\n  }\r\n\r\n  get key() {\r\n    return this.node?.key;\r\n  }\r\n\r\n  get value() {\r\n    return this.node?.value || {};\r\n  }\r\n\r\n  get level() {\r\n    return this.node?.level || -1;\r\n  }\r\n\r\n  get focused() {\r\n    return this.node?.focused;\r\n  }\r\n\r\n  get visible() {\r\n    const parent = this.parent;\r\n    return parent?.opened || parent?.level === -1;\r\n  }\r\n\r\n  get parent() {\r\n    return this.node?.parent;\r\n  }\r\n\r\n  get parentItem() {\r\n    const item = this.parent?.[Symbol.for('gs-element')];\r\n    return item instanceof GSTreeItemElement ? item : undefined;\r\n  }\r\n\r\n  set focused(val) {\r\n    val = val === true;\r\n    this.node.focused = val;\r\n  }\r\n\r\n  get selected() {\r\n    return this.node?.selected;\r\n  }\r\n\r\n  set selected(val) {\r\n    val = val === true;\r\n    const me = this;\r\n    if (me.isFolder && me.owner.leaf) val = false;\r\n\r\n    if (me.multiselect) {\r\n      if (val) {\r\n        me.node.selectAll();\r\n      } else {\r\n        me.node.deselectAll();\r\n      }\r\n    } else {\r\n      me.node.selected = val;\r\n    }\r\n  }\r\n\r\n  get opened() {\r\n    return this.node?.opened;\r\n  }\r\n\r\n  set opened(val) {\r\n    this.#status(val === true);\r\n  }\r\n\r\n  get owner() {\r\n    return this.closest('gs-tree');\r\n  }\r\n\r\n  get multiselect() {\r\n    return this.owner.multiselect;\r\n  }\r\n\r\n  get #cssFocus() { return this.owner.cssFocus || 'focus-ring'; }\r\n  get #cssSelected() { return this.owner.cssSelected || 'active'; }\r\n  get #cssCheck() { return this.owner.cssCheck || ''; }\r\n  get #checkColor() { return this.owner.checkColor || 'secondary'; }\r\n  get #checkColorSelected() { return this.owner.checkColorSelected || 'primary'; }\r\n\r\n  get #border() {\r\n    return this.value?.border === true || this.owner.border === true;\r\n  }\r\n\r\n  get #icon() {\r\n    const me = this;\r\n    const node = me.node;\r\n    const data = me.value;\r\n    const ui = me.owner;\r\n    let itemIco = data.icon || ui.itemIcon;\r\n    if (node.isFolder) itemIco = node.opened ? (data.openIcon || ui.openIcon) : (data.closeIcon || ui.closeIcon);\r\n    return itemIco;\r\n  }\r\n\r\n  #renderIndent(level) {\r\n    return html`<gs-indent size=\"${level}\"></gs-indent>`;\r\n  }\r\n\r\n  #renderSpinner(level) {\r\n    return html`${this.#renderIndent(level)}<gs-spinner small></gs-spinner>`;\r\n  }\r\n\r\n  #renderIcon(level) {\r\n    return html`${this.#renderIndent(level)}${this.#renderMulti()}<gs-icon size=\"5\" name=\"${this.#icon}\"></gs-icon>`;\r\n  }\r\n\r\n  #renderMulti() {\r\n    const me = this;\r\n    if (!me.multiselect) return '';\r\n    const color = me.selected ? me.#checkColorSelected : me.#checkColor;\r\n    const icon = me.node.isPartialySelected ? 'dash-square-fill' : me.selected ? 'check-square-fill' : 'square';\r\n    return html`<gs-icon size=\"6\" data-type=\"state\" \r\n                css=\"me-1 text-${color} ${me.#cssCheck}\"\r\n                name=\"${icon}\"></gs-icon>`;\r\n  }\r\n\r\n  #status(val = false) {\r\n    const me = this;\r\n    if (me.node?.isFolder) {\r\n      me.node.opened = val;\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-tree-item');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, html, css, createRef, ref, repeat, ifDefined } from '../../lib.mjs';\r\nimport { GSElement } from '../../GSElement.mjs';\r\nimport { GSDOM } from '../../base/GSDOM.mjs';\r\nimport { TreeNode } from '../../data/TreeNode.mjs';\r\nimport { TreeController } from './controllers/TreeController.mjs';\r\nimport { color } from '../../properties/color.mjs';\r\n\r\nexport class GSTreeElement extends GSElement {\r\n\r\n  static styles = css`            \r\n    :focus-visible {\r\n      outline: none !important;\r\n    }  \r\n    .list-group-item {\r\n      cursor: pointer;\r\n    }`;\r\n\r\n  static shared = {\r\n    itemIcon: { attribute: 'icon-item' },\r\n    closeIcon: { attribute: 'icon-close' },\r\n    openIcon: { attribute: 'icon-open' },\r\n    cssCheck: { attribute: 'css-check' },\r\n    cssFocus: { attribute: 'css-focus' },\r\n    cssSelected: { attribute: 'css-selected' },\r\n    checkColor: { attribute: 'check-color', ...color },\r\n    checkColorSelected: { attribute: 'check-color-selected', ...color },\r\n  }\r\n\r\n  static properties = {\r\n    storage: {},\r\n    data: { type: Object },\r\n    node: { type: Object, hasChanged: (newVal) => newVal instanceof TreeNode },\r\n    border: { type: Boolean, reflect: true },\r\n    guide: { type: Boolean, reflect: true },\r\n    leaf: { type: Boolean, reflect: true },\r\n    multiselect: { type: Boolean, reflect: true },\r\n    circular: { type: Boolean, reflect: true },\r\n    ...GSTreeElement.shared\r\n  }\r\n\r\n  // GS-ITEM attributes mapping\r\n  static options = {\r\n    ...GSTreeElement.shared,\r\n    css: {},\r\n    icon: {},\r\n    color: {},\r\n    title: {},\r\n    tooltip: {},\r\n    opened: { type: Boolean },\r\n    selected: { type: Boolean }\r\n  }\r\n\r\n  #queued = false;\r\n  #listRef = createRef();\r\n\r\n  #controller = null;\r\n\r\n  constructor() {\r\n    super();\r\n    const me = this;\r\n    me.leaf = false;\r\n    me.multiselect = false;\r\n    me.data = GSDOM.toJson(me, true, true).items;\r\n    me.node = new TreeNode(null, { '#tagName': this.tagName }, null, -1);\r\n    me.itemIcon = 'file-earmark';\r\n    me.closeIcon = 'folder'; // caret-right; chevron-right\r\n    me.openIcon = 'folder2-open'; // caret-down; chevron-down\r\n    me.cssSelected = 'active'; // fw-bold\r\n    me.cssFocus = 'focus-ring';\r\n    me.node[Symbol.for('gs-element')] = me;\r\n    me.#controller = new TreeController(me);\r\n  }\r\n\r\n  renderUI() {\r\n    const me = this;\r\n    return html`<div  dir=\"${ifDefined(me.direction)}\"\r\n          class=\"treeview ${classMap(me.renderClass())}\"          \r\n          @click=\"${me.#onClick}\"\r\n          @keydown=\"${me.#onKeyDown}\"\r\n          @keyup=\"${me.#onKeyUp}\">\r\n          <div class=\"list-group\" ${ref(me.#listRef)}>\r\n          ${repeat(me.node.walk(me.node, false, false), (node) => node.key, (node) => html`\r\n            <gs-tree-item .node=\"${node}\"></gs-tree-item>\r\n          `)}\r\n          </div>    \r\n        </div>`;\r\n  }\r\n\r\n  shouldUpdate(changed) {\r\n    const me = this;\r\n    if (changed.has('data') && me.data && !me.#queued) {\r\n      me.#queued = true;\r\n      queueMicrotask(() => {\r\n        me.node.clear();\r\n        me.node.fromJSON(me.data);\r\n        me.#queued = false;\r\n        me.requestUpdate();\r\n      });\r\n    }\r\n    return this.node ? true : false;\r\n  }\r\n\r\n  willUpdate(changed) {\r\n    super.willUpdate(changed);\r\n    if (changed.has('multiselect') && !this.multiselect) this.node?.deselectAll();\r\n    this.node.multi = this.multiselect;\r\n  }\r\n\r\n  onDataRead(data) {\r\n    if (data instanceof TreeNode) {\r\n      if (data.root !== this.node) this.node = data;\r\n    } else {\r\n      this.data = data;\r\n    }\r\n  }\r\n\r\n  next(expand = false) {\r\n    const me = this;\r\n    let item = me.nextItem;\r\n    if (!item & me.circular) item = me.#first;\r\n    if (item?.visible) {\r\n      item.focus();\r\n      if (expand && me.focused?.isFolder) me.focused.open();\r\n    }\r\n    return me.focused;\r\n  }\r\n\r\n  previous(collapse = false) {\r\n    const me = this;\r\n    let item = me.previousItem;\r\n    if (!item & me.circular) item = me.#last;\r\n    if (item?.visible) {\r\n      item.focus();\r\n      if (item.isFolder && collapse) item.close();\r\n    }\r\n    return me.focused;\r\n\r\n  }\r\n\r\n  expandAll() {\r\n    this.node?.expandAll();\r\n  }\r\n\r\n  collapseAll() {\r\n    this.node?.collapseAll();\r\n  }\r\n\r\n  /**\r\n   * Open folder\r\n   */\r\n  open(path) {\r\n    const me = this;\r\n    me.focused?.open();\r\n  }\r\n\r\n  /**\r\n   * Close folder\r\n   * TODO - path navigation\r\n   */\r\n  close(path) {\r\n    const me = this;\r\n    me.focused?.close();\r\n  }\r\n\r\n  clear() {\r\n    this.node?.clear();\r\n    this.requestUpdate();\r\n  }\r\n\r\n  reload() {\r\n    this.clear();\r\n    this.dataController?.read();\r\n  }\r\n\r\n  get selected() {\r\n    return this.#host(this.node.selectedNodes());\r\n  }\r\n\r\n  get focused() {\r\n    return this.#host(this.node.focusedNode());\r\n  }\r\n\r\n  /**\r\n   * Previous visible ge-node-item\r\n   */\r\n  get previousItem() {\r\n    return this.focused?.node.find(n => n?.visible, true, true)?.[Symbol.for('gs-element')];\r\n  }\r\n\r\n  /**\r\n   * Next visible ge-node-item\r\n   */\r\n  get nextItem() {\r\n    return this.focused?.node.find(n => n?.visible, true)?.[Symbol.for('gs-element')];\r\n  }\r\n\r\n  get #list() {\r\n    return this.#listRef.value;\r\n  }\r\n\r\n  get #first() {\r\n    return this.#list.firstElementChild;\r\n  }\r\n\r\n  get #last() {\r\n    return this.#list.lastElementChild;\r\n  }\r\n\r\n  #host(node) {\r\n    if (Array.isArray(node)) {\r\n      return node.map(n =>n[Symbol.for('gs-element')]).filter( n=> n);\r\n    }\r\n    return node?.[Symbol.for('gs-element')];\r\n  }\r\n\r\n  #onClick(e) {\r\n    const icon = e.target.tagName === 'GS-ICON' ? e.target : e.target.closest('gs-icon');\r\n    const isIcon = icon?.dataset.type === 'state';\r\n    const el = e.target.closest('gs-tree-item');\r\n    if (!el.node) return;\r\n\r\n    const me = this;\r\n\r\n    if (me.multiselect) {\r\n      if (isIcon) el.toggleSelection();\r\n    } else {\r\n      el.select(true);\r\n    }\r\n\r\n    const expandable = (me.multiselect && !isIcon) || (!me.multiselect);\r\n    if (el.isFolder && expandable) el.toggle();\r\n\r\n    el.focus();\r\n    el.handle(e);\r\n  }\r\n\r\n  #onKeyDown(e) {\r\n\r\n    const me = this;\r\n    const el = me.focused;\r\n    if (!el) return;\r\n\r\n    switch (e.code) {\r\n      case 'ArrowUp':\r\n        me.previous();\r\n        break;\r\n      case 'ArrowDown':\r\n        me.next();\r\n        break;\r\n      case 'ArrowLeft':\r\n        if (el.isFolder) {\r\n          if (el.opened) {\r\n            me.close();\r\n          } else {\r\n            (el.parentItem || el)?.focus();\r\n          }\r\n        } else {\r\n          me.previous();\r\n        }\r\n        break;\r\n      case 'ArrowRight':\r\n        if (el.isFolder && !el.opened) {\r\n          me.open();\r\n        } else {\r\n          me.next();\r\n        }\r\n        break;\r\n      case 'Enter':\r\n          if (el.isFolder) {\r\n            el.toggle();\r\n          }        \r\n    }\r\n  }\r\n\r\n  #onKeyUp(e) {\r\n\r\n    const el = e.target.closest('gs-tree-item');\r\n    if (!(el?.node)) return;\r\n\r\n    switch (e.code) {\r\n      case 'Enter':\r\n        el.handle(e);\r\n        break;\r\n      case 'Tab':\r\n        el.focus();\r\n        break;\r\n      case 'Space':\r\n        el.select(this.multiselect ? !el.selected : true);\r\n        el.focus();\r\n        break;\r\n    }\r\n  }\r\n\r\n  static {\r\n    this.define('gs-tree');\r\n  }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\n/**\r\n * A module loading ServiceWorkkerElement class\r\n * @module components/ServiceWorkkerElement\r\n */\r\n\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\n\r\n/**\r\n * An easy way to register a service worker in the browser.\r\n * @class\r\n * @extends { GSlement }\r\n */\r\nexport class ServiceWorkkerElement extends GSElement {\r\n\r\n    static properties = {\r\n        src: {},\r\n        scope: {},\r\n        module: { type: Boolean, default: false },\r\n        trace: { type: Boolean, reflect: true, default: false },\r\n        disabled: { type: Boolean, reflect: true, default: false }\r\n    }\r\n\r\n    #registration = false\r\n    #workerMessage = null;\r\n    #messageChannel = null;\r\n\r\n    #nocache = false;\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        const me = this;\r\n        me.#workerMessage = me.#onWorkerMessage.bind(me);\r\n        me.#load();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        super.disconnectedCallback();\r\n        this.#unload();\r\n    }\r\n\r\n    willUpdate(changed) {\r\n        const me = this;\r\n        if (changed.has('trace')) {\r\n            me.#ServiceWorkerTraceUpdate();\r\n        }\r\n        if (changed.has('disabled')) {\r\n            me.disabled ? me.#unload() : me.#load();\r\n        }\r\n        super.willUpdate(changed);\r\n    }\r\n\r\n    /**\r\n     * Returns true if the service worker is available in the browser and the src is a valid URL.\r\n     */\r\n    get available() {\r\n        const me = this;\r\n        return 'serviceWorker' in navigator && me.src && GSUtil.isURL(me.src);\r\n    }\r\n\r\n    /**\r\n     * Returns the service worker registration object.\r\n     */\r\n    get registration() {\r\n        return this.#registration;\r\n    }\r\n\r\n    /**\r\n     * Request the service worker to clear its cache.\r\n     * @returns \r\n     */\r\n    clearCache() {\r\n        return this.postMessage(\"CLEAR_CACHE\");\r\n    }\r\n\r\n    /**\r\n     * Request the service worker to pupdate preloads\r\n     * @returns \r\n     */\r\n    refresh() {\r\n        return this.postMessage(\"REFRESH_CACHE\");\r\n    }\r\n\r\n    /**\r\n     * Send a message to the service worker.\r\n     * @param {*} message The message to send to the service worker.\r\n     * @returns {boolean} Returns true if the message was sent, false if the service worker is not active or not registered.\r\n     */\r\n    postMessage(message) {\r\n        const me = this;\r\n        const sts = GSUtil.nonNull(message) && me.isLoaded;\r\n        if (sts) {\r\n            if (me.#messageChannel) {\r\n                me.#messageChannel.port1.postMessage(message);\r\n            } else {\r\n                me.#registration?.active?.postMessage(message);\r\n            }\r\n        }\r\n        return sts;\r\n    }\r\n\r\n    /**\r\n     * Method to handle messages from the service worker.\r\n     * Override this method to handle messages from the service worker.\r\n     * The default implementation does nothing.\r\n     * @param {Event} event \r\n     * @returns {boolean} Return false to stop the event propagation, true to continue.\r\n     */\r\n    onMessage(event) {\r\n        me.#trace('ServiceWorker message received:', event);\r\n        return true;\r\n    }\r\n\r\n    #onWorkerMessage = (event) => {\r\n        const me = this;\r\n        if (event.data) {\r\n            if (me.onMessage(event)) {\r\n                me.emit('message', event.data, true, true, true);\r\n            }\r\n        } else {\r\n            me.#trace('ServiceWorker message is empty:', event);\r\n        }\r\n    }\r\n\r\n    #initChannel() {\r\n        const me = this;\r\n        if (me.#registration?.active) {\r\n            me.#messageChannel = new MessageChannel();\r\n            me.#messageChannel.port1.onmessage = me.#workerMessage;\r\n            me.#ServiceWorkerTraceUpdate();\r\n            me.#registration.active.postMessage('INIT_PORT', [me.#messageChannel.port2]);\r\n            //me.emit('activated', isActive, true, true, true);\r\n        }\r\n    }\r\n\r\n    #ServiceWorkerTraceUpdate() {\r\n        const me = this;\r\n        me.#registration?.active?.postMessage(me.trace ? 'TRACE_ON' : 'TRACE_OFF');\r\n    }\r\n\r\n    // Show a notification to the user that a new version of the app is available\r\n    async #invokeServiceWorkerUpdateFlow(registration) {\r\n        return registration?.waiting?.postMessage('NOTIFICATION_WAITING');\r\n    }\r\n\r\n    // detect Service Worker update available and wait for it to become installed\r\n    #monitorServiceWorkerUpdate(registration) {\r\n        const me = this;\r\n        registration.addEventListener('updatefound', () => {\r\n            // wait until the new Service worker is actually installed (ready to take over)\r\n            registration.installing?.addEventListener('statechange', () => {\r\n                if (registration.waiting) {\r\n                    // if there's an existing controller (previous Service Worker), show the prompt\r\n                    if (navigator.serviceWorker.controller) {\r\n                        me.#invokeServiceWorkerUpdateFlow(registration);\r\n                    } else {\r\n                        // otherwise it's the first install, nothing to do\r\n                        me.#trace('Service Worker initialized for the first time');\r\n                    }\r\n                }\r\n            });\r\n        })\r\n    }\r\n\r\n    // detect controller change and refresh the page\r\n    #monitorController() {\r\n        let refreshing = false;\r\n        navigator.serviceWorker.addEventListener('controllerchange', () => {\r\n            if (!refreshing) {\r\n                window.location.reload();\r\n                refreshing = true;\r\n            }\r\n        });\r\n    }\r\n\r\n    async #unload() {\r\n        const me = this;\r\n        GSLoader.NO_CACHE = me.#nocache;\r\n        if (me.disabled) {\r\n            await me.#registration?.unregister();\r\n        }\r\n        me.#messageChannel?.port1.close();\r\n        me.#messageChannel?.port2.close();\r\n        me.#messageChannel = null;\r\n        me.#registration = null;\r\n    }\r\n\r\n    // Load the service worker\r\n    async #load() {\r\n        const me = this;\r\n        if (me.disabled) return;\r\n        me.#nocache = GSLoader.NO_CACHE;\r\n        GSLoader.NO_CACHE = false;\r\n\r\n        if (!me.available) {\r\n            console.warn('Service Worker is not available in this browser or src is not valid.');\r\n            return;\r\n        }        \r\n        try {\r\n            const opt = me.scope ? { scope: me.scope } : {};\r\n            if (me.module) opt.type = 'module';\r\n            me.#registration = await navigator.serviceWorker.register(me.src, opt);\r\n            me.#trace('ServiceWorker registration started:', me.#registration);\r\n\r\n            me.#monitorController();\r\n            me.#invokeServiceWorkerUpdateFlow(me.#registration);\r\n            me.#monitorServiceWorkerUpdate(me.#registration);\r\n            me.#initChannel(me.#registration);\r\n\r\n            me.#trace('ServiceWorker registration successful with scope: ', me.#registration.scope);\r\n\r\n        } catch (error) {\r\n            me.#registration = false;\r\n            console.error('Service Worker registration failed:', error);\r\n        }\r\n        me.emit('loaded', me.isLoaded, true, true, true);\r\n    }\r\n\r\n    #trace(message, data = '') {\r\n        if (this.trace) {\r\n            console.log(message, data);\r\n        }\r\n    }\r\n\r\n    static {\r\n        this.define('gs-service-worker');\r\n    }\r\n}\r\n","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, html, ifDefined, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSLog } from '../base/GSLog.mjs';\r\n\r\nexport class GSChartElement extends GSElement {\r\n\r\n    static get URL_LIB() {\r\n        return globalThis.GS_URL_CHART || globalThis.location?.origin || '/bootstrap-lit';\r\n    }\r\n\r\n    static properties = {\r\n        url: {},\r\n        config: {},\r\n        storage: {},\r\n        height: { type: Number },\r\n        width: { type: Number },\r\n        data: { type: Array },\r\n        options: { type: Object },\r\n    }\r\n\r\n    #canvasRef = createRef();\r\n    #chart = null;\r\n\r\n    constructor() {\r\n        super();\r\n        this.height = 0;\r\n        this.width = 0;\r\n        GSChartElement.#init();\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        this.#waitInit();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        super.disconnectedCallback();\r\n        const me = this;\r\n        if (me.#chart) me.#chart.destroy();\r\n        me.#chart = null;\r\n    }\r\n\r\n    shouldUpdate(changed) {\r\n        return GSChartElement.#isChart;\r\n    }\r\n\r\n    firstUpdated(changed) {\r\n        this.#render();\r\n        super.firstUpdated(changed);\r\n    }\r\n\r\n    updated(changed) {\r\n        const me = this;\r\n        if (changed.has('url') || changed.has('config')) me.#render();\r\n        if (changed.has('data') || changed.has('options')) me.#renderData(me.data, me.options);\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<canvas ${ref(me.#canvasRef)} \r\n                class=\"${classMap(me.renderClass())}\"\r\n                width=\"${ifDefined(me.width > 0 ? me.width : false)}\" \r\n                height=\"${ifDefined(me.height > 0 ? me.height : false)}\" >\r\n            </canvas>`;\r\n    }\r\n\r\n    onDataRead(data) {\r\n        this.data = data;\r\n    }\r\n\r\n    get canvas() {\r\n        return this.#canvasRef.value;\r\n    }\r\n\r\n    // https://www.chartjs.org/docs/latest/developers/api.html\r\n\r\n    reset() {\r\n        this.#chart?.reset();\r\n    }\r\n\r\n    refresh() {\r\n        this.#chart?.render();\r\n    }\r\n\r\n    updateChart(val) {\r\n        this.#chart?.update(val);\r\n    }\r\n\r\n    stop() {\r\n        this.#chart?.stop();\r\n    }\r\n\r\n    clear() {\r\n        this.#chart?.clear();\r\n    }\r\n\r\n    resize(x, y) {\r\n        const me = this;\r\n        if (!me.#chart) return;\r\n        requestAnimationFrame(() => {\r\n            const div = me.query('div');\r\n            if (div) {\r\n                div.style.width = `${x}px`;\r\n                div.style.height = `${y}px`;\r\n            }\r\n            me.#chart.resize(x, y);\r\n        });\r\n    }\r\n\r\n    toBase64Image(type = \"image/png\", quality = 1) {\r\n        return this.#chart?.toBase64Image(type, quality);\r\n    }\r\n\r\n    // internal functions to render JSON from gs-items elements\r\n\r\n    async #render() {\r\n        const me = this;\r\n        try {\r\n            const options = await GSLoader.loadSafe(me.config, 'GET', null, true, {});\r\n            const data = await GSLoader.loadSafe(me.url, 'GET', null, true, []);\r\n            me.data = data;\r\n            me.options = options;\r\n        } catch (error) {\r\n            GSLog.error(null, error);\r\n        }\r\n    }\r\n\r\n    #renderData(data, options) {\r\n        const me = this;\r\n        const el = me.querySelector('gs-item[group=\"options\"]');\r\n        const opt = Object.assign(options, GSChartElement.toJson(el));\r\n\r\n        const sets = opt.data.datasets;\r\n        sets.forEach((o, i) => o.data = sets.length === 1 ? data : data[i] || []);\r\n\r\n        if (me.#chart) return me.updateChart(opt);\r\n\r\n        const ctx = me.canvas?.getContext('2d');\r\n        if (ctx) {\r\n            me.#chart = new GSChartElement.#Chart(ctx, opt);\r\n        } else {\r\n            GSLog.error(null, 'Failed to get canvas context');\r\n        }\r\n    }\r\n\r\n    async #waitInit() {\r\n        if (!GSChartElement.#isChart) await GSEvents.wait(document, 'gs-chart', 0, false);\r\n        this.requestUpdate();\r\n    }\r\n\r\n    static #isChart = false;\r\n    static #initializing = false;\r\n    static #Chart = null;\r\n\r\n    static async #init() {\r\n        const me = GSChartElement;\r\n        if (me.URL_LIB === false) return;\r\n        if (me.#isChart || me.#initializing) return;\r\n        me.#initializing = true;\r\n        try {\r\n            const origin = GSChartElement.URL_LIB;\r\n            const url = `${origin}/assets/chart/chart.mjs`;\r\n            const { Chart, registerables } = await import(url);\r\n            Chart.register(...registerables);\r\n            me.#Chart = Chart;\r\n            me.#isChart = true;\r\n            GSEvents.send(document, 'gs-chart');\r\n        } catch (e) {\r\n            GSLog.error(null, e);\r\n        } finally {\r\n            me.#initializing = false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Convert DOM tree into a JSON structure\r\n     * \r\n     * @param {HTMLElement} obj HTML element instance to convert\r\n     * @param {string} name DOM attribute name for object key\r\n     * @param {string} value DOM attribute name for object value\r\n     * @param {string} type DOM attribute name for object type\r\n     * @returns {object}\r\n     */\r\n    static toJson(el, name = 'name', value = 'value', type = 'type') {\r\n\r\n\r\n        if (!(el instanceof HTMLElement)) return {};\r\n\r\n        const nameV = el.getAttribute(name);\r\n        const valV = el.getAttribute(value);\r\n        const typeV = el.getAttribute(type);\r\n\r\n        let obj = null;\r\n\r\n        switch (typeV) {\r\n            case 'array':\r\n                obj = [];\r\n                break;\r\n            case 'object':\r\n                obj = {};\r\n                break;\r\n            default:\r\n                return GSChartElement.#toType(valV, typeV);\r\n        }\r\n\r\n        const childs = Array.from(el.children);\r\n        const isArray = typeV === 'array';\r\n        const isObject = typeV === 'object';\r\n\r\n        childs.forEach(el => {\r\n            const _nam = el.getAttribute(name);\r\n            if (isArray) {\r\n                obj.push(GSChart.toJson(el, name, value, type));\r\n            } else if (isObject) {\r\n                const tmp = GSChartElement.toJson(el, name, value, type);\r\n                obj[_nam] = tmp;\r\n            } else {\r\n                const _val = el.getAttribute(value);\r\n                const _typ = el.getAttribute(type);\r\n                obj[nameV][_nam] = GSChart.#toType(_val, _typ);\r\n            }\r\n        });\r\n\r\n        return obj;\r\n    }\r\n\r\n    static #toType(val, type) {\r\n        switch (type) {\r\n            case 'boolean': return val === 'true';\r\n            case 'number': return parseFloat(val);\r\n            default: return val\r\n        }\r\n    }\r\n\r\n    static {\r\n        this.define('gs-chart');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { createRef, ref, classMap, html } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\n\r\nexport class GSHighlightElement extends GSElement {\r\n\r\n    static get URL_LIB() {\r\n        return globalThis.GS_URL_HLJS || 'https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0';\r\n    }\r\n\r\n    static properties = {\r\n        url: {},\r\n        theme: {},\r\n        target: {},\r\n        language: {},\r\n    }\r\n\r\n    #codeRef = createRef();\r\n    #data;\r\n\r\n    constructor() {\r\n        super();\r\n        this.theme = 'default';\r\n    }\r\n\r\n    willUpdate(changed) {\r\n        const me = this;\r\n        if (changed.has('theme')) me.#onTheme();\r\n        if (changed.has('target')) me.#onTarget();\r\n        if (changed.has('url')) me.#onURL();\r\n        if (changed.has('language')) me.#onHighlight(me.#data);\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<pre><code ${ref(me.#codeRef)} class=\"${classMap(me.renderClass())}\"><code/><pre/>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const hasLangauge = GSUtil.isStringNonEmpty(me.language);\r\n        const css = {\r\n            [`language-${me.language}`]: hasLangauge\r\n        }\r\n        return css;\r\n    }\r\n\r\n    /**\r\n     * Highligh some code in programmatic way\r\n     * \r\n     * @param {string} data \r\n     */\r\n    highlight(data = '', append = false) {\r\n        this.#data = data;\r\n        this.#onHighlight(data, append);\r\n    }\r\n\r\n    set content(val ='') {\r\n        this.#data = val;\r\n        this.#onHighlight(val);\r\n    }\r\n\r\n    get content() {\r\n        return this.#data;\r\n    }\r\n\r\n    async #onTheme() {\r\n        const url = `${GSHighlightElement.URL_LIB}/styles/${this.theme}.min.css`;\r\n        GSDOM.injectCSS(this, url);\r\n    }\r\n\r\n    /**\r\n     * Search with CSS query for element, if found, \r\n     * get innerHTML, and send to highlighting\r\n     */\r\n    #onTarget() {\r\n        const me = this;\r\n        const el = me.target ? GSDOM.query(me.target) : null;\r\n        if (!el) return GSDOM.setHTML(me.#code, `Element with id ${me.target} not found!`);\r\n        me.#data = el.innerHTML;\r\n        me.#onHighlight(el.innerHTML);\r\n    }\r\n\r\n    /**\r\n     * Download source from URL, then send to highlighting\r\n     */\r\n    async #onURL() {\r\n        const me = this;\r\n        try {\r\n            const data = await GSLoader.load(me.url);\r\n            if (!data) throw new Error(`Code URL ${me.url} unreachable!`);\r\n            me.#data = data;\r\n            me.#onHighlight(data);\r\n        } catch (error) {\r\n            GSDOM.setHTML(me.#code, error.message);\r\n        }\r\n    }\r\n\r\n    get #code() {\r\n        return this.#codeRef.value;\r\n    }\r\n\r\n    #onMessage(e) {\r\n        const me = this;\r\n        const content = e.data.data;\r\n        URL.revokeObjectURL(e.data.url);\r\n        GSDOM.setHTML(me.#code, e.data.append ? me.#code.innerHTML + content : content);\r\n        e.target.terminate();\r\n    }\r\n\r\n    #onHighlight(data = '', append = false) {\r\n        const me = this;\r\n        if (!data) return GSDOM.setHTML(me.#code, 'No data!');\r\n        try {\r\n            const response = me.#worker;\r\n            const blob = new Blob([response], { type: 'application/javascript' });\r\n            const blobURL = URL.createObjectURL(blob);\r\n            const worker = new Worker(blobURL);\r\n            worker.onmessage = me.#onMessage.bind(me);\r\n            worker.postMessage({ data: data, url: blobURL, append: append });\r\n        } catch (error) {\r\n            GSDOM.setHTML(me.#code, error.message);\r\n        }\r\n    }\r\n\r\n    get #worker() {\r\n        const me = this;\r\n        const langs = me.language ? me.language.split(',').map(v => `importScripts('${GSHighlightElement.URL_LIB}/languages/${v.trim()}.min.js');`).join('') : '';\r\n        return `globalThis.onmessage = (event) => {\r\n                importScripts('${GSHighlightElement.URL_LIB}/highlight.min.js');\r\n                ${langs}\r\n                const result = globalThis.hljs.highlightAuto(event.data.data);\r\n                postMessage({data:result.value, url:event.data.url, append: event.data.append});};`\r\n    }\r\n\r\n    static {\r\n        this.define('gs-highlight');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, html, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSUtil } from '../base/GSUtil.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\nimport { GSAttr } from '../base/GSAttr.mjs';\r\nimport { GSID } from '../base/GSID.mjs';\r\n\r\nexport class GSMarkdownElement extends GSElement {\r\n\r\n    static get URL_LIB() {\r\n        return globalThis.GS_URL_MARKDOWN || 'https://unpkg.com/showdown/dist/showdown.min.js';\r\n    }\r\n\r\n    static properties = {\r\n        url: {},\r\n        history: { type: Number },\r\n        maxHeight: { type: Number, attribute: 'max-height' },\r\n    }\r\n\r\n    #containerRef = createRef();\r\n    #converter = null;\r\n    #last = null;\r\n    #first = null;\r\n    #root = null;\r\n    #path = null;\r\n    #cache = [];\r\n\r\n    #styleID = GSID.id;\r\n\r\n    constructor() {\r\n        super();\r\n        this.history = 10;\r\n        this.dynamicStyle(this.#styleID);\r\n    }\r\n\r\n    async connectedCallback() {\r\n        const me = this;\r\n        await me.#initLib();\r\n        if (globalThis.showdown) {\r\n            const opt = { tasklists: true, tables: true };\r\n            me.#converter = new globalThis.showdown.Converter(opt);\r\n            super.connectedCallback();\r\n        }\r\n    }\r\n\r\n    willUpdate(changed) {\r\n        const me = this;\r\n        if (changed.has('url')) {\r\n            me.#toCache(me.url);\r\n            me.#onURL(me.url);\r\n        }\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        const height = me.maxHeight > 0 ? `${me.maxHeight}px;` : false;\r\n        const opt = { 'max-height': height }\r\n        me.dynamicStyle(me.#styleID, opt);\r\n        return html`<div ${ref(me.#containerRef)} class=\"overflow-auto ${classMap(me.renderClass())}\"><div/>`;\r\n    }\r\n\r\n    renderClass() {\r\n        const me = this;\r\n        const hasLangauge = GSUtil.isStringNonEmpty(me.language);\r\n        const css = {\r\n            [me.#styleID] : true,\r\n            [`language-${me.language}`]: hasLangauge\r\n        }\r\n        return css;\r\n    }\r\n\r\n    back() {\r\n        const me = this;\r\n        const url = me.#fromCache();\r\n        me.#onURL(url);\r\n    }\r\n\r\n    get root() {\r\n        return this.#root || '';\r\n    }\r\n\r\n    /**\r\n     * Return injection point for rendered markdown\r\n     */\r\n    get #container() {\r\n        return this.#containerRef.value;\r\n    }\r\n\r\n    /**\r\n     * Download source from URL, then send to rendering\r\n     */\r\n    async #onURL(url = '') {\r\n        const me = this;\r\n\r\n        url = me.#normalize(url);\r\n        if (!url) return;\r\n\r\n        let data = await GSLoader.load(url);\r\n        if (!data) return;\r\n\r\n        me.#path = me.#parent(url);\r\n        if (!me.#root) me.#root = me.#path;\r\n\r\n        // MD library error fix\r\n        data = data.replace(/^[-_\\*]{3}$/gm, '<hr>');\r\n\r\n        me.#container.innerHTML = me.#makeHtml(data);\r\n\r\n        GSEvents.send(me, 'data', url);\r\n        requestAnimationFrame(() => {\r\n            me.#handleLinks();\r\n            me.#handleTables();\r\n            me.#handleCode();\r\n        });\r\n    }\r\n\r\n    #normalize(url = '') {\r\n        const me = this;\r\n        if (!url || url.startsWith('http')) return url;\r\n        return me.#path ? new URL(url, me.#path).toString() :\r\n            GSLoader.normalizeURL(url, true);\r\n    }\r\n\r\n    #parent(url = '') {\r\n        return url.endsWith('/') ? url : GSLoader.parentPath(url);\r\n    }\r\n\r\n    #handleCode() {\r\n        this.#handleStyles('pre:has(code)', 'text-white bg-dark p-1');\r\n    }\r\n\r\n    #handleTables() {\r\n        const me = this;\r\n        const clss = \"table table-light table-hover table-striped table-bordered w-auto shadow-sm\";\r\n        me.#handleStyles('table', clss);\r\n    }\r\n\r\n    #handleStyles(qry, css) {\r\n        const me = this;\r\n        const list = GSDOM.queryAll(me.#container, qry);\r\n        requestAnimationFrame(() => list.forEach(el => GSDOM.toggleClass(el, css)) );\r\n    }\r\n\r\n    #handleLinks() {\r\n        const me = this;\r\n        const links = GSDOM.queryAll(me.#container, 'a').filter(el => !GSAttr.get(el, 'href').startsWith('#'));\r\n\r\n        links\r\n            .filter(el => !(GSAttr.get(el, 'href').endsWith('.md') || GSAttr.get(el, 'href').endsWith('/')))\r\n            .forEach(el => el.target = \"_blank\");\r\n\r\n        links\r\n            .filter(el => GSAttr.get(el, 'href').endsWith('.md') || GSAttr.get(el, 'href').endsWith('/'))\r\n            .forEach(el => GSEvents.attach(el, el, 'click', me.#onLinkClick.bind(me)));\r\n\r\n    }\r\n\r\n    #onLinkClick(e) {\r\n        const me = this;\r\n        const el = e.target;\r\n        const href = GSAttr.get(el, 'href');\r\n        if (href.startsWith('#')) return;\r\n        GSEvents.prevent(e);\r\n        el.href = me.#normalize(href);\r\n\r\n        const success = GSEvents.send(me, 'link', el.href, false, false, true);\r\n        if (!success) return;\r\n\r\n        me.#toCache(el.href);\r\n        me.#onURL(el.href);\r\n        return false;\r\n    }\r\n\r\n    #fromCache() {\r\n        const me = this;\r\n        if (me.#cache.length === 0 ) return me.#first;\r\n        const url = me.#cache.pop();\r\n        return url && url === me.#last ? me.#fromCache() : url;\r\n    }\r\n\r\n    #toCache(url) {\r\n        const me = this;\r\n        if (me.#cache.length >= me.history) me.#cache = me.#cache.slice(1);\r\n        if (me.#last == url) return;\r\n        me.#cache.push(url);\r\n        me.#last = url;\r\n        if (!me.#first) me.#first = url;\r\n    }\r\n\r\n    #makeHtml(data) {\r\n        return this.#converter.makeHtml(data);\r\n    }\r\n\r\n    async #initLib() {\r\n        const me = this;\r\n        if (globalThis.showdown) return;\r\n        const script = document.createElement('script');\r\n        const promise = GSEvents.wait(script, 'load', 0, false);\r\n        script.type = \"text/javascript\";\r\n        script.src = GSMarkdownElement.URL_LIB;\r\n        GSDOM.appendChild(document.head, script);\r\n        await promise;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-markdown');\r\n    }\r\n\r\n}","/*\r\n * Copyright (C) 2015, 2025; Green Screens Ltd.\r\n */\r\n\r\nimport { classMap, createRef, html, ref } from '../lib.mjs';\r\nimport { GSElement } from '../GSElement.mjs';\r\nimport { GSLoader } from '../base/GSLoader.mjs';\r\nimport { GSDOM } from '../base/GSDOM.mjs';\r\nimport { GSEvents } from '../base/GSEvents.mjs';\r\n\r\nexport class GSMonacoElement extends GSElement {\r\n\r\n    static get URL_LIB() {\r\n        return globalThis.GS_URL_MONACO || 'https://unpkg.com/monaco-editor@latest/min/';\r\n    }\r\n\r\n    static properties = {\r\n        url: {},\r\n        theme: {},\r\n        target: {},\r\n        language: {},\r\n    }\r\n\r\n    #containerRef = createRef();\r\n    #editor = null;\r\n\r\n    constructor() {\r\n        super();\r\n        this.language = '';\r\n        this.theme = 'vs-dark';\r\n    }\r\n\r\n    async connectedCallback() {\r\n        await GSMonacoElement.#init();\r\n        super.connectedCallback();\r\n    }\r\n\r\n    createRenderRoot() {\r\n        return this;\r\n    }\r\n\r\n    firstUpdated() {\r\n        this.#onMonacoReady();\r\n        super.firstUpdated();\r\n    }\r\n\r\n    willUpdate(changed) {\r\n        const me = this;\r\n        if (!me.#editor) return;\r\n        if (changed.has('theme')) me.#onTheme(me.theme);\r\n        if (changed.has('target')) me.#onTarget(me.target);\r\n        if (changed.has('url')) me.#onURL(me.url);\r\n        if (changed.has('language')) me.#onLanguage(me.language);\r\n    }\r\n\r\n    renderUI() {\r\n        const me = this;\r\n        return html`<div ${ref(me.#containerRef)} class=\"${classMap(me.renderClass())}\"><div/>`;\r\n    }\r\n\r\n    get monaco() {\r\n        return window.monaco;\r\n    }\r\n\r\n    get editor() {\r\n        return this.#editor;\r\n    }\r\n\r\n    get model() {\r\n        return this.#editor.getModel();\r\n    }\r\n\r\n    /**\r\n     * Get editor code \r\n     * \r\n     * @param {string} data \r\n     */\r\n    get code() {\r\n        return this.#editor?.getValue() || '';\r\n    }\r\n\r\n    set code(data = '') {\r\n        const me = this;\r\n        if (me.#editor) me.#editor.setValue(data);\r\n    }\r\n\r\n    /**\r\n     * Get text selected in Monaco\r\n     */\r\n    get selection() {\r\n        const me = this;\r\n        return me.model.getValueInRange(me.editor.getSelection());\r\n    }\r\n\r\n    get owner() {\r\n        return this.parentElement;\r\n    }\r\n\r\n    #onLanguage(language) {\r\n        const me = this;\r\n        if (me.monaco && language) {\r\n            me.monaco.editor.setModelLanguage(me.model, language);\r\n        }\r\n    }\r\n\r\n    #onTheme(theme) {\r\n        const me = this;\r\n        if (me.monaco && theme) me.monaco.editor.setTheme(theme);\r\n    }\r\n\r\n    /**\r\n     * Search with CSS query for element, if found, \r\n     * get innerHTML, and send to highlighting\r\n     */\r\n    #onTarget(target) {\r\n        const me = this;\r\n        const el = target ? GSDOM.query(target) : null;\r\n        if (!el) return me.code = `Element with id ${target} not found!`;\r\n        me.code = el.innerHTML;\r\n    }\r\n\r\n    /**\r\n     * Download source from URL, then send to highlighting\r\n     */\r\n    async #onURL(url) {\r\n        const me = this;\r\n        try {\r\n            const data = url ? await GSLoader.load(url) : null;\r\n            if (!data) throw new Error(`Code URL ${url} unreachable!`);\r\n            me.code = '';\r\n            me.#onLanguage(me.language);\r\n            me.code = data;\r\n        } catch (error) {\r\n            me.code = error.message;\r\n        }\r\n    }\r\n\r\n    #onMonacoReady() {\r\n\r\n        const me = this;\r\n\r\n        const opt = {\r\n            value: ``,\r\n            language: me.language,\r\n            theme: me.theme,\r\n            automaticLayout: true,\r\n            minimap: { enabled: false }\r\n        };\r\n\r\n        me.#editor = me.monaco?.editor?.create(me.#container, opt);\r\n\r\n        me.attachEvent(window, 'resize', me.#onResize.bind(me));\r\n\r\n        try {\r\n            if (me.url) {\r\n                me.#onURL(me.url);\r\n            } else if (me.target) {\r\n                me.#onTarget(me.target);\r\n            }\r\n        } finally {\r\n            requestAnimationFrame(() => me.emit('initialized'));\r\n            me.#onResize();\r\n        }\r\n    }\r\n\r\n    #onResize(e) {\r\n        const me = this;\r\n        if (!me.#editor) return;\r\n        me.#editor.layout({ width: 0, height: 0 });\r\n\r\n        requestAnimationFrame(() => {\r\n            const rect = me.owner?.getBoundingClientRect();\r\n            if (rect) {\r\n                me.#editor.layout({ width: rect.width, height: rect.height });\r\n            }\r\n        });\r\n    }\r\n\r\n    get #container() {\r\n        return this.#containerRef.value;\r\n    }\r\n\r\n    static #initialized;\r\n\r\n    static async #initLib() {\r\n        if (globalThis.monaco) return;\r\n        const script = document.createElement('script');\r\n        const promise = GSEvents.wait(script, 'load', 0, false);\r\n        script.type = \"text/javascript\";\r\n        script.src = `${GSMonacoElement.URL_LIB}vs/loader.js`;\r\n        GSDOM.appendChild(document.head, script);\r\n        await promise;\r\n    }\r\n\r\n    // Before loading vs/editor/editor.main, define a global MonacoEnvironment that overwrites\r\n    // the default worker url location (used when creating WebWorkers). The problem here is that\r\n    // HTML5 does not allow cross-domain web workers, so we need to proxy the instantiation of\r\n    // a web worker through a same-domain script\r\n    static #initEnv() {\r\n        const url = GSMonacoElement.URL_LIB;\r\n        window.MonacoEnvironment = {\r\n            baseUrl: `${url}`,\r\n            getWorkerUrl: (workerId, label) => {\r\n                return `data:text/javascript;charset=utf-8,${encodeURIComponent(`\r\n                globalThis.MonacoEnvironment = {baseUrl: '${url}'};\r\n                importScripts('${url}vs/base/worker/workerMain.js');`\r\n                )}`;\r\n            }\r\n        };\r\n    }\r\n\r\n    static #initMonaco() {\r\n        return new Promise((resolve, reject) => {\r\n            // TODO  set disabled to true and manually load themes into shadow dom\r\n            require.config({\r\n                paths: { 'vs': `${GSMonacoElement.URL_LIB}/vs` },\r\n                'vs/css': { disabled: false }\r\n            });\r\n            require(['vs/editor/editor.main'], resolve);\r\n        });\r\n    }\r\n\r\n    static async #init() {\r\n        const me = GSMonacoElement;\r\n        if (me.#initialized) return;\r\n        me.#initEnv();\r\n        await me.#initLib();\r\n        await me.#initMonaco();\r\n        me.#initialized = true;\r\n    }\r\n\r\n    static {\r\n        this.define('gs-monaco');\r\n    }\r\n\r\n}"],"names":["GSVersion","version","build","gsstyles","GSLog","static","el","msg","this","print","tracing","forced","type","logging","tmp","nodeName","id","fn","console","log","Error","Object","seal","GSUtil$1","GSUtil","globalThis","GS_FLAT","n","isNaN","parseFloat","isFinite","v","Date","Boolean","value","toString","val","normalize","toLowerCase","str","obj","replace","x","g","split","reverse","join","word","toUpperCase","slice","map","i","capitalize","constructor","o","Array","isArray","isBool","isDate","isNumber","isString","min","max","Math","match","isNull","dft","language","sep","numberSeparator","extractNumber","replaceAll","url","test","trim","startsWith","endsWith","pattern","charset","floor","random","length","navigator","languages","flags","RegExp","isStringEmpty","undefined","Intl","NumberFormat","format","DateTimeFormat","string","reg","keys","isJsonString","isJsonType","JSON","parse","normalizeJson","warn","JSON_NORMALIZE","def","separator","filter","capitalizeAll","tpl","params","names","vals","values","Function","text","textArea","document","createElement","innerHTML","isStringNonEmpty","window","forEach","a","left","right","lmatch","rmatch","time","signal","AbortSignal","timeout","Promise","resolve","reject","iid","setTimeout","bind","addEventListener","clearTimeout","data","name","blob","Blob","URL","createObjectURL","href","download","click","revokeObjectURL","clazz","ext","freeze","expose","HTMLElement","isPrototypeOf","customElements","get","define","extends","isSealed","isFrozen","self","src","import","result","permissions","query","state","clipboard","writeText","readText","GSFunction$1","GSFunction","isFunction","includes","own","isFunctionDefined","desc","Reflect","getOwnPropertyDescriptor","__proto__","isValid","callFunctionAsync","Symbol","toStringTag","owner","args","arguments","from","apply","native","parseFunction","isFunctionNative","isFunctionAsync","callFunctionSync","parseValue","context","cnt","async","contextualize","accept","queueMicrotask","e","func","leading","debounceLifo","debounceFifo","timer","GSID","prefx","next","s","l","h","charCodeAt","isProxy","GSAttr","isHTMLElement","asBool","setAttribute","removeAttribute","isInstance","getAttribute","attr","asNum","toJson","set","NaN","stringify","entries","kv","attributes","host","opt","recursive","Proxy","target","prop","dataset","attribute","toggle","Number","setAsNum","children","proxify","safe","unsafe","dflt","default","multi","hasAttribute","toStringArray","GSCSSMap","body","computedStyleMap","element","getMap","me","modern","capitalizeAttr","asText","to","unit","num","shift","matches","getComputedStyle","getComputedStyledMap","String","on","selText","ors","some","selector","logicalORs","styleSheets","cssRules","reduce","all","concat","containsAny","selectorText","GSDate","DEFAULT_FORMAT","asJSON","REGEX_FORMAT","last","getDate","first","getDay","mondayFirst","isMondayFirst","days","repeat","push","year","getFullYear","setFullYear","month","getMonth","setMonth","day","setDate","YY","YYYY","M","MM","padStart","MMM","toLocale","MMMM","D","DD","d","dd","ddd","weekday","dddd","H","getHours","HH","formatHour","hh","meridiem","A","m","getMinutes","mm","getSeconds","ss","SSS","getMilliseconds","Z","zoneStr","ZZ","Q","ceil","k","kk","W","date","getTime","setHours","week1","round","WW","X","short","offset","Locale","weekInfo","firstDay","charAt","toLocaleString","size","isLowercase","hour","hour12","pop","negMinutes","getTimezoneOffset","minutes","abs","minuteOffset","getDateFormat","regex","getFormattedDateRegex","parseFormattedDate","groups","y","Y","valueOf","GSData","currency","extract","key","Set","b","every","index","toSorted","compareArrays","second","advanced","arr","indexOf","list","it","cfg","toType","rule","toRegex","childElementCount","querySelector","fmt","style","fields","limit","sts","rec","filterRecord","isPrimitive","filterSimple","filterComplex","filterValue","primitive","found","flt","toCheck","matchDate","matchNumber","op","toLocaleLowerCase","local","toLocaleDateString","iso","toISOString","operator","sort","sortPair","ord","idx","col","v1","v2","compare","order","compareNum","compareString","compareBool","s1","s2","localeCompare","ignoreNull","seg","writeSingleToObject","tree","hasOwnProperty","partial","r","readFromProperty","readFromObject","GSDOM","walk","isTemplateElement","cleanup","content","remove","nodeValue","activeElement","active","shadowRoot","css","visibility","display","opacity","rect","getBoundingClientRect","width","height","html","single","mime","doc","DOMParser","parseFromString","head","firstElementChild","error","forceWrap","nodes","fromNode","wrap","appendChild","link","slot","isText","tagName","FORMEL","shadow","queryAll","HTMLButtonElement","hasClass","ownClazz","inheritance","pel","HTMLSelectElement","HTMLSlotElement","HTMLTemplateElement","SVGElement","Text","Comment","clazzName","parentAll","ShadowRoot","childNodes","isGSElement","orientation","classList","add","newEl","injectable","isSVGElement","isOK","invalid","parentNode","nextElementSibling","insertBefore","placement","isok","insertAdjacentElement","parent","removeChild","node","closest","childAll","child","parentElement","offsetParent","c","HTMLBodyElement","root","getByID","documentElement","qry","levels","proxy","res","receiver","sanitize","sanitizer","setHTML","Document","textContent","requestAnimationFrame","toggleClass","contains","unwrap","querySelectorAll","defaults","valueAsNumber","selectedOptions","checked","defaultValue","getValue","styleValue","textTransform","ignore","checkValidity","fromElement2Object","fromObject2Element","objectPathExist","fromValue","noEmpty","writeToObject","toValue","plain","definitions","innerText","props","allProperties","getAsNum","items","tag","asString","fromJsonAsString","fromJsonAsDOM","title","for","sub","location","hash","setValue","group","disabled","createTreeWalker","NodeFilter","SHOW_TEXT","nextNode","ts","textNodesUnder","t","wholeText","nextSibling","CLEANUP1","whiteList","asState","isAllowed","toValidationError","allowElement","allowTag","fetch","ok","sheet","CSSStyleSheet","replaceSync","adoptedStyleSheets","isFormElement","resetSelect","typed","dispatch","isSelect","options","selected","dispatchEvent","Event","bubbles","composed","properties","mergeObjects","template","CustomEvent","globalDispatch","detail","message","GSEvents","Map","altContext","protect","listen","onContext","onKeyDown","event","shiftKey","prevent","code","ctrlKey","callback","loaded","wait","callFunction","sendSuspended","once","chained","suspended","removeEventListener","unlisten","toSignal","internal","evt","propagate","immediate","preventDefault","stopPropagation","stopImmediatePropagation","sender","cancelable","ClipboardEvent","FocusEvent","InputEvent","KeyboardEvent","MouseEvent","SubmitEvent","TouchEvent","WheelEvent","PointerEvent","send","capture","Window","isConnected","hasFunction","eventKey","elmap","getElementMap","eventMap","fnkey","defineProperty","gsid","writable","delete","removeListener","cache","removeElementMap","clear","elid","getElementID","fnid","getCallbackID","hashCode","action","onAction","prefix","findAction","onError","GS_LOG_ACTION","rid","waitAnimationFrame","onResize","attach","waitPageLoad","GSAbortController","AbortController","super","abort","clearInterval","GSDOMObserver","MutationObserver","observe","childList","subtree","observer","onObserve","forRemove","filtersDel","filtersAdd","hasFilters","hasFiltersAdd","hasFiltersDel","mutations","mutation","addedNodes","removedNodes","rootEL","filters","isFunctions","getFilter","exec","create","GSDynamicStyle","deleteRule","getRule","setRule","sync","insertRule","updateRule","isImportant","setProperty","source","dynamicStyleSheetByID","dynamicStyleSheet","gsClass","dynamicRule","dynamicRuleByID","dynamicStyle","assign","dynamicStyleByID","GSCacheStyles","store","dynamic","styles","adopt","adoptedId","GSAdoptedEngine","now","preload","timerID","setInterval","sheets","adoptable","adoptSheet","update","scheduled","sorted","ID","cssText","monitorAttributes","ownerNode","adoptStyle","disconnect","mutationList","onAttributeChange","attributeFilter","attributeOldValue","HTMLLinkElement","rel","as","HTMLStyleElement","then","adoptLink","registerFilter","onMonitorFilter","onMonitorConnect","onMonitorDisconnect","init","GSLoader","GS_TEMPLATE_URL","origin","GS_ROUTER_URL","rootURL","defaultURL","TEMPLATE_URL","ROUTER_URL","hasKey","NO_CACHE","GS_NO_CACHE","localStorage","setItem","getItem","base","path","isFile","pathname","isExt","uri","UNIQUE","searchParams","append","level","isHTML","getRouterURL","loadSafe","routerURL","normalizeURL","routerPath","getTemplateURL","templateURL","templatePath","method","load","headers","asjson","ct","Accept","json","isJson","isFunc","GSTemplateCache","cloneNode","cached","getOrCreate","isHTMLTemplate","initTemplate","loadTemplate","isFunctionTemplate","loadHTMLTemplate","loadFunctionTemplate","loadURLTemplate","GSAttributeHandler","anchor","call","inject","property","swap","trigger","hashed","calls","toggles","triggers","targetList","handle","targets","handleTarget","handleBinding","handleAction","handleSwap","handleInject","handleAttribute","handleProperty","handleToggle","handleTrigger","handleEvent","handleCall","handleExec","handleTemplate","field","form","isForm","HTMLFormElement","isField","toObject","isAttributeJSON","jsonToAttr","toggleAttribute","isPropertyJSON","toggleProperty","tout","symbol","handleContent","clean","useDef","definition","toHTML","gsHashed","applyContent","applyTemplate","clone","insertAdjacent","detach","off","parentComponent","DEFINITION","override","GSBeep","AudioContext","webkitAudioContext","audioContext","duration","frequency","volume","isAvailable","audioCtx","oscillatorNode","createOscillator","gainNode","createGain","connect","destination","gain","start","currentTime","stop","onended","isActive","hasBeenActive","userActivation","GSEnvironment","isMobile","userAgentData","mobile","userAgent","isDesktop","isWebkit","protocol","strVal","brands","brand","strAgt","isEdge","isDevice","platform","screen","otype","GSPromise","callbacks","promise","onAbort","await","aborted","onResolve","onReject","ps","p","GSEvent","EventTarget","listeners","listener","abortable","controller","emit","delayed","unbind","GSEventBus","register","registry","has","exist","bus","GSGesture","xDiff","yDiff","xDown","yDown","bindings","swipe","tap","longPress","delay","move","handleTouchMove","handleTouchStart","end","handleTouchEnd","touches","clientX","clientY","onLongPress","xUp","yUp","GSItem","autofocus","validate","GSElement","tags","collect","GS_LOCALIZATION_LANGUAGE","lang","GSLocalization","GSLocalizationImpl","queue","queued","GS_LOCALIZATION_URL","translate","deft","getLanguage","texthash","reset","promises","loadWait","sequential","Pragma","isDefault","hk","details","GSPopper","asRect","sx","scrollX","sy","scrollY","top","bottom","centerX","centerY","calcPadding","padding","elementPadding","paddingX","paddingY","elementWidth","clientWidth","elementHeight","clientHeight","elementX","elementY","arrow","pos","fromPlacement","isPlacementValid","position","margin","transform","offh","offw","boundingRect","arect","updateArrow","offH","offW","srcH","srcW","calcFixed","astyle","inset","srect","getOffset","calcAbsolute","aopt","isTop","isBottom","isStart","isEnd","trect","erect","arrowPosW","arrowPosH","applyDynamicStyle","GSQueryCSS","object","GSQuery","instance","GSRouter","enabled","hashCallback","onHashChange","getRouter","loadDefinition","enable","disable","route","unregister","deepClone","px","fromJson","GS_DEFINITION_URL","initialize","GS_ROUTER_WAIT","GSTheme","switch","theme","STORAGE","htmlEl","bsTheme","matchMedia","q","URLSearchParams","onTheme","settings","getSystemDefaultTheme","darkMode","lightMode","setup","BinaryTreeNode","isLeaf","hasChildren","isRoot","BinaryTree","inOrderTraversal","postOrderTraversal","preOrderTraversal","insert","parentNodeKey","canInsertLeft","canInsertRight","find","Node","previous","release","toJSON","DoublyLinkedList","tail","previousNode","insertAt","splice","insertFirst","insertLast","getAt","removeAt","full","acc","toArray","iterator","isInvalid","isInvalidIndex","isInteger","LinkedList","cb","asValues","asNodes","Stack","item","unshift","peek","isEmpty","Queue","enqueue","dequeue","Tree","folder","leaf","up","levelID","nodeID","isFolder","hasMore","firstChild","lastChild","down","previousSibling","inclusive","flat","iterate","filtered","fr","newOne","findByKey","flatten","fromJSON","raw","hasParent","DataSelector","SELECT","asArray","removeSelected","isSelected","GSReadWriteRegistryImpl","handlers","INTERNAL","addHandler","removeHandler","getHandler","newHandler","verify","rw","resetRegistry","GSReadWriteRegistry","GSAbstractReadWrite","processors","addProcessor","processor","removeProcessor","isRegistered","notify","onRead","postRead","onWrite","postWrite","addSelected","clearSelected","getSelected","GSReadWrite","reader","writer","mode","skip","TYPE","MODES","isQuark","METHOD","toURL","encodeURIComponent","fromLiteral","isOffline","isRemote","GSCachedReadWrite","reformat","records","postFilter","sortData","filterData","search","read","TreeNode","opened","focused","focusedNode","selectedNode","controllers","select","focus","open","addController","removeController","visible","expand","collapse","changed","onFocusChanged","onSelectionChanged","isPartialySelected","selectAll","deselectAll","selectionFlag","onSelectAll","onDeselectAll","selectedNodes","refresh","onRefresh","loading","onLoad","expandAll","collapseAll","expanded","collapsed","onExpand","onCollapse","onAppend","onInsert","GSTreeReader","resetData","litUrl","GS_LIT_URL","litModule","ReactiveController","ReactiveElement","AsyncDirective","AsyncReplaceDirective","CSSResult","Directive","LitElement","PartType","TemplateResultType","UnsafeHTMLDirective","UntilDirective","_$LE","_$LH","adoptStyles","asyncAppend","asyncReplace","choose","classMap","clearPart","createRef","defaultConverter","directive","getCommittedValue","getCompatibleStyle","getDirectiveClass","guard","ifDefined","insertPart","isCompiledTemplateResult","isDirectiveResult","isServer","isSingleExpression","isTemplateResult","keyed","literal","live","noChange","notEqual","nothing","range","ref","removePart","render","setChildPartValue","setCommittedValue","staticHtml","staticSvg","styleMap","supportsAdoptingStyleSheets","svg","templateContent","unsafeCSS","unsafeHTML","unsafeSVG","unsafeStatic","until","when","withStatic","gsAction","gsAnchor","gsAttribute","gsCall","gsExec","gsInject","gsProperty","gsSwap","gsTarget","gsTemplate","gsToggle","gsTrigger","gsValue","gsTimeout","DatasetDirective","part","srcset","DOMStringMap","remap","hasOwn","descriptors","getOwnPropertyDescriptors","listProperties","listGetters","getPrototypeOf","literalTemplate","listGettable","cssMap","CssMapDirective","partInfo","ATTRIBUTE","strings","classInfo","_previousClasses","_staticClasses","notEmpty","newVal","oldVal","numGT0","numGE0","numLT0","numLE0","AutocapitalizeTypes","autocapitalize","hasChanged","AutocompleteTypes","autocomplete","AutocorrectTypes","autocorrect","ButtonTypes","isType","buttonType","is","ColorTypes","color","EnvironmentTypes","environment","InputTypes","inputType","NavTypes","nav","OrientationTypes","PlacementTypes","PositionTypes","ProtocolTypes","SizeTypes","normal","medium","small","large","big","extra","stringArrayConverter","fromAttribute","toAttribute","AdoptedController","hostConnected","hostDisconnected","isGlobal","rules","removeRule","renderRoot","onAdopted","AttributeController","eventName","onNotify","isFormEl","ContentController","refs","removeContent","hostUpdated","isSelf","contentRef","renderOptions","renderBefore","previousElementSibling","keep","DataController","readCallback","writeCallback","errorCallback","selectCallback","onSelect","write","storeID","firstPage","page","lastPage","nextPage","prevPage","storage","requestUpdate","onDataRead","onDataWrite","onDataError","ElementMoveController","attached","cursorX","cursorY","mouseUpCallback","mouseDownCallback","mouseMoveCallback","onMouseUp","onMouseDown","onMouseMove","attachEvent","removeEvent","onStartMove","onEndMove","onCursorRight","onCursorLeft","onCursorUp","onCursorDown","LocalizationController","hostUpdate","updateLanguage","updateLanguageExt","langauge","onLanguage","OrientationController","hosts","onOrientation","RENDER_SYMBOL","TemplateController","lastRef","isPrefetch","GS_TEMPLATE_PREFETCH","templateRef","toKey","schedule","templateInjected","simple","slots","hasSlots","hasSimple","preprocessTemplate","templateSimple","templateSlots","templates","isTplEl","cacheable","err","gsCache","tasks","task","process","finally","ThemeController","updateTheme","updateThemeExt","SlotController","onSlotChanged","assignedElements","onSlotInjected","rtl","reflect","hide","rounded","bordered","onready","os","browser","adopted","uiHandler","localization","dataController","slotController","themes","refx","attributeChangedCallback","oldValue","newValue","connectedCallback","isBindable","binded","disconnectedCallback","detachListeners","shouldUpdate","changedProperties","createRenderRoot","firstUpdated","willUpdate","isAllowRender","renderUI","renderTemplate","renderClass","border","mapCSS","flag","waitEvent","direction","isFocused","isValidEnvironment","isValidBrowser","isValidOS","isValidProtocol","isValidOrientation","isGenerated","elementStyles","styleSheet","cssRule","setCSSProperty","ElementNavigationController","circular","multiple","onKeyUp","onClick","onFocusIn","onFocusOut","lastElementChild","blur","onSelected","onDeselected","onFocused","isNavigable","isNav","relatedTarget","composedPath","GroupController","busEvent","busCallback","onBusEvent","GSRouterElement","router","updated","GSAccordionElement","autoclose","cssItem","cssHeader","cssBody","renderItems","close","isItemCloser","GSAccordionItemElement","component","GSAlertElement","closed","closable","pause","interval","handleBillboard","show","isBillboard","button","billboard","GSButtonElement","clickCss","hoverCss","toggleColor","outline","toggling","icon","tooltip","refEl","refIco","onMouseOver","onMouseOut","onDisabled","iconEl","animate","onHref","isReset","isSubmit","submit","buttonEl","hover","iconHtml","renderIcon","GSCalendarElement","editable","minYear","maxYear","arrovPrev","arrowNext","cssDays","cssToday","cssWeeks","cssMonth","cssYear","cssNav","cssSelected","arrowPrev","previousMonth","nextMonth","previousYear","nextYear","formatted","updateTarget","week","dayList","months","monthsHTML","yearHTML","onKey","onDay","daysHTML","tgt","HTMLInputElement","valueAsDate","isToday","today","c1","c2","current","monthList","onMonth","optionsHTML","onYear","isList","listID","selectedIndex","yearEl","validity","valid","GSCardElement","imageStyle","overlay","align","image","subtitle","footer","header","colorText","colorBack","colorBorder","cssTitle","cssSubtitle","cssFooter","cssImage","styleID","isVertical","renderVertical","renderHorizontal","imageTop","imageBottom","isBefore","startClass","endClass","startHtml","images","endHtml","isHorizontal","imageSlot","GSCenterElement","GSMenuElement","auto","dark","menuRef","closeSubmenus","updatePosition","onMouseLeave","submenu","dropend","dropstart","popup","caller","isMouseOrPointerEvent","renderSubmenu","renderHeader","renderMenu","renderDivider","menu","toSubmenu","menuItem","isSubmenu","innerWidth","GSContextElement","isInTable","attachTarget","assignedSlot","onPopup","GSCompareElement","background","before","after","elRef","clipRef","slideRef","mouseController","elPosition","splitter","onDoubleClick","isAuto","pct","isFixed","slider","clip","GSControllerElement","module","changes","GSCopyrightElement","company","isCompany","isYear","GSDataHandler","autoload","autorefresh","config","handler","lifoReadRef","lifoWriteRef","itemHolder","PROPERTIES","initLIFO","updateHandler","formatSort","formatFilter","isDebug","gsDebug","isCached","formated","save","verifyHandler","callOnceLifo","lifoReadRefCallback","lifoWriteRefCallback","lifoCall","GSDialogElement","standard","escapable","cancelText","confirmText","minWidth","buttonAlign","iconCancel","iconConfirm","colorCancel","colorConfirm","cssCancel","cssConfirm","cssContent","pass","dialogRef","btnConfirmRef","btnCancelRef","CSS","TITLE_CSS","HEADER_CSS","ALIGN","CANCEL","CONFIRM","updateStack","_shouldUpdate","allowed","onOpenChanged","STACK","dialog","showModal","focusable","isHashed","renderConfirm","onConfirm","renderCancel","onCancel","renderFooter","renderContent","card","onForm","onSubmit","info","confirm","prompt","forms","f","tab","btnConfirm","btnCancel","QUERY_INPUT","isVisible","GSDrawerElement","backdrop","scroll","fingers","transition","cssHead","onLeave","onEnter","hasHeader","headSlot","GSDropdownElement","renderButton","buttonClass","btn","GSEmailElement","user","domain","dev","updateUser","updateDomain","GSFormElement","acceptCharset","autocopy","autoselect","autovalidate","autoreport","enctype","novalidate","block","beep","formRef","lastState","onBlur","onChange","onInvalid","elementTemplate","submitButton","resetButton","elements","inputs","reportValidity","onValidate","tplEl","GSFormGroupElement","layout","label","description","placeholder","mask","spellcheck","noAccessor","rows","cols","step","minLength","maxLength","selectable","autoid","reveal","readonly","required","invalidMessage","cellField","cellLabel","cssLabel","cssField","inputRef","ouptutRef","patterns","internals","attachInternals","validateAllowed","ICON","CSS_LABEL","CSS_LABEL_CELL","formComponent","SELECTOPT","renderFloating","cssCheck","renderInput","renderOutput","renderLabel","renderInfo","renderLabelWrap","renderField","isIcon","CSS_ICON","renderTooltip","isRange","idattr","isFieldset","radioLayout","fieldSet","inputHTML","selectHTML","isTextArea","fld","vertical","initStyle","renderOption","listHTML","outerHTML","isBlock","isBeep","onInput","isSwitch","isCheckable","isFloating","setFormValue","setValidity","validationMessage","tagList","isCheck","isRadio","isChecked","isPassword","isEmail","isURL","GSFormPanelElement","renderFormGroup","formaction","formenctype","formmethod","formnovalidate","formtarget","maxlength","minlength","GSGroupElement","controllerGroup","initData","prerender","of","renderWrappedUI","renderWrappedClass","childTagName","generated","childByName","getName","GSIconElement","superColor","_clicked","_hovered","postAnimate","fs","GSIndentElement","multiplier","numdef","GSImageElement","invert","grayscale","brightness","contrast","saturate","hue","sepia","alt","imageRef","complete","renderStyle","buildFilter","GSLayoutElement","resizable","autofit","vPos","hPos","els","dyncss","horizontal","lev","tc","dir","did","panelCSS","panelStyle","resize","grow","vpos","hpos","GSLinklement","ping","GSListElement","GSListItemElement","initial","isMatchHashBang","renderFirst","renderSecond","itemCSS","itemStatusCSS","isSelectable","renderText","activeCSS","cssActive","inactiveCSS","cssInactive","GSMouseElement","pageX","pageY","screenX","screenY","offsetX","offsetY","onMouse","GSMovableElement","onMove","cursor","updateCursor","GSNavElement","isTab","GSNavItemElement","badge","badgeColor","badgeValue","parentType","badgeUI","itemsCSS","buttonCSS","buildCSS","cssButton","navType","GSOverlayElement","autoremove","radius","styleID2","innerHeight","fillRule","clipRule","strokeLinejoin","strokeMiterlimit","zIndex","pathStr","createSVGPathString","fill","pointerEvents","windowX","windowY","limitedRadius","normalizedRadius","highlightBoxWidth","highlightBoxHeight","GSPagerElement","pages","labelFirst","labelLast","labelNext","labelPrevious","half","renderPrevious","renderItem","renderNext","renderLast","pagination","decodeHTMLEntities","toTarget","ctrl","GSPopupElement","wMin","wMax","hMin","hMax","panelRef","onAuto","reposition","postPopup","popupFixed","panel","overflowH","overflowV","GSPopoverElement","arrowRef","arrowID","attachEvents","popover","fade","isFocusTrigger","isHoverTrigger","popupAbsolute","onFocus","GSProgressElement","updateStyle","percentage","onKeySelect","increase","decrease","trunc","old","GSSpinnerElement","pulsar","GSSplitterElement","styleTGT","cssUpdate","lock","updateMouse","isPreceeding","isStyleValue","styleDynamic","lockable","csize","cls","gsSplitter","updateX","updateY","dx","GSTabItemElement","updateCSS","tabCSS","panelByName","GSTabPanelElement","tabByName","tabs","GSTabGroupElement","findPanel","isAfter","renderTabs","panels","renderPanels","GSTableElement","colspan","hidden","fixed","filterType","cssFilter","colorFilter","colorHead","colorSelect","colorSort","stripedColumn","divider","striped","grid","borderless","columns","datacolumn","multisort","multiselect","protected","sortable","sortOrder","headColor","CELLS","table","stripedColumns","renderFilters","onSort","entry","renderColumn","renderRecord","renderEmpty","renderHandler","columnType","columType","input","valueAt","row","cell","cfgType","timestamp","dataType","renderFilter","hasSub","onFilter","listid","icons","sortType","cells","remapRecord","renderCell","record","elementTofilter","column","getElementIndex","prepareSorter","isComplex","tr","GSTagElement","converter","appendable","closeColor","cssClose","cssTag","dataListRef","renderTags","renderList","updateTag","KEYS","srcElement","removeTag","addTag","isMax","datalist","optEl","tagEl","renderTag","tagClass","btnClass","GSTextElement","GSTooltipElement","arrowStyle","arrowEl","panelEl","refLocal","refGlobal","GSTemplateElement","CopySelectController","clickCallback","copyCallback","onCopy","writeToClipboard","MaskController","_","back","prev","initRules","j","buildSlots","findIndex","buildAccept","toPattern","isMatch","setCustomValidity","setSelectionRange","substring","selectionStart","selectionEnd","lastIndex","maskType","chars","masks","special","MultipatternController","multipattern","NumberController","PasswordController","revealing","isReveal","altKey","TextController","InteractiveController","monitorCallback","onMonitor","hasUpdated","formElements","strict","isInList","togleEl","dataGroup","togleOption","isButtonElement","ComboController","ListController","ValidityController","processing","togglUI","onBlock","report","onAutoValidity","EventsMixin","mixin","prototype","FormController","onReset","onFormData","ControllerHandler","copyselect","typeController","validityController","comboController","formController","invoke","initControllers","prepare","isInput","initIinputControllers","initTextAreaControllers","isDataList","GSExtButtonElement","observedAttributes","controllerHandler","formEl","preupdate","onFormState","clickFn","rateLimit","debounce","requestSubmit","GSExtInputElement","maskController","patternController","listController","isCheckBox","updateMask","updateMultipattern","updateList","isMulti","GSExtTextAreaElement","HTMLTextAreaElement","GSExtSelectElement","objToHTML","GSExtDataListElement","HTMLDataListElement","setIf","GSExtFormElement","isShadowed","disableInput","enableInput","childrens","GSBreadcrumbElement","spacing","updateChildren","$text","GSBreadcrumbItemElement","generate","GSAttachment","file","directory","transfer","transferredFiles","files","File","fullPath","isImage","isVideo","isDirectory","traverse","roots","createReader","readEntries","results","getEntries","getFile","webkitGetAsEntry","GSFileBoxElement","cssList","cssInput","maxFileSize","listEl","fileEl","dragging","TITLE","onDragenter","onDragleave","onDrop","onPaste","dataTransfer","hasFile","dropEffect","clipboardData","pastedFile","types","rgx","kind","getAsFile","attachments","DataTransfer","transferred","validAttachments","GSTimeFormat","toLocaleTimeString","GSDateFormat","GSYearFormat","GSCurrencyFormat","GSStepStyle","GSStepElement","iconCSS","titleCSS","INACTIVE","ICON_CSS","GSStepsElement","steps","isFirst","isLast","COMPLETED","SELECTED","GSNotificationElement","BOTTOM_END","DEFAULT","positionCSS","dismiss","success","danger","primary","secondary","light","requestPermission","showNative","showWeb","toast","dialogToast","notification","Notification","clearNative","dlg","nn","isNativeSupported","isGranted","permission","GSToastElement","pending","visibilityChange","isVisibilityChanged","pendingUpdate","validParent","renderWithHeader","renderSimple","isToast","isNotify","AbstractTreeController","addNodeController","removeNodeController","oldNode","TreeController","toggleState","addedNode","insertedNode","onRemove","GSTreeItemElement","renderSpinner","cssFocus","status","toggleSelection","parentItem","checkColor","checkColorSelected","ui","itemIco","itemIcon","openIcon","closeIcon","renderIndent","renderMulti","GSTreeElement","guide","shared","listRef","nextItem","previousItem","reload","expandable","ServiceWorkkerElement","scope","trace","registration","workerMessage","messageChannel","nocache","onWorkerMessage","unload","ServiceWorkerTraceUpdate","available","clearCache","postMessage","nonNull","isLoaded","port1","onMessage","initChannel","MessageChannel","onmessage","port2","waiting","monitorServiceWorkerUpdate","installing","serviceWorker","invokeServiceWorkerUpdateFlow","monitorController","refreshing","GSChartElement","URL_LIB","GS_URL_CHART","canvasRef","chart","waitInit","destroy","isChart","renderData","canvas","updateChart","div","toBase64Image","quality","sets","datasets","ctx","getContext","Chart","initializing","registerables","nameV","valV","typeV","childs","isObject","_nam","GSChart","_val","_typ","GSHighlightElement","GS_URL_HLJS","codeRef","onTarget","onURL","onHighlight","hasLangauge","highlight","injectCSS","terminate","response","worker","blobURL","Worker","langs","GSMarkdownElement","GS_URL_MARKDOWN","history","maxHeight","containerRef","initLib","showdown","tasklists","tables","Converter","toCache","fromCache","container","makeHtml","handleLinks","handleTables","handleCode","parentPath","handleStyles","links","onLinkClick","script","GSMonacoElement","GS_URL_MONACO","editor","onMonacoReady","monaco","model","getModel","selection","getValueInRange","getSelection","setModelLanguage","setTheme","automaticLayout","minimap","MonacoEnvironment","baseUrl","getWorkerUrl","workerId","require","paths","vs","initialized","initEnv","initMonaco"],"mappings":"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"}